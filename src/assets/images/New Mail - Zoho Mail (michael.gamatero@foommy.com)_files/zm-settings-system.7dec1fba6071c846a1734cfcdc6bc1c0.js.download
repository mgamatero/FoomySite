"use strict";!function(){var i=zmail.Core.Namespaces,e=i.create("zmail.Settings.Modules"),n=function(e,t,n){var r="__namespace",o={create:"create",import:"get"}[e];return t=["zmail.Settings",t],"object"===babelHelpers.typeof(n)&&n.hasOwnProperty(r)&&(n=n[r]),void 0!==n&&t.splice(1,0,n),t=t.join("."),i[o](t)},o=function(e,t){return n("create",e,t)},s=function(e,t){return n("import",e,t)};window._defineSettingsModule=function(e,t,n){if(n=n||"",!(e=e||""))throw new Error("[moduleName] is required");if("function"!=typeof t)throw new Error("[defineCallback] should be a function");n&&(e=[n,e].join("."));var r=o(e);if(!r)throw new Error("Module could not be created");return t(r,s,r),r},e.create=function(e,t){return o(e,t)},e.import=function(e,t){return s(e,t)}}(),_defineSettingsModule("Utils",function(e){var t="function"==typeof Array.prototype.find?function(e,t){return Array.prototype.find.call(e,t)}:function(e,t){var n=Array.prototype.filter.call(e,t);if(n&&n[0])return n[0]};e.copyProperties=function(e,t,n){return e=e||{},t=t||{},t=!0===n?$.extend(!0,t,e):$.extend(t,e)},e.cloneObject=function(e){return _.clone(e)},e.deleteProperty=function(e,t){(e=e||{})[t]=void 0,delete e[t]},e.getProperty=function(e,t,n){for(e=e||window,t=n?t.split("."):[t];t.length&&void 0!==e;)e=e[t.shift()];return e},e.setProperty=function(e,t,n,r){var o;for(e=e||window,t=r?t.split("."):[t];t.length;)e[o=t.shift()]=e[o]||{},0===t.length?e[o]=n:e=e[o]},e.listToMap=function(e){var t={};return(e=e||{}).forEach(function(e){t[e]=e}),t},e.makePrivateMethod=function(t,n){return function(){var e=Array.prototype.slice.apply(arguments);if(!(this instanceof n))throw new Error("Function called from invalid 'this' reference");return t.apply(this,e)}},e.makeDeferred=function(e){e=e||{};var t=$.Deferred();return!0===e.resolve?t.resolve():!0===e.reject&&t.reject(),!0===e.promise&&(t=t.promise()),t},e.allDeferreds=$.when,e.isPromise=function(e){return!(!e||"function"!=typeof e.done||"function"!=typeof e.fail)},e.isNativePromise=function(e){return!(!e||"function"!=typeof e.then)},e.debugLog=function(){if(!0===zmail.Settings.debug){var e=Array.prototype.slice.apply(arguments);e.unshift("[zmail-settings-debug] > "),window.console.log.apply(window.console,e)}},e.debugLogError=function(){if(!0===zmail.Settings.debug){var e=Array.prototype.slice.apply(arguments);e.unshift("[zmail-settings-debug] > "),window.console.error?window.console.error.apply(window.console,e):window.console.log.apply(window.console,e)}},e.removeDuplicates=function(e){if(e&&e.constructor===Array){var t={};return e.forEach(function(e){t[e]=e}),Object.keys(t)}},e.findInArray=t},"Platform.System"),_defineSettingsModule("Base",function(e){var i="_originalSubscriber",s="_proxySubscriber",u={},a=function(e,t){return e!==u&&!0!==t&&(e.hasOwnProperty("_eventSink")||(e._eventSink={}),e=e._eventSink),e},r=function(e,t,n,r){e=a(e=e||u,r);var o=n;return r||(((n=function(e,t){o(t,e)})[i]=o)[s]=n),$(e).on(t,n),n},o=function(e,t,n,r){return e=a(e=e||u,r),!r&&n&&(n[s]?n=n[s]:n[i]&&(n=n[i])),$(e).off(t,n),n},c=function(e,t,n,r){e=a(e=e||u,r),n=n||{},$(e).trigger(t,n)};e.subscribeEvent=r,e.unsubscribeEvent=o,e.publishEvent=c,e.bindEvent=function(e,t,n){if(e||t||n)return r(e,t,n,!0)},e.unbindEvent=function(e,t,n){if(e||t)return o(e,t,n,!0)},e.triggerEvent=function(e,t,n){if(e||t)return c(e,t,n,!0)}},"Platform.Events"),_defineSettingsModule("Utils",function(e,n){var r=n("Platform.Events.Base"),o=n("Platform.System.Utils"),t=zmail.Utils.DOM.getRefs,i=function(e,t,n){$(e).attr(t,n)},s=function(e,t){_zm.succErrMsg("e",e,t)};e.bindEvent=function(e,t,n){return r.bindEvent(e,t,n)},e.unbindEvent=function(e,t,n){return r.unbindEvent(e,t,n)},e.triggerEvent=function(e,t,n){return r.triggerEvent(e,t,n)},e.addDOM=function(e,t,n){n?$(n).before(e):t&&$(t).append(e)},e.removeDOM=function(e){$(e).remove()},e.showDOM=function(e,t){switch((t=t||{}).animation){case"slide":$(e).slideDown(t.duration);break;case"fade":$(e).fadeIn(t.duration);break;case"custom":t.custom(e);break;default:$(e).show()}},e.hideDOM=function(e,t){switch((t=t||{}).animation){case"slide":$(e).slideUp(t.duration);break;case"fade":$(e).fadeOut(t.duration);break;case"custom":t.custom(e);break;default:$(e).hide()}},e.constructDOM=function(e){return e},e.setDOMText=function(e,t){$(e).text(t)},e.setDOMColor=function(e,t){$(e).css("background-color",t)},e.setDOMHtml=function(e,t){$(e).html(t)},e.setDOMAttr=i,e.getDOMAttr=function(e,t){return $(e).attr(t)},e.removeDOMAttr=function(e,t){return $(e).removeAttr(t)},e.addClass=function(e,t){$(e).addClass(t)},e.removeClass=function(e,t){$(e).removeClass(t)},e.toggleClass=function(e,t){$(e).toggleClass(t)},e.hasClass=function(e,t){return $(e).hasClass(t)},e.setClass=function(e,t){i(e,"class",t)},e.getCSSProp=function(e,t){return $(e).css(t)},e.removeCSSProp=function(e,t){$(e).css(t,"")},e.setCSSProp=function(e,t,n){$(e).css(t,n)},e.getDOMReferenceMap=t,e.suppressAnchorEvents=function(e,t){t=t||{},e&&"A"===e.nodeName&&$(e).on("contextmenu",function(){return!1})},e.stopEvent=function(e,t){e&&e.stopPropagation&&(e.stopPropagation(),t&&e.preventDefault&&e.preventDefault())},e.getViewSize=function(e){return e?e.getBoundingClientRect():null},e.showSuccessMessage=function(e,t){_zm.succErrMsg("s",e,t)},e.showErrorMessage=s,e.showInfoMessage=function(e,t){_zm.succErrMsg("i",e,t)},e.showException=function(e,t){e instanceof n("Platform.System.Base").Error?s(e.errorMessage,t):o.debugLogError?o.debugLogError(e,t):o.debugLog("[error] ",e,t)},e.resetScroll=function(e){(e=(e=$(e))[0])&&(e.scrollTop=0)},e.removeDOMText=function(e){$.e(e).clearHTML()}},"Platform.UI"),_defineSettingsModule("Constants",function(e){var t={UNDEFINED:void 0,NULL:null,NAN:NaN,INFINITY:1/0};e.PrimitiveValues=t,e.ModuleList={MAILSUITE_APP_CORE:"zm-settings-mailsuite-appcore"}},"Platform.System"),_defineSettingsModule("Base",function(e){e.Atom=function(){}},"Platform.System"),_defineSettingsModule("Base",function(e,t,n){var r=n.Atom,o=function(){};(o.prototype=new r).constructor=o,e.Class=o},"Platform.System"),_defineSettingsModule("Base",function(e){e.Error=function(e,t){this.errorMessage=e,this.opts=t||{}}},"Platform.System"),_defineSettingsModule("Base",function(e,t,n){var r=n.Error,o=function(e){this.message=e||"Cannot invoke Abstract method"};(o.prototype=new r).constructor=o,e.AbstractMethodError=o},"Platform.System"),function(n,e){var r=e("Events"),o=e("InternalAPI"),i=n("Platform.Events.Base"),s=n("Platform.System.Utils"),t=zmail.Settings,u=!1;r.on=function(e,t){return i.subscribeEvent(r,e,t)},r.off=function(e,t){return i.unsubscribeEvent(r,e,t)},o.publishEvent=function(e,t){return i.publishEvent(r,e,t)};t.initializeSystem=function(){var e=s.makeDeferred();if(u)return e.resolve().promise();var t=[];return o.publishEvent("initialize",{pushTask:function(e){s.isPromise(e)&&t.push(e)}}),$.when(t).done(function(){zmail.Settings.Platform.External.loadSettingsCore().always(function(){!function(e){e=e||{};var t=n("Platform.Components").SettingManager,r=[];t.getAll().forEach(function(t){var e,n=t.getAttribute("id");t.getState().initialized||(t._persister?(e=t.initialize(),s.isPromise(e.promise)&&r.push(e.promise)):o.publishEvent("setting/initialize/"+n,{setValue:function(e){t.initialize({value:e})}}))}),$.when(r).done(function(){e.deferred&&e.deferred.resolve()}).fail(function(){e.deferred&&e.deferred.reject()})}({deferred:e})})}).fail(e.reject),e.done(function(){u=!0,o.publishEvent("initialized")}),e.promise()}}(zmail.Settings.Modules.import,zmail.Settings.Modules.create);