(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"3QXI":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){babelHelpers.classCallCheck(this,e),babelHelpers.defineProperty(this,"counter",0)}return babelHelpers.createClass(e,null,[{key:"increment",value:function(){this.counter++}},{key:"reset",value:function(){this.counter=0}},{key:"exceed",value:function(){return this.counter>5}}]),e}()},GOi7:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("m8qQ"),a=function(e){var t,n,a=(t=$.parseJSON(e.m)).act;switch(a){case"MAIL_CONTENT":n=JSON.parse(t.res),zmContentCache.processResponse(n,n.M),zmContentCache.getCacheStore().put(n.MSGID,n);break;case"INITIAL_FETCH":case"ZMOFFLINE_MAIL_DATA":case"MAIL_LIST":case"THREAD_INFO":case"MAIL_DETAILS":ZMail.IDB.syncer.wsHanlder(a,t);break;case"MAIL_OFFLINE_CHANGES":n=t.data,ZMail.IDB.syncer.wsHanlder(a,n)}Object(r.a)("In mail push msg handler : Data pushed from WS server "+e)}},Kklx:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("m8qQ"),a=n("p2EH"),i=n("hSUr"),s=function(e){if(e){var t=$.parseJSON(e.m),n=$.parseJSON(t.res);if("V_STATUS"===t.act){var s=zmAttachComponent.virusCheckStatus[n.FILEPATH]||{};s.reference?(zmAttachComponent.virusCheckStatusUpdate.call(s.reference,n),delete zmAttachComponent.virusCheckStatus[n.FILEPATH]):zmAttachComponent.virusCheckStatus[n.FILEPATH]={value:n.STATUS}}else if("DOWNLOAD_AS_ZIP"===t.act){if(Object(a.t)())return void i.f.load("download").then(function(){zmDownload.downloadApp({mode:"getzipstream"},n)});var o=n.FILEPATH,c=zmail.conPath+"/FileDownload",u={mode:"getzipstream",accId:zmail.accId,fpath:o};zmAjq.formSubmit(u,c,"get")}Object(r.a)("In attachment push msg handler : Data pushed from WS server "+JSON.stringify(e))}}},Pr16:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"c",function(){return r}),n.d(t,"f",function(){return i}),n.d(t,"d",function(){return s}),n.d(t,"g",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r={INTERNAL_SERVER_ERROR:1011,AUTH_FAILED:4001,TOO_MANY_CONNECTIONS:4002,TOO_MANY_SESSIONS:4004,EMPTY_TICKET:4006},a=zmail.wsServerURL,i="ws",s="?-",o="WebSocket"in window||"MozWebSocket"in window,c=9e5,u=12e4},jS8J:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("m8qQ"),a=n("3QXI"),i=n("Pr16"),s=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"register",value:function(e,t){this.handlers[e]=t}},{key:"handle",value:function(e){var t=e.code,n=this.handlers[t];return n?(zmail._ws._connectionLogger.push(n.log),n.handler&&n.handler(e),n.data):(zmail._ws._connectionLogger.push("unhandled event for code",t),{retryStatus:!0})}}]),e}();babelHelpers.defineProperty(s,"handlers",{});var o=i.c,c=zmail._ws;s.register(o.AUTH_FAILED,{log:"WS :: Authentication Failed",data:{retryStatus:!1},handler:function(){Object(r.a)("Authentication failed: "+i.a),a.a.exceed()||setTimeout(function(){a.a.increment(),c.init()},i.a)}}),s.register(o.TOO_MANY_CONNECTIONS,{log:"WS :: TOO MANY CONNECTIONS",data:{retryStatus:!1,closeStatus:"TOO MANY CONNECTIONS"},handler:function(){Object(r.a)("Too Many Connections. Retry Connection will be initiated after dur: "+i.b),setTimeout(function(){c.init()},i.b)}}),s.register(o.INTERNAL_SERVER_ERROR,{log:"WS :: Internal Server Error",data:{retryStatus:!0,closeStatus:"INTERNAL SERVER ERROR"},handler:function(e){Object(r.a)("Server Error"+e)}}),s.register(o.TOO_MANY_SESSIONS,{log:"WS: Too Many user sessions",data:{retryStatus:!1,closeStatus:"TOO MANY SESSIONS"}}),s.register(o.EMPTY_TICKET,{log:"WS: Empty ticket",data:{retryStatus:!1,closeStatus:"EMPTY TICKET"}})},vA86:function(e,t,n){"use strict";n.r(t),n.d(t,"WS",function(){return l});var r=n("jXRH"),a=n("m8qQ"),i=n("Pr16"),s=n("jS8J"),o=n("3QXI"),c=n("GOi7"),u=n("Kklx"),l=new r.a({serverName:i.f,path:i.e,idleMsg:i.d,args:{zuid:zmail.zuid},secure:!0,isRebranded:zmail.isRebranded,callbacks:{onOpen:function(){},onClose:function(e){return e.code!==i.c.AUTH_FAILED&&o.a.reset(),s.a.handle(e)},onMsg:function(){o.a.reset()},onSessionIdUpdate:function(e){$.publish("/ws/sessionIdUpdate",e)},onRefreshView:function(){$.publish("zmailReconnect")},onServerTime:function(e){zmail.initialServerSyncTime||(zmail.initialServerSyncTime=e.serverTime),zmail.lastServerHandShakeTime=e.serverTime,$.publish("serversync/time",e.serverTime)}},handleRetry:!0,debugLogger:a.a,notifier:zmComponent.notifier.push});i.g&&zmail.workerPromise.then(function(){l.args.ISOFFLINE=_zm.isOfflineLockAvailable(),l.init()}),l._connectionLogger=r.a.getLoggerInstance(200),zmail._ws=l,l.subscribePushMsg("mail",c.a),l.subscribePushMsg("attachment",u.a)}}]);