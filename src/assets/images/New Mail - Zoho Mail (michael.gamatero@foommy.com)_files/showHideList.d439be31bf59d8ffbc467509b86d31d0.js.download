"use strict";!function(){var t,e=zmail.Core.Namespaces.create("zmail.mailShowHideList"),a=function(){function e(){babelHelpers.classCallCheck(this,e),t=zmText.get("mail").actions.customizeOptions}return babelHelpers.createClass(e,[{key:"actionMappingConstants",value:function(){var e=["flag","read","commentcount","dCount","folder","label"],t=e.slice();t.pop(),t.push("cCount");var a=["folder"].slice();return a.pop(),{inboxHideItems:[],FolderIdMap:{Inbox:"iId",Trash:"tId",Template:"teId",Draft:"dId",Outbox:"oId",Sent:"sId",Spam:"spId"},draftHideItems:e,TemplateHideItems:t,sentHideItems:["read","commentcount","folder"],TrashHideItems:["thread","cCount","folder"],OutboxHideItems:["read","folder","commentcount","dCount","flag","label"],spamHideItems:["folder","commentcount","dCount","flag","folder"],searchConstants:{search:"zm_srch1"},searchViewConstants:a,actionMap:{flag:"flag",thread:"thread",envelope:"envelope",dCount:"dCount",cCount:"commentcount",attachment:"attachment",folder:"folder",size:"size",label:"label",date:"date",delete:"delete"},shareFolderHideItems:["folder","delete","label"]}}},{key:"loopListVal",value:function(i,e){var a=zmAdHocSettings.getCustomizeMailListing();return i.forEach(function(e,t){"folder"===e.curAct&&(e.curAct="thread"),parseInt(a[e.curAct])||(i[t].htm+=zdom("i",{className:"msi-tick"}).outerHTML)}),e.forEach(function(a){i.forEach(function(e,t){"thread"===e.curAct&&(e.curAct="folder"),"envelope"===e.curAct&&(e.curAct="read"),a===e.curAct&&i.splice(t,1)})}),i}},{key:"getCurrentConfigList",value:function(e){var t=this,a=zmail.folId,i=zmUtil.getFolId(),o="",n=!1,d=t.actionMappingConstants(),l=zmUtil.isFolderId(i),r=!1;if(zmail.folTree[0].hasOwnProperty(i))r=!0;else for(var s=zmail.folTree[1],c=Object.keys(s),m=c.length,f=0;f<m;f++)if(s[c[f]].CH.hasOwnProperty(i)){r=!0;break}if(!l||zmTab.currentTab===d.searchConstants.search)return void 0!==zmail.shrTree[0]&&zmail.shrTree[0].hasOwnProperty(i)?t.loopListVal(e,d.shareFolderHideItems):t.loopListVal(e,d.searchViewConstants);for(var u in a)if(a[u]===i){n=!0,o=u;break}if(n){if(o===d.FolderIdMap.Inbox)return t.loopListVal(e,d.inboxHideItems);if(o===d.FolderIdMap.Draft)return t.loopListVal(e,d.draftHideItems);if(o===d.FolderIdMap.Template)return t.loopListVal(e,d.TemplateHideItems);if(o===d.FolderIdMap.Trash)return t.loopListVal(e,d.TrashHideItems);if(o===d.FolderIdMap.Sent)return t.loopListVal(e,d.sentHideItems);if(o===d.FolderIdMap.Outbox)return t.loopListVal(e,d.OutboxHideItems);if(o===d.FolderIdMap.Spam)return t.loopListVal(e,d.spamHideItems)}else if(r)return t.loopListVal(e,d.inboxHideItems)}},{key:"changeShowHide",value:function(e,t){var a={0:"1",1:"0"},i=this.actionMappingConstants().actionMap,o=zmAdHocSettings.getCustomizeMailListing();e===i.envelope?o[i.envelope]=a[o[i.envelope]]:e===i.flag?o[i.flag]=a[o[i.flag]]:e===i.thread?o[i.thread]=a[o[i.thread]]:e===i.dCount?o[i.dCount]=a[o[i.dCount]]:e===i.cCount?o[i.cCount]=a[o[i.cCount]]:e===i.attachment?o[i.attachment]=a[o[i.attachment]]:e===i.size?o[i.size]=a[o[i.size]]:e===i.date?o[i.date]=a[o[i.date]]:e===i.delete?o[i.delete]=a[o[i.delete]]:e===i.folder?o[i.thread]=a[o[i.thread]]:e===i.deliveredStatus?o[i.deliveredStatus]=a[o[i.deliveredStatus]]:e===i.label&&(o[i.label]=a[o[i.label]]);var n=!0;ZMail.utils.isROMode()&&(n=!1),zmAdHocSettings.setCustomizeMailListing(o,{sync:n})}},{key:"getDropDownConfigList",value:function(){var e=[{htm:t.flag,curAct:"flag",data:{action:"customizeActionList",value:"flag"}},{htm:t.read,curAct:"envelope",data:{action:"customizeActionList",value:"envelope"}},{htm:t.cCount,curAct:"commentcount",data:{action:"customizeActionList",value:"commentcount"}},{htm:t.attachment,curAct:"attachment",data:{action:"customizeActionList",value:"attachment"}},{htm:t.folder,curAct:"folder",data:{action:"customizeActionList",value:"folder"}},{htm:t.size,curAct:"size",data:{action:"customizeActionList",value:"size"}},{htm:t.label,curAct:"label",data:{action:"customizeActionList",value:"label"}},{htm:t.date,curAct:"date",data:{action:"customizeActionList",value:"date"}},{htm:t.delete,curAct:"delete",data:{action:"customizeActionList",value:"delete"}}];return{list:this.getCurrentConfigList(e),clk:this.changeShowHide.bind(this)}}}]),e}();e.list=a}(),function(){var e=zmail.Core.Namespaces,z=e.create("zmail.showHideSkeleton"),b=e.get("ZMail.lView"),u=0,C=!1,A=window.zmCenterListing.getMappedClass,L=zmInit.classObj,T=zmInit.mapObj,H={0:1,1:0},S={flag:"flag",pflag:"pFlag",checkbox:"checkbox",envelope:"envelope",thread:"thread",delete:"delete",size:"size",date:"date",folder:"folder",pfolder:"pFolder",label:"label",searchWorkSpace:"zm_srch1",pRead:"pRead",pSender:"pSender",read:"read"};z.updateNode=function(e){$(e).find("[data-action="+S.envelope+"]")[0]||$(e).find("[data-action="+S.flag+"]")[0]?$(e).find("[data-action="+S.pRead+"]").removeClass("zmLact2CH"):$(e).find("[data-action="+S.pRead+"]").addClass("zmLact2CH")},z.showHideNode=function(e,t,a,i,o){$(e).remove(),i!==S.flag&&i!==S.envelope||z.updateNode(o)},z.insAftBefNode=function(e,t,a){var i,o,n,d,l,r,s,c,m;switch(a){case"envelope":var f=$(e).find("[data-action="+S.checkbox+"]"),u=$(e).find("[data-action"+S.psender+"]");i=$(e).find("[data-action="+S.thread+"]"),f[0]?$(t).insertBefore(f):i[0]?$(t).insertBefore(i):u[0]&&$(t).prepend(u),z.updateNode(e);break;case"flag":o=$(e).find("[data-action="+S.checkbox+"]"),s=$(e).find("[data-action="+S.envelope+"]"),c=$(e).find("[data-action="+S.pRead+"]"),o[0]?$(t).insertAfter(o):s[0]?$(t).insertAfter(s):c[0]&&$(c).append(t),z.updateNode(e);break;case"commentcount":var p=$(e).find("[data-action='parCCount']");p[0]&&p.append(t);break;case"attachment":var h=$(e).find("[data-action='subject']");h[0]&&h.prepend(t);break;case"size":n=$(e).find("[data-action="+S.delete+"]"),(l=$(e).find("[data-action="+S.date+"]"))[0]?$(t).insertBefore(l):n[0]?$(t).insertBefore(n):$(e).append(t);break;case"delete":$(e).append(t);break;case"date":n=$(e).find("[data-action="+S.delete+"]"),(d=$(e).find("[data-action="+S.size+"]"))[0]?$(t).insertAfter(d):n[0]?$(t).insertBefore(n):$(e).append(t);break;case"folder":var g=$(e).find("[data-action="+S.pfolder+"]");n=$(e).find("[data-action="+S.delete+"]"),d=$(e).find("[data-action="+S.size+"]"),l=$(e).find("[data-action="+S.date+"]"),g[0]?$(t).insertAfter(g):d[0]?$(t).insertBefore(d):l[0]?$(t).insertBefore(l):n[0]?$(t).insertBefore(n):$(e).append(t);break;case"label":r=$(e).find("[data-action='pLabel']"),(m=$(e).find("[data-action='viewAction']"))[0]?$(t).insertBefore(m):r.append(t)}},z.getSkeleton=function(e,t,a){var i=!1;if(void 0===t)return!1;var o=t.getAttribute("id");o&&0<=o.indexOf("thd")?o=o.replace("thd",""):o&&0<=o.indexOf("t")&&(o=o.replace("t",""),i=!0);var n=zmList.getMailObj(o);if(void 0===n)return!1;var d,l,r,s,c,m,f,u,p,h="";switch(e){case"envelope":l=a,r=n,u=zmTab.currentTab,p=zmUtil.getMLConversionValue(s),"search"===l?(s="",u="zm_srch"):s=zmUtil.getFolId(),"thread"===l?(1===r.NS2?r.S=0===r.S?2:4:2===r.NS2?r.S=0===r.S?3:5:3===r.NS2&&(r.S=0===r.S?7:8),s===zmail.folId.teId||s===zmail.folId.dId?(r.NFG="-1",r.S=""):r.FD===zmail.folId.sId&&(r.S=9)):(0!==u.indexOf("zm_srch")&&0!==p&&r.TH&&s!==zmail.folId.tId&&s!==zmail.folId.dId&&s!==zmail.folId.sId&&0<r.TC&&(r.M="t"+r.M,r.S=r.TS,r.TS2&&(1===r.TS2?r.S=0===r.S?2:4:2===r.TS2?r.S=0===r.S?3:5:3===r.TS2&&(r.S=0===r.S?7:8))),s!==zmail.folId.sId&&s!==zmail.folId.oId||s===zmail.folId.oId&&(r.S="6"),s===zmail.folId.teId&&s===zmail.folId.dId&&s===zmail.folId.sId?r.S="":!r.TH||0!==p&&0!==u.indexOf("zm_srch")||(1===r.NS2?r.S=0===r.S?2:4:2===r.NS2?r.S=0===r.S?3:5:3===r.NS2&&(r.S=0===r.S?7:8))),c=A(T,L,r,"markupIcons"),m=A(T,L,r,"calEvent"),f=A(T,L,r,"att"),h=c||m?c||m:f,d=b.constTemplate(e,{iconCls:h,envelope:H[zmAdHocSettings.getCustomizeMailListing()[e]]});break;case"flag":var g=$.extend({},n);L.flagIcon.hasOwnProperty(n.NFG)&&(i&&(g.NFG=zmInit.getThdFlagvalue(o)),h=A(T,L,g,"flagIcon"),d=b.constTemplate(e,{iconCls:h,flag:H[zmAdHocSettings.getCustomizeMailListing()[e]]}));break;case"commentcount":0<n.CMT&&(d=b.constTemplate("commentCount",{commentcount:H[zmAdHocSettings.getCustomizeMailListing()[e]],cmtCount:n.CMT}));break;case"attachment":i&&0<n.TA?d=b.constTemplate(e,{attachment:H[zmAdHocSettings.getCustomizeMailListing()[e]]}):0<n.AT&&(d=b.constTemplate(e,{attachment:H[zmAdHocSettings.getCustomizeMailListing()[e]]}));break;case"size":var z,S,v=zmUtil.getFolId();C&&0===zmfolAction.getFolCV(v)&&(z=!0),z?S=n.hasOwnProperty("SZ")?ZMail.utils.getMailSize(n.SZ):"":"thread"===a&&n.hasOwnProperty("SZ")?S=ZMail.utils.getMailSize(n.SZ):n.hasOwnProperty("TC")&&n.hasOwnProperty("SZ")?(S=ZMail.utils.getMailSize(n.SZ),1<=n.TC&&(S="")):n.hasOwnProperty("SZ")&&(S=ZMail.utils.getMailSize(n.SZ)),d=b.constTemplate(e,{isSizeAdhoc:H[zmAdHocSettings.getCustomizeMailListing()[e]],size:S});break;case"delete":d=b.constTemplate("trash",{trash:H[zmAdHocSettings.getCustomizeMailListing()[e]],iconCls:"msi-trash"});break;case"date":n.hasOwnProperty("DT")&&(d=b.constTemplate(e,{isDateAdhoc:H[zmAdHocSettings.getCustomizeMailListing()[e]],date:n.DT}));break;case"folder":var I;n.hasOwnProperty("FD")&&(I=zmInit.findFolName(n.FD),d=b.constTemplate("folderName",{folName:I,folder:H[zmAdHocSettings.getCustomizeMailListing().thread],isArchive:n.AR}));break;case"label":i&&n.TTAGS?d=b.constTemplate("labels",{tagLst:n.TTAGS,labels:H[zmAdHocSettings.getCustomizeMailListing()[e]],conf:n}):n.TAG&&(d=b.constTemplate("labels",{tagLst:n.TAG,labels:H[zmAdHocSettings.getCustomizeMailListing()[e]],conf:n}))}return d},z.updateList=function(e){var t=zmail.mailCenter.listElem.children;if(z.updateListUI(e,t),zmsuite.isWorkspaceAvailable(S.searchWorkSpace)){var a=zmailSearch.Model.getSearchData();void 0!==a&&(a=a.elemObj.listingContentElem[0].children,z.updateListUI(e,a,"search"))}},z.updateListUI=function(e,t,a){C=!1;var i=zmUtil.getFolId();(zmail.folTree[0].hasOwnProperty(i)||zmail.folTree[1].hasOwnProperty(i))&&(C=!0);var o=H[zmAdHocSettings.getCustomizeMailListing()[e]];"folder"===e&&(o=H[zmAdHocSettings.getCustomizeMailListing().thread]);var n,d=t,l=d.length;if(o)for(var r=0;r<l;r++){if(n=$(d[r]).find("[data-action="+e+"]")[0],d[r].getAttribute("id")&&0<=d[r].getAttribute("id").indexOf("thd")){if(u=d[r].children.length,"folder"!==e){z.updateListUI(e,d[r].children);continue}for(var s=d[r].children,c=s.length,m=0;m<=c;m++)r++,void 0!==(n=z.getSkeleton(e,s[m],"thread"))&&z.insAftBefNode(s[m],n,e)}n?z.showHideNode(n,o,"zmHideD",e,d[r]):"folder"!==e||C?"folder"===e&&"search"===a?void 0!==(n=z.getSkeleton(e,d[r]))&&z.insAftBefNode(d[r],n,e):"folder"!==e&&void 0!==(n=0!==u?(u--,z.getSkeleton(e,d[r],"thread")):z.getSkeleton(e,d[r],a))&&z.insAftBefNode(d[r],n,e):void 0!==(n=z.getSkeleton(e,d[r]))&&z.insAftBefNode(d[r],n,e)}else for(var f=0;f<l;f++)n=$(d[f]).find("[data-action="+e+"]")[0],d[f].getAttribute("id")&&0<=d[f].getAttribute("id").indexOf("thd")?z.updateListUI(e,d[f].children):z.showHideNode(n,o,"zmHideD",e,d[f])}}();