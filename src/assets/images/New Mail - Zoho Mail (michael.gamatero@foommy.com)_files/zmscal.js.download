var zcal={i18n:{},view:0,mlimit:[],disabledcal:""};zcal.win=window,zcal.isRO=!1,zcal.ZCRM="",zcal.ZMET="",zcal.ZTSK="",zcal.ZNTS="",zcal.ZCAL,zcal.timezones=[],zcal.search={},zcal.calcolor=[["#528800","#8CBF40"],["#B1365F","#E67399"],["#4A716C","#85AAA5"],["#001ca2","#8f9bd6"],["#00a600","#9cdc9c"],["#bd1700","#e8b0a8"],["#7b22aa","#c59eda"],["#787878","#c4c4c4"],["#b30051","#de8fb3"],["#5c8d87","#a6bab7"],["#88880E","#BFBF4D"],["#A32929","#D96666"],["#7A367A","#B373B3"],["#29527A","#668CB3"],["#28754E","#65AD89"],["#BE6D00","#F2A640"],["#865A5A","#BE9494"],["#4E5D6C","#8997A5"],["#8D6F47","#C4A883"],["#AB8B00","#E0C240"]],zcal.eventcolor=["#d581d6","#d6819f","#d68d8d","#e59881","#d6d678","#95d681","#81d6a1","#81d6ce","#81bad6","#92b2d6"],zcal.DFORMAT=["MM/dd/yyyy","dd/MM/yyyy","yyyy/MM/dd","yyyy-MM-dd"],zcal.timeformat=["hh:mm a","HH:mm"],zcal.msec_hour=36e5,zcal.msec_minute=6e4,zcal.hrgrid_lsec_width=81,zcal.ttipformat="MMM dd",zcal.qevent_format="E, NNN dd",zcal.QEDITFMT="MMM dd, yyyy",zcal.CALMODE=0,zcal.isTaskUser=!1,zcal.isCRMUser=!1,zcal.isWindowResized=!1,zcal.reconstructView=!1,zcal.settingsUpdated=!1,zcal.timezoneupdated=!1,zcal.alldayScrollTop=0,zcal.hrgridSrollTop=0,zcal.isSubToCalUpd=!1,zcal.workDays=[],zcal.refreshTimer=null,zcal.refreshMode,zcal.appChild={},zcal.appCount={},zcal.groupChild={},zcal.groupCount={},zcal.iswms=!1,zcal.lhsrhsresize=!1,zcal.localTime=(new Date).getTime(),zcal.initLoad=!0,ZCL_GRP_SECTION=!0;var ZCL_CALNAME="";zcal.time=["12:00 am","12:30 am","1:00 am","1:30 am","2:00 am","2:30 am","3:00 am","3:30 am","4:00 am","4:30 am","5:00 am","5:30 am","6:00 am","6:30 am","7:00 am","7:30 am","8:00 am","8:30 am","9:00 am","9:30 am","10:00 am","10:30 am","11:00 am","11:30 am","12:00 pm","12:30 pm","1:00 pm","1:30 pm","2:00 pm","2:30 pm","3:00 pm","3:30 pm","4:00 pm","4:30 pm","5:00 pm","5:30 pm","6:00 pm","6:30 pm","7:00 pm","7:30 pm","8:00 pm","8:30 pm","9:00 pm","9:30 pm","10:00 pm","10:30 pm","11:00 pm","11:30 pm"],zcal.REM=["300000","600000","900000","1200000","1500000","1800000","2700000","3600000","7200000","14400000","21600000","28800000","43200000","86400000","172800000","259200000","345600000","432000000","518400000","604800000","691200000","777600000","864000000","950400000","1036800000","1123200000","1209600000","1296000000","2592000000","3888000000","5184000000","7776000000"],zcal.ZCL_STREAMGROUPLIST=[],zcal.tabcount=0;var zcalInit=function(){function e(e,t){var a={};if(t)for(var l=0;l<t.length;l++){var c=t[l];e[c]&&("1"==e[c][8]?(a[c]={ID:c,CN:""==e[c][0]?"UNTITLED":e[c][0],CC:ZCL_getCalColor(e[c][1])[1],STS:e[c][2]},0==e[c][2]?zcal.disabledcal+=c+",":ZCL_CALNAME+=(""==ZCL_CALNAME?"":",")+e[c][0]):zcal.disabledcal+=c+",")}else for(var l in e)"1"==e[l][8]?(a[l]={ID:l,CN:""==e[l][0]?"UNTITLED":e[l][0],CC:ZCL_getCalColor(e[l][1])[1],STS:e[l][2]},"crm"==e[l][14]&&(a[l].HC=1,a[l].E=1),0==e[l][2]?zcal.disabledcal+=l+",":ZCL_CALNAME+=(""==ZCL_CALNAME?"":",")+e[l][0]):zcal.disabledcal+=l+",";return a}function f(e){return e.sort(function(e,t){var a=e.value.toUpperCase(),l=t.value.toUpperCase();return a<l?-1:l<a?1:0}),e}function a(e){var t=this;if((e=e||{}).length&&-1!==e[0].indexOf("subscribe?")){var a=function(){for(var e=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),t=0;t<e.length;t++){var a=e[t].split("=");if("url"===a[0])return a[1]}}();a&&$.when(zcalSettings.Subscribe.confirmAndSubscribe(a)).done(function(){t.update([])})}}var s={},l=[{groupId:"action",actionArr:[{iconList:["msi-action","msi-barrow"],dropAction:!0,data:"act"}]},{groupId:"view",actionArr:[{iconList:["Day"],text:!0,tooltip:"Day",data:"day"},{iconList:["Week"],text:!0,tooltip:"Week",data:"week"},{iconList:["Work"],text:!0,tooltip:"Work",data:"work"},{iconList:["Month"],text:!0,tooltip:"Month",data:"month"},{iconList:["Agenda"],text:!0,tooltip:"Agenda",data:"agenda"}]},{groupId:"sadd",actionArr:[{iconList:["Smart Add"],text:!0,align:"right",data:"sadd"}]}],d=function(){return[{htm:zcal.i18n.print,data:{action:"print"}},{htm:zcal.i18n.printpreview,data:{action:"printPreview"}},{htm:zcal.i18n.savepdf,data:{action:"savePdf"}}]};return{prevHeader:{id:"zcalPrevHeader",text:"Preview Text",rIcons:[[{tooltip:"Close",tooltipDir:"right",iconClass:"msi-close",data:{action:"closePrev"}}]]},init:function(){var e=null;"function"==typeof zmsuite.createAppRouter&&(e=zmsuite.createAppRouter());var t={appname:zcal.i18n.calendar,appId:"zcal_Container",appIcon:"msi-calendar",customHeader:!0,data:{LNodes:"2",CNodes:"3"},handler:{create:function(){zcalUtil.createEvent()},settings:function(){}},router:e};null!==e&&e.initialize({hashKey:"calendar",handler:a}),zmsuite.setAppInfo(t)},initCalData:function(){zcal.mcal=e(zcal.cdata.calLst,zcal.cdata.calOrdArr),ZCL_updateGroupCalList(),ZCL_updateAppCalList(),zcal.acal=e(zcal.cdata.calALst),zcal.ocal=e(zcal.cdata.calOLst)},bindLeftActions:function(e){var t,a,l,c,i;if(l=(e=e.zmsData).type,a=(c=e.eventInfo).srcElement||c.target,i=e.rowInfo.layerId,t=e.rowInfo.type,"contextmenu"==l)zcalList.calUtility(c,a,i,e.rowObject);else if("click"==l&&"list"==t&&-1==c.currentTarget.id.indexOf("addCal"))zcalList.chgeCalStatus(c,e.rowObject);else if(-1!=c.currentTarget.id.indexOf("addCal")){var n=c.currentTarget.id.split("_")[1];ZCL_createCal(n)}},bindActionHeaderIcons:function(e,t,a){var l=e.srcElement||e.target;switch(a){case"day":zcal.view=0,zcalView.constGridView();break;case"week":case"work":zcal.view="work"==a?2:1,zcalView.constGridView();break;case"month":zcal.view=3,zcalView.constGridView();break;case"agenda":zcal.view=4,zcalView.constGridView();break;case"sadd":ZCL_openSAdd(l);break;case"act":var c=$(l).closest("li"),i=[{htm:"Create Calendar",data:{action:"create-cal"}},{htm:"Import",data:{action:"import"}},{htm:"Subscribe",data:{action:"subscribe"}},{htm:"Settings",data:{action:"settings"}}];c.find("b").addClass("SC_ddn"),zmsuite.showMenu({par:c,list:i,align:"pleft",clk:function(e,t){zcalList.bindAction(e,t)}});break;case"edit":break;case"save":ZCL_svEve()}},constructLeft:function(){var l,e=[];l=zcal.calLeft.getNodes();var t,a={id:"ID",name:"CN",color:"CC",check:"STS",count:"c",hasChild:"HC",expChild:"E",seq:"SE"},c=new ZMLayer;t={type:"5",listId:"zcl_mcalL",hasChild:!0,mapObject:a,id:"zcl_mcal",dataObject:{headerObject:{licon:"msi-folder",id:"zcl_mcalH",name:zcal.i18n.mycal,showList:!0,c:"<i class='msi-plus'></i>",onAdd:function(){ZCL_createCal()}},listObject:zcal.mcal}},c.push(t),e.push(c);var i,n=new ZMLayer;if(i={type:"5",listId:"zcl_acalL",hasChild:!0,mapObject:a,id:"zcl_acal",dataObject:{headerObject:{licon:"msi-folder",id:"zcl_acalH",name:zcal.i18n.appcal,showList:!0},listObject:zcal.acal}},0<Object.keys(zcal.appChild).length&&(i.type="6",i.hasCountObject=!0,i.dataObject.childObject=zcal.appChild,i.dataObject.countObject=zcal.appCount),zcal.cdata.hasAppCal){var r={hideNode:!1,id:"load",name:"Loading ...",txtNodeClass:"SC_thm"};i.dataObject.listObject.more=r}if(n.push(i),e.push(n),ZCL_GRP_SECTION){var s,d=new ZMLayer;if(s={type:"5",listId:"zcl_gcalL",hasChild:!0,mapObject:a,id:"zcl_gcal",dataObject:{headerObject:{licon:"msi-folder",id:"zcl_gcalH",name:zcal.i18n.grpcal,showList:!0,c:"<i class='msi-plus'></i>",onAdd:function(){ZCL_createGrpCal()}},listObject:zcal.gcal}},zcal.cdata.hasGrpCal){r={hideNode:!1,id:"load",name:"Loading ...",txtNodeClass:"SC_thm"};s.dataObject.listObject.more=r}0<Object.keys(zcal.groupChild).length&&(s.type="6",s.hasCountObject=!0,s.dataObject.childObject=zcal.groupChild,s.dataObject.countObject=zcal.groupCount),d.push(s),e.push(d)}var o,u=new ZMLayer;if(o={type:"5",listId:"zcl_ocalL",hasChild:!0,mapObject:a,id:"zcl_ocal",dataObject:{headerObject:{licon:"msi-folder",id:"zcl_ocalH",name:zcal.i18n.othcal,showList:!0},listObject:zcal.ocal}},zcal.cdata.hasOthCal){r={hideNode:!1,id:"load",name:"Loading ...",txtNodeClass:"SC_thm"};o.dataObject.listObject.more=r}u.push(o),e.push(u),l[0].push({layerArr:e}),zcal.calLeft.render(),zcal.calLeft.setListener("click",function(e){zcalInit.bindLeftActions(e)}),zcal.calLeft.setListener("contextmenu",function(e){zcalInit.bindLeftActions(e)}),setTimeout(function(){var e=l[0].getLayer("zcl_acal").el;e.find("#more")[0]&&e.find("#more").find("span").addClass("SC_thm");var t=l[0].getLayer("zcl_gcal").el;t.find("#more")[0]&&t.find("#more").find("span").addClass("SC_thm");var a=l[0].getLayer("zcl_ocal").el;a.find("#more")[0]&&a.find("#more").find("span").addClass("SC_thm")},100),$.isEmptyObject(zcal.acal)||l[0].getLayer("zcl_acal").setChildToggle(function(){window.console.log("ZM_LHS",">>>","Child Toggle Called")}),ZCL_GRP_SECTION&&($.isEmptyObject(zcal.gcal)||l[0].getLayer("zcl_gcal").setChildToggle(function(){window.console.log("ZM_LHS",">>>","Child Toggle Called")}))},constructCenter:function(){var e=zmsuite.getCenter()[0].getNodes();e[0].push(l),e[0].setListener("click",function(e,t,a){zcalInit.bindActionHeaderIcons(e,t,a)});var t=function(){var e,t,a,l,c=["DIV",{attrs:{id:"zcl_header",class:"zcl zcl_tpnvcn"},child:[["DIV",{attrs:{class:"zcl_table"},child:[["UL",{child:[["LI","en"==zmail.user.lang?{child:[["DIV",{attrs:{id:"zcl_sadd"},child:[["B",{child:[["I",{attrs:{class:"msi-add"}}]]}]]}]]}:""],["LI",{attrs:{id:"zcl_headerlbl"}}],["LI",{attrs:{class:"zcl_txr zcl_tpnv",id:"zcl_view"}}],["LI",{attrs:{class:"zcl_tppnt"},child:[["DIV",{attrs:{id:"zcl_print",class:"SCmb"}}]]}]]}]]}]]}];for(var i in(t=(e=_zm.getDOM(c)).querySelector("#zcl_sadd"))&&t.addEventListener("click",function(){ZCL_openSAdd(this)}),a=e.children[0].children[0].children[2],s.view){var n=s.view[i],r=$("<div "+(i==zcal.view?"class='zcl_sl'":"")+">"+n.text+"</div>");r.attr("data-vid",i),ZCL_tooltip({elm:r[0],text:n.tooltip,arrow:"bottom"}),r.off("click").click(function(){var e=$(this);e.parent().find("DIV").removeClass("zcl_sl"),e.addClass("zcl_sl"),zcalView.change(e.attr("data-vid"))}),a.appendChild(r[0])}return(l=e.querySelector("#zcl_print")).innerHTML='<b><div class="SC_hd"></div><i class="msi-print"/></b>',ZCL_tooltip({elm:l,text:zcal.i18n.print,arrow:"bottom"}),l.addEventListener("click",function(){var e=$(this);e.find("b").addClass("SC_ddn"),zmsuite.showMenu({par:e,list:d(),align:"pright",clk:function(e,t){zcalList.bindAction(e,t)}})}),e}();zmsuite.getCenter()[0].$el.prepend(t),zmsuite.renderCenter(),zmsuite.showApp("zcal_Container");var a=document.getElementsByClassName("zm_togglerpane");0<a.length&&(a[0].onclick=function(){setTimeout(function(){zcalView.constGridView()},300)})},constructView:function(){zcal.calLeft=zmsuite.getLeft(),zcalInit.constructLeft(),zcalInit.constructCenter(),zcal.calCenter=zmsuite.getCenter(),zcal.calCenter.listElem=zcal.calCenter[0].getNodes()[2].$el[0],zcal.calCenter.headerElem=zcal.calCenter[0].getNodes()[0].$el[0]},initCal:function(){zcalInit.initCalData(),zcalInit.init(),zcalInit.constructView(),zcalInit.initCalView()},initCalView:function(){zcalView.constGridView(),zcalEvents.loadMonthData(!0),ZCL_CheckUserInOtherServices(),0==zcal.CALMODE&&ZCL_getSubGrpLst()},initGlobalVar:function(){zcal.zuid=zcal.cdata.opt.ZUID,zcal.zoid=zcal.cdata.opt.ZOID,s={view:[{text:zcal.i18n.vday,tooltip:zcal.i18n.vday,data:0},{text:zcal.i18n.week,tooltip:zcal.i18n.week,data:1},{text:zcal.i18n.work,tooltip:zcal.i18n.work,data:2},{text:zcal.i18n.month,tooltip:zcal.i18n.month,data:3},{text:zcal.i18n.agenda,tooltip:zcal.i18n.agenda,data:4}]},zcal.view=zcal.cdata.opt.DEF,zcal.cdate=ZCL_parseDateTimeStr(zcal.cdata.opt.DATE_STR).getTime(),"c"==zmApp.currentApp&&zcalInit.timeLineInterval(),zcal.today=new Date,zcal.today.setTime(zcal.cdate),zcal.chkDate=new Date(zcal.cdate),zcal.mlimit=zcalInit.getMonthLimit(zcal.cdata.opt.DATE),Date.MONTH_NAMES=[[zcal.i18n.january,zcal.i18n.february,zcal.i18n.march,zcal.i18n.april,zcal.i18n.may,zcal.i18n.june,zcal.i18n.july,zcal.i18n.august,zcal.i18n.september,zcal.i18n.october,zcal.i18n.november,zcal.i18n.december],[zcal.i18n.jan,zcal.i18n.feb,zcal.i18n.mar,zcal.i18n.apr,zcal.i18n.may,zcal.i18n.jun,zcal.i18n.jul,zcal.i18n.aug,zcal.i18n.sep,zcal.i18n.oct,zcal.i18n.nov,zcal.i18n.dec]],Date.WEEK_DAYS=[[zcal.i18n.sunday,zcal.i18n.monday,zcal.i18n.tuesday,zcal.i18n.wednesday,zcal.i18n.thursday,zcal.i18n.friday,zcal.i18n.saturday],[zcal.i18n.sun,zcal.i18n.mon,zcal.i18n.tue,zcal.i18n.wed,zcal.i18n.thu,zcal.i18n.fri,zcal.i18n.sat]],zcal.REPEAT_FREQ=[zcal.i18n.daily,zcal.i18n.weekly,zcal.i18n.monthly,zcal.i18n.yearly],zcal.WEEK_TYPE=[zcal.i18n.first,zcal.i18n.second,zcal.i18n.third,zcal.i18n.fourth,zcal.i18n.last],zcal.ALARM_REMTYPE={0:zcal.i18n.before,1:zcal.i18n.after},zcal.ALARM_ACTTYPE={0:zcal.i18n.byemail,1:zcal.i18n.bypopup},zcal.DATEFORMAT=[zcal.i18n.dform1,zcal.i18n.dform2,zcal.i18n.dform3,zcal.i18n.dform4],zcal.TIMEFORMAT=["1:00 "+zcal.i18n.pm,"13:00"],zcal.HOURS=["12:00 "+zcal.i18n.am,"1:00 "+zcal.i18n.am,"2:00 "+zcal.i18n.am,"3:00 "+zcal.i18n.am,"4:00 "+zcal.i18n.am,"5:00 "+zcal.i18n.am,"6:00 "+zcal.i18n.am,"7:00 "+zcal.i18n.am,"8:00 "+zcal.i18n.am,"9:00 "+zcal.i18n.am,"10:00 "+zcal.i18n.am,"11:00 "+zcal.i18n.am,"12:00 "+zcal.i18n.pm,"1:00 "+zcal.i18n.pm,"2:00 "+zcal.i18n.pm,"3:00 "+zcal.i18n.pm,"4:00 "+zcal.i18n.pm,"5:00 "+zcal.i18n.pm,"6:00 "+zcal.i18n.pm,"7:00 "+zcal.i18n.pm,"8:00 "+zcal.i18n.pm,"9:00 "+zcal.i18n.pm,"10:00 "+zcal.i18n.pm,"11:00 "+zcal.i18n.pm],zcal.DEFAULTVIEW=[zcal.i18n.vday,zcal.i18n.week,zcal.i18n.work,zcal.i18n.month,zcal.i18n.agenda],zcal.REMSTR={3e5:"5 "+zcal.i18n.mins,6e5:"10 "+zcal.i18n.mins,9e5:"15 "+zcal.i18n.mins,12e5:"20 "+zcal.i18n.mins,15e5:"25 "+zcal.i18n.mins,18e5:"30 "+zcal.i18n.mins,27e5:"45 "+zcal.i18n.mins,36e5:"1 "+zcal.i18n.hr,72e5:"2 "+zcal.i18n.hrs,144e5:"4 "+zcal.i18n.hrs,216e5:"6 "+zcal.i18n.hrs,288e5:"8 "+zcal.i18n.hrs,432e5:"12 "+zcal.i18n.hrs,864e5:"1 "+zcal.i18n.day,1728e5:"2 "+zcal.i18n.days,2592e5:"3 "+zcal.i18n.days,3456e5:"4 "+zcal.i18n.days,432e6:"5 "+zcal.i18n.days,5184e5:"6 "+zcal.i18n.days,6048e5:"7 "+zcal.i18n.days,6912e5:"8 "+zcal.i18n.days,7776e5:"9 "+zcal.i18n.days,864e6:"10 "+zcal.i18n.days,9504e5:"11 "+zcal.i18n.days,10368e5:"12 "+zcal.i18n.days,11232e5:"13 "+zcal.i18n.days,12096e5:"14 "+zcal.i18n.days,1296e6:"15 "+zcal.i18n.days,2592e6:"30 "+zcal.i18n.days,3888e6:"45 "+zcal.i18n.days,5184e6:"60 "+zcal.i18n.days,7776e6:"90 "+zcal.i18n.days},zcal.AGENDA_INTERVAL={"-1":zcal.i18n.none,0:zcal.i18n.daily,1:zcal.i18n.weekly},zcal.FREEBUSY_DD=[zcal.i18n.alltimes,zcal.i18n.workinghours],zcal.emlNfy=null!=zcal.cdata.orgAdmOpt.MOD_NOTIFY_EMAIL?zcal.cdata.orgAdmOpt.MOD_NOTIFY_EMAIL:"-1",zcal.sendInv=null!=zcal.cdata.orgAdmOpt.SEND_INVITATION?zcal.cdata.orgAdmOpt.SEND_INVITATION:"-1",zcal.subCal=null!=zcal.cdata.orgAdmOpt.CAL_SUBSCRIBE?zcal.cdata.orgAdmOpt.CAL_SUBSCRIBE:"-1",zcal.shrCal=null!=zcal.cdata.orgAdmOpt.CAL_SHARE?zcal.cdata.orgAdmOpt.CAL_SHARE:"-1",zcal.impExp=null!=zcal.cdata.orgAdmOpt.IMPORT_EXPORT?zcal.cdata.orgAdmOpt.IMPORT_EXPORT:"-1",zcal.holCal=null!=zcal.cdata.orgAdmOpt.CAL_HOLIDAY?zcal.cdata.orgAdmOpt.CAL_HOLIDAY:"-1",zcal.pvtUrl=null!=zcal.cdata.orgAdmOpt.PRIVATE_URL?zcal.cdata.orgAdmOpt.PRIVATE_URL:"-1",zcal.workDays=ZCL_setWorkDays(),ZCL_getPOgrpLst(),ZCL_loadOthcal()},timeLineInterval:function(){var t=setInterval(function(){"c"!=zmApp.currentApp&&clearInterval(t);var e=(new Date).getTime();zcal.localTime<e&&(zcal.cdate+=e-zcal.localTime,zcal.localTime=e),new Date(zcal.cdate).dateBy("yyyyMMdd")!=zcal.chkDate.dateBy("yyyyMMdd")&&(zcal.chkDate=new Date(zcal.cdate),zcal.iswms=!1,zcalView.constGridView())},1e4)},updateHeaderBand:function(e,t){var a,l=$("#zcl_headerlbl");if(l.addClass("SC_lbr"),4==zcal.view)l.html(("en"==zmail.user.lang?'<div class="SC_hd"></div>':"")+'<div><div class="zcl_tpdtmth">'+e+'</div><input id="zcl_mini" type="text" style="display:none"></div>');else{l.empty();var c,i=$('<div class="zcl_tprr">'),n=$("<div>"),r=$('<div class="zcl_tplr">');c=$("<span/>"),4!=t&&c.text(zcal.i18n.today),"en"==zmail.user.lang&&l.append('<div class="SC_hd"></div>');zcalView.isTodayInViewRange(t)||c[0].setAttribute("data-tooltip",new Date(zcal.cdate).dateBy("NNN dd, yyyy"));c.off("click").click(function(){zcalView.goToday()}),l.append($('<div class="zcl_tody zcl_tpdyyr"/>').append(c)),r.html('<i class="msi-larrow"></i>'),r.off("click").click(function(e){zcalView.goPrev()}),l.append(r),i.html('<i class="msi-rarrow"></i>'),i.off("click").click(function(e){zcalView.goNext()}),l.append(i),n.append('<div class="zcl_tpdtmth">'+e+'</div><input id="zcl_mini" type="text" style="display:none">'),l.append(n)}l.find("#zcl_mini").click((a=ZEVENTS,l.find("#zcl_mini")[0].value=zcal.today.getDateBy("MM/dd/yyyy"),void a(l.find(".zcl_tpdtmth")[0].parentNode).picker("date",{dform:"MM/DD/YYYY",wkst:0,mode:"popup",update:"no",fullDtclk:1,customdate:"yes",pickerview:3==zcal.view||4==zcal.view?"month":"",range:["01/01/1970","12/31/2100"]}).on("dateclick",function(){var e=this.getDate().getDate(),t=this.getDate().getMonth(),a=this.getDate().getFullYear();4!=zcal.view?zcalView.goDate(e,t,a):zcalAgenda.dispEvents(this.getDate())}).bind()))},formatCalData:e,ZCL_setGrpCal:function(){var e={},t=[],a={},l=zcal.cdata.calByGrp;for(var c in zcal.cdata.grpLst)for(var i in zcal.cdata.grpLst[c])a={id:i,value:zcal.cdata.grpLst[c][i].GNAME},t.push(a);var n=f(t);for(var i in zcal.cdata.gcalbyOdrArr=[],n)zcal.cdata.gcalbyOdrArr.push(n[i].id);for(var c in zcal.groupChild={},zcal.groupCount={},zcal.cdata.gcalbyOdrArr){var r=zcal.cdata.gcalbyOdrArr[c],s=zcal.cdata.grpLst.pgrp[r]||zcal.cdata.grpLst.ogrp[r];if(s&&l[r]){var d=Object.keys(l[r]).length;if(0!=d){if(s.ISADMIN||1<d){zcal.groupCount[r]={c:"0",p:"-1"},e[r]={ID:r,CN:s.GNAME,CC:zcal.calcolor[0][1],STS:"1",HC:"1",E:"1"};var o={},u=[];for(var c in seCount=0,l[r])a={id:c,value:l[r][c][0]},u.push(a);var p=f(u),m=[];for(var i in p)m.push(p[i].id);for(var c in m){var _=m[c];zcal.groupCount[_]={c:"0",p:r};var z=zcal.cdata.calGLst[_];seCount+=1,"1"==z[8]?(o[_]={CN:z[0],CC:ZCL_getCalColor(z[1])[1],ID:c,STS:z[2],HC:0,SE:seCount},0==z[2]?zcal.disabledcal+=_+",":ZCL_CALNAME+=(""==ZCL_CALNAME?"":",")+z[0]):zcal.disabledcal+=_+","}zcal.groupCount["addCal_"+s.GID]={c:"0",p:r},o["addCal_"+s.GID]={CN:"Add Calendar",addNewType:!0,ID:"addCal_"+s.GID,STS:"1",CC:"0",HC:0,SE:seCount+1},zcal.groupChild[r]={CH:o}}else for(var c in l[r]){zcal.groupCount[c]={c:"0",p:"-1"},"1"==(z=zcal.cdata.calGLst[c])[8]?(e[c]={ID:c,CN:z[0],CC:ZCL_getCalColor(z[1])[1],STS:z[2]},0==z[2]?zcal.disabledcal+=c+",":ZCL_CALNAME+=(""==ZCL_CALNAME?"":",")+z[0]):zcal.disabledcal+=c+","}}}}return e},getMonthLimit:function(e){var t,a,l,c=new Date,i=new Date,n=zcal.cdata.opt.WK;return c.setTime(e),i.setTime(e),c.setMonth(c.getMonth()),c.setDate(1),t=c.getDay(),c.setDate(1-c.getDay()),t<n?c.setDate(c.getDate()-(7-n)):c.setDate(c.getDate()+n),l=i.getDaysInMonth(),i.setDate(l),a=i.getDay(),i.setDate(i.getDate()+6-i.getDay()),a<n?i.setDate(i.getDate()-(7-n)):i.setDate(i.getDate()+n),[c,i]},checkDate:function(e){var t=new Date;return t.setTime(e),t.setDate(15),t>=zcal.mlimit[0]&&t<=zcal.mlimit[1]},scrollWidth:function(){var e=document.createElement("div");e.style.overflow="scroll",e.style.width="100%";var t=document.createElement("div");if(t.style.overflow="hidden",t.style.width="100%",e.appendChild(t),document.documentElement.clientHeight){document.documentElement.appendChild(e);var a=e.offsetWidth-t.offsetWidth;return document.documentElement.removeChild(e),a}document.body.appendChild(e);a=e.offsetWidth-t.offsetWidth;return document.body.removeChild(e),a}}}();zcal.dataLoaded=zcal.sentReq=!1,loadZCal=function(t,a){t=t||"calapp",zcal.dataLoaded?ZCL_openApp(t,a):zcal.sentReq||(ZCL_uXHR("/ncal/index.do?mode="+t,function(e){zcal.retLoad(e),ZCL_openApp(t,a)}),zcal.sentReq=!0)},ZCL_openApp=function(e,t){if(zcal.isSubToCalUpd||ZCL_subscribeToCalUpdate(),"event"===e)zcalUtil.createEvent(t);else if("settings"===e)t&&(t.resolve(),zcal.calsettings.status=!1,zcal.calapp&&(zcal.calapp=!1,loadZCal("calapp")));else{if(zmsuite.isWorkspaceAvailable("zcal_Container")){var a=zmsuite.getAppObj("zcal_Container");zmTab.setTabForApp(a.obj),zmsuite.showApp("zcal_Container"),zcal.calLeft.setListener("click",function(e){zcalInit.bindLeftActions(e)}),zcal.calLeft.setListener("contextmenu",function(e){zcalInit.bindLeftActions(e)})}else"c"===zmApp.selectedApp&&zcalInit.initCal();zcal.calapp&&(zcal.calapp=!1),zcal.calsettings&&zcal.calsettings.status&&(zcal.calsettings.status=!1,loadZCal("settings",zcal.calsettings.defobj))}},zcal.retLoad=function(e){var t=JSON.parse(e.responseText);t&&(zcal.dataLoaded=!0,zcal.cdata=t.cdata,5!=zcal.cdata.opt.DEF&&6!=zcal.cdata.opt.DEF||(zcal.cdata.opt.DEF=1),zcal.i18n=t.i18n,zcal.ZCRM_OBJ=zcal.cdata.crmOrgObj,zcal.ZCRM=t.ZCRM,zcal.ZMET=t.ZMET,zcal.ZTSK=t.ZTSK,zcal.ZNTS=t.ZNTS,zcal.ZMIL=t.ZMIL,zcal.ZCAL=t.ZCAL,zcal.ZRECRUIT=t.ZRECRUIT,zcal.ZCAL_MULTICAL_4_GRP=t.ZCAL_MULTICAL_4_GRP,zcal.ZCAL_IsChgownEnable=t.ZCAL_IsChgownEnable,zcal.cssPath=t.CSSPATH,zcal.OUTLOOK32=t.OUTLOOK32,zcal.OUTLOOK64=t.OUTLOOK64,zcal.GCALSYNC=t.GCALSYNC,zcal.ZOHOSTATIC=t.ZOHOSTATIC,zcal.jsPath=t.JSPATH,zcal.imgPath=t.IMGPATH,zcal.TSTAMP=t.TSTAMP,zcal.ZCL_MAXFILESIZE=t.ZCL_MAXFILESIZE,zcalInit.initGlobalVar(),ZCL_setGrpOdr())},zcal.win.onresize=function(){zcal.isWindowResized=!0,"c"==zmApp.currentApp&&ZCL_resizeCalendar()},$.subscribe("/calendar/load",function(){zcal.calapp=!0,zcal.calsettings&&(!zcal.calsettings||zcal.calsettings.status)||loadZCal("calapp")}),$.subscribe("/calendar/serverUp",function(){ZCL_$("zcl_workarea")&&zcalEvents.loadMonthData()}),$.subscribe("/calendar/event",function(e,t){loadZCal("event",t)}),$.subscribe("/calendar/settings",function(e,t){zcal.calsettings={status:!0,defobj:t},zcal.calapp||loadZCal("settings",t)}),ZCL_resizeCalendar=function(){"zcal_Container"==zmTab.currentTab&&4!=zcal.view&&zcalView.constGridView()},$.subscribe("zmsuite/lhsResize",function(){zcal.lhsrhsresize=!0,"zcal_Container"==zmTab.currentTab&&4!=zcal.view&&(zcal.isWindowResized=!0,zcalView.constGridView())}),$.subscribe("/integ/rhs",function(e){zcal.lhsrhsresize=!0,"zcal_Container"==zmTab.currentTab&&4!=zcal.view&&(zcal.isWindowResized=!0,zcalView.constGridView())}),$.subscribe("/apps/tabSwitched",function(e,t,a){if("zcal_Container"==t){var l=(new Date).getTime();zcal.localTime<l&&zcalInit.timeLineInterval(),zcalView.setCurrentTimeLine(zcal.cdate),(zcal.isWindowResized&&4!=zcal.view||zcal.reconstructView||zcal.settingsUpdated||zcal.timezoneupdated||zcal.lhsrhsresize)&&(zcal.lhsrshresize=!1,zcal.isWindowResized=!1,zcal.reconstructView=!1,zcalView.constGridView(),zcal.settingsUpdated&&zcalInit.constructLeft(),zcal.settingsUpdated=!1,zcal.timezoneupdated&&(zcalView.setCurrentTimeLine(zcal.cdate),zcalEvents.loadMonthData()),zmsuite.isWorkspaceAvailable("zcal_eContainer")||(zcal.EMODE=1,zcal.timezoneupdated=!1)),zcal.neweevent&&(zcalView.plotEvents(),zcal.neweevent=!1)}"zcal_eContainer"==t&&zcal.timezoneupdated&&(ZCL_editEve(zcal.EOBJ.EID,e,zcal.EOBJ.CNAME,zcal.EOBJ.EUID),zcal.timezoneupdated=!1)}),$.subscribe("/user/languageChanged",function(){ZCL_handleLanguageChange()}),Date.LZ=function(e){return(e<0||9<e?"":"0")+e},(extendNativeObject=function(e,t,a){if(e&&t&&a){if(!e.prototype[t])try{return e.prototype[t]=a,!0}catch(e){}return!1}})(Date,"getDaysInMonth",function(){var e=new Date(this.getFullYear(),this.getMonth(),1);return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}),extendNativeObject(Date,"clone",function(){var e=new Date;return e.setTime(this.getTime()),e}),extendNativeObject(Date,"getWeek",function(){var e,t,a=new Date(this.getFullYear(),0,1,0,0,0,0);e=a.getDay(),a.setDate(a.getDate()-a.getDay());var l=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0,0);return l.setDate(l.getDate()-l.getDay()),t=e<=4?Math.ceil((l-a)/864e5/7)+1:Math.ceil((l-a)/864e5/7),11==l.getMonth()&&(l.setDate(l.getDate()+6),t=0==l.getMonth()&&2<l.getDate()?1:t),t}),extendNativeObject(Date,"dateBy",function(e){e+="";var t="",a=0,l="",c="",i=this.getYear()+"",n=this.getMonth()+1,r=this.getDate(),s=this.getDay(),d=this.getHours(),o=this.getMinutes(),u=this.getSeconds(),p={};for(i.length<4&&(i=""+(+i+1900)),p.y=""+i,p.yyyy=i,p.yy=i.substring(2,4),p.M=n,p.MM=Date.LZ(n),p.MMM=Date.MONTH_NAMES[0][n-1],p.NNN=Date.MONTH_NAMES[1][n-1],p.d=r,p.dd=Date.LZ(r),p.E=Date.WEEK_DAYS[1][s],p.EE=Date.WEEK_DAYS[0][s],p.H=d,p.HH=Date.LZ(d),p.h=0==d?12:12<d?d-12:d,p.hh=Date.LZ(p.h),p.K=p.h-1,p.k=p.H+1,p.KK=Date.LZ(p.K),p.kk=Date.LZ(p.k),p.a=11<d?"pm":"am",p.m=o,p.mm=Date.LZ(o),p.s=u,p.ss=Date.LZ(u);a<e.length;){for(l=e.charAt(a),c="";e.charAt(a)==l&&a<e.length;)c+=e.charAt(a++);null!=p[c]?t+=p[c]:t+=c}return t});var zcalList={bindAction:function(l){if(l){var e=l.action;switch(e){case"edit":zmUtil.hideMenu(),zmAppLoader.load("zm-settings-mailsuite-appcore").then(function(){zmail.Settings.MailSuite.App.openApp().then(function(){setTimeout(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage("calendar-mgaocalendars").then(function(){var a=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;e.requestPreviewCard({getView:function(){var e=zcal.cdata.calLst[l.id]||zcal.cdata.calGLst[l.id]||zcal.cdata.calOLst[l.id]||zcal.cdata.calALst[l.id],t="my";return"group"==e[14]?(t="groups",a.groupCalendarView()):"ztask"!=e[14]&&"crm"!=e[14]&&"zprojects"!=e[14]&&"zcontacts"!=e[14]||(a.appCalendarView(),t="apps"),a.openDetail(l.id,e,t)}}).then(function(e){e.card.show()})}).fail(function(){})},100)})});break;case"share":zmUtil.hideMenu(),void 0===zmail._newSettings?zmAppLoader.load("zm-settings-mailsuite-appcore").then(function(){zmail.Settings.MailSuite.App.openApp().then(function(){setTimeout(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage("calendar-mgaocalendars").then(function(){var a=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;e.requestPreviewCard({getView:function(){var e=zcal.cdata.calLst[l.id]||zcal.cdata.calGLst[l.id]||zcal.cdata.calOLst[l.id],t="my";return"group"==e[14]?(t="groups",a.groupCalendarView()):"ztask"!=e[14]&&"crm"!=e[14]&&"zprojects"!=e[14]&&"zcontacts"!=e[14]||(a.appCalendarView(),t="apps"),a.openShare(l.id,e,t)}}).then(function(e){e.card.show()})}).fail(function(){})},100)})}):zmAppLoader.load("settings").then(function(){zmailSettings.init("calendar","zcalSettings."+l.type+"CalList",l)});break;case"embed":zmUtil.hideMenu(),void 0===zmail._newSettings?zmAppLoader.load("zm-settings-mailsuite-appcore").done(function(){zmail.Settings.MailSuite.App.openApp().done(function(){setTimeout(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage("calendar-mgaocalendars").done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;e.requestPreviewCard({getView:function(){var e=zcal.cdata.calLst[l.id]||zcal.cdata.calGLst[l.id]||zcal.cdata.calOLst[l.id],t="my";return"group"==e[14]?(t="groups",a.groupCalendarView()):"ztask"!=e[14]&&"crm"!=e[14]&&"zprojects"!=e[14]&&"zcontacts"!=e[14]||(a.appCalendarView(),t="apps"),a.openEmbed(l.id,e,t)}}).done(function(e){e.card.show()})}).fail(function(){})},100)})}):zmAppLoader.load("settings").then(function(){ZCL_openEmbed(l.id)});break;case"member":zmUtil.hideMenu(),zmAppLoader.load("zm-settings-mailsuite-appcore").done(function(){zmail.Settings.MailSuite.App.openApp().done(function(){setTimeout(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage("calendar-mgaocalendars").done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;e.requestPreviewCard({getView:function(){var e=zcal.cdata.calLst[l.id]||zcal.cdata.calGLst[l.id]||zcal.cdata.calOLst[l.id],t="my";return"group"==e[14]?(t="groups",a.groupCalendarView()):"ztask"!=e[14]&&"crm"!=e[14]&&"zprojects"!=e[14]&&"zcontacts"!=e[14]||(a.appCalendarView(),t="apps"),a.openGrpMem(l.id,e,t)}}).done(function(e){e.card.show()})}).fail(function(){})},100)})});break;case"empty":ZCL_empCal(l.id),zmUtil.hideMenu();break;case"delete":case"unsubscribe":var t="unsubscribe"===e;ZCL_delCal(l.id,t),zmUtil.hideMenu();break;case"hide":ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+l.id+"&isshow="+!1,function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status?(zcal.cdata.calGLst[l.id][8]=t.isshow?1:0,$.publish("/calendar/visibilityChanged",{calid:l.id,visibility:t.isshow}),zmUtil.succErrMsg("s",zcal.i18n.off_msg),zmUtil.hideMenu()):zmUtil.succErrMsg("e",t.message)});break;case"closePrev":ZCL_eClose();break;case"create-cal":zcal.createCal();break;case"import":case"subscribe":case"settings":break;case"eventSave":ZCL_svEve();break;case"crmEventSave":zcalCRM.saveEvent();break;case"taskSave":zcalTask.saveTask();break;case"eventDelete":ZCL_delEve();break;case"eventEdit":var a=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_eid")[0].value;ZCL_Dedit(a);break;case"eventClose":zcalCRM.reset(),ZCL_eClose();break;case"eventSend":a=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],ZCL_send(zcal.EOBJ[a]);break;case"startChat":a=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],ZCL_chatLet(event,zcal.EOBJ[a]);break;case"setEventAlarm":ZCL_setEventAlarm();break;case"print":zmUtil.hideMenu(),ZCL_print();break;case"printPreview":zmUtil.hideMenu(),ZCL_prntPreview(!1);break;case"savePdf":zmUtil.hideMenu(),ZCL_svPdf();break;case"eventStreamView":zcal.constEventViewCard()}}},calUtility:function(e,t,a,l){var c;for(var i in ZCL_stopEvents(e),l)c=i;zcalList.leftUtility(e,t,a,c)},leftUtility:function(e,t,a,l){t.id;var c,i=zcal.getCalObj(l);if(i){var n=[];n.push({htm:zcal.i18n.edit,id:"zcalMenu_Edit",cEdit:!1,data:{action:"edit",id:l}}),"group"==i[14]&&(n.push({sep:!0}),n.push({htm:zcal.i18n.members,id:"zcalMenu_Mem",cEdit:!1,data:{action:"member",id:l}})),0!=i[13][0]&&(n.push({sep:!0}),n.push({htm:zcal.i18n.share,id:"zcalMenu_Share",cEdit:!1,data:{action:"share",id:l}})),0!=i[13][0]&&(n.push({sep:!0}),n.push({htm:zcal.i18n.embed,id:"zcalMenu_Embed",cEdit:!1,data:{action:"embed",id:l}})),1==i[13][3]&&(n.push({sep:!0}),n.push({htm:zcal.i18n.empty,id:"zcalMenu_Empty",cEdit:!1,data:{action:"empty",id:l}})),""==i[14]&&1==i[13][4]&&(n.push({sep:!0}),n.push({htm:zcal.i18n.del,id:"zcalMenu_Del",cEdit:!1,data:{action:"delete",id:l}})),"group"==i[14]&&(n.push({sep:!0}),n.push({htm:zcal.i18n.hide,id:"zcalMenu_Hide",cEdit:!1,data:{action:"hide",id:l}})),1==i[13][5]&&"group"!=i[14]&&(n.push({sep:!0}),n.push({htm:zcal.i18n.unsubscribe,id:"zcalMenu_UnSub",cEdit:!1,data:{action:"unsubscribe",id:l}})),c={clk:function(e,t){zcalList.bindAction(t)},conArr:n},zmsuite.showContextMenu(e,c),ZCL_stopEvents(e)}},chgeCalStatus:function(e,t){var a;for(var l in ZCL_stopEvents(e),t)a=l;a&&ZCL_ChgCalSts(a)}},zcalView=function(){function t(){return zcal.calCenter=zcal.calCenter||zmsuite.getCenter(),zcal.calCenter.listElem=zcal.calCenter[0].getNodes()[2].$el[0],zcal.calCenter.headerElem=zcal.calCenter[0].getNodes()[0].$el[0],zcal.calCenter}function o(e,t){e.addEventListener("mousedown",function(e){zcalView.setView(0,t.getFullYear(),t.getMonth(),t.getDate())})}return{hourSlot:2,slotDuration:30,gridWidth:0,gridHeight:0,timeoutID:null,change:function(e){zcal.view=e,this.constGridView()},constGridView:function(){if(zmsuite.appLoadingBand&&zmsuite.appLoadingBand.resolve(),"zcal_Container"!=zmTab.currentTab)return zcal.iswms=!1;var e=zcal.iswms?1:"";zcal.iswms=!1,0!=zcal.view&&1!=zcal.view&&2!=zcal.view||ZCL_$("zcl_eveSub")||(e=""),ZCL_clrStck1("",e),this.gridWidth=$(t().listElem).width()-81-zcalInit.scrollWidth(),this.gridHeight=$(t().listElem).height()-33-1,e?this.gridWidth<=0?zcal.reconstructView=!0:4==zcal.view?zcalView.agendaView():zcalView.plotEvents(e):this.gridWidth<=0?zcal.reconstructView=!0:0==zcal.view?(zcalView.constDayView(),ZCL_$("zcl_encloser").scrollTop=51*zcal.cdata.opt.HS):1==zcal.view||2==zcal.view?(zcalView.constWeekView(),ZCL_$("zcl_encloser").scrollTop=51*zcal.cdata.opt.HS):3==zcal.view?zcalView.constMonthView():4==zcal.view&&zcalView.agendaView()},templates:{day:["DIV",{attrs:{class:"zcl zcl_dayvw",id:"zcl_workarea"},child:[["UL",{child:[["LI",{child:[["DIV",{attrs:{class:"zcl_table",id:"zcl_vwheader"}}]]}],["LI",{child:[["DIV",{attrs:{class:"zcl_rel",id:"zcl_aencloser"},child:[["DIV",{attrs:{class:"zcl_alldycn zcl_table"},child:[["UL",{attrs:{class:"zcl_alldyev"},child:[["LI",{attrs:{class:"zcl_lfsec",id:"zcl_lftsec"}}],["LI",{attrs:{class:"zcl_scrly"},child:[["DIV",{attrs:{id:"zcl_aContainer",class:"zcl_rel",style:"height:36px"},child:[["DIV",{attrs:{class:"zcl_adyevecn",id:"zcl_allLay"}}],["DIV",{attrs:{class:"zcl_table",id:"zcl_allgrid"}}]]}]]}]]}]]}]]}],["DIV",{attrs:{class:"zcl_scrly zcl_rel",id:"zcl_encloser"},child:[["DIV",{attrs:{class:"zcl_esub",id:"zcl_eveSub"}}],["DIV",{attrs:{class:"zcl_wgrdsl",id:"zcl_lay",style:"display:none;height:22px"}}],["UL",{attrs:{class:"zcl_grid"},child:[["LI",{child:[["DIV",{attrs:{class:"zcl_table",id:"zcl_hContainer"}}]]}]]}]]}]]}]]}]]}],week:["DIV",{attrs:{class:"zcl zcl_weekvw",id:"zcl_workarea"},child:[["UL",{child:[["LI",{child:[["DIV",{attrs:{class:"zcl_table",id:"zcl_vwheader"}}]]}],["LI",{child:[["DIV",{attrs:{class:"zcl_rel",id:"zcl_aencloser"},child:[["DIV",{attrs:{class:"zcl_alldycn zcl_table"},child:[["UL",{attrs:{class:"zcl_alldyev"},child:[["LI",{attrs:{class:"zcl_lfsec",id:"zcl_lftsec"}}],["LI",{attrs:{class:"zcl_scrly"},child:[["DIV",{attrs:{id:"zcl_aContainer",class:"zcl_rel",style:"height:36px"},child:[["DIV",{attrs:{class:"zcl_adyevecn",id:"zcl_allLay"}}],["DIV",{attrs:{class:"zcl_table",id:"zcl_allgrid"}}]]}]]}]]}]]}]]}],["DIV",{attrs:{class:"zcl_scrly zcl_rel",id:"zcl_encloser"},child:[["DIV",{attrs:{class:"zcl_esub",id:"zcl_eveSub"}}],["DIV",{attrs:{class:"zcl_wgrdsl",id:"zcl_lay",style:"display:none;height:22px"}}],["UL",{attrs:{class:"zcl_grid"},child:[["LI",{child:[["DIV",{attrs:{class:"zcl_table",id:"zcl_hContainer"}}]]}]]}]]}]]}]]}]]}],month:["DIV",{attrs:{class:"zcl zcl_monthvw",id:"zcl_workarea"},child:[["UL",{child:[["LI",{child:[["DIV",{attrs:{class:"zcl_table",id:"zcl_vwheader"},child:[["UL",{attrs:{class:"zcl_dylst"}}]]}]]}],["LI",{attrs:{class:"zcl_grid"},child:[["DIV",{attrs:{id:"zcl_encloser",class:"zcl_table"}}]]}]]}]]}],agenda:[]},constDOM:function(e){return _zm.getDOM(this.templates[e])},getHeaderDOM:function(e,t,a){var l,c,i,n=new Date;if(n.setTime(zcal.cdate),l=_zm.getDOM(["UL",{attrs:{class:"zcl_dylst"}}]),(c=document.createElement("UL")).id="zcl_adaygrid",0!=zcal.view){var r=document.createElement("LI");r.className="zcl_lfsec",l.appendChild(r)}for(var s=0;s<=e;s++){var d=zcalMulti.retdate(t.dateBy("yyyyMMdd"),s);i=document.createElement("li"),n.dateBy("yyyyMMdd")==d.dateBy("yyyyMMdd")?zcal.today=d.clone():0==s&&(zcal.today=d.clone()),i.innerHTML=(d.getDay()==zcal.cdata.opt.WK?"<b>"+d.getWeek()+"</b>":"")+'<span><span class="'+(n.dateBy("yyyyMMdd")==d.dateBy("yyyyMMdd")?"zmThmBG":"")+'">'+d.getDate()+"</span>"+d.dateBy(a)+"</span>",i.setAttribute("rel",d.dateBy("yyyyMMdd")),o(i,d),l.appendChild(i),c.appendChild($('<li id="zcl_a'+s+'"></li>')[0])}return[l,c]},getHrDOM:function(e,t,a){var l=$("<li><b></b><u></u></li>");return l.addClass(a),l.off("mousedown").on("mousedown",{dayno:e,hr:t},function(e){zcalDrag.dstartDiv(e,e.data.dayno,e.data.hr)}),l},findTimeLineLeft:function(e){for(var t=5,a=1;a<e;a++)t+=ZCL_getEleWdt("zcl_a"+a);return t},setCurrentTimeLine:function(e){if(zcalView.timeoutID&&window.clearTimeout(zcalView.timeoutID),0<$(".zcl_crday").length&&0<=zcal.view&&zcal.view<=2){var t,a,l,c=e?new Date(e):new Date(zcal.cdate),i=c.getHours(),n=c.getMinutes(),r=c.getSeconds(),s=$(".zcl_crday")[0].getBoundingClientRect().height,d=$(".zcl_crday")[0].getBoundingClientRect().width,o=ZCL_timeInUFormat(c.dateBy("HHmm"));l=zcalView.findTimeLineLeft($($(".zcl_crday")[0]).index()),ZCL_$("zcl_timeline")||$("#zcl_encloser").append("<div class='zcl_tiln' id='zcl_timeline'/>"),(t=$("#zcl_timeline")).html('<span/><div style="width:'+d+"px;left:"+l+'px"></div>'),ZCL_tooltip({elm:t.find("span")[0],text:o,arrow:"top"}),a=0<(a=i*s+n*(s/60))?a-1:0,t.attr("style","top:"+a+"px"),zcalView.timeoutID=setTimeout(zcalView.setCurrentTimeLine,1e3*(60-r))}else $("#zcl_timeline").remove()},constHrDOM:function(e,t,a){var l="",c=parseInt(zcal.cdata.opt.HS),i=parseInt(zcal.cdata.opt.HE),n=zcal.workDays;0==zcal.cdata.opt.TF?(l+=0==a?12:12<a?a-12:a,l+="&nbsp;"+(11<a?"pm":"am")):l+=(a<=9?"0"+a:a)+":00";for(var r=$('<ul><li class="zcl_lfsec">'+l+"</li></ul>"),s=0;s<=e;s++){var d=zcalMulti.retdate(t.dateBy("yyyyMMdd"),s),o="";d.dateBy("yyyyMMdd")==new Date(zcal.cdate).dateBy("yyyyMMdd")&&c<=a&&a<i?o="zcl_crday":-1==n.indexOf(d.getDay())?o="zcl_wend":(a<c||i<=a)&&(o="zcl_nwhr"),r.append(zcalView.getHrDOM(s,a,o))}return r[0]},constDayView:function(){var e,t,a,l,c,i=zcal.calCenter.listElem;i.innerHTML="",zcalInit.updateHeaderBand(zcal.today.dateBy("NNN dd, yyyy"),zcal.view),(l=this.constDOM("day")).style.height=i.getBoundingClientRect().height+"px",(e=l.querySelector("#zcl_vwheader")).style.width=this.gridWidth+81+"px";var n=this.getHeaderDOM(0,zcal.today," EE");e.appendChild(n[0]),(t=l.querySelector("#zcl_allgrid")).style.width=this.gridWidth+"px",t.appendChild(n[1]),a=l.querySelector("#zcl_hContainer");for(var r=0;r<24;r++){var s=this.constHrDOM(0,zcal.today,r);a.appendChild(s)}l.addEventListener("contextmenu",function(e){ZCL_stopEvents(e)}),i.appendChild(l),(c=l.querySelector("#zcl_lftsec")).className="zcl_lfsec zcl_til_tz";var d=document.createElement("span");d.className="zcl_grey",d.style.cursor="pointer",d.innerHTML=zcal.cdata.opt.TZ_OFFSET,c.appendChild(d),$("#zcl_lftsec").on({click:function(){zmAppLoader.load("zm-settings-mailsuite-appcore").then(function(){zmail.Settings.MailSuite.App.openApp().then(function(){setTimeout(function(){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage("calendar-generals").then(function(){zmail.Settings.MailSuite.Apps.CalendarGenerals.CalendarGeneralView}).fail(function(){})},100)})})}}),$("#zcl_allLay").on({scroll:function(){var e=$(this).scrollTop();e!=zcal.alldayScrollTop&&(zcal.alldayScrollTop=e,ZCL_clrStck1())},mousedown:function(e){zcal.qkAllday(e,$(this)[0],"all")}}),$("#zcl_encloser").on({scroll:function(){var e=$(this).scrollTop();e!=zcal.hrgridScrollTop&&(zcal.hrgridScrollTop=e,ZCL_clrStck1(),zmUtil.hideMenu())}}),0<$(".zcl_crday").length&&zcalView.setCurrentTimeLine(),zcalView.dispEvents()},constWeekView:function(){var e=1==zcal.view?zcal.cdata.opt.WK:2==zcal.view?zcal.cdata.opt.WS:0;e=parseInt(e,10);var t=1==zcal.view?6+zcal.cdata.opt.WK:2==zcal.view?zcal.cdata.opt.WE:0;t=parseInt(t,10);var a=new Date;a.setTime(zcal.today.getTime());var l=1==zcal.view&&a.getDay()<e?-7:0,c=t<e?7-(e-t):t-e;a.setDate(a.getDate()-a.getDay()+e+l);var i=a.getTime(),n=a.clone(),r="";n.setDate(n.getDate()+c),r=a.getFullYear()===n.getFullYear()?a.getMonth()===n.getMonth()?a.dateBy("NNN dd")+" - "+n.dateBy("dd, yyyy"):a.dateBy("NNN dd")+" - "+n.dateBy("NNN dd, yyyy"):a.dateBy("NNN dd, yyyy")+" - "+n.dateBy("NNN dd, yyyy");var s,d,o,u,p,m,_=zcal.calCenter.listElem;zcal.cdata.opt.DF;_.innerHTML="",zcalInit.updateHeaderBand(r,zcal.view),(m=new Date).setTime(i),(u=this.constDOM("week")).style.height=_.getBoundingClientRect().height+"px",(s=u.querySelector("#zcl_vwheader")).style.width=this.gridWidth+81+"px",d=u.querySelector("#zcl_allgrid");var z=this.getHeaderDOM(c,m," E");s.appendChild(z[0]),d.style.width=this.gridWidth+"px",d.appendChild(z[1]),o=u.querySelector("#zcl_hContainer");for(var f=0;f<24;f++){var v=this.constHrDOM(c,m,f);o.appendChild(v)}u.addEventListener("contextmenu",function(e){ZCL_stopEvents(e)}),_.appendChild(u),(p=u.querySelector("#zcl_lftsec")).className="zcl_lfsec zcl_til_tz";var h=document.createElement("span");h.className="zcl_grey",h.style.cursor="pointer",h.innerHTML=zcal.cdata.opt.TZ_OFFSET,p.appendChild(h),$("#zcl_lftsec").on({click:function(){zmAppLoader.load("zm-settings-mailsuite-appcore").then(function(){zmail.Settings.MailSuite.App.openApp().then(function(){setTimeout(function(){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage("calendar-generals").then(function(){zmail.Settings.MailSuite.Apps.CalendarGenerals.CalendarGeneralView}).fail(function(){})},100)})})}}),$("#zcl_allLay").on({scroll:function(){var e=$(this).scrollTop();e!=zcal.alldayScrollTop&&(zcal.alldayScrollTop=e,ZCL_clrStck1())},mousedown:function(e){zcal.qkAllday(e,$(this)[0],"all")}}),$("#zcl_encloser").on({scroll:function(){var e=$(this).scrollTop();e!=zcal.hrgridScrollTop&&(zcal.hrgridScrollTop=e,ZCL_clrStck1(),zmUtil.hideMenu())}}),0<$(".zcl_crday").length&&zcalView.setCurrentTimeLine(),zcalView.dispEvents()},monthHeaderDOM:function(t){var e=document.createElement("LI");return e.innerHTML="<span>"+t.dateBy("E")+"</span>",e.addEventListener("mousedown",function(e){zcalView.setView(0,t.getFullYear(),t.getMonth(),t.getDate())}),e},constMonthView:function(e){var t,a,l,c,i=zcal.cdata.opt.WK,n=0,r=zcal.workDays,s=zcal.mlimit[0].clone(),d=zcal.calCenter.listElem;e||(d.innerHTML=""),t=((zcal.mlimit[1]-zcal.mlimit[0])/864e5+1)/7;var o,u,p=zcal.mlimit[0].clone();if(p.setDate(p.getDate()+15),zcalInit.updateHeaderBand(p.dateBy("NNN yyyy"),zcal.view),c=e?d.querySelector("div[id=zcl_workarea]"):this.constDOM("month"),!e){c.style.height=d.getBoundingClientRect().height+"px",a=c.querySelector("#zcl_vwheader");var m=new Date;m.setDate(m.getDate()-m.getDay()),m.setDate(m.getDate()+i);for(var _=0;_<7;_++)a.children[0].appendChild(zcalView.monthHeaderDOM(m)),m.setDate(m.getDate()+1);l=c.querySelector("#zcl_encloser"),d.appendChild(c),1===ZCL_MONTHMODE&&(l.style.width=ZCL_getEleWdt(l)-zcalInit.scrollWidth()+"px"),l.parentNode.style.height=this.gridHeight+"px";for(var z=0;z<t;z++){var f=document.createElement("UL");f.id="zcl_row"+z;for(var v=0;v<7;v++){var h,g,C="";s.getDay(),s.dateBy("NNN yyyy");s.dateBy("yyyyMMdd")==new Date(zcal.cdate).dateBy("yyyyMMdd")?(C="zcl_crday",a.children[0].children[v].className="zcl_sl"):-1==r.indexOf(s.getDay())?C="zcl_wend":s.dateBy("yyyyMM")!=p.dateBy("yyyyMM")&&(C="zcl_wend"),h=$('<li id="zcl_mbx'+n+'" class="'+C+'"/>'),g='<div id="zcl_lft'+n+'">'+(s.getDay()==zcal.cdata.opt.WK?"<b>"+s.getWeek()+"</b>":"")+'<span class="'+(s.dateBy("yyyyMMdd")==new Date(zcal.cdate).dateBy("yyyyMMdd")?"zmThmBG":"")+'">'+s.getDate()+'</span></div><div id="zcl_lay'+n+'" class="zcl_mgrdsl" style="display:none"></div>',h.html(g),o=n,u=s,h.off("mousedown").on("mousedown",{cnt:o,date:u.getDate(),month:u.getMonth(),year:u.getFullYear()},function(e){var t=e.target||event.srcElement;"SPAN"==t.tagName&&t.parentNode.id=="zcl_lft"+e.data.cnt?zcalView.setView(0,e.data.year,e.data.month,e.data.date):zcalDrag.mstartDiv(e,e.data.cnt)}),f.appendChild(h[0]),n++,s.setDate(s.getDate()+1)}l.appendChild(f)}c.addEventListener("contextmenu",function(e){ZCL_stopEvents(e)}),ZCL_NOB=n,zcal.mcell_width=$("#zcl_mbx0").width();for(z=0;z<t;z++)l.children[z].style.height=l.children[z].offsetHeight+"px"}zcalView.dispEvents(e)},constMonthPrintView:function(){var e,t,a,l,c=zcal.cdata.opt.WK,i=0,n=zcal.workDays,r=zcal.mlimit[0].clone();e=((zcal.mlimit[1]-zcal.mlimit[0])/864e5+1)/7;var s=zcal.mlimit[0].clone();s.setDate(s.getDate()+15),t=(l=this.constDOM("month")).querySelector("#zcl_vwheader");var d=new Date;d.setDate(d.getDate()-d.getDay()),d.setDate(d.getDate()+c);for(var o=0;o<7;o++)t.children[0].appendChild(zcalView.monthHeaderDOM(d)),d.setDate(d.getDate()+1);a=l.querySelector("#zcl_encloser"),1===ZCL_MONTHMODE&&(a.style.width=ZCL_getEleWdt(a)-zcalInit.scrollWidth()+"px");for(var u=0;u<e;u++){var p=document.createElement("UL");p.id="zcl_pm_r"+u;for(var m=0;m<7;m++){var _="";r.getDay(),r.dateBy("NNN yyyy");r.dateBy("yyyyMMdd")==new Date(zcal.cdate).dateBy("yyyyMMdd")?(_="zcl_crday",t.children[0].children[m].className="zcl_sl"):-1==n.indexOf(r.getDay())?_="zcl_wend":r.dateBy("yyyyMM")!=s.dateBy("yyyyMM")&&(_="zcl_wend");var z=$('<li id="zcl_pm'+i+'" class="'+_+'"/>'),f='<div id="zcl_lft'+i+'">'+(r.getDay()==zcal.cdata.opt.WK?"<b>"+r.getWeek()+"</b>":"")+"<span>"+r.getDate()+"</span></div>";z.html(f),p.appendChild(z[0]),i++,r.setDate(r.getDate()+1)}a.appendChild(p)}return l},agendaView:function(){$(zcal.calCenter.listElem).html('<div class="zcl zcl_agendavw" id="zcl_workarea"><ul id="zcl_encloser" class="zcl_frmbg"><li><ul id="zcl_agnlst" class="zcl_agnlst"></ul></li></ul></div>'),zcalInit.updateHeaderBand(zcal.today.dateBy("NNN dd, yyyy"),zcal.view),zcalView.dispEvents()},weekNoText:function(e){var t=e.getWeek(),a=t%10;return t=1==a&&11!=t?ZCL_replaceString(zcal.i18n.weekno1,[t]):2==a&&12!=t?ZCL_replaceString(zcal.i18n.weekno2,[t]):3==a&&13!=t?ZCL_replaceString(zcal.i18n.weekno3,[t]):ZCL_replaceString(zcal.i18n.weekno4,[t])},plotEvents:function(e){null==zcal.calCenter||zcal.calCenter&&zcal.calCenter.listElem.getBoundingClientRect().height<=0?zcal.reconstructView=!0:0==zcal.view||1==zcal.view||2==zcal.view?zcalView.dEvents(e):3==zcal.view&&(!e&&ZCL_$("zcl_encloser")&&(ZCL_$("zcl_encloser").innerHTML=""),zcalView.constMonthView(e))},dispEvents:function(e){zcal.gridleft=ZCL_findPosXX(ZCL_$("zcl_encloser")),4==zcal.view?zcalAgenda.dispEvents():3==zcal.view?zcalView.mEvents(e):zcalView.dEvents(e)},mEvents:function(e){ZCL_clrStck1("",e);var t,a=zcal.mlimit[0].clone(),l=0;for(ZCL_PRINTDATA=[];a<zcal.mlimit[1];){var c=zcalMulti.split([a.dateBy("yyyyMMdd"),6]);zcalMonth.render(c,a.dateBy("yyyyMMdd"),7,l),ZCL_PRINTDATA[l]=ZCL_Evl(1,zcalMulti.duplicate(c)),a.setDate(a.getDate()+7),l++}t=$("#zcl_encloser").parent(),1===ZCL_MONTHMODE&&t.css({"overflow-y":"scroll","overflow-x":"hidden"})},dEvents:function(e){if(ZCL_clrStck1("",e),ZCL_$("zcl_eveSub")){ZCL_$("zcl_eveSub").innerHTML="";var t=1==zcal.view?zcal.cdata.opt.WK:2==zcal.view?zcal.cdata.opt.WS:0;t=parseInt(t,10);var a=1==zcal.view?6+zcal.cdata.opt.WK:2==zcal.view?zcal.cdata.opt.WE:0;a=parseInt(a,10);var l=new Date;l.setTime(zcal.today.getTime());var c=1==zcal.view&&l.getDay()<t?-7:0,i=a<t?7-(t-a):a-t;0!=zcal.view&&l.setDate(l.getDate()-l.getDay()+t+c);for(var n=l.getTime(),r=ZCL_getEleWdt("zcl_lftsec"),s=0;s<=i;s++){var d=new Date;d.setTime(n),d.setDate(d.getDate()+s);var o=d.dateBy("yyyyMMdd"),u=ZCL_getEleWdt("zcl_a"+s);0!=s&&(r+=u),zcal.cdata.evelst&&zcalEvents.renderDayView(zcal.cdata.evelst[o],o,r,u,s)}var p=zcalMulti.split([l.dateBy("yyyyMMdd"),i]);zcalAday.render(p,l.dateBy("yyyyMMdd"),i)}},isTodayInViewRange:function(e){if(0==e)return zcal.today.dateBy("yyyyMMdd")===new Date(zcal.cdate).dateBy("yyyyMMdd");if(1==e||2==e){var t=1==zcal.view?zcal.cdata.opt.WK:2==zcal.view?zcal.cdata.opt.WS:0;t=parseInt(t,10);var a=1==zcal.view?6+zcal.cdata.opt.WK:2==zcal.view?zcal.cdata.opt.WE:0;a=parseInt(a,10);var l=new Date;l.setTime(zcal.today.getTime());var c=1==zcal.view&&l.getDay()<t?-7:0,i=a<t?7-(t-a):a-t;l.setDate(l.getDate()-l.getDay()+t+c);var n=new Date;n.setTime(zcal.cdate);for(var r=0;r<=i;r++){var s=zcalMulti.retdate(l.dateBy("yyyyMMdd"),r);if(n.dateBy("yyyyMMdd")==s.dateBy("yyyyMMdd"))return!0}}else if(3==e)return zcal.today.dateBy("yyyyMM")===new Date(zcal.cdate).dateBy("yyyyMM");return!1},setView:function(e,t,a,l){zcal.view=e;var c=new Date(t,a,l);if(zcal.today=c.clone(),$("#zcl_view")){var i=$("#zcl_view");i.find("DIV").removeClass("zcl_sl"),i.find("DIV:first").addClass("zcl_sl")}zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))},goPrev:function(){0==zcal.view?zcal.today.setDate(zcal.today.getDate()-1):1==zcal.view||2==zcal.view?zcal.today.setDate(zcal.today.getDate()-7):3==zcal.view&&(zcal.today.setDate(1),zcal.today.setMonth(zcal.today.getMonth()-1)),zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))},goNext:function(){0==zcal.view?zcal.today.setDate(zcal.today.getDate()+1):1==zcal.view||2==zcal.view?zcal.today.setDate(zcal.today.getDate()+7):3==zcal.view&&(zcal.today.setDate(1),zcal.today.setMonth(zcal.today.getMonth()+1)),zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))},goToday:function(){zcal.today.setTime(zcal.cdate),zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))},goDate:function(e,t,a){0==zcal.view||1==zcal.view||2==zcal.view?(zcal.today.setDate(e),zcal.today.setMonth(t),zcal.today.setYear(a)):3==zcal.view&&(zcal.today.setDate(1),zcal.today.setMonth(t),zcal.today.setYear(a)),zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))}}}(),zcalAgenda=function(){var d,i,E={},e=[],t=function(){d=zcal.today.clone(),i=a(d)},a=function(e){var t=e.clone();return t.setDate(1),dateEd=t.clone(),dateEd.setMonth(t.getMonth()+3),dateEd.setDate(dateEd.getDate()-1),[t,dateEd]},o=function(){var e=ZCL_$("zcl_agnlst");$(e).empty();for(var t,a,l=i[0].clone();l<i[1];){if(t=l.getFullYear()+"_"+Math.floor(l.getMonth()/3),E[t]&&(a=l.dateBy("yyyyMMdd"),E[t][0][a]||E[t][1][a])){var c=[];E[t][1][a]&&(c=c.concat(E[t][1][a])),E[t][0][a]&&(c=c.concat(E[t][0][a])),0<c.length&&n(l,c)}l.setDate(l.getDate()+1)}0==e.children.length?$("#zcl_agnmsg").text(ZCL_replaceString(zcal.i18n.agenda_noevents,[i[1].dateBy("dd/MM/yyyy")])):$("#zcl_agnmsg").text(ZCL_replaceString(zcal.i18n.agenda_dispevents,[i[1].dateBy("dd/MM/yyyy")]))},n=function(e,t){var a=ZCL_$("zcl_agnlst");D(t);for(var l=zcalCRM.getCRMColorCode(),c=0;c<t.length;c++){var i=!1,n=0,r=null,s={},d=t[c];if(!d.EMTY){if(s.ET=d.ET,s.ST=d.ST,d.DUP){n=d.RIDX?d.RIDX:"0",r=d.REPINST?d.REPINST:null;var o=d.ST,u=d.ET;if((d=E[d.DUP[0]][d.AIDX][d.DUP[1]][d.DUP[2]]).EMTY)continue;0==d.ADAY?("0000"==o&&"2400"==d.et&&(i=!0),s.ET=u,s.ST=o):i=!0}else"1"==d.ADAY&&(i=!0);var p=d.ORG,m=ZCL_parseDateStr(d.SD),_=parseInt(s.ST.substring(0,2),10),z=parseInt(s.ST.substring(2,4),10);m.setHours(_,z,0,0);var f=ZCL_parseDateStr(d.ED),v=parseInt(s.ET.substring(0,2),10),h=parseInt(s.ET.substring(2,4),10);f.setHours(v,h,0,0);var g=zcal.getCalObj(d.CNAME);if(!g)continue;var C=g[1].split(":"),y=ZCL_getCalColor(C[0]),L=d.CNAME;if("crm"==g[14]&&l?l[p]?sts=0!=l[p][2]:l.OTHERS&&(sts=0!=l.OTHERS[2]):sts=-1==zcal.disabledcal.indexOf(L),sts&&g&&1==g[2]&&1==g[8]){var b=$('<li><div class="zcl_table"><ul><li class="zcl_w70"><ul class="zcl_agdate"><li>'+e.dateBy("E")+"</li><li>"+e.dateBy("dd")+"</li><li>"+e.dateBy("NNN yyyy")+'</li></ul></li><li class="zcl_agncclr"><span style="background-color:'+(-1!=d.EC?zcal.eventcolor[d.EC]:y[1])+'"></span></li><li class="zcl_grevlst"><ul><li><b>'+ZCL_getHTML(d.SUM)+"</b></li><li><em>"+(i?zcal.i18n.allday:ZCL_timeInUFormat(s.ST)+" - "+ZCL_timeInUFormat(s.ET))+"</em>"+(d.LOC?"<span>"+zcal.i18n.loc+"</span><em>"+ZCL_getHTML(d.LOC)+"</em>":"")+"</li></ul></li></ul></div></li>");0!=d.EPERM&&T(b,d,e,n,r),a.appendChild(b[0])}}}},T=function(e,t,a,l,c){e.on("click",{obj:t,dat:a,rindex:l,repinst:c},function(e){var t=e.data.obj,a=e.data.dat,l=t.EID+(t.REP?"_"+a.dateBy("yyyyMMdd"):"");ZCL_AgenEveDetail(l,e,t.CNAME,t.EUID,e.data.rindex,e.data.repinst,t)})},D=function(e){if(1<e.length)for(var t=0;t<e.length-1;t++)for(var a=t+1;a<e.length;a++){var l=e[t],c=e[a];if(l&&c){var i=parseInt(l.ST),n=parseInt(l.ET),r=parseInt(c.ST),s=parseInt(c.ET);r<i?(e[t]=c,e[a]=l):i==r?("2400"==s||s<n)&&(e[t]=c,e[a]=l):(e[t]=l,e[a]=c)}}};return{dispEvents:function(e){null==zcal.calCenter||zcal.calCenter&&zcal.calCenter.listElem.getBoundingClientRect().height<=0?zcal.reconstructView=!0:(e?(d=e,zcal.today=d,i=a(d),zcalInit.updateHeaderBand(zcal.today.dateBy("NNN dd, yyyy"),zcal.view)):t(),zcalAgenda.fetchEvents(d,1))},fetchEvents:function(e,t){zmComponent.loadingBand({container:zcal.calCenter.listElem,type:"listing"});var a="/cal/agenda.do?iszmscal=true&dat="+e.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&qno="+t+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&calmode="+zcal.CALMODE+(1==zcal.CALMODE?"&gid="+zcal.cdata.opt.GID:"");ZCL_uXHR(a,zcalAgenda.agendaData)},agendaData:function(e){$(zcal.calCenter.listElem).html('<div class="zcl zcl_agendavw" id="zcl_workarea"><ul id="zcl_encloser" class="zcl_frmbg"><li><ul id="zcl_agnlst" class="zcl_agnlst"></ul><div id="zcl_agnmsg"></div></li></ul></div>');for(var t,a=ZCL_Evl(1,e.responseText),l=i[0].clone();l<i[1];)a[t=l.getFullYear()+"_"+Math.floor(l.getMonth()/3)]&&(E[t]=a[t]),l.setMonth(l.getMonth()+1);o()},goPrev:function(){d.setDate(1),d.setMonth(d.getMonth()-1),e[0]=new Date(d.getFullYear(),d.getMonth(),1)},goNext:function(){d.setDate(1),d.setMonth(d.getMonth()+1),e[1]=new Date(d.getFullYear(),d.getMonth()+1,1)},del:function(e,t){if(4==zcal.view){var a=e[t].ADAY;if(e[t].REP)return zcalAgenda.fetchEvents(d,1),!1;e[t].SD!=e[t].ED&&(a=1);for(var l=ZCL_parseDateStr(e[t].SD),c=Math.floor(l.getMonth()/3),i=l.dateBy("yyyy"),n=E[i+"_"+c][a][e[t].SD].length,r=0;r<n;r++)if(!E[i+"_"+c][a][e[t].SD][r].EMTY)if(E[i+"_"+c][a][e[t].SD][r].DUP){var s=E[i+"_"+c][a][e[t].SD][r].DUP;E[s[0]][a][s[1]][s[2]].EID==t&&(E[s[0]][a][s[1]][s[2]]={EMTY:"$$$"})}else E[i+"_"+c][a][e[t].SD][r].EID==t&&(E[i+"_"+c][a][e[t].SD][r]={EMTY:"$$$"});o()}},edit:function(e){if(4==zcal.view){var t=ZCL_Evl(1,e);if(t.REP||t.SD!=t.ED)return zcalAgenda.fetchEvents(d,1),!1;var a=t.ADAY;t.SD!=t.ED&&(a=1);var l=t.EID,c=ZCL_parseDateStr(t.SD),i=Math.floor(c.getMonth()/3),n=c.dateBy("yyyy");if(E[n+"_"+i]){for(var r=E[n+"_"+i][a][t.SD].length,s=0;s<r;s++)E[n+"_"+i][a][t.SD][s].EMTY||E[n+"_"+i][a][t.SD][s].EID==l&&(E[n+"_"+i][a][t.SD][s]={EMTY:"$$$"},E[n+"_"+i][t.ADAY][t.SD][E[n+"_"+i][t.ADAY][t.SD].length]=t);o()}}},add:function(e){if(4==zcal.view){var t=ZCL_Evl(1,e);if(t.REP||t.SD!=t.ED)return zcalAgenda.fetchEvents(d,1),!1;var a=ZCL_parseDateStr(t.SD),l=Math.floor(a.getMonth()/3),c=a.dateBy("yyyyMMdd"),i=a.getFullYear();if(E[i+"_"+l]){if(0==t.ADAY)if(E[i+"_"+l][0][c]){var n=E[i+"_"+l][0][c].length;E[i+"_"+l][0][c][n]=t}else E[i+"_"+l][0][c]=[],E[i+"_"+l][0][c][0]=t;else if(E[i+"_"+l][1][c]){n=E[i+"_"+l][1][c].length;E[i+"_"+l][1][c][n]=t}else E[i+"_"+l][1][c]=[],E[i+"_"+l][1][c][0]=t;o()}}}}}(),zcalEvents=function(){function w(e,t,a){e.onmousedown=function(e){zcalEDrag.dragStart(this,e,t,a)}}function O(e,t,a){e.onclick=function(e){zcal.eveDetail(this.id,e,t,[a.SD,a.ST,a.ED,a.ET,a.EUID,a.CNAME,a.EPERM,a.RIDX,a.DPERM,a.REPINST])}}var a,I,l=function(){var e="";for(var t in zcal.cdata.calLst)0!=zcal.cdata.calLst[t][2]&&0!=zcal.cdata.calLst[t][8]&&(e+=""!=e?","+t:t);return e},c=function(e){a&&a();var t=ZCL_Evl(1,e.responseText);zcal.cdata.evelst=t[0],zcal.cdata.eveAll=t[1],zcalView.constGridView()};return{c:{},col:[],findTop:function(e){e=2330<(e=parseInt(e,10))?2330:e,I=I||50;var t=parseInt(e/100,0);return t=t*I+Math.round(e%100*(I/60))},findHgt:function(e,t){e=parseInt(e,10),t=parseInt(t,10),I=I||50;var a,l=parseInt(e/100,10),c=parseInt(t/100,10);return l=60*l+e%100,c=60*c+t%100,a=Math.round(I/60*(c-l)),a=I/2<a?a:I/2},findHgt1:function(e,t){e=parseInt(e,10),t=parseInt(t,10);var a=parseInt(e/100,10),l=parseInt(t/100,10);a=60*a+e%100,l=60*l+t%100;var c=Math.floor(50/60*(l-a));return(c=22<c?c:22)-7},findDur:function(e,t){e=parseInt(e,10),t=parseInt(t,10);var a=parseInt(e/100,10),l=parseInt(t/100,10)-a;return 0<t%100&&++l,l},incCount:function(e,t){e=parseInt(e,10),t=parseInt(t,10);var a=parseInt(e/100,10),l=parseInt(t/100,10);0<t%100&&++l;for(var c=a;c<l;c++)++zcalEvents.c[c].act},setDur:function(e,t){e=parseInt(e,10);var a=parseInt(e/100,10);zcalEvents.c[a].dur<t&&(zcalEvents.c[a].dur=t)},DGView:function(e,t){var a={},l={};a.eorder=[];var c=zcalCRM.getCRMColorCode();for(var i in e)for(var n in d=e[i],d){var r=zcal.getCalObj(d[n].CNAME),s=!0,o=d[n].ORG;if("crm"==r[14]&&c?c[o]?s=0!=c[o][2]:c.OTHERS&&(s=0!=c.OTHERS[2]):s=-1==zcal.disabledcal.indexOf(d[n].CNAME),s&&(1==zcal.cdata.opt.DDE||0==zcal.cdata.opt.DDE&&"2"!=d[n].USTAT)){var u=d[n].ST.substring(0,2)+"00",p=d[n].ST,m=d[n].ET;d[n].SD!=d[n].ED&&(u=t!=d[n].SD?"0000":u,p=t!=d[n].SD?"0000":p,m=t!=d[n].SD?m:"2400");var _=u,z=0;void 0===l[_]?(a.eorder.push(_),l[_]=new Array(1)):z=l[_].length,l[_][z]={},l[_][z].id=n,l[_][z].no=i;var f=zcalEvents.findDur(p,m);l[_][z].span=zcalEvents.findHgt(p,m),l[_][z].dur=f,l[_][z].pos=zcalEvents.findTop(p),zcalEvents.setDur(p,f),zcalEvents.incCount(p,m)}}return a.elist=zcalEvents.sortObj(l),a},sortObj:function(e){for(var t in e)for(var a=e[t],l=0;l<a.length-1;l++)if(a[l].pos==a[l+1].pos&&a[l].span<a[l+1].span){var c=a[l+1];a.splice(l+1,1),a.splice(l,0,c)}return e},cArrSlot:function(e,t){for(var a=0;a<t;a++)e[a]=0},updateColumn:function(e,t,a){var l=e.ST,c=e.ET,i=e.SD,n=e.ED,r="0000",s="2400";i=ZCL_parseDateStr(i),n=ZCL_parseDateStr(n);var d=ZCL_parseDateStr(t),o=(l=i<d||parseInt(l)<parseInt(r)?r:l)+"-"+(c=d<n||parseInt(c)>parseInt(s)?s:c);l=parseInt(l),c=parseInt(c);var u=JSON.parse(JSON.stringify(e));u.etime=o,u.no=a;var p=this.col;if(0<p.length){for(var m=0;m<p.length;m++)for(var _=0;_<p[m].length;_++){var z=p[m][_].etime;parseInt(z.split("-")[0],10);if(l<parseInt(z.split("-")[1],10))break;if(_==p[m].length-1)return p[m].push(u),!0}(f=p[p.length]?p[p.length]:[]).push(u),p[p.length]=f}else{var f;(f=p[p.length]?p[p.length]:[]).push(u),p[p.length]=f}},allocateColumn:function(e,t){var a,l,c=zcalCRM.getCRMColorCode();for(var i in this.col=[],e)for(var n in a=e[i])if((l=a[n]).id=n,l.ED!=t||"1"==l.ADAY||"0000"!=l.ET){l.CNAME;var r=l.ORG,s=!0,d=zcal.getCalObj(l.CNAME);if(d&&("crm"==d[14]&&c?c[r]?s=0!=c[r][2]:c.OTHERS&&(s=0!=c.OTHERS[2]):s=-1==zcal.disabledcal.indexOf(l.CNAME),s=s?"1"==d[2]:s)){var o=l.ST,u=l.ET,p=l.SD,m=l.ED;p=ZCL_parseDateStr(p),m=ZCL_parseDateStr(m);var _=ZCL_parseDateStr(t);o=p<_?"0000":o,u=_<m?"2400":u,parseInt(o)>=parseInt("2400")||parseInt(u)<=parseInt("0000")||0==zcal.cdata.opt.DDE&&"2"==l.USTAT||this.updateColumn(l,t,i)}}},renderDayView:function(e,t,a,l,c){zcalEvents.sortEve(e,t),this.allocateColumn(e,t),this.EveToHTML(ZCL_$("zcl_eveSub"),t,l,c)},findSplitCnt:function(e,t){for(var a=t.etime.split("-"),l=e+1,c=parseInt(a[0],10),i=parseInt(a[1],10),n=0;n<this.col.length;n++)for(var r=this.col[n],s=0;s<r.length;s++){var d=r[s].etime,o=parseInt(d.split("-")[0],10),u=parseInt(d.split("-")[1],10);(c<=o&&o<i||c<u&&u<=i||o<=c&&c<u)&&(i=i<u?u:i,c=o<c?o:c,l=n+1)}return l},EveToHTML:function(e,t,a,l){for(var c=0;c<this.col.length;c++)for(var i=this.col[c],n=0;n<i.length;n++){var r=i[n],s=parseInt(r.etime.split("-")[0],10),d=parseInt(r.etime.split("-")[1],10),o=this.findSplitCnt(c,r),u=Math.floor(a/o-3)+"px",p=this.findHgt1(s,d),m=a/o*c,_=document.querySelector("li[rel='"+t+"']");m=90<_.offsetLeft?_.offsetLeft+parseInt(m)+"px":m+81+"px";var z=this.findTop(s)+"px",f=document.createElement("div");f.style.position="absolute",f.style.top=z,f.style.left=m,f.style.width=u;var v=ZCL_getHTML(r.SUM);""==v&&(v="NO SUBJECT"),f.title=zcalEvents.tooltip(r),f.alt=zcalEvents.tooltip(r),f.setAttribute("gridNo",l);var h=r.id+(r.REP?"_"+r.SD:"");f.id=h,f.eobj={RIDX:r.RIDX,EUID:r.EUID,CNAME:r.CNAME,SD:r.SD,ED:r.ED,ST:r.ST,ET:r.ET,ORG:r.ORG,EPERM:r.EPERM,DPERM:r.DPERM,ADAY:r.ADAY,ETZ:r.ETZ,IN_ETZ:r.IN_ETZ,EC:r.EC},(2==r.EPERM?w:O)(f,t,r);var g=zcalCRM.getCRMColorCode(),C=zcal.getCalObj(r.CNAME);if(C){var y=C[1].split(":"),L=C[1];"crm"==C[14]&&g&&(g[r.ORG]?L=g[r.ORG][1]:g.OTHERS&&(L=g.OTHERS[1]));var b=ZCL_getCalColor(L),E=0==y[1]?"zcl_event zcl_evwh":"zcl_event zcl_evbl",T=6<b[0].split("#")[1].length?hexToRgba(b[0]):b[0],D=6<b[1].split("#")[1].length?hexToRgba(b[1]):b[1];f.style.borderColor=T,f.className=E;var Z=1==r.REF[2]?"msi-mail":"",A=r.USTAT;1==A?Z="msi-inacc":2==A?Z="msi-inden":3==A&&(Z="msi-intac");var M=""!=Z?"<i class='"+Z+"'></i>":"";M+=1==r.REF[4]?"<i class='msi-alarm'></i>":"",M+=r.HASATTACH?"<i class='msi-attachicon'></i>":"",M+=r.REP?"<i class='msi-repeat'></i>":1==r.REF[3]?"<i class='msi-break'></i>":"",M+=r.IN_ETZ&&1==r.IN_ETZ&&r.ETZ&&""!=r.ETZ?"<i class='msi-timezone'/></i>":"",M+="<em>"+ZCL_timeInUFormat(r.ST)+"</em>";var S="<div style='background-color:"+(-1!=r.EC?zcal.eventcolor[r.EC]:D)+"' class='zcl_evbg'></div><div class='zcl_eventbody' style='height:"+p+"px'>";S+="<ul><li class='zcl_sp'></li>";var k="";p<=I/2?(M+="<span>&nbsp;"+v+(r.LOC?"&nbsp;@&nbsp;"+ZCL_getHTML(r.LOC):"")+"</span>",v=""):k+="<ul><li class='zcl_sp'></li><li class='zcl_eventml zcl_evttl'>"+v+"</li></ul>"+(r.LOC?"<ul><li class='zcl_sp'></li><li class='zcl_eventml zcl_evttl'>@&nbsp;"+ZCL_getHTML(r.LOC)+"</li></ul>":""),S+="<li>"+M+"</li></ul>",S+=k,S+="</div>",S+="<div class='zcl_resize'><div class='zcl_scale' id='zcl_scrollme'>&nbsp;</div>",S+="</div>",f.innerHTML=S,zcal.$("zcl_eveSub").style.fontSize="",zcal.$("zcl_eveSub").style.lineHeight="",zcal.$("zcl_eveSub").appendChild(f)}}},appEvent:function(e,t){var a=ZCL_Evl(1,zcalMulti.toString(e)),l=zcal.cdata.evelst;if(!(l=l||{})[t]||l[t].length<1)l[t]=new Array,l[t][0]=a;else{var c=l[t];c[c.length]=a}},sortEve:function(e,t){var a=e?e.length:0;if(1<a)for(var l=0;l<a-1;l++)for(var c=l+1;c<a;c++){var i,n=ZCL_Evl(1,zcalMulti.toString(e[l]));for(var r in n)i=n[r];var s,d=ZCL_Evl(1,zcalMulti.toString(e[c]));for(var o in d)s=d[o];if(i&&s){var u=parseInt(i.ST,10),p=parseInt(i.DUR,10);i.SD!=t&&(p=parseInt(u/100,10)*zcal.msec_hour+u%100*zcal.msec_minute,u=0);var m=parseInt(s.ST,10),_=parseInt(s.DUR,10);s.SD!=t&&(_=parseInt(m/100,10)*zcal.msec_hour+m%100*zcal.msec_minute,m=0),m<u||u==m&&p<_?(e[l]=d,e[c]=n):(e[l]=n,e[c]=d)}}},remEve:function(e,t,a){var l=t?zcal.cdata.eveAll:zcal.cdata.evelst,c=null;try{var i=null;for(var n in l)for(var r=0;r<l[n].length;r++){var s=l[n][r];for(var d in s)if(d==e){c=s,i=n,a&&l[n].splice(r--,1);break}}l[i]&&0==l[i].length&&delete l[i]}catch(e){}return c},getEve:function(e,t,a){var l=t?zcal.cdata.eveAll:zcal.cdata.evelst,c=null;try{if(l[a])for(var i=0;i<l[a].length;i++){var n=l[a][i];if(n[e]){c=n;break}}}catch(e){}return c},tooltip:function(e){var t="",a=ZCL_parseDateStr(e.SD),l=ZCL_parseDateStr(e.ED);return t+=a.dateBy(zcal.ttipformat),e.SD!=e.ED?(t+=1==e.ADAY?"":" "+ZCL_timeInUFormat(e.ST),t+=" - "+l.dateBy(zcal.ttipformat),t+=1==e.ADAY?"":" "+ZCL_timeInUFormat(e.ET)):t+=1==e.ADAY?"":" "+ZCL_timeInUFormat(e.ST)+" - "+ZCL_timeInUFormat(e.ET),t+" "+e.SUM+(e.LOC?" @ "+e.LOC:"")},alltime:function(e){var t=e.USTAT,a="";0==t?a="msi-mail":1==t?a="msi-inacc":2==t?a="msi-inden":3==t&&(a="msi-intac");var l="";return(e.APL_REQ&&1==e.APL_REQ||e.CRM_STATUS&&2==e.CRM_STATUS)&&(l+='<i class="msi-spam"/>'),l+=1==e.ETYPE?"<i class='msi-bdy' alt="+zcal.i18n.birthday+" title="+zcal.i18n.birthday+"></i>":"",l+=4==e.ETYPE?"<i class='msi-hdy' alt="+zcal.i18n.holiday+" title="+zcal.i18n.holiday+"></i>":"",l+=3==e.ETYPE?"<i class='msi-task'></i>":"",l+=""!=a?"<i class='"+a+"'></i>":"",l+=1==e.REF[4]?"<i class='msi-alarm'></i>":"",l+=e.HASATTACH?"<i class='msi-attachicon'></i>":"",l+=e.REP?"<i class='msi-repeat'></i>":1==e.REF[3]?"<i class='msi-break'></i>":"",l+=1==e.ADAY?"":"<em>"+ZCL_timeInUFormat(e.ST)+"</em>"},loadMonthData:function(e){if(zmsuite.isWorkspaceAvailable("zcal_Container")){a=e?zmComponent.loadingBand({container:zcal.calCenter.listElem,type:"listing"}):null;var t="/cal/nxtMon.do?mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&calmode="+zcal.CALMODE;zcal.initLoad&&(t+="&calids="+l()),ZCL_uXHR(t,c)}},retFetchEvents:c}}(),zcalMulti={dtArr:new Array,eve:{},retdate:function(e,t){return null==t&&(t=0),new Date(e.substring(0,4),parseInt(e.substring(4,6),10)-1,parseInt(e.substring(6,8),10)+t)},split:function(e){zcalMulti.dtArr=e;var t=zcalMulti.eve;for(var a in t.all={},zcal.cdata.eveAll)for(var l=zcal.cdata.eveAll[a],c=0;c<l.length;c++)for(var i in l[c]){var n=l[c][i];zcal.getCalObj(n.CNAME)&&-1==zcal.disabledcal.indexOf(n.CNAME)&&(1==zcal.cdata.opt.DDE||0==zcal.cdata.opt.DDE&&"2"!=n.USTAT)&&(n.SD!=n.ED?zcalMulti.splitMulti(l[c],i):zcalMulti.splitNorm(l[c],i))}return t},splitMulti:function(e,t){for(var a=zcalMulti.eve.all,l=zcalMulti.retdate(e[t].SD),c=zcalMulti.retdate(e[t].ED),i=0;i<=zcalMulti.dtArr[1];i++){var n=zcalMulti.retdate(zcalMulti.dtArr[0],i);if(l<=n&&n<=c){a[n=n.dateBy("yyyyMMdd")]||(a[n]=new Array),a[n][a[n].length]=e;break}}},splitNorm:function(e,t){var a=zcalMulti.eve.all,l=zcalMulti.retdate(e[t].SD);zcalMulti.retdate(zcalMulti.dtArr[0])<=l&&zcalMulti.retdate(zcalMulti.dtArr[0],zcalMulti.dtArr[1])>=l&&(a[l=l.dateBy("yyyyMMdd")]||(a[l]=new Array),a[l][a[l].length]=e)},appEvent:function(e,t){var a=ZCL_Evl(1,zcalMulti.toString(e)),l=zcal.cdata.eveAll;if(!(l=l||{})[t]||l[t].length<1)l[t]=new Array,l[t][0]=a;else{var c=l[t];c[c.length]=a}},sortAll:function(e,t){var a=e?e.length:0;if(1<a)for(var l=0;l<a-1;l++)for(var c=l+1;c<a;c++){var i,n=ZCL_Evl(1,zcalMulti.toString(e[l]));for(var r in n)i=n[r];var s,d=ZCL_Evl(1,zcalMulti.toString(e[c]));for(var o in d)s=d[o];i&&s&&(ZCL_daysBetween(t,i.ED)<=ZCL_daysBetween(t,s.ED)?(e[l]=d,e[c]=n):(e[l]=n,e[c]=d))}},toString:function(e){return JSON.stringify(e)},duplicate:function(e){var t="{",a=0;for(var l in e.all){var c=e.all[l];t+=0!=a?",":"",t+='"'+l+'" : [';var i=0;for(var n in c)t+=0!=i?","+zcalMulti.toString(c[n]):zcalMulti.toString(c[n]),i++;t+="]",a++}return t+="}"}},zcalAday={c:new Array,s:1,dtArr:new Array,render:function(e,t,a){zcalAday.s=a+1;var l="";zcalAday.creArray();var c=ZCL_parseDateStr(t);zcalAday.dtArr[0]=c,zcalAday.dtArr[1]=zcalMulti.retdate(t,a);for(var i=0;i<=a;i++){var n=new Date;n.setTime(c),n.setDate(n.getDate()+i);var r=n.dateBy("yyyyMMdd");e.all[r]&&(zcalMulti.sortAll(e.all[r],r),l+=zcalAday.create(e.all[r],i,r))}var s=18*zcalAday.c.length+14;l+='<div style="height:14px;position:absolute;width:100%;top:'+(s-14)+'px"></div>',zcal.$("zcl_allLay").innerHTML=l,zcal.$("zcl_aContainer").style.height=(90<s?90:s)+"px",zcal.$("zcl_encloser").style.height=$(zcal.calCenter.listElem).height()-33-zcal.$("zcl_allLay").offsetHeight-1-1+"px",zcal.alldayScrollTop=$("#zcl_allLay").scrollTop(),zcal.hrgridScrollTop=$("#zcl_encloser").scrollTop(),zcalAday.c=new Array},create:function(e,t,a){var l="";for(var c in e){var i=zcalAday.freeS(t),n=zcalAday.eveWid(i,t,e[c],a),r=zcalAday.eveLeft(t);l+=zcalAday.divCont(18*i,r,e[c],n)}return l},divCont:function(e,t,a,l){var c="";for(var i in a){var n=zcalCRM.getCRMColorCode(),r=zcal.getCalObj(a[i].CNAME),s=!0,d=a[i].ORG;if("crm"==r[14]&&n&&(n[d]?s=0!=n[d][2]:n.OTHERS&&(s=0!=n.OTHERS[2])),s&&void 0!==r){var o=a[i].REP?i+"_"+a[i].SD:i,u=r[1].split(":"),p=ZCL_getCalColor(u[0]),m=zcal.eventcolor[a[i].EC],_=ZCL_parseDateStr(a[i].SD),z=ZCL_parseDateStr(a[i].ED),f=(ZCL_timeInUFormat(a[i].ST),ZCL_timeInUFormat(a[i].ET),_.dateBy("MMM dd"),z.dateBy("MMM dd"),ZCL_getHTML(zcalEvents.tooltip(a[i]))),v=zcalEvents.alltime(a[i]),h=0==u[1]?"zcl_alldy zcl_evwh":"zcl_alldy zcl_evbl",g=6<p[0].split("#")[1].length?hexToRgba(p[0]):p[0],C=6<p[1].split("#")[1].length?hexToRgba(p[1]):p[1];c+='<div class="'+h+'" style="top:'+e+"px;left:"+t+"px;width:"+l+"px;border-color:"+g+'" alt="'+f+'" title="'+f+'" onmousedown="zcal.eveDetail(\''+o+"', event, '"+a[i].SD+"', ['"+a[i].SD+"', '"+a[i].ST+"', '"+a[i].ED+"', '"+a[i].ET+"', '"+a[i].EUID+"', '"+a[i].CNAME+"', '"+a[i].EPERM+"', '"+a[i].RIDX+"', '"+a[i].DPERM+"', '"+a[i].REPINST+"'])\">",c+='<div class="zcl_evbg" style="background-color:'+(-1!=a[i].EC?m:C)+'"></div>',c+='<ul class="zcl_eventbody"><li>'+v+"<span>"+ZCL_getHTML(a[i].SUM)+(a[i].LOC?"&nbsp;@&nbsp;"+ZCL_getHTML(a[i].LOC):"")+"</span></li></ul>",c+="</div>"}}return c},creArray:function(){for(var e=zcalAday.c[zcalAday.c.length]=new Array,t=0;t<zcalAday.s;t++)e[t]=0;return zcalAday.c.length-1},freeS:function(e){for(var t=0;t<zcalAday.c.length;t++)if(0==zcalAday.c[t][e])return t;return zcalAday.creArray()},fillspace:function(e,t,a){for(var l=zcalAday.c[e],c=t;c<a+t;c++)l[c]=1},eveWid:function(e,t,a,l){var c="";for(var i in a)ed=a[i].ED;ed=ZCL_parseDateStr(ed),ed>=zcalAday.dtArr[1]?c=ZCL_daysBetween(l,zcalAday.dtArr[1].dateBy("yyyyMMdd"))+1:ed<zcalAday.dtArr[1]&&(c=ZCL_daysBetween(l,ed.dateBy("yyyyMMdd"))+1),zcalAday.fillspace(e,t,c);for(var n=0,r=0;r<c;r++)n+=ZCL_getEleWdt("zcl_a"+(t+r));return n-5},eveLeft:function(e){for(var t=0,a=0;a<e;a++)t+=ZCL_getEleWdt("zcl_a"+a);return t+1}};zcal.REG=/<|>|&lt;|&gt;|&lt|&gt/gi,zcal.$=function(e){return document.getElementById(e)},(extendNativeObject=function(e,t,a){if(e&&t&&a){if(!e.prototype[t])try{return e.prototype[t]=a,!0}catch(e){}return!1}})(String,"trim",function(){var e=this;return e=(e=e.replace(/^\s*(.*)/,"$1")).replace(/(.*?)\s*$/,"$1")}),extendNativeObject(String,"zcalescape",function(){return encodeURIComponent(this)}),extendNativeObject(String,"zcalunescape",function(){return unescape(decodeURIComponent(this))}),extendNativeObject(String,"zcalreplace",function(){return this.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"')}),zcal.validate=function(e){var t=e.lastIndexOf("<"),a=e.lastIndexOf(">");return!(t<a&&"-1"!=t&&"-1"!=a)},zcal._2digit=function(e){return+e<10?"0"+e:""+e},ZCL_timeInUFormat=function(e){e=parseInt(e,10);var t=Math.floor(e/100),a=zcal._2digit(e%100);return 0!=zcal.cdata.opt.TF?zcal._2digit(t)+":"+a:(0==t?12:12<t?t-12:t)+":"+a+" "+(11<t?zcal.i18n.pm:zcal.i18n.am)};var ZCL_ClearCacheTimer=null;ZCL_handleLanguageChange=function(){null==ZCL_ClearCacheTimer&&(ZCL_ClearCacheTimer=setTimeout(function(){var e=(new Date).getTime();ZCL_uXHR("/cal/clearusercache.do?nocache="+e,ZCL_clearUserCache)},3e3))},ZCL_clearUserCache=function(e){ZCL_ClearCacheTimer=null;var t=ZCL_Evl(1,e.responseText),a=zcal.cdata.opt;if(t.TIM!=a.TIM)if("c"==zmApp.currentApp){var l=document.createElement("div");l.id="zcl_redit_confirm",l.className="zcl_rpt",l.innerHTML="<div>Your timezone has been updated to <span style='color:#000000;font-weight:bold'>"+ZCL_getHTML(t.TIM)+"</span>. Reload the page for the changes to take effect.</div>",document.body.appendChild(l);var c={title:"Hi  "+t.username+",",style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",buttons:[{txt:"OK",callback:function(){ZCL_Continue(t)}}]};zmsDialog.create("zcl_redit_confirm",c)}else ZCL_Continue(t)},ZCL_Continue=function(e){zmsDialog.remove(!0);var t=zcal.cdata.opt;e&&(t.CTIM=e.CTIM,t.TIM=e.TIM,t.TZLBL=e.TZLBL,zcal.cdate=ZCL_parseDateTimeStr(e.DATE_STR).getTime(),zcal.timezoneupdated=!0)},ZCL_pxToTime=function(e){var t,a,l=$("#zcl_hContainer").find("ul:first")[0].getBoundingClientRect().height;return a=Math.round(e%l/(l/60)),a=5*Math.round(a/5),t=Math.floor(e/l),t=60==a?t+1:t,a=60==a?0:a,zcal._2digit(t)+""+zcal._2digit(a)},ZCL_LinkParser=function(e){var t=e;t=(t=(t=t.replace(/\n/g," <br/>")).replace(/\\n/g," <br/>")).replace(/\\N/g," <br/>");for(var a=/((?=http\:|https\:)[\S]*\/\/[^\s\"]+)/gi,l=/[\w]([\w\-\.\+\'\/]*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})/gi,c=/\<br\/?>/gi,i=[],n=[],r=[],s=[],d=[];null!=(match=a.exec(t));){var o={};match[0].match(/(\<|\>)/gi)||(o.sindex=match.index,o.eindex=match.index+match[0].length,i.push(o))}for(;null!=(match=l.exec(t));){(o={}).sindex=match.index,o.eindex=match.index+match[0].length,n.push(o)}for(;null!=(match=c.exec(t));){(o={}).sindex=match.index,o.eindex=match.index+match[0].length,r.push(o)}for(var u in(s=i.concat(n).concat(r)).sort(function(e,t){return e.sindex-t.sindex}),s){if(0!=u){_=t.substring(s[u-1].eindex,s[u].sindex);var p=document.createTextNode(_);d.push(p),_=t.substring(s[u].sindex,s[u].eindex)}else if(0==s[u].sindex)_=t.substring(0,s[u].eindex);else{_=t.substring(0,s[u].sindex);p=document.createTextNode(_);d.push(p),_=t.substring(s[u].sindex,s[u].eindex)}if(_.match(/\<br\/?>/))var m=document.createElement("BR");else{m=document.createElement("A");_.match(l)?m.setAttribute("href","mailto:"+_):m.setAttribute("href",_),_.match(l)||m.setAttribute("target","_blank"),m.innerText=_}if(d.push(m),u==s.length-1){var _=t.substring(s[u].eindex,t.length);p=document.createTextNode(_);d.push(p)}}if(0==s.length){p=document.createTextNode(""!=t?t:"---");d.push(p)}return d},extendNativeObject(String,"getTimeBy",function(e){e+="";var t="",a=0,l="",i=ZCL_parseTime(this);if(i){for(;a<e.length;){for(c=e.charAt(a),l="";e.charAt(a)==c&&a<e.length;)l+=e.charAt(a++);null!=i[l]?t+=i[l]:t+=l}return t}return this}),ZCL_parseTime=function(e){var t=e.trim().toLowerCase();if(/^(20|21|22|23|[01]\d|\d)(([:][0-5]\d){1,2})$/.test(t))return ZCL_ParseByRT(t);if(/^(0[1-9]|1[0-2]|[1-9]):[0-5][0-9]\s*([ap]m|[AP]M)$/.test(t))return ZCL_ParseByAm(t);if(/^(20|21|22|23|[01]\d|\d)[0-5][0-9]$/.test(t))return ZCL_ParseByDB(t);if(t=t.replace(/\D/gi,""),isNaN(t))return{HH:"08",hh:"08",mm:"00",a:"am"};var a=t.length;return t=1==a?t+"000":2==a?t+"00":3==a?t+"0":4<a?t.substring(0,4):t,/^(20|21|22|23|[01]\d|\d)[0-5][0-9]$/.test(t)?ZCL_ParseByDB(t):{HH:"08",hh:"08",mm:"00",a:"am"}},ZCL_ParseByRT=function(e){var t=e.split(":");t[0]=parseInt(t[0],10);var a=(0==t[0]?"12|am":12==t[0]?"12|pm":t[0]<12?t[0]+"|am":t[0]-12+"|pm").split("|"),l={};return l.HH=t[0]<10?"0"+t[0]:t[0],l.hh=a[0]<10?"0"+a[0]:a[0],l.mm=t[1],l.a=a[1],l},ZCL_ParseByDB=function(e){var t=e.substring(0,2),a=e.substring(2,4),l=(0==(t=parseInt(t,10))?"12|am":12==t?"12|pm":t<12?t+"|am":t-12+"|pm").split("|"),c={};return c.HH=t<10?"0"+t:t,c.hh=l[0]<10?"0"+l[0]:l[0],c.mm=a.length<2?"0"+a:a,c.a=l[1],c},ZCL_ParseByAm=function(e){var t=e.split(/:|\s+/);t.length<3&&(t[2]=t[1].substring(2,4),t[1]=t[1].substring(0,2)),t[0]=parseInt(t[0],10);var a={};return a.hh=t[0]<10?"0"+t[0]:t[0],a.mm=t[1],a.a=t[2],a.HH=12==t[0]&&"am"==a.a?"00":"pm"==a.a&&12!=t[0]?t[0]+12:t[0]<10?"0"+t[0]:t[0],a},ZCL_CRTim=function(e){e.value;e.value=e.value.getTimeBy(zcal.timeformat[zcal.cdata.opt.TF])},ZCL_TimetoNo=function(e){var t=ZCL_parseTime(e);return t.HH+""+t.mm},ZCL_replaceString=function(e,t){return e.replace(/\{[0-9]\}/g,function(e){return e=e.replace(/[\{\}]/g,""),t[parseInt(e)]})},ZCL_getPos=function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(e){var t={offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight};if(e.offsetParent){var a=ZCL_getPos(e.offsetParent);t.offsetLeft+=a.offsetLeft,t.offsetTop+=a.offsetTop,t.offsetRight+=a.offsetRight}return t}),ZCL_MouseXY=function(e){(e=e||window.event).pageX||e.pageY?(zcalMX=e.pageX,zcalMY=e.pageY):(e.clientX||e.clientY)&&(zcalMX=e.clientX+document.body.scrollLeft,zcalMY=e.clientY+document.body.scrollTop)};var ZCL_SHCAL_EVEUPD,ZCL_ISTIMER=!(zcal.getCalObj=function(e){return zcal.cdata.calLst[e]||zcal.cdata.calOLst[e]||zcal.cdata.calGLst[e]||zcal.cdata.calALst[e]});ZCL_chkfeed=function(){var e=ZCL_$("zcl_frmfeed");""==ZCL_$("zcl_feedsub").value.trim()?alert(ZCL_ALERTS.entersubject):(e.zcl_feedcsrf.value=ZCL_CSRFCOO,e.submit(),e.reset(),ZCL_clrStck(),ZCL_slideObj.status(ZCL_ALERTS.thfeedback))},ZCL_openRO=function(){var e=ZCL_$("zcl_ro_msg");ZCL_CAStck(new Array("zcl_ro_msg","zcl_mask","zcl_mask1")),e.style.display="",e.style.left=(document.body.offsetWidth-e.offsetWidth)/2+"px",e.style.top=(document.body.offsetHeight-e.offsetHeight)/2+"px",ZCL_openMask()},ZCL_clsRO=function(){ZCL_$("zcl_ro_msg").style.display="none",ZCL_clrStck()},ZCL_getJSONObjCnt=function(e){var t=0;for(var a in e)e.hasOwnProperty(a)&&t++;return t},ZCL_Evl=function(e,t){if(!(arguments.length<2)){if(1==e)return JSON.parse(t);if(2==arguments.length)return window[t].apply(this);var a=Array.prototype.slice.call(arguments,2);return window[t].apply(this,a)}},ZCL_getEleWdt=function(e){return("string"==typeof e?zcal.$(e):e).getBoundingClientRect().width},ZCL_$=function(e){return document.getElementById(e)},ZCL_setOpacity=function(e,t){e.style.filter="alpha(opacity="+t+"0)",e.style.opacity="0."+t,e.style.mozOpacity="0."+t},ZCL_findPosYY=function(e,t){var a=0;if(e.offsetParent)for(;e.offsetParent&&("absolute"!=e.style.position||t);)a+=e.offsetTop,e=e.offsetParent;else e.y&&(a+=e.y);return a},ZCL_findPosXX=function(e,t){var a=0;if(e.offsetParent)for(;e.offsetParent&&("absolute"!=e.style.position||t);)a+=e.offsetLeft,e=e.offsetParent;else e.x&&(a+=e.x);return a},ZCL_daysBetween=function(e,t){var a=ZCL_parseDateStr(e),l=ZCL_parseDateStr(t),c=0;a<l&&(c=6e4*(l.getTimezoneOffset()-a.getTimezoneOffset()));var i=Math.abs(l.getTime()-a.getTime())-c;return Math.ceil(i/864e5)},extendNativeObject(String,"ZCL_calescape",function(){return encodeURIComponent(this)}),ZCL_getHTML=function(e){return e=(e=(e=(e=e.replace(/"/g,"&quot;")).replace(/'/g,"&#39;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")},ZCL_encodeHTML=function(e){return e=(e=(e=(e=(e=e.replace(/\\/g,"")).replace(/"/g,"")).replace(/'/g,"")).replace(/</g,"")).replace(/>/g,"")},ZCL_getHTML1=function(e){return e=(e=(e=(e=(e=e.replace(/\\/g,"\\\\")).replace(/"/g,'\\"')).replace(/'/g,"\\&#39;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")},ZCL_getDescHTML=function(e){return e=(e=(e=(e=(e=(e=(e=e.replace(/"/g,"&quot;")).replace(/'/g,"&#39;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/\n/g,"<br/>")).replace(/\\n/g,"<br/>")).replace(/\\N/g,"<br/>")},ZCL_stopEvents=function(e){(e=e||event).stopPropagation?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!0,e.returnValue=!1)},ZCL_rdaysInJSRep=function(e){for(var t=new Array,a=e.length,l=0;0!=a&&l<a;l++){var c=parseInt(e[l],10);--c,t[l]=c}return t},ZCL_parseDateStr=function(e){var t=e.substring(0,4),a=parseInt(e.substring(4,6),10)-1,l=e.substring(6,8),c=new Date(t,a,l);return c.setHours(0,0,0,0),c},ZCL_parseDateTimeStr=function(e){var t=e.substring(0,4),a=parseInt(e.substring(4,6),10)-1,l=e.substring(6,8),c=e.substring(8,10),i=e.substring(10,12);return new Date(t,a,l,c,i,0,0)},ZCL_array_search=function(e,t){for(var a in t)if(t[a]==e)return a;return!1};var ZCL_replaceComName=function(e){return e.replace("{{companyName}}",zcal.i18n.campanyName)},ZCL_replaceProName=function(e){return e.replace("{{productName}}",ZCL_replaceComName(zcal.i18n.productName,zcal.i18n.campanyName))};function hexToRgba(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,a,l){return t+t+a+a+l+l});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?"rgba("+parseInt(t[1],16)+","+parseInt(t[2],16)+","+parseInt(t[3],16)+","+parseFloat(parseInt(t[4],16)/255).toFixed(1)+")":null}function ZCL_isEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}ZCL_handleCrossProductMessage=function(e,t){if("CL"==e)if("ADD EVENTS"==t.operation)ZCL_showEvent(t.data);else if("DELETE EVENTS"==t.operation){var a=t.data;ZCL_updateDeletedEvents(a,1)}else if("MAIL INVITE"==t.operation||"UPDATE INVITED EVENT"==t.operation){var l=t.data;setTimeout(function(){ZCL_fetchRepeatWithChild(l,1)},3e3)}else if("UPDATE CALENDAR WITH EVENTS"==t.operation)zcal.refreshMode=t.operation,zcal.refreshTimer||(zcal.refreshTimer=setTimeout(function(){zcal.iswms=!0,ZCL_shCalAdd()},3e3));else if("UPDATE EVENTS ONLY"==t.operation)if(zcal.refreshMode="UPDATE CALENDAR WITH EVENTS"==zcal.refreshMode?zcal.refreshMode:t.operation,"GSync Events"==t.data){zcal.iswms=!0;var c=zmail.Settings.MailSuite.Apps.CalendarSync.SyncView;c.setGCalSyncStatus(0),ZCL_shCalAdd(),0<$("#zcl_gcallst").length&&(_zm.succErrMsg("s",zcal.i18n.synccompmsg),c.listGCal())}else if("CRM Events"==t.data){zcal.iswms=!0,ZCL_shCalAdd(),0<(i=$("#zcl_appcallst")).length&&"crm"==i.data("app")&&zcalSettings.appList.listCrmCal()}else"CalDAV Events"==t.data?(zcal.iswms=!0,ZCL_shCalAdd()):"ZTask Events"==t.data?(zcal.iswms=!0,ZCL_shCalAdd(),zcalSettings.appList.setTaskSyncStatus("success"),0<(i=$("#zcl_appcallst")).length&&"task-sync"==i.data("app")&&(_zm.succErrMsg("s",zcal.i18n.synccompmsg),zcalSettings.appList.listTaskCal())):zcal.refreshTimer||(zcal.refreshTimer=setTimeout(function(){zcal.iswms=!0,ZCL_shCalAdd()},3e3));else if("CRM SYNC"==t.operation){var i,n=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;if("success"==t.data.sync_status)zcal.iswms=!0,n.setCrmSyncStatus(t.data.sync_status),zcal.cdata.calOUids+=","+t.data.Uid,zcal.refreshMode="UPDATE CALENDAR WITH EVENTS",ZCL_shCalAdd(),0<(i=$("#zcl_syncstatus")).length&&"crm"==i.data("app")&&(_zm.succErrMsg("s",zcal.i18n.synccompmsg),n.listCrmCal());else setTimeout(function(){n.setCrmSyncFailedStatus()},3e3)}else"UPDATE_SHARECAL_EVENT"==t.operation?setTimeout(function(){ZCL_updateEventsForSharedCal(t.data.eventIdL,t.data.ckey,1)},3e3):"DELETE_SHARECAL_EVENT"==t.operation&&ZCL_updateDeletedEventsForSharedCal(t.data,1)};var zcalUtil={createEvent:function(t){(t?function(){var e=ZCL_nlp(t.SUM,1);e.SUM=e.SUM?e.SUM:"",e.DESC=t.DESC?t.DESC:"",e.msgId=t.msgId?t.msgId:"",e.accId=t.accId?t.accId:"",e.ST=e.ST?e.ST:"",e.ET=e.ET?e.ET:"",e.SD=e.SD?e.SD:"",e.ED=e.ED?e.ED:"",e.failureCallbk=t.failureCallbk?t.failureCallbk:"",e.successCallbk=t.successCallbk?t.successCallbk:"",e.mode=t.msgId?"associate":"",ZCL_constEventView(e)}:function(){ZCL_constEventView()})()}};zcal.NN6=document.getElementById&&!document.all,ZCL_getCalArr=function(e,t){for(var a=[],l=zcal.cdata.calOrdArr,c=0;c<l.length;c++){var i=l[c],n=zcal.cdata.calLst[i];if("1"==zcal.cdata.calLst[i][8])(d={}).id=i,d.name=n[0],d.display_text=n[0],a.push(d)}for(var r in zcal.cdata.calGLst){if("1"==(s=zcal.cdata.calGLst[r])[8]&&(2==s[12]||3==s[12]))(d={}).id=r,d.name=s[0]+"("+s[14]+")",d.display_text=s[0]+"("+s[14]+")",a.push(d)}for(var r in zcal.cdata.calALst){if("1"==(s=zcal.cdata.calALst[r])[8]&&(2==s[12]||3==s[12])){if("ztask"==s[14]&&t)continue;(d={}).id=r,d.name=s[0]+"("+s[14]+")",d.display_text=s[0]+"("+s[14]+")",a.push(d)}}for(var r in zcal.cdata.calOLst){var s,d;if("1"==(s=zcal.cdata.calOLst[r])[8]&&(2==s[12]||3==s[12]))(d={}).id=r,d.name=s[0]+"(others)",d.display_text=s[0]+"(others)",a.push(d)}return a},ZCL_calSelLst=function(e,t){for(var a="",l=zcal.cdata.calOrdArr,c=0;c<l.length;c++){var i=l[c],n=zcal.cdata.calLst[i];"1"==zcal.cdata.calLst[i][8]&&(a+='<option value="'+i+'" '+(e&&i==e?"selected='true'":"")+">"+ZCL_getHTML(n[0])+"</option>")}for(var r in zcal.cdata.calGLst){"1"!=(s=zcal.cdata.calGLst[r])[8]||2!=s[12]&&3!=s[12]||(a+='<option value="'+r+'" '+(e&&r==e?"selected='true'":"")+">"+ZCL_getHTML(s[0])+"("+s[14]+")</option>")}for(var r in zcal.cdata.calALst){if("1"==(s=zcal.cdata.calALst[r])[8]&&(2==s[12]||3==s[12])){if("ztask"==s[14]&&t)continue;a+='<option value="'+r+'" '+(e&&r==e?"selected='true'":"")+">"+ZCL_getHTML(s[0])+"("+s[14]+")</option>"}}for(var r in zcal.cdata.calOLst){var s;"1"!=(s=zcal.cdata.calOLst[r])[8]||2!=s[12]&&3!=s[12]||(a+='<option value="'+r+'" '+(e&&r==e?"selected='true'":"")+">"+ZCL_getHTML(s[0])+"(others)</option>")}return a},zcal.putDate=function(e){var t=zcal.DFORMAT[zcal.cdata.opt.DF],a=e.substring(6,8),l=e.substring(4,6),c=e.substring(0,4);return t.replace("dd",a).replace("MM",l).replace("yyyy",c)},ZCL_getWeekGridNo=function(e){for(var t,a=0,l=ZCL_getEleWdt("zcl_lftsec"),c=l,i=(e=e-l,ZCL_$("zcl_adaygrid").children),n=0;n<i.length;n++){if((e-=t=i[n].getBoundingClientRect().width)<0){a=n;break}c+=t}return[a,c]},ZCL_dragreturn=function(e,t,a){var l=Math.round(e.offsetTop),c=Math.round(e.offsetTop+e.offsetHeight);l=ZCL_pxToTime(l),c=ZCL_pxToTime(c);var i=e.id,n=a.SD,r=a.ST,s=e.offsetLeft,d=a.ED,o=a.ET,u=zcal.getWeekStart(),p=zcal.today.clone();if(0!=zcal.view&&p.setDate(p.getDate()-p.getDay()+u),0!=s){var m,_,z,f,v;if(m=parseInt(e.getAttribute("gridNo"),10),p.setDate(p.getDate()+m),_=p.dateBy("yyyyMMdd"),z=p.dateBy("yyyyMMdd"),n==_&&r==l&&o==("2400"==c?"0000":c))return zcalView.plotEvents(),!1;if(f=zcal.findDuration(a),"bot"==t){if(n!=d&&_==n&&"0000"!=o&&"2400"!=o)return zcalView.plotEvents(),!1;_=n,l=r}else if("top"==t){var h=parseInt(l/100,10),g=l%100;p.setHours(h,g,0,0),p.setTime(p.getTime()+f),z=p.dateBy("yyyyMMdd"),c=p.dateBy("HHmm")}v={SD:_,ED:z,ST:l,ET:c,EID:i,CNAME:a.CNAME,EUID:a.EUID,RIDX:a.RIDX,ORG:a.ORG,ADAY:a.ADAY,ETZ:a.ETZ,IN_ETZ:a.IN_ETZ,USTAT:a.USTAT},zcalQAdd.chkAttAndEdit(v)}},zcal.getWeekStart=function(){if(0==zcal.view)return 0;if(2==zcal.view)return zcal.cdata.opt.WS;if(1==zcal.view){var e=zcal.today.clone(),t=zcal.cdata.opt.WK;return e.getDay()<t&&(t-=7),t}},zcal.qkAllday=function(e,t){var a,l,c,i,n,r;if(ZCL_clrStck(),a=zcal.getWeekStart(),l=zcal.today.clone(),i=(c=ZCL_$("zcl_allLay")).offsetWidth,n=ZCL_findPosXX(c),r=(e.clientX-n)%i,i-zcalInit.scrollWidth()<=r)return!1;r=e.clientX-ZCL_findPosXX(ZCL_$("zcl_aencloser"));var s=ZCL_getWeekGridNo(r);if(0!=zcal.view){l.setDate(l.getDate()-l.getDay()+a);var d=s[0];l.setDate(l.getDate()+d)}var o=l.dateBy("yyyyMMdd");zcal.openAQBook({SD:o,ST:0,ED:o,ET:0,ADAY:1,ORG:zcal.userid},l,e)},ZCL_editEve=function(e,t,a,l){var c=zcal.getCalObj(a),i="/cal/eInfo.do?ckey="+c[9]+"&ekey="+l+"&calmode="+zcal.CALMODE+(1==zcal.CALMODE?"&grpid="+zcal.ZGID:"");i+="&eveId="+(-1!=e.indexOf("_")?e.substring(0,e.indexOf("_"))+"&date="+e.substring(e.indexOf("_")+1,e.length):e),ZCL_TRIDX&&"undefined"!=ZCL_TRIDX&&(i+="&ridx="+ZCL_TRIDX),ZCL_REPINST&&null!=ZCL_REPINST&&"undefined"!=ZCL_REPINST&&null!=ZCL_REPINST&&(i+="&rbrkdate="+ZCL_REPINST),ZCL_XHR(i,function(e){ZCL_processEventData(e,a,c[14])}),ZCL_stopEvents(t)},ZCL_openEventView=function(e,a,t){ZCL_uXHR("/cal/veInfo.do?uid="+e+"&caluid="+t,function(e){var t=ZCL_Evl(1,e.responseText);zcal.GOBJ[t.EID]=t,zcal[t.EID]={},zcal[t.EID].EMODE=0,ZCL_constEventView(t,t.EID),ZCL_stopEvents(a)})},zcal.GOBJ={},ZCL_processEventData=function(e,t,a){var l=ZCL_Evl(1,e.responseText);if(l.NO_DATA)ZCL_slideObj.status(ZCL_ALERTS.eventnotfound);else if("crm"==l.mode||"recruit"==l.mode)"success"==l.status&&(zcal.EOBJ[l.eobj.EID]=l.eobj,zcal.EOBJ[l.eobj.EID].CNAME=t,zcalCRM.updateCRMData(l,l.eobj));else if("ztask"==a){var c=l.PARENT_EVENT_ID?l.PARENT_EVENT_ID:l.EID;zcal.EOBJ[c]=l,zcalTask.updateTaskData(c)}else{ZCL_TEMP_ADAY=l.ADAY;var i=1<l.EID.split("_").length?l.EID.split("_")[0]:l.EID;zcal.GOBJ[i]=l,ZCL_constEventView(l,i)}},ZCL_reqEveDesc=function(e,t,a,l){var c=zcal.getCalObj(a);ZCL_uXHR("/cal/getDesc.do?ckey="+c[9]+"&euid="+l+"&mode=desc",ZCL_retEveDesc),ZCL_stopEvents(t)},ZCL_retEveDesc=function(e){var t=ZCL_Evl(1,e.responseText);if(ZCL_$("zcl_qview")){var a=ZCL_$("zcl_qview"),l=ZCL_$("zcl_qdesc"),c=ZCL_$("zcl_mlink"),i=ZCL_$("zcl_othSer");if(t.DESC&&""!=t.DESC.trim()){if(l.style.display="",l.innerHTML="<li><div class='zcl_frmtcp'>"+zcal.i18n.description+"</div><p class='zcl_desc' id='zcl_deschtml'></p>",ZCL_$("zcl_deschtml")){var n=ZCL_LinkParser(t.DESC);for(var r in n)3==n[r].nodeType&&n[r].nodeValue.match(/\s/)&&(n[r].nodeValue=n[r].nodeValue.replace(/\s/g,"")),ZCL_$("zcl_deschtml").appendChild(n[r])}var s=document.body.offsetHeight-26>zcalMY+a.offsetHeight?zcalMY:zcalMY-a.offsetHeight;a.style.top=s+"px",l.style.display=""}else l.style.display="none";if(t.MLINK?(c.style.display="",c.innerHTML="<li><div class='zcl_frmtcp';>"+zcal.i18n.met_scheduled+"</div><div ><a style='padding: 0 10px;word-wrap: break-word;display: block;overflow: hidden;text-decoration:none;white-space: normal;' class='zcl_lk' href='"+t.MLINK+"' target='_blank'>"+(-1!=t.MLINK.indexOf("start")?zcal.i18n.met_start:zcal.i18n.met_join)+"</a></div></li>"):c.style.display="none",t.RTO&&0<t.RTO.length){var d,o,u="",p=ZCL_getOthSrv();d=p[0].split(","),o=p[1].split(","),d.push("lnk:links"),o.push("7");for(var m=t.RTO,_=0;_<d.length;_++){var z=d[_].split(":")[0],f=d[_].split(":")[1];if(1==m[o[_]]){if("met"==z)continue;var v="lnk"==z?zcal.i18n["vass_"+z]:ZCL_replaceComName(zcal.i18n["vass_"+z]);u+='<li data-service="e'+z+'" data-marker="eventRTO"><i class="msi-'+f+'" title="'+v+'" alt="'+v+'"></i></li>'}}""!=u&&(i.style.display="",i.innerHTML='<ul><li><ul class="zcl_qvassc">'+u+"</ul></li></ul>",$(i).off("click").on("click",function(e){var t=e.target||e.srcElement,a="I"==t.tagName?t.parentNode:t;if("eventRTO"==a.getAttribute("data-marker")){var l=i.getAttribute("data-id");ZCL_callService(a.getAttribute("data-service"),l,e)}}))}}};var ZCL_TEMP_EOBJ,ZCL_TEMP_ADAY,ZCL_MYTIT,ZCL_TRIDX=null,ZCL_REPINST=null,ZCL_REP_INST=null;ZCL_AgenEveDetail=function(e,t,a,l,c,i,n){var r=n.PARENT_EVENT_ID?n.PARENT_EVENT_ID:1<e.split("_").length?e.split("_")[0]:e;-1!=e.indexOf("_")&&e.substring(0,e.indexOf("_"));-1!=e.indexOf("_")&&(ZCL_TRIDX=c,ZCL_REPINST="null"!=i?i:null),zcal[r]={},zcal[r].EMODE=0,ZCL_editEve(e,t,a,l)},ZCL_StdDate=function(e){if(1==[zcl_cdata.opt.DF])return e;var t=zcal.DFORMAT[zcl_cdata.opt.DF],a=t.indexOf("dd"),l=t.indexOf("MM"),c=t.indexOf("yyyy");return t=e.substring(a,a+2)+"/"+e.substring(l,l+2)+"/"+e.substring(c,c+4)},ZCL_detailObj=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a="";ZCL_DELRTO=1,""==(ZCL_MYTIT=(ZCL_TEMP_EOBJ=e).SUM)&&(ZCL_MYTIT="NO SUBJECT"),255<ZCL_MYTIT.length&&(a+="TITLE : "+ZCL_MYTIT+" \n\n",ZCL_MYTIT=ZCL_MYTIT.slice(0,255)),ZCL_MYTIT=ZCL_MYTIT.zcalescape();var l=e.LOC.replace(zcal.REG,"").zcalescape();a+=e.DESC.zcalescape();var c=e.LINK&&e.LINK.replace(zcal.REG,"").zcalescape(),i=zcal.getCalObj(e.CNAME);e.EPERM=""!=e.EPERM?e.EPERM:2<=i[12]?2:1==i[12]?1:0,e.DPERM=""!=e.DPERM?e.DPERM:2<=i[12]?2:0;var n=i[9],r="/cal/ae.do?title="+ZCL_MYTIT+"&ckey="+n+"&desc="+a+"&all="+e.ADAY+"&busy="+e.TRANS+"&loc="+l+"&imp="+e.IMP+"&class="+e.CLASS+"&ctype="+i[5];r+="&ecolor="+(e.EC?e.EC:"-1"),r+="&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&sd="+e.SD+"&st="+e.ST+"&ed="+e.ED+"&et="+e.ET+"&etsk="+e.ETSK+"&ents="+e.ENTS+"&emet="+e.EMET+"&ecrm="+e.ECRM,r+=e.ISDMY?"&isdmy="+e.ISDMY:"",e.MSGID&&e.ACCID&&(r+="&msgId="+e.MSGID+"&accId="+e.ACCID),e.Attachment&&""!=e.Attachment&&(r+="&fileId="+e.Attachment),e.RMAttachment&&""!=e.RMAttachment&&(r+="&rmAttachId="+e.RMAttachment),r+=e.LINK?"&eurl="+c:"",r+=""!=e.ETZ?"&etz="+e.ETZ.zcalescape()+"&inetz="+e.IN_ETZ:"",r+=e.ATT?"&att="+e.ATT.zcalescape():"",r+=e.RMVATT?"&rmatt="+e.RMVATT.zcalescape():"",r+="&mty="+zcal.cdata.opt.MT,r+=e.GATT&&0<e.GATT.length?"&gatt="+e.GATT.join(","):"",r+=e.RMVGATT?"&rmgatt="+e.RMVGATT:"",r+=e.USTAT?"&custat="+e.USTAT:"",r+=e.UCMNT?"&cucmt="+e.UCMNT:"",r+=e.SKEY?"&skey="+e.SKEY:"",r+="&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend=",r+=zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),-1<e.NTFY&&(r+="&ntfy="+e.NTFY),""!=e.EID?(-1!=e.EID.indexOf("_")?(r+="&eid="+e.EID.substring(0,e.EID.indexOf("_")),0==e.TYPE||1==e.TYPE?r+="&type="+e.TYPE+"&mode=recurE"+(null!=e.REPINST&&""!=e.REPINST?"&rbrkdate="+e.REPINST:"")+"&ekey="+e.EUID:2==e.TYPE&&0==e.RIDX?(ZCL_TEMP_EOBJ.TYPE=1,r+="&mode=edit&ekey="+e.EUID):(e.HASATTACH&&(e.HASATTACH=!1),r+="&type="+e.TYPE+"&mode=recurE"+(null!=e.REPINST&&""!=e.REPINST?"&rbrkdate="+e.REPINST:"")+"&ekey="+e.EUID)):r+="&mode=edit&eid="+e.EID+"&ekey="+e.EUID,r+="&oldCkey="+t.find("#zcl_oldCkey")[0].value+"&isOthDel="+e.DELRTO+"&emil="+e.EMIL,e.HASATTACH&&(r+="&hasAttach="+e.HASATTACH)):(r+="&mode=add",ZCL_TEMP_EOBJ.USTAT=1,r+="&invite_allmembers="+e.INVITE_ALL);var s=e.ALARM;s&&(r+="&isrem=true&remt="+s[0].REMTIME+"&remty="+s[0].REMTYPE+"&actty="+s[0].ACTYPE+"&wrksh="+zcal.cdata.opt.HS);var d=e.REP;d&&(r+="&isrep=true&repf="+d.RFRQ+"&rivl="+d.RIVL+"&rbyon="+d.ROPT+"&rday="+d.RDAY.join(",")+"&towk="+d.RTOWK+"&rdate="+d.RDATE+"&rmon="+d.RMON+"&repc="+d.RCNT+"&until="+(""!=d.RUTL.trim()?ZCL_putDate(d.RUTL):"")),ZCL_XHR(r+="&calmode="+zcal.CALMODE,ZCL_retDET)},ZCL_retDET=function(e){zcal.adStck(new Array("zcl_loading","zcl_mask","zcl_mask1"));var t=ZCL_Evl(1,e.responseText);if("success"==t.status){if(t.hasOwnProperty("SUBTASKS"))for(var a=t.SUBTASKS,l=0;l<a.length;l++){var c=a[l];c.ETYPE=3,ZCL_retEve(c)}ZCL_retEve(t),ZCL_eClose(),"c"!=zmApp.currentApp&&(zcal.neweevent=!0)}else if("error"==t.status){if(t.param&&"eurl"==t.param)zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_ce_lnk")[0].focus(),zmUtil.succErrMsg("e",zcal.i18n["err_"+t.param]);else zmUtil.succErrMsg("e",zcal.i18n[t.error]),ZCL_clrStck(),ZCL_eClose();ZCL_closeloding()}else"failure"==t.status?zmUtil.succErrMsg("e",t.message):(zmUtil.succErrMsg("e",t.status),ZCL_clrStck(),ZCL_eClose()),ZCL_closeloding()},ZCL_retEve=function(e){var t=zcal.i18n.evtadded;if(zmsuite.isWorkspaceAvailable("zcal_Container")){var a=e.id,l=e.rdats?e.rdats:"",c=(e.oid&&e.oid,e.ordats?e.ordats:""),i=e.SKEY,n=e.USTAT,r=n&&""!=n?1:0,s=e.ATTEMAIL,d=e.ETYPE?e.ETYPE:0,o={CNAME:ZCL_TEMP_EOBJ.CNAME,ORG:e.ORG,SD:e.SD?e.SD:ZCL_DFDate(ZCL_TEMP_EOBJ.SD),ED:e.ED?e.ED:ZCL_DFDate(ZCL_TEMP_EOBJ.ED),ST:e.ST?e.ST:ZCL_TEMP_EOBJ.ST,ET:e.ET?e.ET:ZCL_TEMP_EOBJ.ET,SUM:e.SUM,LOC:ZCL_TEMP_EOBJ.LOC,REF:[0,1,r,0==ZCL_TEMP_EOBJ.TYPE?1:0,ZCL_TEMP_EOBJ.ALARM?1:0],RTO:[0,0,ZCL_TEMP_EOBJ.EMET,ZCL_TEMP_EOBJ.ETSK,ZCL_TEMP_EOBJ.ENTS,ZCL_TEMP_EOBJ.ECRM,ZCL_TEMP_EOBJ.EMIL,""==ZCL_TEMP_EOBJ.LINK?0:1],ADAY:ZCL_TEMP_EOBJ.ADAY,EPERM:ZCL_TEMP_EOBJ.EPERM,DPERM:ZCL_TEMP_EOBJ.DPERM,EC:ZCL_TEMP_EOBJ.EC,EUID:e.euid,ISEXP:e.ISEXP?e.ISEXP:0,ETYPE:d,HASATTACH:!!e.HASATTACH&&e.HASATTACH};if(t=3==o.ETYPE?zcal.i18n.taskadded:zcal.i18n.evtadded,ZCL_TEMP_EOBJ.ETZ&&(o.ETZ=ZCL_TEMP_EOBJ.ETZ,ZCL_TEMP_EOBJ.IN_ETZ?o.IN_ETZ=1:o.IN_ETZ=0),s&&""!=s&&(o.ATTEMAIL=s),i&&""!=i&&(o.USTAT=n,o.SKEY=i),ZCL_TEMP_EOBJ.REP)(m={}).RPDT=ZCL_DFDate(ZCL_TEMP_EOBJ.SD),o.REP=m;e.APL_REQ&&1==e.APL_REQ&&(o.APL_REQ=e.APL_REQ);var u=ZCL_Evl(1,'{"'+a+'":'+JSON.stringify(o)+"}");o.EID=a;var p=JSON.stringify(o);if(""!=ZCL_TEMP_EOBJ.EID){t=3==o.ETYPE?zcal.i18n.taskedited:zcal.i18n.evtedited;var m,_=-1!=ZCL_TEMP_EOBJ.EID.indexOf("_")?ZCL_TEMP_EOBJ.EID.substring(0,ZCL_TEMP_EOBJ.EID.indexOf("_")):ZCL_TEMP_EOBJ.EID,z=zcalEvents.remEve(_,!1,!0);if(z=z||zcalEvents.remEve(_,!0,!0),u[a].REF[3]=1==z[_].REF[3]?1:u[a].REF[3],""!=c&&ZCL_insertRepEvents(z,c,_),s&&""!=s&&(o.ATTEMAIL=s),i&&""!=i&&(o.USTAT=n,o.SKEY=i),ZCL_TEMP_EOBJ.REP)(m={}).RPDT=ZCL_DFDate(ZCL_TEMP_EOBJ.SD),o.REP=m;e.APL_REQ&&1==e.APL_REQ&&(o.APL_REQ=e.APL_REQ);u=ZCL_Evl(1,'{"'+a+'":'+JSON.stringify(o)+"}");o.EID=a;p=JSON.stringify(o)}if(""!=l?ZCL_insertRepEvents(u,l,a):(ZCL_TEMP_EOBJ&&0==ZCL_TEMP_EOBJ.TYPE&&delete u[a].REP,ZCL_insertEvent(u,a)),4==zcal.view&&(""!=l||""!=c?zcalAgenda.dispEvents():""!=ZCL_TEMP_EOBJ.EID?zcalAgenda.edit(p):zcalAgenda.add(p)),null!=ZCL_TEMP_EOBJ.ACCID&&null!=ZCL_TEMP_EOBJ.MSGID&&""!=ZCL_TEMP_EOBJ.ACCID&&""!=ZCL_TEMP_EOBJ.MSGID){var f=ZCL_TEMP_EOBJ.CNAME;ZCL_TEMP_EOBJ.successCallbk(e.msgId,e.id,f)}zcalView.plotEvents()}else if(null!=ZCL_TEMP_EOBJ.ACCID&&null!=ZCL_TEMP_EOBJ.MSGID&&""!=ZCL_TEMP_EOBJ.ACCID&&""!=ZCL_TEMP_EOBJ.MSGID){f=ZCL_TEMP_EOBJ.CNAME;ZCL_TEMP_EOBJ.successCallbk(e.msgId,e.id,f)}ZCL_enableCal(ZCL_TEMP_EOBJ.CNAME),zmUtil.succErrMsg("s",t)},ZCL_insertEvent=function(e,t){var a=e[t].SD,l=e[t].ED,c=e[t].ET,i=zcal.findDuration(e[t]);if(e[t].DUR=i,a!=l&&864e5<=i||1==e[t].ADAY)zcalMulti.appEvent(e,a);else if(zcalEvents.appEvent(e,a),a!=l&&"0000"!=c){var n=ZCL_parseDateStr(l),r=(n.getTime(),parseInt(c.substring(0,2),10)),s=parseInt(c.substring(2,4),10);n.setHours(r,s,0,0);n.getTime();zcalEvents.appEvent(e,l)}},ZCL_insertRepEvents=function(e,t,a){var l=zcal.findDuration(e[a]);for(var c in t){var i=t[c].SD,n=t[c].ED,r=t[c].ST,s=t[c].ET;if(e[a].SD=i,e[a].ED=n,e[a].ST=r,e[a].ET=s,e[a].RIDX=t[c].RIDX,null!=t[c].REPINST&&(e[a].REPINST=t[c].REPINST),i!=n&&864e5<=l||1==e[a].ADAY)zcalMulti.appEvent(e,i);else if(zcalEvents.appEvent(e,i),i!=n&&"0000"!=e[a].ET){var d=ZCL_parseDateStr(n),o=(d.getTime(),parseInt(e[a].ET.substring(0,2),10)),u=parseInt(e[a].ET.substring(2,4),10);d.setHours(o,u,0,0);d.getTime();zcalEvents.appEvent(e,n)}}},zcal.findDuration=function(e){var t=ZCL_parseDateStr(e.SD),a=parseInt(e.ST.substring(0,2),10),l=parseInt(e.ST.substring(2,4),10);t.setHours(a,l,0,0);var c=ZCL_parseDateStr(e.ED);return a=parseInt(e.ET.substring(0,2),10),l=parseInt(e.ET.substring(2,4),10),c.setHours(a,l,0,0),c.getTime()-t.getTime()},zcal.eveDetail=function(e,t,a,l){t=window.event?window.event:t;zcal.setQuickViewDiv(),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1),zcal.CAStck(["zcl_qview"]);var c=-1!=e.indexOf("_")?e.substring(0,e.indexOf("_")):e,i=l[0],n=l[2],r=l[1],s=l[3],d=zcalEvents.getEve(c,!1,i);d=d||zcalEvents.getEve(c,!0,i);var o=$("#zcl_qview"),u=l[6],p=l[8],m="",_="",z=ZCL_getHTML(d[c].SUM),f={calId:d[c].CNAME,ekey:d[c].EUID,rel:e,ridx:l[7]&&"undefined"!=l[7]?l[7]:void 0,rbrkdate:l[9]&&"undefined"!=l[9]?l[9]:void 0,par_id:d[c].PARENT_EVENT_ID?d[c].PARENT_EVENT_ID:void 0};d[c].USTAT&&(f.USTAT=d[c].USTAT),d[c].APL_REQ&&1==d[c].APL_REQ?m+='<ul><li><div style="margin-top: 10px;color: red;margin-left:8px"><i class="msi-spam" style="color: red;"></i> '+zcal.i18n.waitingforapproval+"</div></li></ul>":d[c].CRM_STATUS&&2==d[c].CRM_STATUS&&(m+='<ul><li><div style="margin-top: 10px;color: red;margin-left:8px"><i class="msi-spam" style="color: red;"></i> '+zcal.i18n.cancelled+"</div></li></ul>"),z=""==z?"NO SUBJECT":z,m+='<li class="zcl_table">',1==d[c].ETYPE?(m+='<ul class="zcl_bday">',m+=d[c].CPHOTO&&""!=d[c].CPHOTO?'<li><img src="'+d[c].CPHOTO+'" class="zcl_cphoto" id="zcl_cphoto" alt="Contact Photo"/></li>':"",_+=d[c].CEMAIL&&""!=d[c].CEMAIL?'<span class="zcl_greymr">'+d[c].CEMAIL+"</span>":""):m+="<ul>",ZCL_REP_INST=d[c].REPINST?d[c].REPINST:"",a=-1!=e.indexOf("_")?e.substring(e.indexOf("_")+1,e.length):a;var v=ZCL_parseDateStr(a),h=i?zcalMulti.retdate(a,ZCL_daysBetween(i,n)):v,g=v.dateBy(zcal.QEDITFMT);if(1==d[c].ADAY?g+=i!=n?" - "+h.dateBy(zcal.QEDITFMT):"":(g+=" "+ZCL_timeInUFormat(r),g+=i!=n?" - "+h.dateBy(zcal.QEDITFMT)+" ":" - ",g+=ZCL_timeInUFormat(s)+(d[c].IN_ETZ&&1==d[c].IN_ETZ&&d[c].ETZ&&""!=d[c].ETZ?" ("+d[c].ETZ+")":"")),m+='<li><div class="zcl_frmttcp">'+z+_+"</div><p>"+(d[c].LOC&&""!=d[c].LOC?ZCL_replaceString(zcal.i18n.timeAndloc,[g,ZCL_getHTML(d[c].LOC)]):g)+"</p></li>",m+="</ul>",null!=d[c].USTAT){var C=d[c].USTAT,y=[zcal.i18n.pending,zcal.i18n.yes,zcal.i18n.no,zcal.i18n.maybe];d[c].ORGEMAIL&&(m+='<ul><li><div class="zcl_frmtcp">'+zcal.i18n.organizer+'</div><p class="zcl_lk">'+d[c].ORGEMAIL+"</p></li></ul>"),m+='<ul><li><div class="zcl_frmtcp">'+zcal.i18n.areyoucoming;for(var L="",b=1;b<4;b++)L+="<li "+(C==b?'class="zcl_sl"':"")+" data-ustatus="+b+">"+y[b]+"</li>";m+='</div><ul class="zcl_qvsup" data-marker="statusUpdate" data-skey="'+d[c].SKEY+'">'+L+"</ul>",m+="</li></ul>"}m+='<ul id="zcl_othSer" style="display:none" data-id="'+c+'"></ul>',m+='<ul id="zcl_mlink" style="display:none"></ul>',m+='<ul id="zcl_qdesc" style="display:none"></ul></li>',m+='<li><div class="zcl_table"><ul><li><ul class="zcl_qvnv">';var E="";"0"==u&&"0"==p||(E+='<li data-marker="eventView">'+zcal.i18n.view+"</li>",E+="2"==u?'<li><div class="zcl_SDot"></div></li><li data-marker="eventEdit">'+zcal.i18n.edit+"</li>":"",E+="0"!=p?'<li><div class="zcl_SDot"></div></li><li data-marker="eventDelete">'+("2"==p?zcal.i18n.del:zcal.i18n.removeme)+"</li>":""),m+=(E+=""!=E?'<li><div class="zcl_SDot"></div></li>':"")+'<li onmousedown="ZCL_clrStck()">'+zcal.i18n.close+"</li>",m+='</ul></li><li style="width: 50px;text-align: right;">',"0"==u&&"0"==p||null!=d[c].USTAT&&(m+='<span style="margin-right:16px" data-marker="eventSend" class="SC_ttip" data-tooltip="Send"><i class="msi-send"></i></span>'),zmail.IntegrationStatus&&zmail.IntegrationStatus.CHAT&&(m+='<span data-marker="startChat" class="SC_ttip" data-tooltip="'+zcal.i18n.startchat+'"><i class="msi-cliq"></i></span>'),m+="</ul></li></ul></div></li>",o.css({left:"-1000px"}),o.html(m);var T=o.find("[data-marker=eventView]"),D=o.find("[data-marker=eventEdit]"),Z=o.find("[data-marker=eventDelete]"),A=o.find("[data-marker=statusUpdate]"),M=o.find("[data-marker=eventSend]"),S=o.find("[data-marker=startChat]");T.length&&(T.removeAttr("data-marker"),T.off("mousedown").on("mousedown",{eobj:f},function(e){ZCL_REPINST=e.data.eobj.rbrkdate,ZCL_TRIDX=e.data.eobj.ridx,ZCL_Dview(e.data.eobj.rel,e,e.data.eobj.calId,e.data.eobj.ekey,e.data.eobj.par_id)})),D.length&&(D.removeAttr("data-marker"),D.off("mousedown").on("mousedown",{eobj:f},function(e){ZCL_REPINST=e.data.eobj.rbrkdate,ZCL_TRIDX=e.data.eobj.ridx,ZCL_Dedit(e.data.eobj.rel,e,e.data.eobj.calId,e.data.eobj.ekey,e.data.eobj.par_id)})),Z.length&&(Z.removeAttr("data-marker"),Z.off("mousedown").on("mousedown",{eobj:f},function(e){ZCL_Qdel(e.data.eobj)})),A.length&&(A.removeAttr("data-marker"),A.off("mousedown").on("mousedown",{eobj:f,eventId:e},function(e){var t=$(this),a=zcal.NN6?e.target:event.srcElement,l=t.data("skey"),c=$(a).data("ustatus"),i=e.data.eventId;eKey=e.data.eobj.ekey,calId=e.data.eobj.calId,ZCL_Estatup(c,l,i,eKey,calId)})),M.length&&(M.removeAttr("data-marker"),M.off("mousedown").on("mousedown",{eobj:f},function(e){ZCL_eveInfo(e.data.eobj.rel,e,e.data.eobj.calId,e.data.eobj.ekey,"send")})),S.length&&(S.removeAttr("data-marker"),S.off("mousedown").on("mousedown",{eobj:f},function(e){ZCL_eveInfo(e.data.eobj.rel,e,e.data.eobj.calId,e.data.eobj.ekey,"chat")})),o.show(),ZCL_MouseXY(t);var k=document.body.offsetWidth>zcalMX+o[0].offsetWidth+20?zcalMX:zcalMX-o[0].offsetWidth,w=document.body.offsetHeight>zcalMY+o[0].offsetHeight+97?zcalMY:zcalMY-o[0].offsetHeight;o.css({top:w+"px",left:k+"px"}),ZCL_reqEveDesc(e,t,d[c].CNAME,d[c].EUID),ZCL_stopEvents(t)},ZCL_getOthSrv=function(){var e="",t="";return""!=zcal.ZCRM&&zcal.isCRMUser&&(t+=""!=t?",crm:crm":"crm:crm",e+=""!=e?",5":"5"),""!=zcal.ZMET&&(t+=""!=t?",met:meeting":"met:meeting",e+=""!=e?",2":"2"),""!=zcal.ZTSK&&zcal.IsTaskUser&&(t+=""!=t?",tsk:task":"tsk:task",e+=""!=e?",3":"3"),""!=zcal.ZNTS&&zcal.IsTaskUser&&(t+=""!=t?",nts:notes":"nts:notes",e+=""!=e?",4":"4"),""!=zcal.ZMIL&&(t+=""!=t?",mil:mail":"mil:mail",e+=""!=e?",6":"6"),[t,e]},ZCL_array_unique=function(e){var t=new Array;for(var a in e)ZCL_in_array(e[a],t)||t.push(e[a]);return t},ZCL_in_array=function(e,t){for(var a in t)if(t[a]==e)return!0;return!1},ZCL_Estatup=function(e,t,a,l,c){if(!zcal.ISRO){var i=zcal.getCalObj(c)[9],n=(-1!=a.indexOf("_")&&a.substring(a.indexOf("_")+1,a.length),a.substring(a.indexOf("_")+1,a.length));ZCL_XHR("/cal/cuStat.do?eid="+n+"&custat="+e+"&skey="+t+"&ckey="+i+"&ekey="+l+"&calmode="+zcal.CALMODE,function(e){var t=ZCL_Evl(1,e.responseText);ZCL_updateSts(n,t.STS),zcalView.plotEvents()})}},ZCL_updQuickRepStatus=function(e,i){ZCL_REP_SD=null!=i.sd?i.sd:null;var t="/cal/cuStat.do?custat="+i.custat+"&eid="+i.eid+"&skey="+i.skey+"&ckey="+i.ckey+"&ekey="+i.ekey+"&calmode="+i.calmode;ZCL_XHR(t+="&repinst="+i.repinst+"&recuredit="+e+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF],function(e){var t=ZCL_Evl(1,e.responseText);if(ZCL_updateSts(i.eid,t.STS),t.ordats||t.rdats){var a=t.oid;ZCL_TEMP_EOBJ=zcalEvents.getEve(a,!1,ZCL_REP_SD);var l=zcalEvents.getEve(a,!1,ZCL_REP_SD);l=l||zcalEvents.getEve(a,!0,ZCL_REP_SD),ZCL_TEMP_EOBJ=ZCL_TEMP_EOBJ||l;var c=Object.keys(ZCL_TEMP_EOBJ);(ZCL_TEMP_EOBJ=ZCL_TEMP_EOBJ[c]).SD=ZCL_putDate(ZCL_TEMP_EOBJ.SD),ZCL_TEMP_EOBJ.ED=ZCL_putDate(ZCL_TEMP_EOBJ.ED),ZCL_TEMP_EOBJ.EID=a,t.updRepStatus=!0,ZCL_retEve(t),ZCL_TEMP_EOBJ=null}else zcalView.plotEvents()})},ZCL_updateSts=function(e,t){if(t&&("1"==t||"2"==t||"3"==t)){var a=zcalEvents.remEve(e,!1,!1)?zcal.cdata.evelst:zcal.cdata.eveAll;for(var l in a)for(var c=0;c<a[l].length;c++){var i=a[l][c];for(var n in i)n==e&&(i[n].USTAT=t)}zmUtil.succErrMsg("s",zcal.i18n.statusupdated)}},ZCL_callService=function(e,t,a){ZCL_clrStck(),"ecrm"==(ZCL_SERVICE=e)||"emet"==e||"emil"==e?(window.open(location.protocol+"//"+zcal.ZCAL+"/cal/nxtPag.do?sname="+e+"&evid="+t,"_blank"),ZCL_stopEvents(a)):ZCL_XHR("/cal/viewOth.do?sname="+(ZCL_SERVICE=e)+"&evid="+t+"&mode=1",ZCL_serviceRes)},ZCL_CheckUserInOtherServices=function(){ZCL_isTaskUser(),ZCL_isCRMUser()},ZCL_isTaskUser=function(){""!=zcal.ZTSK&&ZCL_uXHR("/cal/getPortal.do?mode=task-sync",function(e){var t=ZCL_Evl(1,e.responseText);"success"===t.status&&(zcal.IsTaskUser=t.isMailSuiteUser||!1)})},ZCL_isCRMUser=function(){""!=zcal.ZCRM&&ZCL_uXHR("/cal/getPortal.do?mode=iscrmuser",function(e){null!=e&&"success"===ZCL_Evl(1,e.responseText).status&&(zcal.isCRMUser=!0)})},ZCL_setWorkDays=function(){var e=zcal.cdata.opt.WS,t=zcal.cdata.opt.WE,a=[];if(t<e){for(;e<=6;)a.push(e),e++;e=0}for(var l=e;l<=t;l++)a.push(l);return a},ZCL_getTZ=function(t){ZCL_uXHR("/cal/timez.do",function(e){zcal.timezones=ZCL_Evl(1,e.responseText),t.callback&&t.callback()})},ZCL_shCalAdd=function(){zcal.refreshTimer&&window.clearTimeout(zcal.refreshTimer),"UPDATE CALENDAR WITH EVENTS"==zcal.refreshMode?ZCL_uXHR("/cal/calendars",function(e){var t=ZCL_Evl(1,e.responseText);zcal.cdata.calLst=t.calLst,zcal.cdata.calOLst=t.calOLst,zcal.cdata.calOUids=t.calOUids,zcal.cdata.calGLst=t.calGLst,zcal.cdata.calByGrp=t.calByGrp,zcalInit.ZCL_setGrpCal(t.calGLst),ZCL_updateAppCalList(t.calALst),ZCL_setCalendars(),zcalEvents.loadMonthData(),4==zcal.view&&zcalAgenda.dispEvents()}):"UPDATE EVENTS ONLY"==zcal.refreshMode&&(zcalEvents.loadMonthData(),4==zcal.view&&zcalAgenda.dispEvents()),zcal.refreshTimer=null,zcal.refreshMode=""},ZCL_updateDeletedEvents=function(e,t){0<e.length&&(ZCL_removeDeletedEvents(e),ZCL_updateEvents(t))},ZCL_removeDeletedEvents=function(e){if(0<e.length){var t=zcal.cdata.eveAll,a=zcal.cdata.evelst,l="";for(var c in t)for(var i=0;i<t[c].length;i++){var n=t[c][i];for(var r in n){-1!=e.indexOf(r)&&(t[c].splice(i--,1),l+=""!=l?","+c:c)}}if(""!=l){var s=l.split(",");for(c=0;c<s.length;c++)t[d=s[c]]&&0==t[d].length&&delete t[d]}for(var c in l="",a)for(i=0;i<a[c].length;i++){n=a[c][i];for(var r in n){-1!=e.indexOf(r)&&(a[c].splice(i--,1),l+=""!=l?","+c:c)}}if(""!=l){var d;for(s=l.split(","),c=0;c<s.length;c++)a[d=s[c]]&&0==a[d].length&&delete a[d]}}},ZCL_fetchRepeatWithChild=function(e,a){ZCL_XHR("/cal/getRepWithChild.do?eid="+e+"&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF],function(e){var t=ZCL_Evl(1,e.responseText);ZCL_updateRepeatEvent(t,a)})},ZCL_updateRepeatEvent=function(e,t){if(e.obj.eobj){var a=e.obj.eobj,l=e.obj.eids;for(var c in ZCL_removeDeletedEvents(l),a)for(var i=0;i<a[c].length;i++){var n=a[c][i];for(var r in n)ZCL_insertEvent(n,r)}ZCL_updateEvents(t)}},ZCL_updateEventsForSharedCal=function(e,t,d){var o,u=ZCL_getCalIdFromCalKey(t);null!=u&&1==(o=zcal.getCalObj(u))[8]&&ZCL_XHR("/cal/updShareCalEve.do?eid="+e+"&cKey="+t+"&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF],function(e){var t=ZCL_Evl(1,e.responseText);if(t.obj.eobj){var a=t.obj.eobj,l=t.obj.euids,c=t.remtype;for(var i in ZCL_removeDeletedEventsUsingUids(l,u),a)for(var n=0;n<a[i].length;n++){var r=a[i][n];for(var s in r)r[s].CNAME=u,c[r[s].EUID]?r[s].REF[4]=c[r[s].EUID]:r[s].REF[4]=o[6].ACTYPE?1:0,ZCL_insertEvent(r,s)}ZCL_updateEvents(d)}})},ZCL_updateDeletedEventsForSharedCal=function(e,t){var a,l=e.ekey.split(","),c=e.ckey;a=ZCL_getCalIdFromCalKey(c),ZCL_removeDeletedEventsUsingUids(l,a),ZCL_updateEvents(t)},ZCL_removeDeletedEventsUsingUids=function(e,t){if(0<e.length){var a=zcal.cdata.eveAll,l=zcal.cdata.evelst,c="";for(var i in a)for(var n=0;n<a[i].length;n++){var r=a[i][n];for(var s in r){var d=r[s].EUID,o=r[s].CNAME;-1!=e.indexOf(d)&&o==t&&(a[i].splice(n--,1),c+=""!=c?","+i:i)}}if(""!=c){var u=c.split(",");for(i=0;i<u.length;i++){a[p=u[i]]&&0==a[p].length&&delete a[p]}}for(var i in c="",l)for(n=0;n<l[i].length;n++){r=l[i][n];for(var s in r){d=r[s].EUID,o=r[s].CNAME;-1!=e.indexOf(d)&&o==t&&(l[i].splice(n--,1),c+=""!=c?","+i:i)}}if(""!=c)for(u=c.split(","),i=0;i<u.length;i++){var p;l[p=u[i]]&&0==l[p].length&&delete l[p]}}},ZCL_getCalIdFromCalKey=function(e){for(var t in zcal.cdata.calLst)if(zcal.cdata.calLst[t][9]==e)return t;for(var t in zcal.cdata.calALst)if(zcal.cdata.calALst[t][9]==e)return t;for(var t in zcal.cdata.calGLst)if(zcal.cdata.calGLst[t][9]==e)return t;for(var a in zcal.cdata.calOLst)if(zcal.cdata.calOLst[a][9]==e)return a},ZCL_updateAppCalList=function(){var e,t=zcal.cdata.calALst;for(var a in zcal.appChild={},zcal.appCount={},t)e=t[a],zcal.appCount[a]={c:"0",p:"-1"},"crm"==e[14]&&(zcal.appChild[a]={CH:zcalCRM.getCRMCalChild(e[1],a)})},ZCL_updateGroupCalList=function(){zcal.ZCAL_MULTICAL_4_GRP&&0==zcal.CALMODE?zcal.gcal=zcalInit.ZCL_setGrpCal():zcal.gcal=zcalInit.formatCalData(zcal.cdata.calGLst,zcal.cdata.gcalOdrArr)},ZCL_loadOthcal=function(){ZCL_XHR("/cal/getOtherCal.do",ZCL_retOthcal)},ZCL_retOthcal=function(e){if(200==e.status){var t=ZCL_Evl(1,e.responseText);zcal.cdata.calALst=t.calALst,zcal.cdata.calByGrp=t.calByGrp,zcal.cdata.calGLst=t.calGLst,zcal.cdata.calLst=t.calLst,zcal.cdata.calOLst=t.calOLst,zcal.cdata.calOUids=t.calOUids,zcal.cdata.crmOrgObj=t.crmOrgObj,zcal.cdata.defCalId=t.defCalId,zcal.cdata.hasAppCal=t.hasAppCal,zcal.cdata.hasGrpCal=t.hasGrpCal,zcal.cdata.hasOthCal=t.hasOthCal,zcalCRM.loadCRMUsers(),zcal.initLoad=!1,zcalEvents.loadMonthData(),ZCL_setCalendars()}else zmUtil.succErrMsg("e",zcal.i18n.errmsg)},ZCL_getSubGrpLst=function(){ZCL_XHR("/cal/subCal.do?mode=sub-strmgrp",ZCL_retDefSubCAL)},ZCL_retDefSubCAL=function(e){if(ZCL_clrStck(),200==e.status){var t=ZCL_Evl(1,e.responseText),a=(t.mode,t.id&&t.id,t.status),l=t;null!=t.group&&(ZCL_GRP_SECTION="disable"!=t.group,ZCL_setCalendars()),t.streamGrpLst&&(ZCL_STREAMGROUPLIST=t.streamGrpLst),zcal.cdata.calGLst="success"==a&&null!=l.calGLst?l.calGLst:zcal.cdata.calGLst,"success"==a&&null!=l.calGLst&&(zcalEvents.loadMonthData(),ZCL_setCalendars())}else zmUtil.succErrMsg("e",zcal.i18n.errmsg)},ZCL_getPOgrpLst=function(){ZCL_uXHR("/cal/groups",ZCL_retPOgrp)},ZCL_retPOgrp=function(e){if(200==e.status){var t=ZCL_Evl(1,e.responseText);zcal.cdata.grpLst=t.grpLst,zcalGroup.loadGroup()}else zmUtil.succErrMsg("e",zcal.i18n.errmsg)},ZCL_closeDownCal=function(){zmsDialog.remove();var e=$("#zcl_secureDow");0<e.length&&e.remove(),zmUtil.hideMenu()},ZCL_secureDow=function(e,t){var a=$(zcalTemplate.popupCreateSecdown()),l={title:"Secure Your files",mask:!0,style:{width:"500px"},buttons:[{txt:"Submit",callback:function(){"export"==e?zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView.ZCL_icsDown(t):"attach"==e?ZCL_attch_pwdDow(t):ZCL_pdfDown()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){ZCL_closeDownCal()}}],closeaction:function(){ZCL_closeDownCal()}};ZCL_$("zcl_secureDow")||$("body").append('<div id="zcl_secureDow" class="zcl_addcalcn"></div>'),$("#zcl_secureDow").html(a),a.find("#zcl_pwd").on("focusout",function(){var e=a.find("#zcl_pwd")[0].value;""==e?($("#zcl_pwd_er")[0].style.display="",$("#zcl_pwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none"):e.length<8?($("#zcl_pwd_er")[0].style.display="",$("#zcl_pwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none"):new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})").test(e)?($("#zcl_pwd_er")[0].style.display="none",$("#zcl_pwd")[0].className="SC_tiput"):($("#zcl_pwd_er")[0].style.display="",$("#zcl_pwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none")}),a.find("#zcl_repwd").on("focusout",function(){""==a.find("#zcl_repwd")[0].value&&($("#zcl_repwd_er")[0].style.display="",$("#zcl_repwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none")}),zmsDialog.create("zcl_secureDow",l)},zcal.qObj={},zcal.setQuickViewDiv=function(e){zcal.CAStck(["zcl_qview"]);var t=$("#zcl_qview");t.length||(t=$('<ul id="zcl_qview" class="zcl_qview" style="display:none"></div>'),$("body").append(t)),t.removeAttr("class").addClass(e&&e.class||"zcl_qview")},zcal.setQuickCreateDiv=function(i){var e,t,a=new Date(zcal.cdate),l=zcal.timeformat[zcal.cdata.opt.TF];t=46<(t=2*a.getHours()+(30<a.getMinutes()?2:1))?46:t,zcal.TTT[t].getTimeBy(l),zcal.TTT[t+1].getTimeBy(l),ZCL_$("zcl_qbk")||document.body.appendChild($("<ul id='zcl_qbk' class='zcl_qbook'>")[0]),(e=$("#zcl_qbk")).empty();var c='<li class="zcl_qbtitl" id="zcl_qbkTop">'+(3==zcal.view?zcal.qObj.SD==zcal.qObj.ED?'<input type="text" placeholder="'+zcal.i18n.eventplaceholder+'" class="SC_tiput zcl_Qbk" id="zcl_qbkttl"/>':'<input type="text" placeholder="'+zcal.i18n.alldayeventplaceholder+'" class="SC_tiput zcl_Qbk" id="zcl_qbkttl"/>':'<input type="text" placeholder="'+zcal.i18n.eventtitle+'" class="SC_tiput zcl_Qbk" id="zcl_qbkttl"/>')+'<input type="text" placeholder="'+zcal.i18n.loc+'" class="SC_tiput zcl_Qloc" id="zcl_qbkloc"/></li><li class="zcl_qbcnt" id="zcl_qbkBot"><ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.calendar+'</li><li><div class="SC_select"><input rel="'+zcal.cdata.defcal+'" id="zcl_qbkcal" value="'+ZCL_getHTML(zcal.cdata.calLst[zcal.cdata.defcal][0])+'"></div></li></ul><ul><li class=""><div class="SC_PUbtm"><span class=" js-button-selector" data-id="0" id="zcl_cr_btn">'+zcal.i18n.create+'</span><b id="zcl_mr_lk" class="zcl_lk">'+zcal.i18n.moredet+' </b></div></li></ul></li><input type="hidden" value="'+ZCL_putDate(zcal.qObj.SD)+'" id="zcl_qbksd"/><input type="hidden" value="'+ZCL_putDate(zcal.qObj.ED)+'" id="zcl_qbked"/><a class="zcl_qbl" id="zcl_qbkA"></a>';e.html(c);var n=e.find("#zcl_qbkttl"),r=e.find("#zcl_cr_btn"),s=e.find("#zcl_mr_lk");n.off("keydown").on("keydown",function(e){13==(e.which||e.keyCode)&&zcal.quickCreate()}),r.off("click").on("click",function(e){zcal.quickCreate()}),s.off("click").on("click",function(e){ZCL_QDetail()}),e.find("#zcl_qbkcal").off("click").on("click",function(e){var a,t=ZCL_getCalArr(null,i),l={},c=$(this);l.parentDOM=c.parent(),l.displayAs="dropdown",l.parWidth=!0,l.onSelect=function(e,t){zcal.setCalVal(c,e,t),a.hide()},l.dataCallback=function(){return t},(a=zmUtil.createFLComp("generic",l)).elem.css("z-index","999"),a.show()})},zcal.setCalVal=function(e,t,a){e.val(a.display_text),e.attr("rel",t)},ZCL_updateEndTime=function(){},zcal.dquickBook=function(e,t,a,l){var c=zcal._2digit((e-e%zcalView.hourSlot)/zcalView.hourSlot)+zcal._2digit(e%zcalView.hourSlot*zcalView.slotDuration),i=zcal._2digit((t-t%zcalView.hourSlot)/zcalView.hourSlot)+zcal._2digit(t%zcalView.hourSlot*zcalView.slotDuration),n=zcal.getWeekStart(),r=zcal.today.clone();0!=zcal.view&&r.setDate(r.getDate()-r.getDay()+n),r.setDate(r.getDate()+a);var s=r.dateBy("yyyyMMdd"),d=s;if("2400"==i){var o=r.clone();o.setDate(o.getDate()+1),d=o.dateBy("yyyyMMdd"),i="0000"}zcal.openQBook({SD:s,ST:c,ED:d,ET:i,ADAY:0,ORG:zcal.userid},r,r,!0,l)},zcal.openQBook=function(e,t,a,l,c){zcal.qObj=e,zcal.OBJTEMP=e,zcal.setQuickCreateDiv(l);var i,n=ZCL_$("zcl_qbk");if(n.style.display="",i=n.offsetHeight,zcal.CAStck(["zcl_qbk"]),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1),3==zcal.view){for(var r=0;r<ZCL_NOB;r++)zcal.stck.push("zcl_lay"+r);var s=ZCL_daysBetween(zcal.mlimit[0].dateBy("yyyyMMdd"),a.dateBy("yyyyMMdd")),d=zcal.$("zcl_lay"+s),o=ZCL_findPosXX(d),u=ZCL_findPosYY(d),p=d.offsetHeight,m=d.offsetWidth;o>n.offsetWidth?(n.style.left=o+m/2-310+"px",document.body.offsetHeight-u<i+p/2?(n.style.top=u+p/2-i+"px",zcal.$("zcl_qbkA").className="zcl_qbr"):(n.style.top=u+p/2+"px",zcal.$("zcl_qbkA").className="zcl_qtr")):(n.style.left=o+m/2+"px",document.body.offsetHeight-u<i+p/2?(n.style.top=u+p/2-i+"px",zcal.$("zcl_qbkA").className="zcl_qbl"):(n.style.top=u+p/2+"px",zcal.$("zcl_qbkA").className="zcl_qtl"))}else{$(zcal.calCenter.listElem);zcal.stck.push("zcl_lay");d=zcal.$("zcl_lay"),u=ZCL_findPosYY(zcal.$("zcl_encloser"))+d.offsetTop-zcal.$("zcl_encloser").scrollTop,o=d.offsetLeft,p=d.offsetHeight,m=d.offsetWidth;var _=u+p-i+13;n.style.top=_+"px",o>n.offsetWidth?(zcal.$("zcl_qbkA").className=u<_?"zcl_qtr":"zcl_qbr",n.style.left=zcal.gridleft+o-n.offsetWidth+15+"px"):(zcal.$("zcl_qbkA").className=u<_?"zcl_qtl":"zcl_qbl",n.style.left=zcal.gridleft+o+m/2+"px")}zcal.$("zcl_qbkttl").focus(),ZCL_stopEvents(c)},zcal.openAQBook=function(e,t,a){zcal.qObj=e,zcal.OBJTEMP=e,zcal.setQuickCreateDiv(!1);var l=ZCL_$("zcl_qbk");l.style.display="",l.offsetHeight,zcal.CAStck(["zcl_qbk"]),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1);var c=zcal.NN6?a.clientY:event.clientY,i=zcal.NN6?a.clientX:event.clientX;i>l.offsetWidth?(zcal.$("zcl_qbkA").className="zcl_qtr",l.style.left=i-l.offsetWidth-15+"px"):(zcal.$("zcl_qbkA").className="zcl_qtl",l.style.left=i+15+"px"),l.style.top=c-30+"px",zcal.$("zcl_qbkttl").focus(),ZCL_stopEvents(a)},zcal.mquickBook=function(e,t,a){var l=zcal.mlimit[0].clone(),c=l.clone();l.setDate(l.getDate()+(t<e?t:e)),c.setDate(c.getDate()+(t<e?e:t)),zcal.openQBook({SD:l.dateBy("yyyyMMdd"),ST:0,ED:c.dateBy("yyyyMMdd"),ET:0,ADAY:1,ORG:zcal.userid},l,c,!1,a)},zcal.quickCreate=function(e){var t,a=$("#zcl_qbk").find("#zcl_qbkttl"),l=$("#zcl_qbk").find("#zcl_qbkloc"),c=$("#zcl_qbk").find("#zcl_qbkcal");if(""==a.val().trim())return zmUtil.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_qbkttl").focus(),!1;if(3==zcal.view){var i=(t=ZCL_nlp(a.val().trim(),0)).ST,n=t.ET;if(zcal.qObj.SD==zcal.qObj.ED)if(i||n){if(n.match(/(24)(\d\d)?/)){var r=n.match(/(24)(\d\d)?/);n=r[1]?"00"+(r[2]?r[2]:"00"):n}if(zcal.qObj.ST=i?ZCL_TimetoNo(i):"0000",zcal.qObj.ET=n?ZCL_TimetoNo(n):"0000",zcal.qObj.ST>zcal.qObj.ET&&zcal.qObj.SD==zcal.qObj.ED){var s=parseInt(zcal.qObj.ED%100)+parseInt(1),d=parseInt(zcal.qObj.ED/100);zcal.qObj.ED=d+""+s}zcal.qObj.ADAY=0}else zcal.qObj.ADAY=1}zcal.qObj.SUM=3==zcal.view?t.SUM:a.val().trim(),zcal.qObj.CNAME=c[0].getAttribute("rel"),zcal.qObj.LOC=l.val().trim(),zcalQAdd.add(zcal.qObj),ZCL_clrStck()},zcal.shwLst=function(e){e.parentNode.getElementsByTagName("ul")[0].style.display="block"},zcal.selVal=function(e,t){var a=t.parentNode,l=a.parentNode.getElementsByTagName("input");l[0].value=t.innerHTML,l[1].value=e,a.style.display="none"};var zcalQAdd={adObj:null,add:function(e){this.adObj=e;var t=zcal.getCalObj(e.CNAME),a="/cal/quick.do?mode=a&sd="+zcal.putDate(e.SD)+"&ed="+zcal.putDate(e.ED)+"&st="+e.ST+"&et="+e.ET+"&all="+e.ADAY+"&sum="+(""==e.SUM?"NO SUBJECT":e.SUM).zcalescape()+"&loc="+(""!=e.LOC?e.LOC.zcalescape():"")+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&ckey="+t[9]+"&ctype="+t[5]+"&wrksh="+zcal.cdata.opt.HS+"&calmode="+zcal.CALMODE;if("crm"==t[14]||"recruit"==t[14]&&(-1!=zcal.cdata.calOUids.indexOf("zohoRecruit4_")||1==zcal.cdata.opt.GTYPE&&"new"==zcal.cdata.opt.VERSION)){var l="recruit"==t[14]?zcalCRM.getRecruitCurrentUser():zcalCRM.getCRMCurrentUser();a+="&ownerId="+l.USERID+"&Event Owner="+l.Name}ZCL_XHR(a,zcalQAdd.retAdd)},retAdd:function(e){if("success"==(e=ZCL_Evl(1,e.responseText)).status){var t=e.id,a=zcal.getCalObj(zcalQAdd.adObj.CNAME),l={CNAME:zcalQAdd.adObj.CNAME,ORG:e.ORG?e.ORG:zcalQAdd.adObj.ORG,RTO:[0,0,0,0,0,0,0,0],SD:e.SD?e.SD:zcalQAdd.adObj.SD,ST:e.ST?e.ST:zcalQAdd.adObj.ST,ED:e.ED?e.ED:zcalQAdd.adObj.ED,ET:e.ET?e.ET:zcalQAdd.adObj.ET,REF:[0,1,0,0,a[6].ACTYPE?1:0],SUM:zcalQAdd.adObj.SUM,LOC:zcalQAdd.adObj.LOC,ADAY:zcalQAdd.adObj.ADAY,EPERM:2<=a[12]?2:1==a[12]?1:0,DPERM:2<=a[12]?2:0,EUID:e.euid?e.euid:"",EC:"-1",APL_REQ:e.APL_REQ&&1==e.APL_REQ?e.APL_REQ:"",ETYPE:e.ETYPE?e.ETYPE:0},c=ZCL_Evl(1,'{"'+t+'":'+JSON.stringify(l)+"}");l.EID=t;var i=JSON.stringify(l);ZCL_insertEvent(c,t),4==zcal.view&&zcalAgenda.add(i),ZCL_enableCal(zcalQAdd.adObj.CNAME),zmUtil.succErrMsg("s",3==l.ETYPE?zcal.i18n.taskadded:zcal.i18n.evtadded),zcalView.plotEvents(),zcalQAdd.adObj=null}else e.error&&""!=e.error.trim()?zmUtil.succErrMsg("e",zcal.i18n[e.error]):zmUtil.succErrMsg("e",e.status)},edit:function(e){this.adObj=e;var t=zcal.getCalObj(e.CNAME),a="/cal/quick.do?eid="+e.EID+"&sd="+zcal.putDate(e.SD)+"&ed="+zcal.putDate(e.ED)+"&st="+e.ST+"&et="+e.ET+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&ckey="+t[9]+"&ekey="+e.EUID+"&ctype="+t[5]+"&wrksh="+zcal.cdata.opt.HS+"&all="+e.ADAY+"&calmode="+zcal.CALMODE;a+=e.SUM?"&sum="+e.SUM:"",a+=e.ETZ?"&etz="+e.ETZ.zcalescape()+(e.IN_ETZ&&1==e.IN_ETZ?"&inetz=true":"&inetz=false"):"",a+="&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),a+="&mode="+(null!=e.TY?"recurE"+(null!=e.REPINST&&""!=e.REPINST?"&rbrkdate="+e.REPINST:"")+"&type="+e.TY:"e"),a+="&ntfy="+ZCL_NTFY_ATT,ZCL_NTFY_ATT=-1,ZCL_XHR(a,zcalQAdd.retEdit)},retEdit:function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a=t.id,l=(t.euid&&t.euid,t.rdats?t.rdats:""),c=t.oid?t.oid:"",i=t.ordats?t.ordats:"";if(""!=zcalQAdd.adObj.EID){id=zcalQAdd.adObj.EID;var n=zcalEvents.remEve(id,!1,!0);n=n||zcalEvents.remEve(id,!0,!0);var r=zcal.findDuration(zcalQAdd.adObj);""!=i&&ZCL_insertRepEvents(n,i,c);var s=zcalQAdd.adObj,d={CNAME:n[id].CNAME,ORG:s.ORG,RTO:n[id].RTO,SD:t.SD?t.SD:s.SD,ST:t.ST?t.ST:s.ST,ED:t.ED?t.ED:s.ED,ET:t.ET?t.ET:s.ET,REF:[0,1,n[id].REF[2],n[id].REF[3],n[id].REF[4]],SUM:n[id].SUM.zcalreplace(),LOC:n[id].LOC?n[id].LOC.zcalreplace():"",DUR:r,ADAY:n[id].ADAY?n[id].ADAY:0,EPERM:n[id].EPERM,DPERM:n[id].DPERM,EUID:t.euid?t.euid:n[id].EUID,EC:t.EC?t.EC:-1,ETYPE:t.ETYPE?t.ETYPE:0,HASATTACH:!!t.HASATTACH&&t.HASATTACH};if(t.ETZ&&(d.ETZ=t.ETZ,t.IN_ETZ?d.IN_ETZ=t.IN_ETZ:d.IN_ETZ=0),n[id].SKEY&&(d.SKEY=n[id].SKEY,d.USTAT=n[id].USTAT),n[id].ATTEMAIL&&(d.ATTEMAIL=n[id].ATTEMAIL),n[id].REP){var o={};o.RPDT=s.SD,d.REP=o}t.APL_REQ&&1==t.APL_REQ&&(d.APL_REQ=t.APL_REQ);var u=ZCL_Evl(1,'{"'+a+'":'+JSON.stringify(d)+"}");if(d.EID=a,""!=l?ZCL_insertRepEvents(u,l,a):("0"==s.TY&&(u[a].REF[3]=1,delete u[a].REP),ZCL_insertEvent(u,a)),4==zcal.view){var p=JSON.stringify(d);""!=i||""!=l?zcalAgenda.dispEvents():zcalAgenda.edit(p)}}zmUtil.succErrMsg("s",3==d.ETYPE?zcal.i18n.taskedited:zcal.i18n.evtedited),zcalView.plotEvents(),zcalQAdd.adObj=null}else if("failure"==t.status)t.message&&zmUtil.succErrMsg("e",t.message);else{var m=t.error?"err_general"!=t.error?t.error:zcal.i18n[t.error]:zcal.i18n.err_general;zmUtil.succErrMsg("e",m)}},del:function(e,t,a){var l=1==ZCL_DELRTO,c=zcal.getCalObj(a),i="/cal/delEve.do?mode=d&eid="+e+"&ekey="+t+"&ckey="+c[9]+"&ctype="+c[5]+"&isOthDel="+l+"&calmode="+zcal.CALMODE+"&ntfy="+ZCL_NTFY_ATT;ZCL_NTFY_ATT=-1,ZCL_XHR(i,zcalQAdd.retDel)},chkAttAndEdit:function(e){e.USTAT?ZCL_shAttPopForQkEdit(e):zcalQAdd.edit(e)},chkAttAndDel:function(e,t,a,l,c){var i=!1;l&&1==l&&(i=!0),c&&(i=ZCL_isAtt()),i?ZCL_shAttPopForQkDel(e,t,a,c):(zcalQAdd.del(e,t,a),c&&ZCL_EClrStck())},retDel:function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a=t.id,l=0,c=1<a.split("_").length?a.split("_")[0]:a,i=zcalEvents.remEve(a,!1,!0);(i=i||zcalEvents.remEve(a,!0,!0))&&(l=i[a].ETYPE,4==zcal.view&&zcalAgenda.del(i,a)),zmUtil.succErrMsg("s",3==l?zcal.i18n.taskdeleted:zcal.i18n.evtdeleted),zmsuite.isWorkspaceAvailable("zcal_eeContainer_"+c)&&zmsuite.closeWorkspace("zcal_eeContainer_"+c),zcalView.plotEvents()}else"error"==t.status?zmUtil.succErrMsg("e",zcal.i18n[t.error]):zmUtil.succErrMsg("e",t.status)},retRepDel:function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a=t.id,l=t.rdats?t.rdats:"",c=zcalEvents.remEve(a,!1,!0);for(var i in c=c||zcalEvents.remEve(a,!0,!0))""!=l&&ZCL_insertRepEvents(c,l,i);4==zcal.view&&zcalAgenda.del(c,a),zcalView.plotEvents();var n=1<a.split("_").length?a.split("_")[0]:a;zmsuite.isWorkspaceAvailable("zcal_eeContainer_"+n)&&zmsuite.closeWorkspace("zcal_eeContainer_"+n),zmUtil.succErrMsg("s",zcal.i18n.evtdeleted)}}},ZCL_MONTHMODE=0,ZCL_MROWHGT=[],zcalMonth=function(){function S(){for(var e=k[k.length]=[],t=0;t<w;t++)e[t]=0;return k.length-1}var k=[],w=1,I=[],x={},O=0,N=function(e){e.off("click").on("click",function(e){ZCL_mthmore(this,e)})},R=function(e){for(var t,a,l,c=0;c<e.length-1;c++)for(var i=c+1;i<e.length;i++){for(var n in e[c])a=ZCL_parseDateStr(e[c][n].ED);for(var r in e[i])l=ZCL_parseDateStr(e[i][r].ED);a<l&&(t=e[i],e[i]=e[c],e[c]=t)}},P=function(e,t){for(var a,l,c=0;c<e.length-1;c++)for(var i=c+1;i<e.length;i++){var n,r,s,d;for(var o in n=ZCL_Evl(1,zcalMulti.toString(e[c])))r=n[o];for(var u in s=ZCL_Evl(1,zcalMulti.toString(e[i])))d=s[u];if(r&&d){a=ZCL_parseDateStr(r.ED),l=ZCL_parseDateStr(d.ED);var p=parseInt(r.ST,10),m=parseInt(r.DUR,10);r.SD!=t&&(m=parseInt(p/100,10)*zcal.msec_hour+p%100*zcal.msec_minute,p=0);var _=parseInt(d.ST,10),z=parseInt(d.DUR,10);d.SD!=t&&(z=parseInt(_/100,10)*zcal.msec_hour+_%100*zcal.msec_minute,_=0),a<l||_<p||p==_&&m<z?(e[c]=s,e[i]=n):(e[c]=n,e[i]=s)}}},H=function(e,t,a,l){for(var c,i,n=7*l+t,r=(ZCL_$("zcl_mbx"+n),0);r<e.length;r++)c=d(t),i=o(c,t,e[r],a),s(c,n,e[r],i,a,l)},s=function(e,t,a,l,c,i){x[t]=x[t]||{};var n=x[t],r=t%7;n.elements=n.elements||[],n.events=n.events||[];var s=zcalCRM.getCRMColorCode();for(var d in a){var o=zcal.getCalObj(a[d].CNAME),u=a[d].ORG,p=!0;"crm"==o[14]&&s&&(s[u]?p=0!=s[u][2]:s.OTHERS&&(p=0!=s.OTHERS[2]));var m=a[d].SUM;if(""==m&&(m="NO SUBJECT"),p){var _=ZCL_parseDateStr(a[d].SD),z=ZCL_parseDateStr(a[d].ED),f=a[d].REP?d+"_"+a[d].SD:d,v=ZCL_timeInUFormat(a[d].ST),h=ZCL_getHTML(zcalEvents.tooltip(a[d])),g=zcalEvents.alltime(a[d]),C=(o=zcal.getCalObj(a[d].CNAME))[1].split(":"),y=ZCL_getCalColor(C[0]),L=0==C[1]?"zcl_event zcl_evwh":"zcl_event zcl_evbl";if("1"==a[d].ADAY||_<z){var b=document.createElement("DIV");b.style.width=l+"px",b.className="zcl_mallev",b.style.top=j(i,e)+"px",b.style.left=U(r)+"px",2==a[d].EPERM?(b.eobj={EID:f,SUM:m,SD:a[d].SD,ST:a[d].ST,ED:a[d].ED,ET:a[d].ET,CCOLOR:y[1],ADAY:a[d].ADAY,SDAY:!0,CNAME:a[d].CNAME,EPERM:a[d].EPERM,RIDX:a[d].RIDX,EUID:a[d].EUID,ORG:a[d].ORG,DPERM:a[d].DPERM,ETZ:a[d].ETZ,IN_ETZ:a[d].IN_ETZ,EC:a[d].EC,REPINST:a[d].REPINST,USTAT:a[d].USTAT},b.onmousedown=function(e){zcalMDrag.dragStart(this,e)}):b.onclick=function(e){zcal.eveDetail(f,e,a[d].SD,[a[d].SD,a[d].ST,a[d].ED,a[d].ET,a[d].EUID,a[d].CNAME,a[d].EPERM,a[d].RIDX,a[d].DPERM,a[d].REPINST])};var E=6<y[0].split("#")[1].length?hexToRgba(y[0]):y[0],T=6<y[1].split("#")[1].length?hexToRgba(y[1]):y[1],D='<div class="zcl_mthev" title="'+h+'" alt="'+h+'"><div class="'+L+'" style="background-color:'+(-1!=a[d].EC?zcal.eventcolor[a[d].EC]:T)+";border-color:"+E+'"><ul><li class="zcl_sp"></li><li>'+g+"<span>"+ZCL_getHTML(m)+(a[d].LOC?"&nbsp;@&nbsp;"+ZCL_getHTML(a[d].LOC):"")+"</span></li></ul></div></div>";b.innerHTML=D,n.elements.splice(e,0,b),n.events.splice(e,0,a);var Z=a[d].ED,A=0;(Z=ZCL_parseDateStr(Z))>=I[1]?A=ZCL_daysBetween(c,I[1].dateBy("yyyyMMdd"))+1:Z<I[1]&&(A=ZCL_daysBetween(c,Z.dateBy("yyyyMMdd"))+1);for(var M=t+1;M<t+A;M++){x[M]=x[M]||{};var S,k=x[M];k.elements=k.elements||[],k.events=k.events||[],(S=document.createElement("DIV")).className="zcl_edmy",k.elements.splice(e,0,S),k.events.splice(e,0,a)}}else{var w=document.createElement("DIV");w.className="zcl_mevent",2==a[d].EPERM?(w.eobj={EID:f,SUM:m,SD:a[d].SD,ST:a[d].ST,ED:a[d].ED,ET:a[d].ET,CCOLOR:y[0],ADAY:a[d].ADAY,SDAY:!1,CNAME:a[d].CNAME,RIDX:a[d].RIDX,EUID:a[d].EUID,ORG:a[d].ORG,EPERM:a[d].EPERM,DPERM:a[d].DPERM,ETZ:a[d].ETZ,IN_ETZ:a[d].IN_ETZ,REPINST:a[d].REPINST,USTAT:a[d].USTAT},w.onmousedown=function(e){zcalMDrag.dragStart(this,e)}):w.onclick=function(e){zcal.eveDetail(f,e,a[d].SD,[a[d].SD,a[d].ST,a[d].ED,a[d].ET,a[d].EUID,a[d].CNAME,a[d].EPERM,a[d].RIDX,a[d].DPERM,a[d].REPINST])};var O=6<y[0].split("#")[1].length?hexToRgba(y[0]):y[0];w.innerHTML='<div title="'+h+'" alt="'+h+'"><em class="zcl_st" style="color:'+O+';">'+v+'</em><span style="color:'+O+';">'+ZCL_getHTML(m)+(a[d].LOC?"&nbsp;@&nbsp;"+ZCL_getHTML(a[d].LOC):"")+"</span>",n.elements.splice(e,0,w),n.events.splice(e,0,a)}}}},d=function(e){for(var t=0;t<k.length;t++)if(0==k[t][e])return t;return S()},o=function(e,t,a,l){var c="",i="",n=0;for(var r in a)i=a[r].ED;(i=ZCL_parseDateStr(i))>=I[1]?c=ZCL_daysBetween(l,I[1].dateBy("yyyyMMdd"))+1:i<I[1]&&(c=ZCL_daysBetween(l,i.dateBy("yyyyMMdd"))+1),function(e,t,a){for(var l=k[e],c=t;c<a+t;c++)l[c]=1}(e,t,c);for(var s=0;s<c;s++)n+=ZCL_getEleWdt("zcl_mbx"+(t+s));return n-5},U=function(e){for(var t=0,a=0;a<e;a++)t+=ZCL_getEleWdt("zcl_mbx"+a);return t+1},j=function(e,t){for(var a=18,l=0;l<e;l++)a+=ZCL_MROWHGT[l];return a+=17*t};return{render:function(e,t,a,l){w=a,S();var c=ZCL_parseDateStr(t);I[0]=c,I[1]=zcalMulti.retdate(t,a-1);for(var i=zcalCRM.getCRMColorCode(),n=0;n<a;n++){var r,s=zcal.cdata.evelst,d=new Date;if(d.setTime(c),d.setDate(d.getDate()+n),r=d.dateBy("yyyyMMdd"),e.all[r]&&1<e.all[r].length&&e.all[r].length<=50&&R(e.all[r]),s&&s[r])for(var o in e.all[r]||(e.all[r]=[]),1<s[r].length&&s[r].length<=50&&P(s[r],r),s[r])for(var u in s[r][o]){var p,m,_=s[r][o];p=_[u].CNAME,cObj=zcal.getCalObj(p),m=!(!cObj||-1!=zcal.disabledcal.indexOf(p));var z=_[u].ORG;cObj&&"crm"==cObj[14]&&i&&(i[z]?m=0!=i[z][2]:i.OTHERS&&(m=0!=i.OTHERS[2])),m&&(r==_[u].SD||r!=_[u].SD&&0==n)&&(1==zcal.cdata.opt.DDE||0==zcal.cdata.opt.DDE&&"2"!=_[u].USTAT)&&e.all[r].push(_)}e.all[r]&&0<e.all[r].length&&H(e.all[r],n,r,l);var f,v=7*l+n,h=ZCL_$("zcl_mbx"+v),g=ZCL_$("zcl_encloser"),C=h.offsetHeight-18,y=0;f=x[v]?x[v].elements.length:0,O=O<=f?f:O,y=Math.floor(C/17),1===ZCL_MONTHMODE||f<y?y=f:0!=f&&(y=(y=17*y+13<=C?y:y-1)<0?0:y);var L=h.childNodes[0],b=h.childNodes[1];h.childNodes[0].parentNode.removeChild(h.childNodes[0]),h.innerHTML="",h.appendChild(L),h.appendChild(b);ZCL_$("zcl_encloser").querySelectorAll("div.zcl_mallev");for(var E=0;E<y;E++)"zcl_mallev"===x[v].elements[E].className?(g.appendChild(x[v].elements[E]),h.appendChild($('<div class="zcl_edmy"/>')[0])):h.appendChild(x[v].elements[E]);if(0===ZCL_MONTHMODE&&f&&y<f){var T=document.createElement("DIV"),D=zcalMulti.toString(x[v].events);T.cday=d.dateBy("MMM dd, yyyy"),T.className="zcl_mmore zcl_lk",T.innerHTML="+"+ZCL_replaceString(zcal.i18n.more,[f-y]),T.earr=ZCL_Evl(1,D),N($(T)),h.appendChild(T)}}var Z,A=ZCL_$("zcl_encloser").children[l],M=A.offsetHeight;Z=M<=(Z=1===ZCL_MONTHMODE?17*O+18+17:M)?Z:M,A.style.height=Z+"px",ZCL_MROWHGT[l]=Z,k=[],x={},O=0}}}();zcal.tempObj={},ZCL_mthmore=function(e,t){zcal.setQuickViewDiv({class:"zclevlst"}),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1);var a,l,c=e.earr,i=$("#zcl_qview");i.empty(),(a=$("<li>"+e.cday+'<i class="msi-close SC_frt"></i></li>')).find(".msi-close").off("click").on("click",function(){ZCL_clrStck()}),i.append(a),l=$('<li class="zcl_mrevlst"/>');for(var n=0;n<c.length;n++)for(var r in c[n]){var s=ZCL_getCalColor(zcal.getCalObj(c[n][r].CNAME)[1]),d=(ZCL_parseDateStr(c[n][r].SD),ZCL_parseDateStr(c[n][r].ED),c[n][r].REP?r+"_"+c[n][r].SD:r),o="",u=c[n][r].SUM;""==u&&(u="NO SUBJECT"),c[n][r].ADAY&&"1"==c[n][r].ADAY?o+=zcal.i18n.allday:o+=ZCL_timeInUFormat(c[n][r].ST)+" - "+ZCL_timeInUFormat(c[n][r].ET);var p=$('<ul><li><i style="background-color:'+s[0]+";border-color:"+s[0]+'"></i></li><li>'+ZCL_getHTML(u)+"<span>"+o+"</span></li></ul>");0!=c[n][r].EPERM&&3!=c[n][r].ETYPE?bindClickOnEvent(p,{RIDX:c[n][r].RIDX,ID:d,CNAME:c[n][r].CNAME,EUID:c[n][r].EUID}):p.addClass("zcl_dis"),l.append(p)}i.append(l),i.attr({style:"left:-1000px;display:"}),ZCL_MouseXY(t);n=document.body.offsetWidth>zcalMX+i[0].offsetWidth+20?zcalMX:zcalMX-i[0].offsetWidth,r=document.body.offsetHeight>zcalMY+i[0].offsetHeight+97?zcalMY:zcalMY-i[0].offsetHeight;i.attr({style:"top:"+r+"px;left:"+n+"px"}),ZCL_stopEvents(t)},bindClickOnEvent=function(e,t){e.off("click").on("click",{RIDX:t.RIDX,ID:t.ID,CNAME:t.CNAME,EUID:t.EUID},function(e){ZCL_clrStck(),ZCL_TRIDX=e.data.RIDX;var t=1<e.data.ID.split("_").length?e.data.ID.split("_")[0]:e.data.ID;zcal[t]={},zcal[t].EMODE=0,ZCL_editEve(e.data.ID,e,e.data.CNAME,e.data.EUID)})},zcal.clsMEvlst=function(){var e=zcal.$("zcl_mevlst");e.parentNode.removeChild(e)};var zcalDrag=function(){var i,n,r,c,s,d,o,u,p,m=!1,_=0,z=0,f=0,v=0,h=0,g=function(e){if(m){var t,a;p.offsetTop;if(a=(zcal.NN6?e.clientY:event.clientY)-u.top+o.scrollTop,t=zcal.NN6?e.clientX:event.clientX,!(v<t&&t<h))return!1;var l=Math.floor(a/s);0<=l&&l<=47&&(l==f?(p.style.height=s+"px",p.style.top=l*s+"px",z=(_=l)+1):_=f<l?(p.style.height=(l-f+1)*s+"px",z=l+1,f):(p.style.top=l*s+"px",p.style.height=(f-l+1)*s+"px",z=f+1,l))}},C=function(e){m=!1,document.onmousemove="",document.onmouseup="",zcal.dquickBook(_,z,d,e),_=z=f=null,ZCL_stopEvents(e)},y=function(e){for(var t=ZCL_$("zcl_lftsec").getBoundingClientRect().width,a=0;a<e;a++)t+=ZCL_$("zcl_a"+a).getBoundingClientRect().width;return t},L=function(e){if(m){var t=zcal.NN6?e.target:event.srcElement;if(t.id&&(-1!=t.id.indexOf("zcl_mbx")||-1!=t.id.indexOf("zcl_lay")||-1!=t.id.indexOf("zcl_lft"))){var a=t.id.replace(/\D/g,"");if(n=parseInt(a,10),i<n){for(var l=r;l<=i;l++)ZCL_$("zcl_lay"+l).style.display="none",r=l;for(;n<r;)ZCL_$("zcl_lay"+r--).style.display="none";for(var c=r;c<=n;c++)ZCL_$("zcl_lay"+c).style.display="",r=c}else if(n<i){for(l=r;i<=l;l--)ZCL_$("zcl_lay"+l).style.display="none",r=l;for(;r<n;)ZCL_$("zcl_lay"+r++).style.display="none";for(c=r;n<=c;c--)ZCL_$("zcl_lay"+c).style.display="",r=c}else{for(;r<n;)ZCL_$("zcl_lay"+r++).style.display="none";for(;n<r;)ZCL_$("zcl_lay"+r--).style.display="none"}}}},b=function(e){m=!1,document.onmousemove="",document.onmouseup="",zcal.mquickBook(i,n,e),r=i=n=null};return{dstartDiv:function(e,t,a){p=ZCL_$("zcl_lay"),o=ZCL_$("zcl_encloser"),u=o.getBoundingClientRect(),v=u.left,h=v+u.width-zcalInit.scrollWidth(),ZCL_clrStck();var l=e.target||e.srcElement;c=$("#zcl_hContainer").find("ul:first")[0].getBoundingClientRect().height,s=c/2||25,m=!0,a=2*a+("B"==l.tagName?0:1),_=f=a,z=a+1,d=t,p.style.top=a*s+"px",p.style.left=y(t)+"px",p.style.width=ZCL_getEleWdt(l)+"px",p.style.height=s+"px",p.style.display="",document.onmousemove=g,document.onmouseup=C},mstartDiv:function(e,t){var a,l=e.target||e.srcElement;ZCL_clrStck(),m=!0,!l.id||l.id!="zcl_mbx"+t&&l.id!="zcl_lft"+t||(i=n=r=t,(a=zcal.$("zcl_lay"+t)).style.display="",a.offsetHeight,a.offsetWidth,document.onmousemove=L,document.onmouseup=b)}}}(),zcalEDrag=function(){var L,b,i,n,r,s,c=!1,E="top",d=function(e){var t=zcal.NN6?e.clientY:event.clientY;if(t!=r&&(c||ZCL_setOpacity(b,5),c=!0)){var a=b.getElementsByTagName("div")[1],l=(a.offsetHeight,b.offsetTop);if(t=(zcal.NN6?e.clientY:event.clientY)-ZCL_findPosYY(s),sHgt=t+s.parentNode.scrollTop-l,!(12<sHgt&&t+ZCL_findPosYY(s)<document.body.offsetHeight-50))return!1;a.style.height=sHgt+"px"}},o=function(e){var t=zcal.NN6?e.clientY:event.clientY,a=zcal.NN6?e.clientX:event.clientX;if(t!=r&&(c||ZCL_setOpacity(b,5),c=!0)){if(dHgt=t-r,dLft=a-ZCL_findPosXX(s),0!=zcal.view&&s.offsetWidth>dLft+10&&dLft>=zcal.hrgrid_lsec_width){var l=ZCL_getWeekGridNo(dLft);b.style.left=l[1]+"px",b.setAttribute("gridNo",l[0])}n+dHgt+b.offsetHeight<=s.parentNode.scrollHeight&&0<n+dHgt&&(b.style.top=n+dHgt+"px")}},u=function(e){document.onmousemove="",document.onmouseup="",n=null,c?1==L.EPERM&&1==L.DPERM?ZCL_showConfirm("zcl_attStat"):-1!=b.id.indexOf("_")?t():(ZCL_dragreturn(b,E,{SD:L.SD,ST:L.ST,ED:L.ED,ET:L.ET,CNAME:L.CNAME,EUID:L.EUID,RIDX:L.RIDX,ORG:L.ORG,ADAY:L.ADAY,ETZ:L.ETZ,IN_ETZ:L.IN_ETZ,USTAT:L.USTAT}),b=null):zcal.eveDetail(b.id,e,i,[L.SD,L.ST,L.ED,L.ET,L.EUID,L.CNAME,L.EPERM,L.RIDX,L.DPERM,L.REPINST]),c=!1,E="top",ZCL_stopEvents(e)},t=function(){var e=L.SD,t=(L.ST,L.ED),a=L.ET,l=zcal.getWeekStart(),c=zcal.today.clone(),i=b.offsetLeft;if(0!=zcal.view&&c.setDate(c.getDate()-c.getDay()+l),0!=i){var n=parseInt(b.getAttribute("gridNo"),10);c.setDate(c.getDate()+n);var r=c.dateBy("yyyyMMdd");b.id;if("bot"==E&&e!=t&&r==e&&"0000"!=a&&"2400"!=a)return zcalView.constGridView(),!1;ZCL_showConfirm("qedit",{dtype:E})}};return{dragStart:function(e,t,a,l){ZCL_clrStck(),s=ZCL_$("zcl_eveSub"),ZCL_$("zcl_encloser");var c=zcal.NN6?t.target:event.srcElement;n=e.offsetTop,ZCL_MouseXY(t),r=zcalMY,b=e,i=a,L=l,"DIV"==c.tagName&&"zcl_scrollme"==c.id?(E="bot",document.onmousemove=d):(E="top",document.onmousemove=o),document.onmouseup=u,ZCL_stopEvents(t)},editRep:function(e,t){var a,l,c,i,n,r,s,d,o=b.id,u=L.SD,p=L.ED,m=L.ST,_=L.ET,z=zcal.getWeekStart(),f=zcal.today.clone(),v=(b.offsetLeft,b.offsetTop),h=b.offsetHeight,g=L.RIDX;if(a=Math.round(v),a=ZCL_pxToTime(a),l=Math.round(v+h),l=ZCL_pxToTime(l),0!=zcal.view&&f.setDate(f.getDate()-f.getDay()+z),E=t&&t.dtype?t.dtype:E,c=parseInt(b.getAttribute("gridNo")),f.setDate(f.getDate()+c),i=f.dateBy("yyyyMMdd"),n=f.dateBy("yyyyMMdd"),r=o.substring(0,o.indexOf("_")),s=zcal.findDuration({SD:u,ST:m,ED:p,ET:_}),"bot"==E)i=u,a=m;else if("top"==E){var C=parseInt(a/100,10),y=a%100;f.setHours(C,y,0,0),f.setTime(f.getTime()+s),n=f.dateBy("yyyyMMdd"),l=f.dateBy("HHmm")}2==e&&0==g&&(e=null),d={SD:i,ED:n,ST:a,ET:l,EID:r,TY:e,RIDX:L.RIDX,CNAME:L.CNAME,EUID:L.EUID,ORG:L.ORG,ADAY:L.ADAY,ETZ:L.ETZ,IN_ETZ:L.IN_ETZ,REPINST:L.REPINST},zcalQAdd.edit(d),L=b=null,ZCL_closeREditConfirm()}}}(),zcalMDrag=function(){var p,r,m,_,s,z,f,v,d,h,g=!1,C=!1,o=function(e){var t,a,l,c,i,n,r;if(a=zcal.NN6?e.clientY:event.clientY,((t=zcal.NN6?e.clientX:event.clientX)!=z||a!=f)&&(v.style.display="",C=!0,ZCL_setOpacity(p,5),g)){var s=h.offsetLeft,d=h.offsetTop,o=h.offsetWidth,u=h.offsetHeight;s<t&&t<s+o&&d<a&&a<d+u&&(n=t>s+o-zcal.mcell_width?s+o-zcal.mcell_width:t,r=a>d+u-v.offsetHeight?d+u-v.offsetHeight:a,c=Math.floor((n-s)/zcal.mcell_width),l=y(r,l),i=m=7*l+c,_!=i&&(ZCL_$("zcl_lay"+_).style.display="none",_=i),ZCL_$("zcl_lay"+i).style.display="",v.style.left=n+"px",v.style.top=r+"px",v.style.position="absolute")}},u=function(e){g=!1;var t=window.event?window.event:e;document.onmousemove="",document.onmouseup="",v&&v.parentNode.removeChild(v),v=null,C?r!=m?1==s.EPERM&&1==s.DPERM?ZCL_showConfirm("zcl_attStat"):(-1!=s.EID.indexOf("_")?l:a)():(ZCL_clrStck(),zcalView.plotEvents()):zcal.eveDetail(s.EID,t,s.SD,[s.SD,s.ST,s.ED,s.ET,s.EUID,s.CNAME,s.EPERM,s.RIDX,s.DPERM,s.REPINST]),C=!1,ZCL_stopEvents(t)},a=function(){var e,t,a,l;(e=zcal.mlimit[0].clone()).setDate(e.getDate()+m),t=e.clone(),a=(ZCL_parseDateStr(s.ED)-ZCL_parseDateStr(s.SD))/864e5,t.setDate(t.getDate()+a),l={SD:e.dateBy("yyyyMMdd"),ED:t.dateBy("yyyyMMdd"),ST:s.ST,ET:s.ET,EID:s.EID,EUID:s.EUID,CNAME:s.CNAME,OR:s.ORG,ADAY:s.ADAY,ETZ:s.ETZ,IN_ETZ:s.IN_ETZ,SUM:s.SUM,USTAT:s.USTAT},zcalQAdd.chkAttAndEdit(l)},l=function(){var e,t,a,l,c;(e=zcal.mlimit[0].clone()).setDate(e.getDate()+m),l=(a=s.EID).substring(0,a.indexOf("_")),a.substring(a.indexOf("_")+1,a.length),(t=e.clone()).setDate(t.getDate()+(ZCL_parseDateStr(s.ED)-ZCL_parseDateStr(s.SD))/864e5),c={SD:e.dateBy("yyyyMMdd"),ED:t.dateBy("yyyyMMdd"),ST:s.ST,ET:s.ET,EID:l,TY:0,RIDX:s.RIDX,CNAME:s.CNAME,EUID:s.EUID,ORG:s.ORG,ADAY:s.ADAY,ETZ:s.ETZ,IN_ETZ:s.IN_ETZ,USTAT:s.USTAT,REPINST:s.REPINST},zcalQAdd.chkAttAndEdit(c)},y=function(e,t){e=e+d.scrollTop-h.offsetTop;for(var a=0;a<ZCL_MROWHGT.length;a++)if((e-=ZCL_MROWHGT[a])<=0){t=a;break}return t};return{dragStart:function(e,t){var a,l,c;if(d=ZCL_$("zcl_encloser"),h=ZCL_getPos(d),ZCL_clrStck(),g=!0,s=(p=e).eobj,z=zcal.NN6?t.clientX:event.clientX,f=zcal.NN6?t.clientY:event.clientY,a=Math.floor((z-h.offsetLeft)/zcal.mcell_width),l=y(f),_=r=m=7*l+a,c=ZCL_getCalColor(zcal.getCalObj(s.CNAME)[1]),v=document.createElement("DIV"),s.SDAY||(v.className="zcl_medrg"),v.style.width=zcal.mcell_width-2+"px",s.SDAY&&s.SD!=s.ED){var i=(ZCL_parseDateStr(s.ED)-ZCL_parseDateStr(s.SD))/864e5,n='<div class="zcl_mthev" style="z-index:101;"><div class="zcl_event" style="background-color:'+(-1!=s.EC?zcal.eventcolor[s.EC]:c[1])+";border-color:"+c[0]+'"><ul><li class="zcl_sp"></li><li><span>&nbsp;('+(1+i)+"&nbsp;"+zcal.i18n.days+")&nbsp;&nbsp;"+s.SUM+"</span></li></ul></div></div>";v.innerHTML=n}else v.style.zIndex="101",v.innerHTML=e.innerHTML;document.body.appendChild(v),v.style.left=z+"px",v.style.top=f+"px",v.style.position="absolute",v.style.display="none",document.onmousemove=o,document.onmouseup=u,ZCL_stopEvents(t)}}}();function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ZEVENTS=function(e){return new ZCALPicker(e)},ZEVENTS.count=0,ZEVENTS.obj={},ZEVENTS.template=function(e){switch(e){case"type1":return{_HTML:'<li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><i class="#py#" rel="PY"></i></li><li class="zcal_arr"><i class="#pm#" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="#nm#" rel="NM"></i></li><li class="zcal_arr"><i class="#ny#" rel="NY"></i></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li><li class="zcal_tmz"><span>#tz#</span></li></ul></li>',_cont:{tag:"UL",_class:"zcal_mCal"},_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b"}};case"type2":return{_HTML:'<ul class="zcal_mCal #shadow# #hover#"><li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><svg rel="PY"><polygon points="10.8,4.7 7.8,7.7 10.8,10.7 10.8,12 7.2,8.3 6.5,7.7 7.2,7 10.8,3.4"></polygon><polygon points="4.8,7.7 8.7,11.5 8.6,13.1 3.2,7.7 4,6.9 8.6,2.3 8.7,3.9"></polygon></svg></li><li class="zcal_arr"><svg  rel="PM"><polygon points="10.7,2.3 10.7,4 6.9,7.8 10.7,11.6 10.7,13.2 5.2,7.8"></polygon></svg></li><li><span >#HEADM#</span><span>#HEADY#</span></li><li class="zcal_arr"><svg rel="NM" ><polygon points="5.2,13.2 5.2,11.5 9,7.7 5.2,3.9 5.2,2.3 10.7,7.7"></polygon></svg></li><li class="zcal_arr"><svg rel="NY" ><polygon points="4.7,10.7 7.7,7.7 4.7,4.7 4.7,3.4 8.3,7 9,7.7 8.3,8.3 4.7,12"></polygon><polygon points="10.7,7.7 6.8,3.9 6.9,2.3 12.3,7.7 11.5,8.5 6.9,13.1 6.8,11.5"></polygon></svg></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# #cl# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></li></ul>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};case"type3":return{_HTML:'<li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr" ><i class="#py#" rel="PY"></i></li><li class="zcal_arr" ><i class="#pm#" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="#nm#" rel="NM"></i></li><li class="zcal_arr" ><i class="#ny#" rel="NY"></i></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li rel="DT" class="zcal_table">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li></ul></li>',_class:{sel:"em",dis:"u",nor:"b"},_cont:{tag:"UL",_class:"zcal_mCal"},_bsecont:{tag:"DIV",_class:"zcal_mpcal"},_patch:{tag:"DIV",_cont:"<b></b>"}};case"type4":return{_HTML:'<li class="zcl_mCaltt zcl_table"><ul><li><span>#HEADM#</span><span>#HEADY#</span></li><li class="zcl_W20"><i class="#pm#" rel="PM"></i><i class="#nm#" rel="NM"></i></li></ul></li><li class="zcl_mCaldy zcl_table"><ul>#wk<li#hgt#>#item#</li>wk#</ul></li><li class="zcl_table zcl_mCaldt" rel="DT">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li></ul></li>',_cont:{tag:"UL",_class:"zcl_mCal"},_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b"},_cust:{dysel:"zcl_sl",pm:"zcli-larrow",nm:"zcli-rarrow"}};case"type5":return{_HTML:'<div class="zcal_mCal #shadow# #hover# zcl_mCalwti"><div class="zcal_table"><ul><li class="zcal_mCalti"><div class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><i class="zci-fst" rel="PY"></i></li><li class="zcal_arr"><i class="zci-pre" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="zci-nxt" rel="NM"></i></li><li class="zcal_arr"><i class="zci-lst" rel="NY"></i></li></ul></div><div class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></div></li><li class="zcal_mTil"><i class="zci-tiupar" rel="UT"></i><div ><ul id="zcl_t" style="overflow-y:auto;height:205px">#tr<li#ti# rel="TP">#item#</li>tr#</ul></div><i class="zci-tidnar" rel="TD"></i></li></ul></div><div class="zcal_mCalbtm"><div class="SC_PUbtm"><span rel="OK">Ok</span></div></div></div>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};case"type6":return{_HTML:'<div class="zcal_mCal #shadow# #hover#"><div class="zcal_table"><ul><li><div class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><svg rel="PY"><polygon points="10.8,4.7 7.8,7.7 10.8,10.7 10.8,12 7.2,8.3 6.5,7.7 7.2,7 10.8,3.4"></polygon><polygon points="4.8,7.7 8.7,11.5 8.6,13.1 3.2,7.7 4,6.9 8.6,2.3 8.7,3.9"></polygon></svg></li><li class="zcal_arr"><svg  rel="PM"><polygon points="10.7,2.3 10.7,4 6.9,7.8 10.7,11.6 10.7,13.2 5.2,7.8"></polygon></svg></li><li><span>#HEADM#</span><span>#HEADY#</span></li><li class="zcal_arr"><svg rel="NM" ><polygon points="5.2,13.2 5.2,11.5 9,7.7 5.2,3.9 5.2,2.3 10.7,7.7"></polygon></svg></li><li class="zcal_arr"><svg rel="NY" ><polygon points="4.7,10.7 7.7,7.7 4.7,4.7 4.7,3.4 8.3,7 9,7.7 8.3,8.3 4.7,12"></polygon><polygon points="10.7,7.7 6.8,3.9 6.9,2.3 12.3,7.7 11.5,8.5 6.9,13.1 6.8,11.5"></polygon></svg></li></ul></div><div class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# #cl# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></div></li></ul></div><div class="zcal_mCalbtm zcal_mC_sz_cn zcal_table"><ul><li class="zcal_txl" rel="TL"><span class="zcal_mC_sz_ti">#br<input type="text" id="zcal_hr" rel="HI" value="#cuHr#" data-item="">:<input type="text" id="zcal_min" rel="MI" value="#cuMin#">#tf:<input type="text" readonly id="zcal_ap" rel="AP" value="#apm#">br#</span></li><li><div class="SC_PUbtm" style="padding: 0px;"><span rel="OK">Ok</span></div></li></ul></div></div>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};case"type7":return{_HTML:'<div class="zcal_mCal #shadow# #hover# #timediv#"><div class="zcal_table"><ul><li class="#timediv#"><div class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><svg rel="PY" class="#py#"><polygon points="10.8,4.7 7.8,7.7 10.8,10.7 10.8,12 7.2,8.3 6.5,7.7 7.2,7 10.8,3.4"></polygon><polygon points="4.8,7.7 8.7,11.5 8.6,13.1 3.2,7.7 4,6.9 8.6,2.3 8.7,3.9"></polygon></svg></li><li class="zcal_arr"><svg class="#pm#" rel="PM"><polygon points="10.7,2.3 10.7,4 6.9,7.8 10.7,11.6 10.7,13.2 5.2,7.8"></polygon></svg></li><li><span rel="month_idx">#HEADM#</span><span rel="year_idx">#HEADY#</span></li><li class="zcal_arr"><svg class="#nm#" rel="NM" ><polygon points="5.2,13.2 5.2,11.5 9,7.7 5.2,3.9 5.2,2.3 10.7,7.7"></polygon></svg></li><li class="zcal_arr"><svg class="#ny#" rel="NY" ><polygon points="4.7,10.7 7.7,7.7 4.7,4.7 4.7,3.4 8.3,7 9,7.7 8.3,8.3 4.7,12"></polygon><polygon points="10.7,7.7 6.8,3.9 6.9,2.3 12.3,7.7 11.5,8.5 6.9,13.1 6.8,11.5"></polygon></svg></li></ul></div><div class="#viewclass#" id="mcvw"><div class="zcal_mCal_yr zcal_table">#ycr<ul>#yt<li rel="year_sel" class="#selclass#">#item#</li>yt#</ul>ycr#</div><div class="zcal_mCal_mth zcal_table">#mcr<ul>#mt<li rel="month_sel" class="#selclass#">#item#</li>mt#</ul>mcr#</div><div class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# #cl# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></div></div></li>#timerow<li class="zcal_mTil"><i class="zci-tiupar" rel="UT"></i><div ><ul id="zcl_t" style="overflow-y:auto;height:205px">#tr<li#ti# rel="TP">#item#</li>tr#</ul></div><i class="zci-tidnar" rel="TD"></i></li>timerow#</ul></div>#okrow<div class="zcal_mCalbtm"><div class="SC_PUbtm"><span rel="OK">Ok</span></div></div>okrow##bottomtimerow<div class="zcal_mCalbtm zcal_mC_sz_cn zcal_table"><ul><li class="zcal_txl" rel="TL"><span class="zcal_mC_sz_ti">#br<input type="text" id="zcal_hr" rel="HI" value="#cuHr#" data-item="">:<input type="text" id="zcal_min" rel="MI" value="#cuMin#">#tf:<input type="text" readonly id="zcal_ap" rel="AP" value="#apm#">br#</span></li><li><div class="SC_PUbtm"  style="padding: 0px;"><span rel="OK">Ok</span></div></li></ul></div>bottomtimerow#</div>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};default:return}},ZEVENTS.selector=function(e){var t={},a=e.trim().split(" ");if(t.target=(a[0]||a).substring(1),2==a.length){a[1]=a[1].trim();var l=a[1].indexOf("[");if(-1!=l){var c=a[1].indexOf("]"),i=(a[1].indexOf("."),a[1].indexOf("="));t.ele=a[1].substring(0,l),t.atr=a[1].substring(l+1,c),t.atr_val=a[1].substring(i+1)}else t.atr="#"===a[1][0]?"id":"."==a[1][0]?"class":"",""!=t.atr?(t.atr_val=a[1].substring(a[1].search(/(#|\.)/g)+1),t.ele=""):(t.ele=a[1],t.atr_val="")}else t.ele="",t.atr="",t.atr_val="";return t},ZEVENTS.removeall=function(e){if("string"==typeof(e=e||"picker")&&"picker"==e&&ZEVENTS.obj.picker){var t=ZEVENTS.obj.picker;for(var a in t)ZEVENTS.remove(t[a],e)}},ZEVENTS.remove=function(e,t){if("object"==_typeof(e)&&e._name){var a=e._cont;e.clearobj(),e.clearvar(),e=null,t=t||"picker",delete ZEVENTS.obj[t][a]}},ZEVENTS.clear=function(e){"object"==_typeof(e)&&e._name&&(e.clearobj(),ZEVENTS.obj.state=null)},ZCALPicker=function(e){return this.tar=e,this},ZCALPicker.prototype.picker=function(e,t){var a,l=ZEVENTS.obj.picker||(ZEVENTS.obj.picker={});return t.target=this.tar,"date"==e?a=new ZCALdatepickr(t):"range"==e?a=new ZCALrangepickr(t):"time"==e&&(a=new ZCALtimepickr(t)),a&&(l[a._cont]=a),a};var ZCALtimepickr=function(e){return e?(this._name="timepicker",this._type=e.type&&/^[123]$/.test(e.type)?e.type:1,this._tar="object"==_typeof(e.target)?e.target:document.getElementById(e.target),this._tform=e.tform,e.refer?this._refer="object"==_typeof(e.refer)?e.refer:document.getElementById(e.refer):this._tar&&(this._refer="input"==this._tar.tagName.toLowerCase()?this._tar:this._tar.getElementsByTagName("input")[0]),this.os=0,this.n="",this.tmpO="no",this._cont=(new Date).getTime()+"_"+ZEVENTS.count++,this._prevalue="",this._menu=!1,this._sel=-1,this._errfn=[],this._chgefn=[],this):null};ZCALtimepickr.prototype.on=function(e,t){return"change"==e&&"function"==typeof t?this._chgefn.push(t):"error"==e&&"function"==typeof t&&this._errfn.push(t),this},ZCALtimepickr.prototype.bind=function(){function l(){if(d._inEl){ZCALremoveListener(d._inEl,"input",c),ZCALremoveListener(d._inEl,"keydown",n),ZCALremoveListener(d._inEl,"blur",s),ZCALremoveListener(d._inEl,"keypress",r);d._inEl.parentNode.removeChild(d._inEl);e1=null}if(d._ulEl){ZCALremoveListener(d._ulEl,"mousedown",p);d._ulEl.parentNode.removeChild(d._ulEl);e1=null}d._menu=!1,d._sel=-1,d._prevalue="",d._ulEl=d._inEl=null}var d=this;d.clearobj=function(){ZEVENTS.obj.state=null;var e=document.getElementById(d._cont);e&&(ZCALremoveListener(e,"mousedown",o),ZCALremoveListener(document,"scroll",docevehandle),ZCALremoveListener(document,"mousedown",docevehandle),ZCALremoveListener(document,"mousewheel",docevehandle),ZCALremoveListener(d._tar,"keydown",u),e=e.parentNode.removeChild(e),e=null,d._sel=-1),d._inEl&&(""!=d._refer.placeholder?d._refer.value=d._refer.placeholder:d._refer.value=d._inEl.value,d._refer.placeholder=d._tform,l())},d.clearvar=function(){1==d._type?(ZCALremoveListener(d._tar,"focus",e),ZCALremoveListener(d._tar,"click",e),ZCALremoveListener(d._tar,"keydown",u)):3==d._type?(ZCALremoveListener(d._refer,"keydown",t),ZCALremoveListener(d._refer,"keyup",t),ZCALremoveListener(d._refer,"mouseup",t)):2==d._type&&ZCALremoveListener(d._refer,"focus",a)};var o=function(e){var t=e.target||event.srcElement;"li"==t.tagName.toLowerCase()&&(d._refer.value=t.innerHTML,i(),d.clearobj()),ZCALprevDef(e)},i=function(){var e=d._errfn,t=d._chgefn;if("hh:mm a"==d._tform?d.get12hrTime(d._refer.value):d.get24hrTime(d._refer.value))for(var a in t)t[a].call(d._refer);else for(var a in e)e[a].call(d._refer)},e=function(e){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=d;e.target||e.srcElement;var t="input"==this.tagName.toLowerCase()?this:this.getElementsByTagName("input")[0],a=t.value,l=d._tform||t.getAttribute("tform"),c=a.changeTimetoNumber(l);d._sel=c;var i=document.body.appendChild(document.createElement("ul"));i.style.width=(this.clientWidth<110?110:this.clientWidth)+"px",i.style.left=this.positionX()+"px",i.id=d._cont,ZCALaddListener(i,"mousedown",o);var n=(document.documentElement.clientHeight||window.innerHeight)+Math.max(document.body.scrollTop,document.documentElement.scrollTop);i.className="zcal_tilst "+(this.positionY()+250>n?"zcal_tilsbt":"zcal_tilstp");for(var r="",s=0;s<48;s++)r+='<li rel="'+s+'"'+(s==c?'class="zcal_sl"':"")+">"+(s+"").changeNumbertoTime(l)+"</li>";i.innerHTML=r,i.scrollTop=24*c,i.style.top=this.positionY()+250<n?this.positionY()+this.offsetHeight+"px":this.positionY()-i.offsetHeight+"px",ZCALprevDef(e),ZCALaddListener(document,"scroll",docevehandle=function(){d.clearobj()}),ZCALaddListener(document,"mousedown",docevehandle=function(){d.clearobj()}),ZCALaddListener(d._tar,"keydown",u),ZCALaddListener(d._refer,"blur",docevehandle=function(){d.clearobj()})},u=function(e){var t=e.which||e.keyCode||e.charCode,a=document.getElementById(d._cont).getElementsByTagName("li");38==t&&0!=d._sel?(a[d._sel--].className="",a[d._sel].className="zcal_sl",document.getElementById(d._cont).scrollTop=24*d._sel,i()):40==t&&d._sel!=a.length-1?(a[d._sel++].className="",a[d._sel].className="zcal_sl",document.getElementById(d._cont).scrollTop=24*d._sel,i()):13==t&&(this.value=a[d._sel].innerHTML,d.clearobj())},t=function(e){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=d;var t=this,a=(e=e||event).which||e.keyCode||e.charCode,l="HH:mm"==(d._tform||t.getAttribute("tform"));if("mouseup"==e.type.toLowerCase()){var c=ZCALselstart(t);return d.os=c<=2?ZCALcrtesel(t,0,2):3<=c&&c<=5?ZCALcrtesel(t,3,5):6<=c&&c<=8?ZCALcrtesel(t,6,8):0,!0}if("keyup"!=e.type.toLowerCase()||9==a){switch(!0){case 37==a:d.os=0!=d.os||l?0==d.os&&l?ZCALcrtesel(t,3,5):3==d.os?ZCALcrtesel(t,0,2):6==d.os?ZCALcrtesel(t,3,5):0:ZCALcrtesel(t,6,8);break;case 38==a:d.shiftnos(t,d.os,-1),i();break;case 39==a:d.os=0==d.os?ZCALcrtesel(t,3,5):3!=d.os||l?3==d.os&&l||6==d.os?ZCALcrtesel(t,0,2):0:ZCALcrtesel(t,6,8);break;case 40==a:d.shiftnos(t,d.os,1),i();break;case 48<=a&&a<=57:case 65==a||80==a:d.typenos(t,a,d.os),i();break;case 9==a:if("keydown"==e.type.toLowerCase()){if(ZCALselend(t)==t.value.length)return;d.tmpO="yes",ZCALselend(t)-ZCALselstart(t)!=2?d.os=ZCALcrtesel(t,0,2):d.os=0==d.os?ZCALcrtesel(t,3,5):3!=d.os||l?3==d.os&&l||6==d.os?ZCALcrtesel(t,0,2):0:ZCALcrtesel(t,6,8)}else"keyup"==e.type.toLowerCase()&&"no"==d.tmpO?ZCALselend(t)-ZCALselstart(t)!=2?d.os=ZCALcrtesel(t,0,2):d.os=0==d.os?ZCALcrtesel(t,3,5):3!=d.os||l?3==d.os&&l||6==d.os?ZCALcrtesel(t,0,2):0:ZCALcrtesel(t,6,8):"keyup"==e.type.toLowerCase()&&"yes"==d.tmpO&&(d.tmpO="no",ZCALprevDef(e))}ZCALprevDef(e)}},c=function(){if(d._prevalue!=this.value){this.value=this.value.replace("'","").replace("&","").replace("%","").replace(".",""),d._prevalue=this.value;var e="hh:mm a"==d._tform?d.timeObj12hr(this.value):d.timeObj24hr(this.value);if(e){if(""==e[0]){var t=d._ulEl.getElementsByTagName("li");t[d._sel].className="",t[e[1]].className="zcal_sl"}else{d._ulEl.innerHTML=e[0];var a=d._ulEl.getElementsByTagName("li").length;d._ulEl.style.height=24*(a<=2?a:4)+"px"}d._sel=e[1],d._ulEl.style.display="",d._ulEl.scrollTop=24*e[1],d._prevalue=this.value="hh:mm a"==d._tform?this.value.toUpperCase().replace(/^0/,""):this.value,d._refer.placeholder=e[2],d._refer.value=""}else d._ulEl.style.display="none",d._refer.placeholder="",d._refer.value=""}},n=function(e){var t=e.which||e.keyCode||e.charCode,a=d._ulEl.getElementsByTagName("li");if(38==t)0<d._sel&&(a[d._sel--].className="",a[d._sel].className="zcal_sl",this.value=a[d._sel].innerHTML,d._refer.placeholder=a[d._sel].innerHTML,d._ulEl.scrollTop=24*d._sel);else{if(39==t)return""!=d._refer.placeholder&&(this.value=d._refer.placeholder.substring(0,this.value.length+1)),c.call(this,e);40==t?a.length-1>d._sel&&(a[d._sel++].className="",a[d._sel].className="zcal_sl",this.value=a[d._sel].innerHTML,d._refer.placeholder=a[d._sel].innerHTML,d._ulEl.scrollTop=24*d._sel):13==t&&(""!=d._refer.placeholder?d._refer.value=d._refer.placeholder:d._refer.value=this.value,d._refer.placeholder=d._tform,i(),l())}},r=function(e){var t=e.which||e.keyCode||e.charCode;if(!/^(8|4[0689]|5[0-8]|3[7-9])$/.test(t)&&"HH:mm"==d._tform)return e.preventDefault(),e.stopPropagation(),!1;var a=this.selectionStart,l=this.selectionEnd;if(a==l&&l==this.value.length&&!/^(37|8|46)$/.test(t)){var c=String.fromCharCode(t);("hh:mm a"==d._tform?d.get12hrTime(this.value+c):d.get24hrTime(this.value+c))||(e.preventDefault(),e.stopPropagation())}},s=function(){""!=d._refer.placeholder?d._refer.value=d._refer.placeholder:d._refer.value=this.value,d._refer.placeholder=d._tform,i(),l()},p=function(e){var t=e.target||e.srcElement;"li"==t.tagName.toLowerCase()&&(d._refer.value=t.innerHTML,d._refer.placeHolder="",l(),i())},a=function(){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=d;var e=this.parentNode;d._inEl=e.getElementsByTagName("input")[1],d._ulEl=e.getElementsByTagName("ul")[0],d._inEl||(d._inEl=e.appendChild(document.createElement("input")),d._inEl.type="text",d._inEl.className="zcal_tiabs",ZCALaddListener(d._inEl,"input",c),ZCALaddListener(d._inEl,"keydown",n),ZCALaddListener(d._inEl,"blur",s),ZCALaddListener(d._inEl,"keypress",r)),d._ulEl||(d._ulEl=e.appendChild(document.createElement("ul")),ZCALaddListener(d._ulEl,"mousedown",p));var t="hh:mm a"==d._tform?d.timeObj12hr(this.value):d.timeObj24hr(this.value);if(t){d._ulEl.innerHTML=t[0],d._ulEl.style.display="";var a=d._ulEl.getElementsByTagName("li").length;d._ulEl.style.height=24*(a<=2?a:4)+"px",d._ulEl.scrollTop=24*t[1],d._inEl.value="hh:mm a"==d._tform?this.value.toUpperCase().replace(/^0/,""):this.value,this.placeholder=t[2],this.value="",d._sel=t[1],d._prevalue=this.value}else d._inEl.value=this.value,this.value="",this.placeholder="",d._ulEl.style.display="none";d._inEl.focus()};return 1==d._type?(ZCALaddListener(d._tar,"focus",e),ZCALaddListener(d._tar,"click",e)):2==d._type?ZCALaddListener(d._refer,"focus",a):3==d._type&&(ZCALaddListener(d._refer,"keydown",t),ZCALaddListener(d._refer,"keyup",t),ZCALaddListener(d._refer,"mouseup",t)),this},ZCALtimepickr.prototype.typenos=function(e,t,a){if(6==a&&/(A|P)/gi.test(String.fromCharCode(t))){var l=String.fromCharCode(t);return _ch="A"==l?" "+ZCALtform[0]:" "+ZCALtform[1],e.value=e.value.substring(0,5)+_ch,ZCALcrtesel(e,a,a+2),!0}var c=String.fromCharCode(t),i="HH:mm"==(this._tform||e.getAttribute("tform"));""==this.n?c="0"+(this.n=c):(c=this.n+""+c,this.n=""),0==a&&(!i&&parseInt(c,10)<=12||i&&parseInt(c,10)<=23)?e.value=c+e.value.substring(2):3==a&&parseInt(c,10)<=59&&(e.value=e.value.substring(0,3)+c+e.value.substring(5));var n=this;setTimeout(function(){n.n=""},1e4),ZCALcrtesel(e,a,a+2)},ZCALtimepickr.prototype.shiftnos=function(e,t,a){var l=e.value.substring(t,t+2);if(0==t){var c="HH:mm"==(this._tform||e.getAttribute("tform")),i=parseInt(l,10);c&&0==i&&-1==a?i=23:c||1!=i||-1!=a?c&&23==i&&1==a?i=0:c||12!=i||1!=a?i+=a:i=1:i=12,e.value=(i<=9?"0":"")+i+e.value.substring(2,8)}else if(3==t){0==(i=parseInt(l,10))&&-1==a?i=59:59==i&&1==a?i=1:i+=a,e.value=e.value.substring(0,3)+(i<=9?"0":"")+i+e.value.substring(5,8)}else 6==t&&(l==ZCALtform[0]?e.value=e.value.substring(0,5)+" "+ZCALtform[1]:e.value=e.value.substring(0,5)+" "+ZCALtform[0]);return ZCALcrtesel(e,t,t+2),"true"},ZCALtimepickr.prototype.timeObj12hr=function(e){var t=this.get12hrTime(e),a="";if(t&&t.arr){for(var l=0;l<t.arr.length;l++)a+="<li"+(l==t.sel?" class='zcal_sl'":"")+">"+t.arr[l]+"</li>";return this._menu=!1,[a,t.sel,t.arr[t.sel]]}if(t&&-1<t.sel){var c="";if(this._menu)c=0==t.sel?"12:00 AM":t.sel+":00 AM";else for(l=0;l<24;l++){var i=0==l?"12:00 AM":12==l?"12:00 PM":12<l?l-12+":00 PM":l+":00 AM";l==t.sel&&(c=i),a+="<li"+(l==t.sel?" class='zcal_sl'":"")+">"+i+"</li>",a+="<li>"+i.replace("00","30")+"</li>"}return this._menu=!0,[a,2*t.sel,c]}return!1},ZCALtimepickr.prototype.get12hrTime=function(e){var t,a,l=e.length;return 1<l&&":"==e[1]&&l++,!!(0<l&&l<=8&&(t=e.match(new RegExp(["^([0-9])$","^(0?[1-9]|1[012])$","^(0?[1-9]|1[012])(:)$","^(0?[1-9]|1[012])(:)([0-5])$","^(0?[1-9]|1[012])(:)([0-5][0-9])$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)([APap])$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)([APap][mM])$"][l-1]))))&&(t=Array.prototype.slice.call(t,1),l<4?{sel:11<(a=parseInt(t[0],10))?0:0==a?12:a}:4==l?{arr:[(e=0==e[0]?e.slice(1):e)+"0 AM",e+"5 PM",e+"0 AM",e+"5 PM"],sel:0}:4<l?{arr:[(a=0==(a=e.substring(0,5).trim())[0]?a.slice(1):a)+" AM",a+" PM"],sel:t[4]?/a/i.test(t[4][0])?0:1:0}:void 0)},ZCALtimepickr.prototype.timeObj24hr=function(e){var t=this.get24hrTime(e),a=tmp="";if(t&&t.arr){for(var l=0;l<t.arr.length;l++)a+="<li "+(l==t.sel?"class='zcal_sl'":"")+">"+t.arr[l]+"</li>";return this._menu=!1,[a,t.sel,t.arr[t.sel]]}if(t&&-1<t.sel){if(!this._menu)for(l=0;l<24;l++)tmp=l<10?"0"+l:l,a+="<li "+(l==t.sel?"class='zcal_sl'":"")+" >"+tmp+":00</li>",a+="<li>"+tmp+":30</li>";return this._menu=!0,[a,2*t.sel,(t.sel<10?"0"+t.sel:t.sel)+":00"]}},ZCALtimepickr.prototype.get24hrTime=function(e){var t,a=e.length;if(!(0<a&&a<6&&(t=e.match(new RegExp(["^([0-2])$","^([0-1][0-9]|2[0-3])$","^([0-1][0-9]|2[0-3])(:)$","^([0-1][0-9]|2[0-3])(:)([0-5])$","^([0-1][0-9]|2[0-3])(:)([0-5][0-9])$"][a-1])))))return!1;if(t=Array.prototype.slice.call(t,1),2==a)return{sel:l=parseInt(t[0],10)};if(a<4){var l=parseInt(t[0],10);return{sel:1==t[0].length&&l<=2?10*l:l}}return 4==a?{arr:[e+"0",e+"5"],sel:0}:5==a?{arr:[e],sel:0}:void 0};var ZCALrangepickr=function(e){if(e){this._name="rangepicker",e.range=e.range||["",""],e.range[0]=""!=e.range[0].trim()?new Date(e.range[0].parseDate(e.dform)):new Date(1947,8,15),e.range[1]=""!=e.range[1].trim()?new Date(e.range[1].parseDate(e.dform)):new Date(2147,8,15),e.range[1]=0<=e.range[0].diffTo("month",e.range[1])?e.range[1]:new Date(2147,8,15);var t=new Date,a=e.range[0].diffTo("month",new Date),l=t.diffTo("month",e.range[1]),c=0<=a&&0<l?new Date((new Date).setDate(1)):a<=0?e.range[0]:l<=0?new Date(e.range[1].getFullYear(),e.range[1].getMonth()-1,1):"",i=new Date(c.getFullYear(),c.getMonth()+1);return this._r1=new ZCALdatepickr({dform:e.dform||"MM/DD/YYYY",curdate:c,wkst:e.wkst||0,template:"type3",_cont:(new Date).getTime()+"_"+ZEVENTS.count++,range:e.range}),this._r2=new ZCALdatepickr({dform:e.dform||"MM/DD/YYYY",curdate:i,wkst:e.wkst||0,template:"type3",_cont:(new Date).getTime()+"_"+ZEVENTS.count++,range:e.range}),this._clkdates=[],this._selfn=[],this._tar="object"==_typeof(e.target)?e.target:document.getElementById(e.target),this._bsecont=ZEVENTS.template("type3")._bsecont,this._patch=ZEVENTS.template("type3")._patch,this._cont=(new Date).getTime()+"_"+ZEVENTS.count++,this}};ZCALrangepickr.prototype.on=function(e,t){return"select"==e&&"function"==typeof t&&this._selfn.push(t),this},ZCALrangepickr.prototype.bind=function(){var z=this,e=document.createElement(z._bsecont.tag);e.id=z._cont,e.className=z._bsecont._class,z._tar.appendChild(e);var t=z._r1._curDate.diffTo("month",z._r2._curDate);z.clearobj=function(){ZCALremoveListener(document.getElementById(z._r1._cont),"mousedown",l),ZCALremoveListener(document.getElementById(z._r2._cont),"mousedown",l),ZCALremoveListener(e,"selectstart",ZCALprevDef),ZCALremoveListener(e,"dragstart",ZCALprevDef);e.parentNode.removeChild(e)},z.clearvar=function(){z=e=t=null};function f(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}var l=function(e){var t=e.target||event.srcElement,a=t.getAttribute("rel"),l=t.parentNode.getAttribute("rel"),c="r1"==this.rel?z._r1:z._r2,i=new Date(c._curDate),n=!1;if("u"==t.tagName.toLowerCase()||-1!=t.className.indexOf("zcal_dis"))return ZCALprevDef(e),!1;if("PM"==a||"PM"==l)i=ZCALchangeMonth(i,-1),c._curDate=i;else if("NM"==a||"NM"==l)i=ZCALchangeMonth(i,1),c._curDate=i;else if("PY"==a||"PY"==l)i.setYear(i.getFullYear()-1),c._curDate=i;else if("NY"==a||"NY"==l)i.setYear(i.getFullYear()+1),c._curDate=i;else if("DT"==t.parentNode.parentNode.getAttribute("rel")){if(t.className&&t.className==ZEVENTS.template(c._template)._class.dis)return;if(i.setDate(parseInt(t.innerHTML,10)),0==(s=z._clkdates.length)||2<=s)z._clkdates=new Array(i);else if(1==s&&z._clkdates[0].getTime()!=i.getTime()){var r=i<z._clkdates[0]?0:1;z._clkdates.splice(r,0,i),n=!0}}var s=z._clkdates.length;if(z._r1._select=z._r2._select=[],2==s){var d=z._clkdates[0].diffTo("month",z._r1._curDate),o=z._r1._curDate.diffTo("month",z._clkdates[1]),u=z._clkdates[0].diffTo("month",z._r2._curDate),p=z._r2._curDate.diffTo("month",z._clkdates[1]);0<=d&&0<=o&&(z._r1._select={start:0<d?1:z._clkdates[0].getDate(),end:0<o?new Date(z._r1._curDate.getFullYear(),z._r1._curDate.getMonth()+1,0).getDate():z._clkdates[1].getDate()}),0<=u&&0<=p&&(z._r2._select={start:0<u?1:z._clkdates[0].getDate(),end:0<p?new Date(z._r2._curDate.getFullYear(),z._r2._curDate.getMonth()+1,0).getDate():z._clkdates[1].getDate()})}else 1==s&&0==z._clkdates[0].diffTo("month",i)&&(c._select=[i.getDate()]);var m=z._r1._curDate.diffTo("month",z._r2._curDate);if(z.resetDRange("r1"==this.rel?"r1":"r2"),f(v.call(z._r1)).innerHTML=z._r1.calendar(),f(h.call(z)).innerHTML=1<m?z._patch._cont:"",f(v.call(z._r2)).innerHTML=z._r2.calendar(),n)for(var _ in z._selfn)z._selfn[_].call({getDateRange:{from:z._clkdates[0],to:z._clkdates[1]}})};t<=0&&(z._r2._curDate=new Date(new Date(z._r1._curDate.getTime()).setMonth(z._r1._curDate.getMonth()+1)));var v=function(e){var t=document.getElementById(this._cont);if(!t){var a=ZEVENTS.template(this._template)._cont;(t=document.createElement(a.tag)).className=a._class,t.rel=e,t.id=this._cont,document.getElementById(z._cont).appendChild(t),ZCALaddListener(t,"mousedown",l)}return t},h=function(){var e;(e=document.getElementById(this._cont+"_patch"))||((e=document.createElement(this._patch.tag)).id=this._cont+"_patch",document.getElementById(this._cont).appendChild(e));return e};return z.resetDRange(),v.call(z._r1,"r1").innerHTML=z._r1.calendar(),h.call(z).innerHTML=1<t?z._patch._cont:"",v.call(z._r2,"r2").innerHTML=z._r2.calendar(),ZCALaddListener(e,"selectstart",ZCALprevDef),ZCALaddListener(e,"dragstart",ZCALprevDef),this},ZCALrangepickr.prototype.resetDRange=function(e){this._r1._edate=new Date(this._r2._curDate.getFullYear(),this._r2._curDate.getMonth(),0),this._r2._sdate=new Date(this._r1._curDate.getFullYear(),this._r1._curDate.getMonth()+1,1)};var extendNativeObject,ZCALdatepickr=function(e){return e=e||{},this.fullDtclk=null!=e.fullDtclk?e.fullDtclk:0,this._name="datepicker",this._dform=e.dform||"mm/dd/yyyy",this._tform=e.tform||0,this._wkst=e.wkst&&/^[0-7]$/g.test(e.wkst)?e.wkst:0,this._tar="object"==_typeof(e.target)?e.target:document.getElementById(e.target),this._type=e.mode||"inline",this._titype=e.time||"",this._select=e.select||[],this._monchge=[],this._yrchge=[],this._dtclk=[],this._okclk=[],this._customdate=e.customdate||"no",this._template=e.template||("yes"==this._customdate?"type7":"inline"==this._type?"type1":"popup"==this._type&&"right"==this._titype?"type5":"popup"!=this._type||"bottom"!=this._titype&&"bottom-inline"!=this._titype?"type2":"type7"),this._curDate=e.curdate||(e.today?e.today.parseDate(this._dform):new Date),this._cont=e._cont||(new Date).getTime()+"_"+ZEVENTS.count++,this._change=e.update||"yes",this._minhgt=e.minhgt||251,this._tz=e.timezone||"",this._selDate=new Date,this._curTime,this._pickerview=e.pickerview||"",e.fn&&(this.fn=e.fn),e.timerange&&(this._stime=e.timerange[0],this._etime=e.timerange[1]),e.range&&"[object String]"==Object.prototype.toString.call(e.range[0])?(this._sdate=e.range[0].parseDate(this._dform)||new Date(1947,8,15),this._edate=e.range[1].parseDate(this._dform)||new Date(2147,8,15)):e.range&&"[object Date]"==Object.prototype.toString.call(e.range[0])?(this._sdate=e.range[0],this._edate=e.range[1]):(this._sdate=null,this._edate=null),e.refer?this._refer="object"==_typeof(e.refer)?e.refer:document.getElementById(e.refer):this._tar&&(this._refer="input"==this._tar.tagName.toLowerCase()?this._tar:this._tar.getElementsByTagName("input")[0]),this};ZCALdatepickr.prototype.on=function(e,t){return"monthchge"==e&&"function"==typeof t?this._monchge.push(t):"yearchge"==e&&"function"==typeof t?this._yrchge.push(t):"dateclick"==e&&"function"==typeof t?this._dtclk.push(t):"ok"==e&&"function"==typeof t&&this._okclk.push(t),this},ZCALdatepickr.prototype.updateselect=function(e){return this._r1||(this._select=e||this._select,document.getElementById(this._cont).innerHTML=this.calendar()),this},ZCALdatepickr.prototype.bind=function(){var y=this,e=ZEVENTS.template(y._template)._cont,L="",b=document.createElement(e.tag);b.id=y._cont,b.className=e._class,y.clearobj=function(){if(ZEVENTS.obj.state=null,document.getElementById(y._cont)){ZCALremoveListener(b,"mousedown",c),ZCALremoveListener(b,"selectstart",ZCALprevDef),ZCALremoveListener(b,"dragstart",ZCALprevDef);b.parentNode.removeChild(b);"popup"==y._type&&(ZCALremoveListener(document,"mousedown",docevehandle),ZCALremoveListener(document,"scroll",docevehandle),ZCALremoveListener(document,"mousewheel",docevehandle),"bottom"!=y._titype&&"bottom-inline"!=y._titype||(ZCALremoveListener(b,"keydown",docevekeyhandle1),ZCALremoveListener(b,"keyup",docevekeyhandle2),ZCALremoveListener(b,"focusout",docevekeyhandle1))),0}},y.hide=function(e){var t=!0;b.contains(e.target)&&(t=!1),t&&y.clearobj()},y.clearvar=function(){y=b=e=null};function t(e){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state);var t=(ZEVENTS.obj.state=y)._refer,a=(document.documentElement.clientHeight||window.innerHeight)+Math.max(document.body.scrollTop,document.documentElement.scrollTop),l=(document.documentElement.clientWidth||window.innerWidth)+Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);document.body.appendChild(b),ZCALaddListener(b,"mousedown",c),ZCALaddListener(b,"selectstart",ZCALprevDef),ZCALaddListener(b,"dragstart",ZCALprevDef),ZCALaddListener(document,"mousedown",docevehandle=function(e){y.hide(e)}),ZCALaddListener(document,"scroll",docevehandle=function(e){y.hide(e)}),ZCALaddListener(document,"mousewheel",docevehandle=function(e){y.hide(e)}),"bottom"==y._titype||"bottom-inline"==y._titype?(L=this.parentNode.positionY()+this.parentNode.offsetHeight+y._minhgt>a?"no":"yes",b.style.top=this.parentNode.positionY()+this.parentNode.offsetHeight-y._minhgt+"px"):(L=this.positionY()+this.offsetHeight+y._minhgt>a?"no":"yes",b.style.left=this.positionX()+(this.positionX()+260>l?-260+this.offsetWidth:0)+"px",b.style.top=("yes"==L?this.positionY()+this.offsetHeight:this.positionY()-b.offsetHeight)+"px"),y._curDate=t.value.parseDate(y._dform)||new Date((new Date).setHours(0,0,0,0)),b.innerHTML=y.calendar(L),b.style.left="bottom"==y._titype||"bottom-inline"==y._titype?this.parentNode.positionX()-b.offsetWidth+"px":b.style.left,b.style.top="bottom"==y._titype||"bottom-inline"==y._titype?this.parentNode.positionY()+this.parentNode.offsetHeight-b.offsetHeight+"px":b.style.top,b.style.top=("bottom"==y._titype||"bottom-inline"==y._titype)&&parseInt(b.style.top)<0?this.parentNode.positionY()+this.parentNode.offsetHeight+"px":b.style.top,y._refer.focus(),ZCALprevDef(e)}function E(e,t,a,l){return 0==l?{getDates:function(){return[t,e]}}:2==l?{getDateObj:function(){return{selectDate:e,selectTime:a}}}:{getDate:function(){return e}}}var c=function(e){var t=(e=e||event).target||e.srcElement,a=t.getAttribute("rel"),l=t.parentNode.getAttribute("rel"),c=[],i=0,n=new Date(y._curDate);if("u"==t.tagName.toLowerCase()||"object"!=_typeof(t.className)&&-1!=t.className.indexOf("zcal_dis")){if(1!=y.fullDtclk||"u"!=t.tagName.toLowerCase())return ZCALprevDef(e),!1;c=y._dtclk,i=1;var r=parseInt(t.getAttribute("rel").split("Y")[0]),s=parseInt(t.getAttribute("rel").split("Y")[1]);n.setDate(parseInt(t.innerHTML,10)),n.setMonth(r),n.setYear(s)}if("PY"==a||"PY"==l){var d="PY"==a?t:t.parentNode;if("object"==_typeof(d)&&"zcal_dis"==d.getAttribute("class"))return;c=y._yrchge,n.setYear(n.getFullYear()-1)}else if("NY"==a||"NY"==l){d="NY"==a?t:t.parentNode;if("object"==_typeof(d)&&"zcal_dis"==d.getAttribute("class"))return;c=y._yrchge,n.setYear(n.getFullYear()+1)}else if("PM"==a||"PM"==l){d="PM"==a?t:t.parentNode;if("object"==_typeof(d)){if("zcal_dis"==d.getAttribute("class"))return;if(document.querySelector("div.zcal_vw_yr")){var o=document.querySelectorAll("li[rel=year_sel]"),u=parseInt(o[0].querySelector("span").innerHTML)-12,p=parseInt(u)+11;document.querySelector("span[rel=year_idx]").innerHTML=u+" - "+p,n.setFullYear(u),y._tempview="year"!=y._pickerview,y._pickerview="year"}else document.querySelector("div.zcal_vw_mth")?(n.setFullYear(y._curDate.getFullYear()-1),document.querySelector("span[rel=year_idx]").innerHTML=y._curDate.getFullYear(),y._tempview="month"!=y._pickerview,y._pickerview="month"):(c=y._monchge,n=ZCALchangeMonth(n,-1))}else c=y._monchge,n=ZCALchangeMonth(n,-1)}else if("NM"==a||"NM"==l){d="NM"==a?t:t.parentNode;if("object"==_typeof(d)){if("zcal_dis"==d.getAttribute("class"))return;if(b.querySelector("div.zcal_vw_yr")){o=b.querySelectorAll("li[rel=year_sel]"),u=parseInt(o[o.length-1].querySelector("span").innerHTML)+1,p=parseInt(u)+11;b.querySelector("span[rel=year_idx]").innerHTML=u+" - "+p,n.setFullYear(u),y._tempview="year"!=y._pickerview,y._pickerview="year"}else b.querySelector("div.zcal_vw_mth")?(n.setFullYear(n.getFullYear()+1),b.querySelector("span[rel=year_idx]").innerHTML=y._curDate.getFullYear(),y._tempview="month"!=y._pickerview,y._pickerview="month"):(n=ZCALchangeMonth(n,1),c=y._monchge)}else n=ZCALchangeMonth(n,1),c=y._monchge}else if("TL"==a||"HI"==a||"MI"==a||"AP"==a)i=3;else if("DT"!=t.parentNode.parentNode.getAttribute("rel")||"bottom"!=y._titype&&"bottom-inline"!=y._titype){if("month_idx"==a&&"no"!=y._customdate)i=2,y.updateHead(b,t,"month_idx");else if("year_idx"==a&&"no"!=y._customdate)i=2,y.updateHead(b,t,"year_idx");else if("month_sel"==l||"month_sel"==a){i="month"==y._pickerview?1:0;g=(m="month_sel"==a?t.childNodes[0]:t).getAttribute("rel");if("zcal_dis"==m.parentNode.className)return;"month"==y._pickerview?(n.setMonth(g),c=y._dtclk,y.clearobj()):(c=y._monchge,n.setMonth(g),b.querySelector("div.zcal_mCalvw").className="zcal_mCalvw zcal_vw_dy")}else if("year_sel"==l||"year_sel"==a){i=2;var m="year_sel"==a?t.childNodes[0]:t;g=parseInt(m.innerHTML,10);if("zcal_dis"==m.parentNode.className)return;"year"==y._pickerview?(n.setFullYear(g),c=y._dtclk,y.clearobj()):(c=y._yrchge,n.setFullYear(g),document.querySelector("span[rel=year_idx]").innerHTML=y._curDate.getFullYear(),y._tempview="month"!=y._pickerview,y._pickerview="month",i=0)}else if("DT"==t.parentNode.parentNode.getAttribute("rel"))c=y._dtclk,i=1,n.setDate(parseInt(t.innerHTML,10));else if("OK"==a){i=2;var _=document.getElementById("zcal_hr").value,z=document.getElementById("zcal_min").value,f=document.getElementById("zcal_ap")?document.getElementById("zcal_ap").value:"";""==_&&(_=12<(new Date).getHour()?(new Date).getHour()-12:(new Date).getHour()),""==z&&(z=(new Date).getMinutes());var v=f?_+":"+z+":"+f:_+":"+z;if(y._curTime=v,t.parentNode.parentNode.parentNode.parentNode.parentNode.querySelectorAll(".zcal_sl").length){var h=t.parentNode.parentNode.parentNode.parentNode.parentNode.querySelectorAll(".zcal_sl")[0].innerHTML;n.setDate(parseInt(h,10))}else{h=t.parentNode.parentNode.parentNode.parentNode.parentNode.querySelectorAll("s")[0].innerHTML;n.setDate(parseInt(h,10))}c=y._okclk,y.clearobj()}}else{var g;i=2,(g=t.parentNode.parentNode).querySelector(".zcal_sl")?g.querySelector(".zcal_sl").innerHTML!=t.innerHTML&&(g.querySelector(".zcal_sl").className="",t.className="zcal_sl"):t.className="zcal_sl",c=y._dtclk,n.setDate(parseInt(t.innerHTML,10)),y._selDate=n}if(0==i){for(y._curDate=n;b.firstChild;)b.removeChild(b.firstChild);b.innerHTML=y.calendar(L)}for(var C in 1==i&&y&&"popup"==y._type&&("bottom"==y._titype||"bottom-inline"==y._titype?"yes"==y._change&&(y._refer.value=n.getDateBy(y._dform)):("yes"==y._change&&(y._refer.value=n.getDateBy(y._dform)),y.clearobj())),c)c[C].call(E(n,y._curDate,y._curTime,i));3!=i&&ZCALprevDef(e)};return"inline"==y._type?(y._tar.appendChild(b),ZCALaddListener(b,"mousedown",c),ZCALaddListener(b,"selectstart",ZCALprevDef),ZCALaddListener(b,"dragstart",ZCALprevDef),b.innerHTML=y.calendar()):"popup"==y._type&&("bottom"==y._titype||"bottom-inline"==y._titype)||"popup"==y._type&&y.fn?(ZCALaddListener(y._refer,"click",function(){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state);var e=(ZEVENTS.obj.state=y)._refer;L="yes",y._curDate=(1<e.value.split(" ").length?e.value.split(" ")[0].parseDate(y._dform):e.value.parseDate(y._dform))||new Date,b.innerHTML=y.calendar(L),ZCALaddListener(b,"mousedown",c),ZCALaddListener(document,"mousedown",docevehandle=function(e){y.hide(e)}),ZCALaddListener(document,"scroll",docevehandle=function(e){y.hide(e)}),ZCALaddListener(document,"mousewheel",docevehandle=function(e){y.hide(e)}),y.fn(b)}),ZCALaddListener(b,"keydown",docevekeyhandle1=function(e){!function(e,t){var a=e.which||e.keyCode||e.charCode;if("zcal_hr"==t){var l=document.getElementById(t).value;38==a?0==y._tform?l<=11?(document.getElementById(t).value=++l,document.getElementById(t).value=9<l?l:"0"+l):document.getElementById(t).value="01":l<=23?(document.getElementById(t).value=++l,document.getElementById(t).value=9<l?l:"0"+l):document.getElementById(t).value="01":40==a&&(0==y._tform?1<l&&1!=l?(document.getElementById(t).value=--l,document.getElementById(t).value=9<l?l:"0"+l):document.getElementById(t).value=12:1<l&&1!=l?(document.getElementById(t).value=--l,document.getElementById(t).value=9<l?l:"0"+l):document.getElementById(t).value=24)}else if("zcal_min"==t){l=document.getElementById(t).value;if(38==a)if(l<=58){var c=++l;document.getElementById(t).value=c<10?"0"+c:c}else document.getElementById(t).value="00";else if(40==a)if(0<l&&0!=l){c=--l;document.getElementById(t).value=c<10?"0"+c:c}else document.getElementById(t).value=59}else if("zcal_ap"==t){l=document.getElementById(t).value;38==a?document.getElementById(t).value="AM"==l?"PM":"AM":40==a&&(document.getElementById(t).value="AM"==l?"PM":"AM")}}(e,e.target.id)}),ZCALaddListener(b,"keyup",docevekeyhandle2=function(e){!function(e,t){var a=e.which||e.keyCode||e.charCode;if("zcal_hr"==t){if(38!=a&&40!=a){var l=document.getElementById(t).value,c=/^[0-9]{1,10}$/;document.getElementById(t).value;c.test(l)?0==y._tform?document.getElementById(t).value=12<l&&l<24?l-12<10?"0"+(l-12):l-12:l<12?document.getElementById(t).value:12<(new Date).getHours()?"0"+((new Date).getHours()-12):(new Date).getHours()<10?"0"+(new Date).getHours():(new Date).getHours():document.getElementById(t).value=12<l&&l<24?l<10?"0"+l:l:l<12?document.getElementById(t).value:12<(new Date).getHours()?(new Date).getHours():(new Date).getHours()<10?"0"+(new Date).getHours():(new Date).getHours():""!=l&&(document.getElementById(t).value=(new Date).getHours())}}else if("zcal_min"==t&&38!=a&&40!=a){l=document.getElementById(t).value,c=/^[0-9]{1,10}$/,document.getElementById(t).value;c.test(l)?(60<l||2<l.length)&&(document.getElementById(t).value=(new Date).getMinutes()):""!=l&&(document.getElementById(t).value="00")}}(e,e.target.id)}),ZCALaddListener(b,"focusout",docevekeyhandle1=function(e){!function(e){if("zcal_hr"==e)""==document.getElementById(e).value&&(0==y._tform?document.getElementById(e).value=12<(new Date).getHours()?"0"+((new Date).getHours()-12):(new Date).getHours()<10?"0"+(new Date).getHours():(new Date).getHours():document.getElementById(e).value=12<(new Date).getHours()?(new Date).getHours():(new Date).getHours()<10?"0"+(new Date).getHours():(new Date).getHours());else if("zcal_min"==e){""==document.getElementById(e).value&&(document.getElementById(e).value=(new Date).getMinutes()<10?"0"+(new Date).getMinutes():(new Date).getMinutes())}}(e.target.id)})):"popup"==y._type&&(ZCALaddListener(y._refer,"focus",t),ZCALaddListener(y._refer,"blur",docevehandle=function(){y.clearobj()}),ZCALaddListener(y._refer,"keypress",ZCALprevDef),ZCALaddListener(y._tar,"mousedown",t)),this},ZCALdatepickr.prototype.updateHead=function(e,t,a){if("month_idx"==a){var l=this._sdate?this._sdate.getMonth():"",c=this._edate?this._edate.getMonth():"";if(l&&c&&l==c)return;t.style.display="none";var i=e.querySelectorAll("li[rel=month_sel]");"zcal_dis"==i[i.length-1].className&&e.querySelector("svg[rel=nm]").setAttribute("class","zcal_dis"),"zcal_dis"==i[0].className&&e.querySelector("svg[rel=pm]").setAttribute("class","zcal_dis"),e.querySelector("div.zcal_mCalvw")&&(e.querySelector("div.zcal_mCalvw").className="zcal_mCalvw zcal_vw_mth")}else if("year_idx"==a){var n=e.querySelectorAll("li[rel=year_sel]"),r=n[0].querySelector("span").innerHTML,s=n[n.length-1].querySelector("span").innerHTML,d=this._sdate?this._sdate.getFullYear():"",o=this._edate?this._edate.getFullYear():"";if(d&&o&&d==o)return;t.innerHTML=r+" - "+s,t.previousSibling.style.display="none",d&&o&&(r<d?e.querySelector("svg[rel=pm]").setAttribute("class","zcal_dis"):o<s&&e.querySelector("svg[rel=nm]").setAttribute("class","zcal_dis")),e.querySelector("div.zcal_mCalvw")&&(e.querySelector("div.zcal_mCalvw").className="zcal_mCalvw zcal_vw_yr")}e.querySelector("svg[rel=NY]").setAttribute("class","zcal_dis"),e.querySelector("svg[rel=PY]").setAttribute("class","zcal_dis")},ZCALdatepickr.prototype.changeDate=function(e){var t=document.getElementById(this._cont);for(this._curDate=e?e.parseDate(this._dform):this._curDate;t.firstChild;)t.removeChild(t.firstChild);return t.innerHTML=this.calendar(""),!0},ZCALdatepickr.prototype.calendar=function(e){var t=ZEVENTS.template(this._template),a=t._HTML,l=t._class,c=t._cust;if("type7"==this._template)if("right"==this._titype){var i=(a=(a=(a=(a=a.replace("#timerow","")).replace("timerow#","")).replace("#okrow","")).replace("okrow#","")).indexOf("#bottomtimerow"),n=a.indexOf("bottomtimerow#");a=a.replace(a.substring(i,n+"bottomtimerow#".length),"")}else if("bottom"==this._titype||"bottom-inline"==this._titype){i=(a=(a=a.replace("#bottomtimerow","")).replace("bottomtimerow#","")).indexOf("#timerow"),n=a.indexOf("timerow#");var r=(a=a.replace(a.substring(i,n+"timerow#".length),"")).indexOf("#okrow"),s=a.indexOf("okrow#");a=a.replace(a.substring(r,s+"okrow#".length),""),0==this._tform&&(a=a.replace("#tf",""))}else{i=a.indexOf("#timerow"),n=a.indexOf("timerow#"),r=(a=a.replace(a.substring(i,n+"timerow#".length),"")).indexOf("#okrow"),s=a.indexOf("okrow#");var d=(a=a.replace(a.substring(r,s+"okrow#".length),"")).indexOf("#bottomtimerow"),o=a.indexOf("bottomtimerow#");a=a.replace(a.substring(d,o+"bottomtimerow#".length),"")}var u=a.indexOf("#wk"),p=a.indexOf("wk#"),m=a.indexOf("#dr"),_=a.indexOf("dr#"),z=a.indexOf("#tr"),f=a.indexOf("tr#"),v=(n=a.indexOf("#br"),r=a.indexOf("br#"),s=a.indexOf("#tf"),a.indexOf("#ycr")),h=a.indexOf("ycr#"),g=a.indexOf("#mcr"),C=a.indexOf("mcr#"),y="type7"==this._template?a.substring(0,v):a.substring(0,u);if(y+="type7"==this._template?this.yearrow(a.substring(v+4,h)):"",y+="type7"==this._template?a.substring(h+4,g):"",y+="type7"==this._template?this.monthrow(a.substring(g+4,C)):"",y+="type7"==this._template?a.substring(C+4,u):"",y=(y="type7"==this._template?y.replace("#viewclass#","month"==this._pickerview?"zcal_mCalvw zcal_vw_mth":"year"==this._pickerview?"zcal_mCalvw zcal_vw_yr":"zcal_mCalvw zcal_vw_dy"):y).replace("#HEAD#",this._curDate.getDateBy("MMMM YYYY")).replace("#HEADM#","year"==this._pickerview||"month"==this._pickerview?"":this._curDate.getDateBy("MMMM")).replace("#HEADY#","year"==this._pickerview?this._curDate.getDateBy("YYYY")+"-"+(parseInt(this._curDate.getDateBy("YYYY"))+11):this._curDate.getDateBy("YYYY")),this._sdate&&this._edate){var L=this._sdate.getFullYear(),b=this._sdate.getMonth(),E=this._edate.getFullYear(),T=this._edate.getMonth(),D=this._curDate.getFullYear(),Z=this._curDate.getMonth(),A=this._curDate.getDate();y=y.replace("#py#",("type7"==this._template?"":"zci-fst ")+(new Date(D-1,Z,A)>=this._sdate&&"year"!=this._pickerview&&"month"!=this._pickerview?"":"zcal_dis")).replace("#ny#",("type7"==this._template?"":"zci-lst ")+(new Date(D+1,Z,A)<=this._edate&&"year"!=this._pickerview&&"month"!=this._pickerview?"":"zcal_dis")).replace("#pm#",("type7"==this._template?"":"zci-pre ")+("type7"==this._template&&"month"==this._pickerview&&D<=L?"zcal_dis":new Date(D,Z,1)>new Date(L,b,1)?"":"zcal_dis")).replace("#nm#",("type7"==this._template?"":"zci-nxt ")+("type7"==this._template&&"month"==this._pickerview&&E<=D?"zcal_dis":new Date("type7"==this._template&&"year"==this._pickerview?D+11:D,Z,1)<new Date(E,T,1)?"":"zcal_dis"))}else y=y.replace("#py#","type7"==this._template?"month"==this._pickerview||"year"==this._pickerview?"zcal_dis":"":c?c.py:"zci-fst").replace("#ny#","type7"==this._template?"month"==this._pickerview||"year"==this._pickerview?"zcal_dis":"":c?c.ny:"zci-lst").replace("#pm#","type7"==this._template?"":c?c.pm:"zci-pre").replace("#nm#","type7"==this._template?"":c?c.nm:"zci-nxt");return y=1==this.fullDtclk?y.replace("#hover#","zcal_mCalce"):y.replace("#hover#",""),"bottom-inline"!=this._titype&&(y=y.replace("#shadow#",e&&"yes"!=e?l.shup:l.shdwn)),"type7"==this._template&&(y=y.replace("#timediv#","right"==this._titype?"zcl_mCalwti":"")),y+=this.weekrow(a.substring(u+3,p)),y+=a.substring(p+3,m),y+=this.daterow(a.substring(m+3,_)),"right"==this._titype?(y+=a.substring(_+3,z).replace("#tz#",this._tz),y+=this.timerow(a.substring(z+3,f)),y+=a.substring(f+3,a.length)):"bottom"==this._titype||"bottom-inline"==this._titype?(y+=a.substring(_+3,n).replace("#tz#",this._tz),y+=this.setTimeValue(a.substring(n+3,0==this._tform?r:s)),y+=a.substring(r+3,a.length)):y+=a.substring(_+3,a.length).replace("#tz#",this._tz),this._tempview&&(this._pickerview=""!=this._pickerview?"":this._pickerview),y},ZCALdatepickr.prototype.setTimeValue=function(e){var t=this._refer,a=(1<t.value.split(" ").length?t.value.split(" ")[1]:t.value)||new Date,l=new Date,c=12<(a="string"==typeof a?(l.setHours(a.split(":")[0]),l.setMinutes(a.split(":")[1]),l.setSeconds(a.split(":")[2]),l):a).getHours()&&0==this._tform?a.getHours()-12:a.getHours(),i=c,n=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),r=12<=a.getHours()?"PM":"AM",s=9<i?i:0==i?12:"0"+i;return e.replace("#cuHr#",s).replace("#cuMin#",n).replace("#apm#",r)},ZCALdatepickr.prototype.yearrow=function(e){for(var t="",a=this._sdate?this._sdate.getFullYear():"",l=this._edate?this._edate.getFullYear():"",c=e.indexOf("#yt"),i=e.indexOf("yt#"),n=this._curDate.getFullYear(),r=((new Date).getFullYear(),new Date,e.substring(c+3,i)),s=0,d=0;d<4;d++){t+=e.substring(0,c);for(var o=0;o<3;o++){var u="";u=r.replace("#item#","<span>"+(n+s)+"</span>"),this._curDate.getFullYear()==n+s?u=a&&l&&(n+s<a||l<n+s)?u.replace("#selclass#","zcal_dis"):u.replace("#selclass#","zcal_sl_cr"):a&&l&&(n+s<a||l<n+s)&&(u=u.replace("#selclass#","zcal_dis")),t+=u,s++}t+=e.substring(i+3,e.length)}return t},ZCALdatepickr.prototype.monthrow=function(e){for(var t="",a=e.indexOf("#mt"),l=e.indexOf("mt#"),c=e.substring(a+3,l),i=cnt=0,n=this._curDate.getFullYear(),r=this._sdate?this._sdate.getMonth():"",s=this._edate?this._edate.getMonth():"",d=this._sdate?this._sdate.getFullYear():"",o=this._edate?this._edate.getFullYear():"",u=0;u<4;u++){t+=e.substring(0,a);for(var p=0;p<3;p++){var m="";m=c.replace("#item#","<span rel="+(i+cnt)+">"+Date.MONTH_NAMES[1][i+cnt]+"</span>"),d&&o&&(n==d||n==o)&&(r&&s&&n==o&&i+cnt>s?m=m.replace("#selclass#","zcal_dis"):r&&s&&n==d&&i+cnt<r&&(m=m.replace("#selclass#","zcal_dis"))),this._curDate.getMonth()==i+cnt&&(m=m.replace("#selclass#","zcal_sl_cr")),t+=m,cnt++}t+=e.substring(l+3,e.length)}return t},ZCALdatepickr.prototype.timerow=function(e){var t=new Date;t.setTime((new Date).getTime());var a,l=t.getDate(),c=t.getMonth();t.getFullYear(),c=c+1<10?"0"+(c+1):c+1,l=l<10?"0"+l:l,t.setTime((new Date).getTime()),a=46<(a=2*t.getHours()+(30<t.getMinutes()?2:1))?46:a;for(var i="",n=0;n<48;n++){var r=!1;this._stime&&da.getFullYear()==this._selDate.getFullYear()&&da.getMonth()==this._selDate.getMonth()&&da.getDate()==this._selDate.getDate()&&(r=!0),i+=e.replace("#item#",(n+"").changeNumbertoTime("hh:mm a")).replace("#ti#",n==a?' class="zcal_mCcrti"':1==r&&n<a?' class="zcal_dis"':"")}return i},ZCALdatepickr.prototype.weekrow=function(e){for(var t=new Date(this._curDate).getDay(),a=this._wkst,l=ZEVENTS.template(this._template),c=0,i="";c<7;)i+=e.replace("#item#",Date.WEEKS_DAYS[2][a]).replace("#hgt#",a==t&&l._cust?" class="+l._cust.dysel:""),a=a<6?a+1:0,c++;return i},ZCALdatepickr.prototype.daterow=function(e){var t=e.indexOf("#dc"),a=e.indexOf("dc#"),l=e.substring(t+3,a),c=new Date(this._curDate),i=c.getDate(),n=c.getMonth(),r="",s="",d="",o=",",u=(this._type,"INPUT"==this._tar.tagName?""!=this._tar.value?this._tar.value:"":this._tar.querySelector("input")&&" "!=this._tar.querySelector("input").value?this._tar.querySelector("input").value:""),p=""!=(u=1<u.split(" ").length?u.split(" ")[0]:u)?u.parseDate(this._dform).getMonth():"",m=""!=u?u.parseDate(this._dform).getFullYear():"",_="[object Object]"==Object.prototype.toString.call(this._select);if(!_)for(var z=0;z<this._select.length;z++)o+=this._select[z]+",";c.setDate(1);var f=c.getDay(),v=new Date(c.getFullYear(),c.getMonth(),1),h=new Date(c.getFullYear(),c.getMonth()+1,0),g=(Math.ceil((v.getDay()+h.getDate())/7),f-this._wkst+(f-this._wkst<0?7:0));c.setDate(c.getDate()-g);for(var C=ZEVENTS.template(this._template)._class,y=0;y<6;y++){d+=e.substring(0,t);for(var L=0;L<7;L++){var b="";r=c.getDate(),s=c.getMonth(),cyer=c.getFullYear();var E=C.nor;if(s==n&&!this._sdate&&!this._edate||s==n&&this._sdate&&this._edate&&this._sdate<=c&&this._edate>=c){(""!=o&&-1<o.indexOf(","+r+",")||_&&this._select.start<=r&&this._select.end>=r)&&(E=C.sel);var T=(new Date).getDate(),D=(new Date).getMonth(),Z=(new Date).getFullYear();T==r&&D==s&&Z==cyer&&(E=C.hglt,b="zcal_mCcrdy"),i==r&&i!=T&&C.hglt&&p==s&&m==cyer&&(b="zcal_sl")}else E=C.dis;d+=l.replace(/#tag#/g,E).replace("#cl#",b?"class="+b:"").replace("#item#",r).replace("#month#",c.getMonth()).replace("#year#",c.getFullYear()),c.setDate(r+1)}d+=e.substring(a+3,e.length)}return d},Element.prototype.positionX=function(e){var t=0,a=this;if("function"==typeof a.getBoundingClientRect)t=a.getBoundingClientRect().left+(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0);else if(a.offsetParent)for(;a.offsetParent;)t+=a.offsetLeft,a=a.offsetParent;else a.x&&(urleft+=a.x);return t},Element.prototype.positionY=function(){var e=0,t=this;if("function"==typeof t.getBoundingClientRect)e=t.getBoundingClientRect().top+(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0);else if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetTop,t=t.offsetParent;else t.y&&(e+=t.y);return e},(extendNativeObject=function(e,t,a){if(e&&t&&a){if(!e.prototype[t])try{return e.prototype[t]=a,!0}catch(e){}return!1}})(String,"trim",function(){var e=this;return e=(e=e.replace(/^\s*(.*)/,"$1")).replace(/(.*?)\s*$/,"$1")}),extendNativeObject(String,"changeNumbertoTime",function(e){var t,a,l=parseInt(this,10);return t="hh:mm a"==e?(a=0==(a=24<l?l-24:l)||1==a?12:parseInt(a/2,10),23<l?" "+ZCALtform[1]:" "+ZCALtform[0]):(a=parseInt(l/2,10),""),(a<10?"0":"")+a+":"+(l%2==1?"30":"00")+t}),extendNativeObject(String,"changeTimetoNumber",function(e){if(this.indexOf(":")<0)return 0;var t=this.split(":");if(t[0]=parseInt(t[0],10),"hh:mm a"==e){var a=t[1].split(" ");a[1]==ZCALtform[1]&&12!=t[0]?t[0]+=12:a[1]==ZCALtform[0]&&12==t[0]&&(t[0]=0),t[1]=a[0]}return t[1]=parseInt(t[1],10),2*t[0]+(30==t[1]?1:0)}),extendNativeObject(String,"parseDate",function(e){function t(e,t){for(var a in t)if(e.toLowerCase().trim()==t[a].toLowerCase())return parseInt(a,10)+1;return!1}if(!e||""==e.trim())return!1;if(this&&""==this.trim())return!1;var a=this.match(/(\d+)|([a-zA-Z]+)/g),l=0,c={},i=e.toLowerCase().match(/([a-z]+)/g);if(3!=i.length||3!=a.length)return!1;for(var l in i)"d"==i[l]||"m"==i[l]?i[l]+=i[l]:"mmm"==i[l]?(a[l]=t(a[l],Date.MONTH_NAMES[1]),i[l]="mm"):"mmmm"==i[l]?(a[l]=t(a[l],Date.MONTH_NAMES[0]),i[l]="mm"):"yy"==i[l]&&(a[l]=70<=a[l]?1900+parseInt(a[l],10):2e3+parseInt(a[l],10),i[l]="yyyy"),c[i[l]]=a[l];return new Date(c.yyyy,c.mm-1,c.dd)}),Date.MONTH_NAMES=new Array(["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),Date.WEEKS_DAYS=new Array(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["S","M","T","W","T","F","S"]),ZCALtform=["am","pm"],extendNativeObject(Date,"getDaysOfMonth",function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()}),extendNativeObject(Date,"getDateBy",function(e){function t(e){return(e<0||9<e?"":"0")+e}if(""!=e.trim()){e+="";var a="",l=0,c="",i="",n=this.getYear()+"",r=this.getMonth()+1,s=this.getDate(),d=this.getDay();n.length<4&&(n=""+(+n+1900));var o={};for(o.YYYY=n,o.YY=n.substring(2,4),o.M=r,o.MM=t(r),o.MMMM=Date.MONTH_NAMES[0][r-1],o.MMM=Date.MONTH_NAMES[1][r-1],o.D=s,o.DD=t(s),o.E=Date.WEEKS_DAYS[1][d],o.EE=Date.WEEKS_DAYS[0][d];l<e.length;){for(c=e.charAt(l),i="";e.charAt(l)==c&&l<e.length;)i+=e.charAt(l++);null!=o[i.toUpperCase()]?a+=o[i.toUpperCase()]:a+=i}return a}}),extendNativeObject(Date,"getTimeBy",function(e){function t(e,t){var a=e+"";for(t=t||2;a.length<t;)a="0"+a;return a}var a=this.getHours(),l=12<a?a-12:0==a?12:a;e=(e=(e=(e=e.replace(/(^|[^\\])HH+/g,"$1"+t(a))).replace(/(^|[^\\])H/g,"$1"+a)).replace(/(^|[^\\])hh+/g,"$1"+t(l))).replace(/(^|[^\\])h/g,"$1"+l);var c=this.getMinutes();e=(e=e.replace(/(^|[^\\])mm+/g,"$1"+t(c))).replace(/(^|[^\\])m/g,"$1"+c);var i=this.getSeconds(),n=a<12?"AM":"PM";e=(e=(e=(e=e.replace(/(^|[^\\])ss+/g,"$1"+t(i))).replace(/(^|[^\\])s/g,"$1"+i)).replace(/(^|[^\\])TT+/g,"$1"+n)).replace(/(^|[^\\])T/g,"$1"+n.charAt(0));var r=n.toLowerCase();e=(e=e.replace(/(^|[^\\])tt+/g,"$1"+r)).replace(/(^|[^\\])t/g,"$1"+r.charAt(0));var s=-this.getTimezoneOffset(),d=s?0<s?"+":"-":"Z",o=(s=Math.abs(s))%60;return d+=t(Math.floor(s/60))+":"+t(o),e=e.replace(/(^|[^\\])K/g,"$1"+d)}),extendNativeObject(Date,"diffTo",function(e,t){return t=t||new Date,"days"==e?parseInt((t.getTime()-this.getTime())/864e5,10):"month"==e?t.getMonth()-this.getMonth()+12*(t.getFullYear()-this.getFullYear()):"year"==e?t.getFullYear()-this.getFullYear():void 0});var ZCALaddListener=document.addEventListener?function(e,t,a,l){"mousewheel"==t&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(t="DOMMouseScroll"),e.addEventListener(t,a,Boolean(l))}:function(e,t,a){e.attachEvent("on"+t,a)},ZCALremoveListener=document.removeEventListener?function(e,t,a,l){"mousewheel"==t&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(t="DOMMouseScroll"),e.removeEventListener(t,a,Boolean(l))}:function(e,t,a){e.removeEventListener("on"+t,a)},ZCALprevDef=function(e){(e=e||event).stopPropagation?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!0,e.returnValue=!1)};ZCALcrtesel=function(e,t,a){if(e.createTextRange){e.focus();var l=e.createTextRange();l.collapse(!0),l.moveStart("character",t),l.moveEnd("character",a-t),l.select()}else e.setSelectionRange?(e.focus(),e.setSelectionRange(t,a)):void 0!==e.selectionStart&&(e.focus(),e.selectionStart=t,e.selectionEnd=a);return t},ZCALselstart=function(e){if(document.selection){var t=document.selection.createRange().duplicate();return t.moveEnd("character",e.value.length),""==t.text?e.value.length:e.value.lastIndexOf(t.text)}return e.selectionStart},ZCALselend=function(e){if(document.selection){var t=document.selection.createRange().duplicate();return t.moveStart("character",-e.value.length),t.text.length}return e.selectionEnd},ZCALchangeMonth=function(e,t){var a=new Date(e.getFullYear(),e.getMonth()+t,1),l=e.getDate(),c=new Date(a.getFullYear(),a.getMonth()+1,0).getDate();return a.setDate(l<=c?l:c),a},zcal.stck=[],zcal.keyCtrl=function(e){var t=zcal.NN6?e.target:e.srcElement;27!=(e.which||e.keyCode)?"INPUT"!=t.tagName&&"TEXTAREA"!=t.tagName&&document.removeEventListener("keydown",zcal.keyCtrl):zcal.preclr(e)},zcal.movView=function(e,t){ZCL_clrStck(t),ZCL_TY=e,ZCL_gridView()},zcal.preclr=function(e){"c"==zmApp.currentApp&&(-1!=zcal.stck.toString().indexOf("zcl_repstat")||-1!=zcal.stck.toString().indexOf("zcl_attStat")?zcalView.constGridView():ZCL_clrStck(),null!=e&&ZCL_stopEvents(e))},ZCL_clrStck1=function(e,t){var a=[];if(-1==zcal.stck.toString().indexOf("newEve")){for(var l=0;l<zcal.stck.length;l++)if(zcal.$(zcal.stck[l])){if(("zcl_qbk"==zcal.stck[l]||zcal.stck[l].match("zcl_lay")&&zcal.stck[l].match("zcl_lay")[0])&&1==t){a.push(zcal.stck[l]);continue}zcal.$(zcal.stck[l]).style.display="none"}t?(zmsDialog.remove(),zcal.stck=a):zcal.stck=new Array,e&&null!=e&&ZCL_stopEvents(e)}},ZCL_EClrStck=function(){zmsuite.isWorkspaceAvailable(zmTab.currentTab)&&zmsuite.closeWorkspace(zmTab.currentTab);for(var e=0;e<zmTab.tabArr.length;e++){var t=!1;-1==zmTab.tabArr[e].appId.indexOf("zcal_eContainer")&&-1==zmTab.tabArr[e].appId.indexOf("zcal_eeContainer")&&(t=!0)}t&&(zcal.EOBJ={}),ZCL_clrStck()},ZCL_clrStck=function(e){for(var t=0;t<zcal.stck.length;t++)ZCL_$(zcal.stck[t])&&(ZCL_$(zcal.stck[t]).style.display="none");zcal.stck=[],zcal.$("zcl_action")&&(zcal.$("zcl_action").getElementsByTagName("b")[0].className="");null!=e&&ZCL_stopEvents(e)},zcal.adStck=function(e){zcal.stck=zcal.stck.concat(e)},zcal.CAStck=function(e){ZCL_clrStck(),zcal.adStck(e)},ZCL_mdownClr=function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(e){if("c"==zmApp.currentApp){var t,a,l,c,i=e.target||e.srcElement;if(t=ZCL_$("zcl_qbk"),a=ZCL_$("zcl_qview"),l=ZCL_$("zcl_smAdd"),c=$(".zcal_cn"),t&&t.contains(i)||a&&a.contains(i)||l&&l.contains(i)||0<c.length)return!1;ZCL_clrStck(),document.removeEventListener("mousedown",ZCL_mdownClr)}});var zcalTemplate=function(){var e={popupCreateEvent:function(e){var t='<div class="SC_PUcen">';return t+='<div><div class="zcl_adev">',t+='<div class="zcl_adevtt"><textarea id="zcl_ppce_tit" placeholder="'+zcal.i18n.popup_eventtitle+'">'+e.sum+"</textarea></div>",t+='<ul class="zcl_frmrw zcl_adetim"><li id="zcl_ce_timdv"><input type="text" readonly="" id="zcl_ce_sd" class="zcl_w137 SC_tiput" value="'+e.sd+'"></li><li id="zcl_ce_stpar"><input type="text" id="zcl_ce_st"  autocomplete="off" class="zcl_w136 SC_tiput" value="'+e.st+'"></li><li class="zcl_tmto">to</li><li id="zcl_ce_edpar"><input type="text" readonly="" id="zcl_ce_ed" class="zcl_w137 SC_tiput" value="'+e.ed+'"></li><li id="zcl_ce_etpar"><input type="text" id="zcl_ce_et"  autocomplete="off" class="zcl_w136 SC_tiput" value="'+e.et+'"></li></ul>',t+='<ul class="zcl_frmrw zcl_adall"><li class="zcl_curpt"><i id="zcl_ce_aday" class="msi-uncheck"></i>'+zcal.i18n.allday+"</li></ul>",t+='<ul class="zcl_frmrw zcl_rem">'+e.reminder+"</ul>",t+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.loc+'</u><input type="text" value="" id="zcl_ce_loc" class="zcl_adelk SC_tiput"></li><li><u>'+zcal.i18n.calendar+'</u><div class="SC_select zcl_adecl"><input rel="'+zcal.cdata.defcal+'" value="'+zcal.cdata.calLst[zcal.cdata.defcal][0]+'" readonly type="text" id="zcl_ce_cal"></div></li></ul>',t+='<textarea id="zcl_ce_desc" class="SC_tiput" placeholder="'+zcal.i18n.description+'">'+e.desc+"</textarea>",t+="</div></div>",t+="</div>"},popupChOwner:function(e){return chStr='<div id="zcl_eowner" style=""><div class="SC_PUcen">',chStr+='<div><ul class="zcl_frmrw zcl_when"><input type="text" class="zcl_crlk SC_tiput" id="zcl_eowner_inp" value="" placeholder="'+zcal.i18n.eownerpopup_email+'"></ul></div>',chStr+="false"!=e?'<ul class="zcl_frmrw zcl_when"><li class="zcl_curpt"><i class="msi-uncheck" id="zcl_inclatt"></i>Include me as attendee</li></ul>':"",chStr+='<div style="padding-right:0"><textarea style="height:44px;" class="zcl_Cedes SC_tiput" id="zcl_eowner_cmt" placeholder="'+zcal.i18n.eownerpopup_msg+'"></textarea></div>',chStr+="</div></div>",chStr},popupCreateCal:function(e){var t='<div class="zcl_addcalcn" style="width: 500px;" id="zcl_ad">';return t+="<ul>",t+='<li class="zcl_CMS"><ul class="zcl_addcal" style="padding-left: 40px;"><li><input type="hidden" id="zcl_calid" value="'+(e.id?e.id:"")+'"/><input type="hidden" id="zcl_calgid" value="'+(e.gId?e.gId:"")+'"><input type="text" class="SC_tiput" placeholder="'+zcal.i18n.calname+'" value="'+(e.name?ZCL_getHTML(e.name):"")+'" id="zcl_calname"></li>',t+='<li><textarea style="" placeholder="'+zcal.i18n.description+'" id="zcl_caldesc" class="SC_tiput">'+(e.desc?e.desc:"")+"</textarea></li>",t+='<li class="zcl_calcol" id="zcl_calcol"><div class="zcl_addcaltx"><b>'+zcal.i18n.calcolor+"</b></div>"+zcal.calColorSel(e.color)+"</li>",t+='<li id="zcl_txtcol"><div class="zcl_addcaltx"><b>'+zcal.i18n.textcolor+'</b><div><u  data-marker ="textColor"><i class="'+(0==e.txtcolor?"msi-option":"msi-unoption")+'"></i><u class="">'+zcal.i18n.white+'</u></u><u data-marker ="textColor"><i class="'+(1==e.txtcolor?"msi-option":"msi-unoption")+'"></i><u class="">'+zcal.i18n.black+"</u></u></div></div></li>",t+='<li><div class="SC_PUbtm"><span rel="enable" onclick="ZCL_addCal(event)">'+zcal.i18n.save+'</span><span  data-val="Cancel" onclick="ZCL_adcClose()">'+zcal.i18n.cancel+"</span></div></li>",t+="</ul>",t+="</div>"},popupCreateSecdown:function(){return'<ul><li class="zcl_CMS"><ul class="zcl_addcal"><li><div class="zcl_addcaltx"><b>Password</b></div><input type="password" class="SC_tiput" value="" id="zcl_pwd"></li><li><div class="zcl_addcaltx"><b>Retype Password</b></div><input type="password" class="SC_tiput" value="" id="zcl_repwd"></li><ul class="tempFormList zmErrClr" id="zcl_pwd_er" style="display:none"><li><i class="msi-fail zmDoubleIcon"></i>Length greater than 8 characters</li><li><i class="msi-fail zmDoubleIcon"></i>Upper case character</li><li><i class="msi-fail zmDoubleIcon"></i>Lower case character</li><li><i class="msi-fail zmDoubleIcon"></i>Numeric character</li><li><i class="msi-fail zmDoubleIcon"></i>Special character ( #, ?, !, @, $, %, ^, &amp;, *, -)</li></ul><ul class="tempFormList zmErrClr" id="zcl_repwd_er" style="display:none"><li><i class="msi-fail zmDoubleIcon"></i>Retype your password</li></ul><ul class="tempFormList zmErrClr" id="zcl_repeqwd_er" style="display:none"><li><i class="msi-fail zmDoubleIcon"></i>Password mismatch</li></ul><div class="zcl_addcaltx" id="zcl_pwdcon"><b>Use 8 characters or more with a mix of upper,lower case letters, number and symbols </b></div><div class="zmInfoBox"><b>Note: </b>The password is not saved and hence the file cannot be recovered if the password is forgotten. Password is case-sensitive.</div></ul></li></ul>'},popupCreateGrpCal:function(e){var t="Edit Group Calendar"==e.title?"edit":"add",a='<div class="zcl_table zcl_H100">';return a+="<ul>",a+='<li class="zcl_CMS">',a+='<div class="zcl_addcalcn" style="width:500px">',a+='<ul class="zcl_addcal" style="padding-left: 40px;">',a+="<li>",a+='<input type="hidden" id="zcl_calid" value="'+(e.id?e.id:"")+'">',a+='<input type="hidden" id="zcl_calgid" value="'+(e.gId?e.gId:"")+'">',a+='<div class="zcl_addcaltx"><span id="zcl_ad_ti_er" style="display:none;" class="zcl_ad_cl_er_ms">'+zcal.i18n.grp_namerr+"</span></div>",a+='<input type="text" class="SC_tiput" placeholder="'+zcal.i18n.grpplaceholder+'" value="'+(e.name?ZCL_getHTML(e.name):"")+'" id="zcl_grpcalname"  onfocusout='+("edit"==t?"ZCL_addGrpCal(event,'"+t+"')":"")+" >",a+="</li>",a+='<li class="zcl_calcol" id="zcl_calcol"><div class="zcl_addcaltx"><b>'+zcal.i18n.calcolor+"</b></div>"+zcal.calColorSel(e.color,t)+"</li>",a+='<li id="zcl_txtcol">',a+='<div class="zcl_addcaltx"><b>'+zcal.i18n.textcolor+'</b><div><u data-marker ="textColor"><i class="'+(0==e.txtcolor?"msi-option":"msi-unoption")+'"></i><u class="">'+zcal.i18n.white+'</u></u><u data-marker ="textColor"><i class="'+(1==e.txtcolor?"msi-option":"msi-unoption")+'"></i><u class="">'+zcal.i18n.black+"</u></u></div></div>",a+="</li>",e.members||(a+="<li>",a+='<div class="zcl_addcaltx"><span id="zcl_ad_att_er" style="display:none;" class="zcl_ad_cl_er_ms">'+zcal.i18n.grp_memerr+"</span></div>",a+='<div class="zcl_ad_gr_m" id="zcl_addGrpdiv"><input type="text" id="zcl_addGrpMem" placeholder="'+zcal.i18n.grpaddplaceholder+'"><ul id="zcl_grpMemlist" style="white-space:normal"></ul></div>',a+="</li>"),a+="<li>",a+='<div class="zcl_addcaltx"><span id="zcl_ad_desc_er" style="display:none;" class="zcl_ad_cl_er_ms">Group Description cannot be more than 200 characters</span></div>',a+='<textarea style="margin-top: 0;" placeholder="'+zcal.i18n.grpdesplaceholder+'" id="zcl_calgrpdesc"  class="SC_tiput">'+(e.desc?e.desc:"")+"</textarea>",a+="</li>","add"==t&&(a+='<li><div class="SC_PUbtm"><span rel="enable" onclick="ZCL_addGrpCal(event,\''+t+"')\">"+zcal.i18n.save+'</span><span  data-val="Cancel" onclick="ZCL_grpClose()">'+zcal.i18n.cancel+"</span></div></li>"),a+="</ul>",a+="</div>",a+="</li>",a+="</ul>",a+="<div>"},popupChatlet:function(e){var t,a=new Date,l=12<(t=0==a.getHours()?12:a.getHours())?"pm":"am",c=(t=12<t?t-12:t)+":"+a.getMinutes()+" "+l,i='<div class="SC_PUcen zmChatlet" style="">';if(i+='<div style="width:400px">',i+='<div class="SC_floatLabel flBox flFLabel zm_title">',i+='<input value="'+ZCL_getHTML(e.SUM)+",Chat&nbsp@"+c+'" id="zcl_chTit" type="text"  maxlength="50">',i+="<label>"+zcal.i18n.title+"</label>",i+="</div>",i+='<div class="addInvList">',e.ATT){for(var n in i+='<div  id="attDiv" class="addInv SC_floatLabel flFLabel clearfix flBox addUsers autoFilldata">',e.ATT.USR)for(var r in e.ATT.USR[n])e.ATT.USR[n][r].ZUID!=zmail.zuid&&(i+='<div id="att" class="SC_cs myInv dFill" data-zid='+e.ATT.USR[n][r].ZUID+' title="'+e.ATT.USR[n][r].AID+'">',i+='<div class="SC_avtr">',i+='<img src="'+e.ATT.USR[n][r].PHOTO+'">',i+="</div>",i+="<span>"+e.ATT.USR[n][r].AID+"</span>",i+='<i class="msi-close closePopup prevB"></i>',i+="</div>");i+='<input id="atInp" type="text" class="zm_sgst"><label>'+zcal.i18n.participants+'</label><i class="msi-plus SC_thm borderPlus " id="attAdd"></i></div>'}else i+='<div id="attDiv" class="addInv SC_floatLabel flFLabel clearfix flBox addUsers autoFilldata edit_parti">',i+='<input  id="atInp" type="text" class="zm_sgst"><label>'+zcal.i18n.participants+"</label></div>";return i+="</div>",i+="</div>",i+="</div>",i+="</div>"},popupSmartAdd:function(){return'<li class="zcl_qttl"></li><li class="zcl_table"><ul><li><input type="text" id="zcl_smaddtxt" class="SC_tiput" placeholder="e.g. Client Breakfast at 10 am"></li><li><b onclick="ZCL_openSAddHelp()"><i class="msi-faq"></i></b></li></ul></li><li style="display:none" id="zcl_saddhelp"><p>To schedule an event for having breakfast with a client at 9 am, simply type "Client Breakfast at 9 am".</p><h1>Date:</h1><span>Team treat on Friday</span><span>Suganthi birthday Aug 15</span><span>Mehna Birthday 8/15</span><h1>Date and Time:</h1><span>Leads meet 07/01/2008 10am-12pm</span><span>Meeting 08/01/2008 11:30 am</span><h1>Multiple Days:</h1><span>Vacation Aug 3 - Aug 15</span><span>Conference in London 8/10 - 8/25</span></li>'},OutlookPopup:function(){var e='<div class="SC_PUcen zcl_ovr" style="max-height: 551px;">';return e+='<ul class="SC_cal_groups">',e+='<li><div id="zcl_olbtn" class="zm_comp"><a title="'+ZCL_replaceComName(zcal.i18n.outlooktitle64)+'" href="'+zcal.OUTLOOK64+'" class="SC_lnk"><span>Download</span><span><i class="msi-download"></i></span></a></div><span>'+ZCL_replaceComName(zcal.i18n.outlooktitle64)+"<s>Beta</s></span><em>("+ZCL_replaceComName(zcal.i18n.outlooksubtitle64)+")</em></li>",e+='<li><div class="zm_comp" id="zcl_olbtn"><a class="SC_lnk" href="'+zcal.OUTLOOK32+'" title="'+ZCL_replaceComName(zcal.i18n.outlooktitle32)+'"><span>Download</span><span><i class="msi-download"></i></span></a></div><span>'+ZCL_replaceComName(zcal.i18n.outlooktitle32)+"<s>Beta</s></span><em>("+ZCL_replaceComName(zcal.i18n.outlooksubtitle32)+")</em></li>",e+="</ul>",e+="<p>"+zcal.i18n.mshelp+"</p>",e+="</div>"},calDetials:function(e,t){var a=ZCL_getHTML(t[0]),l=t[9],c=zcal.cdata.opt.TIM,i='<iframe src="'+location.protocol+"//"+zcal.ZCAL+(""==t[14]||"gcal"==t[14]?"":"/"+t[14])+"/embed/"+l+"?title="+a+"&type=1&l=en&tz="+c.zcalescape()+'&sh=[1,1]&v=0" width="600" height="500" frameborder="0" scroll="auto"></iframe>',n='<div class="conditionDiv">';return n+='<div class="zmL">',n+='<div class="SC_srch shw">',n+='<table class="condition">',n+='<tr><td class="gbld">'+zcal.i18n.calname+"</td></tr>",n+='<tr><td><table><tr><td width="29%"><span>'+a+"</span></td></tr></table></td></tr>",n+="</table>",n+="</div>",n+="</div>",n+='<div class="zmL">',n+='<div class="SC_srch shw">',n+='<table class="condition">',n+='<tr><td class="gbld">'+zcal.i18n.calendarid+"</td></tr>",n+='<tr><td><table><tr><td width="29%"><span>'+l+"</span></td></tr></table></td></tr>",n+="</table>",n+="</div>",n+="</div>",n+='<div class="zmL">',n+='<div class="SC_srch shw">',n+='<table class="condition">',n+='<tr><td class="gbld">'+zcal.i18n.embedurl+"</td></tr>",n+='<tr><td><table><tr><td width="29%"><textarea type="text" class="zcl_Stxt">'+i+'</textarea><span class="zcl_lk" data-marker="embedMore">'+zcal.i18n.moretemplates+"</span></td></tr></table></td></tr>",n+="</table>",n+="</div>",n+="</div>",n+='<div class="zmL">',n+='<h2 class="recom_conditionHeading">'+zcal.i18n.reminder+"</h2>",n+='<ul class="zcl_rem">',n+='<li data-marker="calReminder"></li>',n+="</ul>",n+="</div>",n+='<span class="mLnone" data-marker="markAsBusy"><i class="msi-check"></i><span class="pl5">'+zcal.i18n.markasbusy_cal+"</span></span>",n+='<span class="mLnone" data-marker="dlgInvNtfy"><i class="msi-check"></i><span class="pl5">'+zcal.i18n.dlg_Inv_Notify+"</span></span>",n+="</div>",n+='<div class="SC_PUbtm"><span class="sel" data-marker="detailSave">'+zcal.i18n.save+'</span><span data-val="Cancel">'+zcal.i18n.cancel+"</span></div>"},calShare:function(){var e='<div class="conditionDiv">';return e+='<div data-marker="loadingAnimation"></div>',e+='<div data-marker="publicShare"></div>',e+='<div data-marker="privateAddress"></div>',e+='<div data-marker="indShare"></div>',e+='<div class="zcl_Sshlst" data-marker="sharedList"></div>',e+="</div>",e+='<div class="SC_PUbtm"><span data-val="Cancel">'+zcal.i18n.close+"</span></div>"},calEmbed:function(){var e="";return e+='<div class="SC_set SC_filt_bottom">',e+='<div class="zcl_Semdtmp" data-marker="embedTpl"/>',e+='<div class="conditionDiv">',e+='<table class="zcl_Semdsp"><tr>',e+='<td data-marker="embedTplImg"></td>',e+="<td>",e+='<div data-marker="embedTitleSec"></div>',e+="</td>",e+="<td>",e+='<div data-marker="embedTZSec"></div>',e+="</td>",e+="</tr></table>",e+="</div>",e+='<div class="zmL"><div class="SC_srch shw">',e+='<table class="condition">',e+='<tr><td class="gbld">'+zcal.i18n.embed_instruction+"</td></tr>",e+="<tr><td><table>",e+='<tr><td data-marker="embedCode"></td></tr>',e+="</table></td></tr>",e+="</table>",e+="</div></div>",e+="</div>"},invitationview:function(e){var t="";for(var a in t='<table cellspacing="0px" cellpadding="0px"  width="100%" style="_width:97%;border:1px solid #e7e7e7;display:table;table-layout:fixed">',t+="<tr>",t+='<td colspan="2">',t+='<table cellspacing="0px" cellpadding="0px" width="100%" style="font:normal 11px Verdana,arial,Helvetica,sans-serif;color:#333333;border:1px solid #ffffff;display:table;table-layout:fixed">',t+='<tr bgcolor="#fafafa">',t+="<td>",t+='<table cellspacing="0px" cellpadding="0px" style="font:normal 11px Verdana,arial,Helvetica,sans-serif;color:#333333;float:left">',t+="<tr>",t+='<td background="$IMG_INV$" width="46px" height="52"></td>',t+='<td style="padding-left:10px;color:#000000;height:52px"><a href="mailto:'+zcal.cdata.opt.MID+'">'+zcal.cdata.opt.MID+"</a> <br/><b>Invites you</b></td>",t+="</tr>",t+="</table>",t+="</td>",t+="</tr>",t+="<tr>",t+='<td width="100%">',t+='<table cellspacing="0px" cellpadding="0px" width="100%" style="background-color:#ffffff;padding:1px">',t+="<tr>",t+="<td>",t+='<table cellspacing="0px" cellpadding="5px" width="100%" style="font:normal 11px Verdana,arial,Helvetica,sans-serif;line-height:18px;color:#333333;border-collapse:collapse;word-wrap:break-word;table-layout:fixed">',t+="<tr>",t+='<td width="100px" style="font-weight:bold;border-bottom:1px solid #f4f4f4;vertical-align:top">'+zcal.i18n.title+"</td>",t+='<td style="border-bottom:1px solid #f4f4f4;vertical-align:top">'+ZCL_getHTML(e.title)+"</td>",t+="</tr>",t+="<tr>",t+='<td style="font-weight:bold;border-bottom:1px solid #f4f4f4;vertical-align:top">Date</td>',t+='<td style="border-bottom:1px solid #f4f4f4;vertical-align:top">On '+e.date+"</td>",t+="</tr>",t+="<tr>",t+='<td style="font-weight:bold;border-bottom:1px solid #f4f4f4;vertical-align:top">Attendees</td>',t+='<td style="border-bottom:1px solid #f4f4f4;vertical-align:top"><span style="pointer:cursor;color:#878787;">',e.att)t+='<a href="mailto:'+e.att[a]+'">'+e.att[a]+"</a>,";return t+="</span></td>",t+="</tr>",t+="</table>",t+="</td>",t+="</tr>",t+="</table>",t+="</td>",t+="</tr>",t+="</table>",t+="</td>",t+="</tr>",t+="</table>"}};return e}();zcal.TTT=["12:00 am","12:30 am","1:00 am","1:30 am","2:00 am","2:30 am","3:00 am","3:30 am","4:00 am","4:30 am","5:00 am","5:30 am","6:00 am","6:30 am","7:00 am","7:30 am","8:00 am","8:30 am","9:00 am","9:30 am","10:00 am","10:30 am","11:00 am","11:30 am","12:00 pm","12:30 pm","1:00 pm","1:30 pm","2:00 pm","2:30 pm","3:00 pm","3:30 pm","4:00 pm","4:30 pm","5:00 pm","5:30 pm","6:00 pm","6:30 pm","7:00 pm","7:30 pm","8:00 pm","8:30 pm","9:00 pm","9:30 pm","10:00 pm","10:30 pm","11:00 pm","11:30 pm"],zcal.TT=["12 am","1 am","2 am","3 am","4 am","5 am","6 am","7 am","8 am","9 am","10 am","11 am","12 pm","1 pm","2 pm","3 pm","4 pm","5 pm","6 pm","7 pm","8 pm","9 pm","10 pm","11 pm"];var ZCL_REMSTR=[],ZCL_REM=["300000","600000","900000","1200000","1500000","1800000","2700000","3600000","7200000","14400000","21600000","28800000","43200000","86400000","172800000","259200000","345600000","432000000","518400000","604800000","691200000","777600000","864000000","950400000","1036800000","1123200000","1209600000","1296000000","2592000000","3888000000","5184000000","7776000000"];zcal.OBJTEMP;var ZCL_SERVICE="";zcal.MSPERMINUTE=6e4,zcal.MSPERHOUR=36e5,zcal.TF=["hh:mm a","HH:mm"],zcal.EOBJ={},zcal.EMODE=0,zcal.CAL_IND=0;var ZCL_OLD_COBJ,ZCL_AttachSize,ZCL_AttachCount,ZCL_NTFY_ATT=-1,ZCL_AttachElement=[];zcal.evpageCnt=0,ZCL_hdnFld=function(e,t){return'<input type="hidden" id="'+e+'" value="'+t+'"/>'},ZCL_SetEventHiddenFlds=function(e){var t,a,l,c,i,n,r,s,d=zcal.getCalObj(e.CNAME);return t=e.EUID?e.EUID:"",a=e.EID?e.EID:"",l=e.RIDX?e.RIDX:"",c=e.REPINST?e.REPINST:"",i=e.CNAME?e.CNAME:"",n=e.EPERM?e.EPERM:"",r=e.DPERM?e.DPERM:"",s=e.RTO?e.RTO:"",txt=ZCL_hdnFld("zcl_ce_mode",zcal.EMODE)+ZCL_hdnFld("zcl_eid",a)+ZCL_hdnFld("zcl_rmvatt","")+ZCL_hdnFld("zcl_ekey",t)+ZCL_hdnFld("zcl_ridx",l)+ZCL_hdnFld("zcl_repinst",c)+ZCL_hdnFld("zcl_crel",i)+ZCL_hdnFld("zcl_eperm",n)+ZCL_hdnFld("zcl_dperm",r)+ZCL_hdnFld("zcl_oldCkey",d[9])+ZCL_hdnFld("zcl_rtoval",s)+ZCL_hdnFld("zcl_rmvgatt","")+ZCL_hdnFld("zcl_ce_isrep","false")+ZCL_hdnFld("zcl_skey",e.SKEY?e.SKEY:""),txt},ZCL_SetAplReq=function(e){var t="";return e.APL_REQ&&"1"==e.APL_REQ&&(t+='<ul class="zcl_frmrw">',t+='<div style="display: inline-block;color:red;"><i class="msi-spam" style="color:red"></i> '+zcal.i18n.waitingforapproval+"</div>",t+="</ul>"),t},ZCL_SetEventTtl=function(e,t){var a,l='<ul class="zcl_frmrw">';return 0==t?l+='<li class="zcl_evttvw">'+(a=e.SUM?ZCL_getHTML(e.SUM):"")+"</li>":(a=e.SUM?ZCL_getHTML(e.SUM):"",l+='<li class="zcl_W70pc">',l+='<input type="text" placeholder="'+zcal.i18n.untitledevent+'" class="zcl_crevntt SC_tiput"  autocomplete="off" value="'+a+'" id="zcl_ce_tit">',l+="</li>",l+='<li class="zcl_curpt" onclick="ZCL_ChgChk(this)"><i class="'+(e.CLASS&&1==e.CLASS?"msi-check":"msi-uncheck")+'" id="zcl_ce_pvt"></i>'+zcal.i18n.eprivate+"</li>"),l+="</ul>"},ZCL_SetEventCal=function(e,t){var a="";if(0==t)a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.calendar+"</u><span>"+ZCL_GetCalName(e.CNAME)+"</span></li></ul>";else{var l=zcal.cdata.calLst[e.CNAME]||zcal.cdata.calGLst[e.CNAME]||zcal.cdata.calALst[e.CNAME]||zcal.cdata.calOLst[e.CNAME];a+="<li><u>"+zcal.i18n.calendar+'</u><div class="SC_select" ><input rel="'+e.CNAME+'" value="'+ZCL_getHTML(l[0])+'" id="zcl_ce_cal" type="text" style="width:212px" readonly></div></li>'}return a},ZCL_SetEventSchTime=function(e,t){var a=zcal.timeformat[zcal.cdata.opt.TF],l=!(!e.ADAY||1!=e.ADAY),c=e.SD,i=e.ED,n=l?"8:00 am":e.ST,r=l?"8:30 am":e.ET,s=n.getTimeBy(a),d=r.getTimeBy(a),o=ZCL_splitDateVal(ZCL_putDate(c)),u=ZCL_splitDateVal(ZCL_putDate(i)),p=ZCL_parseTime(s),m=ZCL_parseTime(d);if(ZCL_ESDATE=new Date(o[2],o[1]-1,o[0],p.HH,p.mm,0,0),ZCL_EEDATE=new Date(u[2],u[1]-1,u[0],m.HH,m.mm,0,0),e.rObj=new zcalRepeat,e.rObj.init(ZCL_ESDATE),0==t){var _='<ul class="zcl_frmrw"><li>',z=ZCL_parseDateStr(c),f=ZCL_parseDateStr(i);return _+=z.dateBy("MMM dd, yyyy"),l?_+=c!=i?" - "+f.dateBy("MMM dd, yyyy"):"":(_+=c!=i?", "+s+" - "+f.dateBy("MMM dd, yyyy")+", "+d:", "+s+" - "+d,_+=e.ETZ?'&nbsp;<span class="zcl_greymr">'+e.ETZ+"</span>":""),_+="</li></ul>"}var v=l?'style="display:none"':"",h=e.ETZ?e.ETZ:zcal.cdata.opt.TIM;e.IN_ETZ&&e.IN_ETZ;return _='<ul class="zcl_frmrw zcl_when"><li class="zcl_select" id="zcl_ce_timdv"><input class="zcl_w100 SC_tiput" type="text" value="'+ZCL_putDate(c)+'" id="zcl_ce_sd" readonly /></li>&nbsp;&nbsp;<li class="zcl_select" '+v+' id="zcl_ce_stpar"><input class="zcl_w70 SC_tiput" type="text" autocomplete="off" id="zcl_ce_st" value="'+s+'"/></li><li class="zcl_tmto">'+zcal.i18n.eventto+'</li><li class="zcl_select" id="zcl_ce_edpar"><input class="zcl_w100 SC_tiput" type="text" value="'+ZCL_putDate(i)+'" id="zcl_ce_ed" readonly /></li>&nbsp;&nbsp;<li class="zcl_select" '+v+' id="zcl_ce_etpar"><input class="zcl_w70 SC_tiput" type="text"  autocomplete="off" id="zcl_ce_et" value="'+d+'"/></li><li '+v+'><span class="zcl_lk zcl_cetmz" id="zcl_ce_tza">'+ZCL_getHTML(h)+"</span></li></ul>"},ZCL_SetAllDayRepeatSec=function(e){var t="";e.REP&&(e.rObj.update(e.REP),t=e.rObj.getStr());var a='<ul class="zcl_frmrw"><li class="zcl_curpt"><i class="'+(e.ADAY&&1==e.ADAY?"msi-check":"msi-uncheck")+'" id="zcl_ce_aday"></i>'+zcal.i18n.allday+"</li>";return a+=e.RBRK&&1==e.RBRK?"":'<li id="zcl_rep" class="zcl_curpt" onclick="ZCL_chgeRepOpt(this, event)"><i class="'+(e.REP?"msi-check":"msi-uncheck")+'"></i>'+zcal.i18n.repeat+(""!=t?'<span class="zcl_lk" id="zcl_rep_span" onclick="ZCL_chgeRepOpt(this, event)">'+t+"</span>":"")+"</li>",a+="</ul>"},ZCL_SetEventLoc=function(e,t){var a="",l=e.LOC?ZCL_getHTML(e.LOC):"";return 0==t?""!=l&&(a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.loc+"</u><span>"+l+"</span></li></ul>"):a+="<li><u>"+zcal.i18n.loc+'</u><input type="text" class="zcl_crlk SC_tiput" autocomplete="off" id="zcl_ce_loc" value="'+l+'"></li>',a},ZCL_SetEventColor=function(e,t){var a="";return 0==t?-1<e.EC&&(a+='<ul class="zcl_frmrw"><li><u class="zcl_frmtt">'+zcal.i18n.eventcolor+"</u>",a+='<ul class="zcl_cecolr"><li style="background-color:'+zcal.eventcolor[e.EC]+'"></li></ul>',a+="</li></ul>"):a+='<ul class="zcl_frmrw">'+ZCL_EventColorSel(e)+"</ul>",a},ZCL_EventColorSel=function(e){for(var t='<li class="zcl_frmtt">'+zcal.i18n.eventcolor+'</li><li><ul class="zcl_cecolr" id=zcl_ce_color rel="'+(e.EC?e.EC:-1)+'">',a=0;a<zcal.eventcolor.length;a++){var l=e.EC==a?'class="zcl_sl"':"";t+='<li id="zcl_ecolor'+a+'" rel='+a+' onclick="ZCL_EventColor(this)" style="background-color:'+zcal.eventcolor[a]+'" '+l+'><i class="msi-tick"></i></li>'}return t+="</ul></li>"},ZCL_EventColor=function(e){for(var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=t.find("#zcl_ce_color")[0].getElementsByTagName("li"),l=0;l<a.length;l++){var c=a[l];e.id!="zcl_ecolor"+l&&(c.className="")}""==e.className?(e.className="zcl_sl",t.find("#zcl_ce_color")[0].setAttribute("rel",e.getAttribute("rel"))):(e.className="",t.find("#zcl_ce_color")[0].setAttribute("rel","-1"))},ZCL_SetEventAlrm=function(e,t){var a=zcal.getCalObj(e.CNAME),l="";if(0==t||1==t&&""!=a[14]){if(e.REMTY&&1==e.REMTY)l+=ZCL_putAlarmForView(e.ALARM);else if(e.REMTY&&2==e.REMTY)l+=ZCL_putCalAlarmForView(a[6]);else if(""!=a[14]){var c=ZCL_putCalAlarmForView(a[6]);l+=""!=c?c:""}return 0==zcal.CALMODE&&0==t&&1==e.EPERM&&(l+=""==a[14]&&2!=a[5]?"<div "+(""!=l?'style="padding-top:5px"':"")+'><a id="zcl_setrem" class="SC_lnk">'+zcal.i18n.setreminder+"</a></div>":""),""!=l?'<ul class="zcl_frmrw zcl_rem"><li id="zcl_ce_rem"><u>'+zcal.i18n.reminder+"</u>"+l+"</li></ul>":""}return 1==e.REMTY&&e.ALARM?l+=ZCL_putAlarm(e.ALARM):2==e.REMTY?l+=ZCL_putCalAlarm(a[6]):l+=ZCL_RemAddLnk(),'<ul class="zcl_frmrw zcl_rem"><li id="zcl_ce_rem">'+l+"</li></ul>"},ZCL_getGrpInvPolicy=function(e,s,d){if("group"===e[14]){var o=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],u=zcal[o]?zcal[o].EMODE:zcal.EMODE;ZCL_uXHR("/cal/grpDtl.do?mode=grp-inv-policy&comid="+e[9],function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=ZCL_Evl(1,e.responseText),l=a.invPolicy,c=t.find("#zcl_evhelp")[0],i=document.createElement("span");i.style="white-space:normal",1==l?(i.innerHTML="0"==zcal.sendInv?zcal.i18n.orgPolicyNoAttNote:zcal.i18n.nonGrpMem,t.find("#zcl_gatt_add")[0]&&t.find("#zcl_gatt_add")[0].remove()):2==l&&(i.innerHTML="0"==zcal.sendInv?zcal.i18n.orgPolicyNoAttNote:zcal.i18n.NonOrgMemCal,t.find("#zcl_iatt_lst")[0]&&!t.find("#zcl_iatt_lst")[0].querySelector("#zcl_gatt_add")&&t.find("#zcl_iatt_lst")[0].appendChild($('<i class="msi-addgroup" id="zcl_gatt_add"></i>')[0])),""!=i.innerHTML&&(c.childNodes[1].remove(),c.append(i));var n=t.find("#zcl_ce_attdv")[0].childNodes[0].childNodes[2].querySelector("ul");if("grpmorechge"==d||"grpchge"==d&&zcal.EOBJ[o]&&s!=zcal.EOBJ[o].CNAME||1==u&&zcal.EOBJ[o]&&!zcal.EOBJ[o].EID&&s!=zcal.EOBJ[o].CNAME){n.querySelector("li[rel=invi_grp]")&&n.querySelector("li[rel=invi_grp]").remove();var r=$('<li rel="invi_grp"><span class="zcl_curpt"><i class="'+(a.invite_allmembers?"msi-check":"msi-uncheck")+'" id="invi_all"></i>Invite all group members</span></li>');n.insertBefore(r[0],n.childNodes[0]),t.find("#invi_all").parent().off("click").on("click",function(){ZCL_ChgChk(this)})}else n.querySelector("li[rel=invi_grp]")&&n.querySelector("li[rel=invi_grp]").remove()})}},ZCL_setGrpCalAlarm=function(e,t,a){var l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c=zcal[a.EID]?zcal[a.EID].EMODE:zcal.EMODE,i="";if(0==c||1==c&&""!=e[14]){if(a.REMTY&&1==a.REMTY)i+=ZCL_putAlarmForView(a.ALARM);else if(a.REMTY&&2==a.REMTY)i+=ZCL_putCalAlarmForView(e[6]);else if(""!=e[14]){var n=ZCL_putCalAlarmForView(e[6]);i+=""!=n?n:""}0==zcal.CALMODE&&0==zcal.EMODE&&1==a.EPERM&&(i+=""==e[14]&&2!=e[5]?"<div "+(""!=i?'style="padding-top:5px"':"")+'><a id="cc" class="SC_lnk">'+zcal.i18n.setreminder+"</a></div>":"")}else 1==a.REMTY&&a.ALARM?i+=ZCL_putAlarm(a.ALARM):2==a.REMTY?i+=ZCL_putCalAlarm(e[6]):i+=ZCL_RemAddLnk();if(!t)return i;var r=l.find("#zcl_ce_rem")[0]?l.find("#zcl_ce_rem"):$("#zcl_ce_rem"),s=l.find("#zcl_ce_ele")[0]?l.find("#zcl_ce_ele"):$("#zcl_ce_ele");if(""==i)r[0]&&r[0].parentNode.parentNode.removeChild(r[0].parentNode);else if(r[0])r[0].innerHTML=i;else{var d=document.createElement("div");d.className="zcl_frm",d.innerHTML='<ul class="zcl_frmrw zcl_rem"><li id="zcl_ce_rem"><u>'+zcal.i18n.reminder+'</u><div class="zcl_frmaln" id="zcl_ce_rem">'+i+"</div></div>",s[0].insertBefore(d,s[0].childNodes[6])}},ZCL_SetEventAttach=function(e,t,a){var l=zcal.getCalObj(t.CNAME);ZCL_AttachCount=ZCL_AttachSize=0;var c='<ul class="zcl_frmrw zcl_rem" style="display:'+(""==l[14]||"gcal"!=l[14]?"":"none")+'"><li id="zcl_ce_attach"><div class="'+(0==a?"zmPAtt":"zmCAt")+'">';if(t.HAS_ATTACH&&t.ATTACH)for(var i=0;i<t.ATTACH.length;i++)c+=ZCL_Getattachhtml(t,t.ATTACH[i],e);return c+="</div>",0!=a&&0==e&&(c+='<input type="file" style="display:none" multiple id="AttachInput" onchange="ZCL_addAttach(event)"><ul id="zcl_addAttach"><li><span onclick=zcal.$("AttachInput").click()><i class="msi-add"></i>'+zcal.i18n.addattachment+"</span></li></ul>"),c+="</li></ul>"},ZCL_addAttach=function(e){for(var t=e.path?e.path[0].files:e.target.files,a=0;a<t.length;a++){var l,c=new FormData,i=(l=t[a].name).lastIndexOf("."),n="";0<i&&(n=l.substr(i+1,l.length)),n.match(/\b(ade|adp|bat|chm|cmd|com|cpl|exe|hta|ins|isp|jar|jse|lib|lnk|mde|msc|msp|mst|pif|scr|sct|shb|sys|vb|vbe|vbs|vxd|wsc|wsf|wsh)\b/gi)?zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.attachpolicy,[l])):(c.append("zcl_attachFile",t[a]),fileSize=t[a].size,ZCL_AttachSize+=t[a].size,ZCL_AttachCount++,ZCL_SendFiletoProcess(c,l,fileSize))}ZCL_$("AttachInput").value=""},ZCL_SendFiletoProcess=function(e,t,a){var l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(ZCL_AttachSize<=10485760){var c="loadfile"+ZCL_AttachCount,i=ZCL_Getattachhtml("",{name:t,size:a,id:c},0);l.find("#zcl_ce_attach")[0].childNodes[0].appendChild(i);var n=ZCL_getCookie("aprmjrnpkcrkks");e.append("mstpcrdhkur",n);var r=new XMLHttpRequest;r.upload.addEventListener("progress",function(e){l.find("#"+c)[0]&&(l.find("#"+c)[0].querySelector("div[id=progressbar]").style.width=e.loaded/e.total*100+"%")},!1),r.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=this.responseText?JSON.parse(this.responseText):"";if(e&&"success"==e.status){if(l.find("#"+c)[0]){var t=l.find("#"+c)[0].querySelector("div[id=progressbar]").parentNode;t&&t.parentNode.removeChild(t),l.find("#"+c)[0].querySelector("div[id=attachMenu]").style.display="",l.find("#"+c)[0].querySelector("div[id=attachSize]").style.display="",l.find("#"+c)[0].setAttribute("rel",e.fileId),l.find("#"+c)[0].setAttribute("size",e.size),l.find("#"+c)[0].setAttribute("type",e.contentType),l.find("#"+c)[0].setAttribute("akey",e.attachKey),l.find("#"+c)[0].setAttribute("name",ZCL_encodeHTML(e.fileName)),l.find("#"+c)[0].setAttribute("preview",e.preview),l.find("#"+c)[0].id="fileAttachment"}}else l.find("#"+c)[0]&&(l.find("#"+c)[0].parentNode.removeChild(l.find("#"+c)),ZCL_AttachSize-=a,ZCL_AttachCount--,zmUtil.succErrMsg("e",zcal.i18n.uploaderror))}else 400!=this.status&&500!=this.status||l.find("#"+c)[0]&&(l.find("#"+c)[0].parentNode.removeChild(l.find("#"+c)[0]),zmUtil.succErrMsg("e",zcal.i18n.uploaderror))},r.open("POST",zcal_zmcontext+"/cal/addAttachment.do",!0),r.send(e)}else zmUtil.succErrMsg("e",zcal.i18n.maxlimit),ZCL_AttachSize-=a,ZCL_AttachCount--},ZCL_PreviwAttach=function(e){var t=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],a=zcal[t]?zcal[t].EMODE:zcal.EMODE;ZCL_AttachElement=[];var l,c=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el[0].querySelectorAll("[id=fileAttachment]");window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));for(var i=0;i<c.length;i++){var n={fn:c[i].getAttribute("name"),ft:c[i].getAttribute("type").match(/(image\/)/)?101:103,src:"true"==c[i].getAttribute("preview")?zcal_zmcontext+"/cal/attachment/preview/"+c[i].getAttribute("akey")+"?frameorigin="+window.location.origin:"",fileId:c[i].getAttribute("rel"),akey:c[i].getAttribute("akey")};ZCL_AttachElement.push(n)}l=e.className&&"zmImg"==e.className?e.parentNode.parentNode.parentNode:0==a?e.parentNode.parentNode.parentNode.parentNode.parentNode:e.parentNode.parentNode.parentNode.parentNode;var r=ZCL_getCurelIndex(l.getAttribute("rel"),1);if("true"==l.getAttribute("preview"))if(0<=r){var s={startIndex:r,attObjList:ZCL_AttachElement,hideAllOptions:!0,ignoreThumb:!0};s.addIcons={download:{class:"msi-download",title:zmText.get("attachmentUtility").prevMenu.downLoad,events:[{name:"click",listener:function(e,t){var a=zcal_zmcontext+"/cal/attachment/download/"+t.akey;window.open(a)}}]}},zmUtil.initAttSlideShow(s)}else zmUtil.succErrMsg("e",zcal.i18n.uploadprogress)},ZCL_GetFileSize=function(e){var t="";-1!=navigator.appVersion.indexOf("Win")&&(t="Windows"),-1!=navigator.appVersion.indexOf("Mac")&&(t="MacOS"),-1!=navigator.appVersion.indexOf("X11")&&(t="UNIX"),-1!=navigator.appVersion.indexOf("Linux")&&(t="Linux");var a="MacOS"==t?parseInt(1e3):parseInt(1024);if(0<e)var l=parseInt(Math.floor(Math.log(e)/Math.log(a))),c=(e/Math.pow(a,l)).toFixed(1)+" "+["Bytes","KB","MB","GB","TB"][l];return c},ZCL_rmvAttach=function(e){var t=e.parentNode.parentNode.parentNode.parentNode;ZCL_AttachSize-=t.getAttribute("size"),t.parentNode.removeChild(t),ZCL_AttachCount--},ZCL_Getattachhtml=function(e,t,a){var l,c=e&&e.EID?-1!=e.EID.indexOf("_")?e.EID.split("_")[0]:e.EID:4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],i=zcal[c]?zcal[c].EMODE:zcal.EMODE,n="";if(0!=a)return n="<p>"+ZCL_getHTML(t.name)+"</p>";var r=zmUtil.fileTyp(t.name)[1];r+=" zm-attIcn";var s=ZCL_getHTML(t.name);return t.fileId?(ZCL_AttachSize+=parseInt(t.size),ZCL_AttachCount++,n+='<div class="'+(0==i?"zmL zmAch":"zmL SC_Pbar")+'" id="fileAttachment" data="'+t.attachId+'" rel='+t.fileId+' size="'+t.size+'" type="'+t.contentType+'" akey="'+t.attachKey+'" name="'+s+'" preview="'+t.preview+'">'):((l=document.createElement("DIV")).className=0==i?"zmL zmAch":"zmL SC_Pbar",l.id=t.id),n+='<div class="zmLst">',n+='<div class="zmDtl">',n+='<div class="zmImg" onclick="ZCL_PreviwAttach(this)">',n+='<i class="'+(""!=r?r:"msi-attothers")+'"></i>',n+="</div>",n+='<div class="zmFrm">',n+='<span title="'+s+'" data-msg="view">'+s+"</span>",n+="</div>",n+='<div class="zmSub" id="attachMenu" style="display:'+(t.fileId?"":"none")+'">',0==i?(n+="<font>",n+='<i class="msi-download" title="'+zcal.i18n.download+'" onclick="ZCL_getDownloadLink(this)" data-msg="download"></i>',n+="</font>",t.preview&&(n+="<font>",n+='<i class="msi-zoomin" title="'+zcal.i18n.view+'" onclick="ZCL_PreviwAttach(this)" data-msg="view"></i>',n+="</font>")):(n+='<span  onclick="ZCL_PreviwAttach(this)">'+zcal.i18n.preview+"</span>",n+='<span  onclick="ZCL_getDownloadLink(this)">'+zcal.i18n.download+"</span>"),n+="</div>",n+='<div class="zmSze" id="attachSize" style="display:'+(t.fileId?"":"none")+'">',n+='<span class="sum">'+ZCL_GetFileSize(t.size)+"</span>",n+="</div>",0!=i&&(n+='<div class="SC_icn">',n+='<i class="msi-close" onclick="ZCL_rmvAttach(this)"></i>',n+="</div>",t.fileId||(n+='<div class="zm_lbl zmProgBar">',n+='<div id="progressbar">',n+="</div>",n+="</div>")),n+="</div>",n+="</div>",t.fileId&&(n+="</div>"),t.fileId?n:(l.innerHTML=n,l)},ZCL_getCurelIndex=function(e,t){for(var a=0;a<ZCL_AttachElement.length;a++){if(!e)return-1;if(ZCL_AttachElement[a].fileId==e){if(0!=t)return a;ZCL_AttachElement.splice(a,1);break}}},ZCL_getFileAttach=function(e){var t="",a=[],l=$("#zcl_ce_cal")[0].getAttribute("rel"),c=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,i=zcal.getCalObj(l);if((""==i[14]||"gcal"!=i[14])&&c.find("#fileAttachment")[0]){a=c[0].querySelectorAll("[id=fileAttachment]");if("get"==e)for(var n=0;n<a.length;n++)a[n].getAttribute("data")||(t+=""==t?a[n].getAttribute("rel"):","+a[n].getAttribute("rel"));ZCL_AttachSize=ZCL_AttachCount=0}return"get"==e?t:0<a.length},ZCL_getFileRemoved=function(e){var t="";if(zcal.EOBJ[e].ATTACH){for(var a=[],l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el[0].querySelectorAll("[id=fileAttachment]"),c=0;c<l.length;c++)l[c].getAttribute("data")&&a.push(l[c].getAttribute("rel"));for(c=0;c<zcal.EOBJ[e].ATTACH.length;c++)t+=a.indexOf(zcal.EOBJ[e].ATTACH[c].fileId)<0?""==t?zcal.EOBJ[e].ATTACH[c].attachId:","+zcal.EOBJ[e].ATTACH[c].attachId:""}return t},ZCL_getDownloadLink=function(e){var t,a=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],l=zcal[a]?zcal[a].EMODE:zcal.EMODE,c=(t=e.className&&"zmImg"==e.className?e.parentNode.parentNode.parentNode:0==l?e.parentNode.parentNode.parentNode.parentNode.parentNode:e.parentNode.parentNode.parentNode.parentNode).getAttribute("akey");t.getAttribute("name");if(!(!zmAdHocSettings||!zmAdHocSettings.getSecuredownload||"1"!==zmAdHocSettings.getSecuredownload()))ZCL_secureDow("attach",c);else{var i=zcal_zmcontext+"/cal/attachment/download/"+c;window.open(i)}},ZCL_attch_pwdDow=function(e){var t=$("#zcl_pwd")[0].value,a=$("#zcl_repwd")[0].value;""==t&&""==a?($("#zcl_pwd_er")[0].style.display="",$("#zcl_repwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none"):t==a?($("#zcl_repeqwd_er")[0].style.display="none",$("#zcl_repwd")[0].className="SC_tiput",ZCL_EClrStck(),ZCL_formSubmit({password:t,resformat:"zip",mode:"pwdattach"},"/cal/attachment/pwdDownload/"+e,"GET"),zmsDialog.remove()):($("#zcl_repeqwd_er")[0].style.display="",$("#zcl_repwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none")},ZCL_SetEventLnk=function(e,t){var a="",l=e.URL?ZCL_getHTML(e.URL):"";return 0==t?""!=l&&(a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.link+'</u><span class="zcl_lk" id="zcl_ve_lnk">'+l+"</span></li></ul>"):a+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+zcal.i18n.link+'</u><input type="text" class="zcl_crlk SC_tiput" id="zcl_ce_lnk" value="'+l+'"></li></ul>',a},ZCL_SetEventMlink=function(e){var t="",a=e.MLINK?e.MLINK:"";return t+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.met_scheduled+'</u><span style="word-wrap:break-word"  id="zcl_m_lnk"><a class="zcl_lk" href="'+a+'" target="_blank">'+(-1!=a.indexOf("start")?zcal.i18n.met_start:zcal.i18n.met_join)+"</a></span></li></ul>"},ZCL_SetEventDesc=function(e,t){var a="",l=e.DESC?e.DESC:"";return a+=0==t?'<ul class="zcl_frmrw"><li><u>'+zcal.i18n.description+'</u><div class="zcl_vwdes" id="zcl_cedesc" style="max-width: 400px;"></div></li></ul>':'<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+zcal.i18n.description+'</u><textarea style="height:44px;" class="zcl_Cedes SC_tiput" id="zcl_ce_desc">'+l+"</textarea></li></ul>"},ZCL_dispDesc=function(e){e.className="zcl_curpt zcl_hide",zcal.$("zcl_ce_desc").parentNode.className=""},ZCL_SetAlrm=function(e){var t="";if(1==zcal.EOBJ[e].REMTY&&zcal.EOBJ[e].ALARM)t+=ZCL_putAlarm(zcal.EOBJ[e].ALARM);else if(2==zcal.EOBJ[e].REMTY){var a=zcal.getCalObj(zcal.EOBJ[e].CNAME);t+=ZCL_putCalAlarm(a[6])}else t+=ZCL_putAlarm([{ACTYPE:"0",REMTYPE:"0",REMTIME:"300000"}]);ZCL_$("zcl_ce_rem").innerHTML=t,ZCL_$("zcl_ce_rem")&&$("#zcl_ce_rem .msi-close").off("click").on("click",function(){var e=this.parentNode.parentNode.parentNode;e.removeChild(this.parentNode.parentNode),e.querySelector("#zcl_addrem")||ZCL_AppendRemAddLnk(e)});var l=zmsuite.getCenter()[1].getNodes()[0],c=l.headerArr.text,i={id:"zcalPrevHeader",rIcons:[{groupId:"Save",actionArr:[{iconClass:"msi-save",tooltip:zcal.i18n.save,data:{action:"setEventAlarm"}}]},{groupId:"Delete",actionArr:[{iconClass:"msi-trash",data:{action:"eventDelete"},tooltip:"eventDelete"}]},{groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.save,data:{action:"eventClose"}}]}]};l.push(i),i.text=c,l.render()},ZCL_SetEventAttStsUpd=function(e){var t="";if(!e.ISEXP&&e.USTAT){var a=e.ATTEMAIL,l=e.USTAT,c="";e.UCMNT&&(c=e.UCMNT,0),t+='<ul class="zcl_frmrw zcl_vwsts"><li><u>'+ZCL_UStatusText(l,a)+"</u>"+ZCL_hdnFld("zcl_skey",e.SKEY),t+='<ul class="zcl_qvsup" id="zcl_ce_asts">'+ZCL_AttStsDv(l)+"</ul>",t+='<textarea style="height: 30px;" class="SC_tiput" id="zcl_cu_cmt" placeholder="Comments">'+c+"</textarea>",t+='<div class="SC_PUbtm"><span onclick="ZCL_sndStat()">'+zcal.i18n.update+"</span></div>",t+="</li></ul>"}return t},ZCL_SetEventAss=function(e,t){for(var a="",l=e.RTO,c=ZCL_getOthSrv(),i=c[0].split(","),n=c[1].split(","),r="",s=0;s<i.length;s++){var d=i[s].split(":")[0],o=i[s].split(":")[1];if(0==t){var u=-1!=e.EID.indexOf("_")?e.EID.split("_")[0]:e.EID;if(1==l[n[s]]){if("met"==d)continue;r+="<li onmousedown=\"ZCL_callService('e"+d+"','"+u+'\', event)"><i class="msi-'+o+'" rel="'+(p=ZCL_replaceComName(zcal.i18n["vass_"+d]))+'"></i></li>'}}else{var p="tsk"==d||"nts"==d?ZCL_replaceComName(zcal.i18n["eass_"+d]):zcal.i18n["eass_"+d];r+="mil"!=d?'<li onclick="ZCL_ChgChk(this)"><i id="zcl_ce_'+d+'" class="'+(1==l[n[s]]?"msi-check":"msi-uncheck")+'"></i><i class="msi-'+o+'" rel="'+p+'"></i></li>':'<input type="hidden" id="zcl_ce_'+d+'" value="'+l[n[s]]+'"/>'}}return a+=""!=r?"<li><u>"+zcal.i18n.associate+(1==t?'<span class="zcl_ce_hlp"><i id="zcl_help" class="msi-faq"><a href="'+(-1!=zcal.ZCAL.indexOf(".stage.skydesk.jp")?"https://www.stage.skydesk.jp/apps/calendar/help/associate-events-with-skydesk-apps.html":"https://www.zoho.com/calendar/help/associate-events-with-zoho-apps.html")+'" ></a></i></span>':"")+"</u><ul>"+r+"</ul></li>":""},ZCL_SetEventAtt=function(e,t){var a="";if(1==t&&(e.EID&&e.ATT||"0"!=zcal.sendInv)||0==t&&e.ATT)a+=ZCL_SetIndAttLst("all",e,t);else if("0"==zcal.sendInv||"1"==zcal.sendInv){a+='<div class="section-content startup" style=""><span id="zcl_evhelp" class="startup help" style="margin: 20px 41px;width: auto"><em><img src="//img.zohostatic.com/zmail/zm/103.1/images/settings/lightbulb-info.png" class="info-message"></em><span style="white-space: normal;">'+("0"==zcal.sendInv?zcal.i18n.orgPolicyNoAttNote:zcal.i18n.orgPolicyOrgAttNote)+"</span></span></div>"}return a},ZCL_attStsLnk=function(e,t){return t==e?'<li class="zcl_sl">'+zcal.i18n[e]+"</li>":"<li onclick=\"ZCL_swtchAtt('"+e+"', this)\">"+zcal.i18n[e]+"</li>"},ZCL_swtchAtt=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];t.find("#zcl_ce_aslst")[0].innerHTML=ZCL_attStsLnk("all",e)+ZCL_attStsLnk("yes",e)+ZCL_attStsLnk("no",e)+ZCL_attStsLnk("maybe",e)+ZCL_attStsLnk("pending",e),t.find("#zcl_ce_attlst")[0].innerHTML=ZCL_ListAtt(e,zcal.EOBJ[a]);var l=t.find("#zcl_ce").find("[data-marker=groupAtt]");0<l.length&&(l.removeAttr("data-marker"),l.off("click").on("click",function(){var e=$(this),t=e.data("gid"),a=e.data("sts");ZCL_listGroupUserAtt(t,a)}))},ZCL_SetSvCnlBtn=function(){return'<ul class="zcl_frmrw"><li><div class="SC_PUbtm"><span id="zcl_svspan" rel="enable" onclick="ZCL_svEve()">'+zcal.i18n.save+'</span><span data-val="Cancel" onclick="ZCL_eClose()">'+zcal.i18n.cancel+'</span></div></li><li><span rel="save_loadband"><em class="zmSpinLoader" style="display: none;"></em></span></li></ul>'},ZCL_setPaseve=function(e){var t="";return ZCL_isPasteve(ZCL_putDate(e.ED),"0000"==e.ET?"12:00 am":e.ET)&&(t+='<div id="zcl_pasband" style="padding: 5px;margin: 0 20px 20px;background-color: #f3f2f2;">'+zcal.i18n.pastevemsg+'<span class="zcl_lk" id="zcl_pshelp" style="margin-left: 5px;">Help</span></div>'),t},ZCL_ConstEventPage=function(e,t){var a,l,c=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,i=e?zcal.EOBJ[e]:zcal.EOBJ,n=e&&"ev"==t?zcal[e].EMODE:zcal.EMODE,r=i.CNAME,s="",d="";if("crm"==(a=zcal.getCalObj(r))[14]||"recruit"==a[14]&&-1!=zcal.cdata.calOUids.indexOf("zohoRecruit4_"))crmCalId=r,zcalCRM.showCRMForm(i,n);else if("ztask"==a[14])zcalTask.showTaskForm(i,n);else{if(s+='<div class="zcl zcl_CMS zcl_H100" id="zcl_ce">',1==n&&""==i.SUM&&(s+=ZCL_setPaseve(i)),s+=ZCL_SetEventHiddenFlds(i),s+='<div class="zcl_table zcl_H100">',l=ZCL_SetEventAtt(i,n),d=""==a[14]&&zcal.cdata.calOLst&&!zcal.cdata.calOLst[r]?ZCL_SetEventAss(i,n):"",0==n)s+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li><ul class="zcl_vwev"><li>'+ZCL_SetAplReq(i,n)+ZCL_SetEventTtl(i,n)+ZCL_SetEventSchTime(i,n)+ZCL_SetEventAlrm(i,n)+ZCL_SetEventAttach(0,i,n)+(""!=a[14]?"":ZCL_SetEventColor(i,n))+ZCL_SetEventLoc(i,n)+ZCL_SetEventCal(i,n)+ZCL_SetEventLnk(i,n)+ZCL_SetEventDesc(i,n)+(i.MLINK?ZCL_SetEventMlink(i):"")+'</li></ul></li></ul></li><li class="zcl_Cer zcl_vwCer" id="zcl_ce_ext">'+ZCL_SetMetaInfo(l,i)+ZCL_SetEventAttStsUpd(i)+(""!=d?'<ul class="zcl_frmrw" id="zcl_ce_ass">'+d+"</ul>":"")+l+"</li></ul>";else if(s+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li>'+ZCL_SetAplReq(i,n)+ZCL_SetEventTtl(i,n)+ZCL_SetEventSchTime(i,n)+ZCL_SetAllDayRepeatSec(i)+"</li><li>"+ZCL_SetEventAlrm(i,n)+ZCL_SetEventAttach(0,i,n)+(""!=a[14]?"":ZCL_SetEventColor(i,n))+'<ul class="zcl_frmrw" id="zcl_ce_loccal">'+ZCL_SetEventLoc(i,n)+ZCL_SetEventCal(i,n)+"</ul>"+ZCL_SetEventLnk(i,n)+ZCL_SetEventDesc(i,n)+ZCL_SetSvCnlBtn()+'</li></ul></li><li class="zcl_Cer" id="zcl_ce_ext">',i.EID&&(s+=ZCL_SetMetaInfo(l,i),s+=ZCL_SetEventAttStsUpd(i)),s+=(""!=d?'<ul class="zcl_frmrw" id="zcl_ce_ass">'+d+"</ul>":"")+l+"</li></ul>","group"==a[14])ZCL_getGrpInvPolicy(a,r,"c"==t?"grpmorechge":"");s+="</div></div>",ZCL_setEventWorkSpace(s,i,n,""),zcal.bindCreateEventAction()}1==n&&null!=c.find("#zcl_ce_cal")[0]&&(zcal.CAL_IND=c.find("#zcl_ce_cal")[0].selectedIndex,ZCL_OLD_COBJ=zcal.getCalObj(i.CNAME))},ZCL_openTZPopup=function(e,t){var a,l,c=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_ce_tza");ZCL_$("zcl_tz_pp")||$("body").append("<div id='zcl_tz_pp' class='zcl_ovr'/>"),(a=$("#zcl_tz_pp")).html('<div>            <div data-marker="loadingAnimation"></div>            <div class="SC_select" id="zcl_tzlst"><input type="text" readonly  value="'+ZCL_getHTML(e)+'" class="SC_tiput zcl_nrbr" rel="'+ZCL_getHTML(t)+'" /></div>           </div>'),l=a.find("[data-marker=loadingAnimation]").removeAttr("data-marker");var i={title:zcal.i18n.event_timezone,mask:!0,drag:!1,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",closeaction:function(){zmsDialog.remove(),$("#zcl_tz_pp").remove()},buttons:[{txt:zcal.i18n.done,callback:function(){var e=$("#zcl_tz_pp").find("input");if(e.length){var t=e[0].getAttribute("rel");t!=c.html()&&ZCL_setEvenTimezone(t)}zmsDialog.remove(!0),$("#zcl_tz_pp").remove()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){zmsDialog.remove(!0),$("#zcl_tz_pp").remove()}}]};zmsDialog.create("zcl_tz_pp",i),0<zcal.timezones.length?ZCL_showTimezoneSelection():(l.show(),ZCL_getTZ({mode:"event",callback:function(){l.hide(),ZCL_showTimezoneSelection()}}))},ZCL_showTimezoneSelection=function(){$("#zcl_tz_pp").find("#zcl_tzlst").on("click",function(){var e=zcal.timezones,t=[];for(var a in e)for(var l in e[a]){var c={};c.id=l,c.name=e[a][l]+" ("+l+")",c.display_text=e[a][l]+" ("+l+")",t.push(c)}var i,n={},r=$(this);n.parentDOM=r.parent(),n.displayAs="dropdown",n.parWidth=!0,n.onSelect=function(e,t){setGroupValueTZ(r,e,t),i.hide()},n.dataCallback=function(){return t},(i=zmUtil.createFLComp("generic",n)).show()})};var setGroupValueTZ=function(e,t,a){e.find("input").val(a.display_text),e.find("input").attr("rel",t)};ZCL_setEvenTimezone=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_ce_tza");zcal.cdata.opt.TIM;t.html(e)},ZCL_ListAtt=function(e,t){var a="";if(t.ATT&&t.ATT.GRP){var l=t.ATT.GRP;a=ZCL_getGroupAttHtml(l,e,t)}if(t.ATT&&t.ATT.USR){for(var c="",i="yes"==e?t.ATT.USR[0]:"no"==e?t.ATT.USR[1]:"maybe"==e?t.ATT.USR[2]:"pending"==e?t.ATT.USR[3]:t.ATT.USR[0].concat(t.ATT.USR[1],t.ATT.USR[2],t.ATT.USR[3]),n=0;n<i.length;n++){var r=i[n],s={promise:!1,eid:r.AID},d=zmail.ContactBook.get(s);0<d.length?c+="<ul id="+ZCL_getHTML(r.AID)+">"+(d[0].attrs.photo?'<li><img src="'+d[0].attrs.photo+'"/></li>':r.PHOTO?'<li><img src="'+r.PHOTO+'"></li>':'<li><img src="'+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+'"></li>')+'<li onclick="ZCL_attDetail(event)"><b>'+ZCL_getHTML(r.AID)+"</b>"+ZCL_AttCmntDiv(r.CMNT)+'</li><li class="zcl_txr">'+ZCL_AttCmntIcn(r.CMNT)+ZCL_AttStsIcn(r.STS)+ZCL_AttRmvIcn(r.AID,r.UID,t)+"</li></ul>":c+="<ul id="+ZCL_getHTML(r.AID)+">"+(r.PHOTO?'<li><img src="'+r.PHOTO+'"/></li>':'<li><img src="'+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+'"></li>')+'<li onclick="ZCL_attDetail(event)"><b>'+ZCL_getHTML(r.AID)+"</b>"+ZCL_AttCmntDiv(r.CMNT)+'</li><li class="zcl_txr">'+ZCL_AttCmntIcn(r.CMNT)+ZCL_AttStsIcn(r.STS)+ZCL_AttRmvIcn(r.AID,r.UID,t)+"</li></ul>"}a+=""!=c?'<div class="zcl_viwatlst zcl_table" id="ex_attlist">'+c+"</div>":""}return a=""!=a?a:'<div class="zcl_viwatlst zcl_table"><ul><li><div class="zcl_grey">'+zcal.i18n.noattendee+"</div></li></ul></div>"},ZCL_attDetail=function(e){zmConUtil.showContactCard({email:e.target.innerHTML,dom:e.target})},ZCL_AttCmntIcn=function(e){return""!=e?'<i class="msi-comment" title='+zcal.i18n.comment+' onclick="ZCL_DispAttCmt(this)"></i>':""},ZCL_AttStsIcn=function(e){return"<i "+(1==e?"class='msi-like' title='"+zcal.i18n.statusyes+"'":2==e?"class='msi-unlike' title='"+zcal.i18n.statusno+"'":3==e?"class='msi-maybe' title='"+zcal.i18n.statusmaybe+"'":"class='msi-pending' title='"+zcal.i18n.statuspending+"'")+"></i>"},ZCL_AttRmvIcn=function(e,t,a){var l=-1!=a.EID.indexOf("_")?a.EID.split("_")[0]:a.EID,c="";return 1==(zcal[l]?zcal[l].EMODE:zcal.EMODE)&&(c+=t!=a.ORG?'<i class="msi-close" title='+zcal.i18n.remove+" onclick=\"ZCL_rmvAtt(this,'"+e+"')\"></i>":""),c},ZCL_AttCmntDiv=function(e){return""!=e?'<span id="cmtSpan" style="display:none">'+ZCL_getHTML(e)+"</span>":""},ZCL_DispAttCmt=function(e){var t=e.parentNode.parentNode.querySelector("#cmtSpan");t.style.display="none"==t.style.display?"":"none"},ZCL_StsDv=function(e,t,a){return"<li "+(e==t?"class='zcl_sl'":"")+' onclick="ZCL_ChgSts(this)">'+a+"</li>"},ZCL_AttStsDv=function(e){return ZCL_StsDv(e,1,zcal.i18n.yes)+""+ZCL_StsDv(e,2,zcal.i18n.no)+ZCL_StsDv(e,3,zcal.i18n.maybe)},ZCL_ChgSts=function(e){for(var t=e.parentNode.childNodes,a=0;a<t.length;a++)t[a].className="";e.className="zcl_sl",ZCL_sndStat()},ZCL_txtAreaFcs=function(e){if("zcl_cu_cmt"==e.id){var t=e.value.trim();e.value=t==zcal.i18n.comments?"":t,e.className="zcl_evtxa"}},ZCL_txtAreaBlur=function(e){if("zcl_cu_cmt"==e.id){var t=e.value.trim();e.value=""==t?zcal.i18n.comments:t,e.className=""==t?"zcl_evtxa zcl_greymr":"zcl_evtxa"}},ZCL_listGroupUserAtt=function(e,t){var a=zcalGroup.getGroup(e).getMembers();ZCL_isEmpty(a)?zcalGroup.fetchMembers(e,function(){a=zcalGroup.getGroup(e).getMembers(),ZCL_listGroupMemWithStatus(e,a,t)}):ZCL_listGroupMemWithStatus(e,a,t)},ZCL_listGroupMemWithStatus=function(e,t,a){var l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],i=l.find("#zcl_gattThd_"+e)[0];if("none"==i.style.display){"all"==a&&(a="");var n="",r=[],s=[],d=zcal.EOBJ[c].ORGM;zcal.EOBJ[c].ATT.GRP_USR&&(r=ZCL_getGroupUserAttArr("",zcal.EOBJ[c])),zcal.EOBJ[c].ATT.USR&&(s=ZCL_getUserAttArr("",zcal.EOBJ[c]));var o=!1;a&&(zcal.EOBJ[c].ATT.GRP_USR&&("pending"==a&&(r=ZCL_getGroupUserAttArr("",zcal.EOBJ[c])),r=ZCL_getGroupUserAttArr(a,zcal.EOBJ[c])),zcal.EOBJ[c].ATT.USR&&(s="pending"==a?ZCL_getUserAttArr("",zcal.EOBJ[c]):ZCL_getUserAttArr(a,zcal.EOBJ[c])),o=!0);for(var u in t){var p=t[u].eid,m=!1;if(p!=d){for(var _ in r){var z=r[_].AID,f=r[_].STS,v=r[_].CMNT;if(p==z){"pending"!=a&&(n+="<ul><li><span><b></b></span></li><li><b onclick=ZCL_attDetail(event)>"+p+"</b>"+ZCL_AttCmntDiv(v)+"</li><li>"+ZCL_AttCmntIcn(v)+ZCL_AttStsIcn(f)+"</li></ul>",0),m=!0;break}}if(!m)for(var _ in s){var h=s[_].AID;f=s[_].STS,v=s[_].CMNT;if(p==h){"pending"!=a&&(n+="<ul><li><span><b></b></span></li><li><b onclick=ZCL_attDetail(event)>"+p+"</b>"+ZCL_AttCmntDiv(v)+"</li><li>"+ZCL_AttCmntIcn(v)+ZCL_AttStsIcn(f)+"</li></ul>",0),m=!0;break}}o||m?"pending"!=a||m||(n+="<ul><li><span><b></b></span></li><li><b onclick=ZCL_attDetail(event)>"+p+"</b></li><li>"+ZCL_AttStsIcn(0)+"</li></ul>",0):n+="<ul><li><span><b></b></span></li><li><b onclick=ZCL_attDetail(event)>"+p+"</b></li><li>"+ZCL_AttStsIcn(0)+"</li></ul>"}else p==d&&0}""!=n&&(i.innerHTML=n,i.style.display="",$("#zcl_gatt_"+e).addClass("zcl_vwatgrp"))}else i.style.display="none",$("#zcl_gatt_"+e).removeClass("zcl_vwatgrp")},ZCL_getGroupAttHtml=function(e,t,a){var l=-1!=a.EID.indexOf("_")?a.EID.split("_")[0]:a.EID,c=zcal[l]?zcal[l].EMODE:zcal.EMODE,i="",n=a.ATT.GRP_PHOTO||{};if("all"==t&&-1==zmail.zoid)for(var r=0;r<e.length;r++)for(var s in e[r]){var d=e[r][s];d=ZCL_getHTML(d),i+='<div class="zcl_viwatlst zcl_table" id="zcl_gatt_'+s+'"><ul><li>'+(n[s]?'<img src="'+n[s]+'">':"")+"</li><li><b>"+d+"</b></li>"+(1!=c||a.ATT.IS_STREAM?"":'<li class="zcl_txr"><i class="msi-close" title='+zcal.i18n.remove+" onclick=\"ZCL_rmvGAtt(this, '"+s+"')\"></i></li>")+"</ul></div>"}else for(r=0;r<e.length;r++)for(var s in e[r]){d=e[r][s];var o="all"==t||ZCL_isGroupMemWithStsPres(s,t,a);d=ZCL_getHTML(d),o&&(i+='<div class="zcl_viwatlst zcl_table zcl_curpt" id="zcl_gatt_'+s+'"><ul data-marker="groupAtt" data-gid="'+s+'" data-sts="'+t+'"><li>'+(n[s]?'<img src="'+n[s]+'">':"")+"</li><li><b>"+d+"</b></li>"+(1!=c||a.ATT.IS_STREAM?"":'<li class="zcl_txr"><i class="msi-close" title='+zcal.i18n.remove+" onclick=\"ZCL_rmvGAtt(this, '"+s+"')\"></i></li>")+'</ul></div><div class="zcl_viwatlst zcl_vwatgrpls zcl_table" id="zcl_gattThd_'+s+'" style="display:none"></div>')}return i},ZCL_isGroupMemWithStsPres=function(e,t,a){if("pending"!=t&&!a.ATT.GRP_USR)return!1;var l={},c={},i={},n=!1;if(a.ATT.GRP_USR){var r=a.ATT.GRP_USR;l=r[0],c=r[1],i=r[2]}if("yes"==t)l[e]&&(n=!0);else if("no"==t)c[e]&&(n=!0);else if("maybe"==t)i[e]&&(n=!0);else if("pending"==t){var s=0,d=a.ATT.GRP_MEM_CNT,o=0;d[e]&&(s=d[e]),l[e]&&(o=parseInt(o+ZCL_getJSONObjCnt(l))),c[e]&&(o=parseInt(o+ZCL_getJSONObjCnt(c))),i[e]&&(o=parseInt(o+ZCL_getJSONObjCnt(tentxObj))),o<s&&(n=!0)}return n},ZCL_getGroupUserAttArr=function(e,t){switch(e){case"yes":return t.ATT.GRP_USR[0];case"no":return t.ATT.GRP_USR[1];case"maybe":return t.ATT.GRP_USR[2];case"pending":return t.ATT.GRP_USR[0].concat(t.ATT.GRP_USR[1],t.ATT.GRP_USR[2]);case"all":default:return t.ATT.GRP_USR[0].concat(t.ATT.GRP_USR[1],t.ATT.GRP_USR[2],t.ATT.GRP_USR[3])}},ZCL_getUserAttArr=function(e,t){switch(e){case"yes":return t.ATT.USR[0];case"no":return t.ATT.USR[1];case"maybe":return t.ATT.USR[2];case"pending":return t.ATT.USR[3];case"all":default:return t.ATT.USR[0].concat(t.ATT.USR[1],t.ATT.USR[2],t.ATT.USR[3])}},ZCL_addRem=function(e){var t=e.parentNode;t.removeChild(e);var a=t.childNodes.length;a<4&&(ZCL_appendRem(t),a<3&&ZCL_AppendRemAddLnk(t))},ZCL_appendRem=function(e){e.appendChild((new zcalAlarm).getDOM("dom"))},ZCL_ChgeRemType=function(e){var t=e.nextSibling.value;e.innerHTML="1"==t?zcal.i18n.before:zcal.i18n.after,e.nextSibling.value="1"==t?"0":"1"},ZCL_ChgeActType=function(e){var t=e.nextSibling.value;e.innerHTML="1"==t?zcal.i18n.byemail:zcal.i18n.bypopup,e.nextSibling.value="1"==t?"0":"1"},ZCL_rmvRem=function(e){var t=e.parentNode.parentNode;t.removeChild(e.parentNode),zcal.$("zcl_addrem")||ZCL_AppendRemAddLnk(t)},ZCL_QDetail=function(){var e=$("#zcl_qbk").find("#zcl_qbkttl"),t=$("#zcl_qbk").find("#zcl_qbkloc"),a=$("#zcl_qbk").find("#zcl_qbkcal");if(zcal.OBJTEMP.SUM=e.val(),zcal.OBJTEMP.CNAME=a[0].getAttribute("rel"),3==zcal.view)if(zcal.OBJTEMP.SUM){var l;if(l=ZCL_nlp(e.val().trim(),0),zcal.OBJTEMP.SD==zcal.OBJTEMP.ED){var c=l.ST,i=l.ET;if(c||i){if(zcal.OBJTEMP.ST=c?ZCL_TimetoNo(c):"8:00",zcal.OBJTEMP.ET=i?ZCL_TimetoNo(i):"8:30",zcal.OBJTEMP.ST>zcal.OBJTEMP.ET&&zcal.OBJTEMP.SD==zcal.OBJTEMP.ED){var n=parseInt(zcal.OBJTEMP.ED%100)+parseInt(1),r=parseInt(zcal.OBJTEMP.ED/100);zcal.OBJTEMP.ED=r+""+n}zcal.OBJTEMP.ADAY=0}else zcal.OBJTEMP.ST="8:00",zcal.OBJTEMP.ET="8:30"}zcal.OBJTEMP.SUM=l.SUM}else zcal.OBJTEMP.SD==zcal.OBJTEMP.ED&&(zcal.OBJTEMP.ADAY=0,zcal.OBJTEMP.ST="8:00",zcal.OBJTEMP.ET="8:30");zcal.OBJTEMP.LOC=t.val(),zcal.OBJTEMP.Eurl="",zcal.OBJTEMP.DESC="",zcal.OBJTEMP.RTO=[0,0,0,0,0,0,0,0],zcal.OBJTEMP.REMTY=2,zcal.EMODE=1,ZCL_constEventView(zcal.OBJTEMP),zcal.OBJTEMP=null},ZCL_Qdel=function(e){var t,a=e.rel,l=e.ekey,c=e.calId,i=e.rto,n=e.ridx,r=e.rbrkdate;(ZCL_clrStck(),-1==a.indexOf("_"))?!i||-1==i.indexOf("1")||0==i.indexOf("1")||1==i.split(",")[7]&&14==i.indexOf("1")?(t=(t=zcalEvents.remEve(a,!0,!1))||zcalEvents.remEve(a,!1,!1))&&t[a].USTAT&&t[a].ORG==zcal.cdata.opt.ZUID?zcalQAdd.chkAttAndDel(a,l,c,t[a].USTAT):zcalQAdd.chkAttAndDel(a,l,c):zcal.cdata.calLst[c]?ZCL_getPromtval("eve",a,l,c):(t=(t=zcalEvents.remEve(a,!0,!1))||zcalEvents.remEve(a,!1,!1))&&t[a].USTAT&&t[a].ORG==zcal.cdata.opt.ZUID?zcalQAdd.chkAttAndDel(a,l,c,t[a].USTAT):zcalQAdd.chkAttAndDel(a,l,c):ZCL_showConfirm("delete",{rel:a,ekey:l,crel:c,rto:i,ridx:n,rbrkdate:r,ustat:e.USTAT})},ZCL_delRep=function(e,t){ZCL_EClrStck(),ZCL_closeREditConfirm();var a=t.rel,l=t.crel,c=t.ekey,i=t.ridx,n=t.rto,r=t.rbrkdate,s=a.substring(0,a.indexOf("_")),d=zcalEvents.remEve(s,!1,!1);(d=d||zcalEvents.remEve(s,!0,!1))[s].REP.RPDT;if(1==e||2==e&&0==i)!n||-1==n.indexOf("1")||0==n.indexOf("1")||1==n.split(",")[7]&&14==n.indexOf("1")?zcalQAdd.del(a.substring(0,a.indexOf("_")),c,l,n):zcal.cdata.calLst[l]?ZCL_getPromtval("eve",s,c,l):zcalQAdd.del(a.substring(0,a.indexOf("_")),c,l,n);else{var o=zcal.getCalObj(l),u="/cal/delEve.do?mode=recurD&eid="+s+"&type="+e+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&ckey="+o[9]+"&ekey="+c+"&ctype="+o[5]+"&calmode="+zcal.CALMODE+"&ntfy="+ZCL_NTFY_ATT;u+="&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),u+=i&&"undefined"!=i?"&ridx="+i:"",ZCL_XHR(u+=r&&"undefined"!=r?"&rbrkdate="+r:"",zcalQAdd.retRepDel)}},ZCL_Dedit=function(e,t,a,l,c){var i=1<e.split("_").length?e.split("_")[0]:e,n=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],r=zcal.EOBJ[i]?i:c||(n||i);zcal[r]={},zcal[r].EMODE=1,!zcal.EOBJ[r]||r&&zcal.EOBJ[r]&&e!=zcal.EOBJ[r].EID?ZCL_editEve(e,t,a,l):ZCL_constEventView(zcal.EOBJ[r],r)},ZCL_eveInfo=function(e,a,t,l,c){if(zcal.EMODE=1,zcal.EOBJ=={}||!zcal.EOBJ[e]||e&&e!=zcal.EOBJ[e].EID){zcal.EOBJ={};var i="/cal/eInfo.do?ckey="+zcal.getCalObj(t)[9]+"&ekey="+l+"&calmode="+zcal.CALMODE+(1==zcal.CALMODE?"&grpid="+zcal.ZGID:"");i+="&eveId="+(-1!=e.indexOf("_")?e.substring(0,e.indexOf("_"))+"&date="+e.substring(e.indexOf("_")+1,e.length):e),ZCL_TRIDX&&"undefined"!=ZCL_TRIDX&&(i+="&ridx="+ZCL_TRIDX),ZCL_REPINST&&null!=ZCL_REPINST&&"undefined"!=ZCL_REPINST&&null!=ZCL_REPINST&&(i+="&rbrkdate="+ZCL_REPINST),ZCL_XHR(i,function(e){var t=ZCL_Evl(1,e.responseText);zcal.EOBJ[t.EID]={},zcal.EOBJ[t.EID]=t,"send"==c?ZCL_send(zcal.EOBJ[t.EID]):ZCL_chatLet(a,zcal.EOBJ[t.EID])})}else"send"==c?ZCL_send(zcal.EOBJ[e]):ZCL_chatLet(a,zcal.EOBJ[e])},ZCL_send=function(e){ZCL_clrStck();var t="",a=[];if(e.ATT){for(var l in e.ATT.USR)for(var c in e.ATT.USR[l])t+=""!=t?", "+e.ATT.USR[l][c].AID:e.ATT.USR[l][c].AID+"",a.push(e.ATT.USR[l][c].AID);var i=ZCL_parseDateStr(e.SD),n=String(i).slice(0,3),r=i.dateBy("MMM dd, yyyy"),s=zcal.timeformat[zcal.cdata.opt.TF],d=!(!e.ADAY||1!=e.ADAY),o=(e.SD,e.ED,d?"8:00 am":e.ST),u=d?"8:30 am":e.ET,p=o.getTimeBy(s),m=u.getTimeBy(s),_=p.split(" ")[0],z="am"==p.split(" ")[1]?"AM":"PM",f=m.split(" ")[0],v="am"==m.split(" ")[1]?"AM":"PM",h=n+" "+r+" "+(d?"":_+" "+z+" - "+f+" "+v)+" ("+(e.ETZ?e.ETZ:zcal.cdata.opt.TIM)+")",g={title:e.SUM,date:h,att:a},C=zcalTemplate.invitationview(g)}zmUtil.compose({TO:t,CONTENT:C,SUBJECT:zcal.i18n.eventinvitation+" - "+e.SUM})},ZCL_Dview=function(e,t,a,l,c){var i=c||(1<e.split("_").length?e.split("_")[0]:e);zcal[i]={},zcal[i].EMODE=0,ZCL_editEve(e,t,a,l)},ZCL_GetCalName=function(e){return ZCL_getHTML(zcal.getCalObj(e)[0])},ZCL_tgleNxtEle=function(e){var t=e.parentNode;"none"==t.nextSibling.style.display?(t.nextSibling.style.display="",e.children[0].className="msi-barrow"):(t.nextSibling.style.display="none",e.children[0].className="msi-rarrow")},ZCL_tgleAttEle=function(e){var t=e.parentNode.parentNode;"none"==t.nextSibling.style.display?(t.nextSibling.style.display="",t.className="zcl_ratgpsl"):(t.nextSibling.style.display="none",t.className="zcl_ratgp")},ZCL_setTblHgt=function(){zcal.$("zcl_ce_tbl").style.height=zcal.$("zcl_ce_cont").offsetHeight-2+"px"},ZCL_tgleGrpAtt=function(e){var t=e.childNodes[0];"zcl_sl"==t.className?t.className="":t.className="zcl_sl"},ZCL_UStatusText=function(e,t){return t?"Status of "+t:"Status"},ZCL_putAttendee=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(zcal.EOBJ[e].ATT&&zcal.EOBJ[e].ATT.USR&&t.find("#zcl_ce_aslst")[0]){var a=t.find("#zcl_ce_aslst")[0].childNodes;"sl"==a[1].className?0:"sl"==a[2].className?0:"sl"==a[3].className?0:"sl"==a[4].className&&0,t.find("#zcl_ce_attlst")[0].innerHTML=ZCL_ListAtt("all",zcal.EOBJ[e]);var l=t.find("#zcl_ce").find("[data-marker=groupAtt]");0<l.length&&(l.removeAttr("data-marker"),l.off("click").on("click",function(){var e=$(this),t=e.data("gid"),a=e.data("sts");ZCL_listGroupUserAtt(t,a)}))}},ZCL_rmvAtt=function(e,t){var a=ZCL_$("zcl_rmvatt"),l=a.value,c=""!=l?l.split(","):[];ZCL_in_array(t,c)||c.push(t),a.value=c.join(","),e.parentNode.parentNode.parentNode.removeChild(e.parentNode.parentNode)},ZCL_rmvFromAtt=function(e){e.parentNode.parentNode.parentNode.removeChild(e.parentNode.parentNode)},ZCL_rmvGAtt=function(e,t){var a=ZCL_$("zcl_rmvgatt"),l=a.value,c=""!=l?l.split(","):[];ZCL_in_array(t,c)||c.push(t),a.value=c.join(","),$("#zcl_gatt_"+t).remove(),$("#zcl_gattThd_"+t).remove()},ZCL_putCalAlarmForView=function(e){var t="";if(e.ACTYPE)for(var a=e.ACTYPE.split(","),l=e.REMTIME.split(","),c=e.REMTYPE.split(","),i=a.length,n=0;n<i&&i<=4;n++){ZCL_array_search(l[n],ZCL_REM);1==a[n]&&1==c[n]?t+="<span>"+zcal.REMSTR[l[n]]+" "+zcal.i18n.after+' <span class="zcl_grey">'+zcal.i18n.bypopup+"</span></span>":1==a[n]&&0==c[n]?t+="<span>"+zcal.REMSTR[l[n]]+" "+zcal.i18n.before+' <span class="zcl_grey">'+zcal.i18n.bypopup+"</span></span>":0==a[n]&&1==c[n]?t+="<span>"+zcal.REMSTR[l[n]]+" "+zcal.i18n.after+' <span class="zcl_grey">'+zcal.i18n.byemail+"</span></span>":0==a[n]&&0==c[n]&&(t+="<span>"+zcal.REMSTR[l[n]]+" "+zcal.i18n.before+' <span class="zcl_grey">'+zcal.i18n.byemail+"</span></span>")}return t},ZCL_putCalAlarm=function(e){var t="";if(e.ACTYPE){for(var a=e.ACTYPE.split(","),l=e.REMTIME.split(","),c=e.REMTYPE.split(","),i=a.length,n=0;n<i&&i<=4;n++){var r=new zcalAlarm;r.set({ACTYPE:a[n],REMTYPE:c[n],REMTIME:l[n]}),t+=r.getDOM("string")}t+=4==i?"":ZCL_RemAddLnk()}else t+=ZCL_RemAddLnk();return t},ZCL_AppendRemAddLnk=function(e){var t=$('<ul id="zcl_addrem"><li><span><i class="msi-add"></i>'+zcal.i18n.addreminder+"</span></li></ul>");t.find("span").off("click").on("click",function(){ZCL_addRem(this.parentNode.parentNode)}),e.appendChild(t[0])},ZCL_RemAddLnk=function(){return'<ul id="zcl_addrem"><li><span onclick="ZCL_addRem(this.parentNode.parentNode)"><i class="msi-add"></i>'+zcal.i18n.addreminder+"</span></li></ul>"},ZCL_RemDelDiv=function(){return'<li onclick="ZCL_rmvRem(this)"><i class="msi-close" title='+zcal.i18n.remove+"></i></li>"},ZCL_putAlarmForView=function(e){var t="";if(e)for(var a=e.length,l=0;l<a&&a<=4;l++){var c=e[l],i=parseInt(c.ACTYPE),n=parseInt(c.REMTYPE),r="";r=ZCL_array_search(c.REMTIME,ZCL_REM)?zcal.REMSTR[c.REMTIME]:ZCL_getCustomAlarmInfo(c.REMTIME),1==i&&1==n?t+="<div>"+r+" "+zcal.i18n.after+' <span class="zcl_grey">'+zcal.i18n.bypopup+"</span></div>":1==i&&0==n?t+="<div>"+r+" "+zcal.i18n.before+' <span class="zcl_grey">'+zcal.i18n.bypopup+"</span></div>":0==i&&1==n?t+="<div>"+r+" "+zcal.i18n.after+' <span class="zcl_grey">'+zcal.i18n.byemail+"</span></div>":0==i&&0==n&&(t+="<div>"+r+" "+zcal.i18n.before+' <span class="zcl_grey">'+zcal.i18n.byemail+"</span></div>")}return t},ZCL_putAlarm=function(e){for(var t="",a=e.length,l=0;l<a&&a<=4;l++){var c=new zcalAlarm;c.set(e[l]),t+=c.getDOM("string")}return t+=4==a?"":ZCL_RemAddLnk()},ZCL_putDate=function(e){var t=zcal.DFORMAT[zcal.cdata.opt.DF],a=e.substring(6,8),l=e.substring(4,6),c=e.substring(0,4);return t.replace("dd",a).replace("MM",l).replace("yyyy",c)},ZCL_DFDate=function(e){for(var t=3==zcal.cdata.opt.DF?zcal.DFORMAT[zcal.cdata.opt.DF].split("-"):zcal.DFORMAT[zcal.cdata.opt.DF].split("/"),a=3==zcal.cdata.opt.DF?e.split("-"):e.split("/"),l={},c=0;c<a.length;c++)l[t[c]]=a[c];return l.yyyy+""+l.MM+l.dd},ZCL_putValues=function(e,t,a){var l=0;for(var c in a)e.options[l]=new Option(a[c],c),t&&c==t&&(e.options[l].selected=!0),l++};var ZCL_DELRTO=1;ZCL_svEve=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];""!=e[0].querySelector("span[rel=save_loadband]").querySelector("em").style.display&&(""!=e.find("#zcl_eid")[0].value?1==zcal.GOBJ[t].RTO[2]&&e.find("#zcl_ce_met")[0]&&"msi-uncheck"==e.find("#zcl_ce_met")[0].className?ZCL_getPromtval("zcl_ce_met"):1==zcal.GOBJ[t].RTO[5]&&e.find("#zcl_ce_crm")[0]&&"msi-uncheck"==e.find("#zcl_ce_crm")[0].className?ZCL_getPromtval("zcl_ce_crm"):1==zcal.GOBJ[t].RTO[3]&&e.find("#zcl_ce_tsk")[0]&&"msi-uncheck"==e.find("#zcl_ce_tsk")[0].className?ZCL_getPromtval("zcl_ce_tsk"):1==zcal.GOBJ[t].RTO[4]&&e.find("#zcl_ce_nts")[0]&&"msi-uncheck"==e.find("#zcl_ce_nts")[0].className?ZCL_getPromtval("zcl_ce_nts"):ZCL_getEntry():ZCL_getEntry())},ZCL_getEntry=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=(new Date,new Date),a=ZCL_splitDateVal(e.find("#zcl_ce_sd")[0].value),l=ZCL_parseTime(e.find("#zcl_ce_st")[0].value);if(t.setYear(a[2]),t.setMonth(a[1]-1),t.setDate(a[0]),t.setHours(l.HH,l.mm,0,0),""==e.find("#zcl_ce_tit")[0].value.trim())return zmUtil.succErrMsg("e",zcal.i18n.plenttle),e.find("#zcl_ce_tit")[0].focus(),!1;var c=e[0].querySelectorAll("[id=fileAttachment]"),i=e[0].querySelectorAll("[id=loadfile1]");if(0<i.length||0<i.length&&ZCL_AttachCount&&ZCL_AttachCount!=c.length)return zmUtil.succErrMsg("e",zcal.i18n.uploadprogress),!1;if(ZCL_UrlCheck(e.find("#zcl_ce_lnk")[0].value),!ZCL_dateValidate("zcl_ce_sd",zcal.i18n.evest)||!ZCL_dateValidate("zcl_ce_ed",zcal.i18n.eveed))return!1;if(!ZCL_dateTimeComparison("zcl_ce_ed","zcl_ce_et",zcal.i18n.eveed,"zcl_ce_sd","zcl_ce_st",zcal.i18n.evest,"G"))return!1;if((e[0].querySelector("span[rel=save_loadband]").querySelector("em").style.display="")!=e.find("#zcl_eid")[0].value){var n=e.find("#zcl_eid")[0].value,r=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];-1!=n.indexOf("_")&&n.substring(0,n.indexOf("_"));if(zcal.GOBJ[r]&&zcal.GOBJ[r].REP&&zcal.GOBJ[r].CNAME==e.find("#zcl_ce_cal")[0].getAttribute("rel"))if((e.find("#zcl_ce_tza")[0].innerHTML?e.find("#zcl_ce_tza")[0].innerHTML:zcal.cdata.opt.TIM)==(zcal.GOBJ[r].ETZ?zcal.GOBJ[r].ETZ:zcal.cdata.opt.TIM)){var s=zcal.GOBJ[r].REP,d=ZCL_getRep("arr",r);d&&d[0]==s.RFRQ&&d[1]==s.RIVL&&d[2]==s.ROPT&&d[3].join("")==s.RDAY.join("")&&d[4]==s.RTOWK&&d[5]==s.RDATE&&d[6]==s.RMON&&d[7]==s.RCNT&&d[8].trim()==s.RUTL?ZCL_showConfirm("edit"):ZCL_subEvent(1)}else ZCL_subEvent(1);else ZCL_subEvent(1)}else ZCL_subEvent()},ZCL_retEntry=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],l=!1,c=zcal.cdata.opt.TIM,i=t.find("#zcl_ce_tza").html(),n=t.find("#zcl_ce_aday").hasClass("msi-check"),r=t.find("#zcl_ce_sd").val(),s=t.find("#zcl_ce_ed").val(),d=n?"00:00":t.find("#zcl_ce_st").val(),o=n?"00:00":t.find("#zcl_ce_et").val(),u=t.find("#zcl_ce_tit").val(),p=t.find("#zcl_ce_desc").val(),m=t.find("#zcl_ce_inetz").hasClass("msi-check"),_=t.find("#zcl_ce_cal")[0].getAttribute("rel");null!=zcal.GOBJ[a]&&zcal.GOBJ[a].SUM==u&&zcal.GOBJ[a].SD==ZCL_DFDate(r)&&zcal.GOBJ[a].ED==ZCL_DFDate(s)&&zcal.GOBJ[a].ST==ZCL_TimetoNo(d)&&zcal.GOBJ[a].ET==ZCL_TimetoNo(o)&&zcal.GOBJ[a].DESC==p&&(l=!0);var z=zcal.getCalObj(_),f={EID:t.find("#zcl_eid")[0].value,EUID:t.find("#zcl_ekey")[0].value,RIDX:t.find("#zcl_ridx")[0].value,EPERM:t.find("#zcl_eperm")[0].value,DPERM:t.find("#zcl_dperm")[0].value,SD:t.find("#zcl_ce_sd")[0].value,ST:ZCL_TimetoNo(d),ED:t.find("#zcl_ce_ed")[0].value,ET:ZCL_TimetoNo(o),ATT:ZCL_getAttendee(),RMVATT:t.find("#zcl_rmvatt")[0].value,GATT:ZCL_getGrpAttendee(),RMVGATT:t.find("#zcl_rmvgatt")[0].value,CLASS:t.find("#zcl_ce_pvt")[0]&&"msi-check"==t.find("#zcl_ce_pvt")[0].className?1:0,ADAY:"msi-check"==t.find("#zcl_ce_aday")[0].className?1:0,IMP:0,Attachment:ZCL_getFileAttach("get"),HASATTACH:ZCL_getFileAttach("sts"),RMAttachment:ZCL_getFileRemoved(a),USTAT:ZCL_usrStat(),UCMNT:t.find("#zcl_cu_cmt")[0]?t.find("#zcl_cu_cmt")[0].value:"",SKEY:t.find("zcl_skey")[0]?t.find("#zcl_skey")[0].value:"",CNAME:_,LOC:t.find("#zcl_ce_loc")[0].value,TRANS:1,DESC:t.find("#zcl_ce_desc")[0].value,LINK:t.find("#zcl_ce_lnk")[0].value,ETSK:t.find("#zcl_ce_tsk")[0]&&"msi-check"==t.find("#zcl_ce_tsk")[0].className?1:0,ECRM:t.find("#zcl_ce_crm")[0]&&"msi-check"==t.find("#zcl_ce_crm")[0].className?1:0,ENTS:t.find("#zcl_ce_nts")[0]&&"msi-check"==t.find("#zcl_ce_nts")[0].className?1:0,EMET:t.find("#zcl_ce_met")[0]&&"msi-check"==t.find("#zcl_ce_met")[0].className?1:0,EMIL:t.find("#zcl_ce_mil")[0]&&"msi-check"==t.find("#zcl_ce_mil")[0].className?1:0,SUM:t.find("#zcl_ce_tit")[0].value,ALARM:""==z[14]?ZCL_getAlarm("zcl_ce_rem"):"group"==z[14]&&0<Object.keys(z[6]).length?ZCL_getGrpAlarm(z[6]):"",REP:ZCL_getRep("",a),TYPE:e,ISDMY:l,ETZ:i!=c?i:"",IN_ETZ:m,DELRTO:1==ZCL_DELRTO,EC:t.find("#zcl_ce_color")[0]?t.find("#zcl_ce_color")[0].getAttribute("rel"):-1,REPINST:t.find("#zcl_repinst")[0].value,ADD_MODE:"DET",NTFY:ZCL_NTFY_ATT,INVITE_ALL:!(!t.find("#invi_all")[0]||"msi-check"!=t.find("#invi_all")[0].className)};ZCL_detailObj(f)},ZCL_subEvent=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=!(!t.find("#zcl_ce_met")[0]||"msi-check"!=t.find("#zcl_ce_met")[0].className);ZCL_isAtt()&&a&&(ZCL_NTFY_ATT=2),ZCL_isAtt()&&!a?e?ZCL_shNtfyAttPop(e):ZCL_shNtfyAttPop():e?ZCL_retEntry(e):ZCL_retEntry()},ZCL_isAtt=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],a=!1;zcal.EOBJ[t].ATT&&(zcal.EOBJ[t].ATT.USR||zcal.EOBJ[t].ATT.GRP)&&(a=!0),a||e.find("#attlist")[0]&&0<e.find("#attlist")[0].childNodes.length&&(a=!0);return a},ZCL_shNtfyAttPop=function(e){ZCL_$("zcl_att_confirm")||$("body").append("<div id='zcl_att_confirm' class='zcl_rpt'/>"),$("#zcl_att_confirm").html($("<div>"+zcal.i18n.invnotifymsg+" ?</div>")[0]);var t={title:zcal.i18n.eventinvitation,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",buttons:[{txt:zcal.i18n.send,callback:function(){ZCL_confNotAtt(e,"1")}},{txt:zcal.i18n.sendme,callback:function(){ZCL_confNotAtt(e,"2")}},{txt:zcal.i18n.dontsend,callback:function(){ZCL_confNotAtt(e,"0")}}],closeaction:function(){ZCL_closeloding()}};setTimeout(function(){zmsDialog.create("zcl_att_confirm",t)},600)},ZCL_shAttPopForQkEdit=function(e){ZCL_$("zcl_att_confirm")||$("body").append("<div id='zcl_att_confirm' class='zcl_rpt'/>"),$("#zcl_att_confirm").html($("<div>"+zcal.i18n.invnotifymsg+" ?</div>")[0]);var t={title:zcal.i18n.eventinvitation,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",buttons:[{txt:zcal.i18n.send,callback:function(){ZCL_confAttQkEdit("1",e)}},{txt:zcal.i18n.sendme,callback:function(){ZCL_confAttQkEdit("2",e)}},{txt:zcal.i18n.dontsend,callback:function(){ZCL_confAttQkEdit("0",e)}}]};setTimeout(function(){zmsDialog.create("zcl_att_confirm",t)},600)},ZCL_closeloding=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;""==e[0].querySelector("span[rel=save_loadband]").querySelector("em").style.display&&(e[0].querySelector("span[rel=save_loadband]").querySelector("em").style.display="none")},ZCL_confAttQkEdit=function(e,t){ZCL_NTFY_ATT=e,zmsDialog.remove(!0),zcalQAdd.edit(t)},ZCL_shQKNtfyAttForRep=function(e,t,a){ZCL_$("zcl_att_confirm")||$("body").append("<div id='zcl_att_confirm' class='zcl_rpt'/>"),$("#zcl_att_confirm").html($("<div>"+zcal.i18n.invnotifymsg+" ?</div>")[0]);var l={title:zcal.i18n.eventinvitation,mask:!0,buttons:[{txt:zcal.i18n.send,callback:function(){ZCL_confAttQkEdRep(e,t,a,"1")}},{txt:zcal.i18n.sendme,callback:function(){ZCL_confAttQkEdRep(e,t,a,"2")}},{txt:zcal.i18n.dontsend,callback:function(){ZCL_confAttQkEdRep(e,t,a,"0")}}]};setTimeout(function(){zmsDialog.create("zcl_att_confirm",l)},600)},ZCL_shAttPopForQkDel=function(e,t,a,l){ZCL_$("zcl_att_confirm")||$("body").append("<div id='zcl_att_confirm' class='zcl_rpt'/>"),$("#zcl_att_confirm").html($("<div>"+zcal.i18n.invnotifymsg+" ?</div>")[0]);var c={title:zcal.i18n.eventinvitation,mask:!0,buttons:[{txt:zcal.i18n.send,callback:function(){ZCL_confAttQkDel(e,t,a,l,"1")}},{txt:zcal.i18n.sendme,callback:function(){ZCL_confAttQkDel(e,t,a,l,"2")}},{txt:zcal.i18n.dontsend,callback:function(){ZCL_confAttQkDel(e,t,a,l,"0")}}]};setTimeout(function(){zmsDialog.create("zcl_att_confirm",c)},600)},ZCL_confNotAtt=function(e,t){ZCL_NTFY_ATT=t,ZCL_clrStck(),zmsDialog.remove(!0),e?ZCL_retEntry(e):ZCL_retEntry()},ZCL_confAttQkDel=function(e,t,a,l,c){ZCL_NTFY_ATT=c,zcalQAdd.del(e,t,a),zmsDialog.remove(!0),l&&1==l&&(ZCL_EClrStck(),zmsDialog.remove(!0))},ZCL_confAttQkEdRep=function(e,t,a,l){ZCL_NTFY_ATT=l,1==t&&ZCL_delRep(e,a)},ZCL_retValAtt=function(e,t){var a=ZCL_Evl(1,e.responseText);if("true"==a.ISVALID)ZCL_detailObj(t);else if("onlygrpmem"==a.MSG){var l=zcal.i18n.nonGrpMem;setTimeout(function(){zmsDialog.confirm(l,{onOk:function(){ZCL_detailObj(t)}})},500)}else if("onlyorgmem"==a.MSG){l=zcal.i18n.NonOrgMemCal;setTimeout(function(){zmsDialog.confirm(l,{onOk:function(){ZCL_detailObj(t)}})},500)}else if("dontallowinvitee"==a.MSG){l="Organization policy doesn't allow to add attendees.";setTimeout(function(){zmsDialog.confirm(l,{onOk:function(){ZCL_detailObj(t)}})},500)}},ZCL_getAddress=function(e){var t=[];for(var a in e[0].childNodes)if(e[0].childNodes[a].id){var l={};e[0].childNodes[a].getAttribute("gid")?(l.egid=e[0].childNodes[a].id,l.gid=e[0].childNodes[a].getAttribute("gid")):(l.eid=e[0].childNodes[a].id,l.zid=e[0].childNodes[a].getAttribute("data-zid")),t.push(l)}return t},ZCL_getAttendee=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a="";if(0<(e=e||t.find("#attlist")).length){var l=ZCL_getAddress(e);if(l)for(var c=0;c<l.length;c++)if(!l[c].gid){var i=l[c].eid.trim();a+=""!=a?","+i:i}var n=a.split(",");a=(n=ZCL_array_unique(n)).join(",")}return a},ZCL_getFullAttendee=function(){var e=ZCL_getAttendee(),t="",a=a||$("#ex_attlist"),l=[];if(0<a.length){for(var c in a[0].childNodes){var i={};a[0].childNodes[c].id&&(i.egid=a[0].childNodes[c].id,l.push(i))}if(l)for(c=0;c<l.length;c++){var n=l[c].egid;t+=""!=t.trim()?","+n:n}var r=t.split(",");t=(r=ZCL_array_unique(r)).join(",")}return t+=""!=e.trim()?""!=t.trim()?","+e:e:""},ZCL_getGrpAttendee=function(){var e=new Array;if(zcal.$("attlist")){var t=ZCL_getAddress($("#attlist"));if(t)for(var a=0;a<t.length;a++)t[a].egid&&e.push(t[a].egid)}return e},ZCL_getAlarm=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a="zcl_cal_rem"==e?[{}]:"";if(t.find("#"+e)[0]){var l=t.find("#"+e)[0].childNodes,c=l.length;1<c&&c<=5&&(a=ZCL_getAlarmObj(l))}return a},ZCL_getAlarmObj=function(e){var t=e.length,a=[],l=[],c=[];t=5<t?5:t;for(var i=0;i<t;i++)if("UL"==e[i].tagName&&"zcl_addrem"!=e[i].id){var n=e[i].childNodes;l.push(n[0].children[0].children[0].value),c.push(n[1].children[0].children[0].value),a.push(n[2].children[0].children[0].value)}return[{ACTYPE:a.join(","),REMTIME:l.join(","),REMTYPE:c.join(",")}]},ZCL_getGrpAlarm=function(e){return[{ACTYPE:e.ACTYPE,REMTIME:e.REMTIME,REMTYPE:e.REMTYPE}]},ZCL_getRep=function(e,t){var a=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_rep")[0],l=zcal.EOBJ[t].rObj;if(a){if("msi-check"!=a.getElementsByTagName("I")[0].className)return l.reset(),null;var c=l.getReqObj();return null!=e&&"arr"==e&&(c=[c.RFRQ,c.RIVL,c.ROPT,c.RDAY,c.RTOWK,c.RDATE,c.RMON,c.RCNT,c.RUTL]),c}return null},ZCL_ChgChk=function(e){if("zcl_rep_span"!=e.id){var t=e.childNodes[0];t.className="msi-check"==t.className?"msi-uncheck":"msi-check"}},ZCL_checkAll=function(e){var t=e?$(e):zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=t.find("#zcl_ce_aday")[0]?t.find("#zcl_ce_aday"):$("#zcl_ce_aday"),l=t.find("#zcl_ce_st")[0]?t.find("#zcl_ce_st"):$("#zcl_ce_st"),c=t.find("#zcl_ce_et")[0]?t.find("#zcl_ce_et"):$("#zcl_ce_et"),i=t.find("#zcl_ce_tza")[0]?t.find("#zcl_ce_tza"):$("#zcl_ce_tza"),n=t.find("#zcl_ce_inetz")[0]?t.find("#zcl_ce_inetz"):$("#zcl_ce_inetz"),r=t.find("#zcl_ce")[0]?t.find("#zcl_ce"):e?$(e):$("#zcl_ce"),s=t.find("#zcl_pshelp")[0]?t.find("#zcl_pshelp"):$("#zcl_pshelp"),d=t.find("#zcl_pasband")[0]?t.find("#zcl_pasband"):$("#zcl_pasband");a.hasClass("msi-uncheck")?(l.parent().show(),c.parent().show(),i.parent().show(),n.parents("ul.zcl_frmrw").show(),r[0]?ZCL_isPasteve("zcl_ce_ed","zcl_ce_et",e)&&(r.find("#zcl_pasband")[0]||(r[0].insertAdjacentElement("afterbegin",$('<div id="zcl_pasband" style="padding: 5px;margin: 0 20px 20px;background-color: #f3f2f2;">'+zcal.i18n.pastevemsg+'<span class="zcl_lk" id="zcl_pshelp" style="margin-left: 5px;">Help</span></div>')[0]),s.on("click",function(){window.open("https://www.zoho.com/calendar/help/managing-events.html#alink19")}))):ZCL_isPasteve("zcl_ce_ed","zcl_ce_et",e)&&($("#zmsdialog_zcl_addevent").find("#zcl_pasband")[0]||($("#zmsdialog_zcl_addevent")[0].insertAdjacentElement("afterbegin",$('<div id="zcl_pasband" style="padding: 5px;margin: 0 20px 20px;background-color: #f3f2f2;">'+zcal.i18n.pastevemsg+'<span class="zcl_lk" id="zcl_pshelp" style="margin-left: 5px;">Help</span></div>')[0]),s.on("click",function(){window.open("https://www.zoho.com/calendar/help/managing-events.html#alink19")})))):(l.parent().hide(),c.parent().hide(),i.parent().hide(),n.parents("ul.zcl_frmrw").hide(),r[0]?ZCL_isPasteve("zcl_ce_ed",0,e)?r.find("#zcl_pasband")[0]||(r[0].insertAdjacentElement("afterbegin",$('<div id="zcl_pasband" style="padding: 5px;margin: 0 20px 20px;background-color: #f3f2f2;">'+zcal.i18n.pastevemsg+'<span class="zcl_lk" id="zcl_pshelp" style="margin-left: 5px;">Help</span></div>')[0]),s.on("click",function(){window.open("https://www.zoho.com/calendar/help/managing-events.html#alink19")})):d[0]&&d.remove():ZCL_isPasteve("zcl_ce_ed",0,e)?$("#zmsdialog_zcl_addevent").find("#zcl_pasband")[0]||($("#zmsdialog_zcl_addevent")[0].insertAdjacentElement("afterbegin",$('<div id="zcl_pasband" style="padding: 5px;margin: 0 20px 20px;background-color: #f3f2f2;">'+zcal.i18n.pastevemsg+'<span class="zcl_lk" id="zcl_pshelp" style="margin-left: 5px;">Help</span></div>')[0]),s.on("click",function(){window.open("https://www.zoho.com/calendar/help/managing-events.html#alink19")})):d[0]&&d.remove())},ZCL_delEve=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=e.find("#zcl_eid")[0].value,a=e.find("#zcl_ekey")[0].value,l=e.find("#zcl_crel")[0].value,c=e.find("#zcl_rtoval")[0]?e.find("#zcl_rtoval")[0].value:"";if(zcal.isRO)ZCL_openRO();else if(t&&""!=t)if(-1==t.indexOf("_"))-1==c.indexOf("1")||0==c.indexOf("1")||1==c.split(",")[7]&&14==c.indexOf("1")?zcalQAdd.chkAttAndDel(t,a,l,-1,!0):zcal.cdata.calLst[l]?ZCL_getPromtval("eve",t,a,l):zcalQAdd.chkAttAndDel(t,a,l,-1,!0);else{var i={rel:t,crel:l,ekey:a,ridx:e.find("#zcl_ridx")[0].value,rbrkdate:e.find("#zcl_repinst")[0].value,rto:c};ZCL_showConfirm("delete",i)}},ZCL_usrStat=function(){var e=0;if(ZCL_$("zcl_ce_asts")){var t=ZCL_$("zcl_ce_asts").childNodes;e="zcl_sl"==t[0].className?1:"zcl_sl"==t[1].className?2:"zcl_sl"==t[2].className?3:e}return e},ZCL_sndStat=function(){var e=ZCL_usrStat();if(0!=e)if(zcal.isRO)ZCL_openRO();else{var t=ZCL_$("zcl_cu_cmt").value,a=ZCL_$("zcl_eid").value,l=ZCL_$("zcl_skey").value,c=ZCL_$("zcl_crel").value,i=zcal.getCalObj(c)[9],n=ZCL_$("zcl_ekey").value;ZCL_XHR("/cal/cuStat.do?custat="+e+"&cucmt="+t+"&eid="+(a=-1==a.indexOf("_")?a:a.substring(0,a.indexOf("_")))+"&skey="+l+"&ckey="+i+"&ekey="+n+"&calmode="+zcal.CALMODE,ZCL_retStat)}},ZCL_updRepStatus=function(e,t){ZCL_REP_SD=null!=t.sd?t.sd:null;var a="/cal/cuStat.do?custat="+t.custat+"&cucmt="+t.cmt+"&eid="+t.eid+"&skey="+t.skey+"&ckey="+t.ckey+"&ekey="+t.ekey+"&calmode="+t.calmode;ZCL_XHR(a+="&repinst="+t.repinst+"&recuredit="+e+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF],ZCL_retStat)},ZCL_retStat=function(e,t){var a="UPDATE ATTENDEE STATUS"==t?ZCL_Evl(1,e):ZCL_Evl(1,e.responseText);if(a.ERR)return ZCL_slideObj.status(zcal.i18n[a.ERR]),!1;if(a.ATTENDEE){var l=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];zcal.EOBJ[l].ATT.USR=a.ATTENDEE,ZCL_putAttendee(l)}!a.EID||"1"!=a.STS&&"2"!=a.STS&&"3"!=a.STS||ZCL_updateSts(a.EID,a.STS)},ZCL_showEvent=function(e){for(var t in e)for(var a in e[t])if(e[t][a].EC=e[t][a].EC?e[t][a].EC:"-1","edit"==e[t][a].MODE){var l=zcalEvents.remEve(a,!1,!0);l=l||zcalEvents.remEve(a,!0,!0),ZCL_insertEvent(e[t],a)}else{parseInt(e[t][a].SD),parseInt(e[t][a].ED),parseInt(e[t][a].ADAY),parseInt(e[t][a].ST);var c=e[t][a];c.REP?ZCL_XHR("/cal/repRange.do?eid="+a+"&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF],function(e){var t=ZCL_Evl(1,e.responseText);ZCL_updateRepeatWithRange(t,c)}):ZCL_insertEvent(e[t],a)}ZCL_enableCal(e[t][a].CNAME),ZCL_updateCalAndEvents()},ZCL_updateRepeatWithRange=function(e,t){var a=e.id,l=e.rdats?e.rdats:"";if(t){var c="{'"+a+"':{'CNAME': '"+t.CNAME+"', 'SD' : '"+t.SD+"', 'ED' : '"+t.ED+"', 'ST': '"+t.ST+"', 'ET':'"+t.ET+"', 'SUM' :'"+t.SUM+"', 'ADAY':'"+t.ADAY+"', 'EUID':'"+t.EUID+"', 'DUR':'"+t.DUR+"', 'EPERM':'"+t.EPERM+"', 'DPERM':'"+t.DPERM+"'";c+=", 'REF' : ["+t.REF[0]+", "+t.REF[1]+", "+t.REF[2]+", "+t.REF[3]+", "+t.REF[4]+"]",c+=t.REP?", 'REP' : {'RPDT' : '"+t.RPDT+"'}}":"}",c+="}";var i=ZCL_Evl(1,c);""!=l&&0<l.length&&ZCL_insertRepEvents(i,l,a)}},ZCL_eClose=function(){ZCL_EClrStck()},ZCL_serviceRes=function(e){if("success"==(_=ZCL_Evl(1,e.responseText)).status){var t=_.service;if("ents"==t){(d=ZCL_$("zcl_eassociate_qv")?ZCL_$("zcl_eassociate_qv"):document.createElement("div")).id="zcl_eassociate_qv",d.className="zcl_asso";var a=_.nobj,l=a.title;d.innerHTML="";var c=document.createElement("p");c.append(zcal.i18n.title+" : "+l);var i=document.createElement("p"),n=ZCL_LinkParser(a.desc?a.desc:"");for(var r in n)i.appendChild(n[r]);d.append(c),d.append(i),document.body.appendChild(d);var s={title:ZCL_replaceComName(zcal.i18n.znotes),style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright"};zmsDialog.create("zcl_eassociate_qv",s)}else if("etsk"==t)try{var d,o=[zcal.i18n.ztask_priority_high,zcal.i18n.ztask_priority_medium,zcal.i18n.ztask_priority_low],u=_.tobj,p=o[u.PRIORITY];(d=ZCL_$("zcl_eassociate_qv")?ZCL_$("zcl_eassociate_qv"):document.createElement("div")).id="zcl_eassociate_qv",d.className="zcl_asso";var m='<ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.task_label_title+"</li><li>"+ZCL_getHTML(u.TITLE)+"</li></ul>";m+='<ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.task_label_duedate+"</li><li>"+u.DUEDATE+"</li></ul>",m+='<ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.task_label_priority+"</li><li>"+p+"</li></ul>",m+='<ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.task_label_description+"</li><li></li></ul>",m+="<p>"+ZCL_getHTML(u.DESC)+"</p>",d.innerHTML=m,document.body.appendChild(d);s={title:ZCL_replaceComName(zcal.i18n.ztask),style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright"};zmsDialog.create("zcl_eassociate_qv",s)}catch(e){return zmUtil.succErrMsg("e",zcal.i18n.errorpopup_desc),!1}else if("emet"==ZCL_SERVICE)window.open(e.responseText);else if("elnk"==ZCL_SERVICE){var _;if((_=ZCL_Evl(1,e.responseText)).elnk){var z=document.body.appendChild(document.createElement("A"));z.setAttribute("rel","noreferrer"),z.href=_.elnk,z.target="_blank",z.click(),z.parentNode.removeChild(z)}}else"ecrm"==ZCL_SERVICE?window.open(e.responseText):"emil"==ZCL_SERVICE&&window.open(e.responseText)}else ZCL_dispErrorPopup()},ZCL_dispErrorPopup=function(){var e=ZCL_$("zcl_errdiv")?ZCL_$("zcl_errdiv"):document.createElement("div");e.id="zcl_errdiv",e.innerHTML='<div id="zcl_errmsg">'+zcal.i18n.associate_error+"</div>",document.body.appendChild(e);var t={title:"Alert!",buttons:[{txt:"OK",callback:function(){zmsDialog.remove(!0)}}],style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright"};zmsDialog.create("zcl_errdiv",t)},ZCL_getPromtval=function(e,t,a,l){var c=document.createElement("div");c.id="zcl_rmvass_confirm",c.className="zcl_rpt",c.innerHTML="eve"==e?zcal.i18n.delOthSer:zcal.i18n.disOther,ZCL_$("zcl_rmvass_confirm")||document.body.appendChild(c);var i={title:zcal.i18n.confirm+" ?",style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){ZCL_closeAssConfirm()},buttons:[{txt:zcal.i18n.yes,callback:function(){ZCL_DELRTO=1,ZCL_closeAssConfirm(),"eve"==e?zcalQAdd.del(t,a,l):ZCL_getEntry()}},{txt:zcal.i18n.no,callback:function(){ZCL_DELRTO=0,"eve"==e?zcalQAdd.del(t,a,l):ZCL_getEntry(),ZCL_closeAssConfirm()}},{txt:zcal.i18n.cancel,callback:function(){zmsDialog.remove(!0)}}]};zmsDialog.create("zcl_rmvass_confirm",i)},ZCL_closeAssConfirm=function(){zmsDialog.remove(!0),$("#zcl_rmvass_confirm").remove()},ZCL_UrlCheck=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=e.find("#zcl_ce_lnk")[0].value.trim();if(""!=t){/^http(s?)\:\/\/[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*(:(0-9)*)*(\/?)([a-zA-Z0-9\-\.\?\,\:\'\/\\\+=&amp;%\$#_]*)?$/i.test(t)||(t=t.match(/\b^(http|https)\:\/\/\b/)?t:location.protocol+"//"+t),e.find("#zcl_ce_lnk")[0].value=t}},ZCL_setEventAlarm=function(){var e=ZCL_$("zcl_crel").value,t=zcal.cdata.calLst[e]||zcal.cdata.calOLst[e];if(t){var a=t[9],l=ZCL_$("zcl_ekey").value,c=ZCL_getAlarm("zcl_ce_rem"),i="/cal/setEveRem.do?ekey="+l+"&ckey="+a;ZCL_XHR(i+=c?"&isrem=true&remt="+c[0].REMTIME+"&remty="+c[0].REMTYPE+"&actty="+c[0].ACTYPE:"&isrem=false",function(e){ZCL_retRemStat(e)})}},ZCL_retRemStat=function(e){var t=ZCL_Evl(1,e.responseText);_zm.succErrMsg("reminderupdated"==t.STS||"reminderremoved"==t.STS?"s":"e",zcal.i18n[t.STS])},ZCL_getAddEventObj=function(e){var t=new Date,a="";e&&(a=e),t.setTime(zcal.today.getTime());var l,c,i,n=t.getDate(),r=t.getMonth(),s=t.getFullYear();for(var s in l=s+""+(r=r+1<10?"0"+(r+1):r+1)+(n=n<10?"0"+n:n),t.setTime(zcal.cdate),c=46<(c=2*t.getHours()+(30<t.getMinutes()?2:1))?46:c,zcal.EMODE=1,zcal.cdata.calOrdArr)if("1"==zcal.cdata.calLst[zcal.cdata.calOrdArr[s]][8]){i=zcal.cdata.calOrdArr[s];break}return i?{SD:l,ST:zcal.TTT[c],ED:l,ET:zcal.TTT[c+1],SUM:a,LOC:"",DESC:"",ADAY:0,ORG:zcal.uid,RTO:[0,0,0,0,0,0,0,0],CNAME:i,REMTY:2}:(alert("You don't have permission to add event on any of these calendars."),!1)},ZCL_updEventPrevHeader=function(e,t,a){var l,c=zmsuite.getCenter()[1].getNodes()[0],i="eventSave",n=c.headerArr.text;"task"===a?i="taskSave":"crm"===a&&(i="crmEventSave"),0==t?(l={id:"zcalPrevHeader",rIcons:[{groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.close,data:{action:"eventClose"}}]}]},"2"==e.DPERM&&l.rIcons.unshift({groupId:"Delete",actionArr:[{iconClass:"msi-trash",tooltip:zcal.i18n.del,data:{action:"eventDelete"}}]}),2==e.EPERM&&l.rIcons.unshift({groupId:"Edit",actionArr:[{iconClass:"msi-edit",tooltip:zcal.i18n.edit,data:{action:"eventEdit"}}]}),null!=e.ATT&&l.rIcons.unshift({groupId:"Send",actionArr:[{iconClass:"msi-send",tooltip:"Send as mail",data:{action:"eventSend"}}]}),zmail.IntegrationStatus&&zmail.IntegrationStatus.CHAT&&l.rIcons.unshift({groupId:"Chatlet",actionArr:[{iconClass:"msi-cliq",tooltip:zcal.i18n.startchat,data:{action:"startChat"}}]})):(l={id:"zcalPrevHeader",rIcons:[{groupId:"Save",actionArr:[{iconClass:"msi-save",tooltip:zcal.i18n.save,data:{action:i}}]}]},null!=e.ATT&&l.rIcons.push({groupId:"Send",actionArr:[{iconClass:"msi-send",tooltip:"Send as mail",data:{action:"eventSend"}}]}),e.EID&&("2"==e.DPERM&&l.rIcons.push({groupId:"Delete",actionArr:[{iconClass:"msi-trash",data:{action:"eventDelete"},tooltip:zcal.i18n.del}]}),zmail.IntegrationStatus&&zmail.IntegrationStatus.CHAT&&l.rIcons.push({groupId:"Chatlet",actionArr:[{iconClass:"msi-cliq",tooltip:zcal.i18n.startchat,data:{action:"startChat"}}]})),l.rIcons.push({groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.close,data:{action:"eventClose"}}]})),c.push(l),l.text=n,c.render()},ZCL_setEventWorkSpace=function(e,t,a,l){var c,i="eventSave",n=!1;if(0==a){var r=t.PARENT_EVENT_ID?t.PARENT_EVENT_ID:1<t.EID.split("_").length?t.EID.split("_")[0]:t.EID;appName=zcal.i18n.viewevent,tabId="zcal_eeContainer_"+r,appIcon="msi-Vevnt"}else if(t.EID){r=t.PARENT_EVENT_ID?t.PARENT_EVENT_ID:1<t.EID.split("_").length?t.EID.split("_")[0]:t.EID;appName=zcal.i18n.editevt,tabId="zcal_eeContainer_"+r,appIcon="msi-caledit"}else appName=zcal.i18n.createevt,tabId="zcal_eContainer",appIcon="msi-caledit",n=!0;if("task"===l?(i="taskSave",appName=0==a?t.IS_SUB_TASK?"View Subtask":zcal.i18n.viewtask:t.EID?t.IS_SUB_TASK?"Edit Subtask":zcal.i18n.edittask:zcal.i18n.createtask):"crm"===l&&(i="crmEventSave"),n){var s=n?++zcal.tabcount:"";id=tabId+"_"+s}n||(id=tabId);var d={appname:appName,appId:id,data:{CNodes:"2"},appIcon:appIcon};if(zmTab.isMaxLimitReached())return"";zmsuite.setWorkSpace(d);var o=["DIV",{attrs:{class:"SC_phd"},child:[["text",appName]]}];0==a?(c={id:"zcalPrevHeader",rIcons:[{groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.close,data:{action:"eventClose"}}]}]},"2"==t.DPERM&&c.rIcons.unshift({groupId:"Delete",actionArr:[{iconClass:"msi-trash",tooltip:"Delete",data:{action:"eventDelete"}}]}),2==t.EPERM&&c.rIcons.unshift({groupId:"Edit",actionArr:[{iconClass:"msi-edit",tooltip:"Edit",data:{action:"eventEdit"}}]}),null!=t.ATT&&c.rIcons.unshift({groupId:"Send",actionArr:[{iconClass:"msi-send",tooltip:"Send as mail",data:{action:"eventSend"}}]}),zmail.IntegrationStatus&&zmail.IntegrationStatus.CHAT&&c.rIcons.unshift({groupId:"Chatlet",actionArr:[{iconClass:"msi-cliq",tooltip:"Start chat",data:{action:"startChat"}}]})):(c={id:"zcalPrevHeader",rIcons:[]},"task"!=l&&c.rIcons.push({groupId:"Save",actionArr:[{iconClass:"msi-save",tooltip:zcal.i18n.save,data:{action:i}}]}),null!=t.ATT&&c.rIcons.push({groupId:"Send",actionArr:[{iconClass:"msi-send",tooltip:"Send as mail",data:{action:"eventSend"}}]}),t.EID&&("2"==t.DPERM&&c.rIcons.push({groupId:"Delete",actionArr:[{iconClass:"msi-trash",data:{action:"eventDelete"},tooltip:"Delete"}]}),zmail.IntegrationStatus&&zmail.IntegrationStatus.CHAT&&c.rIcons.push({groupId:"Chatlet",actionArr:[{iconClass:"msi-cliq",tooltip:"Start chat",data:{action:"startChat"}}]})),c.rIcons.push({groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.close,data:{action:"eventClose"}}]})),c.text=o,zmsuite.showWorkSpace(id),zmTab.updateTabLst(d);var u=zmsuite.getCenter(),p=u[1].getNodes();zmsuite.renderCenter(),p[0].push(c),p[0].setListener("click",function(e,t){zcalList.bindAction(e,t)}),p[1].push($(e)),u[1].show();var m="task"==l?ZCL_$("zcl_tskdes"):u[1].$el.find("#zcl_cedesc")[0];if(m){var _=ZCL_LinkParser(t.DESC?t.DESC:"");for(var z in _)m.appendChild(_[z])}u[1].$el.find("#zcl_ce_desc")[0]&&(u[1].$el.find("#zcl_ce_desc")[0].value=t.DESC?t.DESC:""),u[0].$el.addClass("SC_sw"),u[1].$el.addClass("SC_w100")},ZCL_constEventView=function(e,t){ZCL_clrStck();var a="";if(e&&e.EID&&t){var l=1<t.split("_").length?t.split("_")[0]:t;zcal.EOBJ[l]=e}else"c"==zmApp.currentApp?(a=++zcal.evpageCnt,zcal.EOBJ[a]=e||ZCL_getAddEventObj()):zcal.EOBJ.zm=e||ZCL_getAddEventObj();if("c"!=zmApp.currentApp)e&&e.EID?zcal.EOBJ[e.EID].EID&&(zmsuite.isWorkspaceAvailable("zcal_eContainer")&&zmsuite.closeWorkspace("zcal_eContainer"),zcal[e.EID].EMODE=zcal[e.EID]&&1==zcal[e.EID].EMODE?1:0,ZCL_ConstEventPage(e.EID,"ev")):ZCL_openPopupCreateEvent(zcal.EOBJ.zm);else{zmsuite.isWorkspaceAvailable("zcal_eContainer")&&zmsuite.closeWorkspace("zcal_eContainer");var c="",i="";if(e&&e.EID&&t){l=1<t.split("_").length?t.split("_")[0]:t;zcal[l].EMODE=null==zcal.EOBJ[l].EID||1==zcal[l].EMODE&&zcal.EOBJ[l].EPERM&&2==zcal.EOBJ[l].EPERM?1:0,c=l,i="ev"}else c=a,zcal.EMODE=null==zcal.EOBJ[a].EID||1==zcal.EMODE&&zcal.EOBJ[a].EPERM&&2==zcal.EOBJ[a].EPERM?1:0,i="c";ZCL_ConstEventPage(c,i)}},zcal.constEventViewCard=function(){var e=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],t=zcal.EOBJ[e].GROUP_ID,a=zcal.EOBJ[e].ENTITY_ID;if(ZCL_clrStck(),ZCL_eClose(),zmsuite.isWorkspaceAvailable("zcal_Container")){var l={gid:t,pid:a,type:4,actionType:"viewGroupEntity"};zmStream.singlePost.init(l,function(e){var t=zmsuite.getCenter("zcal_Container")[1],a={text:[["DIV",{attrs:{class:"SC_phd"},child:[["text","Stream view"]]}]],rIcons:[[{tooltip:"Close",iconClass:"msi-close",data:"close"}]]},l=t.getNodes()[0];l.push(a);l.setListener("click",function(){zcal.closePrvwCard(t)}),t.getNodes()[1].push(e),t.show()})}};var isFreeBusyClicked=!(zcal.closePrvwCard=function(e){e.close()});zcal.bindCreateEventAction=function(){var d=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,e=d.find("#zcl_ce_sd")[0],t=d.find("#zcl_ce_ed")[0];e&&ZEVENTS(e.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:e,wkst:zcal.cdata.opt.WK,mode:"popup",fullDtclk:1,higDate:["14/11/2017","16/11/2017"],update:"yes",minhgt:251}).on("dateclick",function(){ZCL_calcEed(e),d.find("#zcl_ce")[0]?showPastBand(d.find("#zcl_ce")):showPastBand(d.find("#zmsdialog_zcl_addevent"))}).bind(),t&&ZEVENTS(t.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:t,wkst:zcal.cdata.opt.WK,mode:"popup",fullDtclk:1,update:"yes",minhgt:251}).on("dateclick",function(){ZCL_setEed(t),d.find("#zcl_ce")[0]?showPastBand(d.find("#zcl_ce")):showPastBand(d.find("#zmsdialog_zcl_addevent"))}).bind();var a=d.find("#zcl_ce_st")[0],l=d.find("#zcl_ce_et")[0];a&&ZEVENTS(a).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:a}).on("change",function(){ZCL_calcEed(a,!0),d.find("#zcl_ce")[0]?showPastBand(d.find("#zcl_ce")):showPastBand(d.find("#zmsdialog_zcl_addevent"))}).bind(),l&&ZEVENTS(l).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:l}).on("change",function(){ZCL_setEed(l,!0),d.find("#zcl_ce")[0]?showPastBand(d.find("#zcl_ce")):showPastBand(d.find("#zmsdialog_zcl_addevent"))}).bind(),d.find("#zcl_ce_cal")[0]&&d.find("#zcl_ce_cal").on("change",function(){ZCL_DoGrpChg()}),d.find("#zcl_ce_cal")[0]&&d.find("#zcl_ce_cal").off("click").on("click",function(e){var a,t=ZCL_getCalArr(),l={},c=$(this);l.parentDOM=c.parent(),l.displayAs="dropdown",l.parWidth=!0,l.onSelect=function(e,t){setGroupValue(c,e,t,""),a.hide()},l.dataCallback=function(){return t},$("#zm_dropDown").remove(),(a=zmUtil.createFLComp("generic",l)).show()}),$("#zcl_addevent").on("click",function(e){"zcl_ce_cal"!=e.target.id&&$("#zm_dropDown").remove()}),$("#zcl_help").on("click",function(e){var t;t=-1!=zcal.ZCAL.indexOf(".stage.skydesk.jp")?"https://www.stage.skydesk.jp/apps/calendar/help/associate-events-with-skydesk-apps.html":-1!=zcal.ZCAL.indexOf(".skydesk.jp")?"https://www.skydesk.jp/apps/calendar/help/associate-events-with-skydesk-apps.html":"https://www.zoho.com/calendar/help/associate-events-with-zoho-apps.html",window.open(t)}),d.find("#zcl_pshelp").on("click",function(){window.open("https://www.zoho.com/calendar/help/managing-events.html#alink19")}),d.find("#zcl_ce_ass")[0]&&(d.find(".msi-crm")[0]&&ZCL_tooltip({elm:d.find(".msi-crm")[0],text:d.find(".msi-crm")[0].getAttribute("rel"),arrow:"bottom"}),d.find(".msi-meeting")[0]&&ZCL_tooltip({elm:d.find(".msi-meeting")[0],text:d.find(".msi-meeting")[0].getAttribute("rel"),arrow:"bottom"}),d.find(".msi-task")[0]&&ZCL_tooltip({elm:d.find(".msi-task")[0],text:d.find(".msi-task")[0].getAttribute("rel"),arrow:"bottom"}),d.find(".msi-notes")[0]&&ZCL_tooltip({elm:d.find(".msi-notes")[0],text:d.find(".msi-notes")[0].getAttribute("rel"),arrow:"bottom"})),document.onmouseup=function(e){if("zcl_iatt_lst"!=e.target.id&&d.find("#zcl_ce_att_tbox")[0]&&""!=d.find("#zcl_ce_att_tbox")[0].value){var t=d.find("#zcl_ce_att_tbox")[0].value;if(1<t.split(",").length){var a=t.split(",");for(var l in a){if(ZCL_isEmail(a[l]))(c={}).id=a[l],ZCL_attCont(c),d.find("#zcl_ce_att_tbox").val("")}}else{var c;if(ZCL_isEmail(t))(c={}).id=t,setTimeout(function(){""!=d.find("#zcl_ce_att_tbox").val()&&(ZCL_attCont(c),d.find("#zcl_ce_att_tbox").val(""))},10)}}},d.find("#zcl_ce_att")[0]&&(d.find("#zcl_ce_att_tbox").off("keydown").on("keydown",function(e){if(13==e.keyCode&&"zcl_ce_att_tbox"==this.id){for(var t=this.value.split(","),a=[],l=0;l<t.length;l++){var c=t[l].trim(),i=c.indexOf("<"),n=c.indexOf(">");-1<i&&-1<n&&(c=c.substring(i+1,n)),c=c.replace(/,/g,""),a.push(c)}if(1<a.length)for(var r in a){if(ZCL_isEmail(a[r]))(s={}).id=a[r],ZCL_attCont(s),d.find("#zcl_ce_att_tbox").val("")}else{var s={};ZCL_isEmail(c)&&(s.id=c,setTimeout(function(){""!=d.find("#zcl_ce_att_tbox").val()&&(ZCL_attCont(s),d.find("#zcl_ce_att_tbox").val(""))},10))}}}),zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:d.find("#zcl_ce_att_tbox")[0],excludeMe:!0,contactType:["org","crm","personal"],exclude:function(){var e=[];if(d.find("#zcl_ce_attlst")[0])for(var t=d.find("#zcl_ce_attlst")[0].childNodes[0].childNodes,a=0;a<t.length;a++)e.push(t[a].getElementsByTagName("B")[0].innerHTML);else if(d.find("#attlist")[0].childNodes){t=d.find("#attlist")[0].childNodes;for(var a in t)e.push(t[a].id)}return e},onSelect:function(e,t){t=t.item.attributes;ZCL_attCont(t),d.find("#zcl_ce_att_tbox").val("")}})})),d.find("#zcl_ce_aday")[0]&&d.find("#zcl_ce_aday").parent().off("click").on("click",function(){ZCL_ChgChk(this),ZCL_checkAll()}),d.find("#zcl_ce_tza")[0]&&d.find("#zcl_ce_tza").parent().off("click").on("click",function(){var a=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];if(zcal.EOBJ[a].ETZ){if(0<zcal.timezones.length)for(var e in zcal.timezones)zcal.timezones[e][zcal.EOBJ[a].ETZ]&&ZCL_openTZPopup(zcal.timezones[e][zcal.EOBJ[a].ETZ],zcal.EOBJ[a].ETZ);else ZCL_uXHR("/cal/timez.do",function(e){for(var t in zcal.timezones=ZCL_Evl(1,e.responseText),zcal.timezones)zcal.timezones[t][zcal.EOBJ[a].ETZ]&&ZCL_openTZPopup(zcal.timezones[t][zcal.EOBJ[a].ETZ],zcal.EOBJ[a].ETZ)})}else ZCL_openTZPopup(zcal.cdata.opt.CTIM,zcal.cdata.opt.TIM)}),d.find("#zcl_ce_inetz")[0]&&d.find("#zcl_ce_inetz").parent().off("click").on("click",function(){ZCL_ChgChk(this)}),d.find("#zcl_fblnk")[0]&&d.find("#zcl_fblnk").off("click").on("click",function(e){isFreeBusyClicked||zcalFreebusy.loadFB()}),d.find("#zcl_gatt_add")[0]&&d.find("#zcl_gatt_add").off("click").on("click",function(e){zcalGroup.listGroupForAttSel()}),d.find("#zcl_ce_rem")[0]&&d.find("#zcl_ce_rem .msi-close").off("click").on("click",function(){var e=this.parentNode.parentNode.parentNode;e.removeChild(this.parentNode.parentNode),e.querySelector("#zcl_addrem")||ZCL_AppendRemAddLnk(e)}),d.find("#zcl_ve_lnk")[0]&&d.find("#zcl_ve_lnk").on("click",function(e){var t=d.find("#zcl_eid")[0].value;ZCL_XHR("/cal/viewOth.do?sname=elnk&mode=1&evid="+(-1!=t.indexOf("_")?t.substring(0,t.indexOf("_")):t),function(e){var t=ZCL_Evl(1,e.responseText);t.elnk&&window.open(t.elnk,"_blank")}),ZCL_stopEvents(e)}),d.find("#zcl_setrem")[0]&&d.find("#zcl_setrem").on("click",function(e){var t=d.find("#zcl_eid")[0].value,a=-1!=t.indexOf("_")?t.substring(0,t.indexOf("_")):t;ZCL_SetAlrm(a)});var c=d.find("#zcl_ce");$groupAtt=c.find("[data-marker=groupAtt]"),0<$groupAtt.length&&($groupAtt.removeAttr("data-marker"),$groupAtt.off("click").on("click",function(){var e=$(this),t=e.data("gid"),a=e.data("sts");ZCL_listGroupUserAtt(t,a)}))},showPastBand=function(e){ZCL_isPasteve("zcl_ce_ed","zcl_ce_et",e)?e.find("#zcl_pasband")[0]||(e[0].insertAdjacentElement("afterbegin",$('<div id="zcl_pasband" style="padding: 5px;margin: 0 20px 20px;background-color: #f3f2f2;">'+zcal.i18n.pastevemsg+'<span class="zcl_lk" id="zcl_pshelp" style="margin-left: 5px;">Help</span></div>')[0]),$("#zcl_pshelp").on("click",function(){window.open("https://www.zoho.com/calendar/help/managing-events.html#alink19")})):e.find("#zcl_pasband").remove()},ZCL_attCont=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=t.find("#attlist"),l=document.createElement("ul");e.zid&&l.setAttribute("data-zid",e.zid),l.setAttribute("id",e.id),l.setAttribute("class","zcl_sl"),t.find("#zcl_ce_attlst")[0]?(l.innerHTML="<li>"+(e.profileImage?"<img src="+e.profileImage+">":"<img src="+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+">")+"</li><li><b>"+e.id+'</b></li><li class="zcl_txr"><i class="msi-pending" title="Status &quot;Pending&quot;"></i><i class="msi-close" onclick="ZCL_rmvFromAtt(this)" title="Remove" ></i></li>',t.find("#zcl_ce_attlst").prepend(a.append($(l)))):(l.innerHTML="<li>"+(e.profileImage?"<img src="+e.profileImage+">":"<img src="+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+">")+"</li><li><b>"+e.id+'</b></li><li class="zcl_txr" style="width:20px"><i class="msi-close" onclick="ZCL_rmvFromAtt(this)" title="Remove" ></i></li>',a.append($(l)))};var setGroupValue=function(e,t,a,l){e.val(a.display_text),e.attr("rel",t),ZCL_DoGrpChg(l)};ZCL_selBox=function(e,t,a){for(var l='<div class="SC_select"><select class="select" id="'+e+'">',c=0;c<a.length;c++)l+="<option "+(c==t?"selected":"")+' value="'+c+'">'+a[c]+"</option>";return l+="</select></div>"},ZCL_selBox1=function(e,t,a){var l='<div class="SC_select"><select class="select" id="'+e+'">';for(var c in a)l+="<option "+(c==t?"selected":"")+' value="'+c+'">'+a[c]+"</option>";return l+="</select></div>"},ZCL_SetMetaInfo=function(e,t){var a=!(!zcal.cdata.calLst[t.CNAME]||!t.ATT),l=zcal.getCalObj(t.CNAME),c=t.CRETIME.split(","),i=t.LSTMODTIME.split(","),n='<ul class="zcl_vwmeta"><li><span onclick="ZCL_tgleNxtEle(this)"><i class="'+(""!=e?"msi-rarrow":"msi-barrow")+'"></i>'+(3==t.ETYPE?zcal.i18n.taskinfo:zcal.i18n.eventinfo)+"</span></li>";return n+="<li "+(""!=e?'style="display:none"':"")+'><div class="zcl_table">',t.ORGM&&""!=t.ORGM&&(n+="<ul><li>"+(t.ORG_PH?'<img src="'+t.ORG_PH+'"/>':"")+"</li><li><b>"+zcal.i18n.organizer+(""!=l[14]&&1==t.CHG_OWN||zcal.cdata.calLst[t.CNAME]&&!t.REP&&"1"!=t.RBRK?'<a class="zcl_lk" onclick="ZCL_opnChgOwnerDv(\''+a+"','"+t.CNAME+"','"+t.REP+"','"+t.EUID+"','"+t.RIDX+"','"+t.REPINST+'\')" style="float: right;margin-right: 10px;">'+zcal.i18n.change+"</a>":"")+'</b><span class="zcl_lk">'+t.ORGM+"</span></li></ul>"),t.CREBY?n+="<ul><li>"+(t.CREBY_PH?'<img src="'+t.CREBY_PH+'">':"")+"</li><li><b>"+zcal.i18n.createdby+'</b><span class="zcl_lk">'+t.CREBY+"</span><u>"+ZCL_parseDateStr(c[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(c[2]).HH+":"+ZCL_parseTime(c[2]).mm+"</u></li></ul>":n+="<ul><li>"+(t.CREBY_PH?'<img src="'+t.CREBY_PH+'">':"")+"</li><li><b>"+zcal.i18n.createdon+"</b><u>"+ZCL_parseDateStr(c[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(c[2]).HH+":"+ZCL_parseTime(c[2]).mm+"</u></li></ul>",t.MODBY?n+="<ul><li>"+(t.MODBY_PH?'<img src="'+t.MODBY_PH+'"/>':"")+"</li><li><b>"+zcal.i18n.modifiedby+'</b><span class="zcl_lk">'+t.MODBY+"</span><u>"+ZCL_parseDateStr(i[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(i[2]).HH+":"+ZCL_parseTime(i[2]).mm+"</u></li></ul>":n+="<ul><li>"+(t.MODBY_PH?'<img src="'+t.MODBY_PH+'"/>':"")+"</li><li><b>"+zcal.i18n.modifiedon+"</b><u>"+ZCL_parseDateStr(i[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(i[2]).HH+":"+ZCL_parseTime(i[2]).mm+"</u></li></ul>",n+="</div></li></ul>"},ZCL_opnChgOwnerDv=function(e,t,a,l,c,i){var n=$(zcalTemplate.popupChOwner(e)),r={title:zcal.i18n.eownerpopup_title,mask:!0,buttons:[{txt:zcal.i18n.change,callback:function(){ZCL_ChgOwner(t,a,l,c,i)}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){zmsDialog.remove(!0)}}],closeaction:function(){zmUtil.hideMenu()}};ZCL_$("zcl_eowner")||$("body").append('<div id="zcl_eowner"></div>'),$("#zcl_eowner").html(n),$("#zcl_eowner").off("click").on("click",function(e){if(e.target.id&&"zcl_inclatt"==e.target.id||$(e.target)[0].querySelector("i")&&"zcl_inclatt"==$(e.target)[0].querySelector("i").id){var t="zcl_inclatt"==e.target.id?e.target:$(e.target)[0].querySelector("i");"msi-uncheck"==t.className?t.className="msi-check":t.className="msi-uncheck"}}),zmsDialog.create("zcl_eowner",r)},ZCL_ChgOwner=function(e,t,a,l,c){var i=ZCL_$("zcl_eowner_inp").value.trim(),n=i.split(","),r=i.indexOf("<"),s=i.indexOf(">");-1<r&&-1<s&&(i=i.substring(r+1,s));var d=ZCL_$("zcl_inclatt")?"msi-check"==ZCL_$("zcl_inclatt").className?1:0:"";if(!ZCL_isEmail(i))return 1<n.length?zmUtil.succErrMsg("e",zcal.i18n.moreemlid_errmsg):zmUtil.succErrMsg("e",zcal.i18n.invalidmail),!1;ZCL_clrStck();var o=zcal.getCalObj(e);"undefined"!=t?(ZCL_$("zcl_repChOwn").setAttribute("rel",i),ZCL_$("zcl_repChOwn").setAttribute("crel",o[9]),ZCL_$("zcl_repChOwn").setAttribute("ekey",a),ZCL_$("zcl_repChOwn").setAttribute("ridx",l),ZCL_$("zcl_repChOwn").setAttribute("repinst",c),ZCL_showConfirm("zcl_repChOwn")):ZCL_XHR("/cal/chgOwner.do?euid="+a+"&ckey="+o[9]+"&nowner="+i.ZCL_calescape()+"&cmt="+ZCL_$("zcl_eowner_cmt").value.trim().ZCL_calescape()+("number"==typeof d?"&inclatt="+d:""),ZCL_retChgOwner)},ZCL_retChgOwner=function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){$("#zcl_ce_ext")[0].childNodes[0].querySelector("div[rel=chgmsg]")&&$("#zcl_ce_ext")[0].childNodes[0].querySelector("div[rel=chgmsg]").remove();var a=document.createElement("div");a.setAttribute("rel","chgmsg"),a.style.whiteSpace="normal",a.style.padding="10px 40px 20px",a.style.fontSize="13px",a.innerHTML='<span class="zcl_lk">'+t.eml+"</span> "+zcal.i18n.orgchnge_msg,$("#zcl_ce_ext")[0].childNodes[0].append(a)}else zmUtil.succErrMsg("e",t.msg);zmsDialog.remove(!0)},ZCL_SetIndAttLst=function(e,t,a){var l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c="",i="";if(t.ATT&&(t.ATT.USR||t.ATT.GRP)&&(c+='<ul class="zcl_viwatt" id="zcl_ce_aslst">'+ZCL_attStsLnk("all",e)+ZCL_attStsLnk("yes",e)+ZCL_attStsLnk("no",e)+ZCL_attStsLnk("maybe",e)+ZCL_attStsLnk("pending",e)+"</ul>",c+='<div id="zcl_ce_attlst">'+ZCL_ListAtt(e,t)+"</div>"),1==a){i+='<ul class="zcl_frmrw" id="zcl_ce_attdv"><li class="zcl_att"><u>'+zcal.i18n.attendees+"</u>",i+='<ul class="zcl_frmrw zcl_pddbz"><li id="zcl_iatt_lst" class="zcl_atte"><div id="zcl_ce_att"><input type="text" class="zm_sgst" placeholder="'+zcal.i18n.typeaemailid+'" id="zcl_ce_att_tbox"></div>';var n;ZCL_hasGrp();n=l.find("#zcl_ce_cal")[0]?l.find("#zcl_ce_cal")[0].getAttribute("rel"):t.CNAME,zcal.getCalObj(n),i+='<i class="msi-addgroup" id="zcl_gatt_add"></i>',i+="</li></ul>",i+='<div class="zcl_table" style="margin-top: 10px;"><ul><li style="width: 100px;"><div class="zcl_txr"><span id="zcl_fblnk" class="zcl_lk">Free/Busy</span></div></li></ul></div>',i+='<div class="section-content startup" style=""><span id="zcl_evhelp" class="startup help" style="margin: 20px 0px;width: auto"><em><img src="'+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+'" class="info-message"></em><span style="white-space: normal;">'+zcal.i18n.eventmsg+"</span></span></div>"}return i+='<div><div class="zcl_viwatlst zcl_table" id="attlist"></div>',i+="</div>",""!=c&&(i+='<ul class="zcl_frmrw zcl_vwatte"><li><div>'+c+"</div></li></ul>"),i},ZCL_hasGrp=function(){var e=!1;return 0<(zcal.cdata.grpLst&&zcal.cdata.grpLst.pgrp?Object.keys(zcal.cdata.grpLst.pgrp).length:0)||(0<(zcal.cdata.grpLst&&zcal.cdata.grpLst.ogrp?Object.keys(zcal.cdata.grpLst.ogrp):0)&&(e=!0),e)},ZCL_DoGrpChg=function(e){var t,a,l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c="c"!=zmApp.currentApp?"zm":4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],i=l.find("#zcl_ce_cal")[0]?l.find("#zcl_ce_cal"):$("#zcl_ce_cal");if(t=i[0].getAttribute("rel"),""!=(a=zcal.getCalObj(t))[14])if("crm"!=a[14]&&null!=i[0]&&(zcal.CAL_IND=i[0].selectedIndex),"crm"==a[14]||"recruit"==a[14]&&(-1!=zcal.cdata.calOUids.indexOf("zohoRecruit4_")||1==zcal.cdata.opt.GTYPE&&"new"==zcal.cdata.opt.VERSION)){if("crm"==a[14]&&null!=zcal.EOBJ[c].EID&&null!=ZCL_OLD_COBJ){if(0!=ZCL_OLD_COBJ[5])return zmUtil.succErrMsg("e",zcal.i18n.crmothercal),void(i[0].selectedIndex=zcal.CAL_IND);if(null!=zcal.EOBJ[c].REP)return zmUtil.succErrMsg("e",zcal.i18n.crmrepadd),void(i[0].selectedIndex=zcal.CAL_IND)}zcal.EOBJ[c].CNAME=t,crmCalId=t,zcalCRM.showCRMForm(zcal.EOBJ[c],zcal[c]?zcal[c].EMODE:zcal.EMODE)}else"ztask"==a[14]?(zcal.EOBJ[c].CNAME=t,zcalTask.showTaskForm(zcal.EOBJ[c],zcal[c]?zcal[c].EMODE:zcal.EMODE)):("gcal"==a[14]?l.find("#zcl_ce_attach")[0]&&(l.find("#zcl_ce_attach")[0].parentNode.style.display="none"):l.find("#zcl_ce_attach")[0]&&(l.find("#zcl_ce_attach")[0].parentNode.style.display=""),l.find("#zcl_ce_ass")[0]&&l.find("#zcl_ce_ass")[0].parentNode.removeChild(l.find("#zcl_ce_ass")[0]),l.find("#zcl_ce_pvt")[0]&&l.find("#zcl_ce_pvt")[0].parentNode.parentNode.removeChild(l.find("#zcl_ce_pvt")[0].parentNode),l.find("#zcl_ce_color")[0]&&l.find("#zcl_ce_color")[0].parentNode.parentNode.parentNode.removeChild(l.find("#zcl_ce_color")[0].parentNode.parentNode),ZCL_setGrpCalAlarm(a,!0,zcal.EOBJ[c]),ZCL_getGrpInvPolicy(a,t,"grpchge"));else{if(null!=i[0]&&(zcal.CAL_IND=i[0].selectedIndex),l.find("#zcl_ce_ass")[0])zcal.cdata.calOLst&&zcal.cdata.calOLst[t]&&l.find("#zcl_ce_ass")[0]&&l.find("#zcl_ce_ass")[0].parentNode.removeChild(l.find("#zcl_ce_ass")[0]);else{var n=ZCL_SetEventAss(zcal.EOBJ[c],zcal[c]?zcal[c].EMODE:zcal.EMODE);if(""!=n){var r=document.createElement("ul");if(r.className="zcl_frmrw",r.id="zcl_ce_ass",r.innerHTML=n,l.find("#zcl_ce_ext")[0]){l.find("#zcl_ce_ext")[0].childNodes;l.find("#zcl_ce_ext")[0].insertBefore(r,l.find("#zcl_ce_attdv")[0])}}}if(!l.find("#zcl_ce_pvt")[0]){var s=document.createElement("li");s.className="zcl_curpt",s.onclick=function(){ZCL_ChgChk(this)},s.innerHTML='<i class="'+(zcal.EOBJ[c].CLASS&&1==zcal.EOBJ[c].CLASS?"msi-check":"msi-uncheck")+'" id="zcl_ce_pvt"></i>'+zcal.i18n.eprivate,l.find("#zcl_ce_tit")[0]&&l.find("#zcl_ce_tit")[0].parentNode.parentNode.appendChild(s)}var d=l.find("#zcl_ce_rem")[0]||""==e?l.find("#zcl_ce_rem"):$("#zcl_ce_rem");if(d[0]){var o=ZCL_setGrpCalAlarm(a,!1,zcal.EOBJ[c]);d[0].innerHTML=o}if(!d[0]){var u=document.createElement("ul");u.className="zcl_frmrw zcl_rem";o=ZCL_setGrpCalAlarm(a,!1,zcal.EOBJ[c]);u.innerHTML='<li id="zcl_ce_rem">'+o+"</li>";var p=l.find("#zcl_ce_ele")[0]?l.find("#zcl_ce_ele"):$("#zcl_ce_ele");if(p[0])p[0].childNodes[1].insertBefore(u,p[0].childNodes[1].childNodes[0]);else(l.find("#zcl_ce_desc")[0]?l.find("#zcl_ce_desc"):$("#zcl_ce_desc"))[0].parentNode.childNodes[3].append(u)}if(l.find("#zcl_ce_attach")[0]&&(l.find("#zcl_ce_attach")[0].parentNode.style.display=""),!l.find("#zcl_ce_color")[0]){var m=document.createElement("ul");m.className="zcl_frmrw",m.innerHTML=ZCL_EventColorSel(zcal.EOBJ[c]),l.find("#zcl_ce_ele")[0]&&l.find("#zcl_ce_ele")[0].childNodes[1].insertBefore(m,l.find("#zcl_ce_ele")[0].childNodes[1].childNodes[1])}if(l.find("#zcl_iatt_lst")[0]&&!l.find("#zcl_iatt_lst")[0].querySelector("#zcl_gatt_add")&&l.find("#zcl_iatt_lst")[0].appendChild($('<i class="msi-addgroup" id="zcl_gatt_add"></i>')[0]),l.find("#zcl_ce_attdv")[0]){var _=l.find("#zcl_ce_attdv")[0].querySelector("li[rel=invi_grp]");_&&_.remove()}}zcal.bindCreateEventAction()},ZCL_openPopupCreateEvent=function(e){var t,a,l,c,i,n,r=ZCL_getAddEventObj(),s=zcal.timeformat[zcal.cdata.opt.TF];e.ADAY&&e.ADAY,t=e.SD?e.SD:r.SD,a=e.ED?e.ED:r.ED,l=e.ST?e.ST:r.ST,c=e.ET?e.ET:r.ET;var d,o=e.CNAME?e.CNAME:r.CNAME;d=zcal.getCalObj(o),i=e.SUM?ZCL_getHTML(e.SUM):"",n=e.DESC?e.DESC:"";var u=l.getTimeBy(s),p=c.getTimeBy(s),m=ZCL_splitDateVal(ZCL_putDate(t)),_=ZCL_splitDateVal(ZCL_putDate(a)),z=ZCL_parseTime(u),f=ZCL_parseTime(p);ZCL_ESDATE=new Date(m[2],m[1]-1,m[0],z.HH,z.mm,0,0),ZCL_EEDATE=new Date(_[2],_[1]-1,_[0],f.HH,f.mm,0,0);var v,h,g,C,y=ZCL_SetEventAlrm(d),L=$(".zm_compose"),b=$("#zm_centerHolder").offset(),E=$(".zmNewBtn").offset();C=$(zcalTemplate.popupCreateEvent({sum:i,desc:n,sd:ZCL_putDate(t),st:u,ed:ZCL_putDate(a),et:p,reminder:y})),v=L.offset(),h=E?E.top+"px":v.top+"px",g=b.left+"px";var T={title:zcal.i18n.createevt,mask:!0,posParent:{top:h,left:g},buttons:[{txt:zcal.i18n.save,callback:function(){ZCL_savePopupEvent(e)}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){zmMention.clearMention($("#zcl_ppce_tit")),zmUtil.hideMenu()}}],closeaction:function(){zmMention.clearMention($("#zcl_ppce_tit")),zmUtil.hideMenu()}};if(!ZCL_$("zcl_addevent")){var D=$('<div id="zcl_addevent"></div>'),Z=zmsuite.getCenter()[0].$el[0].offsetHeight-220;D[0].style.maxHeight=Z+"px",$("body").append(D)}if($("#zcl_addevent").html(C),zmsDialog.create("zcl_addevent",T),ZCL_$("zcl_ppce_tit")){zmAutoFill.setAutofill({contentArray:"org",compare:["fn","ln","nn","eid"],LType:"3",OType:"3",drag:!1},$("#zcl_ppce_tit"))}$("#zmsdialog_zcl_addevent").mousedown(function(e){zmUtil.stopEvents(e,!0),$(".zcal_cn").remove(),$(".zcal_tilst").remove()}),zcal.bindPopupCreateEventAction()},zcal.bindPopupCreateEventAction=function(){var e=ZCL_$("zcl_addevent"),t=e.querySelector("#zcl_ce_sd"),a=e.querySelector("#zcl_ce_ed");t&&ZEVENTS(t.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:t,wkst:zcal.cdata.opt.WK,mode:"popup",fullDtclk:1,higDate:["14/11/2017","16/11/2017"],update:"yes",minhgt:251}).on("dateclick",function(){ZCL_calcEed(t,!1,e),showPastBand($("#zmsdialog_zcl_addevent"))}).bind(),a&&ZEVENTS(a.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:a,wkst:zcal.cdata.opt.WK,mode:"popup",fullDtclk:1,update:"yes",minhgt:251}).on("dateclick",function(){ZCL_setEed(a,!1,e),showPastBand($("#zmsdialog_zcl_addevent"))}).bind();var l=e.querySelector("#zcl_ce_st"),c=e.querySelector("#zcl_ce_et");l&&ZEVENTS(l).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:l}).on("change",function(){ZCL_calcEed(l,!0,e),showPastBand($("#zmsdialog_zcl_addevent"))}).bind(),c&&ZEVENTS(c).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:c}).on("change",function(){ZCL_setEed(c,!0),showPastBand($("#zmsdialog_zcl_addevent"))}).bind(),e.querySelector("#zcl_ce_aday")&&$(e.querySelector("#zcl_ce_aday")).parent().off("click").on("click",function(){ZCL_ChgChk(this),ZCL_checkAll($("#zmsdialog_zcl_addevent"))}),e.querySelector("#zcl_ce_cal")&&$(e.querySelector("#zcl_ce_cal")).on("change",function(){ZCL_DoGrpChg()}),e.querySelector("#zcl_ce_cal")&&$(e.querySelector("#zcl_ce_cal")).off("click").on("click",function(e){var a,t=ZCL_getCalArr(),l={},c=$(this);l.parentDOM=c.parent(),l.displayAs="dropdown",l.parWidth=!0,l.onSelect=function(e,t){setGroupValue(c,e,t,"pop"),a.hide()},l.dataCallback=function(){return t},$("#zm_dropDown").remove(),(a=zmUtil.createFLComp("generic",l)).show()})},ZCL_savePopupEvent=function(e){var t,a,l,c,i=ZCL_$("zcl_addevent");if(""==(t=ZCL_$("zcl_ppce_tit").parentNode.firstChild.innerHTML.split("<b")[0])&&(t=ZCL_$("zcl_ppce_tit").value),a=ZCL_$("zcl_ce_loc").value,l=zmMention.getMentions($("#zcl_ppce_tit")),c=ZCL_streamEve.getMentionEmails(l),""==t)return zmUtil.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_ppce_tit").focus(),!1;if(!ZCL_dateValidate("zcl_ce_sd",zcal.i18n.evest)||!ZCL_dateValidate("zcl_ce_ed",zcal.i18n.eveed))return!1;if(!ZCL_dateTimeComparison("zcl_ce_ed","zcl_ce_et",zcal.i18n.eveed,"zcl_ce_sd","zcl_ce_st",zcal.i18n.evest,"G"))return!1;if(!zcal.validate(i.querySelector("#zcl_ce_desc").value))return zmUtil.succErrMsg("e",zcal.i18n.spchevenot),i.querySelector("#zcl_ce_desc").focus(),!1;var n=""==i.querySelector("#zcl_ce_st").style.display?i.querySelector("#zcl_ce_st").value:"00:00",r=""==i.querySelector("#zcl_ce_et").style.display?i.querySelector("#zcl_ce_et").value:"00:00",s=i.querySelector("#zcl_ce_cal").getAttribute("rel"),d=zcal.getCalObj(s),o={EID:"",EUID:"",EPERM:2<=d[12]?2:1==d[12]?1:0,DPERM:2<=d[12]?2:0,SD:i.querySelector("#zcl_ce_sd").value,ST:ZCL_TimetoNo(n),ED:i.querySelector("#zcl_ce_ed").value,ET:ZCL_TimetoNo(r),ADAY:"msi-check"==i.querySelector("#zcl_ce_aday").className?1:0,LOC:a,DESC:i.querySelector("#zcl_ce_desc").value,ALARM:""==d[14]?ZCL_getAlarm("zcl_ce_rem"):"",ETZ:"",IN_ETZ:!1,CLASS:0,IMP:0,CNAME:s,TRANS:1,ETSK:0,ECRM:0,ENTS:0,EMET:0,LINK:"",NTFY:""!=c?1:-1,SUM:t,EC:-1,ATT:c,ADD_MODE:"PP",MSGID:e.msgId,ACCID:e.accId,failureCallbk:e.failureCallbk,successCallbk:e.successCallbk,INVITE_ALL:!1};ZCL_detailObj(o),zmMention.clearMention($(i.querySelector("#zcl_ppce_tit"))),zmUtil.hideMenu(),zcal.neweevent=!0};var zcalTask=function(){function y(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=e.target||e.srcElement,l=a.id,c=parseInt(l.match(/\d+$/)[0]);if(0<t.find("#zcl_task_"+c).find("input[id='zcl_ce_tit_"+c+"']").length){var i=Z[c];j(i.EUID,i,c)}else u(a)}function L(e){var t=e.target||e.srcElement;o(t)}function b(e){var i=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=[zcal.i18n.ztask_priority_high,zcal.i18n.ztask_priority_medium,zcal.i18n.ztask_priority_low],a=[zcal.i18n.inprogress,zcal.i18n.completed],l=e.SD;id=T;var c=document.createElement("DIV");if(c.id="zcl_task_"+id,c.setAttribute("rel","new"),c.innerHTML='<ul class="zcl_frmrw"><li class="" style="width: 400px;"><u>Subtask Title</u><input type="text" placeholder="Subtask title" class="zcl_crevntt SC_tiput" id="zcl_ce_tit_'+id+'" value=""></li></ul><ul class="zcl_frmrw"><li class="zcl_select"><u>'+zcal.i18n.duedate+'</u><input type="text" class="zcl_w100 SC_tiput" id="zcl_ce_dd_'+id+'" value="'+ZCL_putDate(l)+'" readonly></li><li><u>'+zcal.i18n.status+"</u>"+ZCL_selBox("zcl_task_sts_"+id,0,a)+"</li><li><u>"+zcal.i18n.priority+"</u>"+ZCL_selBox("zcl_task_pri_"+id,1,t)+'</li></ul><ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+zcal.i18n.description+'</u><textarea style="height:44px;" id="zcl_ce_desc_'+id+'" class="zcl_Cedes SC_tiput"></textarea></li></ul>'+(e.EID?'<span class="zcl_lk" id="zcl_task_edit_'+id+'">'+zcal.i18n.add+"</span>":"")+(e.EID?'<span class="zcl_sep" style="display: inline-block;margin:0 10px;border-left:1px solid #bfbfbf;height:10px;width:0;font-size:0;line-height:0;vertical-align:middle;"></span>':"")+'<span class="zcl_lk" id="zcl_task_del_'+id+'">'+zcal.i18n.cancel+"</span>",!!i.find("#zcl_ce_ele")[0].querySelector(".zcl_vw_su_cn")){(n=i.find("#zcl_ce_ele")[0].querySelector(".zcl_vw_su_cn")).appendChild(c)}else{var n;(n=document.createElement("LI")).className="zcl_vw_su_cn",n.appendChild(c);var r=i.find("#zcl_ce_ele")[0];r.insertBefore(n,r.childNodes[1])}m(id);var s=i.find("#zcl_task_"+id).find("span[id='zcl_task_del_"+id+"']");0<s.length&&s.off("click").on("click",function(e){var t=e.target||e.srcElement;o(t)});var d=i.find("#zcl_task_"+id).find("span[id='zcl_task_edit_"+id+"']");0<d.length&&d.off("mousedown").on("mousedown",function(){var e=d.attr("id"),t=parseInt(e.match(/\d+$/)[0]),a=d.text();if(a==zcal.i18n.edit)u(d[0]);else if(a==zcal.i18n.add){(c={}).title=i.find("#zcl_ce_tit_"+t)[0].value,c.duedate=i.find("#zcl_ce_dd_"+t)[0].value,c.priority=i.find("#zcl_task_pri_"+t)[0].value,c.status=i.find("#zcl_task_sts_"+t)[0].value,c.desc=i.find("#zcl_ce_desc_"+t)[0].value,U(c,t)}else if(a==zcal.i18n.save){var l=Z[t].UID,c=Z[t];j(l,c,t)}})}var E,T,D,i,n,Z,c=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;e.SUM=t.find("#zcl_ce_tit")[0]?t.find("#zcl_ce_tit")[0].value:e.SUM,e.Description=t.find("#zcl_ce_desc")[0]?t.find("#zcl_ce_desc")[0].value:"",e.SD=t.find("#zcl_ce_sd")[0]?ZCL_DFDate(t.find("#zcl_ce_sd")[0].value):e.SD,e.ST=t.find("#zcl_ce_st")[0]?ZCL_TimetoNo(""==t.find("#zcl_ce_st")[0].style.display?t.find("#zcl_ce_st")[0].value:"00:00"):e.ST,e.ED=t.find("#zcl_ce_ed")[0]?ZCL_DFDate(t.find("#zcl_ce_ed")[0].value):e.ED,e.ET=t.find("#zcl_ce_et")[0]?ZCL_TimetoNo(""==t.find("#zcl_ce_et")[0].style.display?t.find("#zcl_ce_et")[0].value:"00:00"):e.ET},r=function(e,t){var a=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;ZCL_clrStck();var l='<div class="zcl zcl_CMS zcl_H100" id="zcl_ce">';l+=x(e),l+='<div class="zcl_table zcl_H100">',l+=0==t?'<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li>'+(e.IS_SUB_TASK?'<span class="SC_lnk">'+e.PARENT_TITLE+"</span>":"")+'<ul class="zcl_vwev"><li>'+d(0,e)+v(0,e)+h(0,e)+g(0,e)+C(0,e)+w()+O()+I(0,e)+"</li>"+(0<D?s(e,t):"")+'</ul></li></ul></li><li class="zcl_Cer zcl_vwCer" id="zcl_ce_ext">'+R(e)+"</li></ul>":'<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li>'+(e.IS_SUB_TASK?'<span class="SC_lnk" style="padding-bottom: 10px;display:inline-block;">'+e.PARENT_TITLE+"</span>":"")+d(1,e)+v(1,e)+h(1,e)+g(1,e)+C(1,e)+I(1,e)+w()+O()+"</li>"+(0<D?s(e,t):"")+(e.IS_SUB_TASK||i||!n?"<li>"+N(e)+"</li>":'<li class="zcl_ce_ad_sbtk"><ul class="zcl_frmrw"><li><ul id="zcl_addsubtask"><li><span><i class="msi-add"></i>Add Subtask</span></li></ul></li></ul><ul class="zcl_frmrw"><li><span class="startup  help"><em><img src="'+zmResource.get("image","settings/lightbulb-info.png")+'" class="info-message"></em><span>Task will be created in Calendar "Zoho Tasks" and Task Views(My Tasks).</span></span></li></ul></li><li>'+N(e)+"</li>")+'</ul></li><li class="zcl_Cer zcl_vwCer" id="zcl_ce_ext" style="'+(e.EID?"":"visibility:hidden")+'">'+(e.EID?R(e):"")+"</li></ul>",l+="</div></div>",a.find("#zcl_ce")[0]?(ZCL_updEventPrevHeader("task"),a.find("#zcl_ce").parent().html(l)):ZCL_setEventWorkSpace(l,e,t,"task"),1==t&&z()},o=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=t.find("#zcl_eid")[0].value,l=e.id,c=parseInt(l.match(/\d+$/)[0]),i=e.innerText;if(c<T){var n=Z[c];if(!$.isEmptyObject(n)&&n.hasOwnProperty("EID")&&i==zcal.i18n.del){zcalQAdd.del(n.EID,n.EUID,zcal.EOBJ[a].CNAME),Z.splice(c,1),T=Z.length;var r=t.find("#zcl_task_"+c)[0];if(0<T)r.parentElement.children[0].innerHTML=1==T?T+"Subtasks":T+"Subtask",r.parentElement.removeChild(r);else{var s=r.parentElement;s.parentElement.removeChild(s)}p()}else{if(n.hasOwnProperty("EID")&&i==zcal.i18n.cancel)return void _(n,c);if(i==zcal.i18n.cancel){Z.splice(c,1),T--;var d=ZCL_$("zcl_task_"+c);d.parentElement.removeChild(d),p(),ZCL_$("zcl_ce_ele").querySelector(".zcl_ce_ad_sbtk")&&(ZCL_$("zcl_ce_ele").querySelector(".zcl_ce_ad_sbtk").children[0].style.display="")}}}},u=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=e.id,l=parseInt(a.match(/\d+$/)[0]),c=t.find("#zcl_task_"+l)[0],i=c.querySelectorAll("ul.zcl_frmrw"),n=[zcal.i18n.ztask_priority_high,zcal.i18n.ztask_priority_medium,zcal.i18n.ztask_priority_low],r=[zcal.i18n.inprogress,zcal.i18n.completed],s=Z[l],d=f(s.DUEDATE),o=new Date(d).dateBy(zcal.DATEFORMAT[zcal.cdata.opt.DF]);if(i[0].innerHTML='<li style="width: 400px;"><u>Subtask Title</u><input type="text" placeholder="Subtask title" class="zcl_crevntt SC_tiput" autocomplete="off" id="zcl_ce_tit_'+l+'" value="'+s.TITLE+'"></li>',i[1].innerHTML='<li class="zcl_select"><u>'+zcal.i18n.duedate+'</u><input type="text" class="zcl_w100 SC_tiput" id="zcl_ce_dd_'+l+'" value="'+o+'" readonly></li><li><u>'+zcal.i18n.priority+"</u>"+ZCL_selBox("zcl_task_pri_"+l,s.PRIORITY||1,n)+"</li><li><u>"+zcal.i18n.status+"</u>"+ZCL_selBox("zcl_task_sts_"+l,s.STATUS||0,r)+"</li>",3==i.length)i[2].innerHTML='<li class="zcl_W70pc"><u>'+zcal.i18n.description+'</u><textarea style="height:44px;" id="zcl_ce_desc_'+l+'" class="zcl_Cedes SC_tiput">'+(s.DESC||"")+"</textarea></li>";else{var u=document.createElement("UL");u.className="zcl_frmrw",u.innerHTML='<li class="zcl_W70pc"><u>'+zcal.i18n.description+'</u><textarea style="height:44px;" id="zcl_ce_desc_'+l+'" class="zcl_Cedes SC_tiput"></textarea></li>',c.insertBefore(u,c.children[2])}var p=t.find("#zcl_ce_ele")[0].querySelector(".zcl_ce_ad_sbtk");p&&(p.children[0].style.display="none"),t.find("#zcl_task_edit_"+l).text(zcal.i18n.save),t.find("#zcl_task_del_"+l).text(zcal.i18n.cancel),m(l)},_=function(e,t){var a=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,l=t,c=a.find("#zcl_task_"+l)[0];c.setAttribute("rel",e.EID);var i=c.querySelectorAll("ul.zcl_frmrw"),n=[zcal.i18n.ztask_priority_high,zcal.i18n.ztask_priority_medium,zcal.i18n.ztask_priority_low],r=[zcal.i18n.inprogress,zcal.i18n.completed],s=f(e.DUEDATE),d=e.TITLE,o=e.PRIORITY,u=e.STATUS,p=zcal.DATEFORMAT[zcal.cdata.opt.DF];if(i[0].innerHTML="<li><b>"+d+"</b></li>",i[1].innerHTML='<li><div class="zcl_table"><ul><li><u>'+zcal.i18n.duedate+"</u>"+new Date(s).dateBy(p)+"</li><li><u>"+zcal.i18n.priority+"</u><span>"+n[o]+"</span></li><li><u>"+zcal.i18n.status+"</u><span>"+r[u]+"</span></li></ul></div></li>",3==i.length)""==e.DESC?i[2].parentElement.removeChild(i[2]):i[2].innerHTML="<li><u>"+zcal.i18n.description+"</u>"+e.DESC+"</li>";else if(""!=e.DESC){var m=document.createElement("UL");m.className="zcl_frmrw",m.innerHTML="<li><u>"+zcal.i18n.description+"</u>"+e.DESC+"</li>"}var _=a.find("#zcl_ce_ele")[0].querySelector(".zcl_ce_ad_sbtk");_&&(_.children[0].style.display=""),a.find("#zcl_task_edit_"+t).text(zcal.i18n.edit),a.find("#zcl_task_del_"+t).text(zcal.i18n.del)},s=function(e,t){var a=document.createElement("LI");a.className="zcl_vw_su_cn",a.style.paddingLeft="20px";for(var l="<b>"+(0<T?1==T?T+" Subtask":T+" Subtasks":"No Subtasks")+"</b>",c=[zcal.i18n.ztask_priority_high,zcal.i18n.ztask_priority_medium,zcal.i18n.ztask_priority_low],i=[zcal.i18n.inprogress,zcal.i18n.completed],n=zcal.DATEFORMAT[zcal.cdata.opt.DF],r=0;r<Z.length;r++){var s,d=(e=Z[r]).TITLE,o=e.DUEDATE;0<o.indexOf("/")?(o=f(o),s=new Date(o).getDateBy(n)):(s=new Date(o).getDateBy(n),Z[r].DUEDATE=s);var u=e.PRIORITY||1,p=e.DESC||"",m=e.STATUS||0;e.REMINDER;l+='<div id="zcl_task_'+r+'" rel="'+e.EID+'"><ul class="zcl_frmrw"><li><b>'+d+'</b></li></ul><ul class="zcl_frmrw"><li><div class="zcl_table"><ul><li><u>'+zcal.i18n.duedate+"</u>"+s+"</li><li><u>"+zcal.i18n.priority+"</u><span>"+c[u]+"</span></li><li><u>"+zcal.i18n.status+"</u><span>"+i[m]+"</span></li></ul></div></li></ul>"+(""!=p?'<ul class="zcl_frmrw"><li><u>'+zcal.i18n.description+"</u>"+p+"</li></ul>":"")+(e.EID&&1==t?'<span class="zcl_lk" id="zcl_task_edit_'+r+'">'+zcal.i18n.edit+'</span><span class="zcl_sep"></span><span class="zcl_lk" id="zcl_task_del_'+r+'">'+zcal.i18n.del+"</span>":"")+"</div>"}return a.innerHTML=l,a.outerHTML},m=function(e){var t=$("#zcl_task_"+e).find("input[id='zcl_ce_tit_"+e+"']");0<t.length&&t.off("change").on("change",function(){""==t.val().trim()&&(zmUtil.succErrMsg("e",zcal.i18n.plenttle),t.focus())});var a=$("#zcl_task_"+e).find("input[id='zcl_ce_dd_"+e+"']");if(0<a.length){var l,c=a[0],i=new Date(zcal.cdate),n=zcal.DFORMAT[zcal.cdata.opt.DF];l=i.dateBy(n),ZEVENTS(c).picker("date",{dform:n,range:[l,""],refer:c.id,wkst:0,mode:"popup",update:"yes",minhgt:251}).on("dateclick",function(){A(c)}).bind()}var r=$("#zcl_task_"+e).find("textarea[id='zcl_ce_desc_"+e+"']");0<r.length&&r.off("change").on("change",function(){""==r.val().trim()&&(zmUtil.succErrMsg("e",zcal.i18n.plenttle),r.focus())})},p=function(){for(var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],a="zcl_ce_tit_",l="zcl_ce_dd_",c="zcl_task_sts_",i="zcl_task_pri_",n="zcl_ce_desc_",r="zcl_task_edit_",s="zcl_task_del_",d=e.find("#zcl_ce_ele")[0].querySelectorAll("div[id^='zcl_task_']"),o=0;o<d.length;o++){var u=d[o];u.querySelector('input[id^="'+a+'"]')&&(u.querySelector('input[id^="'+a+'"]').id=a+o,u.querySelector('input[id^="'+l+'"]').id=l+o,u.querySelector('select[id^="'+c+'"]').id=c+o,u.querySelector('select[id^="'+i+'"]').id=i+o,u.querySelector('textarea[id^="'+n+'"]').id=n+o),u.id="zcl_task_"+o,u.querySelector('span[id^="'+s+'"]').id=s+o,zcal.EOBJ[t].EID&&(u.querySelector('span[id^="'+r+'"]').id=r+o)}},z=function e(){var l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c=zmTab.currentTab.split("_")[2],t=l.find("#zcl_ce"),a=zcal.DFORMAT[zcal.cdata.opt.DF],i=(zcal.timeformat[zcal.cdata.opt.TF],t.find("[data-marker=dateField]")),n=t.find("[data-marker=timeField]"),r=t.find("[data-marker=chkboxField]"),s=t.find("[data-marker=remField]"),d=t.find("[data-marker=taskSave]"),o=t.find("[data-marker=taskFormClose]"),u=l.find("#zcl_addsubtask"),p=t.find("[data-marker=remClose]");if(0<i.length){var m;m=new Date(zcal.cdate).dateBy(a),i.removeAttr("data-marker");var _=i[0];ZEVENTS(_).picker("date",{dform:a,range:[m,""],refer:_,wkst:0,mode:"popup",update:"yes",minhgt:251}).on("dateclick",function(){A(_)}).bind()}if(0<n.length){n.removeAttr("data-marker");var z=n[0];ZEVENTS(z).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:z}).bind()}0<s.length&&(s.removeAttr("data-marker"),s.off("click").on("click",function(){M(this)})),0<r.length&&(r.removeAttr("data-marker"),r.parent().off("click").on("click",function(){ZCL_ChgChk(this)})),0<d.length&&(d.removeAttr("data-marker"),d.off("click").on("click",function(){Y(c)})),0<o.length&&(o.removeAttr("data-marker"),o.off("click").on("click",function(){D=T=Z=E=void 0,ZCL_eClose(),zcalView.plotEvents()})),0<u.length&&u.off("click").on("click",function(){var e=l.find("#zcl_ce_ele")[0].querySelector(".zcl_ce_ad_sbtk").children[0];if(0==T){if(P(c)){b(zcal.EOBJ[c]),zcal.EOBJ[c].EID&&(e.style.display="none"),T++;var t={};Z.push(t)}}else if(0<T){var a=ZCL_$("zcl_task_"+(T-1));if(0!=H(a)){b(zcal.EOBJ[c]),zcal.EOBJ[c].EID&&(e.style.display="none"),T++;t={};Z.push(t)}}}),0<p.length&&p.off("mousedown").on("mousedown",function(){ZCL_$("zcl_ce_ele").children[0].children[4].outerHTML='<ul class="zcl_frmrw zcl_rem"><li data-marker="remField"><ul id="zcl_addrem"><li><span><i class="msi-add"></i>'+zcal.i18n.addreminder+"</span></li></ul></li></ul>",e()}),function(){var e=$("#zcl_ce_tit");0<e.length&&e.off("change").on("change",function(){""==e.val().trim()&&(zmUtil.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_ce_tit").focus())});var t=$("#zcl_ce_desc");0<t.length&&t.off("change").on("change",function(){""==t.val().trim()&&(zmUtil.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_ce_desc").focus())})}();for(var f=l.find("#zcl_ce_ele")[0].querySelectorAll("div[id^='zcl_task_']"),v=0;v<f.length;v++){var h=f[v],g=h.querySelector("span[id^='zcl_task_edit_']");ZCALaddListener(g,"mousedown",y);var C=h.querySelector("span[id^='zcl_task_del_']");ZCALaddListener(C,"mousedown",L)}},A=function(e){var t=e.id,a=zcal.DFORMAT[zcal.cdata.opt.DF];if(t.startsWith("zcl_ce_dd_")){var l=e.value;l=f(l);var c=new Date(l),i=ZCL_$("zcl_ce_dd").value;i=f(i);var n=new Date(i);if(c.getTime()>n.getTime())return e.value=n.getDateBy(a),zmUtil.succErrMsg("e","Subtask due date must be less than parent task due date"),!1}else if("zcl_ce_rd"==t){var r=e.value;r=f(r);var s=new Date(r),d=$("#zcl_ce_rt").val();d=ZCL_TimetoNo(d);var o=parseInt(d.substring(0,2)),u=parseInt(d.substring(2));if(s.setHours(o,u),s.getTime()<(new Date).getTime())return zmUtil.succErrMsg("e","Reminder date cannot be less than current date"),!1}return!0},f=function(e){var t=zcal.cdata.opt.DF;if(1==t){var a=e.split("/");e=a[1]+"/"+a[0]+"/"+a[2]}else 3==t&&(e=e.replace(/-/g,"/"));return e},M=function(e){var t,a=$(e),l=e.children[0].id;t=k("dom",l),a.parent().replaceWith(t);var c=t.find("[data-marker=dateField]"),i=t.find("[data-marker=timeField]"),n=t.find("[id=zcl_remMail]"),r=t.find("[id=zcl_remPop]"),s=t.find("i.msi-close");if(0<c.length){var d,o=new Date(zcal.cdate),u=zcal.DFORMAT[zcal.cdata.opt.DF];d=o.dateBy(u),c.removeAttr("data-marker");var p=c[0];ZEVENTS(p).picker("date",{dform:u,range:[d,""],refer:p.id,wkst:0,mode:"popup",update:"yes",minhgt:251}).on("dateclick",function(){A(p)}).bind()}if(0<i.length){i.removeAttr("data-marker");var m=i[0];ZEVENTS(m).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:m.id}).bind()}0<n.length&&n.off("mousedown").on("mousedown",function(){var e=n.attr("class");n[0].className="msi-check"==e?"msi-uncheck":"msi-check"}),0<r.length&&r.off("mousedown").on("mousedown",function(){var e=r.attr("class");r[0].className="msi-check"==e?"msi-uncheck":"msi-check"}),0<s.length&&s.off("mousedown").on("mousedown",function(){ZCL_$("zcl_ce_ele").children[0].children[4].outerHTML='<ul class="zcl_frmrw zcl_rem"><li data-marker="remField"><ul id="zcl_addrem"><li><span><i class="msi-add"></i>'+zcal.i18n.addreminder+"</span></li></ul></li></ul>",z()})},d=function(e,t){var a='<ul class="zcl_frmrw">',l=t.TITLE?ZCL_getHTML(t.TITLE):ZCL_getHTML(t.SUM);return 0==e?a+='<li class="zcl_evttvw">'+l+"</li>":1==e&&(a+='<li class="zcl_W70pc"><u>'+zcal.i18n.title+'</u><input type="text" placeholder="Task Title" class="zcl_crevntt SC_tiput" id="zcl_ce_tit" value="'+l+'"></li>'),a+="</ul>"},v=function(e,t){var a="",l=t.SD;0==e?a+='<ul class="zcl_frmrw"><li>'+ZCL_parseDateStr(l).dateBy("MMM dd, yyyy")+"</li></ul>":1==e&&(a+='<ul class="zcl_frmrw"><li class="zcl_select"><u>'+zcal.i18n.duedate+'</u><input type="text" class="zcl_w100 SC_tiput" data-marker="dateField" value="'+ZCL_putDate(l)+'" id="zcl_ce_dd" readonly></li></ul>');return a},h=function(e,t){var a="",l=t.PRIORITY?t.PRIORITY:1,c=[zcal.i18n.ztask_priority_high,zcal.i18n.ztask_priority_medium,zcal.i18n.ztask_priority_low];return a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.priority+"</u>",0==e?a+="<span>"+c[l]+"</span>":1==e&&(a+=ZCL_selBox("zcl_task_pri",l,c)),a+="</li></ul>"},g=function(e,t){var a="",l=t.STATUS?t.STATUS:0,c=[zcal.i18n.inprogress,zcal.i18n.completed];return a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.status+"</u>",0==e?a+="<span>"+c[l]+"</span>":1==e&&(a+=ZCL_selBox("zcl_task_sts",l,c)),a+="</li></ul>"},C=function(e,t){var a="";return 0==e||t.REMDATE?a+=k("string",t,e):1==e&&(a+='<ul class="zcl_frmrw zcl_rem"><li data-marker="remField"><ul id="zcl_addrem"><li><span><i class="msi-add"></i>'+zcal.i18n.addreminder+"</span></li></ul></li></ul>"),a},S=function(e,t){var a=e+"";for(t=t||2;a.length<t;)a="0"+a;return a},k=function(e,t,a){var l=zcal.DFORMAT[zcal.cdata.opt.DF],c=(zcal.timeformat[zcal.cdata.opt.TF],t.REMDATE||""),i=""!=c&&new Date(c).getTime()>(new Date).getTime()?new Date(c):new Date,n=function(e){var t=zcal.cdata.opt.TF,a=e.getHours(),l=e.getMinutes(),c="";if(30<l?(l=0,a+=1):0<l&&(l=30),0==t){var i=a<12?"am":"pm";c=S(a=12<a?a-12:0==a?12:a)+":"+S(l)+" "+i}else c=S(a)+":"+S(l);return c}(i),r=$('<ul class="zcl_frmrw"/>'),s="";if(0==a){var d=""!=c?new Date(c).dateBy(l)+", "+n:"";s+="<li><u>"+zcal.i18n.reminder+"</u><span>"+d+"</span></li>"}else{var o,u;u=t.EID?(o=zobj.EMLR&&1==t.EMLR?"msi-check":"msi-uncheck",t.PPR&&1==t.PPR?"msi-check":"msi-uncheck"):o="msi-check";rdate=i.getDateBy(l),s+="<li><u>"+zcal.i18n.reminder+'</u><ul class="zcl_frmrw zcl_when"><li class="zcl_select"><input type="text" class="zcl_w100 SC_tiput" data-marker="dateField" value="'+rdate+'" id="zcl_ce_rd" readonly></li><li class="zcl_select"><input type="text" class="zcl_w70 SC_tiput" data-marker="timeField" value="'+n+'" id="zcl_ce_rt"></li><li><i class="msi-close" data-marker="remClose" title="Remove"></i></li></ul><ul><li class="zcl_curpt"><i class="'+o+'" data-marker="chkboxField" id="zcl_remMail"></i>'+zcal.i18n.mail+'</li><li class="zcl_curpt"><i class="'+u+'" data-marker="chkboxField" id="zcl_remPop"></i>'+zcal.i18n.notification+"</li></ul></li>"}return r.html(s),"dom"===e?r:"string"===e?r[0].outerHTML:void 0},w=function(){return'<ul class="zcl_frmrw"><li><u class="zcl_grey">'+zcal.i18n.calendar+"</u><span>"+ZCL_GetCalName(E)+"</span></li></ul>"},O=function(){return'<ul class="zcl_frmrw"><li><u class="zcl_grey">'+zcal.i18n.task+"</u><span>"+zcal.i18n.mytask+"</span></li></ul>"},I=function(e,t){var a='<ul class="zcl_frmrw">',l=t.DESC?t.DESC:"";return 0==e?a+="<li><u>"+zcal.i18n.description+'</u><div class="zcl_vwdes" id="zcl_tskdes"></div></li>':1==e&&(a+='<li class="zcl_W70pc"><u>'+zcal.i18n.description+'</u><textarea style="height:44px;" class="zcl_Cedes SC_tiput" id="zcl_ce_desc">'+l+"</textarea></li>"),a+="</ul>"},x=function(e){return ZCL_hdnFld("zcl_eid",e.EID?e.EID:"")+ZCL_hdnFld("zcl_ekey",e.EUID?e.EUID:"")+ZCL_hdnFld("zcl_crel",E)+ZCL_hdnFld("zcl_rmvatt","")},N=function(e){return'<ul class="zcl_frmrw"><li><div class="SC_PUbtm"><span data-marker="taskSave">'+(e.EID?zcal.i18n.save:zcal.i18n.add)+'</span><span data-marker="taskFormClose" data-val="Cancel">'+zcal.i18n.cancel+"</span></div></li></ul>"},R=function(e){return ZCL_SetMetaInfo("",e)},P=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(""==t.find("#zcl_ce_tit")[0].value.trim())return zmUtil.succErrMsg("e",zcal.i18n.plenttle),t.find("#zcl_ce_tit")[0].focus(),!1;if(!zcal.EOBJ[e].EID){var a=new Date,l=f(t.find("#zcl_ce_dd")[0].value);if(new Date(l).setHours(23,59,59)<a.getTime())return zmUtil.succErrMsg("e","Due date cannot be lesser than the current date"),!1}if(!zcal.validate(t.find("#zcl_ce_desc")[0].value))return zmUtil.succErrMsg("e",zcal.i18n.spchevenot),t.find("#zcl_ce_desc")[0].focus(),!1;var c=t.find("#zcl_ce_rd")[0];return!(c&&!A(c))},H=function(e){var t=e.querySelector("input[id^='zcl_ce_tit_']");if(!t)return 2;if(""==t.value.trim())return zmUtil.succErrMsg("e",zcal.i18n.plenttle),t.focus(),0;var a=f(e.querySelector("input[id^='zcl_ce_dd_']").value),l=f(ZCL_$("zcl_ce_dd").value),c=new Date(a),i=new Date(l);if(c.getTime()>i.getTime())return zmUtil.succErrMsg("e","Subtask due date must be less than parent task's due date"),0;var n=e.querySelector("textarea[id^='zcl_ce_desc_']");if(!zcal.validate(n.value))return n.value="",zmUtil.succErrMsg("e","Special characters are not allowed in description"),n.focus(),0;e.id;return"new"!=e.getAttribute("rel")?2:1},U=function(e,r){var t=zmTab.currentTab.split("_")[2],a=zcal.DFORMAT[zcal.cdata.opt.DF],s=zcal.EOBJ[t].CNAME;e.dateformat=a,e.caluid=zcal.getCalObj(s)[10][2],e.ownerId=zcal.EOBJ[t].OWNERID;var l="/cal/tasks/"+zcal.EOBJ[t].UID+"?";l+="mode=addSubTask",ZCL_XHR(l+="&taskData="+JSON.stringify(e),function(e){var t=JSON.parse(e.responseText);if(t.hasOwnProperty("EID")){if(t.ISNEW=!0,F(t,s),!ZCL_$("zcl_ce_ele"))return;zmUtil.succErrMsg("s","Subtask added successfully!"),Z[r]=t;var a=ZCL_$("zcl_ce_ele").querySelector(".zcl_vw_su_cn");if(a){var l,c=a.getElementsByTagName("B");if(0<c.length)(l=c[0]).innerHTML=1==T?T+" Subtasks":T+"Subtask";else(l=document.createElement("B")).innerHTML=T+" Subtasks",a.insertBefore(l,a.children[0]);var i=Z[r];_(i,r)}}else if("failure"==t.sts){var n=t.msg||"Error while adding subtask!";zmUtil.succErrMsg("e",n)}})},j=function(e,o,u){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_eid")[0].value,p=f(o.DUEDATE);if(p=new Date(p).getDateBy("yyyyMMdd"),o=B(o,u),$.isEmptyObject(o))return zmUtil.succErrMsg("e","Nothing is changed!"),void _(Z[u],u);o.hasOwnProperty("isDue")||(o.isDue=!1,o.duedate=ZCL_$("zcl_ce_dd_"+u).value);var a=zcal.DFORMAT[zcal.cdata.opt.DF],m=zcal.EOBJ[t].CNAME;o.caluid=zcal.getCalObj(m)[10][2],o.dateformat=a,o.ownerId=zcal.EOBJ[t].OWNERID;var l="/cal/tasks/"+e+"?";l+="mode=updateTask",ZCL_XHR(l+="&taskData="+JSON.stringify(o),function(e){var t=JSON.parse(e.responseText);if("success"==t.status){var a=t.data,l=Z[u];for(var c in a)l[c]=a[c];Z[u]=l;var i=!1;if(a.hasOwnProperty("DUEDATE")){i=!0;for(var n=zcal.cdata.eveAll[p],r=o.EID,s=0;s<n.length;s++){n[s].hasOwnProperty(r)&&n.splice(s,1)}}if(l.ISNEW=i,F(l,m),!ZCL_$("zcl_ce_ele"))return;zmUtil.succErrMsg("s","Subtask edited successfully!"),_(l,u),zcalView.plotEvents()}else if("failure"==t.status){var d=t.error||"Error while updating!";zmUtil.succErrMsg("e",d)}})},B=function(e,t){var a=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(!a.find("#zcl_ce_tit_"+t)[0])return{};if(!e.EID)return e;var l={},c=a.find("#zcl_ce_tit_"+t)[0].value;e.TITLE!=c&&(l.title=c);var i=a.find("#zcl_ce_dd_"+t)[0].value;e.DUEDATE!=i&&(l.duedate=i,l.isDue=!0);var n=a.find("#zcl_task_sts_"+t)[0].value;e.STATUS!=n&&(l.status=n);var r=a.find("#zcl_task_pri_"+t)[0].value;e.PRIORITY!=r&&(l.priority=r);var s=a.find("#zcl_ce_desc_"+t)[0].value;return e.DESC!=s&&(l.desc=s),l},F=function(e,t){var a=e.EID,l=e.EUID,c=e.DUEDATE||e.DD;c=f(c);var i=new Date(c),n=i.getDateBy("yyyyMMdd"),r=e.TITLE||e.SUM,s=Number.parseInt(e.STATUS),d=e.ISNEW,o=zcal.cdata.eveAll;o.hasOwnProperty(n)||(o[n]=[]);var u=o[n];if(d){var p={ADAY:"1",CNAME:t||e.CNAME,DPERM:"2",DTSTART:i.getTime(),DUR:"86400000",EC:"-1",ED:n,EPERM:"2",ET:"0000",ETYPE:"3",EUID:l,HASATTACH:!1,LOC:"",ORG:zcal.cdata.opt.ZUID,ORGEMAIL:zcal.cdata.opt.MID,ROLE:"organizer",REF:[0,1,0,0,0,0],RTO:[0,0,0,0,0,0,0,0],SD:n,ST:"0000",SUM:r,TSTS:s};(_={})[a]=p,u.push(_)}else for(var m=0;m<u.length;m++){var _,z=u[m];if(z.hasOwnProperty(a))(_=z[a]).SUM=r,_.TSTS=s}},Y=function(e){if(P(e)&&function(e){for(var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_ce_ele")[0].querySelectorAll("div[id^='zcl_task_']"),a=0;a<t.length;a++){var l=t[a],c=H(l);if(1!=c){if(2==c)continue;return!1}var i=!!zcal.EOBJ[e].EID,n={};n.title=l.querySelector("input#zcl_ce_tit_"+a).value;var r=l.querySelector("input#zcl_ce_dd_"+a).value;n.duedate=r,n.priority=l.querySelector("select#zcl_task_pri_"+a).value;var s=l.querySelector("textarea#zcl_ce_desc_"+a).value;n.desc=s,i&&(n.status=l.querySelector("select#zcl_task_sts_"+a).value),Z[a]=n}return!0}(e)){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=t.find("#zcl_ce_rt")[0]?t.find("#zcl_ce_rt")[0].value:"00:00",r={EID:t.find("#zcl_eid")[0].value,EUID:t.find("#zcl_ekey")[0].value,DD:t.find("#zcl_ce_dd")[0].value,CNAME:t.find("#zcl_crel")[0].value,SUM:t.find("#zcl_ce_tit")[0].value,PRIORITY:t.find("#zcl_task_pri")[0].value,STATUS:t.find("#zcl_task_sts")[0].value,DESC:t.find("#zcl_ce_desc")[0]?t.find("#zcl_ce_desc")[0].value:"",REMDATE:t.find("#zcl_ce_rd")[0]?t.find("#zcl_ce_rd")[0].value:"",REMTIME:ZCL_TimetoNo(a),MAIL:t.find("#zcl_remMail")[0]&&"msi-check"==t.find("#zcl_remMail")[0].className?1:0,POPUP:t.find("#zcl_remPop")[0]&&"msi-check"==t.find("#zcl_remPop")[0].className?1:0,ADAY:1,EPERM:2,DPERM:2,EC:-1,SUBTASK:JSON.stringify(Z)};if(zcal.EOBJ[e].EID){!function(){for(var e=0;e<Z.length;e++){var t=Z[e],a=B(t,e);$.isEmptyObject(a)||(t.EID?j(t.UID,t,e):U(t,e))}}();var l=function(e,t){var a={};e.SUM!=t.TITLE&&(a.title=e.SUM);var l=e.DD;l=f(l),(l=new Date(l).getDateBy("yyyyMMdd"))!=t.SD&&(a.duedate=e.DD,a.isDue=!0),e.PRIORITY!=t.PRIORITY&&(a.priority=e.PRIORITY),e.STATUS!=t.STATUS&&(a.status=e.STATUS),e.DESC!=t.DESC&&(a.desc=e.DESC);var c={};if(t.REMDATE){if(""!=t.REMDATE){""==e.REMDATE&&(a.reminder=c);var i=new Date(t.REMDATE).getTime(),n=f(e.REMDATE);n=new Date(n);var r=e.REMTIME,s=parseInt(r.substring(0,2)),d=parseInt(r.substring(2));n.setHours(s,d),i!=n.getTime()&&(e.MAIL||e.POPUP)&&(a.reminder=c)}}else""!=e.REMDATE&&(e.MAIL||e.POPUP)&&(a.reminder=c);return a}(r,zcal.EOBJ[e]);if($.isEmptyObject(l))ZCL_eClose();else{if(l.hasOwnProperty("reminder")){var c={};c.reminderDate=r.REMDATE,c.reminderTime=r.REMTIME,c.isEmail=r.MAIL,c.isPopup=r.POPUP,l.reminder=c}var i=zcal.DFORMAT[zcal.cdata.opt.DF],s=zcal.EOBJ[e].SD;l.caluid=zcal.getCalObj(zcal.EOBJ[e].CNAME)[10][2],l.hasOwnProperty("duedate")||(l.duedate=r.DD,l.isDue=!1),l.dateformat=i,l.ownerId=zcal.EOBJ[e].OWNERID;var n="/cal/tasks/"+zcal.EOBJ[e].UID+"?";n+="mode=updateTask",ZCL_XHR(n+="&taskData="+JSON.stringify(l),function(e){var t=JSON.parse(e.responseText);if("success"==t.status){zmUtil.succErrMsg("s",zcal.i18n.taskedited);var a=!1;if(t.data.hasOwnProperty("DUEDATE")){a=!0;for(var l=zcal.cdata.eveAll[s],c=r.EID,i=0;i<l.length;i++){l[i].hasOwnProperty(c)&&l.splice(i,1)}}r.ISNEW=a,F(r)}else if("failure"==t.status){var n=t.error||"Error while updating!";zmUtil.succErrMsg("e",n)}ZCL_eClose()})}zcalView.plotEvents()}else V(r)}},V=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a="/cal/addTask.do?title="+e.SUM.zcalescape()+"&dateFormat="+zcal.DFORMAT[zcal.cdata.opt.DF];a+="&dueDate="+e.DD,a+="&priority="+e.PRIORITY.zcalescape(),a+="&status="+e.STATUS.zcalescape(),a+="&desc="+e.DESC.zcalescape(),a+="&subTask="+e.SUBTASK,""!=e.REMDATE&&(e.MAIL||e.POPUP)&&(a+="&remDate="+e.REMDATE+"&remTime="+e.REMTIME+"&remMail="+e.MAIL+"&remPopup="+e.POPUP),a+="&ckey="+zcal.getCalObj(t.find("#zcl_crel")[0].value)[9],ZCL_TEMP_EOBJ=e,ZCL_XHR(a,function(e){ZCL_retDET(e)})};return{showTaskForm:function(e,t){E=e.CNAME,D=e.SUBTASKSCOUNT||0,T=D;var a=e.SUBTASKS?JSON.parse(e.SUBTASKS):[];if(Z=a||[],null==e.EID){c(e);var l=ZCL_putDate(e.SD);l=f(l),i=!(new Date(l).setHours(23,59,59)>(new Date).getTime()),n=!i}else{l=new Date(e.DUEDATE).setHours(23,59,59);i=!(l>(new Date).getTime()),n=!(!e.APERM||"2"!=e.APERM)}r(e,t)},updateTaskData:function(e){var t=e?zcal.EOBJ[e]:zcal.EOBJ,a=e?zcal[e].EMODE:zcal.EMODE;E=t.CNAME,D=t.SUBTASKSCOUNT||0,T=D;var l=t.SUBTASKS?JSON.parse(t.SUBTASKS):[];if(Z=l||[],t.EID){var c=new Date(t.DUEDATE).setHours(23,59,59);i=!(c>(new Date).getTime()),n=!(!t.APERM||"2"!=t.APERM)}else{c=ZCL_putDate(t.SD);c=f(c),i=!(new Date(c).setHours(23,59,59)>(new Date).getTime()),n=!i}r(t,a)},saveTask:Y}}();ZCL_getCustomAlarmInfo=function(e){var t="";if(e<36e5)t=parseInt(e/6e4),t+=1==t?" min":" mins";else if(e<864e5){t=parseInt(e/36e5),t+=1==t?" hr":" hrs";var a=e%36e5;0!=(a=parseInt(a/6e4))&&(t+=1==a?" "+a+" min":" "+a+" mins")}else{t=parseInt(e/864e5);var l=e%864e5;a=l%36e5;t+=1==t?" day":" days",0!=(l=parseInt(l/36e5))&&(t+=1==l?" "+l+" hr":" "+l+" hrs"),0!=(a=parseInt(a/6e4))&&(0==l&&(t+=" 0 hrs"),t+=1==a?" "+a+" min":" "+a+" mins")}return t},ZCL_chatDropdown=function(e,t,c){if("zcal_eContainer"==zmTab.currentTab){var a=[{txt:"Start New Chat",data:"newChat"}];for(var l in e)a.push({txt:e[l].title,data:e[l].chatId});var i,n,r,s=[];for(var d in a)i=(n="newChat"===a[d].data)?"SC_thm":"",s.push(_zm.getDOM(["LI",{attrs:{"data-item":a[d].data,class:i},child:[["text",a[d].txt]]}])),n&&s.push(_zm.getDOM(["LI",{attrs:{class:"SC_lne"}}]));r=new zmDropDownMenu;var o={par:t.target,showArrow:!1,liDom:s,spanClass:"SC_Sopt",clk:chatAction=function(e){if("newChat"==e.item)ZCL_openChatletPopup(c),zmUtil.hideMenu();else{c.EID;var t=c.CNAME,a=zcal.getCalObj(t)[10][2],l=c.UID;ZCL_XHR("/cal/chatlet.do?mode=add&chId="+e.item+"&euid="+l+"&caluid="+a,function(e){"success"==JSON.parse(e.responseText).status&&zmUtil.hideMenu()})}},align:"pright"};r.setDropObj(o),r.paint()}else{ZCL_clrStck();var u={buttons:[{txt:"Start New Chat",callback:function(){ZCL_openChatletPopup(c)}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){ZCL_closeChatlet()}}],closeaction:function(){ZCL_closeChatlet()}};ZCL_$("zcl_chatlet")||$("body").append('<ul id="zcl_alchatlet" class="zcl_chatlgr zmListReset"></ul>');var p="";for(var d in e)p+="<li rel="+e[d].chatId+">"+e[d].title+"</li>";$("#zcl_alchatlet").html(p),$("#zcl_alchatlet").find("LI").on("click",function(e){var t=c.EID,a=zcal.getCalObj(c.CNAME)[10][2],l="/cal/chatlet.do?mode=add&chId="+e.target.getAttribute("rel")+"&caluid="+a;""!=t&&(-1!=t.indexOf("_")?l+="&eveId="+t.substring(0,t.indexOf("_")):l+="&eveId="+t),ZCL_XHR(l,function(e){"success"==JSON.parse(e.responseText).status&&zmsDialog.remove(!0)})}),zmsDialog.create("zcl_alchatlet",u)}},ZCL_chatLet=function(a,l){l.EID;var e=l.CNAME,t=zcal.getCalObj(e)[10][2];ZCL_XHR("/cal/chatlet.do?mode=getChats&euid="+l.UID+"&caluid="+t,function(e){var t=ZCL_Evl(1,e.responseText);0<t.ChatObj.length&&0<Object.keys(t.ChatObj[0]).length?ZCL_chatDropdown(t.ChatObj,a,l):ZCL_openChatletPopup(l)})},ZCL_chatInfo=function(e,t){var a=ZCL_Evl(1,e.responseText);0<a.ChatObj.length?ZCL_chatDropdown(a.ChatObj,t):ZCL_openChatletPopup()},ZCL_openChatletPopup=function(e){var t=e,a=$(zcalTemplate.popupChatlet(t)),l={title:zcal.i18n.stnewchat,mask:!0,buttons:[{txt:zcal.i18n.startchat,callback:function(){ZCL_creatChatlet(e)}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){ZCL_closeChatlet()}}],closeaction:function(){ZCL_closeChatlet()}};ZCL_$("zcl_chatlet")||$("body").append('<div id="zcl_chatlet"></div>'),$("#zcl_chatlet").html(a),$("#zmsdialog_zcl_alchatlet").remove(),zmsDialog.create("zcl_chatlet",l),$("#zmsdialog_zcl_chatlet").on("click",function(e){"attDiv"==$(e.target).parent()[0].id&&("attAdd"!=e.target.id&&"att"!=$(e.target).parent()[0].id||(a.find("#attDiv")[0].className="addInv SC_floatLabel flFLabel clearfix flBox addUsers autoFilldata edit_parti",a.find("input").focus()))}),a.find(".msi-close").on("click",function(){$(this).parent("#att").remove()}),ZCL_autoCom(a)},ZCL_creatChatlet=function(e){var t=zcal.timeformat[zcal.cdata.opt.TF],a=!(!e.ADAY||1!=e.ADAY),l=e.SD,c=e.ED,i=a?"8:00 am":e.ST,n=a?"8:30 am":e.ET,r=i.getTimeBy(t),s=n.getTimeBy(t),d=ZCL_splitDateVal(ZCL_putDate(l)),o=ZCL_splitDateVal(ZCL_putDate(c)),u=ZCL_parseTime(r),p=ZCL_parseTime(s);ZCL_ESDATE=new Date(d[2],d[1]-1,d[0],u.HH,u.mm,0,0),ZCL_EEDATE=new Date(o[2],o[1]-1,o[0],p.HH,p.mm,0,0),e.rObj=new zcalRepeat,e.rObj.init(ZCL_ESDATE);var m=e.LOC,_="",z=ZCL_parseDateStr(l),f=ZCL_parseDateStr(c);_+=z.dateBy("NNN dd, yyyy"),_+=a?l!=c?" - "+f.dateBy("NNN dd, yyyy"):"":l!=c?", "+r+" - "+f.dateBy("NNN dd, yyyy")+", "+s:", "+r+" - "+s;var v=$("#zcl_chTit")[0].value,h="";for(var g in $("#attDiv")[0].childNodes)3<=$("#attDiv")[0].childNodes.length?"att"==$("#attDiv")[0].childNodes[g].id&&(h+=""==h?$("#attDiv")[0].childNodes[g].getAttribute("data-zid"):","+$("#attDiv")[0].childNodes[g].getAttribute("data-zid")):""!=$("#atInp")[0].value?ZCL_isEmail($("#atInp")[0].value)?zmUtil.succErrMsg("e","Add only org members"):zmUtil.succErrMsg("e","Please Enter a valid email"):zmUtil.succErrMsg("e","Please Enter attendee");e.EID;var C=e.CNAME,y=zcal.getCalObj(C)[10][2];ZCL_XHR("/cal/chatlet.do?mode=create&title="+v+"&att="+h+"&edate="+_+"&loc="+m+"&euid="+e.UID+"&caluid="+y,function(e){"success"==ZCL_Evl(1,e.responseText).status&&ZCL_closeChatlet()})},ZCL_autoCom=function(c){var i=$(c).find("#atInp");zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:i[0],contactType:"org",exclude:function(){var e=[];if($("#attDiv")[0])for(var t=$("#attDiv")[0].childNodes,a=0;a<t.length;a++)t[a].getElementsByTagName("SPAN")[0]&&e.push(t[a].getElementsByTagName("SPAN")[0].innerHTML);return e},excludeMe:!0,onSelect:function(e,t){t=t.item.attributes;var a=$(c).find("#attDiv"),l=document.createElement("div");l.className="SC_cs myInv dFill",l.setAttribute("data-zid",t.zid),l.setAttribute("id","att"),l.setAttribute("title",t.email),l.innerHTML='<div class="SC_avtr"><img src='+t.profileImage+"></div><span>"+t.email+'</span><i class="msi-close closePopup"></i></div>',a.prepend($(l)),$(i).val(""),$(l).find(".closePopup").on("click",function(){$(this).parent("#att").remove()})}})})},ZCL_closeChatlet=function(){zmsDialog.remove(!0);var e=$("#zcl_chatlet");0<e.length&&e.remove(),zmUtil.hideMenu()},ZCL_tooltip=function(e){e.elm.setAttribute("data-tooltip",e.text),e.elm.setAttribute("data-tooltip-pos",e.arrow)};var zcalRepeat=function(){function e(){this.frequency=-1,this.interval=1,this.option=0,this.date,this.month,this.day,this.week,this.until,this.count=0}return e.prototype={init:function(e){this.date=e&&e.getDate(),this.month=e&&e.getMonth(),this.day=e&&[e.getDay()],this.week=e&&Math.floor(this.date/7)},update:function(e){this.frequency=e&&e.RFRQ?e.RFRQ:this.frequency,this.interval=e&&e.RIVL?e.RIVL:this.interval,this.option=e&&e.ROPT?e.ROPT:this.option,this.date=e&&e.RDATE?e.RDATE:this.date,this.month=e&&e.RMON?e.RMON:this.month,this.week=e&&e.RTOWK?e.RTOWK:this.week,this.day=e&&e.RDAY?ZCL_rdaysInJSRep(e.RDAY):this.day,this.count=e&&0<e.RCNT?e.RCNT:this.count,this.until=e&&0==this.count&&0!=e.RUTL?e.RUTL:this.until},setFrequency:function(e){this.frequency=parseInt(e)},setInterval:function(e){this.interval=parseInt(e)},setOption:function(e){this.option=e},setDate:function(e){this.date=parseInt(e)},setMonth:function(e){this.month=parseInt(e)},setWeek:function(e){this.week=parseInt(e)},setDay:function(e){this.day=e},setCount:function(e){this.count=e},setUntil:function(e){this.until=e},getStr:function(){var e="",t=this.day.length;if(0==this.frequency)1==this.option?e+=zcal.i18n.ce_daily1:e+=1==this.interval?zcal.i18n.daily:ZCL_replaceString(zcal.i18n.ce_daily0,[" "+this.interval+" "]);else if(1==this.frequency){e+=1==this.interval?zcal.i18n.weekly:ZCL_replaceString(zcal.i18n.ce_yearly0,[" "+this.interval+" ",zcal.i18n.weeks]),e+=" "+zcal.i18n.on+" ";for(var a=0;a<this.day.length;a++){var l=parseInt(this.day[a]);e+=0!=a&&a!=t-1?", ":0!=a&&a==t-1?" & ":"",e+=Date.WEEK_DAYS[1][l]}}else 2==this.frequency?(e+=1==this.interval?1==this.option?"":zcal.i18n.monthly:ZCL_replaceString(zcal.i18n.ce_yearly0,[" "+this.interval+" ",zcal.i18n.months]),1==this.option?e+=ZCL_replaceString(zcal.i18n.mon_onthe,[" "+zcal.WEEK_TYPE[this.week]+" "+Date.WEEK_DAYS[0][this.day[t-1]]]):e+=" "+zcal.i18n.on+" "+zcal.i18n.day+" "+this.date):3==this.frequency&&(e+=1==this.interval?zcal.i18n.yearly:ZCL_replaceString(zcal.i18n.ce_yearly0,[" "+this.interval+" ",zcal.i18n.years]),1==this.option?e+=" "+zcal.i18n.on+" "+Date.MONTH_NAMES[0][this.month]+" "+zcal.WEEK_TYPE[this.week]+" "+Date.WEEK_DAYS[0][this.day[t-1]]:e+=" "+zcal.i18n.on+" "+Date.MONTH_NAMES[0][this.month]+" "+this.date);return this.count&&0!=this.count?e+=", "+this.count+" "+zcal.i18n.times:this.until&&0!=this.ZCL_REPUTL&&(e+=", "+zcal.i18n.repuntil+" "+ZCL_putDate(this.until)),""!=e?" ("+e+")":""},getReqObj:function(){if(-1==this.frequency)return null;var e={RFRQ:this.frequency,RIVL:this.interval,ROPT:this.option,RCNT:this.count&&0!=this.count?this.count:"",RUTL:this.until&&0!=this.until?this.until:"",RST:ZCL_DFDate(ZCL_$("zcl_ce_sd").value)},t=rtowk=rdate="",a=[];if(2!=this.frequency&&3!=this.frequency||1!=this.option)if(2!=this.frequency&&3!=this.frequency||0!=this.option){if(1==this.frequency)for(var l=0;l<this.day.length;l++)a[l]=parseInt(this.day[l])+1}else t=2==this.frequency?"":this.month,rdate=this.date;else t=2==this.frequency?"":this.month,rtowk=this.week,a[0]=parseInt(this.day[0])+1;return e.RTOWK=rtowk,e.RMON=t,e.RDATE=rdate,e.RDAY=a,e},reset:function(){this.frequency=-1,this.interval=1,this.option=0,this.date=null,this.month=null,this.day=null,this.week=null,this.until=null,this.count=0}},e}();ZCL_chgeRepOpt=function(e,t){var a=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;ZCL_stopEvents(t),"zcl_rep_span"==e.id?ZCL_openRepeatPP():(ZCL_ChgChk(e),"msi-check"==e.childNodes[0].className?ZCL_openRepeatPP():a.find("#zcl_rep_span")[0]&&(a.find("#zcl_rep_span")[0].innerHTML=""))},ZCL_openRepeatPP=function(){var e;zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_ce_rsec")[0]||$("body").append("<div id='zcl_ce_rsec' class='zcl_rpt'/>"),e=$("#zcl_ce_rsec");var t=_zm.getDOM(["UL",{child:[["LI",{attrs:{id:"zcl_rep_optpar"},child:[["text",zcal.i18n.repeats]]}],["LI",{child:[["UL",{attrs:{class:"zcl_CMS"},child:[["LI",{attrs:{class:"zcl_repsec",id:"zcl_repsec"}}]]}]]}]]}]);e.html(t),ZCL_constRepeatOpt();var a={title:zcal.i18n.repeat,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){ZCL_closeRepeat()},buttons:[{txt:zcal.i18n.done,callback:function(){ZCL_getRepeatData()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){ZCL_closeRepeat()}}]};zmsDialog.create("zcl_ce_rsec",a),ZCL_$("zcl_ce_rutl")&&ZEVENTS(ZCL_$("zcl_ce_rutl").parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:"zcl_ce_rutl",wkst:0,mode:"popup",update:"yes",minhgt:251}).bind()},ZCL_constRepeatOpt=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],a=document.createElement("select");a.id="zcl_ce_rfreq",a.className="select",ZCL_putValues(a,zcal.EOBJ[t].rObj.frequency,zcal.REPEAT_FREQ),a.addEventListener("change",function(){this.selectedIndex;ZCL_setRepeatCriteria(t,this.selectedIndex)});var l=document.createElement("div");l.className="SC_select",l.appendChild(a),$("#zcl_rep_optpar").append(l);var c=$("<ul><li id='zcl_rep_cri'></li><li></li><li></li><li id='zcl_rep_ends'></li></ul>");$(c.children()[1]).append($("<ul class='zcl_sp'><li></li></ul>")),$(c.children()[2]).append($("<ul class='zcl_adrept'><li>"+zcal.i18n.ends+"</li></ul>")),$("#zcl_repsec").append(c),zcal.EOBJ[t].rObj&&-1!=zcal.EOBJ[t].rObj.frequency&&e.find("#zcl_rep_span")[0]&&(e.find("#zcl_rep_span")[0].innerHTML=zcal.EOBJ[t].rObj.getStr()),ZCL_setRepeatCriteria(t,-1!=zcal.EOBJ[t].rObj.frequency?zcal.EOBJ[t].rObj.frequency:0),ZCL_setRepeatEnds(t)},ZCL_setRepeatEnds=function(e){var t=zcal.EOBJ[e].rObj,a=ZCL_$("zcl_rep_ends"),l=0<t.count?t.count:0,c=t.until?ZCL_putDate(t.until):0,i=document.createElement("UL");i.className="zcl_adrept",i.addEventListener("click",function(){ZCL_ChgRdo(this),ZCL_addTbox(this)}),i.appendChild($('<li class="zcl_curpt"><i class="'+(0==l&&0==c?"msi-option":"msi-unoption")+'"></i>'+zcal.i18n.noenddate+"</li>")[0]),a.appendChild(i);var n=document.createElement("UL");n.className="zcl_adrept",n.addEventListener("click",function(){ZCL_ChgRdo(this),ZCL_addTbox(this,0!=c?c:null)}),n.appendChild($('<li class="zcl_curpt"><i class="'+(0==l&&0!=c?"msi-option":"msi-unoption")+'"></i>'+zcal.i18n.until+"</li>")[0]),n.appendChild($('<li class="zcl_select" '+(0==l&&0!=c?"":'style="display:none"')+'><input type="text" class="SC_tiput" id="zcl_ce_rutl" value="'+c+'"></li>')[0]),a.appendChild(n);var r=document.createElement("UL");r.className="zcl_adrept",r.addEventListener("click",function(){ZCL_ChgRdo(this),ZCL_addTbox(this)}),r.appendChild($('<li class="zcl_curpt"><i class="'+(0!=l?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.fortimes,['<input type="text" id="zcl_ce_rcnt" maxlength="3" value="'+(0!=l?l:"")+'" class="zcl_rpdy SC_tiput">'])+"</li>")[0]),a.appendChild(r)},ZCL_setRepeatCriteria=function(e,t){var a=zcal.EOBJ[e].rObj;0==t?ZCL_dailyRepeatOption(a):1==t?ZCL_weeklyRepeatOption(a):2==t?ZCL_monthlyRepOption(a):3==t&&ZCL_yearlyRepeatOption(a)},ZCL_getRepeatData=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,t=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],a=zcal.EOBJ[t].rObj,l=ZCL_$("zcl_ce_rfreq").value,c=ZCL_$("zcl_rep_cri");if(a.setFrequency(l),0==l){var i=c.children[0].children[0],n=c.children[1].children[0];if("msi-option"==i.children[0].className){a.setOption(0);var r=i.children[1].value;if(isNaN(r)||""==r||r<=0)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),i.children[1].focus(),!1;a.setInterval(r)}else"msi-option"==n.children[0].className&&(a.setOption(1),a.setInterval(1))}else if(1==l){r=(i=c.children[0].children[0]).children[0].value;if(isNaN(r)||""==r||r<=0)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),i.children[0].focus(),!1;a.setInterval(r);var s=c.children[1].children;a.day=[];for(var d=0;d<s.length;d++)"msi-check"==s[d].children[0].className&&a.day.push(d);if(0==a.day.length)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),!1}else if(2==l){i=c.children[0].children[0],n=c.children[1].children[0];if("msi-option"==i.children[0].className){a.setOption(0);var o=i.children[1].value;if(isNaN(o)||""==o||o<1||o>ZCL_ESDATE.getDaysInMonth())return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),i.children[1].focus(),!1;a.setDate(o);r=i.children[2].value;if(isNaN(r)||""==r||r<=0)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),i.children[2].focus(),!1;a.setInterval(r)}else if("msi-option"==n.children[0].className){a.setOption(1),a.setWeek(n.children[1].children[0].value),a.setDay([n.children[2].children[0].value]);r=n.children[3].value;if(isNaN(r)||""==r||r<=0)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),n.children[3].focus(),!1;a.setInterval(r)}}else if(3==l){i=c.children[0].children[0],n=c.children[1].children[0];if(a.setInterval(1),"msi-option"==i.children[0].className){a.setOption(0);var u=i.children[1].children[0].value,p=i.children[2].value,m=ZCL_ESDATE.clone();if(m.setDate(1),m.setMonth(u),isNaN(p)||""==p||p<1||p>m.getDaysInMonth())return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),i.children[2].focus(),!1;a.setMonth(u),a.setDate(p)}else"msi-option"==n.children[0].className&&(a.setOption(1),a.setWeek(n.children[1].children[0].value),a.setDay([n.children[2].children[0].value]),a.setMonth(n.children[3].children[0].value))}var _=ZCL_$("zcl_rep_ends");if("msi-option"==_.children[1].children[0].children[0].className){if(!ZCL_dateValidate("zcl_ce_rutl",zcal.i18n.repun))return!1;if(!ZCL_dateComparison("zcl_ce_rutl",zcal.i18n.repun,"zcl_ce_ed",zcal.i18n.eveed,"GE"))return!1;a.setUntil(ZCL_DFDate(ZCL_$("zcl_ce_rutl").value)),a.setCount(0)}else if("msi-option"==_.children[2].children[0].children[0].className){var z=ZCL_$("zcl_ce_rcnt").value.trim();if(""==z)return zmUtil.succErrMsg("e",zcal.i18n.repeatcount),ZCL_$("zcl_ce_rcnt").focus(),!1;if(!ZCL_intValidate("zcl_ce_rcnt",zcal.i18n.repcount))return!1;a.setCount(parseInt(z)),a.setUntil(0)}else a.setUntil(0),a.setCount(0);var f=e.find("#zcl_rep_span")[0]||document.createElement("span");f.id="zcl_rep_span",f.className="zcl_lk",f.onclick=function(e){ZCL_chgeRepOpt(this,e)},f.innerHTML=a.getStr(),e.find("#zcl_rep")[0].appendChild(f),ZCL_closeRepeat()},ZCL_closeRepeat=function(e){e=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=zcal.EOBJ[e].rObj;zmsDialog.remove(!0);var l=ZCL_$("zcl_ce_rsec");l&&l.parentNode.removeChild(l),-1==a.frequency&&(t.find("#zcl_rep")[0].children[0].className="msi-uncheck")},ZCL_ChgRdo=function(e,t){for(var a=e.parentNode.childNodes,l=0;l<a.length;l++)"I"==a[l].childNodes[0].childNodes[0].tagName&&(a[l].childNodes[0].childNodes[0].className="msi-unoption");e.childNodes[0].childNodes[0].className="msi-option",t&&""!=t&&ZCL_Evl(0,t)},ZCL_addTbox=function(e,t){var a=e.parentNode.children[1];"msi-unoption"==a.children[0].children[0].className?a.children[1].style.display="none":(a.children[1].style.display="",a.children[1].children[0].value=t||zcal.$("zcl_ce_ed").value)},ZCL_dailyRepeatOption=function(e){var t=$("#zcl_rep_cri"),a=$("<ul class='zcl_adrept'/>"),l=$("<ul class='zcl_adrept'/>");t.empty(),a.on("click",function(){ZCL_ChgRdo(this)}),a.append('<li class="zcl_curpt"><i class="'+(0==e.option?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_daily0,['<input type="text" id="zcl_rivl0" value="'+e.interval+'" class="zcl_rpdy SC_tiput">'])+"</li>"),t.append(a),l.on("click",function(){ZCL_ChgRdo(this)}),l.append($('<li class="zcl_curpt"><i class="'+(1==e.option?"msi-option":"msi-unoption")+'"></i>'+zcal.i18n.ce_daily1+"</li>")),t.append(l)},ZCL_weeklyRepeatOption=function(e){var t=$("#zcl_rep_cri"),a=$("<ul class='zcl_adrept'/>"),l=$("<ul class='zcl_adrept zcl_adreptwk'/>");for(var c in t.empty(),a.append($('<li class="zcl_curpt">'+ZCL_replaceString(zcal.i18n.ce_weekly0,['<input type="text" id="zcl_rivl0" value="'+e.interval+'" class="zcl_rpdy SC_tiput">'])+"</li>")),t.append(a),Date.WEEK_DAYS[1]){var i=$('<li class="zcl_curpt" '+(0==c?"":'style="margin-left:10px;"')+"/>");i.html('<i class="'+(-1!=e.day.indexOf(parseInt(c))?"msi-check":"msi-uncheck")+'"></i>'+Date.WEEK_DAYS[1][c]),i.on("click",function(){ZCL_ChgChk(this)}),l.append(i)}t.append(l)},ZCL_monthlyRepOption=function(e){var t=$("#zcl_rep_cri"),a=$("<ul class='zcl_adrept'/>");_ele2=$("<ul class='zcl_adrept'/>"),l=e.day.length,t.empty(),a.on("click",function(){ZCL_ChgRdo(this)}),a.append($('<li class="zcl_curpt"><i class="'+(0==e.option?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_monthly0,['<input type="text" id="zcl_rmd" value="'+e.date+'" class="zcl_rpdy SC_tiput">','<input type="text" id="zcl_rivl0" value="'+e.interval+'" class="zcl_rpdy SC_tiput">'])+"</li>")),t.append(a),_ele2.on("click",function(){ZCL_ChgRdo(this)}),_ele2.append($('<li class="zcl_curpt"><i class="'+(1==e.option?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_monthly1,[ZCL_selBox("zcl_reps0",e.week,zcal.WEEK_TYPE,"wktype","zcl_stime"),ZCL_selBox("zcl_reps1",e.day[l-1],Date.WEEK_DAYS[0],"weekdays","zcl_sday"),'<input type="text" id="zcl_rivl0" value="'+e.interval+'" class="zcl_rpdy SC_tiput">'])+"</li>")),t.append(_ele2)},ZCL_yearlyRepeatOption=function(e){var t=$("#zcl_rep_cri"),a=$("<ul class='zcl_adrept'/>");_ele2=$("<ul class='zcl_adrept'/>"),l=e.day.length,t.empty(),a.on("click",function(){ZCL_ChgRdo(this)}),a.append($('<li class="zcl_curpt"><i class="'+(0==e.option?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_yearly0,[ZCL_selBox("zcl_mons0",e.month,Date.MONTH_NAMES[0],"months","zcl_sdate"),'<input type="text" id="zcl_rivl0" value="'+e.date+'" class="zcl_rpdy SC_tiput">'])+"</li>")),t.append(a),_ele2.on("click",function(){ZCL_ChgRdo(this)}),_ele2.append($('<li class="zcl_curpt"><i class="'+(1==e.option?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_yearly1,[ZCL_selBox("zcl_reps0",e.week,zcal.WEEK_TYPE,"wktype","zcl_stime"),ZCL_selBox("zcl_reps1",e.day[l-1],Date.WEEK_DAYS[0],"weekdays","zcl_sday"),ZCL_selBox("zcl_mons0",e.month,Date.MONTH_NAMES[0],"months","zcl_sdate")])+"</li>")),t.append(_ele2)},ZCL_showConfirm=function(e,t){var a=document.createElement("div");a.id="zcl_redit_confirm",a.className="zcl_rpt",a.innerHTML="delete"==e?zcal.i18n.rdelete_msg:zcal.i18n.redit_msg,document.body.appendChild(a);var l=[];l.push({txt:zcal.i18n.only,callback:function(){"delete"==e?(ZCL_quickDelRep(0,t),ZCL_closeREditConfirm()):"qedit"==e?zcalEDrag.editRep(0,t):(ZCL_subEvent("0"),ZCL_closeREditConfirm())}}),l.push({txt:zcal.i18n.redit0,callback:function(){"delete"==e?(ZCL_quickDelRep(1,t),ZCL_closeREditConfirm()):"qedit"==e?zcalEDrag.editRep(1,t):(ZCL_subEvent("1"),ZCL_closeREditConfirm())}}),t&&t.ustat&&"2"!=t.dperm||l.push({txt:zcal.i18n.redit1,callback:function(){"delete"==e?(ZCL_quickDelRep(2,t),ZCL_closeREditConfirm()):"qedit"==e?zcalEDrag.editRep(2,t):(ZCL_subEvent("2"),ZCL_closeREditConfirm())}});var c={title:"delete"==e?zcal.i18n.confirm_delete:zcal.i18n.confirm_edit,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){ZCL_closeREditConfirm(),ZCL_closeloding()},buttons:l};zmsDialog.create("zcl_redit_confirm",c)},ZCL_quickDelRep=function(e,t){var a=t.rel,l=a.substring(0,a.indexOf("_")),c=(t.ekey,t.calId,zcalEvents.remEve(l,!0,!1)),i=!1;(c=c||zcalEvents.remEve(l,!1,!1))&&1==c[l].USTAT&&(i=!0),i?ZCL_shQKNtfyAttForRep(e,!0,t):ZCL_delRep(e,t)},ZCL_closeREditConfirm=function(){zmsDialog.remove(!0);var e=ZCL_$("zcl_redit_confirm");e&&e.parentNode.removeChild(e),ZCL_clrStck(),zcalView.plotEvents()};var zcalAlarm=function(){"use strict";function i(e,t,a){var l="";for(var c in a)l+='<option value="'+c+'" '+(c==t?"selected='true'":"")+">"+a[c]+"</option>";e.innerHTML=l}var e=["300000","600000","900000","1200000","1500000","1800000","2700000","3600000","7200000","14400000","21600000","28800000","43200000","86400000","172800000","259200000","345600000","432000000","518400000","604800000","691200000","777600000","864000000","950400000","1036800000","1123200000","1209600000","1296000000","2592000000","3888000000","5184000000","7776000000"];function t(){this.actionType="0",this.reminderType="0",this.reminderTime=e[0]}return t.prototype.set=function(e){this.actionType=e&&e.ACTYPE,this.reminderType=e&&e.REMTYPE,this.reminderTime=e&&e.REMTIME},t.prototype.getDOM=function(e){var t,a,l,c=$('<ul><li><div class="SC_select"><select class="select"></select></div></li><li><div class="SC_select"><select class="select"></select></div></li><li><div class="SC_select"><select class="select"></select></div></li><li><i class="msi-close" title='+zcal.i18n.remove+"></i></li></ul>")[0];return l=c.children[0].children[0].children[0],i(l,this.reminderTime,zcal.REMSTR),a=c.children[1].children[0].children[0],i(a,this.reminderType,zcal.ALARM_REMTYPE),t=c.children[2].children[0].children[0],i(t,this.actionType,zcal.ALARM_ACTTYPE),c.children[3].addEventListener("click",function(){var e=this.parentNode.parentNode;e.removeChild(this.parentNode),e.querySelector("#zcl_addrem")||ZCL_AppendRemAddLnk(e)}),"dom"===e?c:"string"===e?c.outerHTML:void 0},t}();function ZCL_isPasteve(e,t,a){var l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;l=l.find("#zcl_ce")[0]?l:a||"";var c=!1,i=ZCL_splitDateVal(-1==e.indexOf("_ed")?e:ZCL_getObj(e,l).value.replace(/^\s+/g,"").replace(/\s+$/g,"")),n=new Date;n.setYear(i[2]),n.setMonth(i[1]-1),n.setDate(i[0]);var r=0==t?"2300":-1==t.indexOf("_et")?t:ZCL_getObj(t,l).value.replace(/^\s+/g,"").replace(/\s+$/g,"");r=ZCL_parseTime(r),n.setHours(r.HH,r.mm,0,0);var s=n.getTime();return zcal.cdate>s&&(c=!0),c}function ZCL_dateTimeComparison(e,t,a,l,c,i,n){var r=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,""),s=ZCL_getObj(l).value.replace(/^\s+/g,"").replace(/\s+$/g,""),d=ZCL_splitDateVal(r),o=ZCL_splitDateVal(s);dd1=d[0],mm1=d[1],yyyy1=d[2],dd2=o[0],mm2=o[1],yyyy2=o[2];var u=ZCL_getObj(t).value.replace(/^\s+/g,"").replace(/\s+$/g,"");u=ZCL_TimetoNo(u);var p=ZCL_getObj(c).value.replace(/^\s+/g,"").replace(/\s+$/g,"");p=ZCL_TimetoNo(p);var m=parseInt(u/100,10),_=parseInt(p/100,10),z=p%100;return!!ZCL_compareDates(new Date(yyyy1,mm1-1,dd1,m,u%100,0,0),a,new Date(yyyy2,mm2-1,dd2,_,z,0,0),i,n)||(ZCL_getObj(e).focus(),!1)}function ZCL_dateValidate(e,t){if(0==ZCL_patternValidate(e,t,"DATE"))return!1;dateval=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,"");var a=ZCL_splitDateVal(dateval);if(dd=a[0],mm=a[1],yyyy=a[2],dd<1||31<dd||mm<1||12<mm||yyyy<1||yyyy<1e3)return zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[t])),ZCL_getObj(e).focus(),!1;if(2==mm&&29<dd)return zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[t])),ZCL_getObj(e).focus(),!1;if(2==mm&&28<dd&&yyyy%4!=0)return zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[t])),ZCL_getObj(e).focus(),!1;switch(parseInt(mm)){case 2:case 4:case 6:case 9:case 11:if(30<dd)return zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[t])),ZCL_getObj(e).focus(),!1}return!0}function ZCL_dateComparison(e,t,a,l,c){var i=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,""),n=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,""),r=ZCL_splitDateVal(i),s=ZCL_splitDateVal(n);return dd1=r[0],mm1=r[1],yyyy1=r[2],dd2=s[0],mm2=s[1],yyyy2=s[2],!!ZCL_compareDates(new Date(yyyy1,mm1-1,dd1,0,0,0,0),t,new Date(yyyy2,mm2-1,dd2,0,0,0,0),l,c)||(ZCL_getObj(e).focus(),!1)}function ZCL_patternValidate(e,t,a){var l=ZCL_getObj(e);if("EMAIL"==a.toUpperCase()){l.value=l.value.trim();var c=/^[a-zA-Z0-9]([\w\-\.\+]*)@([\w\-\.]*)(\.[a-zA-Z]{2,8}(\.[a-zA-Z]{2}){0,2})$/i}else if("DATE"==a.toUpperCase())switch(zcal.DFORMAT[zcal.cdata.opt.DF]){case"yyyy/MM/dd":case"yyyy-MM-dd":c=/^\d{4}(\-|\/|\.)\d{1,2}\1\d{1,2}$/;break;case"MM/dd/yyyy":case"dd/MM/yyyy":c=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{4}$/}else if("TIME"==a.toUpperCase())c=/^\d{1,2}\:\d{1,2}$/;return!!c.test(l.value)||(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[t])),l.focus(),!1)}function ZCL_splitDateVal(e){var t,a=new Array(3);switch(0<=e.indexOf("-")?t="-":0<=e.indexOf(".")?t=".":0<=e.indexOf("/")&&(t="/"),zcal.DFORMAT[zcal.cdata.opt.DF]){case"yyyy/MM/dd":case"yyyy-MM-dd":a[0]=e.substr(e.lastIndexOf(t)+1,e.length),a[1]=e.substring(e.indexOf(t)+1,e.lastIndexOf(t)),a[2]=e.substring(0,e.indexOf(t));break;case"MM/dd/yyyy":a[0]=e.substring(e.indexOf(t)+1,e.lastIndexOf(t)),a[1]=e.substring(0,e.indexOf(t)),a[2]=e.substr(e.lastIndexOf(t)+1,e.length);break;case"dd/MM/yyyy":a[0]=e.substring(0,e.indexOf(t)),a[1]=e.substring(e.indexOf(t)+1,e.lastIndexOf(t)),a[2]=e.substr(e.lastIndexOf(t)+1,e.length)}return a}function ZCL_compareDates(e,t,a,l,c){var i=!0;switch(c){case"L":a<=e&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.shlethn,[t,t])),i=!1);break;case"LE":a<e&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.shlethoreq,[t,l])),i=!1);break;case"E":e!=a&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.sheqto,[t,l])),i=!1);break;case"G":e<=a&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.shgrthn,[t,l])),i=!1);break;case"GE":e<a&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.shgrthoreq,[t,l])),i=!1)}return 0!=i}function ZCL_intValidate(e,t){var a=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,"");return isNaN(a)||-1!=a.indexOf(".")?(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.invd,[t])),ZCL_getObj(e).focus(),!1):!(a<1||999<a)||(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.outrge,[t])),!1)}ZCL_getObj=function(a){function e(e,t){return a.apply(this,arguments)}return e.toString=function(){return a.toString()},e}(function(e,t){var a,l,c;if(t=t||document,null!=e&&0<(a=e.indexOf("?"))&&parent.frames.length&&(t=parent.frames[e.substring(a+1)].document,e=e.substring(0,a)),!(c=t[e])&&t.all&&(c=t.all[e]),t.forms)for(l=0;!c&&l<t.forms.length;l++)c=t.forms[l][e];for(l=0;!c&&t.layers&&l<t.layers.length;l++)c=ZCL_getObj(e,t.layers[l].document);return!c&&t.getElementById&&(c=t.getElementById(e)),!c&&t.find&&(c=t.find("#"+e)[0]),c});var ZCL_ESDATE=new Date,ZCL_EEDATE=new Date;function ZCL_dateTimeValidate(e,t,a,l){ZCL_getObj(e);if(0==ZCL_patternValidate(e,a,"DATE"))return!1;dateval=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,"");var c=ZCL_splitDateVal(dateval);if(dd=c[0],mm=c[1],yyyy=c[2],dd<1||31<dd||mm<1||12<mm||yyyy<1||yyyy<1e3)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[a])),ZCL_getObj(e).focus(),!1;if(2==mm&&29<dd)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[a])),ZCL_getObj(e).focus(),!1;if(2==mm&&28<dd&&!ZCL_isLeapYear(yyyy))return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[a])),ZCL_getObj(e).focus(),!1;switch(parseInt(mm,10)){case 2:case 4:case 6:case 9:case 11:if(30<dd)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[a])),ZCL_getObj(e).focus(),!1}var i=ZCL_getObj(e+"_time"),n=i.value.toLowerCase();return n=n.replace(/\D/gi,""),!isNaN(n)||(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[a])),i.focus(),!1)}function ZCL_isLeapYear(e){return e%400==0||e%100!=0&&e%4==0}function ZCL_crmIntValidate(e,t){if(null==ZCL_getObj(e)||0==ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length)return!0;var a=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,"");return isNaN(a)||-1!=a.indexOf(".")||!/^\d+(,(\d)+)*$/.test(a)?(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),ZCL_getObj(e).focus(),!1):(ZCL_getObj(e).value=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,""),!0)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ZCL_calcEed=function(e,t,a){var l=a?$(a):zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c=l.find("#zcl_ce_sd")[0]?l.find("#zcl_ce_sd")[0].value.trim():ZCL_$("zcl_ce_sd").value.trim(),i=l.find("#zcl_ce_st")[0]?l.find("#zcl_ce_st")[0].value:ZCL_$("zcl_ce_st").value;if(""!=c){t&&ZCL_CRTim(e);var n=ZCL_parseTime(i),r=ZCL_splitDateVal(c),s=new Date(r[2],r[1]-1,r[0],n.HH,n.mm,0,0),d=s.getTime()-ZCL_ESDATE.getTime();ZCL_EEDATE.setTime(ZCL_EEDATE.getTime()+d),l.find("#zcl_ce_ed")[0]?l.find("#zcl_ce_ed")[0].value=ZCL_EEDATE.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]):$("#zcl_ce_ed")[0].value=ZCL_EEDATE.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),l.find("#zcl_ce_et")[0]?l.find("#zcl_ce_et")[0].value=ZCL_EEDATE.dateBy(zcal.timeformat[zcal.cdata.opt.TF]):$("#zcl_ce_et")[0].value=ZCL_EEDATE.dateBy(zcal.timeformat[zcal.cdata.opt.TF]),ZCL_ESDATE=s.clone()}},ZCL_setEed=function(e,t,a){var l=a?$(a):zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c=l.find("#zcl_ce_ed")[0]?l.find("#zcl_ce_ed")[0].value.trim():ZCL_$("zcl_ce_ed").value,i=l.find("#zcl_ce_et")[0]?l.find("#zcl_ce_et")[0].value:ZCL_$("zcl_ce_et").value;if(""!=c){t&&ZCL_CRTim(e);var n=ZCL_splitDateVal(c),r=ZCL_parseTime(i);(ZCL_EEDATE=new Date(n[2],n[1]-1,n[0],r.HH,r.mm,0,0))<=ZCL_ESDATE&&(ZCL_ESDATE.getTime()-ZCL_EEDATE.getTime()>=zcal.MSPERHOUR?ZCL_EEDATE.setDate(ZCL_ESDATE.getDate()):ZCL_EEDATE.setDate(ZCL_ESDATE.getDate()+1),l.find("#zcl_ce_ed")[0]?l.find("#zcl_ce_ed")[0].value=ZCL_EEDATE.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]):$("#zcl_ce_ed")[0].value=ZCL_EEDATE.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]))}},ZCL_isEmail=function(e){e=e.trim();return/^[\w]([\w\-\.\+\'\/]*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})$/i.test(e)},ZCL_crmFormValidate=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(""==e.find("#zcl_ce_tit")[0].value.trim())return _zm.succErrMsg("e",zcal.i18n.plenttle),e.find("#zcl_ce_tit")[0].focus(),!1;if(!ZCL_dateValidate("zcl_ce_sd",zcal.i18n.evest)||!ZCL_dateValidate("zcl_ce_ed",zcal.i18n.eveed))return!1;if(!ZCL_dateTimeComparison("zcl_ce_ed","zcl_ce_et",zcal.i18n.eveed,"zcl_ce_sd","zcl_ce_st",zcal.i18n.evest,"G"))return!1;for(var t=e.find("#zcl_crmfldname")[0].value.split(";"),a=e.find("#zcl_crmfldtype")[0].value.split(";"),l=e.find("#zcl_crmfldlabel")[0].value.split(";"),c=0;c<t.length;c++){var i=a[c].split("~"),n="zcl_"+t[c];if("M"==i[1]&&null!=ZCL_$(n)&&!ZCL_emptyCheck(n,l[c]))return!1;switch(i[0]){case"O":case"V":case"C":break;case"E":if(null!=ZCL_getObj(n)&&0!=ZCL_getObj(n).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!ZCL_emailValidate(n,l[c]))return!1;break;case"DT":if(null!=ZCL_getObj(n)&&0!=ZCL_getObj(n).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){var r=void 0===i[3]?"OTH":i[3];if(!ZCL_dateTimeValidate(n,i[2],l[c],r))return!1}break;case"D":if(null!=ZCL_getObj(n)&&0!=ZCL_getObj(n).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){r=void 0===i[2]?"OTH":i[2];if(!ZCL_crmDateValidate(n,l[c],r))return!1}break;case"I":if(null!=ZCL_getObj(n)&&0!=ZCL_getObj(n).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!ZCL_crmIntValidate(n,l[c]))return!1;break;case"DE":if(null!=ZCL_getObj(n)&&0!=ZCL_getObj(n).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){var s=void 0===i[2]?"any":i[2];if(!ZCL_decimalValidate(n,l[c],s))return!1}break;case"N":if(null!=ZCL_getObj(n)&&0!=ZCL_getObj(n).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){s=void 0===i[2]?"any":i[2];if(!ZCL_numValidate(n,l[c],s))return!1}break;case"P":if(null!=ZCL_getObj(n)&&0!=ZCL_getObj(n).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!ZCL_phoneValidate(n,l[c]))return!1;break;case"W":if(null!=ZCL_getObj(n)&&0!=ZCL_getObj(n).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!ZCL_isValidWebURL(n,l[c]))return!1}}return!0},ZCL_emptyCheck=function(e,t){var a=ZCL_getObj(e);if(null==a||0!=a.value.replace(/^\s+/g,"").replace(/\s+$/g,"").length||a.disabled)return!0;_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_emptychk,[t]));try{a.focus()}catch(e){}return!1},ZCL_isValidWebURL=function(e,t){var a=ZCL_getObj(e),l=a.value;return!!new RegExp("^(http:\\/\\/www.|https:\\/\\/www.|ftp:\\/\\/www.|www.|http:\\/\\/|https:\\/\\/|ftp:\\/\\/|){1}[a-zA-Z0-9--]+(\\.[a-zA-Z0-9-\\_\\#\\:\\;\\?]+)+(/[\\w-\\;\\-\\*\\._\\?\\,\\:\\'/\\\\\\+&amp;%\\$#\\=~@-]*)*$").test(l)||(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),a.focus(),!1)},ZCL_phoneValidate=function(e,t){var a=ZCL_getObj(e);return!!/^[0-9a-zA-Z!#%\*\^\(\)=\{\}\[\]\?`~_\-\.\$@\?\,\:\'\/\!\P{InBasicLatin}\s\+\|\\]+$/.test(a.value.trim())||(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),a.focus(),!1)},ZCL_crmDateValidate=function(e,t){ZCL_getObj(e);if(0==ZCL_patternValidate(e,t,"DATE"))return!1;dateval=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,"");var a=ZCL_splitDateVal(dateval);if(dd=a[0],mm=a[1],yyyy=a[2],dd<1||31<dd||mm<1||12<mm||yyyy<1||yyyy<1e3)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),ZCL_getObj(e).focus(),!1;if(2==mm&&29<dd)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),ZCL_getObj(e).focus(),!1;if(2==mm&&28<dd&&!isLeapYear(yyyy))return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),ZCL_getObj(e).focus(),!1;switch(parseInt(mm,10)){case 2:case 4:case 6:case 9:case 11:if(30<dd)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),ZCL_getObj(e).focus(),!1}return!0},ZCL_emailValidate=function(e,t){return 0!=ZCL_patternValidate(e,t,"EMAIL")},ZCL_numValidate=function(e,t,a){var l=ZCL_getObj(e),c=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,"");if(null==l||0==l.value.replace(/^\s+/g,"").replace(/\s+$/g,"").length)return!0;var i=/^-?\d+((\d)+)*(\.\d{1,2})?$/;if("any"!=a&&0!=parseInt(a)){var n="^-?\\d+((\\d)+)*(\\.\\d{1,"+(a=a.split(","))[0]+"})?$";i=new RegExp(n)}return i.test(c)?(l.value=c,!0):(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),l.focus(),!1)},ZCL_decimalValidate=function(e,t,a){var l=ZCL_getObj(e);if(null==l||0==l.value.replace(/^\s+/g,"").replace(/\s+$/g,"").length)return!0;var c=l.value.replace(/^\s+/g,"").replace(/\s+$/g,""),i=/^-?\d+(\.\d\d*)*$/;return"any"!=a&&0!=parseInt(a)&&(i=new RegExp("^-?\\d+((\\d)+)*(\\.\\d{1,"+a+"})?$")),!!i.test(c)||(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[t])),l.focus(),!1)},ZCL_clearId=function(e){ZCL_$(e).value=""};var zcalFreebusy=function(){function t(e,t){a&&window.clearTimeout(a),0<e&&(D<0?(D+=20,ZCL_$("zcl_fbdtgrid").style.left=D+"px",ZCL_$("zcl_fbgrid").style.left=D+"px",e-=20,a=setTimeout(function(){zcalFreebusy.scrollLeft(e,t)},1),t.className=""):(D=0,ZCL_$("zcl_fbdtgrid").style.left=D+"px",ZCL_$("zcl_fbgrid").style.left=D+"px",t.className="zcl_dis"),0==e&&(ZCL_$("zcl_fbrgtnv").className="",O("left")))}function n(){isFreeBusyClicked=!1,zmsDialog.remove(!0),o={},i={},L=[],E={},y=[],$.unsubscribe("/calendar/fillfb"),c&&c.remove(),c=null}var c,m,_,u,p,z,f,v=!1,h=0,g=23,C=1,o={},y=[],i={},L=[],b=[],E={},a=null,T=0,D=0,l=0,Z=1,A=onedayAllTimeWidth=0,r=function(e){var t=e.email,a=e.date,l=e.fbdata,c=o[a][t]||new j;c.setFBSlot({fbslot:l}),o[a][t]=c;var i=L.indexOf(t);if(ZCL_$("zcl_fb"+a)&&-1!=i){var n=ZCL_$("zcl_fb"+a);n.replaceChild(c.$el[0],n.childNodes[i])}},s=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;f=zcal.cdata.opt.MID;var t=ZCL_getFullAttendee();""!==t&&(L=t.split(",")),ZCL_in_array(zcal.cdata.opt.MID,L)||L.splice(0,0,zcal.cdata.opt.MID),b=L.slice();var a=ZCL_splitDateVal(e.find("#zcl_ce_sd")[0].value);v="msi-check"==e.find("#zcl_ce_aday")[0].className;var l=new Date;if(l.setYear(a[2]),l.setMonth(a[1]-1),l.setDate(a[0]),l.setHours(0,0,0,0),!v){var c=ZCL_parseTime(e.find("#zcl_ce_st")[0].value);l.setHours(c.HH,c.mm,0,0)}m=l.clone(),m.dateBy("HHmm");var i=ZCL_splitDateVal(e.find("#zcl_ce_ed")[0].value),n=new Date;if(n.setYear(i[2]),n.setMonth(i[1]-1),n.setDate(i[0]),n.setHours(0,0,0,0),!v){var r=ZCL_parseTime(e.find("#zcl_ce_et")[0].value);n.setHours(r.HH,r.mm,0,0)}_=n.clone(),_.dateBy("HHmm"),Z=Math.ceil((_-m)/18e5),Z+=v?48:0,(new Date).setTime(zcal.cdate),z=l.clone(),y=function(){var e=new Date;e.setTime(z.getTime());var t=e.clone();t.setDate(1),t.setHours(0,0,0,0);var a=e.clone();return a.setMonth(a.getMonth()+2),a.setDate(a.getDaysInMonth()),a.setHours(0,0,0,0),[t,a]}(),U(),function(){for(var e=y[0].clone();e<=y[1];){var t=e.dateBy("yyyyMMdd");E[t]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e.setDate(e.getDate()+1)}}(),(u=z.clone()).setDate(u.getDate()-4),u.setHours(0,0,0,0),u<y[0]&&(u=y[0].clone()),(p=z.clone()).setDate(p.getDate()+6),p.setHours(0,0,0,0),p>y[1]&&(p=y[1].clone()),h=parseInt(zcal.cdata.opt.HS),g=parseInt(zcal.cdata.opt.HE);var s=m.getHours(),d=_.getHours();(s<h||g<s||d<h||g+1<d)&&(C=0),onedayAllTimeWidth=1450,A=60*(g-h+1)+10;var o=ZCL_daysBetween(u.dateBy("yyyyMMdd"),m.dateBy("yyyyMMdd"));T=m.getHours(),D=0==C?-(o*onedayAllTimeWidth+60*T):-(o*A+60*(T-h))},d=function(){for(var e,t,a="",l=!1,c=0;c<Z;c++)a+="0";var i=_.clone(),n=1===C?2*(_.getHours()-h):2*_.getHours();for(n+=0<_.getMinutes()?1:0;i<=y[1];){I(1);var r=i.dateBy("yyyyMMdd");if(E[r]){var s=(0===C?E[r]:E[r].slice(2*h,2*(g+1))).join(""),d=r===_.dateBy("yyyyMMdd")?n:0,o=s.indexOf(a,d);if(-1!=o){(e=i.clone()).setHours(0,0,0,0),1===C&&(o=2*h+o),t=o,l=!0;break}}i.setDate(i.getDate()+1)}if(l){var u=(t-t%2)/2,p=t%2?30:0;(m=e.clone()).setHours(u,p,0,0),_.setTime(m.getTime()+30*Z*60*1e3),T=m.getHours(),M()}},M=function(){var e=Math.ceil((_-m)/18e5)+(v?48:0);if(e<48){var t=ZCL_daysBetween(u.dateBy("yyyyMMdd"),m.dateBy("yyyyMMdd"))*(0===C?onedayAllTimeWidth:A);t+=60*(0===C?T:h<=T&&T<=g?T-h:0)+(0<m.getMinutes()?30:0);var a=ZCL_$("zcl_fbsslot")||document.createElement("SPAN"),l=Math.abs(D);if(a.id="zcl_fbsslot",a.style.left=t+"px",a.style.width=30*e+"px",ZCL_$("zcl_fbgrid").appendChild(a),0!=l&&600<=t-l)S(t-l-(t-l)%20,ZCL_$("zcl_fbrgtnv"))}},S=function(e,t){a&&window.clearTimeout(a),0<e&&(-l<D?(D-=20,ZCL_$("zcl_fbdtgrid").style.left=D+"px",ZCL_$("zcl_fbgrid").style.left=D+"px",e-=20,a=setTimeout(function(){zcalFreebusy.scrollRight(e,t)},1),t.className=""):(D=-l,ZCL_$("zcl_fbdtgrid").style.left=D+"px",ZCL_$("zcl_fbgrid").style.left=D+"px",t.className="zcl_dis"),0==e&&(ZCL_$("zcl_fblftnv").className="",O("right")))},k=function(e){S(600,e)},w=function(e){t(600,e)},O=function(e){var t=Math.abs(D),a=1;if(0==C){c=t%onedayAllTimeWidth,onedayAllTimeWidth;var l=(c-c%60)/60;T=l=0<c%60?l+1:0}else{a=600<A?1:Math.round(600/A);var c;c=t%A;T=l=h<=(l=(l=(c-c%60)/60)+h+(0<c%60?1:0))&&l<=g?l:0}"right"===e&&I(a)},I=function(e){for(var t=p.clone(),a=0,l=$("#zcl_fbdtgrid");a<e;){t.setDate(t.getDate()+1);var c=t.dateBy("yyyyMMdd");if(!ZCL_$("zcl_fb"+c)&&t<=y[1]){var i=x(t);l.append(i);for(var n=0;n<L.length;n++){var r=L[n],s=o[c][r]||new j,d=ZCL_$("zcl_fb"+c)||document.createElement("DIV");d.id="zcl_fb"+c,d.appendChild(s.$el[0]),ZCL_$("zcl_fbgrid").appendChild(d),o[c][r]=s}p=t.clone()}a++}P()},x=function(e){var t=$("<div/>");t.append("<s>"+e.dateBy("MMM dd, yyyy")+"</s>");for(var a=$("<ul/>"),l=0;l<24;l++){var c=l<h||g<l?"class='"+(0==C?"zcl_tmp":"zcl_fbhdn")+"'":"";a.append("<li "+c+">"+zcal.TT[l]+"</li>")}return t.append(a),t},N=function(){ZCL_$("zcl_freebusy")||$("body").append("<ul id='zcl_freebusy' class='zcl_fb'/>"),(c=$("#zcl_freebusy")).html("");var e=function(){var e=$("<li class='zcl_table'></li>"),t=$("<ul class='zcl_fbnv'></ul>"),a=$("<li></li>"),l=48<=Z?"zcl_lk zcl_dis":"zcl_lk";a.html('<span class="'+l+'">'+zcal.i18n.find_next_freetime+"</span>"),Z<48&&a.bind("click",function(){d()}),t.append(a);var c=document.createElement("select");c.className="select",ZCL_putValues(c,C,{0:zcal.i18n.alltimes,1:zcal.i18n.workinghours}),c.addEventListener("change",function(){C=c.selectedIndex;var e=Math.abs(D);if(0==C){var t=(e-e%A)/A;$(".zcl_fbhdn").removeClass("zcl_fbhdn").addClass("zcl_tmp"),D=-(t*onedayAllTimeWidth+60*T)}else{t=(e-e%onedayAllTimeWidth)/onedayAllTimeWidth;var a=h<=T&&T<=g?T-h:0;$(".zcl_tmp").removeClass("zcl_tmp").addClass("zcl_fbhdn"),D=-(t*A+60*a)}ZCL_$("zcl_fbdtgrid").style.left=D+"px",ZCL_$("zcl_fbgrid").style.left=D+"px",M()});var i=document.createElement("div");i.className="SC_select",i.appendChild(c);var n=$("<li></li>").append(i);return t.append(n),e.append(t),e}();c.append(e);var t=function(){var e=$("<li class='zcl_table'></li>"),t=$("<ul class='zcl_fbtime'></ul>"),a=$("<li></li>");a.append($("<span>"+zcal.i18n.attendee+"</span>"));var l=$("<u/>");l.html("<i class='msi-add'></i>"),l.bind("click",function(e){var t=$("<input type='text' id='zcl_fbadd'/>"),a={contentArray:"",compare:["fn","ln","nn","eid"],LType:"1",OType:"1",drag:!1,actionCallback:zcalFreebusy.getSelectedEmail};zmAutoFill.setAutofill(a,t),$par=$(this).parent(),$par.empty(),$par.append($("<div/>").append(t)),t.focus()}),a.append(l),t.append(a);var c=$("<li></li>"),i=$("<u id='zcl_fblftnv'></u>"),n=$("<u id='zcl_fbrgtnv'></u>");i.html("<i class='msi-larrow'></i>"),i.bind("click",function(){w(this)}),n.html("<i class='msi-rarrow'></i>"),n.bind("click",function(){k(this)}),c.append(i),c.append(n);for(var r=$("<div id='zcl_fbdtgrid'/>"),s=y[0].clone();s<=y[1];){if(u<=s&&s<=p){var d=x(s);r.append(d)}o[s.dateBy("yyyyMMdd")]={},s.setDate(s.getDate()+1)}return c.append(r),t.append(c),e.append(t),e}();c.append(t);var a=$('<li class="zcl_fbhgt"><div class="zcl_table"><ul class="zcl_fbgrid"><li><div id="zcl_fbatt" class="zcl_table"></div></li><li><div id="zcl_fbgrid"></div></li></ul></div></li>');c.append(a);var l={title:zcal.i18n.freebusytime,style:{left:"500px",top:"100px","max-width":"900px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){zcalFreebusy.cleanUp()},buttons:[{txt:zcal.i18n.ok,callback:function(){zcalFreebusy.getSelAttendee()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){zcalFreebusy.cleanUp()}}]};zmsDialog.create("zcl_freebusy",l)},R=function(e){var t=document.createElement("UL");if(t.appendChild($("<li>"+e+"</li>")[0]),e!==f){var a=$("<li><i class='msi-delete'></i></li>");a.bind("click",function(){this.parentNode.parentNode.removeChild(this.parentNode),zcalFreebusy.removeAttedee(e)}),t.appendChild(a[0])}else t.appendChild($("<li/>")[0]);ZCL_$("zcl_fbatt").appendChild(t);for(var l=u.clone();l<=p;){var c=l.dateBy("yyyyMMdd"),i=o[c][e]||new j,n=ZCL_$("zcl_fb"+c)||document.createElement("DIV");n.id="zcl_fb"+c,n.appendChild(i.$el[0]),ZCL_$("zcl_fbgrid").appendChild(n),o[l.dateBy("yyyyMMdd")][e]=i,l.setDate(l.getDate()+1)}ZCL_$("zcl_fbdtgrid").style.left=D+"px",ZCL_$("zcl_fbgrid").style.left=D+"px",M(),P()},P=function(){var e=ZCL_daysBetween(u.dateBy("yyyyMMdd"),p.dateBy("yyyyMMdd"))+1;l=0==C?e*onedayAllTimeWidth-ZCL_$("zcl_fbgrid").offsetWidth:e*A-ZCL_$("zcl_fbgrid").offsetWidth},H=function(e){ZCL_XHR("/cal/userFB.do?uemail="+e.email.zcalescape()+"&date="+e.date+"&month="+e.month+"&year="+e.year,zcalFreebusy.getFBRes)},U=function(){$.subscribe("/calendar/fillfb",function(e,t){!function(e){var t=e.date,a=e.fbdata;if(a[0])E[t]=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];else if(a[1])for(var l=0;l<a[1].length;l++)for(var c=a[1][l].split("-"),i=c[0];i<c[1];i++)E[t][i]=1}(t)})},j=function(e){this.fbslot=[],this.$el=$("<ul/>"),this.setFBSlot(e)};return j.prototype={setFBSlot:function(e){this.$el.empty();var t=e&&e.fbslot?e.fbslot:[];if(0<t.length){if(t[0])for(var a=0;a<24;a++){this.fbslot.push([1,1]);var l=a<h||g<a?"class='"+(0==C?"zcl_tmp":"zcl_fbhdn")+"'":"";this.$el.append($("<li "+l+"><b></b><b></b></li>"))}else if(t[1]){for(a=0;a<t[1].length;a++)for(var c=t[1][a].split("-"),i=c[0];i<c[1];i++){var n=(i-i%2)/2,r=i%2!=0?1:0;this.fbslot[n][r]=1}for(a=0;a<24;a++){l=a<h||g<a?"class='"+(0==C?"zcl_tmp":"zcl_fbhdn")+"'":"";var s="";for(i=0;i<this.fbslot[a].length;i++)s+=1==this.fbslot[a][i]?"<b></b>":"<u></u>";this.$el.append($("<li "+l+">"+s+"</li>"))}}}else for(a=0;a<24;a++){this.fbslot.push([0,0]);l=a<h||g<a?"class='"+(0==C?"zcl_tmp":"zcl_fbhdn")+"'":"";this.$el.append($("<li "+l+"><u></u><u></u></li>"))}}},{loadFB:function(){isFreeBusyClicked=!0,s(),N();for(var e=0;e<L.length;e++){var t=L[e];i[t]||(i[t]=!1,R(t),H({email:t,date:z.getDate(),month:z.getMonth()+1,year:z.getFullYear()}))}},getFBRes:function(e){var t=ZCL_Evl(1,e.responseText);for(var a in t){var l=t[a];if(i[a]=!0,"object"===_typeof(l))for(var c in l)$.publish("/calendar/fillfb",{date:c,fbdata:l[c]}),r({email:a,date:c,fbdata:l[c]})}},cleanUp:n,getSelAttendee:function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(e.find("#zcl_ce_sd")[0].value=ZCL_putDate(m.dateBy("yyyyMMdd")),e.find("#zcl_ce_ed")[0].value=ZCL_putDate(_.dateBy("yyyyMMdd")),!v){var t=zcal.timeformat[zcal.cdata.opt.TF];e.find("#zcl_ce_st")[0].value=m.dateBy("HHmm").getTimeBy(t),e.find("#zcl_ce_et")[0].value=_.dateBy("HHmm").getTimeBy(t)}for(var a=0;a<L.length;a++)if(!ZCL_in_array(L[a],b)){var l={},c={promise:!1,eid:L[a]},i=zmail.ContactBook.get(c);0<i.length?(l.profileImage=i[0].attrs.photo,l.id=i[0].attrs.eid,l.zid=i[0].attrs.zid):(l.profileImage=zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"),l.id=L[a],l.zid=L[a]),ZCL_attCont(l)}n()},scrollRight:S,scrollLeft:t,removeAttedee:function(e){var t=L.indexOf(e);if(-1!=t)for(var a in L.splice(t,1),o)o[a][e]&&delete o[a][e],ZCL_$("zcl_fb"+a)&&ZCL_$("zcl_fb"+a).removeChild(ZCL_$("zcl_fb"+a).childNodes[t])},getSelectedEmail:function(e,t){var a=t.data.eid;try{zmAutoFill.removeContact(t.elm)}catch(e){}e&&(e[0].value="",e[0].style.width="100%"),""!=a&&ZCL_isEmail(a)&&-1==L.indexOf(a)&&(L.push(a),i[a]=!1,R(a),H({email:a,date:z.getDate(),month:z.getMonth()+1,year:z.getFullYear()}))}}}(),zcalGroup=function(){function s(e){if(-1==m.indexOf(e.zid)){var t={attr:{"data-eid":e.eid,"data-uid":e.zid},name:e.eid,img:!!e.photo,ph:e.photo,iclass:"msi-close",cls:"SC_cs",eid:e.eid,ret:"dom"},a=zmConUtil.bubbleUtil(t),l=a.querySelector(".msi-close");l.addEventListener("click",function(e){var t=l.parentNode.getAttribute("data-eid"),a=m.indexOf(t);l.parentNode.parentNode.removeChild(l.parentNode),-1!=a&&m.splice(a,1),ZCL_stopEvents(e)}),n.children()[2].appendChild(a),m.push(e.zid)}}function a(e,a){ZCL_uXHR("/cal/grpDtl.do?mode=grp-membs&comid="+e,function(e){var t=JSON.parse(e.responseText);t.GRP_ID&&d[t.GRP_ID]&&(d[t.GRP_ID].setMembers(t),void 0!==a&&a.apply(arguments))})}var n,d={},r=[],o=[],u="personal",p=[],m=[],_=[],f=function(e,t){var a=$(e);a.off("click").click(function(){u=t,a.parent().find("i").removeClass("zcl_sl"),a.addClass("zcl_sl"),l()})},l=function(){var e="org"===u?o:r;for(var t in $("#zcl_glist").empty(),e)if(d[e[t]]){var a=d[e[t]],l=$("<ul>"),c=$("<li><span><img src='"+a.photo+"'/></span><span>"+ZCL_getHTML(a.name)+"</span></li>");c.on("click",{group:a,encrytid:e[t]},function(e){v(e.data.group,e.data.encrytid)}),l.append(c);var i=$("<li><i class='msi-addgroup'></i></li>");i.on("click",{gid:e[t]},function(e){h(e.data.gid)}),l.append(i),$("#zcl_glist").append(l)}},v=function(e,a){if(-1==p.indexOf(a)){var t={attr:{"data-ty":"group","data-gid":e.id},name:e.name,img:!!e.photo,ph:e.photo,iclass:"msi-close",cls:"SC_cs",eid:e.name,ret:"dom"},l=zmConUtil.bubbleUtil(t),c=l.querySelector(".msi-close");c.addEventListener("click",function(e){c.parentNode.getAttribute("data-gid");var t=p.indexOf(a);c.parentNode.parentNode.removeChild(c.parentNode),-1!=t&&p.splice(t,1),ZCL_stopEvents(e)}),n.children()[2].appendChild(l),p.push(a)}},h=function(e){ZCL_isEmpty(d[e].getMembers())?a(e,function(){c(e)}):c(e)},c=function(e){var t,a=$("#zcl_gmemlist");a.empty(),(t=$("<input type='text' class='zm_sgst' placeholder='Search individuals' id='zcl_gmemsrch'>")).attr("gid",e),t.off("keyup").keyup(function(e){C(e,this)}),a.append($("<div/>").append(t)),a.append($("<div/>")),g(e)},g=function(e){var t=d[e].getMembers(),a=$("#zcl_gmemlist"),l=$(a.children()[1]),c=$("<div class='zcl_table'/>");for(var i in l.empty(),t){var n=t[i].photo||zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"),r=$("<ul><li><span><img src='"+n+"'/></span><span>"+t[i].eid+"</span></li></ul>");r.on("click",{zid:i,eid:t[i].eid,photo:n},function(e){s(e.data)}),c.append(r)}l.append(c)},C=function(e,a){var l=a.value,c=a.getAttribute("gid"),n=d[c].getMembersSearchRec(),r=l.lastIndexOf(",");if(-1<r&&(l=l.substring(r+1,fldval.length)),"\n"==(l=l.trim()))return 0;(_=function(e,a,l){var c=[],n=[],r=(a=a.replace(/&#39;/gi,"'")).substring(0,1).toLowerCase();'"'==r&&(r=a.charAt(1).toLowerCase());for(r.match(/[^a-zA-Z]$/)&&(r="others"),e[r]&&(n=e[r]),0!=a.indexOf("+")&&(a=a.replace(/\+/,"\\+")),a=(a=(a=(a=(a=(a=a.replace(/\s/,"\\s")).replace(/\(/,"\\(")).replace(/\)/,"\\)")).replace(/\*/,"\\*")).replace(/\&/,"\\&")).replace(/\$/,"\\$"),z=0;z<n.length&&(!l||c.length!=l);z++){var s=n[z].dtxt,d=(s=(s=(s=(s=s.replace(/"/gi,"")).replace(/</gi,"")).replace(/>/gi,"")).replace(/\(/gi," ")).split(" ");for(d[d.length]=n[z],i=0;i<d.length;i++){t=d[i];var o=new RegExp("^(\"|')?"+a+".*?","gi").exec(t);if(o&&0==o.index){c[c.length]=n[z];break}}}return c}(n,l,10))&&0<_.length?function(e){var t=$("#zcl_gmemlist"),a=$(t.children()[1]),l=$("<div class='zcl_table'/>");for(var c in a.empty(),e){var i=e[c].photo||zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"),n=$("<ul><li><span><img src='"+i+"'/></span><span>"+e[c].eid+"</span></li></ul>");n.on("click",{zid:e[c].zid,eid:e[c].eid,photo:i},function(e){s(e.data)}),l.append(n)}a.append(l)}(_):g(c)},y=function(){if(zmsDialog.remove(!0),u="personal",p=[],m=[],ZCL_$("zcl_addgroup")){var e=ZCL_$("zcl_addgroup");e.parentNode.removeChild(e)}},L=function(e){this.id,this.name,this.photo,this.desc,this.members={},this.srchIndArr={},this.type,this.init(e)};return L.prototype={init:function(e){this.id=e&&e.id,this.name=e&&e.name,this.photo=e&&e.photo,this.desc=e&&e.desc},setMembers:function(e){this.members=e&&e.GRP_MEM_OBJ,this.srchIndArr=e&&e.GRP_MEM_ARR&&e.GRP_MEM_ARR[0]},getMembers:function(){return this.members},getMembersSearchRec:function(){return this.srchIndArr}},{loadGroup:function(){if(zcal.cdata.grpLst){var e=zcal.cdata.grpLst;for(var t in e.pgrp)d[t]=new L({id:e.pgrp[t].GID,name:e.pgrp[t].GNAME,type:"personal",photo:e.pgrp[t].PHOTO,desc:e.pgrp[t].GDESC?e.pgrp[t].GDESC:zcal.i18n.nodescription}),r.push(t);for(var t in e.ogrp)d[t]=new L({id:e.ogrp[t].GID,name:e.ogrp[t].GNAME,type:"org",photo:e.ogrp[t].PHOTO,desc:e.ogrp[t].GDESC?e.ogrp[t].GDESC:zcal.i18n.nodescription}),o.push(t)}},listGroupForAttSel:function(){var e,t;0==$("#zcl_addgroup").length&&document.body.appendChild($("<div class='zcl_adgrp' id='zcl_addgroup'/>")[0]),(n=$("#zcl_addgroup")).empty(),n.append(function(){for(var e=[{type:"personal",icon:"msi-group"},{type:"org",icon:"msi-Ogrp"}],t=$("<div/>"),a=0;a<e.length;a++){var l=e[a],c=document.createElement("i");c.className=l.icon+(l.type===u?" zcl_sl":""),f(c,l.type),t.append(c)}return t}()),n.append((e=$("<div class='zcl_table'/>"),t=_zm.getDOM(["UL",{child:[["LI",{attrs:{class:"zcl_adgrpls"},child:[["DIV",{child:[["DIV",{attrs:{id:"zcl_glist",class:"zcl_table"}}]]}]]}],["LI",{attrs:{class:"zcl_adgrpils",id:"zcl_gmemlist"}}]]}]),e.append(t),e)),n.append($("<div class='zcl_grpatt'/>")),l();var a={title:zcal.i18n.add_group_attendees,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){zcalGroup.close()},buttons:[{txt:zcal.i18n.ok,callback:function(){zcalGroup.getSelectedGroup()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){zcalGroup.close()}}]};zmsDialog.create("zcl_addgroup",a)},getSelectedGroup:function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(0<m.length){var t=zmail.ContactBook.get({promise:!1,zuid:m}),a=e.find("#attlist");for(var l in t){var c=t[l].attrs;(r=document.createElement("ul")).setAttribute("data-zid",c.zid),r.setAttribute("id",c.eid),r.className="zcl_sl",r.innerHTML="<li><img src="+c.photo+"></li><li><b>"+c.eid+'</b></li><li class="zcl_txr"><i class="msi-close" title="Remove" ></i></li>',e.find("#zcl_ce_attlst")[0]?e.find("#zcl_ce_attlst").append(a.append($(r))):a.append($(r))}}if(0<p.length){var i={};for(l=0;l<p.length;l++){var n=p[l];i[d[n].id]={gid:d[n].id,name:d[n].name,photo:d[n].photo,egid:n}}try{a=e.find("#attlist");for(var l in i){var r;(r=document.createElement("ul")).setAttribute("id",i[l].egid),r.setAttribute("gid",i[l].gid),r.innerHTML="<li><img src="+i[l].photo+"></li><li><b>"+i[l].name+'</b></li><li class="zcl_txr"><i class="msi-close" title="Remove" ></i></li>';var s=r.querySelector(".msi-close");s.addEventListener("click",function(e){s.parentNode.parentNode.remove()}),e.find("#zcl_ce_attlst")[0]?e.find("#zcl_ce_attlst").append(a.append($(r))):a.append($(r))}}catch(e){}}y()},close:y,getGroupList:function(e){return"personal"==e?r:"org"==e?o:void 0},getGroup:function(e){if(d[e])return d[e]},fetchMembers:a}}();function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ZCL_createCal=function(e){ZCL_openCalPopup({id:"",gId:e||"",name:"",desc:"",color:0,txtcolor:0,addmode:"cal"})},ZCL_openCalPopup=function(e){zmsuite.isWorkspaceAvailable("zcal_addcalContainer")&&zmsuite.closeWorkspace("zcal_addcalContainer");var t=zcalTemplate.popupCreateCal(e);ZCL_setAddCalWorkSpace(t,e)},ZCL_addCal=function(e){if("enable"==e.target.getAttribute("rel")){if(""==ZCL_$("zcl_calname").value.trim())return zmUtil.succErrMsg("e",zcal.i18n.entercalname),ZCL_$("zcl_calname").focus(),!1;e.target.setAttribute("rel","disabled");var t=ZCL_$("zcl_calcol").getElementsByTagName("li"),a=0;for(var l in t){var c=t[l].getElementsByTagName("i");if(0<c.length&&"msi-tick"==c[0].className){a=t[l].getAttribute("rel");break}}var i=zcal.$("zcl_calname").value.trim().replace(zcal.REG,"").zcalescape(),n=zcal.$("zcl_caldesc").value.trim().replace(zcal.REG,"").zcalescape(),r=zcal.$("zcl_calid").value,s=zcal.$("zcl_calgid").value,d=1;"msi-option"==ZCL_$("zcl_txtcol").getElementsByTagName("i")[0].className&&(d=0);var o="/cal/calAct.do?calname="+i;ZCL_XHR(o+=""!=r?"&mode=edit-info&calid="+r+"&caldesc="+n+"&calcol="+a+"&txtcol="+d:"&mode=add&caldesc="+n+"&calcol="+a+"&txtcol="+d+(s?"&gid="+s:""),zcal.retCAL)}},ZCL_adcClose=function(){zmsuite.isWorkspaceAvailable("zcal_addcalContainer")&&zmsuite.closeWorkspace("zcal_addcalContainer")},ZCL_editCal=function(i){var n=zcal.getCalObj(i),r=n[1].split(":")[0],s=n[1].split(":")[1];if("group"==n[14]){var d;for(var e in zcal.cdata.calByGrp)for(var t in zcal.cdata.calByGrp[e])t==i&&(d=e);var o=[],u=[],p=[],m=!1;ZCL_uXHR("/cal/groups/"+d+"/getMembers",function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a=t.members;for(var l in a)(a[l].isOwner||a[l].isModerator)&&zmail.zuid==a[l].zid&&(m=!0);for(var c in a)a[c].isOwner?o.push(a[c]):a[c].isModerator?u.push(a[c]):p.push(a[c]);ZCL_openGrpCalPopup({id:i,gId:d,name:n[0],desc:n[4],color:r,txtcolor:s,addmode:"grp",title:"Edit Group Calendar",members:p,owner:o,moderator:u,is_owner:m})}})}else ZCL_openCalPopup({id:i,name:n[0],desc:n[4],color:r,txtcolor:s,addmode:"cal",title:"Edit Calendar"})},zcal.calColorSel=function(e,t){e=e||"0";for(var a="<ul>",l=!1,c=0;c<zcal.calcolor.length;c++)l=e==c||zcal.calcolor[c][1].toLowerCase()==e.toLowerCase()||l,a+="<li onclick=\"zcal.selColor(this,'"+t+'\')" style="background-color:'+zcal.calcolor[c][1]+';" rel="'+c+'">',a+=e==c||zcal.calcolor[c][1].toLowerCase()==e.toLowerCase()?'<i class="msi-tick"></i>':"",a+=9==c?"</ul><ul>":"";return a+="</ul>",l||(a+="<ul><li onclick=\"zcal.selColor(this,'"+t+'\')" style="background-color:'+e+'" rel="'+e+'"><i class="msi-tick"></i></li>',a+="<li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>"),a},zcal.selColor=function(e,t){var a=zcal.$("zcl_calcol").getElementsByTagName("li");for(var l in a)a[l].innerHTML="";e.innerHTML='<i class="msi-tick"></i>',"edit"==t&&ZCL_addGrpCal(e,t)},zcal.openCalDesc=function(e){zcal.$("zcl_caldesc").style.display="",e.style.display="none"},ZCL_delCal=function(a,e){ZCL_clrStck();var t,l=e?zcal.i18n.areyousureunsub:zcal.i18n.deletecalendar;zmsDialog.confirm(l,{onOk:function(){t=zcal.getCalObj(a),ZCL_XHR("/cal/calAct.do?mode=del&calid="+a+"&calencpt="+t[9],function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status&&$.publish("/calendar/deleted",{calid:a,caluid:t.uid,mode:"delete"})})}})},ZCL_enableCal=function(e){var t=zcal.getCalObj(e);t&&0==t[2]&&ZCL_sendChgCalStsReq(e,!0,t)},ZCL_ChgCalSts=function(e){var t,a;-1!=e.indexOf("zcrm_")?(e=e.replace("zcrm_",""),zcalCRM.chgUserSts(e)):null!=(t=zcal.getCalObj(e))&&(a=1!=t[2],ZCL_sendChgCalStsReq(e,a,t))},ZCL_sendChgCalStsReq=function(t,a,l){ZCL_XHR("/cal/calAct.do?mode=en-dis&calid="+t+"&isen="+a,function(e){"success"==ZCL_Evl(1,e.responseText).status&&(l[2]=a?"1":"0",$.publish("/calendar/statusChanged",{calid:t,sts:l[2]}))})},ZCL_openEmbed=function(e){var t=zcal.getCalObj(e);t&&zcalEmbed.render(e,t)},ZCL_empCal=function(e){ZCL_clrStck(),zmsDialog.confirm(zcal.i18n.emptycal,{onOk:function(){cObj=zcal.getCalObj(e),ZCL_XHR("/cal/calAct.do?mode=empty&calid="+e,ZCL_retEmptyCal)}})},ZCL_retEmptyCal=function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status&&(zcalEvents.loadMonthData(),zmUtil.succErrMsg("s",ZCL_replaceString(zcal.i18n.emptingsucc,[zcal.cdata.calLst[t.id][0]])))},ZCL_grpClose=function(){zmsuite.isWorkspaceAvailable("zcal_addgrpContainer")&&zmsuite.closeWorkspace("zcal_addgrpContainer")},ZCL_memper=function(i,a){var e,t=("I"==i.target.tagName?i.target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode:i.target.parentNode.parentNode.parentNode.parentNode.parentNode).querySelector(".SC_Otxt").innerHTML,l=[],c="Moderator"==t?zcal.i18n.make_member:zcal.i18n.make_moderator;e=new zmDropDownMenu,l.push(_zm.getDOM(["LI",{attrs:{"data-item":"Moderator"==t?"member":"moderator",class:void 0},child:[["text",c]]}])),l.push(_zm.getDOM(["LI",{attrs:{"data-item":"remove",class:void 0},child:[["text",zcal.i18n.rem_from_grp]]}]));var n={par:"I"==i.target.tagName?i.target.parentNode:i.target,showArrow:!1,liDom:l,spanClass:"SC_Sopt",align:"pright",clk:role_remAction=function(e){var t=$("#zcl_calgid")[0].value;"remove"==e.item?ZCL_XHR("/cal/groups/"+t+"/removeMember/"+a,function(e){if("success"==ZCL_Evl(1,e.responseText).status){var t="I"==i.target.tagName?i.target.parentNode.parentNode.parentNode.parentNode.parentNode:i.target.parentNode.parentNode.parentNode.parentNode,a=t.parentNode.querySelector("strong").innerHTML,l=t.parentNode.parentNode.parentNode.parentNode.querySelector("#isMem"),c=t.parentNode.parentNode.parentNode.parentNode.querySelector("#zcl_memView");l.innerHTML=2==c.childNodes.length?c.childNodes.length-1+" Person":c.childNodes.length-1+" Members",t.parentNode.remove(),zmUtil.succErrMsg("s",a+" "+zcal.i18n.removemem_msg),zmUtil.hideMenu()}}):"member"==e.item?ZCL_XHR("/cal/groups/"+t+"/makeMember/"+a,function(e){if("success"==ZCL_Evl(1,e.responseText).status){var t="I"==i.target.tagName?i.target.parentNode.parentNode.parentNode.parentNode.parentNode:i.target.parentNode.parentNode.parentNode.parentNode,a=t.parentNode.querySelector("strong").innerHTML;"Moderator"==t.parentNode.querySelector(".SC_Otxt").innerHTML&&(t.parentNode.querySelector(".SC_Otxt").innerHTML=""),zmUtil.hideMenu(),zmUtil.succErrMsg("s",a+" "+zcal.i18n.makemem_msg)}}):"moderator"==e.item&&ZCL_XHR("/cal/groups/"+t+"/makeModerator/"+a,function(e){if("success"==ZCL_Evl(1,e.responseText).status){var t="I"==i.target.tagName?i.target.parentNode.parentNode.parentNode.parentNode.parentNode:i.target.parentNode.parentNode.parentNode.parentNode,a=t.parentNode.querySelector("strong").innerHTML;""==t.parentNode.querySelector(".SC_Otxt").innerHTML&&(t.parentNode.querySelector(".SC_Otxt").innerHTML="Moderator"),zmUtil.hideMenu(),zmUtil.succErrMsg("s",a+" "+zcal.i18n.makemode_msg)}})}};"I"==i.target.tagName?i.target.parentNode.className="zmcDrpDwnOpn SC_ddn":i.target.className="zmcDrpDwnOpn SC_ddn",e.setDropObj(n),e.paint(),"bottom"===e.dropObj.mountPosition?"I"==i.target.tagName?i.target.parentNode.className="zmcDrpDwnOpn SC_ddnB":i.target.className="zmcDrpDwnOpn SC_ddnB":"top"===e.dropObj.mountPosition&&("I"==i.target.tagName?i.target.parentNode.className="zmcDrpDwnOpn SC_ddn":i.target.className="zmcDrpDwnOpn SC_ddn")},addGroup=function(e){if(200==e.status){var t=(i=ZCL_Evl(1,e.responseText)).mode,a=i.calid?i.calid:null;if("add"==t)"success"==i.status?(ZCL_grpClose(),zmUtil.succErrMsg("s","Group Calendar added successfully"),i.gid?(zcal.cdata.calOLst=l.calOLst,zcal.cdata.calOUids=l.calOUids,0==zcal.CALMODE&&(zcal.cdata.calGLst=l.calGLst,zcal.cdata.calALst=l.calALst,zcal.cdata.calByGrp=l.calByGrp)):(zcal.cdata.calGLst[a]=i.obj,zcal.cdata.gcalOdrArr[zcal.cdata.gcalOdrArr.length]=a,i.groupId&&(zcal.cdata.calByGrp[i.groupId]={},zcal.cdata.calByGrp[i.groupId][a]=i.obj)),$.publish("/calendar/added",{calid:a,mode:"add"})):(zmUtil.succErrMsg("e",i.error),zmUtil.hideMenu());else if(t="edit")if("success"==i.status){zmUtil.succErrMsg("s",zcal.i18n.caledited);var l=i.obj,c=zcal.getCalObj(a);c[0]=l[0],c[1]=l[1],c[4]=l[4],$.publish("/calendar/updated")}else zmUtil.succErrMsg("e",i.error)}else{var i;"add"==(t=(i=ZCL_Evl(1,e.responseText)).mode)&&"failure"==i.status&&("Group Name already exists"==i.error?zmUtil.succErrMsg("e",i.error):(zmUtil.succErrMsg("e",i.error),zmUtil.hideMenu()))}},zcal.retCAL=function(e){if(ZCL_adcClose(),200==e.status){var t=(n=ZCL_Evl(1,e.responseText)).mode,a=n.id?n.id:null;if("add"==t)if("success"==n.status){zmUtil.succErrMsg("s",zcal.i18n.caladd);var l=n.obj;n.gid?(zcal.cdata.calOLst=l.calOLst,zcal.cdata.calOUids=l.calOUids,0==zcal.CALMODE&&(zcal.cdata.calGLst=l.calGLst,zcal.cdata.calALst=l.calALst,zcal.cdata.calByGrp=l.calByGrp)):(zcal.cdata.calLst[a]=n.obj,zcal.cdata.calOrdArr[zcal.cdata.calOrdArr.length]=a),$.publish("/calendar/added",{calid:a,mode:"add"})}else zmUtil.succErrMsg("e",n.error);else if("edit-info"==t)if("success"==n.status){zmUtil.succErrMsg("s",zcal.i18n.caledited);l=n.obj;var c=zcal.getCalObj(a);c[0]=l[0],c[1]=l[1],c[4]=l[4],$.publish("/calendar/updated")}else zmUtil.succErrMsg("e",n.error);else if("del"==t||"delByUid"==t)ZCL_cleanDeletedCal(a);else if("gcal_del"==t)n.service&&"gcal"==n.service&&(ZCL_removeGCal(n),"success"==n.status&&zmUtil.succErrMsg("s",zcal.i18n.unsubscribesuc));else if("en-dis"==t&&"success"==n.status){var i=n.isenable;zcal.getCalObj(n.id)[2]=i?"1":"0",zmUtil.succErrMsg("s",zcal.i18n.statuschange)}}else{var n=e&&e.responseText?ZCL_Evl(1,e.responseText):null;zmUtil.succErrMsg("e",n&&n.message?n.message:zcal.i18n.errmsg)}},ZCL_cleanDeletedCal=function(e){var t=e.calid,a=e.caluid,l=e.grpid?e.grpid:"";zcal.cdata.calLst[t]?(delete zcal.cdata.calLst[t],ZCL_remCalid(t),zmUtil.succErrMsg("s",zcal.i18n.caldeleted)):(zcal.cdata.calOLst[t]||zcal.cdata.calGLst[t]||zcal.cdata.calALst[t]||zcal.cdata.calByGrp[l])&&(zcal.cdata.calGLst[t]||zcal.cdata.calByGrp[l]?(delete zcal.cdata.calGLst[t],delete zcal.cdata.calByGrp[l]):zcal.cdata.calALst[t]?(delete zcal.cdata.calALst[t],a.startsWith("zohoCrm_")&&(crmCalId=null)):delete zcal.cdata.calOLst[t]&&delete zcal.cdata.calOLst[t],ZCL_remOCalid(a),"grpdelete"==e.mode?zmUtil.succErrMsg("s","Group deleted successfully"):zmUtil.succErrMsg("s",zcal.i18n.unsubscribesuc)),ZCL_setCalendars(),zcalEvents.loadMonthData()},ZCL_remCalid=function(e){for(var t in zcal.cdata.calOrdArr)if(zcal.cdata.calOrdArr[t]==e){zcal.cdata.calOrdArr.splice(t,1);break}},ZCL_remOCalid=function(e){var t=zcal.cdata.calOUids;zcal.cdata.calOUids=t.substring(0,t.indexOf(e))+t.substring(t.indexOf(e)+e.length+1,t.length)},ZCL_gothro=function(e){for(var t in zcal.cdata.evelst){var a=zcal.cdata.evelst[t];for(var l in a)for(var c in a[l])e==a[l][c].CNAME&&(1==a.length?delete zcal.cdata.evelst[t]:zcal.cdata.evelst[t].splice(l,1))}for(var t in zcal.cdata.eveAll){a=zcal.cdata.eveAll[t];for(var l in a)for(var c in a[l])e==a[l][c].CNAME&&(1==a.length?delete zcal.cdata.eveAll[t]:zcal.cdata.eveAll[t].splice(l,1))}},ZCL_subscribeToCalUpdate=function(){zcal.isSubToCalUpd=!0,$.subscribe("/calendar/added",ZCL_updateCalAndEvents),$.subscribe("/calendar/subscribed",function(){ZCL_setCalendars(),zcal.settingsUpdated=!0,zcalEvents.loadMonthData()}),$.subscribe("/calendar/updated",ZCL_updateCalAndEvents),$.subscribe("/calendar/deleted",function(e,t){zcal.settingsUpdated=!0,ZCL_cleanDeletedCal(t)}),$.subscribe("/calendar/statusChanged",function(e,t){ZCL_setCalendars(),zcal.settingsUpdated=!0,ZCL_updateEvents(),"1"==t.sts&&zcalEvents.loadMonthData()}),$.subscribe("/calendar/visibilityChanged",function(e,t){ZCL_setCalendars(),t.visibility?zcalEvents.loadMonthData():(zcal.settingsUpdated=!0,ZCL_gothro(t.calid),ZCL_updateEvents())})},ZCL_updateCalAndEvents=function(){ZCL_setCalendars(),ZCL_updateEvents()},ZCL_updateEvents=function(e){4==zcal.view?zcalAgenda.dispEvents():zcalView.plotEvents(e)},ZCL_setCalendars=function(){zcal.disabledcal="",ZCL_CALNAME="",zcal.mcal=zcalInit.formatCalData(zcal.cdata.calLst,zcal.cdata.calOrdArr),ZCL_setGrpOdr(),ZCL_updateGroupCalList(),ZCL_updateAppCalList(),zcal.acal=zcalInit.formatCalData(zcal.cdata.calALst),zcal.ocal=zcalInit.formatCalData(zcal.cdata.calOLst),"c"==zmApp.currentApp&&(zcal.calLeft?zcalInit.constructLeft():zcalInit.initCal())},ZCL_setGrpOdr=function(){if(zcal.cdata.calGLst){var e=zcal.cdata.calGLst,t=[],a={};for(var l in e)a={id:l,value:e[l][0]},t.push(a);for(var c in t.sort(function(e,t){var a=e.value.toUpperCase(),l=t.value.toUpperCase();return a<l?-1:l<a?1:0}),zcal.cdata.gcalOdrArr=[],t)zcal.cdata.gcalOdrArr.push(t[c].id)}},ZCL_getCalColor=function(e){return e=-1!=(e+="").indexOf(":")?e.substring(0,e.indexOf(":")):e,/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/.test(e)?[e,e]:/0?[0-9]|1[0-9]/.test(e)?zcal.calcolor[parseInt(e,10)]:zcal.calcolor[0]},ZCL_getColorNo=function(e){for(var t=0;t<zcal.calcolor.length;t++){var a=zcal.calcolor[t];if(a[0].toLowerCase()==e.toLowerCase()||a[1].toLowerCase()==e.toLowerCase())return t}return-1},ZCL_createGrpCal=function(e){ZCL_openGrpCalPopup({id:"",gId:e||"",name:"",grpMem:"",desc:"",color:0,txtcolor:0,addmode:"grp"})},ZCL_openGrpCalPopup=function(e){zmsuite.isWorkspaceAvailable("zcal_addgrpContainer")&&zmsuite.closeWorkspace("zcal_addgrpContainer"),quickCal=zcalTemplate.popupCreateGrpCal(e),ZCL_setAddCalWorkSpace(quickCal,e)},ZCL_addGrpCal=function(e,t){"disabled"!=e.target.getAttribute("rel")&&e.target.setAttribute("rel","enabled");var a=ZCL_$("zcl_grpcalname").value,l=$("#zcl_grpMemlist");if(""==a.trim())l[0].childNodes.length<=0&&(ZCL_$("zcl_ad_att_er").style.display="",ZCL_$("zcl_addGrpMem").parentNode.className="zcl_ad_gr_m zcl_cl_ad_er"),ZCL_$("zcl_ad_ti_er").style.display="",ZCL_$("zcl_grpcalname").className="SC_tiput zcl_cl_ad_er";else{if(""!=zcal.$("zcl_calgrpdesc").value&&200<zcal.$("zcl_calgrpdesc").value.length)return ZCL_$("zcl_ad_desc_er").style.display="",!(ZCL_$("zcl_calgrpdesc").className="SC_tiput zcl_cl_ad_er");if(ZCL_$("zcl_addGrpMem")&&l[0].childNodes.length<=0)ZCL_$("zcl_ad_att_er").style.display="",ZCL_$("zcl_addGrpMem").parentNode.className="zcl_ad_gr_m zcl_cl_ad_er";else{var c=ZCL_$("zcl_calcol").getElementsByTagName("li"),i=0;for(var n in c){var r=c[n].getElementsByTagName("i");if(0<r.length&&"msi-tick"==r[0].className){i=c[n].getAttribute("rel");break}}var s=zcal.$("zcl_grpcalname").value.trim().replace(zcal.REG,"").zcalescape(),d=zcal.$("zcl_calgrpdesc").value.trim().replace(zcal.REG,"").zcalescape(),o=1;if("msi-option"==ZCL_$("zcl_txtcol").getElementsByTagName("i")[0].className&&(o=0),"edit"==t){var u=$("#zcl_calgid")[0].value,p=$("#zcl_calid")[0].value,m=zcal.cdata.calGLst[p];if(s!=m[0]||d!=m[4]||m[1].split(":")[0]!=zcal.calcolor[i][1].toLowerCase()||m[1].split(":")[1]!=o){var _={calname:s,caldesc:d,calcol:i,txtcol:o};ZCL_XHR("/cal/groups/"+u+"?groupData="+JSON.stringify(_),addGroup)}}else{var z=l[0].childNodes,f=[];for(var n in z)if("object"==_typeof(z[n])){var v=z[n].getAttribute("data-zid");f.push(parseInt(v))}_={calname:s,caldesc:d,calcol:i,txtcol:o,members:f};"enabled"==e.target.getAttribute("rel")&&(e.target.setAttribute("rel","disabled"),ZCL_XHR("/cal/groups?groupData="+JSON.stringify(_),addGroup))}}}},ZCL_setAddCalWorkSpace=function(e,l){var t,a="cal"==l.addmode?"zcal_addcalContainer":"zcal_addgrpContainer",c="cal"==l.addmode?l.title?l.title:zcal.i18n.addcalendar:l.title?l.title:zcal.i18n.addgrpcalendar,i={appname:c,appId:a,data:{CNodes:"2"},appIcon:0==zcal.EMODE?"msi-Vevnt":"msi-caledit"};if(zmTab.isMaxLimitReached())return"";zmsuite.setWorkSpace(i),(t={id:"zcalPrevHeader"}).text=["DIV",{attrs:{class:"SC_phd"},child:[["text",c]]}];var n=zmsuite.getCenter(),r=n[1].getNodes();zmsuite.renderCenter(),r[0].push(t),r[0].setListener("click",function(e,t){zcalList.bindAction(e,t)}),r[1].push($(e)),n[1].show(),r[1].$el.find("[data-marker=textColor]").removeAttr("data-marker").on("click",function(e){var t=$(this);t.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),t.find("i").removeClass("msi-unoption").addClass("msi-option"),"Edit Group Calendar"==l.title&&ZCL_addGrpCal(e,"edit")}),ZCL_$("zcl_grpcalname")&&$("#zcl_grpcalname").on("keydown",function(e){13==e.keyCode&&"Edit Group Calendar"==l.title&&ZCL_addGrpCal(e,"edit")}),ZCL_$("zcl_addGrpMem")&&($("#zcl_addGrpMem").on("keydown",function(e){if(13==e.keyCode&&"zcl_addGrpMem"==this.id){for(var t=this.value.split(","),a=0;a<t.length;a++){var l=t[a].trim(),c=l.indexOf("<"),i=l.indexOf(">");-1<c&&-1<i&&(l=l.substring(c+1,i)),l=l.replace(/,/g,"")}if(ZCL_isEmail(l)){var n={promise:!1,eid:l,type:["org"]},r=zmail.ContactBook.get(n);if(r[0]&&r[0].isOrg);else ZCL_$("zcl_addGrpMem").parentNode.className="zcl_ad_gr_m",ZCL_$("zcl_ad_att_er").style.display="",ZCL_$("zcl_ad_att_er").innerHTML="Add only org members"}$("#zcl_addGrpMem").val("")}}),$("#zcl_addGrpMem").on("keypress",function(e){13!=e.keyCode&&(ZCL_$("zcl_addGrpMem").parentNode.className="zcl_ad_gr_m",ZCL_$("zcl_ad_att_er").innerHTML="")}),zmAppLoader.load("zmContactsAutoComplete").then(function(){zmContactsAutoComplete.autoComplete({input:$("#zcl_addGrpMem")[0],excludeMe:!0,contactType:["org"],exclude:function(){var e=[];if(0<$("#zcl_grpMemlist")[0].childNodes.length){var t=$("#zcl_grpMemlist")[0].childNodes;for(var a in t)e.push(t[a].id)}return e},onSelect:function(e,t){t=t.item.attributes;var a=$("#zcl_grpMemlist"),l=document.createElement("li");t.zid&&l.setAttribute("data-zid",t.zid),l.setAttribute("id",t.id),l.innerHTML="<img src="+t.profileImage+"><span>"+t.firstName+'</span><i class="msi-close"></i></li>',a.append($(l)),a.find(".msi-close").on("click",function(e){e.target.parentNode.remove(),$("#zcl_addGrpMem").focus()}),$("#zcl_addGrpMem").val("")}})})),ZCL_$("zcl_addsrhdiv")&&($("#zcl_addsrhmem").on("keydown",function(e){if(ZCL_$("zcl_ad_att_er").style.display="none",13==e.keyCode&&"zcl_addsrhmem"==this.id){for(var t=this.value.split(","),a=0;a<t.length;a++){var l=t[a].trim(),c=l.indexOf("<"),i=l.indexOf(">");-1<c&&-1<i&&(l=l.substring(c+1,i)),l=l.replace(/,/g,"")}if(ZCL_isEmail(l)){ZCL_$("zcl_ad_att_er").style.display=""}$("#zcl_addsrhmem").val("")}}),zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:$("#zcl_addsrhmem")[0],excludeMe:!0,contactType:["org"],exclude:function(){var e=[];if($("#zcl_memView")[0].childNodes)for(var t in $("#zcl_memView")[0].childNodes){var a=$("#zcl_memView")[0].childNodes[t].id;a&&e.push(a)}return e},onSelect:function(e,t){t=t.item.attributes;zcl_addmem(t),$("#zcl_addsrhmem").val("")}})})),"Edit Group Calendar"!=l.title&&$("#zcl_grpcalname").on("focusout",function(){if(""==ZCL_$("zcl_grpcalname").value)ZCL_$("zcl_ad_ti_er").style.display="",ZCL_$("zcl_grpcalname").className="SC_tiput zcl_cl_ad_er";else if(zcal.$("zcl_grpcalname").value){var e=!1;for(var t in zcal.cdata.calGLst){var a=zcal.cdata.calGLst[t][0];zcal.$("zcl_grpcalname").value==a&&l.id!=t&&(e=!0)}e?(ZCL_$("zcl_ad_ti_er").style.display="",ZCL_$("zcl_grpcalname").className="SC_tiput zcl_cl_ad_er",ZCL_$("zcl_ad_ti_er").innerHTML="The group name you've entered is already in use"):(ZCL_$("zcl_ad_ti_er").style.display="none",ZCL_$("zcl_grpcalname").className="SC_tiput")}});var s=$("#zcl_grpMemlist");$("#zcl_addGrpdiv").on("focusout",function(){s[0].childNodes.length<=0?(ZCL_$("zcl_ad_att_er").style.display="",ZCL_$("zcl_addGrpMem").parentNode.className="zcl_ad_gr_m zcl_cl_ad_er"):(ZCL_$("zcl_ad_att_er").style.display="none",ZCL_$("zcl_addGrpMem").parentNode.className="zcl_ad_gr_m")}),$("#zcl_addGrpdiv").on("focusin",function(){0<s[0].childNodes.length&&(ZCL_$("zcl_ad_att_er").style.display="none",ZCL_$("zcl_addGrpMem").parentNode.className="zcl_ad_gr_m")}),zmsuite.showWorkSpace(a),n[0].$el.addClass("SC_sw"),n[1].$el.addClass("SC_w100")},zcal.getCalLst=function(){for(var e={},t=0;t<zcal.cdata.calOrdArr.length;t++){var a=zcal.cdata.calOrdArr[t],l=zcal.cdata.calLst[a];e[a]=l[0]}for(var c in zcal.cdata.calGLst){"1"!=(i=zcal.cdata.calGLst[c])[8]||2!=i[12]&&3!=i[12]||(e[c]=i[0]+"("+i[14]+")")}for(var c in zcal.cdata.calALst){"1"!=(i=zcal.cdata.calALst[c])[8]||2!=i[12]&&3!=i[12]||(e[c]=i[0]+"("+i[14]+")")}for(var c in zcal.cdata.calOLst){var i;"1"!=(i=zcal.cdata.calOLst[c])[8]||2!=i[12]&&3!=i[12]||(e[c]=i[0]+"(others)")}return e};var zcalDD={CUR_ELEMENT:null,valObj:null,isTZ:!(zcal.showDD=function(e,t){if("remlst"==t)zcalDD.ddList(e,zcal.REMSTR);else if("rem_rtype"==t)zcalDD.ddList(e,zcal.ALARM_REMTYPE);else if("rem_atype"==t)zcalDD.ddList(e,zcal.ALARM_ACTTYPE);else if("repfreq"==t)zcalDD.ddList(e,zcal.REPEAT_FREQ);else if("callst"==t){var a=zcal.getCalLst();zcalDD.ddList(e,a)}else"weekdays"==t?zcalDD.ddList(e,Date.WEEK_DAYS[0]):"wktype"==t?zcalDD.ddList(e,zcal.WEEK_TYPE):"months"==t?zcalDD.ddList(e,Date.MONTH_NAMES[0]):"freebusy_db"==t&&zcalDD.ddList(e,zcal.FREEBUSY_DD)}),ddList:function(e,t,a){this.CUR_ELEMENT=e,this.valObj=t,this.isTZ=a,this.constDD()},close:function(e){var t=document.getElementById&&!document.all?e.target:event.srcElement;t.id&&"zcl_ddlst"==t.id||(document.attachEvent?document.detachEvent("onmousedown",zcalDD.close):document.removeEventListener("mousedown",zcalDD.close,!1),zcalDD.delDD())},delDD:function(){var e=document.getElementById("zcl_ddlst");return!!e&&(e.parentNode.removeChild(e),!0)},constDD:function(){document.attachEvent?document.attachEvent("onmousedown",zcalDD.close):document.addEventListener("mousedown",zcalDD.close,!1);var e=document.createElement("ul");e.className="zcl_optiondrpbx",e.setAttribute("id","zcl_ddlst"),e.onmousedown=function(e){zcalDD.returnVal(this,e)};var t="";t+=this.constLst(),e.innerHTML=t,this.CUR_ELEMENT.appendChild(e),e.style.display="block"},constLst:function(){var e="";if(this.isTZ)for(var t in this.valObj)for(var a in this.valObj[t])e+="<li rel="+a+">"+unescape(this.valObj[t][a])+" ("+a+")</li>";else for(var t in this.valObj)e+='<li rel="'+t+'">'+ZCL_getHTML(this.valObj[t])+"</li>";return e},returnVal:function(e,t){var a=document.getElementById&&!document.all?t.target:event.srcElement;if("LI"==a.tagName){if(this.CUR_ELEMENT){this.CUR_ELEMENT.childNodes[0].value=a.innerHTML;var l=a.getAttribute("rel");this.CUR_ELEMENT.childNodes[1].value=l,this.CUR_ELEMENT.getAttribute("callback")&&ZCL_Evl(0,this.CUR_ELEMENT.getAttribute("callback"),l)}this.CUR_ELEMENT=null,this.valObj=null,this.isTZ=!1,this.delDD(),this.stopEvent(t)}},stopEvent:function(e){(e=e||event).stopPropagation?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!0,e.returnValue=!1)}};ZCL_openSAdd=function(e){zcal.CAStck(new Array("zcl_smAdd")),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1);var t=$(zcalTemplate.popupSmartAdd());ZCL_$("zcl_smAdd")||$("body").append('<ul id="zcl_smAdd" class="zcl_smtadd"></ul>');var a=$("#zcl_smAdd");a.html(t);var l=$(zcal.calCenter.listElem).offset();a.css({left:l.left+"px",top:$(e).offset().top+$(e).height()+8+"px",display:""}),$("#zcl_smaddtxt").focus(),$("#zcl_smaddtxt").off("keydown").on("keydown",function(e,t){13==(e.which||e.keyCode)&&(ZCL_clrStck(),ZCL_smartAdd(this))})},ZCL_openSAddHelp=function(){zcal.$("zcl_saddhelp").style.display="none"==zcal.$("zcl_saddhelp").style.display?"":"none"},ZCL_smartAdd=function(e){var t=e.value.trim();if(""==t)return!1;if(!zcal.validate(t))return alert(zcal.i18n.spchsmad),!1;""==(t=t.replace(zcal.REG,"").replace(/ /g," "))&&(t="NO SUBJECT");var a=ZCL_nlp(t,1),l=a.SUM.trim();""==l&&(l="NO SUBJECT");var c=a.SD&&""!=a.SD?a.SD:"";c=ZCL_parseDateStr(c).dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]);var i=a.ED&&""!=a.ED?a.ED:"";i=ZCL_parseDateStr(i).dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]);var n={EID:"",EUID:"",RIDX:"",EPERM:2,DPERM:2,SD:c,ST:a.ST?a.ST:"0000",ED:i,ET:a.ET?a.ET:"0000",ATT:"",RMVATT:"",GATT:"",RMVGATT:"",CLASS:0,ADAY:a.ST||a.ET?0:1,IMP:0,USTAT:0,UCMNT:"",SKEY:"",CNAME:zcal.cdata.defcal,LOC:"",TRANS:1,DESC:"",LINK:"",ETSK:0,ECRM:0,ENTS:0,EMET:0,SUM:l,ALARM:"",REP:"",TYPE:1,ISDMY:!1,ETZ:"",IN_ETZ:!1,DELRTO:!1,EC:-1,ADD_MODE:"DET",INVITE_ALL:!1};return ZCL_detailObj(n),e.blur(),!1},ZCL_retsAdd=function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a=t.obj,l=t.rdats?t.rdats:"",c=a.LOC,i={CNAME:a.CNAME,ORG:a.ORG,SD:a.SD,ST:a.ST,ED:a.ED,ET:a.ET,SUM:a.SUM,LOC:c,REF:a.REF,RTO:a.RTO,ADAY:a.ADAY,EPERM:"2",DPERM:"2",EUID:a.EUID,EC:"-1"},n=ZCL_Evl(1,'{"'+a.EID+'":'+JSON.stringify(i)+"}");if(""!=l)ZCL_insertRepEvents(n,l,a.EID);else if(ZCL_insertEvent(n,a.EID),4==zcal.view){i.EID=a.EID;var r=JSON.stringify(i);zcalAgenda.add(r)}ZCL_enableCal(a.CNAME),zcalView.plotEvents(),zmUtil.succErrMsg("s",zcal.i18n.evtadded)}else"Parser Error"==t.error?ZCL_callAdd(t.sub):zmUtil.succErrMsg("s",t.error)};var ZCL_RQ=[],ZCL_URL=[],ZCL_LOGIN_STATE=!0,zcal_zmcontext="/zm";function ZCL_XHR(e,t,a,l,c){if(e=zcal_zmcontext+e,ZCL_LOGIN_STATE){rt=ZCL_RQ.length,ZCL_RQ[rt]=ZCL_GetHTTPTransport(),ZCL_URL[rt]=e,"function"==typeof t?(ZCL_RQ[rt].zcal_callback=t,ZCL_RQ[rt].zcal_reqindex=rt,ZCL_RQ[rt].onreadystatechange=function(){var e=this.zcal_callback,t=this.zcal_reqindex;4==this.readyState&&(e(-1!=this.getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml")?this.responseXML:this,ZCL_URL[t]),ZCL_RQ[t]=null)}):ZCL_RQ[rt].onreadystatechange=function(){if(4==ZCL_RQ[rt].readyState){ZCL_XHRInclude(ZCL_RQ[rt],ZCL_URL[rt]);var e=ZCL_RQ[rt].getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");t(-1!=e?ZCL_RQ[rt].responseXML:ZCL_RQ[rt],ZCL_URL[rt]),ZCL_RQ[rt]=null}},a=a||"POST";var i=ZCL_getCookie("aprmjrnpkcrkks");return-1!=e.indexOf("?")?(l=e.substring(e.indexOf("?")+1,e.length),e=e.substring(0,e.indexOf("?"))):l="",l+=(""!=l?"&":"")+"mstpcrdhkur="+i,ZCL_RQ[rt].open(a,e,!0),"delete"==a&&l&&ZCL_RQ[rt].setRequestHeader("X-ZCSRF-TOKEN",l),"POST"==a?(c=c||"application/x-www-form-urlencoded;charset=UTF-8",ZCL_RQ[rt].setRequestHeader("Content-Type",c),ZCL_RQ[rt].send(l)):ZCL_RQ[rt].send(null),!0}return!1}function ZCL_XHRInclude(){return!0}function ZCL_XHRSync(e,t,a){var l=ZCL_GetHTTPTransport();return m=t?"POST":"GET",e+=(e.indexOf("?")+1?"&":"?")+(new Date).getTime(),l.open(m,e,!1),"POST"==m?(a=a||"application/x-www-form-urlencoded;charset=UTF-8",l.setRequestHeader("Content-Type",a),l.send(t)):l.send(null),l}ZCL_uXHR=function(e,t){return e=zcal_zmcontext+e,rt=ZCL_RQ.length,ZCL_RQ[rt]=ZCL_GetHTTPTransport(),ZCL_URL[rt]=e,"function"==typeof t?(ZCL_RQ[rt].zcal_callback=t,ZCL_RQ[rt].zcal_reqindex=rt,ZCL_RQ[rt].onreadystatechange=function(){var e=this.zcal_callback,t=this.zcal_reqindex;4==this.readyState&&(e(-1!=this.getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml")?this.responseXML:this,ZCL_URL[t]),ZCL_RQ[t]=null)}):ZCL_RQ[rt].onreadystatechange=function(){if(4==ZCL_RQ[rt].readyState){ZCL_XHRInclude(ZCL_RQ[rt],ZCL_URL[rt]);var e=ZCL_RQ[rt].getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");t(-1!=e?ZCL_RQ[rt].responseXML:ZCL_RQ[rt],ZCL_URL[rt]),ZCL_RQ[rt]=null}},ZCL_RQ[rt].open("GET",e,!0),ZCL_RQ[rt].setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),ZCL_RQ[rt].send(null),!0},ZCL_GetHTTPTransport=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){throw new Exception("Browser not supported")}}},ZCL_formSubmit=function(e,t,a){if(!ZCL_$("zcl_tarFrame")){var l=_zm.getDOM(["IFRAME",{attrs:{id:"zcl_tarFrame",name:"zcl_tarFrame",style:"display:none",width:"0",height:"0",frameborder:"0"}}]);document.body.appendChild(l)}var c=_zm.getDOM(["FORM",{attrs:{id:"dwnldForm",name:"dwnldForm",style:"display:none",target:"zcl_tarFrame",method:a||"post",action:zcal_zmcontext+t+"?frameorigin="+window.location.protocol+"//"+window.location.hostname}}]);for(var i in e)c.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:i,value:e[i]}}]));var n=ZCL_getCookie("aprmjrnpkcrkks");c.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:"mstpcrdhkur",value:n}}])),document.body.appendChild(c),c.submit(),c.parentNode.removeChild(c)},ZCL_getCookie=function(e){e=new RegExp("^"+e+"=");for(var t=document.cookie.split(";"),a=0;a<t.length;a++){var l=t[a].trim();if(e.test(l))return l.replace(e,"")}return null};var zcalSettings=function(e){return e.getCalConfig=function(){return{orders:[["Preferences","Import","Subscribe","Sync","Groups","ZohoApps","OwnCalendars","GroupCalendars","AppCalendars","OtherCalendars"]],rows:{Preferences:{title:zcal.i18n.mypreference,html:function(){return zcalSettings.zcalMyPreferences.myprefRowHTML()},invokable:!0,uId:"zcalSettings.zcalMyPreferences"},Import:{title:zcal.i18n.import,html:zcal.i18n.mailimport,invokable:!0,uId:"zcalSettings.Import"},Subscribe:{title:zcal.i18n.subscribe,html:zcal.i18n.mailsubscibe,invokable:!0,uId:"zcalSettings.Subscribe"},Sync:{title:zcal.i18n.sync,html:zcal.i18n.mailsync,invokable:!0,uId:"zcalSettings.Sync"},Groups:{title:zcal.i18n.groups,html:zcal.i18n.mailgroupcalendars,invokable:!0,uId:"zcalSettings.zcalGroupList"},ZohoApps:{title:ZCL_replaceComName(zcal.i18n.zohoapps),html:ZCL_replaceComName(zcal.i18n.appsubscribe),invokable:!0,uId:"zcalSettings.appList"},OwnCalendars:{title:zcal.i18n.mycalendars,html:zcal.i18n.mailowncalendar,invokable:!0,uId:"zcalSettings.ownCalList"},GroupCalendars:{title:zcal.i18n.groupcalendars,html:zcal.i18n.mailgroupcalendar,invokable:!0,uId:"zcalSettings.grpCalList"},AppCalendars:{title:zcal.i18n.appcalendars,html:zcal.i18n.mailappcalendar,invokable:!0,uId:"zcalSettings.appCalList"},OtherCalendars:{title:zcal.i18n.othercalendars,html:zcal.i18n.mailotherscalendar,invokable:!0,uId:"zcalSettings.othCalList"}}}},e}(zcalSettings||{});function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}(zcalSettings=window.zcalSettings||{}).zcalMyPreferences=function(e){function t(){l=$('<div class="SC_filt"><div class="SC_filt_Tabs"/></div>');var e={general:{text:zcal.i18n.general,type:"general",id:"zcl_mypref_general",click:function(){b="general",i()}},emailnotify:{text:zcal.i18n.emailnotify,type:"emailnotify",id:"zcl_mypref_enotify",click:function(){b="emailnotify",i()}}};for(var t in e){var a=$('<a id="'+e[t].id+'"/>');a.addClass(b==e[t].type?"sel":""),a.text(e[t].text),a.off("click").on("click",{click:e[t].click},function(e){var t=$(this);t.parent().find("a").removeClass("sel"),t.addClass("sel"),e.data.click()}),l.find(".SC_filt_Tabs").append(a)}c.append(l)}function a(){var e=zcal.cdata.opt;!function(){var e,t,a;if(u={},e=[["DF",3],["TF",1],["DEF",4],["WK",6],["WS",6],["WE",6]],t=parseInt(ZCL_$("zcl_HS").value,10),(a=parseInt(ZCL_$("zcl_HE").value,10))<=t)return _zm.succErrMsg("e",zcal.i18n.wkhretgrwkhrst),!1;u.HS=t,u.HE=a;var l=ZCL_$("zcl_TZ")?ZCL_$("zcl_TZ").getAttribute("rel"):null;l&&l!=zcal.cdata.opt.TIM?(u.TIM=l,u.CTIM=ZCL_$("zcl_TZ").value):u.TIM=zcal.cdata.opt.TIM;for(var c=0;c<e.length;c++){var i=e[c][0],n=parseInt(ZCL_$("zcl_"+i).value,10);u[i]=0<=n&&n<=e[c][1]?n:opt[i]}var r,s=$("#zcl_autoInv"),d=$("#zcl_showDE"),o=$("#zcl_remNotify");return r=s.find(".msi-option").parent().index(),u.SIE=2==r?1:1==r?2:0,u.DDE=0==d.find(".msi-option").parent().index()?1:0,u.REM=0==o.find(".msi-option").parent().index()?1:0,u.NWTB=1==$("#zcl_nonWHr").find(".msi-check").length?1:0,!0}()||ZCL_XHR("/cal/set.do?type=gen&obj="+encodeURIComponent('{"DF":'+u.DF+',"TF":'+u.TF+',"DEF":'+u.DEF+',"WK":'+u.WK+',"WS":'+u.WS+',"WE":'+u.WE+',"HS":'+u.HS+',"HE":'+u.HE+',"MTO":'+e.MTO+', "TH":'+e.TH+',"FS":'+e.FS+',"TIM":"'+u.TIM+'", "DDE":'+u.DDE+', "SIE":'+u.SIE+',"REM":'+u.REM+',"NWTB":'+u.NWTB+"}"),s)}var l,y,c,L,b="general",u={},i=function(){y=$('<div class="SC_setInner"><div class="SC_filt_bottom"/></div>');var e=zcal.cdata.opt;if("emailnotify"==b){var t="",a=e.MT,l=e.MTO;if(e.CMAIL&&""!=e.CMAIL)t+='<div class="folderRow"><div class="folderRowBox">',t+="<p>"+ZCL_replaceString(zcal.i18n.rnote1,['<span class="SC_lnk">'+e.CMAIL+"</span>",'<span class="SC_lnk" data-marker="resendEmail">',"</span>"])+"</p>",t+="<p>"+ZCL_replaceString(zcal.i18n.rnote2,['<span class="SC_lnk">'+l+"</span>"])+"</p>",t+='<div class="SC_PUbtm"><span data-marker="reverttoPrevious">'+zcal.i18n.rbutton+"</span></div>",t+="</div></div>";else{if(t='<ul class="SC_cal_prefer"><li>',"1"==zcal.emlNfy){var c=e.REMID.split(",");t+="<span>"+zcal.i18n.emailaddress+"<span>"+zcal.i18n.emailaddress_msg2+"</span></span><em><div>"+ZCL_selBox("zcl_MTO",l,c)}else t+="<span>"+zcal.i18n.emailaddress+"<span>"+zcal.i18n.emailaddress_msg1+"</span></span><em><div>"+l,"0"!=zcal.emlNfy&&"1"!=zcal.emlNfy&&(t+='<span class="cnew SC_lnk pl5" data-marker="changeEmailNotify">'+zcal.i18n.change+"</span>");t+='<div class="block" id="enotifyType"><span data-marker="notifyType"><i class="'+(0==a?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.ashtml+'</span></span><span data-marker="notifyType"><i class="'+(1==a?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.asplaintext+"</span></span></div></div></em>",t+="</li>",0==a&&(t+="<li>",t+="<span>"+zcal.i18n.agendanotification+"<span>"+zcal.i18n.agendanotification_msg+"</span></span><em>"+ZCL_selBox1("zcl_AI",e.AI,zcal.AGENDA_INTERVAL)+"</em>",t+="</li>"),t+='<div class="SC_PUbtm left"><span class="sel" data-marker="saveENotify">'+zcal.i18n.save+"</span></div>",t+="</ul>"}var i=(o=$(t)).find("[data-marker=notifyType]").removeAttr("data-marker");i.length&&i.on("click",function(e){var t=$(this);t.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),t.find("i").removeClass("msi-unoption").addClass("msi-option"),D(t.index())});var n=o.find("[data-marker=changeEmailNotify]").removeAttr("data-marker");n.length&&n.on("click",function(e){Z()});var r=o.find("[data-marker=resendEmail]").removeAttr("data-marker");r.length&&r.on("click",function(e){ZCL_XHR("/cal/set.do?type=resendemail",S)});var s=o.find("[data-marker=reverttoPrevious]").removeAttr("data-marker");s.length&&s.on("click",function(e){ZCL_XHR("/cal/set.do?type=revert",k)});var d=o.find("[data-marker=saveENotify]").removeAttr("data-marker");d.length&&d.on("click",function(e){T()}),y.find(".SC_filt_bottom").append(o)}else{var o;t='<ul class="SC_cal_prefer">';t+="<li><span>"+zcal.i18n.timezone+'</span><em><div class="SC_select default">'+M()+'</div><span class="cnew SC_lnk pl5" data-marker="showallTimezone">'+zcal.i18n.showall+"</span></em></li>",t+="<li><span>"+zcal.i18n.dateformat+"</span><em>"+ZCL_selBox("zcl_DF",e.DF,zcal.DATEFORMAT)+"</em></li>",t+="<li><span>"+zcal.i18n.timeformat+"</span><em>"+ZCL_selBox("zcl_TF",e.TF,zcal.TIMEFORMAT)+"</em></li>",t+="<li><span>"+zcal.i18n.defaultview+"</span><em>"+ZCL_selBox("zcl_DEF",e.DEF,zcal.DEFAULTVIEW)+"</em></li>",t+="<li><span>"+zcal.i18n.weekstartson+"</span><em>"+ZCL_selBox("zcl_WK",e.WK,Date.WEEK_DAYS[0])+"</em></li>",t+="<li><span>"+zcal.i18n.workweek+"</span><em><strong>"+zcal.i18n.startson+ZCL_selBox("zcl_WS",e.WS,Date.WEEK_DAYS[0])+"</strong><strong>"+zcal.i18n.endson+ZCL_selBox("zcl_WE",e.WE,Date.WEEK_DAYS[0])+"</strong></em></li>";var u=e.SIE,p=e.DDE,m=e.REM,_=e.NWTB;t+="<li><span>"+zcal.i18n.workhours+"</span><em><strong>"+zcal.i18n.startson+ZCL_selBox("zcl_HS",e.HS,zcal.HOURS)+"</strong><strong>"+zcal.i18n.endson+ZCL_selBox("zcl_HE",e.HE,zcal.HOURS)+'</strong><div class="block"><span data-marker="nonworkingHour" id="zcl_nonWHr"><i class="'+(1==_?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.nonworktime_busy+"</span></span></div></em></li>",t+="<li><span>"+zcal.i18n.automatic_inv+"<span>"+zcal.i18n.automatic_invmsg+'</span></span><em id="zcl_autoInv"><span data-marker="automaticInvitation"><i class="'+(0==u?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.allow+'</span></span><span data-marker="automaticInvitation"><i class="'+(2==u?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.allowiffree+'</span></span><span data-marker="automaticInvitation"><i class="'+(1==u?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.dontallow+"</span></span></em></li>",t+="<li><span>"+zcal.i18n.denied_events+"<span>"+zcal.i18n.denied_eventsmsg+'</span></span><em id="zcl_showDE"><span data-marker="deniedEvents"><i class="'+(1==p?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.show+'</span></span><span data-marker="deniedEvents"><i class="'+(0==p?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.hide+"</span></span></em></li>",t+="<li><span>"+zcal.i18n.reminder_notification+"<span>"+zcal.i18n.reminder_notification_msg+'</span></span><em id="zcl_remNotify"><span data-marker="reminderNotify"><i class="'+(1==m?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.on+'</span></span><span data-marker="reminderNotify"><i class="'+(0==m?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.off+"</span></span></em></li>",t+='<div class="SC_PUbtm left"><span class="sel" data-marker="saveMyPrefGeneral">'+zcal.i18n.save+"</span></div>",t+="</ul>";var z=(o=$(t)).find("[data-marker=showallTimezone]").removeAttr("data-marker");z&&z.on("click",function(e){0<zcal.timezones.length?M():ZCL_getTZ({mode:"mypref",callback:function(){zcalSettings.zcalMyPreferences.showAllTimezone()}}),$(this).remove()}),o.find("#zcl_TZ").on("click",function(e){if(0<zcal.timezones.length){var t=zcal.timezones,a=[];for(var l in t)for(var c in t[l]){var i={};i.id=c,i.name=t[l][c]+" ("+c+")",i.display_text=t[l][c]+" ("+c+")",a.push(i)}var n,r={},s=$(this);r.parentDOM=s.parent(),r.displayAs="dropdown",r.parWidth=!0,r.onSelect=function(e,t){E(s,e,t),n.hide()},r.dataCallback=function(){return a},(n=zmUtil.createFLComp("generic",r)).show()}});var f=o.find("[data-marker=nonworkingHour]").removeAttr("data-marker");f&&f.on("click",function(e){var t=$(this);"msi-check"==t.find("i")[0].className?t.find("i").removeClass("msi-check").addClass("msi-uncheck"):t.find("i").removeClass("msi-uncheck").addClass("msi-check")});var v=o.find("[data-marker=automaticInvitation]").removeAttr("data-marker");v&&v.on("click",function(e){var t=$(this);t.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),t.find("i").removeClass("msi-unoption").addClass("msi-option")});var h=o.find("[data-marker=deniedEvents]").removeAttr("data-marker");h&&h.on("click",function(e){var t=$(this);t.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),t.find("i").removeClass("msi-unoption").addClass("msi-option")});var g=o.find("[data-marker=reminderNotify]").removeAttr("data-marker");g&&g.on("click",function(e){var t=$(this);t.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),t.find("i").removeClass("msi-unoption").addClass("msi-option")});var C=o.find("[data-marker=saveMyPrefGeneral]").removeAttr("data-marker");C&&C.on("click",function(e){A()}),y.find(".SC_filt_bottom").append(o)}L.empty().append(y)},E=function(e,t,a){e.val(a.display_text),e.attr("rel",t),e.attr("value",a.display_text)},T=function(){if(function(){var e=zcal.cdata.opt,t=$("#enotifyType");if(ZCL_$("zcl_MTO")){var a=ZCL_$("zcl_MTO").value;if(!ZCL_isEmail(a))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),ZCL_$("zcl_MTO").focus(),!1;if(a!=e.MTO)return!0}if(t.length){var l=t.find(".msi-option").parent().index();if(e.MT!=l)return!0;var c=-1;if(0===l&&(c=$("#zcl_AI").val()),c!=e.AI)return!0}return!1}()){var e=zcal.cdata.opt,t=$("#enotifyType");(u={}).MTO=ZCL_$("zcl_MTO")?ZCL_$("zcl_MTO").value:e.MTO,u.MT=t.length?t.find(".msi-option").parent().index():e.MT,u.AI=0==u.MT?$("#zcl_AI").val():-1,ZCL_XHR("/cal/set.do?type=notify&mailto="+u.MTO.zcalescape()+"&as="+u.MT+"&agenda_notify="+u.AI,n)}},n=function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status&&(_zm.succErrMsg("s",zcal.i18n.successedit),zcal.cdata.opt.MTO=t.MTO,zcal.cdata.opt.MT=t.MT,zcal.cdata.opt.AI=t.AI)},D=function(e){if(0===e){if(0==$("#zcl_AI").length){var t=$("<li/>");t.html("<span>"+zcal.i18n.agendanotification+"<span>"+zcal.i18n.agendanotification_msg+"</span></span><em>"+ZCL_selBox1("zcl_AI",zcal.cdata.opt.AI,zcal.AGENDA_INTERVAL)+"</em>"),$(".SC_cal_prefer>li:first").after(t)}}else 0<$("#zcl_AI").length&&$("#zcl_AI").parents("LI").remove()},Z=function(){var e,t="";y=$('<div class="SC_setInner"><div class="SC_filt_bottom"/></div>'),t+='<ul class="SC_cal_prefer"><li><span>'+zcal.i18n.emailaddress+"<span>"+zcal.i18n.emailaddress_msg3+"</span></span>",t+='<em><input type="text" id="zcl_MTO" value="'+zcal.cdata.opt.MTO+'" class="inputDefault"></em></li>',t+='<div class="SC_PUbtm left"><span class="sel" data-marker="confirmEmail">'+zcal.i18n.confirm+'</span><span data-val="Cancel" data-marker="cancelEmail">'+zcal.i18n.cancel+"</span></div></ul>";var a=(e=$(t)).find("[data-marker=confirmEmail]").removeAttr("data-marker");a&&a.on("click",function(){r()});var l=e.find("[data-marker=cancelEmail]").removeAttr("data-marker");l&&l.on("click",function(){i()}),y.find(".SC_filt_bottom").append(e),L.empty().append(y)},r=function(){var e=zcal.cdata.opt,t=ZCL_$("zcl_MTO").value.trim();if(e.CMAIL&&""!=e.CMAIL&&t!=e.CMAIL||null==e.CMAIL||""==e.CMAIL&&t!=e.MTO){if(!ZCL_isEmail(t))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),ZCL_$("zcl_MTO").focus(),!1;ZCL_XHR("/cal/set.do?type=changeemail&mailto="+(e.CMAIL=t).zcalescape(),d)}else i()},s=function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a=zcal.cdata.opt;for(var l in t.TZLBL&&(a.TZLBL=t.TZLBL),u)a[l]=u[l];_zm.succErrMsg("s",zcal.i18n.successedit)}},A=function(){!function(){var e,t,a,l,c=zcal.cdata.opt;if(ZCL_$("zcl_TZ")){var i=ZCL_$("zcl_TZ").getAttribute("rel");if(i&&i!=c.TIM)return!0}for(var n=["DF","TF","DEF","WK","WS","WE","HS","HE"],r=0;r<n.length;r++)if(c[n[r]]!=parseInt(ZCL_$("zcl_"+n[r]).value,10))return!0;l=1==$("#zcl_nonWHr").find(".msi-check").length?1:0;var s,d=$("#zcl_autoInv"),o=$("#zcl_showDE"),u=$("#zcl_remNotify");return e=2==(s=d.find(".msi-option").parent().index())?1:1==s?2:0,t=0==o.find(".msi-option").parent().index()?1:0,a=0==u.find(".msi-option").parent().index()?1:0,c.DDE!=t||c.SIE!=e||c.REM!=a||c.NWTB!=l}()?_zm.succErrMsg("i","No Changes made in My Preferences"):a()},M=function(){return'<input type="text" readonly  value="'+unescape(zcal.cdata.opt.CTIM)+'" id="zcl_TZ" class="SC_tiput zcl_nrbr" rel="'+zcal.cdata.opt.TIM+'" />          '},S=function(e){var t=ZCL_Evl(1,e.responseText);zcal.cdata.opt.CMAIL=t.CMAIL,_zm.succErrMsg("s",zcal.i18n.mailsendsuccess)},k=function(e){var t=ZCL_Evl(1,e.responseText);zcal.cdata.opt.CMAIL=t.CMAIL,i()},d=function(e){var t=ZCL_Evl(1,e.responseText);""!=t.MTO&&""==t.CMAIL?(zcal.cdata.opt.MTO=t.MTO,zcal.cdata.opt.CMAIL=t.CMAIL,null!=t.MSG?"INVALID_ID"==t.MSG?_zm.succErrMsg("e",zcal.i18n.nonregisteredemailid):"NOPERM"==t.MSG&&_zm.succErrMsg("e",zcal.i18n.nonregisteredemailid):_zm.succErrMsg("s",zcal.i18n.mailconfirmed)):(zcal.cdata.opt.CMAIL=t.CMAIL,_zm.succErrMsg("s",zcal.i18n.verifymailsend)),i()};return(e=e||{}).myprefRowHTML=function(){var e="",t=zcal.cdata.opt.TIM,a=zcal.DFORMAT[zcal.cdata.opt.DF];zcal.timeformat[zcal.cdata.opt.TF],zcal.cdata.opt.MTO;return e+=ZCL_replaceString(zcal.i18n.mailtimezone,[t]),e+="<strong>|</strong>",e+=ZCL_replaceString(zcal.i18n.maildateformat,[a])},e.init=function(){zmsuite.isWorkspaceAvailable("settings")&&function(){zmailSettings.views.showPreview();var e=$(zmailSettings.views.getPreviewDOM());c=e.find(".SC_ptit"),t(),L=e.find(".SC_Twpr"),i()}()},e.clearTrace=function(){b="general",l.remove(),y.remove(),zmailSettings.currentAppName=void 0},e.showAllTimezone=M,e}(zcalSettings.zcalMyPreferences||{}),zcalSettings.Import=function(e){function t(){l=$('<div class="SC_filt"><div class="SC_filt_Tabs"/></div>');var e={file:{text:zcal.i18n.file,type:"file",id:"zcl_imp_file",click:function(){r="file",s()}},url:{text:zcal.i18n.url,type:"url",id:"zcl_imp_url",click:function(){r="url",s()}}};for(var t in e){var a=$('<a id="'+e[t].id+'"/>');a.addClass(r==e[t].type?"sel":""),a.text(e[t].text),a.off("click").on("click",{click:e[t].click},function(e){var t=$(this);t.parent().find("a").removeClass("sel"),t.addClass("sel"),e.data.click()}),l.find(".SC_filt_Tabs").append(a)}i.append(l)}function a(e,t){var a,l=$("#zcl_impCal");""!=(a=t&&t.calid?p(t.calid):p())&&(l.empty(),l.html(a))}var l,c,i,n,r="file",s=function(){c=$('<div class="SC_setInner"><div class="SC_filt_bottom"/></div>');var e,t='<ul class="SC_cal_prefer">';"url"==r?(t+="<li><span>"+zcal.i18n.weburl+"<span>"+zcal.i18n.weburl_msg+"</span></span>",t+='<em><input type="text" id="zcl_impUrl" class="inputDefault"/>'):(t+="<li><span>"+zcal.i18n.filename+"<span>"+zcal.i18n.browsefile+"</span></span>",t+="<em>",t+='<iframe name="zcl_imp" id="zcl_imp" style="display:none"></iframe><form action="/mail/import.do" method="post" enctype="multipart/form-data" target="zcl_imp" onSubmit="return false;" id="zcl_impEve" name="zcl_impEve">',t+='<input id="zcl_impCkey" value="0" name="zcl_impCkey" type="hidden"/>',t+='<input id="zcl_owrEvent" value="false" name="zcl_owrEvent" type="hidden"/>',t+='<input id="zcl_incAtt" value="false" name="zcl_incAtt" type="hidden"/>',t+='<input id="zcl_incRem" value="false" name="zcl_incRem" type="hidden"/>',t+='<input id="zcl_mkPvt" value="false" name="zcl_mkPvt" type="hidden"/>',t+='<div class="SC_select default"><input type="file" id="zcl_impFil" name="zcl_impFil"/></div>',t+="</form>"),t+='<span id="zcl_impMoreOptTxt" class="cnew SC_lnk pl5">'+zcal.i18n.moreoptions+'</span><div style="display:none;" id="zcl_impMoreOpt" class="moreOptions"></div>',t+="</em></li>",t+="<li><span>"+zcal.i18n.calname+'</span><em><div class="SC_select default">'+u()+"</div></em></li>",t+='<div class="SC_PUbtm left"><span class="sel" data-marker="calImport">'+zcal.i18n.import+"</span></div>",t+="</ul>";var a=(e=$(t)).find("[data-marker=calImport]").removeAttr("data-marker");a.length&&a.on("click",{type:r},function(e){("url"===e.data.type?m:z)()}),e.find("#zcl_impMoreOptTxt").off("click").on("click",function(e){d()});var l=e.find("select");l.length&&l.change(function(){0==this.value&&ZCL_createCal()}),c.find(".SC_filt_bottom").append(e),n.empty().append(c)},d=function(){var e,t,a,l,c=$("#zcl_impMoreOpt"),i=$("#zcl_impMoreOptTxt");c.is(":visible")?(c.html(""),i.text(zcal.i18n.moreoptions),c.hide()):((e=$('<span id="zcl_impOvr"><div><i class="msi-uncheck"/><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></span>")).off("click").on("click",function(e){var t;t=$(this).find("i"),o(t)}),c.append(e),(t=$('<span id="zcl_impAtt"><div><i class="msi-uncheck"/><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></span>")).off("click").on("click",function(e){var t;t=$(this).find("i"),o(t)}),c.append(t),(a=$('<span id="zcl_impRem"><div><i class="msi-uncheck"/><span class="pl5">'+zcal.i18n.includereminder+"</span></div></span>")).off("click").on("click",function(e){var t;t=$(this).find("i"),o(t)}),c.append(a),(l=$('<span id="zcl_impPvt"><div><i class="msi-uncheck"/><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></span>")).off("click").on("click",function(e){var t;t=$(this).find("i"),o(t)}),c.append(l),i.text(zcal.i18n.hideoptions),c.show())},o=function(e){e.hasClass("msi-check")?e.removeClass("msi-check").addClass("msi-uncheck"):e.removeClass("msi-uncheck").addClass("msi-check")},u=function(){var e='<select id="zcl_impCal">';return e+=p(),e+="</select>"},p=function(a){var e=zcal.cdata.calOrdArr,l="";return e.forEach(function(e){var t=zcal.cdata.calLst;"1"==t[e][8]&&(l+='<option value="'+t[e][9]+'" data-cid="'+e+'" '+(e==a?"selected":"")+">"+ZCL_getHTML(t[e][0])+"</option>")}),e.length<100&&(l+='<option value="0">'+zcal.i18n.newcal+"</option>"),l},m=function(){var e,t,a=ZCL_$("zcl_impUrl").value.trim(),l=!1,c=!1,i=!1,n=!1,r=$("#zcl_impMoreOpt");if(!/^(http|https|webcal|webcals)\:\/\/[-.\w]*(\/?)([a-zA-Z0-9\-\.\?\,\:\'\/\\\+=&amp;%\$#_@]*)?$/i.test(a))return zmUtil.succErrMsg("e",zcal.i18n.entervalidhttpurl),!1;if(r.is(":visible")){var s=$("#zcl_impOvr").find("i"),d=$("#zcl_impAtt").find("i"),o=$("#zcl_impRem").find("i"),u=$("#zcl_impPvt").find("i");l=!!s.hasClass("msi-check"),c=!!d.hasClass("msi-check"),i=!!o.hasClass("msi-check"),n=!!u.hasClass("msi-check")}if(null==(e=ZCL_$("zcl_impCal").value))return zmUtil.succErrMsg("e",zcal.i18n.selvacalnam),!1;t=$("#zcl_impCal option:selected").data("cid"),ZCL_XHR("/impurl.do?url="+encodeURIComponent(a)+"&impCkey="+e+"&incAtt="+c+"&owrEvent="+l+"&incRem="+i+"&mkPvt="+n+(t?"&calId="+t:""),function(e){var t=ZCL_Evl(1,e.responseText);_(t)})},_=function(e){""==e||0==e.PCNT?zmUtil.succErrMsg("e",zcal.i18n.failimport):("10000"<e.TCNT?zmUtil.succErrMsg("e",zcal.i18n.importfailure_exceedlimit):(zmUtil.succErrMsg("s",zcal.i18n.successimport+". "+zcal.i18n.totallyprocessed+" : "+(null==e.PCNT?0:e.PCNT)+". "+zcal.i18n.actuallyimported+" : "+(null==e.ACNT?0:e.ACNT)),zcalEvents.loadMonthData()),ZCL_$("zcl_impUrl").value="")},z=function(){var e,t=!1,a=!1,l=!1,c=!1,i=$("#zcl_impFil").val().trim(),n=$("#zcl_impMoreOpt");if(".ics"!=i.substr(i.lastIndexOf(".")))return zmUtil.succErrMsg("e",zcal.i18n.validicsfile),!1;if(n.is(":visible")){var r=$("#zcl_impOvr").find("i"),s=$("#zcl_impAtt").find("i"),d=$("#zcl_impRem").find("i"),o=$("#zcl_impPvt").find("i");t=!!r.hasClass("msi-check"),a=!!s.hasClass("msi-check"),l=!!d.hasClass("msi-check"),c=!!o.hasClass("msi-check")}if(null==(e=$("#zcl_impCal").val()))return zmUtil.succErrMsg("e",zcal.i18n.selvacalnam),!1;$("#zcl_impCkey").val(e);var u,p=document.cookie;u=-1!=(p=p.substring(p.indexOf("aprmjrnpkcrkks=")+15,p.length)).indexOf(";")?p.substring(0,p.indexOf(";")):p,document.zcl_impEve.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:"mstpcrdhkur",value:u}}])),$("#zcl_owrEvent").val(t),$("#zcl_incAtt").val(a),$("#zcl_incRem").val(l),$("#zcl_mkPvt").val(c),document.zcl_impEve.submit()},f=function(){$.subscribe("/calendar/added",a),$.subscribe("/calendar/updated",a),$.subscribe("/calendar/deleted",a),$.subscribe("/calendar/statusChanged",a)};return(e=e||{}).init=function(){zmsuite.isWorkspaceAvailable("settings")&&(function(){zmailSettings.views.showPreview();var e=$(zmailSettings.views.getPreviewDOM());i=e.find(".SC_ptit"),t(),n=e.find(".SC_Twpr"),s()}(),f())},e.clearTrace=function(){r="file",l.remove(),c.remove(),zmailSettings.currentAppName=void 0,$.unsubscribe("/calendar/added",a),$.unsubscribe("/calendar/updated",a),$.unsubscribe("/calendar/deleted",a),$.unsubscribe("/calendar/statusChanged",a)},e.showImportStatus=function(e){if(""==e)zmUtil.succErrMsg("e",zcal.i18n.failimport);else{var t=ZCL_Evl(1,e);0==t.PCNT?zmUtil.succErrMsg("e",zcal.i18n.failimport):("10000"<t.TCNT?zmUtil.succErrMsg("e",zcal.i18n.failimport+"<br/>Unable to import as it exceeds the limit of 10000 events."):(zmUtil.succErrMsg("s",zcal.i18n.successimport+". "+zcal.i18n.totallyprocessed+" : "+(null==t.PCNT?0:t.PCNT)+". "+zcal.i18n.actuallyimported+" : "+(null==t.ACNT?0:t.ACNT)),zcalEvents.loadMonthData()),ZCL_$("zcl_impFil").value="")}},e}(zcalSettings.Import||{}),zcalSettings.Subscribe=function(e){function t(){i=$('<div class="SC_filt"><div class="SC_filt_Tabs"/></div>');var e={weburl:{text:zcal.i18n.weburl,type:"weburl",id:"zcl_subscribe_weburl",click:function(){r="weburl",d()}},friendscal:{text:zcal.i18n.friendscalendar,type:"friendscal",id:"zcl_subscribe_friendscal",click:function(){r="friendscal",d()}},holidays:{text:zcal.i18n.holidays,type:"holidays",id:"zcl_subscribe_holidays",click:function(){r="holidays",d()}}};for(var t in e){var a=$('<a id="'+e[t].id+'"/>');a.addClass(r==e[t].type?"sel":""),a.text(e[t].text),a.off("click").on("click",{click:e[t].click},function(e){var t=$(this);t.parent().find("a").removeClass("sel"),t.addClass("sel"),e.data.click()}),i.find(".SC_filt_Tabs").append(a)}l.append(i)}function c(){if(p.show(),_.html("").hide(),0==z.length){ZCL_XHR("/cal/subHoli.do?mode=list",function(e){var t;"list"==(t=ZCL_Evl(1,e.responseText)).mode&&(z=t.obj,s())})}else s()}var i,m,l,n,p,_,z=[],f=[],r="weburl",s=function(){for(var e,t,a,l,c,i=z,n=$('<ul class="SC_cal_groups" id="zcl_hlist"/>'),r=0;r<i.length;r++){var s=$("<li/>"),d="";d+="<span>"+ZCL_getHTML(i[r][0]),-1==zcal.cdata.calOUids.indexOf(i[r][1])?d+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":d+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",d+="</span>",s.html(d);var o=s.find("[data-marker=sub]").removeAttr("data-marker");o.length&&(a=o,l=i[r][1],c=i[r][0],a.on("click",{uid:l,name:c},function(e){v(e.data.uid,e.data.name)}));var u=s.find("[data-marker=unsub]").removeAttr("data-marker");u.length&&(e=u,t=i[r][1],e.on("click",{uid:t},function(e){L(e.data.uid)})),n.append(s)}m.find(".SC_filt_bottom").empty().append(n),p.hide(),_.show()},v=function(e,t){ZCL_XHR("/cal/subHoli.do?mode=sub&huid="+encodeURIComponent(e)+"&loc="+t,function(e){a(e)})},d=function(){if(m=$('<div class="SC_setInner"><div class="SC_filt_bottom" data-marker="listContainer"/><div data-marker="loadingAnimation"/></div>'),p=m.find("[data-marker=loadingAnimation]").removeAttr("data-marker"),_=m.find("[data-marker=listContainer]").removeAttr("data-marker"),"holidays"==r)n.empty().append(m),zmComponent.loadingBand({container:p[0],type:"pagination"}),c();else{var e,t;m=$('<div class="SC_setInner"><div class="SC_filt_bottom"/></div>'),t='<ul class="SC_cal_prefer">',"friendscal"==r?(t+="<li><span>"+zcal.i18n.friendemailaddress+"<span>"+zcal.i18n.friendemailaddress_msg+'</span></span><em><input type="text" class="inputDefault" id="zcl_fEmailId"></em></li>',t+='<div class="SC_PUbtm left"><span class="sel" data-marker="listFCal">'+zcal.i18n.ok+"</span></div>"):(t+="<li><span>"+zcal.i18n.weburl+"<span>"+zcal.i18n.weburl_msg+'</span></span><em><input type="text" class="inputDefault" id="zcl_subLink"></em></li>',t+='<div class="SC_PUbtm left"><span class="sel" data-marker="subToCal">'+zcal.i18n.subscribe+"</span></div>"),t+="</ul>";var a=(e=$(t)).find("[data-marker=listFCal]").removeAttr("data-marker");a.length&&a.on("click",function(e){E()});var l=e.find("[data-marker=subToCal]").removeAttr("data-marker");l.length&&l.on("click",function(e){var t=ZCL_$("zcl_subLink").value.trim();if(""==t)return _zm.succErrMsg("e",zcal.i18n.entervalidhttpurl),ZCL_$("zcl_subLink").focus(),!1;u(t)}),m.find(".SC_filt_bottom").append(e),n.empty().append(m)}},o=function(){zmsDialog.remove(!0),$("#zcl_urlsubscribe_confirm").remove()},u=function(e){ZCL_XHR("/cal/subCal.do?mode=sub-url&url="+encodeURIComponent(e),function(e){a(e)})},a=function(e){if(200===e.status){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a,l=t.obj;zcal.cdata.calOLst=l.clst,zcal.cdata.calOUids=l.Uids,zcal.cdata.calGLst=l.gclst,ZCL_updateAppCalList(l.aclst),_zm.succErrMsg("s",zcal.i18n.calSubSuccess),$.publish("/calendar/subscribed"),i&&("zcl_subscribe_holidays"==(a=i.find(".sel"))[0].id?s():"zcl_subscribe_friendscal"==a[0].id&&h())}else _zm.succErrMsg("e",zcal.i18n[t.status])}else _zm.succErrMsg("e",zcal.i18n.errmsg)},h=function(){var e,t,a,l,c=f[0],i=f[1];if((t=m.find("#zcl_FPubCalList")).length||(t=$('<div id="zcl_FPubCalList"/>'),m.append(t)),t.html("<h3>"+zcal.i18n.publiccal+'</h3><ul class="SC_cal_groups"></li>'),e=t.find(".SC_cal_groups"),ZCL_isEmpty(c)){var n="<li><em>"+zcal.i18n.calnotfound+"</em></li>";e.html(n)}else for(var r in c){var s=$("<li/>"),d="";d+="<span>"+ZCL_getHTML(c[r][0]),-1==zcal.cdata.calOUids.indexOf(c[r][2])?d+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":d+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",d+="</span>",d+="<em>"+(1==c[r][1]?zcal.i18n.viewonlyfreebusy:zcal.i18n.vieweventdetail)+"</em>",s.html(d),(o=s.find("[data-marker=sub]").removeAttr("data-marker")).length&&o.on("click",{id:r},function(e){C(e.data.id)}),(u=s.find("[data-marker=unsub]").removeAttr("data-marker")).length&&u.on("click",{uid:c[r][2]},function(e){L(e.data.uid)}),e.append(s)}if(!ZCL_isEmpty(i))for(var r in(a=m.find("#zcl_FPvtCalList")).length||(a=$('<div id="zcl_FPvtCalList"/>'),m.append(a)),a.html("<h3>"+zcal.i18n.privatecal+'</h3><ul class="SC_cal_groups"/>'),l=a.find(".SC_cal_groups"),i){var o,u;s=$("<li/>"),d="";d+="<span>"+ZCL_getHTML(i[r][0]),-1==zcal.cdata.calOUids.indexOf(i[r][2])?d+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":d+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",d+="</span>",d+="<em>"+(1==i[r][1]?zcal.i18n.viewonlyfreebusy:zcal.i18n.vieweventdetail)+"</em>",s.html(d),(o=s.find("[data-marker=sub]").removeAttr("data-marker")).length&&o.on("click",{id:r},function(e){y(e.data.id)}),(u=s.find("[data-marker=unsub]").removeAttr("data-marker")).length&&u.on("click",{uid:i[r][2]},function(e){L(e.data.uid)}),l.append(s)}var p=m.find("#zcl_pvtshreqlnk");p.length||(p=$('<span class="SC_lnk" id="zcl_pvtshreqlnk"/>'),m.append(p)),p.html("&raquo;"+zcal.i18n.sendreqforindividualshare),p.off("click").on("click",{eid:f[2]},function(e){g(e.data.eid)}),m.append(p)},g=function(e){ZCL_XHR("/cal/sentReq.do?mailId="+e.zcalescape(),function(e){b(e)})},C=function(e){ZCL_XHR("/cal/subCal.do?mode=sub-url&url="+encodeURIComponent(location.protocol+"//"+zcal.ZCAL+"/ical/"+e),function(e){a(e)})},y=function(e){ZCL_XHR("/cal/shareCal.do?mode=pvtshcal-sub&ckey="+f[1][e][4],function(e){a(e)})},L=function(e){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(e),function(e){!function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a,l=t.id;zcal.cdata.calLst[l]?(delete zcal.cdata.calLst[l],ZCL_remCalid(l),_zm.succErrMsg("s",zcal.i18n.caldeleted)):(zcal.cdata.calOLst[l]||zcal.cdata.calGLst[l]||zcal.cdata.calALst[l])&&(zcal.cdata.calGLst[l]?delete zcal.cdata.calGLst[l]:zcal.cdata.calALst[l]?delete zcal.cdata.calALst[l]:delete zcal.cdata.calOLst[l],ZCL_remOCalid(t.uid),_zm.succErrMsg("s",zcal.i18n.unsubscribesuc)),ZCL_gothro(l),"zcl_subscribe_holidays"==(a=i.find(".sel"))[0].id?s():"zcl_subscribe_friendscal"==a[0].id&&h()}else _zm.succErrMsg("e",t.status)}(e)})},b=function(){_zm.succErrMsg("s",zcal.i18n.requestmailsent)},E=function(){var e=$("#zcl_fEmailId").val();if(!ZCL_isEmail(e))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),ZCL_$("zcl_fEmailId").focus(),!1;ZCL_XHR("/cal/subCal.do?mode=pub-lst&mailId="+e.zcalescape(),function(e){!function(e){var t=ZCL_Evl(1,e.responseText);if("pub-lst"==t.mode)if("du"==t.result){var a=t.obj;f=[a.pub,a.pvt,t.mid],h()}else"su"==obj.result?_zm.succErrMsg("i",zcal.i18n.cannotsubtoowncal):"nonzoho"==obj.result?_zm.succErrMsg("i",ZCL_replaceComName(zcal.i18n.theuserdonthavezohoacc)):"np"==obj.result&&_zm.succErrMsg("e",zcal.i18n.cannotsubnonorgmemcal)}(e)})};return(e=e||{}).init=function(){zmsuite.isWorkspaceAvailable("settings")&&function(){zmailSettings.views.showPreview();var e=$(zmailSettings.views.getPreviewDOM());l=e.find(".SC_ptit"),t(),n=e.find(".SC_Twpr"),d()}()},e.clearTrace=function(){r="weburl",i.remove(),m.remove(),zmailSettings.currentAppName=void 0},e.confirmAndSubscribe=function(e){var t=$.Deferred();$("#zcl_urlsubscribe_confirm").length||$("body").append("<div id='zcl_urlsubscribe_confirm' />"),$("#zcl_urlsubscribe_confirm").html(e);var a={title:"Do you want to add calendar?",style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){o(),t.reject()},buttons:[{txt:"Yes",callback:function(){u(e),o(),t.resolve()}},{txt:"No",callback:function(){o(),t.reject()}}]};return zmsDialog.create("zcl_urlsubscribe_confirm",a),t.promise()},e}(zcalSettings.Subscribe||{}),zcalSettings.Sync=function(e){e=e||{};var t,n,a,r,o,u,l,s=[],c=1,i=!1,d=null,p=0,m=function(){var e,t=(n=$('<div class="SC_setInner"><div class="SC_filt_bottom"><ul class="SC_cal_groups"/></div></div>')).find(".SC_cal_groups"),a=(e={},-1!=zcal.ZCAL.indexOf("zoho")&&-1==zcal.ZCAL.indexOf("zoho.com.cn")&&-1==zcal.ZCAL.indexOf("baihui")&&(e.outlook={text:zcal.i18n.outlook,msg:ZCL_replaceProName(zcal.i18n.outlook_subnote),type:"outlook",click:function(){m()}}),-1==zcal.ZCAL.indexOf("zoho.com.cn")&&-1==zcal.ZCAL.indexOf("baihui")&&(e.gcal={text:zcal.i18n.gcal,msg:ZCL_replaceProName(zcal.i18n.gcal_subnote),type:"gcal",click:function(){m()}}),e.caldav={text:zcal.i18n.caldav,msg:ZCL_replaceProName(zcal.i18n.caldav_subnote),type:"caldav",click:function(){m()}},-1==zcal.ZCAL.indexOf("zoho.com.cn")&&-1==zcal.ZCAL.indexOf("baihui")&&(e.zcalsync={text:ZCL_replaceComName(zcal.i18n.zcalsync),msg:ZCL_replaceProName(zcal.i18n.zcalsync_subnote),type:"zcalsync",click:function(){m()}}),e);for(var l in a){var c=a[l],i=$("<li/>");i.html("<span>"+c.text+"</span><em>"+c.msg+"</em>"),i.on("click",{type:c.type},function(e){_(e.data.type)}),t.append(i)}r.empty().append(n)},_=function(e){"caldav"===e?f():"gcal"===e?h():"outlook"===e?M():"zcalsync"===e&&z()},z=function(){var e="https://"+zcal.ZOHOSTATIC+"/help/user-guide/calsync-android.html";window.open(e,"_blank")},f=function(){var e,t;ZCL_$("zcl_caldav_pp")||$("body").append("<div id='zcl_caldav_pp'/>"),(t=$("#zcl_caldav_pp")).html('<div><div class="SC_filt_bottom zcl_cdavovr" data-marker="listContainer"/><div data-marker="loadingAnimation"/></div>'),o=t.find("[data-marker=loadingAnimation]").removeAttr("data-marker"),u=t.find("[data-marker=listContainer]").removeAttr("data-marker");var a=(_defineProperty(e={title:zcal.i18n.caldav_help,mask:!0,drag:!1},"mask",!0),_defineProperty(e,"ptr","tright"),_defineProperty(e,"pos","center"),_defineProperty(e,"style",{"min-width":"600px","max-width":"750px"}),_defineProperty(e,"customClass","SC_SetPop"),_defineProperty(e,"buttons",[{txt:zcal.i18n.ok,callback:function(){$("#zcl_caldav_pp").remove(),zmsDialog.remove(!0)}}]),_defineProperty(e,"closeaction",function(){$("#zcl_caldav_pp").remove(),zmsDialog.remove()}),e);zmsDialog.create("zcl_caldav_pp",a),zmComponent.loadingBand({container:o[0],type:"pagination"}),o.show(),u.html("").hide(),ZCL_XHR("/cal/caldavCalLst.do?mode=callist",function(e){var t=ZCL_Evl(1,e.responseText);v(t)})},v=function(e){u.empty();var t=$('<div class="SC_cal_groups"><ul></ul></div>');for(var a in e){var l=e[a],c=ZCL_getHTML(l.NAME),i=1==l.SHOWHIDE,n=l.CALID,r=1==l.ISDEF,s=1==l.SYNC,d=$('<li class="'+(i?"":"disable")+'"><i class="'+(r||s?"msi-check":"msi-uncheck")+'"></i><span>'+c+"</span></li>");r||d.off("click").on("click",{calid:n},function(e){var t,a=e.data.calid;"msi-uncheck"==(t=$(this).find("i"))[0].className?t.removeClass("msi-uncheck").addClass("msi-check"):t.removeClass("msi-check").addClass("msi-uncheck"),ZCL_XHR("/cal/enablecaldav.do?mode="+("msi-check"==t[0].className?"enable":"disable")+"&calid="+a,function(e){ZCL_Evl(1,e.responseText)})}),t.find("ul").append(d)}u.append(t),o.hide(),u.show()},h=function(){var e,t;ZCL_$("zcl_gcal_pp")||$("body").append("<div id='zcl_gcal_pp'/>"),(t=$("#zcl_gcal_pp")).html('<div><div data-marker="loadingAnimation"/><div><ul class="SC_cal_groups SC_setInner zcl_ovr" id="zcl_gcallst"/><div/></div>'),o=t.find("[data-marker=loadingAnimation]").removeAttr("data-marker");var a=(_defineProperty(e={title:zcal.i18n.gcal,mask:!0,drag:!1},"mask",!0),_defineProperty(e,"ptr","tright"),_defineProperty(e,"pos","center"),_defineProperty(e,"style",{"min-width":"600px","max-width":"750px"}),_defineProperty(e,"customClass","SC_SetPop"),_defineProperty(e,"closeaction",function(){$("#zcl_gcal_pp").remove(),zmsDialog.remove()}),e);zmsDialog.create("zcl_gcal_pp",a),s&&0<s.length?E():(zmComponent.loadingBand({container:o[0],type:"pagination"}),o.show(),ZCL_XHR("/cal/getGCal.do?mode=auth",function(e){s=ZCL_Evl(1,e.responseText),g()}))},g=function(){if(s)o.hide(),E();else{function t(e){(e.origin||e.originalEvent.origin)===a&&(b(),e.source.close(),window.addEventListener?window.removeEventListener("message",t,!1):window.detachEvent("onmessage",t))}var a=document.location.protocol+"//"+zcal.ZCAL;window.addEventListener?window.addEventListener("message",t,!1):window.attachEvent("onmessage",t);var e=(document.body.offsetHeight-500)/2,l=(document.body.offsetWidth-700)/2,c="GoogleAuthenticationWindow_"+location.hostname.split(".")[0];i=window.open(zcal.GCALSYNC,c,"menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=no,width=700,height=500,left="+l+",top="+e),d=d||setTimeout(function(){checkGCalWinStatus()},5e3)}};function C(){return l.apply(this,arguments)}checkGCalWinStatus=(l=function(){d&&clearTimeout(d),12==c||i.closed?(i&&i.close(),0<$("#zcl_gcal_pp").length&&(zmsDialog.remove(),$("#zcl_gcal_pp").remove()),d=null,i=!(c=1)):(c++,d=setTimeout(function(){checkGCalWinStatus()},5e3))},C.toString=function(){return l.toString()},C);function y(e){p=e}function L(){zmailSettings.views.showPreview();var e=$(zmailSettings.views.getPreviewDOM());a=e.find(".SC_ptit"),t=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.sync+"</div></div>"),a.append(t),r=e.find(".SC_Twpr"),m()}var b=function(){d&&clearTimeout(d),ZCL_XHR("/cal/getGCal.do?mode=list",function(e){s=ZCL_Evl(1,e.responseText),g()})},E=function(){if(s&&0<s.length){var e=$("#zcl_gcallst");if(0<e.length){e.empty();for(var t=0;t<s.length;t++){var a=$("<li/>"),l="";s[t].gcalName=s[t].gcalName.replace("<","&lt;").replace(">","&gt;"),l+='<span id="zcl_synccal">'+s[t].gcalName,-1==zcal.cdata.calOUids.indexOf("gCal_"+decodeURIComponent(s[t].gcalId))?l+='<span class="button" data-marker="sub">'+zcal.i18n.synchronize+"</span>":l+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span>",l+="</span>",1===p&&(a.addClass("zcl_disls"),l+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),a.html(l);var c=a.find("[data-marker=sub]").removeAttr("data-marker");c.length&&T(c,{gcalId:s[t].gcalId,gcalName:s[t].gcalName,authMail:s[t].authMail});var i=a.find("[data-marker=unsub]").removeAttr("data-marker");i.length&&D(i,{gcalId:s[t].gcalId,gcalName:s[t].gcalName,authMail:s[t].authMail}),e.append(a)}}}},T=function(e,t){e.off("click").on("click",{calid:t.gcalId,calname:t.gcalName,email:t.authMail},function(e){A(),ZCL_XHR("/cal/getGCal.do?mode=sub&calId="+e.data.calid+"&calName="+e.data.calname+"&ownerMailID="+e.data.email,Z)})},D=function(e,t){e.off("click").on("click",{calid:t.gcalId,calname:t.gcalName},function(e){ZCL_XHR("/cal/getGCal.do?mode=unsub&calId="+e.data.calid+"&calName="+e.data.calname,function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status&&(s=null,(p=0)<$("#zcl_gcal_pp").length&&(zmsDialog.remove(),$("#zcl_gcal_pp").remove()),$.publish("/calendar/deleted",{calid:t.id,caluid:t.uid,mode:"delete"}))})})},Z=function(e){if(ZCL_clrStck(),200==e.status){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a=t.obj;zcal.cdata.calOLst=a.clst,zcal.cdata.calOUids=a.Uids,zcal.cdata.calGLst=a.gclst,ZCL_updateAppCalList(a.aclst),$.publish("/calendar/subscribed")}}},A=function(){var e=$("#zcl_gcallst");y(1);var t=e.find("#zcl_synccal");0==e.find("#zcl_syncstatus").length&&t.after($('<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>")),e.find("#zcl_syncstatus").parent().addClass("zcl_disls"),t.find("span.button").off("click")},M=function(){var e,t=$(zcalTemplate.OutlookPopup());t.find("a").addClass("SC_lnk");var a=(_defineProperty(e={title:ZCL_replaceProName(zcal.i18n.mstitle),mask:!0,drag:!1},"mask",!0),_defineProperty(e,"ptr","tright"),_defineProperty(e,"pos","center"),_defineProperty(e,"style",{"min-width":"600px","max-width":"750px"}),_defineProperty(e,"customClass","SC_SetPop"),_defineProperty(e,"closeaction",function(){$("#zcl_grpcallst_pp").remove(),zmsDialog.remove()}),e);ZCL_$("zcl_olpp")||$("body").append('<div id="zcl_olpp"></div>'),$("#zcl_olpp").html(t),zmsDialog.create("zcl_olpp",a)};return e.init=function(){zmsuite.isWorkspaceAvailable("settings")&&L()},e.clearTrace=function(){t.remove(),n.remove(),zmailSettings.currentAppName=void 0},e.reqGCalList=b,e.setGCalSyncStatus=y,e.listGCal=E,e}(zcalSettings.Sync||{}),zcalSettings.zcalGroupList=function(e){function t(){l=$('<div class="SC_filt"><div class="SC_filt_Tabs"/></div>');var e={personal:{text:zcal.i18n.personal_group,type:"personal",id:"zcl_group_personal",click:function(){m="personal",i()}},org:{text:zcal.i18n.org_group,type:"org",id:"zcl_group_org",click:function(){m="org",i()}}};for(var t in e){var a=$('<a id="'+e[t].id+'"/>');a.addClass(m==e[t].type?"sel":""),a.text(e[t].text),a.off("click").on("click",{click:e[t].click},function(e){var t=$(this);t.parent().find("a").removeClass("sel"),t.addClass("sel"),e.data.click()}),l.find(".SC_filt_Tabs").append(a)}c.append(l)}function a(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a,l=t.obj,c=t.uid;zcal.cdata.calOLst=l.clst,zcal.cdata.calOUids=l.Uids,zcal.cdata.calGLst=l.gclst,ZCL_updateAppCalList(l.aclst),_zm.succErrMsg("s",zcal.i18n.calSubSuccess),updateGrpCalLst(c),"zcl_grpcal_sh"==(a=$("#zcl_grpcallst_tabs").find(".sel"))[0].id?s("sh"):"zcl_grpcal_sub"==a[0].id?s("sub"):s("def"),$.publish("/calendar/subscribed")}else"available"==t.status?_zm.succErrMsg("s",zcal.i18n.calSubSuccess):_zm.succErrMsg("e",t.status)}var d,l,o,c,u,p={},m="personal",i=function(){var e,t,a,l,c;e=(o=$('<div class="SC_setInner"><div class="SC_filt_bottom"><ul class="SC_cal_groups"/></div></div>')).find(".SC_cal_groups"),t=zcalGroup.getGroupList(m);for(var i=0;i<t.length;i++){var n=zcalGroup.getGroup(t[i]);if(n){var r=$("<li/>"),s=ZCL_getHTML(n.name);r.html("<span>"+s+"</span><em>"+ZCL_getDescHTML(n.desc)+"</em>"),a=r,l=t[i],c=s,a.on("click",{id:l,name:c},function(e){d=e.data.name,_(e.data.id)}),e.append(r)}}u.empty().append(o)};updateGrpCalLst=function(e){if(!ZCL_isEmpty(p)){if(p.owncLst&&p.owncLst[e])return void(p.owncLst[e].IS_SUB=0==p.owncLst[e].IS_SUB?1:0);if(p.shdcLst&&p.shdcLst[e])return void(p.shdcLst[e].IS_SUB=0==p.shdcLst[e].IS_SUB?1:0);p.subcLst&&p.subcLst[e]&&(p.subcLst[e].IS_SUB=0==p.subcLst[e].IS_SUB?1:0)}};function n(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a,l=t.id,c=t.uid;$.publish("/calendar/deleted",{calid:l,caluid:c,mode:"unsubscribe"}),updateGrpCalLst(c),"zcl_grpcal_sh"==(a=$("#zcl_grpcallst_tabs").find(".sel"))[0].id?s("sh"):"zcl_grpcal_sub"==a[0].id?s("sub"):s("def")}else _zm.succErrMsg("e",t.status)}var _=function(e){var t;ZCL_$("zcl_grpcallst_pp")||$("body").append("<div id='zcl_grpcallst_pp' class='zcl_ovr'/>"),(t=$("#zcl_grpcallst_pp")).html('<div><div class="SC_filt_Tabs none" id="zcl_grpcallst_tabs"></div><div data-marker="loadingAnimation"></div><div id="zcl_heigGrp" ><ul class="SC_cal_groups SC_setInner zcl_ovr" id="zcl_grpcallst"/></div></div>'),$loadAnimationDOM=t.find("[data-marker=loadingAnimation]").removeAttr("data-marker"),r();var a,l,c={title:d,mask:!0,drag:!1,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",closeaction:function(){$("#zcl_grpcallst_pp").remove(),zmsDialog.remove()}};zmsDialog.create("zcl_grpcallst_pp",c),zmComponent.loadingBand({container:$loadAnimationDOM[0],type:"pagination"}),$loadAnimationDOM.show(),$.when((a=e,l=$.Deferred(),ZCL_XHR("/cal/grpDtl.do?mode=grp-callst&comid="+a,function(e){p=ZCL_Evl(1,e.responseText),l.resolve(p)}),l)).then(function(e){$loadAnimationDOM.hide(),s("def")})},r=function(){for(var e,t,a=$("#zcl_grpcallst_tabs"),l=[{type:"def",text:zcal.i18n.default},{type:"sh",text:zcal.i18n.shared},{type:"sub",text:zcal.i18n.subscribed}],c=0;c<l.length;c++){var i=$('<a id="zcl_grpcal_'+l[c].type+'"/>');i.addClass("def"==l[c].type?"sel":""),i.text(l[c].text),e=i,t=l[c].type,e.off("click").on("click",{type:t},function(e){var t=$(this);t.parent().find("a").removeClass("sel"),t.addClass("sel"),s(e.data.type)}),a.append(i)}},s=function(e){var t,a=$("#zcl_grpcallst");if(t="sh"==e?p.shdcLst:"sub"==e?p.subcLst:p.owncLst,a.empty(),5<Object.keys(p.shdcLst).length&&$("#zcl_heigGrp").css({height:"300px","overflow-x":"hidden","overflow-y":"auto"}),ZCL_isEmpty(t)){if(a.is(":empty")){i=$("<li><em>"+zcal.i18n.nocalendar+"</em></li>");a.append(i)}}else for(var l in t){var c=t[l],i=$("<li/>"),n="";n+="<span>"+c.CNAME,0==c.IS_SUB?n+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":n+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",n+="</span>",i.html(n);var r=i.find("[data-marker=sub]").removeAttr("data-marker");r.length&&r.on("click",{uid:l,gid:p.comid},function(e){z(e.data.uid,e.data.gid)});var s=i.find("[data-marker=unsub]").removeAttr("data-marker");s.length&&s.on("click",{uid:l},function(e){f(e.data.uid)}),a.append(i)}},z=function(e,t){ZCL_XHR("/cal/subCal.do?mode=grpcal-sub&caluid="+encodeURIComponent(e)+"&grpid="+t,a)},f=function(e){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(e),n)};return(e=e||{}).init=function(){zmsuite.isWorkspaceAvailable("settings")&&function(){zmailSettings.views.showPreview();var e=$(zmailSettings.views.getPreviewDOM());c=e.find(".SC_ptit"),t(),u=e.find(".SC_Twpr"),i()}()},e.clearTrace=function(){m="personal",l.remove(),o.remove(),zmailSettings.currentAppName=void 0},e}(zcalSettings.zcalGroupList),zcalSettings.appList=function(e){function t(){zmailSettings.views.showPreview();var e=$(zmailSettings.views.getPreviewDOM());l=e.find(".SC_ptit"),a=$('<div class="SC_settHead"><div class="SC_phd">'+ZCL_replaceComName(zcal.i18n.zohoapps)+"</div></div>"),l.append(a),n=e.find(".SC_Twpr"),p()}var a,i,l,n,c,r,s,d,o,u={},p=function(){var e=(i=$('<div class="SC_setInner"><div class="SC_filt_bottom"><ul class="SC_cal_groups"/></div></div>')).find(".SC_cal_groups"),t={zcrm:{text:ZCL_replaceComName(zcal.i18n.zohocrm),msg:zcal.i18n.sync,type:"crm",click:function(){p()}},zrecruit:{text:ZCL_replaceComName(zcal.i18n.zohorecruit),msg:zcal.i18n.sync,type:"recruit",click:function(){p()}},ztask:{text:ZCL_replaceComName(zcal.i18n.zohotask),msg:zcal.i18n.sync,type:"task-sync",click:function(){p()}},zprojects:{text:ZCL_replaceComName(zcal.i18n.zohoprojects),msg:zcal.i18n.subscribe,type:"project",click:function(){p()}},zcontacts:{text:ZCL_replaceComName(zcal.i18n.zohocontacts),msg:zcal.i18n.subscribe,type:"contacts",click:function(){p()}}};for(var a in t){var l,c=t[a];("crm"==c.type&&""!=zcal.ZCRM||"recruit"==c.type&&""!=zcal.ZRECRUIT||"task-sync"==c.type&&""!=zcal.ZTSK||"project"==c.type||"contacts"==c.type)&&((l="error"===u[c.type]?$('<li class="zcl_disable"/>'):$("<li/>")).html("<span>"+c.text+"</span><em>"+c.msg+"</em>"),l.hasClass("zcl_disable")||l.on("click",{type:c.type,txt:c.text},function(e){m(e.data.type,e.data.txt)}),e.append(l))}n.empty().append(i)},m=function(t,e){var a;ZCL_$("zcl_appcallst_pp")||$("body").append("<div id='zcl_appcallst_pp' class='zcl_ovr'/>"),(a=$("#zcl_appcallst_pp")).html('<div><div data-marker="loadingAnimation"></div><div><ul class="SC_cal_groups SC_setInner zcl_ovr" id="zcl_appcallst" data-app="'+t+'"/></div></div>'),c=a.find("[data-marker=loadingAnimation]").removeAttr("data-marker");var l={title:e,mask:!0,drag:!1,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",closeaction:function(){$("#zcl_appcallst_pp").remove(),zmsDialog.remove()}};zmsDialog.create("zcl_appcallst_pp",l),zmComponent.loadingBand({container:c[0],type:"pagination"}),c.show(),ZCL_uXHR("/cal/getPortal.do?mode="+t,function(e){c.hide(),_(t,e)})},_=function(e,t){if("contacts"==e){var a=t.getElementsByTagName("status")[0].firstChild.nodeValue;if("ok"==a)f();else{u.contacts="error";var l="503"==a?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzcontact);z(l)}}else if("task-sync"==e)if("in-process"==(o=ZCL_Evl(1,t.getElementsByTagName("obj")[0].firstChild.nodeValue)).status||"success"==o.status)v();else{u.task="error";l="503"==o?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inztask);z(l)}else if("project"==e){var c=t.getElementsByTagName("obj")[0].firstChild.nodeValue;if("503"!=c&&"Empty result set"!=c&&"error"!=c)r=ZCL_Evl(1,c),h();else{u.project="error";l="503"==c?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzproject);z(l)}}else if("crm"==e)if("in-process"==(s=ZCL_Evl(1,t.getElementsByTagName("obj")[0].firstChild.nodeValue)).status||"success"==s.status)g();else{u.crm="error";l="503"==s.status?zcal.i18n.subscribeunavailable:"sync-noperm"==s.status?ZCL_replaceComName(zcal.i18n.crmcal_noperm):ZCL_replaceComName(zcal.i18n.noacc_inzcrm);z(l)}else if("recruit"==e){(d=ZCL_Evl(1,t.getElementsByTagName("obj")[0].firstChild.nodeValue)).obj.VERSION;if("503"!=d.obj&&"error"!=d.obj)C();else{u.recruit="error";l="503"==d.obj?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzrecruit);z(l)}}},z=function(e){var t=$("#zcl_appcallst").parent();t.empty(),t.append(e),p()},f=function(){var e=$("#zcl_appcallst");e.empty();var t=$("<li/>"),a="";a+="<span>"+zcal.i18n.contactscal,-1==zcal.cdata.calOUids.indexOf("zohoContacts_")?a+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":a+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",a+="</span>",t.html(a);var l=t.find("[data-marker=sub]").removeAttr("data-marker");l.length&&l.on("click",function(e){ZCL_XHR("/cal/subCal.do?mode=contactcal-sub",L)});var c=t.find("[data-marker=unsub]").removeAttr("data-marker");if(c.length){var i=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoContacts_"));i=-1!=i.indexOf(",")?i.substring(0,i.indexOf(",")):i,c.on("click",{uid:i,mode:"contacts"},function(e){b(e.data.uid,e.data.mode)})}e.append(t)},v=function(){var e=$("#zcl_appcallst");e.empty();var t=$("<li/>"),a="";a+="<span>"+ZCL_replaceComName(zcal.i18n.zohotask),-1==zcal.cdata.calOUids.indexOf("zohoTask_")?a+='<span class="button" data-marker="sub">'+zcal.i18n.synchronize+"</span>":a+='<span class="button zcl_vis" data-marker="unsub">'+(o.isOldTaskSubscribed?zcal.i18n.unsubscribe:zcal.i18n.unsynchronize)+"</span>",a+="</span>","in-process"==o.status&&(t.addClass("zcl_disls"),a+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),t.html(a);var l=t.find("[data-marker=sub]").removeAttr("data-marker");l.length&&l.on("click",function(e){ZCL_XHR("/cal/subCal.do?mode=task-sync",L)});var c=t.find("[data-marker=unsub]").removeAttr("data-marker");if(c.length){var i=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoTask_"));i=-1!=i.indexOf(",")?i.substring(0,i.indexOf(",")):i,c.on("click",{uid:i,mode:"task"},function(e){b(e.data.uid,e.data.mode)})}e.append(t)},h=function(){var e=$("#zcl_appcallst"),t=r;for(var a in e.empty(),t){var l=$("<li/>"),c="";c+="<span>"+ZCL_getHTML(t[a].portal),-1==zcal.cdata.calOUids.indexOf("zohoProject_"+t[a].portal_zoid)?c+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":c+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",c+="</span>",l.html(c);var i=l.find("[data-marker=sub]").removeAttr("data-marker");i.length&&i.on("click",function(e){ZCL_XHR("/cal/subCal.do?mode=project-sub&portal="+t[a].portal+"&portalId="+encodeURIComponent(t[a].portal_zoid),L)});var n=l.find("[data-marker=unsub]").removeAttr("data-marker");n.length&&n.on("click",{uid:"zohoProject_"+t[a].portal_zoid,mode:"project"},function(e){b(e.data.uid,e.data.mode)}),e.append(l)}},g=function(){var l=$("#zcl_appcallst");if(0<l.length){l.empty();var e=$("<li/>"),t="";t+='<span id="zcl_synccal">'+ZCL_replaceComName(zcal.i18n.crmcal),-1==zcal.cdata.calOUids.indexOf("zohoCrm_")?t+='<span class="button" data-marker="sub">'+zcal.i18n.synchronize+"</span>":t+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span>",t+="</span>","in-process"==s.status&&(e.addClass("zcl_disls"),t+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),e.html(t);var a=e.find("[data-marker=sub]").removeAttr("data-marker");a.length&&a.off("click").on("click",{soid:s.obj.ZSOID},function(e){var t,a;a=(t=l).find("#zcl_synccal"),0==t.find("#zcl_syncstatus").length&&a.after($('<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>")),t.find("#zcl_syncstatus").parent().addClass("zcl_disls"),a.find("span.button").off("click"),ZCL_XHR("/cal/subCal.do?mode=crm-sync&crmid="+e.data.soid,y)});var c=e.find("[data-marker=unsub]").removeAttr("data-marker");if(c.length){var i=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoCrm_"));i=-1!=i.indexOf(",")?i.substring(0,i.indexOf(",")):i,c.off("click").on("click",{uid:i,mode:"crm"},function(e){b(e.data.uid,e.data.mode)})}l.append(e)}},C=function(){var e=$("#zcl_appcallst"),t=d.obj.VERSION;e.empty();var a=$("<li/>"),l="";l+="<span>"+ZCL_replaceComName(zcal.i18n.recruitcal),"new"==t?-1==zcal.cdata.calOUids.indexOf("zohoRecruit4_")?l+='<span class="button" data-marker="sub">'+zcal.i18n.synchronize+"</span>":l+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span>":-1==zcal.cdata.calOUids.indexOf("zohoRecruit_")?l+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":l+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",l+="</span>",a.html(l);var c=a.find("[data-marker=sub]").removeAttr("data-marker");c.length&&c.off("click").on("click",{soid:d.obj.ZSOID},function(e){ZCL_XHR("/cal/subCal.do?mode=recruitcal-sub&recid="+e.data.soid,L)});var i=a.find("[data-marker=unsub]").removeAttr("data-marker");if(i.length){var n=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoRecruit"));n=-1!=n.indexOf(",")?n.substring(0,n.indexOf(",")):n,i.on("click",{uid:n,mode:"recruit"},function(e){b(e.data.uid,e.data.mode)})}e.append(a)},y=function(e){if(ZCL_clrStck(),200==e.status){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){if("sync-initiated"==t.sync_mode)"in-process"==t.sync_status?s.status=t.sync_status:(s.status="success",setTimeout(function(){_zm.succErrMsg("s",zcal.i18n.synccompmsg)},2e3));else if("success"==t.sync_status){s.status=t.sync_status;var a=t.obj;zcal.cdata.calOLst=a.clst,zcal.cdata.calOUids=a.Uids,zcal.cdata.calGLst=a.gclst,zcal.cdata.calALst=a.aclst,zcal.ZCRM_OBJ=a.crmOrgObj,ZCL_updateAppCalList(a.aclst),setTimeout(function(){_zm.succErrMsg("s",zcal.i18n.synccompmsg)},2e3),zcalCRM.loadCRMUsers()}else"in-process"==t.sync_status?s.status=t.sync_status:setTimeout(function(){_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed))},2e3);g(),$.publish("/calendar/subscribed")}else setTimeout(function(){_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed))},2e3)}},L=function(e){var t=ZCL_Evl(1,e.responseText);if("success"==t.status){var a=t.obj,l=t.mode;t.uid;zcal.cdata.calOLst=a.clst,zcal.cdata.calOUids=a.Uids,zcal.cdata.calGLst=a.gclst,zcal.cdata.calALst=a.aclst,ZCL_updateAppCalList(a.aclst),"contactcal-sub"===l?(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),f()):"project-sub"===l?(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),h()):"task-sync"===l?("completed"==t.sync_status?(o.status="success",_zm.succErrMsg("s",zcal.i18n.synccompmsg)):"in-process"==t.sync_status&&(o.status="in-process"),v()):"recruitcal-sub"==l&&(_zm.succErrMsg("s",zcal.i18n.synccompmsg),C()),$.publish("/calendar/subscribed")}},b=function(e,t){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(e),function(e){!function(e,t){var a=ZCL_Evl(1,e.responseText);if("success"==a.status){var l=a.id,c=a.uid;$.publish("/calendar/deleted",{calid:l,caluid:c,mode:"unsubscribe"}),"contacts"===t?f():"project"===t?h():"task"===t?v():"crm"===t?g():"recruit"===t&&C()}else _zm.succErrMsg("e",a.status)}(e,t)})};return(e=e||{}).init=function(){zmsuite.isWorkspaceAvailable("settings")&&t()},e.clearTrace=function(){a.remove(),i.remove(),zmailSettings.currentAppName=void 0},e.setCrmSyncStatus=function(e){s.status=e},e.setCrmSyncFailedStatus=function(){s.status="success",_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed)),g()},e.listCrmCal=g,e.listTaskCal=v,e.listRecruitCal=C,e.setTaskSyncStatus=function(e){o.status=e},e}(zcalSettings.appList||{}),zcalSettings.ownCalList=function(e){function a(){if(s=zcal.cdata.calOrdArr,d=zcal.cdata.calLst,f.empty(),s.forEach(function(e){d[e]&&o(e,d[e])}),r&&"share"===r.action){var e,t,a=r.id;0<(e=c.find("[data-id="+a+"]")).length&&(t=e.find("[data-id=sh]"),v(t,e,a,d[a]))}}function t(){zmailSettings.views.showPreview();var e,t=$(zmailSettings.views.getPreviewDOM());i=t.find(".SC_ptit"),l=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.mycalendars+"</div></div>"),i.append(l),(n=t.find(".SC_Twpr")).removeClass("SC_Twpr").removeAttr("style"),c=$((e="<div>",e+='<div class="SC_filt_bottom SC_Calendar">',e+='<div class="zmL SC_filt_bld">',e+='<ul class="bld custom">',e+="<li>&nbsp;</li>",e+="<li>"+zcal.i18n.calname+"</li>",e+="<li>"+zcal.i18n.status+"</li>",e+="</ul>",e+="</div>",e+="</div>",e+='<div style="bottom:0px;top:106px;" class="SC_Twpr">',e+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist"></div>',e+="</div>",e+="</div>")),f=c.find("#zcl_callist"),n.append(c),a()}var l,c,f,i,n,r,s,d,o=function(e,i){var t,a,l,c,n,r,s=$('<div class="zmL '+(1==i[8]?"":"disableFilter")+'" data-id="'+e+'"><ul></ul></div>'),d=ZCL_getCalColor(i[1])[1],o=ZCL_getHTML(i[0]),u=$('<li><div style="background-color:'+d+'" class="SClbl"><i class="'+(1==i[2]?"msi-tick":"")+'"></i></div></li>');u.find(".SClbl").off("click").on("click",{calid:e},function(e){var t=e.data.calid;ZCL_ChgCalSts(t)}),s.find("ul").append(u);var p=$('<li><strong class="filterControl">'+o+"<b></b></strong></li>"),m=p.find("b");(t=$('<span data-id="det">'+zcal.i18n.details+"</span>")).off("click").on("click",{calid:e,cobj:i},function(e){var t=$(this);zcalDetails.close(),zcalShare.close(),t.closest("ul").attr("class","sel"),t.parent().find("span").removeClass("zcl_sl"),t.addClass("zcl_sl"),zcalDetails.render(e.data.calid,e.data.cobj).insertAfter(s)}),m.append(t),(r=$('<span data-id="edit">'+zcal.i18n.edit+"</span>")).off("click").on("click",{calId:e},function(e){var t=zcal.getCalObj(e.data.calId),a=t[1].split(":")[0],l=t[1].split(":")[1];ZCL_openCalPopup({id:e.data.calId,name:t[0],desc:t[4],color:a,txtcolor:l})}),m.append(r),"0"==zcal.shrCal&&"0"==zcal.pvtUrl||((a=$('<span data-id="sh">'+zcal.i18n.share+"</span>")).off("click").on("click",{calid:e,cobj:i},function(e){v($(this),s,e.data.calid,e.data.cobj)}),m.append(a)),"0"!=zcal.impExp&&1==i[13][2]&&((l=$('<span data-id="exp">'+zcal.i18n.exports+"</span>")).off("click").on("click",{calid:e,ckey:i[9]},function(e){ZCL_formSubmit({ckey:e.data.ckey,mode:"calexp"},"/cal/export.do","GET")}),m.append(l)),1==i[13][3]&&((c=$('<span data-id="emp">'+zcal.i18n.empty+"</span>")).off("click").on("click",{calid:e},function(e){var t=e.data.calid;ZCL_empCal(t)}),m.append(c)),1==i[13][4]&&((n=$('<span data-id="del">'+zcal.i18n.del+"</span>")).off("click").on("click",{calid:e,ckey:i[9]},function(e){var t=e.data.calid;ZCL_delCal(t,!1)}),m.append(n)),s.find("ul").append(p);var _=$('<li><strong class="filterControl"><span class="filterSate"/></strong></li>');if("false"==i[3]){var z=$("<div/>");0==i[8]?z.addClass("sdiv sadiv"):z.addClass("sdiv inctop"),z.off("click").on("click",{calid:e},function(e){var a=$(this),l=a.parents(".zmL"),c=e.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+c+"&isshow="+!!a.hasClass("sadiv"),function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status&&(i[8]=t.isshow?1:0,a.removeAttr("class").addClass(t.isshow?"sdiv inctop":"sdiv sadiv"),l.removeAttr("class").addClass(t.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:c,visibility:t.isshow}))})}),_.find(".filterSate").append(z)}s.find("ul").append(_),f.append(s)},v=function(e,t,a,l){zcalDetails.close(),zcalShare.close(),e.closest("ul").attr("class","sel"),e.parent().find("span").removeClass("zcl_sl"),e.addClass("zcl_sl"),zcalShare.render(a,l).insertAfter(t)},u=function(){$.subscribe("/calendar/added",a),$.subscribe("/calendar/updated",a),$.subscribe("/calendar/deleted",e.delCal),$.subscribe("/calendar/statusChanged",e.updCalSts)};return(e=e||{}).init=function(e){r=e,zmsuite.isWorkspaceAvailable("settings")&&(t(),u())},e.clearTrace=function(){l.remove(),c.remove(),d=void 0,n.addClass("SC_Twpr"),n.css("top","61px"),zmailSettings.currentAppName=void 0,$.unsubscribe("/calendar/added",a),$.unsubscribe("/calendar/updated",a),$.unsubscribe("/calendar/deleted",e.delCal),$.unsubscribe("/calendar/statusChanged",e.updCalSts)},e.updCalSts=function(e,t){var a,l=t.calid;t.sts;0<(a=c.find("[data-id="+l+"]")).find("i").length&&a.find("i").removeAttr("class").addClass(1==t.sts?"msi-tick":"")},e.delCal=function(e,t){var a=t.calid;$ele=c.find("[data-id="+a+"]"),$ele.length&&$ele.remove()},e}(zcalSettings.ownCalList||{}),zcalSettings.grpCalList=function(e){function a(){for(var e in s=zcal.cdata.calGLst,_.empty(),s)o(e,s[e]);if(r&&"share"===r.action){var t,a,l=r.id;0<(t=c.find("[data-id="+l+"]")).length&&(a=t.find("[data-id=sh]"),z(a,t,l,s[l]))}d()}function t(){zmailSettings.views.showPreview();var e,t=$(zmailSettings.views.getPreviewDOM());i=t.find(".SC_ptit"),l=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.groupcalendars+"</div></div>"),i.append(l),(n=t.find(".SC_Twpr")).removeClass("SC_Twpr").removeAttr("style"),c=$((e="<div>",e+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist_hdr">',e+='<div class="zmL SC_filt_bld">',e+='<ul class="bld custom">',e+="<li>&nbsp;</li>",e+="<li>"+zcal.i18n.calname+"</li>",e+="<li>"+zcal.i18n.status+"</li>",e+="</ul>",e+="</div>",e+="</div>",e+='<div style="bottom:0px;top:106px;" class="SC_Twpr">',e+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist"></div>',e+="</div>",e+="</div>")),_=c.find("#zcl_callist"),n.append(c),a()}var l,c,_,i,n,r,s,d=function(){_.is(":empty")&&(_.html('<div class="SC_nmsg">No calendars found, <font>click here</font> to subscribe.</div>'),$("#zcl_callist_hdr").empty(),_.find("font").off("click").on("click",function(e){zmailSettings.init("calendar","zcalSettings.zcalGroupList")}),$(_.parent()).css("top","86px"))},o=function(e,i){var t,a,l,c,n=$('<div class="zmL '+(1==i[8]?"":"disableFilter")+'" data-id="'+e+'"><ul></ul></div>'),r=ZCL_getCalColor(i[1])[1],s=ZCL_getHTML(i[0]),d=$('<li><div style="background-color:'+r+'" class="SClbl"><i class="'+(1==i[2]?"msi-tick":"")+'"></i></div></li>');d.find(".SClbl").off("click").on("click",{calid:e},function(e){var t=e.data.calid;ZCL_ChgCalSts(t)}),n.find("ul").append(d);var o=$('<li><strong class="filterControl">'+s+"<b></b></strong></li>"),u=o.find("b");(t=$('<span data-id="det">'+zcal.i18n.details+"</span>")).off("click").on("click",{calid:e,cobj:i},function(e){var t=$(this);zcalDetails.close(),zcalShare.close(),t.closest("ul").attr("class","sel"),t.parent().find("span").removeClass("zcl_sl"),t.addClass("zcl_sl"),zcalDetails.render(e.data.calid,e.data.cobj).insertAfter(n)}),u.append(t),(c=$('<span data-id="edit">'+zcal.i18n.edit+"</span>")).off("click").on("click",{calId:e},function(e){var t=zcal.getCalObj(e.data.calId),a=t[1].split(":")[0],l=t[1].split(":")[1];ZCL_openCalPopup({id:e.data.calId,name:t[0],desc:t[4],color:a,txtcolor:l})}),u.append(c),0==i[13][0]&&0==i[13][7]||((a=$('<span data-id="sh">'+zcal.i18n.share+"</span>")).off("click").on("click",{calid:e,cobj:i},function(e){z($(this),n,e.data.calid,e.data.cobj)}),u.append(a)),1==i[13][5]&&((l=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>")).off("click").on("click",{calid:e,ckey:i[9]},function(e){var t=e.data.calid;ZCL_delCal(t,!0)}),u.append(l)),n.find("ul").append(o);var p=$('<li><strong class="filterControl"><span class="filterSate"/></strong></li>');if("false"==i[3]){var m=$("<div/>");0==i[8]?m.addClass("sdiv sadiv"):m.addClass("sdiv inctop"),m.off("click").on("click",{calid:e},function(e){var a=$(this),l=a.parents(".zmL"),c=e.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+c+"&isshow="+!!a.hasClass("sadiv"),function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status&&(i[8]=t.isshow?1:0,a.removeAttr("class").addClass(t.isshow?"sdiv inctop":"sdiv sadiv"),l.removeAttr("class").addClass(t.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:c,visibility:t.isshow}))})}),p.find(".filterSate").append(m)}n.find("ul").append(p),_.append(n)},z=function(e,t,a,l){zcalDetails.close(),zcalShare.close(),e.closest("ul").attr("class","sel"),e.parent().find("span").removeClass("zcl_sl"),e.addClass("zcl_sl"),zcalShare.render(a,l).insertAfter(t)},u=function(){$.subscribe("/calendar/subscribed",a),$.subscribe("/calendar/updated",a),$.subscribe("/calendar/deleted",e.delCal),$.subscribe("/calendar/statusChanged",e.updCalSts)};return(e=e||{}).init=function(e){r=e,zmsuite.isWorkspaceAvailable("settings")&&(t(),u())},e.clearTrace=function(){l.remove(),c.remove(),s=void 0,n.addClass("SC_Twpr"),n.css("top","61px"),zmailSettings.currentAppName=void 0,$.unsubscribe("/calendar/subscribed",a),$.unsubscribe("/calendar/updated",a),$.unsubscribe("/calendar/deleted",e.delCal),$.unsubscribe("/calendar/statusChanged",e.updCalSts)},e.updCalSts=function(e,t){var a,l=t.calid;t.sts;0<(a=c.find("[data-id="+l+"]")).find("i").length&&a.find("i").removeAttr("class").addClass(1==t.sts?"msi-tick":"")},e.delCal=function(e,t){var a=t.calid;$ele=c.find("[data-id="+a+"]"),$ele.length&&$ele.remove(),d()},e}(zcalSettings.grpCalList||{}),zcalSettings.appCalList=function(e){function a(){for(var e in s=zcal.cdata.calALst,z.empty(),s)o(e,s[e]);if(r&&"share"===r.action){var t,a,l=r.id;0<(t=c.find("[data-id="+l+"]")).length&&(a=t.find("[data-id=sh]"),f(a,t,l,s[l]))}d()}function t(){zmailSettings.views.showPreview();var e,t=$(zmailSettings.views.getPreviewDOM());i=t.find(".SC_ptit"),l=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.appcalendars+"</div></div>"),i.append(l),(n=t.find(".SC_Twpr")).removeClass("SC_Twpr").removeAttr("style"),c=$((e="<div>",e+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist_hdr">',e+='<div class="zmL SC_filt_bld">',e+='<ul class="bld custom">',e+="<li>&nbsp;</li>",e+="<li>"+zcal.i18n.calname+"</li>",e+="<li>"+zcal.i18n.status+"</li>",e+="</ul>",e+="</div>",e+="</div>",e+='<div style="bottom:0px;top:106px;" class="SC_Twpr">',e+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist"></div>',e+="</div>",e+="</div>")),z=c.find("#zcl_callist"),n.append(c),a()}var l,c,z,i,n,r,s,d=function(){z.is(":empty")&&(z.html('<div class="SC_nmsg">'+zcal.i18n.noappcal+"</div>"),$("#zcl_callist_hdr").empty(),$(z.parent()).css("top","86px"))},o=function(e,i){var t,a,l,c,n,r=$('<div class="zmL '+(1==i[8]?"":"disableFilter")+'" data-id="'+e+'"><ul></ul></div>'),s=ZCL_getCalColor(i[1])[1],d=ZCL_getHTML(i[0]),o=$('<li><div style="background-color:'+s+'" class="SClbl"><i class="'+(1==i[2]?"msi-tick":"")+'"></i></div></li>');o.find(".SClbl").off("click").on("click",{calid:e},function(e){var t=e.data.calid;ZCL_ChgCalSts(t)}),r.find("ul").append(o);var u=$('<li><strong class="filterControl">'+d+"<b></b></strong></li>"),p=u.find("b");(t=$('<span data-id="det">'+zcal.i18n.details+"</span>")).off("click").on("click",{calid:e,cobj:i},function(e){var t=$(this);zcalDetails.close(),zcalShare.close(),t.closest("ul").attr("class","sel"),t.parent().find("span").removeClass("zcl_sl"),t.addClass("zcl_sl"),zcalDetails.render(e.data.calid,e.data.cobj).insertAfter(r)}),p.append(t),(n=$('<span data-id="edit">'+zcal.i18n.edit+"</span>")).off("click").on("click",{calId:e},function(e){var t=zcal.getCalObj(e.data.calId),a=t[1].split(":")[0],l=t[1].split(":")[1];ZCL_openCalPopup({id:e.data.calId,name:t[0],desc:t[4],color:a,txtcolor:l})}),p.append(n),0==i[13][0]&&0==i[13][7]||((a=$('<span data-id="sh">'+zcal.i18n.share+"</span>")).off("click").on("click",{calid:e,cobj:i},function(e){f($(this),r,e.data.calid,e.data.cobj)}),p.append(a)),1==i[13][5]&&((l=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>")).off("click").on("click",{calid:e,ckey:i[9]},function(e){var t=e.data.calid;ZCL_delCal(t,!0)}),p.append(l)),2!=i[5]&&(5!=i[5]||"zcontacts"!=i[14]&&"zprojects"!=i[14])||((c=$('<span data-id="upd">'+zcal.i18n.update+"</span>")).off("click").on("click",{calid:e,ckey:i[9]},function(e){var t,a=e.data.calid;t=a,ZCL_XHR(1==zcal.CALMODE?"/cal/gsubCal.do?&grpid="+ZCL_ZGID+"&mode=userUpd&calid="+t:"/cal/subCal.do?mode=userUpd&calid="+t,function(){ZCL_setCalendars(),zcalEvents.loadMonthData(),zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully)})}),p.append(c)),r.find("ul").append(u);var m=$('<li><strong class="filterControl"><span class="filterSate"/></strong></li>');if("false"==i[3]){var _=$("<div/>");0==i[8]?_.addClass("sdiv sadiv"):_.addClass("sdiv inctop"),_.off("click").on("click",{calid:e},function(e){var a=$(this),l=a.parents(".zmL"),c=e.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+c+"&isshow="+!!a.hasClass("sadiv"),function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status&&(i[8]=t.isshow?1:0,a.removeAttr("class").addClass(t.isshow?"sdiv inctop":"sdiv sadiv"),l.removeAttr("class").addClass(t.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:c,visibility:t.isshow}))})}),m.find(".filterSate").append(_)}r.find("ul").append(m),z.append(r)},f=function(e,t,a,l){zcalDetails.close(),zcalShare.close(),e.closest("ul").attr("class","sel"),e.parent().find("span").removeClass("zcl_sl"),e.addClass("zcl_sl"),zcalShare.render(a,l).insertAfter(t)},u=function(){$.subscribe("/calendar/subscribed",a),$.subscribe("/calendar/updated",a),$.subscribe("/calendar/deleted",e.delCal),$.subscribe("/calendar/statusChanged",e.updCalSts)};return(e=e||{}).init=function(e){r=e,zmsuite.isWorkspaceAvailable("settings")&&(t(),u())},e.clearTrace=function(){l.remove(),c.remove(),s=void 0,n.addClass("SC_Twpr"),n.css("top","61px"),zmailSettings.currentAppName=void 0,$.unsubscribe("/calendar/subscribed",a),$.unsubscribe("/calendar/updated",a),$.unsubscribe("/calendar/deleted",e.delCal),$.unsubscribe("/calendar/statusChanged",e.updCalSts)},e.updCalSts=function(e,t){var a,l=t.calid;t.sts;0<(a=c.find("[data-id="+l+"]")).find("i").length&&a.find("i").removeAttr("class").addClass(1==t.sts?"msi-tick":"")},e.delCal=function(e,t){var a=t.calid;$ele=c.find("[data-id="+a+"]"),$ele.length&&$ele.remove(),d()},e}(zcalSettings.appCalList||{}),zcalSettings.othCalList=function(e){function t(){zmailSettings.views.showPreview();var e,t=$(zmailSettings.views.getPreviewDOM());l=t.find(".SC_ptit"),a=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.othercalendars+"</div></div>"),l.append(a),(i=t.find(".SC_Twpr")).removeClass("SC_Twpr").removeAttr("style"),c=$((e="<div>",e+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist_hdr">',e+='<div class="zmL SC_filt_bld">',e+='<ul class="bld custom">',e+="<li>&nbsp;</li>",e+="<li>"+zcal.i18n.calname+"</li>",e+="<li>"+zcal.i18n.status+"</li>",e+="</ul>",e+="</div>",e+="</div>",e+='<div style="bottom:0px;top:106px;" class="SC_Twpr">',e+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist"></div>',e+="</div>",e+="</div>")),f=c.find("#zcl_callist"),i.append(c),function(){for(var e in r=zcal.cdata.calOLst,f.empty(),r)d(e,r[e]);if(n&&"share"===n.action){var t,a,l=n.id;0<(t=c.find("[data-id="+l+"]")).length&&(a=t.find("[data-id=sh]"),v(a,t,l,r[l]))}s()}()}var a,c,f,l,i,n,r,s=function(){f.is(":empty")&&(f.html('<div class="SC_nmsg">No calendars found, <font>click here</font> to subscribe.</div>'),$("#zcl_callist_hdr").empty(),f.find("font").off("click").on("click",function(e){zmailSettings.init("calendar","zcalSettings.Subscribe")}),$(f.parent()).css("top","86px"))},d=function(e,i){var t,a,l,c,n,r,s=$('<div class="zmL '+(1==i[8]?"":"disableFilter")+'" data-id="'+e+'"><ul></ul></div>'),d=ZCL_getCalColor(i[1])[1],o=ZCL_getHTML(i[0]),u=$('<li><div style="background-color:'+d+'" class="SClbl"><i class="'+(1==i[2]?"msi-tick":"")+'"></i></div></li>');u.find(".SClbl").off("click").on("click",{calid:e},function(e){var t=e.data.calid;ZCL_ChgCalSts(t)}),s.find("ul").append(u);var p=$('<li><strong class="filterControl">'+o+"<b></b></strong></li>"),m=p.find("b");(t=$('<span data-id="det">'+zcal.i18n.details+"</span>")).off("click").on("click",{calid:e,cobj:i},function(e){var t=$(this);zcalDetails.close(),zcalShare.close(),t.closest("ul").attr("class","sel"),t.parent().find("span").removeClass("zcl_sl"),t.addClass("zcl_sl"),zcalDetails.render(e.data.calid,e.data.cobj).insertAfter(s)}),m.append(t),(r=$('<span data-id="edit">'+zcal.i18n.edit+"</span>")).off("click").on("click",{calId:e},function(e){var t=zcal.getCalObj(e.data.calId),a=t[1].split(":")[0],l=t[1].split(":")[1];ZCL_openCalPopup({id:e.data.calId,name:t[0],desc:t[4],color:a,txtcolor:l})}),m.append(r),0!=i[13][0]&&"0"!=zcal.shrCal&&((a=$('<span data-id="sh">'+zcal.i18n.share+"</span>")).off("click").on("click",{calid:e,cobj:i},function(e){v($(this),s,e.data.calid,e.data.cobj)}),m.append(a)),0!=i[13][2]&&((l=$('<span data-id="exp">'+zcal.i18n.exports+"</span>")).off("click").on("click",{calid:e,ckey:i[9]},function(e){ZCL_formSubmit({ckey:e.data.ckey,mode:"calexp"},"/cal/export.do","GET")}),m.append(l)),1==i[13][5]&&((c=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>")).off("click").on("click",{calid:e,ckey:i[9]},function(e){var t=e.data.calid;ZCL_delCal(t,!0)}),m.append(c)),2==i[5]&&((n=$('<span data-id="upd">'+zcal.i18n.update+"</span>")).off("click").on("click",{calid:e,ckey:i[9]},function(e){var t=e.data.calid;h(t)}),m.append(n)),s.find("ul").append(p);var _=$('<li><strong class="filterControl"><span class="filterSate"/></strong></li>');if("false"==i[3]){var z=$("<div/>");0==i[8]?z.addClass("sdiv sadiv"):z.addClass("sdiv inctop"),z.off("click").on("click",{calid:e},function(e){var a=$(this),l=a.parents(".zmL"),c=e.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+c+"&isshow="+!!a.hasClass("sadiv"),function(e){var t=ZCL_Evl(1,e.responseText);"success"==t.status&&(i[8]=t.isshow?1:0,a.removeAttr("class").addClass(t.isshow?"sdiv inctop":"sdiv sadiv"),l.removeAttr("class").addClass(t.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:c,visibility:t.isshow}))})}),_.find(".filterSate").append(z)}s.find("ul").append(_),f.append(s)},v=function(e,t,a,l){zcalDetails.close(),zcalShare.close(),e.closest("ul").attr("class","sel"),e.parent().find("span").removeClass("zcl_sl"),e.addClass("zcl_sl"),zcalShare.render(a,l).insertAfter(t)},h=function(e){ZCL_XHR(1==zcal.CALMODE?"/cal/gsubCal.do?&grpid="+ZCL_ZGID+"&mode=userUpd&calid="+e:"/cal/subCal.do?mode=userUpd&calid="+e,function(){ZCL_setCalendars(),zcalEvents.loadMonthData(),zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully)})},o=function(){$.subscribe("/calendar/deleted",e.delCal),$.subscribe("/calendar/statusChanged",e.updCalSts)};return(e=e||{}).init=function(e){n=e,zmsuite.isWorkspaceAvailable("settings")&&(t(),o())},e.clearTrace=function(){a.remove(),c.remove(),r=void 0,i.addClass("SC_Twpr"),i.css("top","61px"),zmailSettings.currentAppName=void 0,$.unsubscribe("/calendar/deleted",e.delCal),$.unsubscribe("/calendar/statusChanged",e.updCalSts)},e.updCalSts=function(e,t){var a,l=t.calid;t.sts;0<(a=c.find("[data-id="+l+"]")).find("i").length&&a.find("i").removeAttr("class").addClass(1==t.sts?"msi-tick":"")},e.delCal=function(e,t){var a=t.calid;$ele=c.find("[data-id="+a+"]"),$ele.length&&$ele.remove(),s()},e}(zcalSettings.othcalList||{});var zcalDetails=function(e){function i(){var e=$("#zcl_callist");e&&e.find("ul.sel").removeClass(),r&&(r.remove(),r=void 0)}function n(){var e,t,a=p&&0<p.find(".msi-check").length?"1":"0";e=ZCL_getAlarmObj(u[0].childNodes)[0];var l=m&&0<m.find(".msi-check").length?"1":"0";e.ACTYPE||e.ACTYPE==d[6].ACTYPE&&null!=e.ACTYPE?e.ACTYPE==d[6].ACTYPE&&e.REMTIME==d[6].REMTIME&&e.REMTYPE==d[6].REMTYPE&&markAsBusy==d[16]||(t="&remt="+e.REMTIME+"&remty="+e.REMTYPE+"&actty="+e.ACTYPE+"&busy="+a+"&invNtfy="+l):t="&remt=&remty=&actty=&busy="+a+"&invNtfy="+l,t&&ZCL_XHR("/cal/calAct.do?mode=edit-adv&caluid="+o+"&calid="+s+t,function(e){var t=ZCL_Evl(1,e.responseText);"success"===t.status&&(d[6]=t.obj.REM,d[16]=t.obj.BUSY,d[17]=t.obj.INVNOTIFY,zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully),i())})}var r,s,d,o,u,p,m;return(e=e||{}).render=function(e,t){s=e,o=(d=t)[9],r=$('<div id="zcl_caldetails" class="editFilterParent"></div>');var a=$(zcalTemplate.calDetials(s,t));if(a.find("[data-marker=embedMore]").off("click").on("click",function(e){zcalEmbed.render(s,d)}),(u=a.find("[data-marker=calReminder]").removeAttr("data-marker")).html(ZCL_putCalAlarm(d[6])),u.find(".msi-close").off("click").on("click",function(){$(this).closest("ul").remove(),u.find("#zcl_addrem").length||ZCL_AppendRemAddLnk(u[0])}),p=a.find("[data-marker=markAsBusy]").removeAttr("data-marker"),null!=d[16]&&""!=d[16]){var l=p.find("i");0<l.length&&(l.removeAttr("class").addClass("1"==d[16]?"msi-check":"msi-uncheck"),l.off("click").on("click",function(){this.className="msi-check"==this.className?"msi-uncheck":"msi-check"}))}else p.remove();if(m=a.find("[data-marker=dlgInvNtfy]").removeAttr("data-marker"),2==d[13][0]&&1==d[5]){var c=m.find("i");0<c.length&&(c.removeAttr("class").addClass("1"==d[17]?"msi-check":"msi-uncheck"),c.off("click").on("click",function(){this.className="msi-check"==this.className?"msi-uncheck":"msi-check"}))}else m.remove();return a.find("[data-marker=detailSave]").removeAttr("data-marker").off("click").on("click",n),a.find("[data-val=Cancel]").off("click").on("click",i),r.html(a),r},e.close=i,e}(zcalDetails||{}),zcalShare=function(e){function l(){var e=$("#zcl_callist");e&&e.find("ul.sel").removeClass(),c&&(c.remove(),u=p=m=o=d=c=void 0,f&&zmAutoFill.removeAutoFill(f)),C={},g=h=void 0}function r(e){var t=[{value:0,text:zcal.i18n.private_shperm_freebusy},{value:1,text:zcal.i18n.private_shperm_viewevent}];return 0==e&&(t.push({value:2,text:zcal.i18n.private_shperm_editevent}),t.push({value:3,text:zcal.i18n.private_shperm_delegate})),t}var c,i,s,n,d,o,u,p,m,_,z,f,v,h,g,C={};(e=e||{}).render=function(e,t){i=e,n=(s=t)[9],h=ZCL_Evl(1,JSON.stringify(zcal.cdata.grpLst)),c=$('<div id="zcl_calshare" class="editFilterParent"></div>');var a=$(zcalTemplate.calShare());if(0!=s[13][0]||1==s[13][7])return o=a.find("[data-marker=publicShare]").removeAttr("data-marker"),u=a.find("[data-marker=privateAddress]").removeAttr("data-marker"),p=a.find("[data-marker=indShare]").removeAttr("data-marker"),v=a.find("[data-marker=sharedList]").removeAttr("data-marker"),d=a.find("[data-marker=loadingAnimation]").removeAttr("data-marker"),0==s[13][0]&&1==s[13][7]?0!=zcal.pvtUrl&&(3==s[5]?T:j)():1==s[13][0]&&0==s[13][7]?0!=zcal.shCal&&1!=zcal.shCal&&(3==s[5]?T:I)():1==s[13][0]&&1==s[13][7]?0==zcal.shCal&&0!=zcal.pvtUrl?(3==s[5]?T:j)():0!=zcal.shCal&&1!=zcal.shCal&&0==zcal.pvtUrl?(3==s[5]?T:I)():0!=zcal.shCal&&1!=zcal.shCal&&0!=zcal.pvtUrl&&(3==s[5]?T():(I(),j())):0==zcal.shCal&&0!=zcal.pvtUrl?(o&&(o.remove(),o=void 0),p&&(p.remove(),p=void 0),v&&(v.remove(),v=void 0),j()):1==zcal.shCal&&0==zcal.pvtUrl?(o&&(o.remove(),o=void 0),u&&(u.remove(),u=void 0),(zcal.cdata.calLst[i]?Z:D)()):1==zcal.shCal&&0!=zcal.pvtUrl?(o&&(o.remove(),o=void 0),zcal.cdata.calLst[i]?(j(),Z()):D()):2==zcal.shCal&&0==zcal.pvtUrl?(u&&(u.remove(),u=void 0),zcal.cdata.calLst[i]?(I(),Z()):D()):zcal.cdata.calLst[i]?(I(),j(),Z()):D(),a.find("[data-val=Cancel]").off("click").on("click",l),c.html(a),c;(c=void 0).remove()};function y(e){var l=[];(e.menuItems||[]).forEach(function(e){var t=e.value,a=e.text;l.push({htm:"<div>"+a+"</div>",data:{value:t,text:a}})});var c=$.Deferred();return e.list=l,e.clk=function(e,t,a){c.resolve(e,t,a)},e.onHide=function(){c.reject()},l.length?zmsuite.showMenu(e):c.reject(),c.fail(zmUtil.hideMenu),c.promise()}function a(e,t){for(var a=0;a<t.length;a++){var l=zcalGroup.getGroup(t[a]);l&&e.push({id:t[a],name:l.name,display_text:l.name})}}function L(e){this.theme=e&&e.theme||0,this.language=e&&e.lang||"en",this.calKey=e&&e.ckey}var b,E,T=function(){zmComponent.loadingBand({container:d[0],type:"pagination"}),d.show(),ZCL_XHR("/cal/shareCal.do?mode=cal-pubpvtinfo&caluid="+s[9]+"&calid="+i+"&calmode=0",function(e){var t=ZCL_Evl(1,e.responseText);d.hide(),t.obj&&(s[10]=t.obj),I()})},D=function(){zmComponent.loadingBand({container:d[0],type:"pagination"}),d.show(),ZCL_XHR("/cal/shareCal.do?mode=sh-calinfo&caluid="+s[9]+"&calid="+i+"&calmode=0",function(e){d.hide();var t=ZCL_Evl(1,e.responseText);t.calinfo&&(s[10]=t.calInfo[10],s[11]=t.calInfo[11],s[12]=t.calInfo[12]),t.pvtLst&&(g=t.pvtLst,A()),t.grpInfo&&(h.grp=t.grpInfo),I()})},Z=function(){zmComponent.loadingBand({container:d[0],type:"pagination"}),d.show(),ZCL_XHR("/cal/shareCal.do?mode=priv-shlst&calid="+i+"&calmode=0",function(e){d.hide();var t=ZCL_Evl(1,e.responseText);t.obj&&(g=t.obj,A())})},A=function(){var e='<h2 class="recom_conditionHeading">Share with individuals or groups</h2>';e+='<div class="zmL">',e+='<div class="SC_srch shw">',e+='<table class="condition"><tr><td>',e+='<table><tr><td width="60px"><div class="SC_select" data-marker="shareType">',e+='<i class="msi-invitee"></i>',e+="</div></td>",e+='<td width="43%"><div class="SC_select SC_selectnoneArw">',e+='<input type="text" placeholder="'+zcal.i18n.typeaemailid+'" value="" class="zm_sgst" data-marker="shareTo">',e+="</div></td>",e+='<td width="29%"><div class="SC_select">',e+='<input type="text" class="disabled" readonly value="'+zcal.i18n.private_shperm_viewevent+'" data-marker="sharePerm">',e+="</div></td>",e+='<td class="tRht"><span><i class="msi-plus"></i></span></td>',e+="</tr></table>",e+="</tr></table>",e+="</div>",e+="</div>",p.html(e),m=p.find("[data-marker=shareType]").removeAttr("data-marker"),_=p.find("[data-marker=shareTo]").removeAttr("data-marker"),z=p.find("[data-marker=sharePerm]").removeAttr("data-marker"),p.find(".msi-plus").off("click").on("click",function(e){if(1==C.type){var t=_.attr("data-gid");if(null==t)return!1;C.grpid=t}else{var a=_[0].value;if(!ZCL_isEmail(a))return zmUtil.succErrMsg("e",zcal.i18n.entervalidemail),_[0].focus(),!1;C.email=a}w(C)}),t({value:0}),M()},M=function(){var e=$("<table/>");for(var t in g[0]){var a=(n=r(0))[g[0][t]].text;(i=$('<tr><td><i class="msi-invitee"></i></td><td width="43%"><span>'+ZCL_getHTML(t)+'</span></td><td width="29%"><div class="SC_select"><input type="text" class="disabled" readonly value="'+a+'"></div></td><td><i class="msi-close"></i></td></tr>')).find("input").off("click").on("click",{menuItems:n,email:t},function(t){y({menuItems:t.data.menuItems,par:this,parWidth:!0}).then(function(e){w({type:0,email:t.data.email,perm:e.value}),zmUtil.hideMenu()})}),i.find(".msi-close").off("click").on("click",{email:t},function(e){O({email:e.data.email,mode:0})}),e.append(i)}for(var l in g[1]){var c=h.pgrp[l]||h.ogrp[l];if(c){var i,n;a=(n=r(1))[g[1][l]].text;(i=$('<tr><td width="5%"><i class="msi-group"></i></td><td width="43%"><span>'+ZCL_getHTML(c.GNAME)+'</span></td><td width="29%"><div class="SC_select"><input type="text" class="disabled" readonly value="'+a+'"></div></td><td><i class="msi-close"></i></td></tr>')).find("input").off("click").on("click",{menuItems:n,grpid:l},function(t){y({menuItems:t.data.menuItems,par:this,parWidth:!0}).then(function(e){w({type:1,grpid:t.data.grpid,perm:e.value}),zmUtil.hideMenu()})}),i.find(".msi-close").off("click").on("click",{grpid:l},function(e){O({grpid:e.data.grpid,mode:1})}),e.append(i)}}v.html(e)},t=function a(e){var t=!ZCL_isEmpty(h.pgrp)||!ZCL_isEmpty(h.ogrp),l=e.value,c=r(l);if(C.type=l,C.perm=c[1].value,m&&(m.html('<i class="'+(1==l?"msi-group":"msi-invitee")+'"></i>'),m.off("click").on("click",{isgrp:t},function(e){var t=[{value:0,text:zcal.i18n.individuals}];e.data.isgrp&&t.push({value:1,text:zcal.i18n.groups}),y({menuItems:t,par:this,parWidth:!1}).then(function(e){a(e),zmUtil.hideMenu()})})),f&&zmAutoFill.removeAutoFill(f),_)if(_.off("click"),_.val(""),1==l){_.attr("placeholder",zcal.i18n.selectagroup);var i=k();_.off("click").on("click",function(e){var a,t={},l=$(this);t.parentDOM=l.parent(),t.displayAs="dropdown",t.onSelect=function(e,t){S(l,e,t),a.hide()},t.dataCallback=function(){return i},(a=zmUtil.createFLComp("generic",t)).show()})}else{_.attr("placeholder",zcal.i18n.typeaemailid);var n=zmSearch.getAFObj(0,function(e,t){_[0].value=e.eid,C.email=e.eid});f=zmAutoFill.setAutofill(n,_)}z&&z.off("click").on("click",function(e){var t=this;y({menuItems:c,par:this,parWidth:!0}).then(function(e){t.value=e.text,C.perm=e.value,zmUtil.hideMenu()})})},S=function(e,t,a){e.val(a.display_text),e.attr("data-gid",t)},k=function(){var e,t=[];return e=zcalGroup.getGroupList("personal"),a(t,e),e=zcalGroup.getGroupList("org"),a(t,e),t},w=function(e){var t="/cal/shareCal.do?calid="+i+"&perm="+e.perm+"&caluid="+n+"&calmode=0";1==e.type?t+="&mode=grp-sh&grpid="+e.grpid:t+="&mode=priv-sh&shuser="+e.email.zcalescape(),ZCL_XHR(t,function(e){var t,a=ZCL_Evl(1,e.responseText);"success"==a.status?(zmUtil.succErrMsg("s",zcal.i18n.sharedsuccessfully),t=a.obj,"grp-sh"===a.mode?g[1][t[0]]=t[1]:g[0][t[0]]=t[1],A()):"maxLmtReached"==a.status?zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.maxLmtReached,[60])):"noPermission"==a.status?zmUtil.succErrMsg("e",zcal.i18n.NoPermission):"WaitForApprvl"==a.status&&zmUtil.succErrMsg("e",zcal.i18n.waitforapprovalcalmsg)})},O=function(e){var t=e.mode,a="/cal/shareCal.do?&calid="+i+"&caluid="+s[9]+"&calmode=0";ZCL_XHR(a+=0==t?"&mode=priv-sh-del&shuser="+e.email.zcalescape():"&mode=grp-sh-del&grpid="+e.grpid,function(e){var t,a,l=ZCL_Evl(1,e.responseText);t=l.mode,a=l.obj,"grp-sh-del"==t?delete g[1][a[0]]:delete g[0][a[0]],zmUtil.succErrMsg("s","Calendar sharing removed successfully"),M()})},I=function(){var e='<h2 class="recom_conditionHeading">'+zcal.i18n.public_share+"</h2>";e+='<div class="zmL">',e+="<div>",e+='<table class="condition">',e+="<tr><td>",e+='<div><span data-marker="makePublic"><i class="'+(0!=s[10][1]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.makethiscalpub+"</span></span></div>",0!=s[10][1]&&(e+='<div class="zcl_Sshp zcl_Sshpu">',e+="<div>",e+='<span data-marker="chgPubPerm" rel="fb"><i class="'+(1==s[10][1]||4==s[10][1]?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.public_shperm_freebusy+"</span></span>",e+='<span data-marker="chgPubPerm" rel="vd"><i class="'+(2==s[10][1]||3==s[10][1]?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.public_shperm_viewevent+"</span></span>",1==s[13][1]&&(e+='<div><span data-marker="allowER"><i class="'+(3==s[10][1]||4==s[10][1]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.allow_requisition+"</span></span>",e+=3==s[10][1]||4==s[10][1]?'<ul><li><span class="zcl_lk" data-marker="webAPI">'+zcal.i18n.webapiforevent+'</span></li><li><span class="zcl_lk" data-marker="eventReq">'+zcal.i18n.calpubevtreq+"</span></li></ul>":"",e+="</div>"),e+="</div>",e+='<div><span class="zcl_lk" data-marker="pubICAL">'+zcal.i18n.ical+'</span><span class="zcl_sp"></span><span class="zcl_lk" data-marker="pubHTML">'+zcal.i18n.html+"</span></div>",e+="</div>"),e+="</td></tr>",e+="</table>",e+="</div>",e+="</div>",o.html(e),o.find("[data-marker=makePublic]").removeAttr("data-marker").off("click").on("click",function(e){var t,a=$(this).find("i");t=a.hasClass("msi-check")?(a.removeClass("msi-check").addClass("msi-uncheck"),0):(a.removeClass("msi-uncheck").addClass("msi-check"),1),x({perm:t,mode:"enable/disable"})}),o.find("[data-marker=chgPubPerm]").removeAttr("data-marker").off("click").on("click",function(e){var t,a=$(this),l=a.parent();t="vd"===$(this).attr("rel")?2:1,t=3<=s[10][1]?1==t?4:3:t,l.find(".msi-option").removeClass().addClass("msi-unoption"),a.find("i").addClass("msi-option"),x({perm:t,mode:"change"})}),o.find("[data-marker=allowER]").removeAttr("data-marker").off("click").on("click",function(e){var t,a=$(this).find("i");t=a.hasClass("msi-check")?(a.removeClass("msi-check").addClass("msi-uncheck"),0):(a.removeClass("msi-uncheck").addClass("msi-check"),1),N(t)}),o.find("[data-marker=pubICAL]").removeAttr("data-marker").off("click").on("click",function(e){R("ical")}),o.find("[data-marker=pubHTML]").removeAttr("data-marker").off("click").on("click",function(e){R("embed")}),o.find("[data-marker=webAPI]").removeAttr("data-marker").off("click").on("click",function(e){P()}),o.find("[data-marker=eventReq]").removeAttr("data-marker").off("click").on("click",function(e){U()})},x=function(l){var c=l.perm;ZCL_XHR("/cal/shareCal.do?pubshare="+c+"&mode=pub-sh&calid="+i+"&caluid="+s[9]+"&calmode=0",function(e){var t,a=ZCL_Evl(1,e.responseText);"success"===a.status&&(s[10][1]=a.pub,t="change"===l.mode?zcal.i18n.publicsharechanged:0==c?zcal.i18n.publicshare_disabled:zcal.i18n.publicshare_enabled,zmUtil.succErrMsg("s",t)),I()})},N=function(l){var e=s[10][1];ZCL_XHR("/cal/shareCal.do?pubshare="+(e=1==l?2==e?3:4:4==e?1:2)+"&mode=pub-sh&calid="+i+"&caluid="+s[9]+"&calmode=0",function(e){var t,a=ZCL_Evl(1,e.responseText);"success"===a.status&&(s[10][1]=a.pub,t=0==l?zcal.i18n.allow_requisition_disabled:zcal.i18n.allow_requisition_enabled,zmUtil.succErrMsg("s",t)),I()})},R=function(e){$("#zcl_calpubaddress").length||$("body").append("<div id='zcl_calpubaddress' class='zcl_ovr'/>");var t,a=$("#zcl_calpubaddress");t='<div class="SC_set SC_filt_bottom">',t+='<textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/"+(""==s[14]||"gcal"==s[14]?"":s[14]+"/")+e+"/"+s[9]+"</textarea>",t+='<span class="zcl_grey">'+zcal.i18n.calurlmsg+"</span>",t+="</div>",a.html(t);var l={title:zcal.i18n.publicaddress,mask:!0,pos:"center",closeaction:function(){a.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calpubaddress",l)},P=function(){$("#zcl_calwebapi").length||$("body").append("<div id='zcl_calwebapi' class='zcl_ovr'/>");var e,t=$("#zcl_calwebapi");e='<div class="SC_set SC_filt_bottom">',e+='<div class="zmL">',e+='<div class="SC_srch shw"><table class="condition">',e+='<tr><td class="gbld">'+zcal.i18n.calwebapimsg+"</td></tr>",e+="<tr><td><table>",e+='<tr><td><textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/eventreq/"+s[9]+"?name=[name]&mailId=[EmailId]&date=[MM/dd/yyyy]&time=[13:00]&reason=[Reason for Appointment]</textarea></td></tr>",e+="</table></td></tr>",e+="</table></div>",e+="</div>",e+="</div>",t.html(e);var a={title:zcal.i18n.apiforeventreq,mask:!0,pos:"center",closeaction:function(){t.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calwebapi",a)};L.prototype={setTheme:function(e){this.theme=e},setLanguage:function(e){this.language=e},getURL:function(){return'<iframe src="'+location.protocol+"//"+zcal.ZCAL+"/eventreqForm/"+this.calKey+"?theme="+this.theme+"&l="+this.language+'" frameborder="0" scrolling="no" marginWidth="0" border="0px" marginHeight="0" height="300px" width="432px" allowTransparency="true" align="center"></iframe>'}};function H(){E&&E.html('<textarea class="zcl_Stxt">'+b.getURL()+"</textarea>")}var U=function(){$("#zcl_calereq").length||$("body").append("<div id='zcl_calereq' class='zcl_ovr'/>");var e,t,a=$("#zcl_calereq");b=new L({lang:"en",theme:0,ckey:s[9]}),t=["#D5E4F7","#899AFF","#6FC252","#D4D4D4","#FF8F8F","#FF8FC1","#C9CE46","#FFAE00","#6F0DC2","#C81515"],e='<div class="SC_set SC_filt_bottom">',e+='<div class="conditionDiv">',e+="<table><tr><td>",e+='<div><div class="zmL">',e+='<div class="SC_srch shw">',e+='<table class="condition">',e+='<tr><td class="gbld">'+zcal.i18n.chooseyourclolor+"</td></tr>",e+='<tr><td><ul class="zcl_cecolr" id="zcl_ereqTheme">';for(var l=0;l<t.length;l++)e+='<li style="background-color:'+t[l]+'" class='+(l===b.theme?"zcl_sl":"")+'><i class="msi-tick"></i></li>';e+="</ul></td></tr>",e+="</table>",e+="</div>",e+="</div></div>",e+="</td>",e+="<td>",e+='<div><div class="zmL">',e+='<div class="SC_srch shw">',e+='<table class="condition">',e+='<tr><td class="gbld">'+zcal.i18n.language+"</td></tr>",e+='<tr><td><table><tr><td><div class="SC_select" style="width:100%" data-marker="languageSel"/></td></tr></table></td></tr>',e+="</table>",e+="</div>",e+="</div></div>",e+="</td></tr></table>",e+="</div>",e+='<div class="zmL">',e+='<div class="SC_srch shw"><table class="condition">',e+='<tr><td class="gbld">'+zcal.i18n.calwebapimsg+"</td></tr>",e+="<tr><td><table>",e+='<tr><td data-marker="ereqCode"><textarea class="zcl_Stxt">'+b.getURL()+"</textarea></td></tr>",e+="</table></td></tr>",e+="</table></div>",e+="</div>",e+="</div>",a.html(e),E=a.find("[data-marker=ereqCode]").removeAttr("data-marker"),a.find("#zcl_ereqTheme").find("li").off("click").on("click",function(e){var t=$(this);t.parent().find("li").removeClass("zcl_sl"),t.addClass("zcl_sl"),b.setTheme(t.index()),H()});var c=a.find("[data-marker=languageSel]").removeAttr("data-marker"),i=function(){var e=zcalEmbed.languages(),t='<select class="select">';for(var a in e)t+='<option value="'+a+'">'+e[a]+"</option>";return t+="</select>"}();c.html(i),c.find("select").off("change").on("change",function(e){b.setLanguage(this.value),H()});var n={title:zcal.i18n.calpubevtreq,mask:!0,pos:"center",closeaction:function(){a.remove(),zmsDialog.remove()},customClass:"SC_SetPop",buttons:[{txt:zcal.i18n.preview,callback:function(){var e,t=window.open();t.document.open(),e=b.getURL().replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),t.document.write("<html><body>"+e+"</body></html>"),t.document.close()}}]};zmsDialog.create("zcl_calereq",n)},j=function(){var e='<h2 class="recom_conditionHeading">'+zcal.i18n.privateaddress+"</h2>";e+='<div class="zmL">',e+="<div>",e+='<table class="condition">',e+="<tr><td>",e+='<span data-marker="enablePvtURL"><i class="'+(s[10][0]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.endableprivateadd+"</span></span>",s[10][0]&&(e+='<div class="zcl_Sshp"><div><span class="zcl_lk" data-marker="pvtICAL">'+zcal.i18n.ical+'</span><span class="zcl_sp"></span><span class="zcl_lk" data-marker="pvtHTML">'+zcal.i18n.html+"</span>",e+='<span class="SC_button zcl_ovr" data-marker="pvtReset">'+zcal.i18n.reset+"</span></div></div>"),e+="</td></tr>",e+="</table>",e+="</div>",e+="</div>",u.html(e),u.find("[data-marker=enablePvtURL]").removeAttr("data-marker").off("click").on("click",function(e){var t,a=$(this).find("i");a.hasClass("msi-check")?(a.removeClass("msi-check").addClass("msi-uncheck"),t="priv-dis"):(t="priv-reset",a.removeClass("msi-uncheck").addClass("msi-check")),B({mode:t,msg:"enable/disable"})}),u.find("[data-marker=pvtICAL]").removeAttr("data-marker").off("click").on("click",function(e){F("ical")}),u.find("[data-marker=pvtHTML]").removeAttr("data-marker").off("click").on("click",function(e){F("embed")}),$pvtReset=u.find("[data-marker=pvtReset]").removeAttr("data-marker"),$pvtReset.off("click").on("click",function(e){B({mode:"priv-reset",msg:"reset"})})},B=function(a){var e=s[9],l=a.mode;ZCL_XHR("/cal/shareCal.do?calid="+i+"&caluid="+e+"&mode="+l+"&calmode=0",function(e){var t=ZCL_Evl(1,e.responseText);"priv-reset"===l?(s[10][0]=t.pvtId,zmUtil.succErrMsg("s","reset"==a.msg?zcal.i18n.privateurlchanged:zcal.i18n.privateshare_enabled)):(s[10][0]=null,zmUtil.succErrMsg("s",zcal.i18n.privateshare_disabled)),j()})},F=function(e){var t;$("#zcl_calpvtaddress").length||$("body").append("<div id='zcl_calpvtaddress' class='zcl_ovr'/>"),t=$("#zcl_calpvtaddress");var a='<div class="SC_set SC_filt_bottom">';a+='<textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/"+(""==s[14]?"":s[14]+"/")+e+"/"+s[9]+"/pvt_"+s[10][0]+"</textarea>",a+='<span class="zcl_grey">'+zcal.i18n.calurlmsg+"</span>",a+="</div>",t.html(a);var l={title:zcal.i18n.privateaddress,mask:!0,pos:"center",closeaction:function(){t.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calpvtaddress",l)};return e.close=l,e}(zcalShare||{}),zcalEmbed=function(e){var r,s,d,o,u,p,m,_;e=e||{};function c(){return-1!=zcal.ZCAL.indexOf(".baihui.com")?{zh:zcal.i18n.chines,en:zcal.i18n.english}:{en:zcal.i18n.english,da:zcal.i18n.danish,de:zcal.i18n.german,es:zcal.i18n.spanish,fr:zcal.i18n.french,hu:zcal.i18n.hungarian,it:zcal.i18n.italian,ja:zcal.i18n.japanes,nl:zcal.i18n.dutch,pl:zcal.i18n.polish,pt:zcal.i18n.portuguese,ru:zcal.i18n.russian,sv:zcal.i18n.swedish,tr:zcal.i18n.turkish,zh:zcal.i18n.chines}}function z(e){this.template=e&&e.type||0,this.title=e&&e.title,this.defaultCal=e&&e.dcal,this.selectedCal=[],this.view=t[this.template].v,this.color=t[this.template].c,this.language=e&&e.lang||"en",this.width=t[this.template].w,this.height=t[this.template].h,this.timezone=e&&e.tz,this.showTitle=!0,this.showTimezone=!0,this.detailview=!1}var t=[{w:"600",h:"500",c:-1,v:0},{w:"300",h:"500",c:0,v:-1},{w:"350",h:"500",c:10,v:-1},{w:"300",h:"500",c:0,v:-1},{w:"400",h:"400",c:-1,v:-1},{w:"700",h:"270",c:0,v:-1},{w:"300",h:"400",c:-1,v:-1},{w:"350",h:"500",c:1,v:-1},{w:"300",h:"500",c:7,v:-1},{w:"300",h:"500",c:0,v:-1}];z.prototype={setTemplate:function(e){this.template=parseInt(e),this.view=t[this.template].v,this.color=t[this.template].c,this.width=t[this.template].w,this.height=t[this.template].h},setTitle:function(e){this.title=e},setCalendars:function(e){this.selectedCal=""!=e?e.split(","):[]},setView:function(e){this.view=parseInt(e)},setColor:function(e){this.color=parseInt(e)},setLanguage:function(e){this.language=e},setWidth:function(e){this.width=parseInt(e)},setHeight:function(e){this.height=parseInt(e)},setTimezone:function(e){this.timezone=e},setShowTitle:function(e){this.showTitle=e},setShowTimezone:function(e){this.showTimezone=e},setDetailview:function(e){this.detailview=e},getURL:function(){var e='<iframe src="'+location.protocol+"//"+zcal.ZCAL+(""===d[14]||"gcal"===d[14]?"":"/"+d[14])+"/embed/"+this.defaultCal+"?";if(zcal.cdata.calLst[s]){var t=this.selectedCal.length,a="";if(0!=t)for(var l=0;l<t;l++)a+=(0==l?"":",")+this.selectedCal[l];e+=""!=a?"cal="+a+"&":""}return e+="title="+ZCL_getHTML(this.title).replace("&#39;",""),e+="&type="+(this.template+1),e+="&l="+this.language,e+="&tz="+this.timezone.zcalescape(),e+="&sh=["+(this.showTitle?1:0)+","+(this.showTimezone?1:0)+","+(this.detailview?1:0)+"]",e+=-1!=this.color?"&c="+this.color:"",e+=-1!=this.view?"&v="+this.view:"",e+='" width="'+this.width+'" height="'+this.height+'" frameborder="0" scrolling="no"></iframe>'}};function f(){for(var e=[zcal.i18n.blue,zcal.i18n.green,zcal.i18n.red,zcal.i18n.pink,zcal.i18n.violet,zcal.i18n.rosybrown,zcal.i18n.purple,zcal.i18n.grey,zcal.i18n.orange,zcal.i18n.brown,zcal.i18n.yellow],t='<select class="select">',a=0;a<e.length;a++)t+='<option value="'+a+'" '+(o.color==a?"selected":"")+">"+e[a]+"</option>";return t+="</select>"}function i(){return'<input type="text" readonly  value="'+unescape(zcal.cdata.opt.CTIM)+'" id="zcl_TZ" class="SC_tiput zcl_nrbr" rel="'+zcal.cdata.opt.TIM+'" />          '}function a(){var e,t,a,l,c;if(p){a='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.title+"</td></tr>",a+='<tr><td><input type="text" class="SC_tiput" value="'+ZCL_getHTML(o.title)+'"/></td></tr>',a+="</table></div>",a+="</div>",a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.select_calendar+"</td></tr>",a+='<tr><td><select style="width:100%" size="4" multiple="multiple"/></td></tr>',a+="</table></div>",a+="</div>",-1==o.color&&-1==o.view||(a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+(-1!=o.view?zcal.i18n.chooseyourview:zcal.i18n.chooseacolor)+"</td></tr>",a+='<tr><td><table><tr><td><div class="SC_select" data-marker="viewColorSel"/></td></tr></table></td></tr>',a+="</table></div>",a+="</div>"),p.html(a),p.find("input.SC_tiput").off("change").on("change",function(e){o.setTitle(this.value),g()}),e=p.find("select");var i,n=(l=zcal.cdata.calOrdArr,c="",l.forEach(function(e){var t=zcal.cdata.calLst,a=t[e][9]==o.defaultCal||-1!=o.selectedCal.indexOf(t[e][9])?"selected":"";c+='<option value="'+t[e][9]+'" '+a+">"+ZCL_getHTML(t[e][0])+"</option>"}),c);if(e.html(n),e.off("click").on("click",function(e){var t=$(this),a=[];$.each(t.find("option:selected"),function(){var e=$(this).val();e!=o.defaultCal&&a.push(e)}),o.setCalendars(a.join(",")),g()}),t=p.find("[data-marker=viewColorSel]").removeAttr("data-marker"))-1!=o.color?((i=$(f())).off("change").on("change",function(e){o.setColor(this.value),g()}),t.html(i)):-1!=o.view&&((i=$(function(){for(var e=[zcal.i18n.vday,zcal.i18n.week,zcal.i18n.month],t='<select class="select">',a=0;a<e.length;a++)t+='<option value="'+a+'" '+(o.view==a?"selected":"")+">"+e[a]+"</option>";return t+="</select>"}())).off("change").on("change",function(e){o.setView(this.value),g()}),t.html(i))}}function l(){var e,t,a;if(m){a='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.language+"</td></tr>",a+='<tr><td><table><tr><td><div class="SC_select" data-marker="languageSel"/></td></tr></table></td></tr>',a+="</table></div>",a+="</div>",a+='<div class="zmL">',a+='<div class="SC_srch shw"><table>',a+='<tr><td><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.width+"</td></tr>",a+='<tr><td><table><tr><td><input type="text" id="zcl_embedWdt" class="SC_tiput zcl_nrbr" value="'+o.width+'px"></td></tr></table></td></tr>',a+="</table></td>",a+='<td><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.height+"</td></tr>",a+='<tr><td><table><tr><td><input type="text" id="zcl_embedHgt" class="SC_tiput" value="'+o.height+'px"></td></tr></table></td></tr>',a+="</table></td></tr>",a+="</table></div>",a+="</div>",a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.timezone+'<span class="zcl_smlk SC_lnk pl5" data-marker="showallTimezone">('+zcal.i18n.showall+")</span></td></tr>",a+='<tr><td><table><tr><td><div class="SC_select" id="zcl_embedTZ">'+i()+"</div></td></tr></table></td></tr>",a+="</table></div>",a+="</div>",a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+="<tr><td><table>",a+="<tr>",a+='<td><span class="mLnone" id="zcl_embedShowTitle"><i class="'+(o.showTitle?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.title+"</span></span></td>",a+='<td><span class="mLnone" id="zcl_embedShowTz"><i class="'+(o.showTimezone?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.timezone+"</span></span></td>",a+="</tr>",a+="</table></td></tr>",0==o.template&&(a+='<tr><td><span class="mLnone" id="zcl_embedDview"><i class="'+(o.detailview?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.detailsview+"</span></span></td></tr>"),a+="</table></div>",a+="</div>",m.html(a),e=m.find("[data-marker=languageSel]").removeAttr("data-marker");var l=function(){var e=c(),t='<select class="select">';for(var a in e)t+='<option value="'+a+'" '+(o.lang==a?"selected":"")+">"+e[a]+"</option>";return t+="</select>"}();e.html(l),e.find("select").off("change").on("change",function(e){o.setLanguage(this.value),g()}),$wdtDOM=m.find("#zcl_embedWdt"),$wdtDOM.off("change").on("change",function(e){var t=this.value;""!=t&&(t=t.replace(/\D/g,""),o.setWidth(t),g())}),m.find("#zcl_embedHgt").off("change").on("change",function(e){var t=this.value;""!=t&&(t=t.replace(/\D/g,""),o.setHeight(t),g())}),m.find("#zcl_embedTZ select").off("change").on("change",function(e){o.setTimezone(this.value),g()}),(t=m.find("[data-marker=showallTimezone]").removeAttr("data-marker"))&&t.off("click").on("click",function(e){n(),$(this).remove()}),m.find("#zcl_TZ").on("click",function(e){var t=zcal.timezones,a=[];for(var l in t)for(var c in t[l]){var i={};i.id=c,i.name=t[l][c]+" ("+c+")",i.display_text=t[l][c]+" ("+c+")",a.push(i)}var n,r={},s=$(this);r.parentDOM=s.parent(),r.displayAs="dropdown",r.parWidth=!0,r.onSelect=function(e,t){h(s,e,t),n.hide()},r.dataCallback=function(){return a},(n=zmUtil.createFLComp("generic",r)).show()}),m.find("#zcl_embedShowTitle").off("click").on("click",function(e){var t,a,l;l="msi-check"==(t=(a=$(this).find("i")).hasClass("msi-check")?"msi-uncheck":"msi-check"),a.attr("class",t),o.setShowTitle(l),g()}),m.find("#zcl_embedShowTz").off("click").on("click",function(e){var t,a,l;l="msi-check"==(t=(a=$(this).find("i")).hasClass("msi-check")?"msi-uncheck":"msi-check"),a.attr("class",t),o.setShowTimezone(l),g()}),m.find("#zcl_embedDview").off("click").on("click",function(e){var t,a,l;l="msi-check"==(t=(a=$(this).find("i")).hasClass("msi-check")?"msi-uncheck":"msi-check"),a.attr("class",t),o.setDetailview(l),g()})}}var v=function(){r&&(zmsDialog.remove(!0),r.remove(),r=void 0)},h=function(e,t,a){e.val(a.display_text),e.attr("rel",t),e.attr("value",a.display_text),o.setTimezone(t),g()},n=function(){0<zcal.timezones.length?i():ZCL_getTZ({mode:"embed",callback:function(){zcalEmbed.showAllTimezone()}})},g=function(){_&&_.html('<textarea class="zcl_Stxt">'+o.getURL()+"</textarea>")},C=function(){u&&u.html('<div><div class="zcl_emb'+(o.template+1)+'"></div></div>'),a(),l(),g()};return e.render=function(e,t){s=e,o=new z({title:(d=t)[0],dcal:d[9],tz:zcal.cdata.opt.TIM,lang:zcal.cdata.opt.LANG}),r||(r=$('<div id="zcl_calembed" class="zcl_ovr zcl_Semd"></div>'),$("body").append(r));var a,l=$(zcalTemplate.calEmbed()),c="";a=l.find("[data-marker=embedTpl]").removeAttr("data-marker");for(var i=0;i<10;i++)c+="<span "+(i==o.template?'class="zcl_sl"':"")+">"+(i+1)+"</span>";a.html(c),a.find("span").off("click").on("click",function(e){var t=$(this);t.parent().find("span").removeClass("zcl_sl"),t.addClass("zcl_sl"),o.setTemplate(t.index()),C()}),u=l.find("[data-marker=embedTplImg]").removeAttr("data-marker"),p=l.find("[data-marker=embedTitleSec]").removeAttr("data-marker"),m=l.find("[data-marker=embedTZSec]").removeAttr("data-marker"),_=l.find("[data-marker=embedCode]").removeAttr("data-marker"),C();var n={title:zcal.i18n.calendardetails,style:{"max-width":"750px"},mask:!0,pos:"center",closeaction:v,customClass:"SC_SetPop",buttons:[{txt:zcal.i18n.preview,callback:function(){var e,t=window.open();t.document.open(),e=o.getURL().replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),t.document.write("<html><body>"+e+"</body></html>"),t.document.close()}},{txt:zcal.i18n.refresh,callback:function(){o=new z({title:d[0],dcal:d[9],tz:zcal.cdata.opt.TIM,lang:zcal.cdata.opt.LANG,type:o.template}),C()}}]};r.html(l),zmsDialog.create("zcl_calembed",n)},e.showAllTimezone=i,e.languages=c,e}(zcalEmbed||{});function ZCL_constructData(){var e="",t=$('<div id="zcl_prntTemp"/>');if(4==zcal.view)e=ZCL_prntTitle()+'<div align="center" style="font-weight:bold; line-height: 40px;font-size:14px;">'+$(".zcl_tpdtmth")[0].innerHTML+'</div><div class="zcl_prntpdf">'+$("#zcl_workarea").parent().html()+"</div>",t.html(e);else if(3==zcal.view)e=ZCL_prntTitle()+'<div align="center" style="font-weight:bold; line-height: 40px;font-size:14px;">'+$(".zcl_tpdtmth")[0].innerHTML+'</div><div class="zcl_prntpdf">'+zcalMonthPrint.printMonth()+"</div>",t.html(e);else{e=ZCL_prntTitle()+'<div align="center" style="font-weight:bold; line-height: 40px;font-size:14px;">'+$(".zcl_tpdtmth")[0].innerHTML+'</div><div class="zcl_prntpdf">'+$("#zcl_workarea").parent().html()+"</div>",t.html(e);var a=t.find("#zcl_workarea"),l=t.find("#zcl_encloser"),c=t.find("#zcl_allgrid"),i=t.find(".zcl_evbg");a.removeAttr("style"),l.removeAttr("style"),c.removeAttr("style"),i.removeAttr("style")}return t[0].innerHTML}ZCL_prntTitle=function(){return'<div class="zcl_prntlk"><b style="font-size:14px">'+zcal.i18n.calendar+"</b> : "+ZCL_getHTML(ZCL_CALNAME)+"</div>"},ZCL_getPrntWdt=function(){return 3==zcal.view?1051:ZCL_getEleWdt(ZCL_$("zcl_workarea"))-zcalInit.scrollWidth()},ZCL_prntPageHdTxt=function(){var e="<!DOCTYPE html><html><head>";return e+='<meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>'+ZCL_replaceProName(zcal.i18n.prttitle)+'</title><link type="text/css" rel="stylesheet" href="'+location.protocol+zcal.cssPath+'zmscal.css"</link><link href="'+location.protocol+zcal.cssPath+'zmscal-print.css" rel="stylesheet" type="text/css"></link>',e+="</head>"},ZCL_iPrnt=function(){ZCL_EClrStck();var e,t,a={id:"zcl_prntFrame",frameborder:0,style:"top:50px;display:none"};navigator.userAgent.match(/rv:11.0/i)?a.src="":a.src=zcal_zmcontext+"/cal/jsp/print.jsp",e=$("<IFRAME/>",a),ZCL_$("zcl_pdfLoad")||$("body").append("<div id='zcl_pdfLoad' style='display:none'/>");var l=$("#zcl_pdfLoad");t=ZCL_prntPageHdTxt(),t+='<body style="padding-bottom:5px;padding-left:5px;padding-top:10px;overflow:auto;width:'+ZCL_getPrntWdt()+'px;height:100%" class="zcl" id="zcl_print" onload="printDoc()">',t+='<div class="zcl_P">'+ZCL_constructData()+"</div>",t+="<script>printDoc=function(){window.print()}<\/script></body></html>",l.empty(),l.append(e);var c=e[0].contentWindow||e[0].contentDocument;c.document&&(c=c.document),c.write(t),c.close()},isIE=function(){return 0<window.navigator.userAgent.indexOf("MSIE")||!!navigator.userAgent.match(/Trident/)},ZCL_print=function(){isIE()?ZCL_prntPreview(!0):ZCL_iPrnt()},ZCL_prntPreview=function(e){ZCL_EClrStck();var t=ZCL_prntPageHdTxt();t+='<body style="padding-bottom:5px;padding-left:5px;padding-top:10px;overflow:auto;width:'+ZCL_getPrntWdt()+'px;height:100%;display:none" class="zcl" id="zcl_print" onload="ZCL_dispPrntData();'+(e?"window.print()":"")+'">',t+='<div class="zcl_P">',t+=ZCL_constructData(),t+="</div>",t+='<script>ZCL_dispPrntData=function(){document.getElementById("zcl_print").style.display="";}<\/script></body></html>';var a="";(a=navigator.userAgent.match(/rv:11.0/i)?window.open("","_blank"):window.open(zcal_zmcontext+"/cal/print.do")).document.write(t),a.document.close(),a.focus()},ZCL_pdfDown=function(){var e=$("#zcl_pwd")[0].value,t=$("#zcl_repwd")[0].value;if(""==e&&""==t)$("#zcl_pwd_er")[0].style.display="",$("#zcl_repwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none";else if(e==t){$("#zcl_repeqwd_er")[0].style.display="none",$("#zcl_repwd")[0].className="SC_tiput",ZCL_EClrStck();var a='<body style="padding-bottom:5px;padding-left:5px;padding-top:10px;overflow:auto;width:'+ZCL_getPrntWdt()+'px;height:100%" class="zcl" id="zcl_print">';a+='<div class="zcl_P">',a+=ZCL_constructData(),a+="</div>",a+="</body>",ZCL_formSubmit({password:e,zcl_file:ZCL_prntTxt(a),zcl_ori:3==zcal.view?"landscape":"portrait"},"/cal/pwdPdf.do"),zmsDialog.remove()}else $("#zcl_repeqwd_er")[0].style.display="",$("#zcl_repwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none"},ZCL_svPdf=function(){if(!(!zmAdHocSettings||!zmAdHocSettings.getSecuredownload||"1"!==zmAdHocSettings.getSecuredownload()))ZCL_secureDow();else{ZCL_EClrStck();var e='<body style="padding-bottom:5px;padding-left:5px;padding-top:10px;overflow:auto;width:'+ZCL_getPrntWdt()+'px;height:100%" class="zcl" id="zcl_print">';e+='<div class="zcl_P">',e+=ZCL_constructData(),e+="</div>",e+="</body>",ZCL_formSubmit({zcl_file:ZCL_prntTxt(e),zcl_origin:"zmail",zcl_ori:3==zcal.view?"landscape":"portrait"},"/cal/Pdf.do")}},ZCL_prntTxt=function(e){var t=new RegExp(String.fromCharCode(160),"gi");return e=(e=(e=e.replace(t,String.fromCharCode(32))).replace(/\n\t\r/g,"")).replace(/https/g,"http"),encodeURIComponent(e)};var crmCalId,ZCL_PRINTDATA=[],zcalMonthPrint=function(){var v,a=[],h=[],g=1,E=[],T={},C=0,l=function(e,t,a,l){g=a,L();var c,i,n=ZCL_parseDateStr(t);E[0]=n,E[1]=(c=t,null==(i=a-1)&&(i=0),new Date(c.substring(0,4),parseInt(c.substring(4,6),10)-1,parseInt(c.substring(6,8),10)+i));for(var r=0;r<a;r++){var s,d=new Date;d.setTime(n),d.setDate(d.getDate()+r),e[s=d.dateBy("yyyyMMdd")]&&0<e[s].length&&y(e[s],r,s,l);var o,u,p=7*l+r,m=v.querySelector("#zcl_pm"+p);m.offsetHeight;u=T[p]?T[p].elements.length:0,C=C<=u?u:C,o=u;for(var _=0;_<o;_++)m.appendChild(T[p].elements[_])}var z,f=v.querySelector("#zcl_pm_r"+l);z=C<5?100:17*C+18,f.style.height=z+"px",h=[],T={},C=0},y=function(e,t,a,l){for(var c,i,n=7*l+t,r=(v.querySelector("#zcl_pm"+n),0);r<e.length;r++)c=d(t),i=o(c,t,e[r],a),s(c,n,e[r],i,a,l)},s=function(e,t,a,l,c){T[t]=T[t]||{};var i=T[t];for(var n in i.elements=i.elements||[],i.events=i.events||[],a){var r,s,d,o,u,p,m,_=a[n].SUM.replace("/<|>|&lt;|&gt;|&lt|&gt/gi","").replace(/ /g,"&nbsp;"),z=zcal.getCalObj(a[n].CNAME);if(""==_&&(_="NO SUBJECT"),r=ZCL_parseDateStr(a[n].SD),s=ZCL_parseDateStr(a[n].ED),d=ZCL_timeInUFormat(a[n].ST),o=zcalEvents.alltime(a[n]),u=z[1].split(":"),p=ZCL_getCalColor(u[0]),m=0==u[1]?"zcl_event zcl_evwh":"zcl_event zcl_evbl","1"==a[n].ADAY||r<s){var f=document.createElement("DIV");f.style.width=l+"px",f.className="zcl_mallev";var v='<div class="zcl_mthev"><div class="'+m+'" style="background-color:#ffffff;border-color:'+p[0]+'">';v+='<ul><li class="zcl_sp"></li><li>'+o+"<span>"+ZCL_getHTML(_)+(a[n].LOC?"&nbsp;@&nbsp;"+ZCL_getHTML(a[n].LOC):"")+"</span></li></ul>",v+="</div></div>",f.innerHTML=v,i.elements.splice(e,0,f),i.events.splice(e,0,a);var h=a[n].ED,g=0;(h=ZCL_parseDateStr(h))>=E[1]?g=ZCL_daysBetween(c,E[1].dateBy("yyyyMMdd"))+1:h<E[1]&&(g=ZCL_daysBetween(c,h.dateBy("yyyyMMdd"))+1);for(var C=t+1;C<t+g;C++){T[C]=T[C]||{};var y,L=T[C];L.elements=L.elements||[],L.events=L.events||[],(y=document.createElement("DIV")).className="zcl_edmy",L.elements.splice(e,0,y),L.events.splice(e,0,a)}}else{var b=document.createElement("DIV");b.className="zcl_mevent",b.innerHTML='<div><em class="zcl_st" style="color:'+p[0]+';">'+d+'</em><span style="color:'+p[0]+';">'+ZCL_getHTML(_)+(a[n].LOC?"&nbsp;@&nbsp;"+ZCL_getHTML(a[n].LOC):"")+"</span></div>",i.elements.splice(e,0,b),i.events.splice(e,0,a)}}},L=function(){for(var e=h[h.length]=new Array,t=0;t<g;t++)e[t]=0;return h.length-1},d=function(e){for(var t=0;t<h.length;t++)if(0==h[t][e])return t;return L()},o=function(e,t,a,l){var c="",i="";for(var n in a)i=a[n].ED;return(i=ZCL_parseDateStr(i))>=E[1]?c=ZCL_daysBetween(l,E[1].dateBy("yyyyMMdd"))+1:i<E[1]&&(c=ZCL_daysBetween(l,i.dateBy("yyyyMMdd"))+1),function(e,t,a){for(var l=h[e],c=t;c<a+t;c++)l[c]=1}(e,t,c),150*c-5};return{printMonth:function(){return v=zcalView.constMonthPrintView(),function(){for(var e=zcal.mlimit[0].clone(),t=0;t<ZCL_PRINTDATA.length;t++)a[t]=0,l(ZCL_PRINTDATA[t],e.dateBy("yyyyMMdd"),7,t),e.setDate(e.getDate()+7)}(),v.outerHTML}}}(),zcalCRM=function(){function d(){_=[],z=[],m=[],p=[],crmCalId=u=void 0,h=0}function o(e){return 1!=h?'<input type="text" class="zcl_crlk SC_tiput" id="zcl_crmnote_title" value="'+(e||"")+'">':(u.notetype,'<div class="SC_select"><select id="zcl_crmnote_title" class="select">'+function(e){for(var t="",a=u.notetype,l=0;l<a.length;l++){var c=a[l];t+='<option value="'+c.id+'" '+(e==c.name?'selected="selected"':"")+">"+c.name+"</option>"}return t}(e)+"</select></div>")}var u,_,z,n,f="Contact Name",v="Related To",h=0,p=[],m=[],g="",r={},s={},C={},l=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;e.SUM=t.find("#zcl_ce_tit")[0]?t.find("#zcl_ce_tit")[0].value:e.SUM,e.Venue=t.find("#zcl_ce_loc")[0]?t.find("#zcl_ce_loc")[0].value:"",e.Description=t.find("#zcl_ce_desc")[0]?t.find("#zcl_ce_desc")[0].value:"",e.SD=t.find("#zcl_ce_sd")[0]?ZCL_DFDate(t.find("#zcl_ce_sd")[0].value):e.SD,e.ST=t.find("#zcl_ce_st")[0]?ZCL_TimetoNo(""==t.find("#zcl_ce_st")[0].style.display?t.find("#zcl_ce_st")[0].value:"00:00"):e.ST,e.ED=t.find("#zcl_ce_ed")[0]?ZCL_DFDate(t.find("#zcl_ce_ed")[0].value):e.ED,e.ET=t.find("#zcl_ce_et")[0]?ZCL_TimetoNo(""==t.find("#zcl_ce_et")[0].style.display?t.find("#zcl_ce_et")[0].value:"00:00"):e.ET},c=function(e,t){t.SERVICE=e.mode||"crm",crmCalId=t.CNAME,(u={}).flds=e.flds.Events.section,u.fieldname=e.fieldname,u.fieldtype=e.fieldtype,u.fieldlabel=e.fieldlabel,_=e.relatedto_modules,z=e.associate_modules,i(t)},i=function(e){var t=zcal[e.EID]?zcal[e.EID].EMODE:zcal.EMODE;ZCL_clrStck();var a=u.flds,l="",c=!1;e.SEMODULE&&("Leads"==e.SEMODULE?g="Leads":"Candidates"==e.SEMODULE?g="Candidates":!e[f]&&"Contacts"!=e.SEMODULE||(g="Contacts"));var i=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(l+='<div class="zcl zcl_CMS zcl_H100" id="zcl_ce">',l+=L(e),l+='<div class="zcl_table zcl_H100">',0==t?(c=!0,l+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li><ul class="zcl_vwev"><li>'+ZCL_SetCrmsts(e)+E(e)+y(a,e)+'</li><li class="zcl_crmnt"><div class="zcl_table"><ul><li>'+zcal.i18n.notes+'</li><li class="zcl_txr"><span class="zcl_lk" id="zcl_addnote"><i class="msi-add"></i>'+zcal.i18n.addnotes+'</span></li></ul></div><div data-marker="loadingAnimation"></div></li></ul></li></ul><li class="zcl_Cer zcl_vwCer" id="zcl_ce_ext">'+U(e)+j(t)+"</li></ul>"):l+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li>'+ZCL_SetCrmsts(e)+E(e)+y(a,e)+b()+'</li></ul></li><li class="zcl_Cer" id="zcl_ce_ext">'+U(e)+j(t)+"</li></ul>",l+="</div></div>",i.find("#zcl_ce")[0]?(ZCL_updEventPrevHeader("crm"),i.find("#zcl_ce").parent().html(l)):ZCL_setEventWorkSpace(l,e,t,"crm"),0<p.length&&($("#zcl_custfldname").val(p.join(";")),$("#zcl_custfldlbl").val(m.join(";"))),Y(),c){var n,r;(r=(i=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el).find("#zcl_ce").find("span#zcl_addnote")).length&&r.off("click").on("click",function(){var e=$(this).closest("li.zcl_crmnt");re(e)}),n=i.find("#zcl_ce").find("[data-marker=loadingAnimation]").removeAttr("data-marker"),zmComponent.loadingBand({container:n[0],type:"pagination"}),n.show();var s=zcal.getCalObj(crmCalId)[9],d=zcal.EOBJ[e.EID].SERVICE,o=e.ACTIVITYID;ZCL_uXHR("/cal/crmNotes.do?mode=list&eventId="+o+"&service="+("recruit"==d?"ZohoRecruit":"ZohoCrm")+"&ckey="+s,function(e){n.hide(),le(e)})}e.ACTIVITYID&&oe(e.ACTIVITYID)},y=function(e,t){p=[],m=[];for(var a="",l=0;l<e.length;l++){var c=e[l].FL,i="";for(var n in c){var r=c[n];switch("true"==r.customfield&&(p.push(r.label),m.push(r.dv)),r.type){case"Lookup":i+=A(r,t);break;case"Text":case"Email":case"Currency":case"Phone":case"Website":"Recurring Activity"!=r.label&&"Subject"!=r.label&&"Remind At"!=r.label&&(i+=M(r,t));break;case"Date":i+=S(r,t);break;case"DateTime":"Start DateTime"!=r.label&&"End DateTime"!=r.label&&(i+=k(r,t));break;case"TextArea":i+=w(r,t);break;case"Boolean":i+=O(r,t);break;case"Integer":case"Double":i+=I(r,t);break;case"Pick List":i+=x(r,t);break;case"Multiselect Pick List":i+=N(r,t);break;case"AutoNumber":i+=R(r,t);break;case"Formula":i+=P(r,t)}}a+=i}return a},L=function(e){return ZCL_hdnFld("zcl_activityid",e.ACTIVITYID?e.ACTIVITYID:"")+ZCL_hdnFld("zcl_eid",e.EID?e.EID:"")+ZCL_hdnFld("zcl_ekey",e.EUID?e.EUID:"")+ZCL_hdnFld("zcl_euid",e.UID?e.UID:"")+ZCL_hdnFld("zcl_crel",crmCalId)+ZCL_hdnFld("zcl_rmvatt","")+ZCL_hdnFld("zcl_crmfldname",u.fieldname)+ZCL_hdnFld("zcl_crmfldtype",u.fieldtype)+ZCL_hdnFld("zcl_crmfldlabel",u.fieldlabel)+ZCL_hdnFld("zcl_custfldname","")+ZCL_hdnFld("zcl_custfldlbl","")},b=function(){return'<ul class="zcl_frmrw"><li><div class="SC_PUbtm"><span data-marker="crmEventSave">'+zcal.i18n.save+'</span><span data-marker="crmFormClose" data-val="Cancel">'+zcal.i18n.cancel+"</span></div></li></ul>"},E=function(e){var t=a(e);return t+=T(e),t+=D()},a=function(e){var t='<ul class="zcl_frmrw">';return t+=0==(zcal[e.EID]?zcal[e.EID].EMODE:zcal.EMODE)?'<li><div class="zcl_evttvw">'+(e.SUM?ZCL_getHTML(e.SUM):"")+"</div>"+Z(e)+"</li>":'<li class="zcl_W70pc"><input type="text" placeholder="Untitled event" class="zcl_crevntt SC_tiput" value="'+(e.SUM?ZCL_getHTML(e.SUM):"")+'" id="zcl_ce_tit"></li>',t+="</ul>"},T=function(e){var t=zcal[e.EID]?zcal[e.EID].EMODE:zcal.EMODE,a=zcal.timeformat[zcal.cdata.opt.TF],l=!(!e.ADAY||1!=e.ADAY),c=e.SD,i=e.ED,n=l?"8:00 am":e.ST,r=l?"8:30 am":e.ET,s=n.getTimeBy(a),d=r.getTimeBy(a),o=ZCL_splitDateVal(ZCL_putDate(c)),u=ZCL_splitDateVal(ZCL_putDate(i)),p=ZCL_parseTime(s),m=ZCL_parseTime(d);if(ZCL_ESDATE=new Date(o[2],o[1]-1,o[0],p.HH,p.mm,0,0),ZCL_EEDATE=new Date(u[2],u[1]-1,u[0],m.HH,m.mm,0,0),0==t){var _=ZCL_parseDateStr(c),z=ZCL_parseDateStr(i),f='<ul class="zcl_frmrw"><li>'+_.dateBy("MMM dd, yyyy");return f+=l?c!=i?" - "+z.dateBy("MMM dd, yyyy"):"":c!=i?", "+s+" - "+z.dateBy("MMM dd, yyyy")+", "+d:", "+s+" - "+d,f+="</li></ul>"}var v=l?'style="display:none"':"";f='<ul class="zcl_frmrw zcl_when"><li class="zcl_select"><input class="zcl_w100 SC_tiput" type="text" value="'+ZCL_putDate(c)+'" id="zcl_ce_sd" readonly /></li>&nbsp;&nbsp;<li class="zcl_select" '+v+'><input class="zcl_w70 SC_tiput" type="text" autocomplete="off" id="zcl_ce_st" value="'+s+'"/></li><li class="zcl_tmto">to</li><li class="zcl_select"><input class="zcl_w100 SC_tiput" type="text" value="'+ZCL_putDate(i)+'" id="zcl_ce_ed" readonly /></li>&nbsp;&nbsp;<li class="zcl_select" '+v+'><input class="zcl_w70 SC_tiput" type="text" autocomplete="off" id="zcl_ce_et" value="'+d+'"/></li></ul>';return f+='<ul class="zcl_frmrw"><li class="zcl_curpt"><i class="'+(e.ADAY&&1==e.ADAY?"msi-check":"msi-uncheck")+'" id="zcl_ce_aday"></i>'+zcal.i18n.allday+"</li></ul>"},D=function(){return'<ul class="zcl_frmrw"><li><u class="zcl_grey">'+zcal.i18n.calendar+"</u><span>"+ZCL_GetCalName(crmCalId)+"</span></li></ul>"},Z=function(e){var t="";if(0==(zcal[e.EID]?zcal[e.EID].EMODE:zcal.EMODE)){var a,l="",c="",i="";_&&0<_.length&&(!e.SEMODULE||"Leads"!=e.SEMODULE&&"Candidates"!=e.SEMODULE?e[f]&&(l=e[f],e.CONTACTID):(l=e[v],e.RELATEDTOID)),z&&0<z.length&&e.SEMODULE&&"Leads"!=e.SEMODULE&&"Candidates"!=e.SEMODULE&&"Contacts"!=e.SEMODULE&&(c=e.SEMODULE,e.RELATEDTOID&&e.RELATEDTOID,i=e[v]?e[v]:"",a=K(c)),""==l&&""==i||(""!=(t+='<div class="zcl_crminf"><span class="zcl_grey">'+ZCL_replaceString(zcal.i18n.eventfor,["</span><span>"+l])+"</span>")&&""!=i&&(t+='<div class="zcl_SDot"></div>'),""!=i&&(t+='<span class="zcl_grey">'+a+" </span><span>"+i+"</span>"),t+="</div>")}return t},A=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE;if("Event Owner"==e.label)return"true"==e.isreadonly&&(1==h?0:0),"";var l="";if(0==a)var c="";else if("Who Id"==e.label&&_&&0<_.length){var i="",n="";c="";_.unshift({None:zcal.i18n.none}),z&&0<z.length&&_.push({Others:"Others"}),!t.SEMODULE||"Leads"!=t.SEMODULE&&"Candidates"!=t.SEMODULE?t[f]&&(n=t[f],i=t.CONTACTID):(n=t[v],i=t.RELATEDTOID);var r=""!=g?g:t.SEMODULE?"Others":"";l+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.relatedto+"</u></li>",l+='<li><div class="SC_select"><select id="zcl_CrmEvents_CONTACTMODULE" class="select">';for(var s=0;s<_.length;s++){var d=_[s];for(var o in d)c=""==c&&o==r?d[o]:c,l+='<option value="'+o+'" '+(o==r?'selected="selected"':"")+">"+d[o]+"</option>"}l+="</select>",l+="</div>",l+="</li></ul>",""!=g&&(l+=G(c,n,i))}else if("What Id"==e.label&&z&&0<z.length&&t.SEMODULE&&"Leads"!=t.SEMODULE&&"Candidates"!=t.SEMODULE&&"Contacts"!=t.SEMODULE){var u=t.SEMODULE,p=t.RELATEDTOID?t.RELATEDTOID:"",m=t[v]?t[v]:"";l+=Q(u,m,p)}return l},M=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE,l="",c=H(e,t);return l+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+(1==a&&"true"==e.req?"&#42;":"")+e.dv+"</u>",0==a||"true"==e.isreadonly?l+=""!=c?c:"---":l+='<input type="text" class="zcl_crlk SC_tiput" value="'+c+'" id="zcl_'+e.label+'" maxlength="'+e.maxlength+'">',l+="</li>",l+="</ul>"},S=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE,l=(zcal.timeformat[zcal.cdata.opt.TF],""),c=H(e,t);(l+='<ul class="zcl_frmrw"><li class="zcl_select"><u>'+(1==a&&"true"==e.req?"&#42;":"")+e.dv+"</u>",0==a||"true"==e.isreadonly)?l+=""!=c?c:"---":l+='<input class="zcl_w100 SC_tiput" type="text" data-marker="dateField" value="'+(""!=c?ZCL_putDate(B(c,0)[0]):"")+'" id="zcl_'+e.label+'" readonly />';return l+="</li>",l+="</ul>"},k=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE,l=zcal.timeformat[zcal.cdata.opt.TF],c="",i=H(e,t),n="",r=F().getTimeBy(l);if(c+='<ul class="zcl_frmrw">',0==a||"true"==e.isreadonly)c+="<li><u>"+(1==a&&"true"==e.req?"&#42;":"")+e.dv+"</u>"+(""!=i?i:"---")+"</li>";else{if(""!=i){var s=B(i,0);n=ZCL_putDate(s[0]),r=s[1].getTimeBy(l)}c+='<li class="zcl_select"><u>'+(1==a&&"true"==e.req?"&#42;":"")+e.dv+'</u><input class="zcl_w100 SC_tiput zcl_m20" type="text" data-marker="dateField" value="'+n+'" id="zcl_'+e.label+'" readonly /><input class="zcl_w70 SC_tiput" type="text" data-marker="timeField" id="zcl_'+e.label+'_time" value="'+r+'"/></li>'}return c+="</ul>"},w=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE,l=H(e,t),c="";return c+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+(1==a&&"true"==e.req?"&#42;":"")+e.dv+"</u>",0==a||"true"==e.isreadonly?c+=""!=l?ZCL_getDescHTML(l):"---":c+='<textarea style="height:44px;" class="zcl_Cedes SC_tiput" id="zcl_'+e.label+'">'+l+"</textarea>",c+="</li>",c+="</ul>"},O=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE,l="true"==H(e,t),c="";return c+='<ul class="zcl_frmrw"><li class="zcl_curpt">',0==a||"true"==e.isreadonly?(c+="<u>"+(1==a&&"true"==e.req?"&#42;":"")+e.dv+"</u>",c+=l?zcal.i18n.yes:"---"):(c+='<i class="'+(l?"msi-check":"msi-uncheck")+'" data-marker="chkboxField" id="zcl_'+e.label+'"></i>',c+=(1==a&&"true"==e.req?"&#42;":"")+e.dv),c+="</li>",c+="</ul>"},I=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE,l=H(e,t),c="";return c+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+(1==a&&"true"==e.req?"&#42;":"")+e.dv+"</u>",0==a||"true"==e.isreadonly?c+=""!=l?l:"---":c+='<input class="zcl_w70 SC_tiput" type="text" id="zcl_'+e.label+'" value="'+l+'" maxlength="'+e.maxlength+'"/>',c+="</li>",c+="</ul>"},x=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE,l=H(e,t),c=e.val,i="";if(i+='<ul class="zcl_frmrw"><li><u>'+(1==a&&"true"==e.req?"&#42;":"")+e.dv+"</u>",0==a||"true"==e.isreadonly)i+=""!=l?l:"---";else{i+='<div class="SC_select"><select id="zcl_'+e.label+'" class="select">';for(var n=0;n<c.length;n++)c[n].content&&c[n].default?i+='<option value="'+c[n].content+'" selected="true">'+c[n].content+"</option>":i+='<option value="'+c[n]+'" '+(c[n]==l?"selected":"")+">"+c[n]+"</option>";i+="</select>",i+="</div>"}return i+="</li>",i+="</ul>"},N=function(e,t){var a=zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE,l=H(e,t),c=e.val,i="";if(i+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+(1==a&&"true"==e.req?"&#42;":"")+e.dv+"</u>",0==a||"true"==e.isreadonly)i+=""!=l?l:"---";else{var n=""!=l?l+";":"";i+='<div class="SC_select"><select id="zcl_'+e.label+'" class="select" multiple="multiple" style="height:auto">';for(var r=0;r<c.length;r++)c[r].content&&c[r].default?i+='<option value="'+c[r].content+'" selected="true">'+c[r].content+"</option>":i+='<option value="'+c[r]+'" '+(-1!=n.indexOf(c[r]+";")?"selected='true'":"")+">"+c[r]+"</option>";i+="</select>",i+="</div>"}return i+="</li>",i+="</ul>"},R=function(e,t){var a="";if(0==(zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE)){var l=H(e,t);a+='<ul class="zcl_frmrw"><li><u>'+e.dv+"</u>"+(""!=l?l:"---")+"</li></ul>"}return a},P=function(e,t){var a="";if(0==(zcal[t.EID]?zcal[t.EID].EMODE:zcal.EMODE)){var l=H(e,t);a+='<ul class="zcl_frmrw"><li><u>'+e.dv+"</u>"+(""!=l?l:"---")+"</li></ul>"}return a},H=function(e,t){return"true"==e.customfield?t[e.dv]?t[e.dv]:"":t[e.label]?t[e.label]:""},U=function(e){var t=e.ORGM?e.ORGM:1==h?r.Name:s.Name,a=e.SMOWNERID?e.SMOWNERID:1==h?r.USERID:s.USERID,l='<ul class="zcl_vwmeta"><li><span onclick="ZCL_tgleNxtEle(this)"><i class="msi-barrow"></i>'+zcal.i18n.eventinfo+"</span></li>";if(l+='<li><div class="zcl_table">',l+="<ul><li>"+(e.ORG_PH?'<img src="'+e.ORG_PH+'"/>':"")+"</li><li><b>"+zcal.i18n.organizer,l+='</b><span class="zcl_lk" id="zcl_ownerName">'+ZCL_getHTML(t)+'</span><input type="hidden" value="'+a+'" id="zcl_ownerId"/></li></ul>',e.ACTIVITYID){var c=e.CRETIME.split(","),i=e.LSTMODTIME.split(",");l+="<ul><li>"+(e.CREBY_PH?'<img src="'+e.CREBY_PH+'">':"")+"</li><li>"+(e.CREBY?"<b>"+zcal.i18n.createdby+'</b><span class="zcl_lk">'+e.CREBY+"</span>":"<b>"+zcal.i18n.createdon+"</b>")+"<u>"+ZCL_parseDateStr(c[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(c[2]).HH+":"+ZCL_parseTime(c[2]).mm+"</u></li></ul>",l+="<ul><li>"+(e.MODBY_PH?'<img src="'+e.MODBY_PH+'"/>':"")+"</li><li>"+(e.MODBY?"<b>"+zcal.i18n.modifiedby+'</b><span class="zcl_lk">'+e.MODBY+"</span>":"<b>"+zcal.i18n.modifiedon+"</b>")+"<u>"+ZCL_parseDateStr(i[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(i[2]).HH+":"+ZCL_parseTime(i[2]).mm+"</u></li></ul>"}return l+="</div></li></ul>"},j=function(e){var t='<ul class="zcl_frmrw" id="zcl_crmatt_info"><li class="zcl_att"><u>'+zcal.i18n.attendees+"</u>";return 1==e&&(t+='<ul class="zcl_frmrw zcl_pddbz"><li class="zcl_atte"><div id="zcl_crmatt"><input type="text" id="zcl_ce_att_tbox" class="zm_sgst" placeholder="'+zcal.i18n.typeaemailid+'"></div></li></ul>'),t+="</li>",t+='<div><div class="zcl_viwatlst zcl_table" id="attlist"></div></div></ul>'},B=function(e,t){if(e)return[e.substring(0,4)+e.substring(5,7)+e.substring(8,10),e.substring(11,13)+e.substring(14,16)];var a,l=new Date;return l.setTime(zcal.cdata.opt.DATE),a=46<(a=2*l.getHours()+(30<l.getMinutes()?2:1))?46:a,[l.dateBy("yyyyMMdd"),zcal.TTT[a+t]]},F=function(){var e=new Date,t=2*e.getHours()+(30<e.getMinutes()?2:1);return t=46<t?46:t,zcal.TTT[t]},Y=function(){var e,t,r=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=r.find("#zcl_ce"),l=r.find("#zcl_ce_sd")[0],c=r.find("#zcl_ce_ed")[0];if(_stEle=r.find("#zcl_ce_st")[0],_etEle=r.find("#zcl_ce_et")[0],$allday=a.find("#zcl_ce_aday"),$dateField=a.find("[data-marker=dateField]"),$timeField=a.find("[data-marker=timeField]"),$chkboxField=a.find("[data-marker=chkboxField]"),$searchIcon=a.find(".msi-search"),$crmAtt=a.find("#zcl_crmatt"),$attAdd=r.find("#zcl_crmatt_info").find("[data-marker=attendeeAdd]"),$saveBtn=a.find("[data-marker=crmEventSave]"),$closeBtn=a.find("[data-marker=crmFormClose]"),l&&ZEVENTS(l.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:l,wkst:0,mode:"popup",update:"yes",minhgt:251}).on("dateclick",function(){ZCL_calcEed(l)}).bind(),c&&ZEVENTS(c.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:c,wkst:0,mode:"popup",update:"yes",minhgt:251}).on("dateclick",function(){ZCL_setEed(c)}).bind(),_stEle&&ZEVENTS(_stEle).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:_stEle}).on("change",function(){ZCL_calcEed(_stEle,!0)}).bind(),_etEle&&ZEVENTS(_etEle).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:_etEle}).on("change",function(){ZCL_setEed(_etEle,!0)}).bind(),0<$allday.length&&$allday.parent().off("click").on("click",function(){ZCL_ChgChk(this),ZCL_checkAll()}),0<$dateField.length){$dateField.removeAttr("data-marker");for(var i=0;i<$dateField.length;i++){var n=$dateField[i];ZEVENTS(n).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:n.id,wkst:0,mode:"popup",update:"yes",minhgt:251}).bind()}}if(0<$timeField.length){$timeField.removeAttr("data-marker");for(i=0;i<$timeField.length;i++){var s=$timeField[i];ZEVENTS(s).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:s.id}).bind()}}0<$chkboxField.length&&($chkboxField.removeAttr("data-marker"),$chkboxField.parent().off("click").on("click",function(){ZCL_ChgChk(this)})),0<(e=a.find("#zcl_CrmEvents_CONTACTMODULE")).length&&e.off("change").on("change",function(){var e=this.value,t=$(this);switch(e){case"Leads":case"Candidates":te(t),q(t);break;case"Contacts":te(t),W(t);break;case"Others":te(t),X(t);break;case"None":te(t)}}),0<(t=a.find("#zcl_CrmEvents_SEMODULE")).length&&t.off("change").on("change",function(){$("#zcl_CrmEvents_SEID").val(""),$("#zcl_CrmEvents_SENAME").val("")}),0<$searchIcon.length&&$searchIcon.off("click").on("click",function(e){var t,a=$(this),l=a.data("fname"),c=a.data("fid");if("zcl_CrmEvents_SEID"===c?t=$("#zcl_CrmEvents_SEMODULE").val():"zcl_CrmEvents_CONTACTID"===c&&(t=$("#zcl_CrmEvents_CONTACTMODULE").val()),t){var i=document.location.hostname.startsWith("zmail")?"mail":"zmail",n=(1==h?zcal.ZRECRUIT+"/recruit":zcal.ZCRM+"/crm")+"/Search.do?service="+i+"&searchmodule="+t+"&fldName="+l+"&fldId="+c+"&fldValue=",r=(document.body.offsetHeight-400)/2,s=(document.body.offsetWidth-700)/2;window.addEventListener("message",function(e){J(e,{fldName:l,fldId:c,module:t}),this.removeEventListener("message",arguments.caller?arguments.caller.callee:arguments.callee)},!1),window.open(n,"calwindow","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=700,height=400,left="+s+",top="+r)}}),0<$crmAtt.length&&(r.find("#zcl_ce_att_tbox").on("keydown",function(e){if(13==e.keyCode&&"zcl_ce_att_tbox"==this.id){for(var t=this.value.split(","),a=0;a<t.length;a++){var l=t[a].trim(),c=l.indexOf("<"),i=l.indexOf(">");-1<c&&-1<i&&(l=l.substring(c+1,i)),l=l.replace(/,/g,"")}if(ZCL_isEmail(l)){var n={};n.id=l,V(n),r.find("#zcl_ce_att_tbox").val("")}}}),zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:r.find("#zcl_ce_att_tbox")[0],contactType:["org","crm"],excludeMe:!0,exclude:function(){var e=[];if(r.find("#attlist")[0].childNodes){var t=r.find("#attlist")[0].childNodes;for(var a in t)e.push(t[a].id)}return e},onSelect:function(e,t){t=t.item.attributes;V(t)}})}),0<$attAdd.length&&$attAdd.off("click").on("click",function(){var e=ZCL_getAttendee(r.find("#attlist"));if(""!=e){var t=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],a=r.find("#zcl_activityid").val(),l="recruit"==zcal.EOBJ[t].SERVICE?"ZohoRecruit":"ZohoCrm",c=zcal.getCalObj(crmCalId)[9];ZCL_XHR("/cal/crmInvitees.do?mode=add&eventId="+a+"&service="+l+"&att="+e.zcalescape()+"&ckey="+c,function(e){var t=ZCL_Evl(1,e.responseText);ue(t,a)})}})),0<$saveBtn.length&&$saveBtn.off("click").on("click",function(){ae()}),0<$closeBtn.length&&$closeBtn.off("click").on("click",function(){d(),ZCL_eClose()})},V=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=t.find("#attlist"),l=document.createElement("ul");e.zid&&l.setAttribute("data-zid",e.zid),l.setAttribute("id",e.id),l.setAttribute("class","zcl_sl"),l.innerHTML="<li>"+(e.profileImage?"<img src="+e.profileImage+">":"<img src="+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+">")+"</li><li><b>"+e.id+'</b></li><li class="zcl_txr"><i class="msi-close" onclick="ZCL_rmvAtt(this,\''+e.id+'\')" title="Remove" ></i></li>',t.find("#zcl_crm_attlist")[0]?(l.innerHTML="<li>"+(e.profileImage?"<img src="+e.profileImage+">":"<img src="+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+">")+"</li><li><b>"+e.id+'</b></li><li><i class="msi-close" onclick="ZCL_rmvAtt(this,\''+e.id+'\')" title="Remove" ></i></li>',t.find("#zcl_crm_attlist").prepend(a.append($(l)))):(l.innerHTML="<li>"+(e.profileImage?"<img src="+e.profileImage+">":"<img src="+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+">")+"</li><li><b>"+e.id+'</b></li><li class="zcl_txr"><i class="msi-close" onclick="ZCL_rmvAtt(this,\''+e.id+'\')" title="Remove" ></i></li>',a.append($(l))),t.find("#zcl_ce_att_tbox").val("")},G=function(e,t,a){return'<ul class="zcl_frmrw"><li><u>'+e+'</u><input type="text" class="zcl_w200 SC_tiput zcl_m10" id="zcl_CrmEvents_CONTACTNAME" value="'+t+'" readonly><input type="hidden" value="'+a+'" id="zcl_CrmEvents_CONTACTID"><i class="msi-search" data-fname="zcl_CrmEvents_CONTACTNAME" data-fid="zcl_CrmEvents_CONTACTID"></i></li></ul>'},q=function(e){var t,a=zmTab.currentTab.split("_")[2],l=e.find("option:selected").text(),c="",i="";!zcal.EOBJ[a].SEMODULE||"Leads"!=zcal.EOBJ[a].SEMODULE&&"Candidates"!=zcal.EOBJ[a].SEMODULE||(c=zcal.EOBJ[a].RELATEDTOID,i=zcal.EOBJ[a][v]),(t=$(G(l,i,c))).find(".msi-search").off("click").on("click",function(e){var t=document.location.hostname.startsWith("zmail")?"mail":"zmail",a=(1==h?zcal.ZRECRUIT+"/recruit":zcal.ZCRM+"/crm")+"/Search.do?service="+t+"&searchmodule=Leads&fldName=zcl_CrmEvents_CONTACTNAME&fldId=zcl_CrmEvents_CONTACTID&fldValue=",l=(document.body.offsetHeight-400)/2,c=(document.body.offsetWidth-700)/2;window.addEventListener("message",function(e){J(e,{fldName:"zcl_CrmEvents_CONTACTNAME",fldId:"zcl_CrmEvents_CONTACTID",module:"Leads"}),this.removeEventListener("message",arguments.caller?arguments.caller.callee:arguments.callee)},!1),window.open(a,"calwindow","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=700,height=400,left="+c+",top="+l)}),e.parents("ul.zcl_frmrw").after(t)},J=function(e,t){if((e.origin||e.originalEvent.origin)===document.location.protocol+zcal.ZCRM.substring(zcal.ZCRM.indexOf("//"))){e.source.close(),"PriceBooks"===t.module?ZCL_$(t.fldName).value=e.data.pbname:ZCL_$(t.fldName).value=e.data.fldName,ZCL_$(t.fldId).value=e.data.fldId;var a=$("#zcl_CrmEvents_SEMODULE");e.data.acName&&"null"!=e.data.acName&&0<a.length&&"Accounts"===a.val()&&(ZCL_$("zcl_CrmEvents_SEID").value=e.data.acId,ZCL_$("zcl_CrmEvents_SENAME").value=e.data.acName)}},W=function(e){var t,a=zmTab.currentTab.split("_")[2],l=e.find("option:selected").text(),c="",i="";zcal.EOBJ[a][f]&&(i=zcal.EOBJ[a][f],c=zcal.EOBJ[a].CONTACTID),(t=$(G(l,i,c))).find(".msi-search").off("click").on("click",function(e){var t=document.location.hostname.startsWith("zmail")?"mail":"zmail",a=(1==h?zcal.ZRECRUIT+"/recruit":zcal.ZCRM+"/crm")+"/Search.do?service="+t+"&searchmodule=Contacts&fldName=zcl_CrmEvents_CONTACTNAME&fldId=zcl_CrmEvents_CONTACTID&fldValue=",l=(document.body.offsetHeight-400)/2,c=(document.body.offsetWidth-700)/2;window.addEventListener("message",function(e){J(e,{fldName:"zcl_CrmEvents_CONTACTNAME",fldId:"zcl_CrmEvents_CONTACTID",module:"Contacts"}),this.removeEventListener("message",arguments.caller?arguments.caller.callee:arguments.callee)},!1),window.open(a,"calwindow","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=700,height=400,left="+c+",top="+l)}),e.parents("ul.zcl_frmrw").after(t),X($("#zcl_CrmEvents_CONTACTID"))},X=function(e){var t=zmTab.currentTab.split("_")[2];if(z&&0<z.length){var a,l="",c="",i="";zcal.EOBJ[t].SEMODULE&&"Leads"!=zcal.EOBJ[t].SEMODULE&&"Candidates"!=zcal.EOBJ[t].SEMODULE&&"Contacts"!=zcal.EOBJ[t].SEMODULE&&(l=zcal.EOBJ[t].SEMODULE,c=zcal.EOBJ[t][v],i=zcal.EOBJ[t].RELATEDTOID);var n=(a=$(Q(l,c,i))).find("#zcl_CrmEvents_SEMODULE"),r=a.find(".msi-search");0<n.length&&n.off("change").on("change",function(){$("#zcl_CrmEvents_SENAME").val(""),$("#zcl_CrmEvents_SEID").val("")}),r.off("click").on("click",function(e){var t=document.location.hostname.startsWith("zmail")?"mail":"zmail",a=$("#zcl_CrmEvents_SEMODULE").val(),l=(1==h?zcal.ZRECRUIT+"/recruit":zcal.ZCRM+"/crm")+"/Search.do?service="+t+"&searchmodule="+a+"&fldName=zcl_CrmEvents_SENAME&fldId=zcl_CrmEvents_SEID&fldValue=",c=(document.body.offsetHeight-400)/2,i=(document.body.offsetWidth-700)/2;window.addEventListener("message",function(e){J(e,{fldName:"zcl_CrmEvents_SENAME",fldId:"zcl_CrmEvents_SEID",module:a}),this.removeEventListener("message",arguments.caller?arguments.caller.callee:arguments.callee)},!1),window.open(l,"calwindow","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=700,height=400,left="+i+",top="+c)}),e.parents("ul.zcl_frmrw").after(a)}},Q=function(e,t,a){return'<ul class="zcl_frmrw"><li><div class="SC_select"><select class="select" id="zcl_CrmEvents_SEMODULE">'+ee(e)+'</select><div/></li><li><input type="text" class="zcl_crlk SC_tiput" id="zcl_CrmEvents_SENAME" value="'+t+'"/><input type="hidden" value="'+a+'" id="zcl_CrmEvents_SEID"/></li><li><i class="msi-search" data-fname="zcl_CrmEvents_SENAME" data-fid="zcl_CrmEvents_SEID"></i></li></ul>'},K=function(e){for(var t,a="",l=0;l<z.length;l++){for(var c in t=z[l])if(c==e){a=t[c];break}if(""!=a)break}return a},ee=function(e){for(var t,a="",l=0;l<z.length;l++)for(var c in t=z[l])a+='<option value="'+c+'" '+(c==e?'selected="selected"':"")+">"+t[c]+"</option>";return a},te=function(){$("#zcl_CrmEvents_CONTACTID").parents("ul.zcl_frmrw").remove(),$("#zcl_CrmEvents_SEID").parents("ul.zcl_frmrw").remove()},ae=function(){if(!ZCL_crmFormValidate())return!1;var e,t,a,l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c=l.find("#zcl_ce_aday").hasClass("msi-check"),i=c?"00:00":l.find("#zcl_ce_st").val(),n=c?"00:00":l.find("#zcl_ce_et").val(),r="/cal/crmAddEvent.do?Subject="+(a={EID:l.find("#zcl_eid")[0].value,EUID:l.find("#zcl_euid")[0].value,EPERM:2,DPERM:2,SD:l.find("#zcl_ce_sd")[0].value,ST:ZCL_TimetoNo(i),ED:l.find("#zcl_ce_ed")[0].value,ET:ZCL_TimetoNo(n),ATT:ZCL_getAttendee($("#attlist")),RMVATT:l.find("#zcl_rmvatt")[0].value,ADAY:c?1:0,CNAME:l.find("#zcl_crel")[0].value,SUM:l.find("#zcl_ce_tit")[0].value,LOC:l.find("#zcl_Venue")[0]?l.find("#zcl_Venue")[0].value:"",EC:-1,ETZ:"",LINK:"",ETSK:0,ECRM:0,ENTS:0,EMET:0,EMIL:0}).SUM.zcalescape()+"&all="+a.ADAY+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&Start DateTime="+l.find("#zcl_ce_sd")[0].value+"&Start DateTime_time="+ZCL_TimetoNo(i)+"&End DateTime="+l.find("#zcl_ce_ed")[0].value+"&End DateTime_time="+ZCL_TimetoNo(n)+"&ownerId="+l.find("#zcl_ownerId")[0].value+"&ownerName="+l.find("#zcl_ownerName")[0].innerHTML+(l.find("#zcl_Venue")[0]?"&Venue="+l.find("#zcl_Venue")[0].value.zcalescape():"")+(l.find("#zcl_Description")[0]?"&Description="+l.find("#zcl_Description")[0].value.zcalescape():"")+(a.ATT?"&att="+a.ATT.zcalescape():"")+(a.RMVATT?"&rmatt="+a.RMVATT.zcalescape():"");if("None"!=(e=l.find("#zcl_CrmEvents_CONTACTMODULE")[0]?l.find("#zcl_CrmEvents_CONTACTMODULE")[0].value:"None")&&"Others"!=e&&(r+=""!=l.find("#zcl_CrmEvents_CONTACTNAME")[0].value?"&leContModSel="+e+"&leContModId="+l.find("#zcl_CrmEvents_CONTACTID")[0].value:""),""==(t=l.find("#zcl_CrmEvents_SEMODULE")[0]?l.find("#zcl_CrmEvents_SEMODULE")[0].value:"")||"None"!=e&&"Leads"==e&&"Candidates"==e||(r+=""!=l.find("#zcl_CrmEvents_SENAME")[0].value?"&modsel="+t+"&modid="+l.find("#zcl_CrmEvents_SEID")[0].value:""),r+="&Send Notification Email=false&Recurring Activity=false",l.find("#zcl_custfldname")[0]&&""!=l.find("#zcl_custfldname")[0].value){for(var s=l.find("#zcl_custfldname")[0].value.split(";"),d=l.find("#zcl_custfldlbl")[0].value.split(";"),o="",u=0;u<s.length;u++)if(-1!=s[u].indexOf("boolean")){if(l.find("#zcl_"+s[u])[0]){var p="msi-check"==l.find("#zcl_"+s[u])[0].className?"true":"false";r+="&"+s[u]+"="+p,o+=(""!=o?",":"")+'"'+s[u]+'":"'+d[u]+'"'}}else if(-1!=s[u].indexOf("datetime"))l.find("#zcl_"+s[u])[0]&&(r+="&"+s[u]+"="+l.find("#zcl_"+s[u])[0].value,o+=(""!=o?",":"")+'"'+s[u]+'":"'+d[u]+'"',r+="&"+s[u]+"_time="+ZCL_TimetoNo(l.find("#zcl_"+s[u]+"_time")[0].value));else if(-1!=s[u].indexOf("mselect")){if(l.find("#zcl_"+s[u])[0]){for(var m=l.find("#zcl_"+s[u])[0],_=(p="",0);_<m.length;_++)1==m[_].selected&&(p+=""==p?m[_].value:";"+m[_].value);r+="&"+s[u]+"="+p,o+=(""!=o?",":"")+'"'+s[u]+'":"'+d[u]+'"'}}else{if(-1!=s[u].indexOf("anumber")||-1!=s[u].indexOf("formula"))continue;l.find("#zcl_"+s[u])[0]&&(r+="&"+s[u]+"="+l.find("#zcl_"+s[u])[0].value.zcalescape(),o+=(""!=o?",":"")+'"'+s[u]+'":"'+d[u]+'"')}r+=""!=(o=""!=o?"{"+o+"}":o)?"&customFlds="+encodeURIComponent(o):""}a.EID&&(r+="&eid="+a.EID+"&euid="+a.EUID),r+="&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend=",r+=zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),r+="&ckey="+zcal.getCalObj(l.find("#zcl_crel")[0].value)[9],null!=ZCL_OLD_COBJ&&(r+="&oldckey="+ZCL_OLD_COBJ[9],r+="&oldctype="+ZCL_OLD_COBJ[5]),ZCL_TEMP_EOBJ=a,ZCL_XHR(r,function(e){ZCL_retDET(e)})},t=function(e){var t=JSON.parse(e.responseText);"success"==t.status&&("recruit"==t.mode?(t.uobj,r=t.cuser):(t.uobj,s=t.cuser,n=t.ccode,ZCL_updateCalAndEvents()))},le=function(e){var t=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,a=ZCL_Evl(1,e.responseText);if("list"==a.mode)ce(a.notes);else if("add"==a.mode){if("success"==a.status){var l,c=a.nobj;t.find("div#zcl_addnoteform").remove(),t.find("#zcl_addnote").parent().show(),i=(1==h?ie:_constCrmv2Note)(c),0<(l=t.find("#zcl_crm_noteslst").find("li:first")).length?l.before(i):t.find("#zcl_crm_noteslst").append(i)}}else if("edit"==a.mode){if("success"==a.status){c=a.nobj;var i,n=$("li#zcl_crmnote_"+c.id);t.find("div#zcl_addnoteform").remove(),t.find("#zcl_addnote").parent().show(),i=1==h?$("<div>"+(c.Title?"<b>"+c.Title+"</b>":"")+"<p>"+ZCL_getDescHTML(c["Note Content"])+"</p></div>"):$("<div>"+(c.Note_Title?"<b>"+c.Note_Title+"</b>":"")+"<p>"+ZCL_getDescHTML(c.Note_Content)+"</p></div>"),n.find("div:first").replaceWith(i),n.find(".zcl_txr").show()}}else"del"==a.mode&&"success"==a.status&&t.find("#zcl_crmnote_"+a.noteid).remove()},ce=function(e){var t,a=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;if(a.find("#zcl_crm_noteslst").length||a.find("#zcl_ce").find("li.zcl_crmnt").append('<ul id="zcl_crm_noteslst"/>'),(t=a.find("#zcl_ce").find("#zcl_crm_noteslst")).length)if(1==h)for(var l=0;l<e.length;l++)t.append(ie(e[l]));else for(var c=0;c<e.length;c++)t.append(_constCrmv2Note(e[c]))},ie=function(t){var e,a,l,c="";return c+='<li id="zcl_crmnote_'+t.id+'"><div>'+(t.Title?"<b>"+t.Title+"</b>":"")+"<p>"+ZCL_getDescHTML(t["Note Content"])+'</p></div><div class="zcl_table"><ul><li><span class="zcl_lk">'+t["Owner Name"]+'</spam><span class="zcl_grey">'+t["Created Time"]+'</span></li><li class="zcl_txr"><i class="msi-edit"></i><span></span><i class="msi-trash"></i></li></ul></div></li>',(a=(e=$(c)).find("i.msi-edit")).length&&a.off("click").on("click",{title:t.Title||"",content:t["Note Content"],id:t.id},function(e){ne($(this).parent(),e.data.id,e.data.title,e.data.content)}),(l=e.find("i.msi-trash")).length&&l.off("click").on("click",function(){var e=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];ZCL_XHR("/cal/crmNotes.do?mode=del&noteId="+t.id+"&service="+("recruit"==zcal.EOBJ[e].SERVICE?"ZohoRecruit":"ZohoCrm")+"&ckey="+zcal.getCalObj(crmCalId)[9],function(e){le(e)})}),e},ne=function(e,t,a,l){e.hide();var c,i=e.closest("li#zcl_crmnote_"+t);(c=$("#zcl_addnoteform")).length&&("zcl_crm_noteslst"==c.parent().parent().attr("id")&&(c.parent().find("div:first").show(),c.parent().find("li.zcl_txr").show()),c.remove()),i.length&&(i.find("div:first").hide(),re(i,t,a,l))},re=function(e,t,a,l){var c,i,n,r=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el.find("#zcl_ce").find("span#zcl_addnote");r.parent().hide();var s='<div class="zcl_crmntad" id="zcl_addnoteform"><input type="hidden" id="zcl_crmnote_id" value="'+(t||"")+'"/><ul class="zcl_frmrw"><li><u>'+zcal.i18n.title+"</u>"+o(a)+'</li></ul><ul class="zcl_frmrw"><li><u>'+zcal.i18n.content+'</u><textarea style="height: 49px;" class="zcl_Cedes SC_tiput" id="zcl_crmnote_content">'+(l||"")+'</textarea></li></ul><ul class="zcl_frmrw"><li><div class="SC_PUbtm"><span data-marker="saveNote">'+zcal.i18n.save+'</span><span data-marker="closeNote" data-val="Cancel">'+zcal.i18n.cancel+"</span></div></li></ul></div>";(i=(c=$(s)).find("[data-marker=saveNote]").removeAttr("data-marker")).length&&i.off("click").on("click",function(){se()}),(n=c.find("[data-marker=closeNote]").removeAttr("data-marker")).length&&n.off("click").on("click",function(){$(this).parents("div#zcl_addnoteform").remove(),r.parent().show(),e.find("div:first").show(),e.find("li.zcl_txr").show()}),e.find("div:first").after(c)},se=function(){var e=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el;return""==e.find("#zcl_crmnote_title").val()?(zmUtil.succErrMsg("e","Please enter note title"),e.find("#zcl_crmnote_title")[0].focus(),!1):""==e.find("#zcl_crmnote_content").val()?(zmUtil.succErrMsg("e","Please enter note content"),e.find("#zcl_crmnote_content")[0].focus(),!1):void de()},de=function(){var e,t,a,l=zmsuite.getAppObj(zmTab.currentTab).centerObj.$el,c=1==h?"ZohoRecruit":"ZohoCrm";e=1==h?l.find("#zcl_crmnote_title").find("option:selected").text():l.find("#zcl_crmnote_title").val(),t=l.find("#zcl_crmnote_content").val(),a=l.find("#zcl_crmnote_id").val();var i="/cal/crmNotes.do?note="+t+"&title="+e+"&service="+c+"&ckey="+zcal.getCalObj(crmCalId)[9]+(1==h?"&id="+l.find("#zcl_crmnote_title").val():"");ZCL_XHR(i+=""!=a?"&mode=edit&noteId="+a:"&mode=add&eventId="+l.find("#zcl_activityid").val(),function(e){le(e)})},oe=function(a){var e=zcal.getCalObj(crmCalId)[9],t=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],l="recruit"==zcal.EOBJ[t].SERVICE?"ZohoRecruit":"ZohoCrm";ZCL_uXHR("/cal/crmInvitees.do?mode=list&eventId="+a+"&service="+l+"&ckey="+e,function(e){var t=ZCL_Evl(1,e.responseText);ue(t,a)})},ue=function(e,t){"list"==e.mode?(C[t]=e.invitees,pe()):"del"==e.mode?"success"==e.status&&0==$("#zcl_crm_attlist").find("UL").length&&$("#zcl_crm_attlist").html('<ul><li><span class="zcl_grey">'+zcal.i18n.noattendee+"</span></li></ul>"):"add"==e.mode&&"success"==e.status&&oe(t)},pe=function(){var e=zmTab.currentTab.split("_")[2],t=zcal.EOBJ[e].ACTIVITYID,a=["all"];if(0<(C[t]||[]).length){var l,c;$("#zcl_crm_attlist").length||(c=$('<ul class="zcl_frmrw zcl_vwatte"><li><div><ul class="zcl_viwatt"/><div  id="zcl_crm_attlist"/></div></li></ul>'),$("ul#zcl_crmatt_info>li").append(c)),l=(c=$("#zcl_crm_attlist").parents("ul.zcl_vwatte")).find("ul.zcl_viwatt");for(var i=0;i<a.length;i++){var n=$('<li data-usts="'+a[i]+'" '+(0==i?'class="zcl_sl"':"")+">"+zcal.i18n[a[i]]+"</li>");me(n),l.append(n)}var r=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];("recruit"==zcal.EOBJ[r].SERVICE?_e:_constCrmV2Attendees)("all")}},me=function(e){e.off("click").on("click",function(){var e=$(this);e.parent().find("li").removeClass("zcl_sl"),e.addClass("zcl_sl"),_e(e.data("usts"))})},_e=function(){var e,t=zmTab.currentTab.split("_")[2],a=zcal.EOBJ[t].ACTIVITYID,l=$("#zcl_crm_attlist");e=zcalCRM.getCRMAttendee()[a]||[],l.empty();for(var c=0;c<e.length;c++){var i,n,r=e[c],s=$('<div class="zcl_viwatlst zcl_table zcl_curpt"></div>');i='<ul><li><img src="'+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+'"></li><li onclick = "ZCL_attDetail(event)"><b>'+ZCL_getHTML(r.EMAIL)+'</b></li><li class="zcl_txr">'+ZCL_AttStsIcn(r.STATUS)+'<i class="msi-close"/></li></ul>',s.append(i),n=s.find("i.msi-close"),ze(n,r),l.append(s)}},ze=function(e,t){e.off("click").on("click",{attId:t.INVITEEID,mode:zcal.EMODE},function(e){var t,a,l,c,i,n=$(this).parent().parent(),r=e.data.attId;n.remove(),t=r,a=zcal.getCalObj(crmCalId)[9],l=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2],c=$("#zcl_activityid").val(),i="recruit"==zcal.EOBJ[l].SERVICE?"ZohoRecruit":"ZohoCrm",ZCL_XHR("/cal/crmInvitees.do?mode=del&attId="+t+"&eventId="+c+"&service="+i+"&ckey="+a,function(e){var t=ZCL_Evl(1,e.responseText);ue(t,c)})})};return{showCRMForm:function(a,e){if(h="recruit"==zcal.getCalObj(crmCalId)[14]?1:0,null==a.EID&&l(a),u)i(a,e);else{var t=zcal.getCalObj(crmCalId)[9];ZCL_uXHR("/cal/getCRMFlds.do?ckey="+t+"&service="+(1==h?"ZohoRecruit":"ZohoCrm"),function(e){var t=ZCL_Evl(1,e.responseText);(t.status="success")&&c(t,a)})}},updateCRMData:c,reset:d,saveEvent:ae,loadCRMUsers:function(){if(-1!=zcal.cdata.calOUids.indexOf("zohoCrm_")){if(null==crmCalId)for(var e in zcal.cdata.calALst)zcal.cdata.calALst.hasOwnProperty(e)&&zcal.cdata.calALst[e][10][2].startsWith("zohoCrm_")&&(crmCalId=e);null!=crmCalId&&ZCL_uXHR("/cal/getCRMUsers.do?ckey="+zcal.cdata.calALst[crmCalId][9],function(e){t(e)})}-1!=zcal.cdata.calOUids.indexOf("zohoRecruit4_")&&ZCL_uXHR("/cal/getCRMUsers.do?service=ZohoRecruit",function(e){t(e)})},getCRMCurrentUser:function(){return s},getRecruitCurrentUser:function(){return r},getCRMColorCode:function(){return n},getCRMCalChild:function(e,t){var a={};for(var l in n){var c=ZCL_getCalColor(e),i=ZCL_getColorNo(c[0]);n[l][1]=-1!=i?i:c[1],"OTHERS"==l&&(i=19==i?0:i+1,n[l][1]=i,c=ZCL_getCalColor(i)),a["zcrm_"+l]={CN:n[l][0],STS:n[l][2],CC:c[1],ID:"zcrm_"+l,HC:0,SE:"OTHERS"==l?"2":"1"},zcal.appCount["zcrm_"+l]={c:"0",p:t}}return a},chgUserSts:function(e){for(var t in n)if(t==e){n[t][2]="0"==n[t][2]?"1":"0",ZCL_updateCalAndEvents();break}},getCRMAttendee:function(){return C}}}();ZCL_SetCrmsts=function(e){var t='<ul class="zcl_frmrw">';return e.CRM_STATUS&&2==e.CRM_STATUS&&(t+='<div style="display: inline-block;color:red;"><i class="msi-spam" style="color:red"></i> '+zcal.i18n.cancelled+"</div>"),t+="</ul>"};var _constCrmv2Note=function(t){var e,a,l,c="";return cdate=t.Created_Time,cdate=cdate.replace("T"," "),cdate=cdate.substr(0,19),c+='<li id="zcl_crmnote_'+t.id+'"><div>'+(t.Note_Title?"<b>"+t.Note_Title+"</b>":"")+"<p>"+ZCL_getDescHTML(t.Note_Content)+'</p></div><div class="zcl_table"><ul><li><span class="zcl_lk">'+t.Owner.name+'</spam><span class="zcl_grey">'+cdate+'</span></li><li class="zcl_txr"><i class="msi-edit"></i><span></span><i class="msi-trash"></i></li></ul></div></li>',(a=(e=$(c)).find("i.msi-edit")).length&&a.off("click").on("click",{title:t.Title||"",content:t["Note Content"],id:t.id},function(e){_openEditNote($(this).parent(),e.data.id,e.data.title,e.data.content)}),(l=e.find("i.msi-trash")).length&&l.off("click").on("click",function(){var e=4==zmTab.currentTab.split("_").length?zmTab.currentTab.split("_")[2]+"_"+zmTab.currentTab.split("_")[3]:zmTab.currentTab.split("_")[2];ZCL_XHR("/cal/crmNotes.do?mode=del&noteId="+t.id+"&service="+("recruit"==zcal.EOBJ[e].SERVICE?"ZohoRecruit":"ZohoCrm")+"&ckey="+zcal.getCalObj(crmCalId)[9],function(e){_updateNotes(e)})}),e},_constCrmV2Attendees=function(){var e,t=zmTab.currentTab.split("_")[2],a=zcal.EOBJ[t].ACTIVITYID,l=$("#zcl_crm_attlist");e=zcalCRM.getCRMAttendee()[a]||[],l.empty();for(var c=0;c<e.length;c++){var i,n,r=e[c],s=$('<div class="zcl_viwatlst zcl_table zcl_curpt"></div>');i='<ul><li><img src="'+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+'"></li><li onclick = "ZCL_attDetail(event)">',r.Email?i+="<b>"+ZCL_getHTML(r.Email)+"</b>":i+="<b>"+ZCL_getHTML(r.participant)+"</b>",i+='</li><li class="zcl_txr">'+ZCL_crmv2AttStsIcn(r.status)+'<i class="msi-close"/></li></ul>',s.append(i),n=s.find("i.msi-close"),bindcrmV2ClickOnAttendeeDelete(n,r),l.append(s)}},bindcrmV2ClickOnAttendeeDelete=function(e,t){e.off("click").on("click",{attId:t.id,mode:zcal.EMODE},function(e){var t=$(this).parent().parent(),a=e.data.attId;t.remove(),_delAttendees(a)})},ZCL_crmv2AttStsIcn=function(e){return"<i "+("yes"==e?"class='msi-like' title='"+zcal.i18n.statusyes+"'":"no"==e?"class='msi-unlike' title='"+zcal.i18n.statusno+"'":"maybe"==e?"class='msi-maybe' title='"+zcal.i18n.statusmaybe+"'":"class='msi-pending' title='"+zcal.i18n.statuspending+"'")+"></i>"};ZCL_nlp=function(e,z){var t=e;if(""==t)return 0;new Date;input=t;var m,ne,re,se,de,oe,ue,pe,me,_e,a,ze,fe,ve,he,ge,l,Ce=[dt(new Date,0),dt(new Date,1),dt(new Date,2),dt(new Date,3),dt(new Date,4),dt(new Date,5),dt(new Date,6)],ye=["tomorrow","today","now","dayaftertomorrow","day after tomorrow"],Le=[ut(new Date,1),ut(new Date,0),ut(new Date,0),ut(new Date,2),ut(new Date,2)],be=[ot(new Date,0),ot(new Date,1),ot(new Date,2),ot(new Date,3),ot(new Date,4),ot(new Date,5),ot(new Date,6)],Ee=[pt(new Date,0),pt(new Date,1),pt(new Date,2),pt(new Date,3),pt(new Date,4),pt(new Date,5),pt(new Date,6)],Te=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],De=["sundays","mondays","tuesdays","wednesdays","thursdays","fridays","saturdays"],Ze=["sun","mon","tue","wed","thu","fri","sat"],c=["first","second","third","fourth","last"],Ae=new Date,Me=Date.parse(Ae.getMonth()+parseInt(1)+"/"+Ae.getDate()+"/"+Ae.getFullYear()),Se={};Se.daily,Se.weekly,Se.monthly,Se.yearly;var ke=["January","Jan","january","jan","February","february","Feb","feb","March","march","Mar","mar","April","april","Apr","apr","May","may","June","june","Jun","jun","July","july","Jul","jul","August","august","Aug","aug","September","Sep","september","sep","October","Oct","october","oct","November","Nov","november","nov","December","Dec","dec","december"],we=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],Oe=["january","february","march","april","may","june","july","august","september","october","november","december"],i=[/\b(test\s?machine|server\s?machine|windows\s?machine|mac\s?machine|windows\sos\smachine|mac\sos\smachine)\b/,/\b(cab|shuttle)\b/,/(room|hall)/,/\b(projector|speaker)\b/],r={};r.typ,r.details={};var n,s,d=/\b(avadi|dlf|guindy|puzthivakkam|thirumangalam|vadapalani|velachery|guduvanchery|urapakkam|perungalathur|mogappair|koyambedu|cmbt|medavakkam|vandalur)\b/,o=/\b(confluence|meeting|(video\s)?conference|seminar|training|join|lunch|party)\s(room|hall)\b/,u=/\b((tower|plaza)\s(building)|estancia)\b/,p={},_={},Ie=/\b(first|second|third|fourth|last|next|this)\s(\bsunday\b|\bmonday\b|\btuesday\b|\bwednesday\b|\bthursday\b|\bfriday\b|\bsaturday\b|\bsun\b|\bmon\b|\btue\b|\bwed\b|\bthu\b|\bfri\b|\bsat\b)\b/,xe=/\b(today|now|tomorrow|(day\s?after\s?tomorrow))\b/,f=/\b(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)-(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\s(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\b/,v=/\b(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\s(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)-(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\s(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\b/,h=/\b(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\s(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)-(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\b/,g=/((today|tomorrow)(\s+)?(,)?)(\s+)?(monday|tuesday|wednesday|thursday|friday|saturday|sunday|sun|mon|tue|wed|thu|fri|sat)(\s+)?(,)?(\s+)?\(?(\s+)?(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?[0-9]{1,2}(st|rd|th|nd)(\s+)?\)?/,C=/((today|tomorrow)(\s+)?(,)?(\s)?)?(sunday|monday|tuesday|wednesday|thursday|friday|saturday|sun|mon|tue|wed|thu|fri|sat)(\s+)?(,)?(\s+)?\(?(\s+)?[0-9]{1,2}(st|rd|nd|th)?(\s+)?(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?\).?/,y=/\b(monday|tuesday|wednesday|thursday|friday|saturday|sunday|sun|mon|tue|thu|fri|sat|sun)(,)?(\s+)?(the)?(\s+)?(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\sof\s((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))((\s(19|20)\d\d)|('[0-9]{1,2}))?\b/,L=/\b[0-9]{1,2}(\s+)?(january|february|march|april|may|june|july|august|sepetember|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(')[0-9]{1,2}\b/,b=/\b[0-9]{1,2}(st|nd|rd|th)(\s+)(of)(\s+)(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?'[0-9]{2}\b/,E=/[0-9]{1,2}(st|rd|nd|th)?(\s+)?(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?(,)?(\s?)\(?(\s+)?(monday|tuesday|wednesday|thursday|friday|saturday|sunday|mon|tue|wed|thu|fri|sat|sun)(\s+)?\)?/,T=/(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?[0-9]{1,2}(st|rd|nd|th)(\s+)?(,)?(\s+)?\(?(\s+)?(sunday|monday|tuesday|wednesday|thursday|friday|saturday|sun|mon|tue|wed|thu|fri|sat|sun)(\s+)?\)?/,D=/\b(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?[0-9]{1,2}(st|rd|nd|th)(\s+)?(,)?(\s+)?[0-9]{4}(\s+)?(,)?(\s+)?(sunday|monday|tuesday|wednesday|thursday|friday|saturday|sat|sun|mon|tue|wed|thu|fri)\b/,Z=[/\b((0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.](0?[1-9]|1[012])[\-|\/|\.](19|20)\d\d)\b/,/\b(0?[1-9]|1[012])[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.](19|20)\d\d\b/,/\b(19|20)\d\d[\-|\/|\.](0?[1-9]|1[012])[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])\b/,/\b(19|20)\d\d[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.](0?[1-9]|1[012])\b/,/\b(0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.](0?[1-9]|1[012])\b[\-|\/|\.]\d\d\b/,/\b(0?[1-9]|1[012])\b[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.]\d\d\b/,/\b(0?[1-9]|[1|2][0-9]|3[0|1])[\/](0?[1-9]|1[012])\b/,/\b(0?[1-9]|1[012])[\/](0?[1-9]|[1|2][0-9]|3[0|1])\b/,/\b(0[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.]((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))[\-|\/|\.]?((19|20)?\d\d)?\b/,/\b(19|20)\d\d[\-|\/|\.]((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))[\-|\/|\.](0[1-9]|[1|2][0-9]|3[0|1])\b/,/\b(0?[1-9]|[1|2][0-9]|3[0|1])\s?((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))((\s|(\s+)?,(\s+)?)(19|20)?\d\d(?!:))?\b/,/\b(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\s((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))((\s|(\s+)?,(\s+)?)(19|20)?\d\d)?\b/,/\b((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))\s?(0?[1-9]|[1|2][0-9]|3[0|1])((\s|(\s+)?,(\s+)?)?(19|20)\d\d)?\b/,/\b(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.]?((19|20)\d\d)?\b/,/\b((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))\s(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)((\s|(\s+)?,(\s+)?)(19|20)\d\d)?\b/,/(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\sof\s((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))((\s|(\s+)?,(\s+)?)(19|20)\d\d)?\b/,/\bsunday\b|\bmonday\b|\btuesday\b|\bwednesday\b|\bthursday\b|\bfriday\b|\bsaturday\b|\bsun\b|\bmon\b|\btue\b|\bwed\b|\bthu\b|\bfri\b|\bsat\b/,xe,/\b(saturdays|sundays|mondays|tuesdays|wednesdays|thursdays|fridays)\b/,/\b(weekend)s?\b/,/\b(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\s?(0?[1-9]|[1|2][0-9]|3[0|1])-(0?[1-9]|[1|2][0-9]|3[0|1])\b/,/\b(0?[1-9]|[1|2][0-9]|3[0|1])-(0?[1-9]|[1|2][0-9]|3[0|1])\s?(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\b/],Ne=/[ \t\n\r]+/gi,A=[/\b(0?[0-9]|1[0-9]|2[0-4]){1,2}([:|.](0[0-9]|[1-4][0-9]|5[0-9]))?\s?(am|pm|hrs)\b/,/\b(0?[0-9]|1[0-9]|2[0-3])([:](0[0-9]|[1-4][0-9]|5[0-9]))\b/,/\b(morning|noon|afternoon|evening)\b/,/\b(dinner|breakfast|lunch|supper|brunch|tea)\b/,/\b(0?[0-9]|1[0-9]|2[0-4]){1,2}([:|\.](0[0-9]|[1-4][0-9]|5[0-9]))?\s?(am|pm|hrs)?-(0?[0-9]|1[0-9]|2[0-4]){1,2}([:|\.](0[0-9]|[1-4][0-9]|5[0-9]))?\s?(am|pm|hrs)\b/,/\b(now)\b/,/\b(after)\s?[0-9]{1,2}\s?(hours|hrs)\b/],M=(Te=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],new Object);M.noon="43200000",M.breakfast="28800000",M.dinner="75600000",M.lunch="43200000",M.afternoon="43200000",M.supper="61200000",M.morning="28800000",M.evening="61200000",M.tea="61200000";for(var S,Re,$e,Pe,k,w,O,I,x={one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",ten:"10",eleven:"11",twelve:"12",thirteen:"13",fourteen:"14",fifteen:"15",sixteen:"16",seventeen:"17",eighteen:"18",nineteen:"19",twenty:"20",thirty:"30",forty:"40",fifty:"50",sixty:"60",seventy:"70",eighty:"80",ninty:"90",hundred:"100"},N=["first","second","third","fourth","last"],He=new Object,R=input.trim().toLowerCase(),$=R=(R=R.replace(/\ba.m\b/g,"am")).replace(/\bp.m\b/g,"pm"),P=new Array,H=R.split(Ne),U=[],j=[],Ue="",B=(new Date,new Date,0);B<H.length;B++)x[H[B]]&&H[B+1]&&x[H[B+1]]&&(H[B+1]=(parseInt(x[H[B]])+parseInt(x[H[B+1]])).toString(),H[B]="for"==H[B-1]?H[B-1]:""),x[H[B]]&&(H[B]=x[H[B]]),H[B].match(/^(from|(begin)s?|(start)s?|between|(open)s?|starting|commence)$/)&&U.push(B),H[B].match(/^(to|(end)s?|-|and|(close)s?|till|until|over|ending)$/)&&j.push(B),H[B].match("once")&&H[B-1]&&H[B-1].match(/(day)s?/)&&H[B-2]&&H[B-2].match(/[0-9]{1,2}/)&&(n=H[B-2]),H[B].match("once")&&H[B-1]&&H[B-1].match(/(month)s?/)&&H[B-2]&&H[B-2].match(/[0-9]{1,2}/)&&(s=H[B-2]),Ue=Ue+" "+H[B];if(0!=U.length&&0!=j.length){if(U[0]<j[0]){for(var F="",Y=0;Y<U[0];Y++)F=F+" "+H[Y];if($e=at(F),k=ct(F),0==z)for(var V in M)F.match(V)&&M[V]==k&&(k="",$=Ue);F.match(/\b(every|all)\b/)&&($e=F.match(/\b(every|all)\b/)?"":$e,k=F.match(/\b(every|all)\b/)?"":k,Re=1),w=k?parseInt(k)+parseInt(36e5):null}for(var G=0;G<U.length;G++){var q,J,W,X,Q,K,ee=0;if((G<U.length?U[G]:100)<(G<j.length?j[G]:-1)){for(ee=G;U[ee]<j[G];)ee++;F="";for(var te=U[G];te<j[G];te++)F=F+" "+H[te];"days"==H[U[G]-1]&&H[U[G]-2]&&H[U[G]-2].match(/[0-9]{1,2}/)&&H[U[G]-3]&&!H[U[G]-3].match("every")&&("for"==H[U[G]-3]&&(K=1),q=864e5*H[U[G]-2]),H[U[G]-1]&&H[U[G]-1].match(/(hour|hours)/)&&H[U[G]-2]&&H[U[G]-2].match(/[0-9]{1,2}/)&&H[U[G]-3]&&!H[U[G]-3].match(/(after|in)/)?J=36e5*H[U[G]-2].match(/[0-9]{1,2}/):H[U[G]-1]&&H[U[G]-1].match(/(hour|hours)/)&&H[U[G]-2]&&H[U[G]-2].match(/[0-9]{1,2}/)&&H[U[G]-3]&&H[U[G]-3].match(/(after|in)/)&&(X=36e5*H[U[G]-2].match(/[0-9]{1,2}/)),H[U[G]-1]&&H[U[G]-1].match(/(minute|minutes)/)&&H[U[G]-2]&&H[U[G]-2].match(/[0-9]{1,2}/)&&H[U[G]-3]&&!H[U[G]-3].match(/(after|in)/)?W=6e4*H[U[G]-2].match(/[0-9]{1,2}/):H[U[G]-1]&&H[U[G]-1].match(/(minute|minutes)/)&&H[U[G]-2]&&H[U[G]-2].match(/[0-9]{1,2}/)&&H[U[G]-3]&&H[U[G]-3].match(/(after)/)&&(Q=6e4*H[U[G]-2].match(/[0-9]{1,2}/));var je=1;if($e?k||null!=at(F)||(k=k||ct(F),w=w?"":J?parseInt(ct(F))+parseInt(J):W?parseInt(ct(F))+parseInt(W):"",je=0):($e=$e||(q&&!K?parseInt(at(F))+parseInt(q):at(F)),1==K&&(Pe=Pe||parseInt(at(F))+parseInt(q)),k=k||(X?parseInt(ct(F))+parseInt(X):Q?parseInt(ct(F))+parseInt(Q):ct(F)),w=w||(J?parseInt(ct(F))+parseInt(J):W?parseInt(ct(F))+parseInt(W):""),je=0),($e||k)&&0==je&&("and"==H[j[G]]&&("between"==H[U[G]]||ee-1!=G&&R.match("between")||H[j[G]+1]&&H[j[G]+1].match(/(end|ends|closes|over|close|ending)/)||G+1<j.length&&H[j[G+1]].match(/(end|ends|closes|close|over|to|ending)/))||"and"!=H[j[G]])){var ae="",le="";for(te=j[G]+1;te<U[G+1];te++)ae=ae+" "+H[te];if("and"==H[j[G]]&&"between"!=H[U[G]])(lt(ae)?lt(ae):it(ae)?it(ae):"")&&(ae="");if(ae)if(ae.match("to"))le=ae.split("to")[1];if(!U[G+1]&&j[G+1]){for(var ce=j[G]+1;ce<j[G+1];ce++)ae=ae+" "+H[ce];if("and"==H[j[G]]&&H[j[G+1]].match(/(end|ends|closes|over|to|close|ending)/))if(lt(ae)?lt(ae):it(ae)?it(ae):"")"between"!=H[U[G]]&&(ae="");else for(ce=j[G+1];ce<H.length;ce++)ae=ae+" "+H[ce];if("to"==H[ce])for(var ie=ce;ie<H.length;ie++)le=le+" "+H[ie]}if(!U[G+1]&&!j[G+1]&&!ae)for(ce=j[G]+1;ce<H.length;ce++)ae=ae+" "+H[ce];if(ee-1!=G&&U[ee]&&!ae)for(var Be=j[G]+1;Be<U[ee];Be++)ae=ae+" "+H[Be];else if(ee-1!=G&&!U[ee]&&!ae){for(Be=j[G]+1;Be<H.length;Be++)ae=ae+" "+H[Be];if("and"==H[j[G]]&&"between"!=H[U[G]])if(ee-1!=G&&H["between"!=U[ee-1]])(lt(ae)?lt(ae):it(ae)?it(ae):"")&&(ae="")}var Fe=0;if(ae.match(/[0-9]{1,2}\s?(day)s?/)){for(ce=j[G]+1;ce<(U[G+2]?U[G+2]:j[G+1]?j[G+1]:H.length);ce++)ae=ae+" "+H[ce];Fe=1,U.shift()}if(ae.match(/[0-9]{1,2}\s?(hours|hour|minute|minutes)/)){for(ce=j[G]+1;ce<(U[G+2]?U[G+2]:j[G+1]?j[G+1]:H.length);ce++)ae=ae+" "+H[ce];U.shift()}if(Pe=Pe||lt(ae),!ae.match(/[0-9]{1,2}\s?(day)s?\s?(from|after)/)&&1==Fe){var Ye=ae.match(/[0-9]{1,2}/);Pe=Pe||parseInt($e)+864e5*Ye[0]}(w=w||it(ae))&&!k&&le&&it(le)&&(k=w,w=it(le)),$e&&!Pe&&(Pe=$e),!$e&&Pe&&k&&($e=Date.parse(Ae.getMonth()+parseInt(1)+"/"+Ae.getDate()+"/"+Ae.getFullYear())),k&&!w&&(w=k+36e5),!k&&w&&(k=w-36e5)}}else if(G<j.length&&j[G]){for(var Ve,Ge=j[G],qe=(F="",Pe),Je=(je=0,0);Je<j[G];Je++)F=F+" "+H[Je];if($e=$e||at(F),je=!$e&&H[j[G]].match(/(till|end|ends)/)?1:"",k=k||ct(F),je=!k&&H[j[G]].match(/(till|end|ends )/)?1!=je?1:je:"",$e||k||1==je){for(ae="",ce=j[G];ce<U[G];ce++)ae=ae+" "+H[ce];Pe=Pe||lt(ae),Ve=lt(ae),w=w||it(ae),Pe&&!$e&&($e=$e||Date.parse(Ae.getMonth()+parseInt(1)+"/"+Ae.getDate()+"/"+Ae.getFullYear())),w&&!k&&(k=k||parseInt(36e5*Ae.getHours())+parseInt(6e4*Ae.getMonth()))}if(j.shift(),"and"==H[Ge]&&null!=Ve||Ve&&Ve!=Pe){Pe=qe||"";break}if(!j[G=j[G]?G-1:G]){if(!$e){F="";for(var We=U[G];We<H.length;We++)F=F+" "+H[We];$e=at(F)}if(!k){for(F="",We=U[G];We<H.length;We++)F=F+" "+H[We];k=ct(F)}}}else{if(!$e){for(F="",We=U[G];We<H.length;We++)F=F+" "+H[We],ee=0;$e=at(F)}if(!k){for(F="",We=U[G];We<H.length;We++)F=F+" "+H[We],ee=0;k=ct(F)}}G=ee-1==G||0==ee?G:ee-1}}if(0==U.length&&0!=j.length)for(G=0;G<j.length;G++)if(0==G){for(F="",te=0;te<j[G];te++)F=F+" "+H[te];je=1;if($e)k||null!=at(F)||(k=k||ct(F),je=0);else{if($e=$e||at(F),Se.daily=H[j[G]].match(/(ends|end|until|till)/)&&!$e&&F.match(/(every|all)\s?(weekday)s?/)?1:"",ge=H[j[G]].match(/(ends|end|until|till)/)&&!$e&&F.match(/(every|all)\s?(weekday)s?/)?1:"",H[j[G]].match(/(ends|end|until|till)/)&&!$e&&1!=Se.daily){var Xe=F.match(/every\s?[0-9]{1,2}\s?(day)s?/);ge=Xe?1:"",Se.daily=Xe?1:"";var Qe=Xe?Xe[0].match(/[0-9]{1,2}/):"";he=Qe?Qe[0]:""}if(H[j[G]].match(/(ends|end|until|till)/)&&!$e&&1!=Se.daily&&F.match(/[0-9]{1,2}\s?of\s?every\s?([0-9]{1,2})?\s?month/)){var Ke=(wt=F.split("every"))[0].match(/[0-9]{1,2}/);if(wt[1].match(/[0-9]{1,2}\s?month/)){var tt=wt[1].match(/[0-9]{1,2}\s?month/)[0].match(/[0-9]{1,2}/);Se.monthly=1,a=Ke[0],_e=tt[0]}else Se.monthly=1,a=Ke[0]}$e=H[j[G]].match(/(ends|end|until|till)/)&&!$e?Date.parse(Ae.getMonth()+parseInt(1)+"/"+Ae.getDate()+"/"+Ae.getFullYear()):$e,k=k||ct(F),k=H[j[G]].match(/(end|ends|until|till)/)&&!k?parseInt(36e5*Ae.getHours())+parseInt(6e4*Ae.getMinutes()):k,je=0}if(($e||k)&&0==je&&"and"!=H[j[G]]){for(ae="",ce=j[G]+1;ce<j[G+1];ce++)ae=ae+" "+H[ce];if(j[G+1]&&ae)for(ie=ce;ie<H.length;ie++)le=le+" "+H[ie];if(!j[G+1])for(Be=j[G]+1;Be<H.length;Be++)ae=ae+" "+H[Be];Pe=Pe||lt(ae),w=w||it(ae),!k&&w&&le&&it(le)&&(k=w,w=it(le)),(Pe||w)&&G++}}else{for(F="",te=j[G-1]+1;te<j[G];te++)"and"!=j[G-1]&&"and"!=j[G]&&(F=F+" "+H[te]);je=1;if($e?k||null!=at(F)||(k=k||ct(F),je=0):($e=$e||at(F),$e=H[j[G]].match(/(end|ends|till)/)&&!$e?Date.parse(Ae.getMonth()+parseInt(1)+"/"+Ae.getDate()+"/"+Ae.getFullYear()):$e,k=k||ct(F),k=H[j[G]].match(/(end|ends|till)/)&&!k?parseInt(36e5*Ae.getHours())+parseInt(6e4*Ae.getMinutes()):k,je=0),($e||k)&&0==je){for(ae="",ce=j[G]+1;ce<j[G+1];ce++)ae=ae+" "+H[ce];if(!j[G+1])for(ce=j[G]+1;ce<H.length;ce++)ae=ae+" "+H[ce];if(j[G+1]&&ae)for(ie=ce;ie<H.length;ie++)le=le+" "+H[ie];Pe=Pe||lt(ae),w=w||it(ae),!k&&w&&le&&it(le)&&(k=w,w=it(le))}}function at(e){try{for(var t=0;t<Z.length;t++)if(e.match(Z[t])){S=nt(e.match(Z[t]),t,e),m=17!=t?e.match(Z[t]):"";e.match(Z[t]);var a=e.match(Z[t]);if(12==t&&e.match(Z[20])){S=nt(e.match(Z[20]),20,e);var l=e.match(Z[20]);m=e.match(Z[20]),a=""}if(10==t)if(e.match(Z[21])){S=nt(e.match(Z[21]),21,e);l=e.match(Z[21]);m=e.match(Z[21]),a=""}else if(e.match(L)){var c=e;if(m=e.match(L),(e=e.replace(/\'/g," ")).match(Z[10])){S=nt(e.match(Z[10]),10,e);l=c.match(L);a=""}}if(11==t){if(e.match(v)){S=nt(e.match(v),22,e);l=e.match(v);m=e.match(v),a=""}if(e.match(f)){S=nt(e.match(f),23,e);l=e.match(f);m=e.match(f),a=""}if(e.match(C)){l=$.match(C);a=""}if(e.match(E)){l=$.match(E);a=""}}if(14==t)if(e.match(h)){S=nt(e.match(h),24,e);l=e.match(h);m=e.match(h),a=""}else if(e.match(g)){l=$.match(g);a=""}else if(e.match(T)){l=$.match(T);a=""}else if(e.match(D)){l=$.match(D);a=""}if(t=15){if(e.match(b)){var i="20"+(c=e).split("'")[1];if((n=(e=e.replace(/\'/g," ")).match(Z[15])[0]+" "+i).match(Z[15])){S=nt(n.match(Z[15]),15,e);l=c.match(b);m=c.match(b),a=""}}if(c&&c.match(y)||e.match(y)){if(c){var n,r=c;i="20"+c.split("'")[1];(n=(c=c.replace(/\'/g," ")).match(Z[15])[0]+" "+i).match(Z[15])&&(S=nt(n.match(Z[15]),15,c),m=r.match(y))}l=$.match(y);a=""}}if(""==a&&l&&0!=z)if((d=(o=(o=$.substring(0,$.indexOf(l[0]))).trim()).split(Ne)).length=""==d[d.length-1]||","==d[d.length-1]?d.length-1:d.length,d[d.length-1]&&(d[d.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on|tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||d[d.length-1].match(/@/)))if(d[d.length-1].match(/\b(tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)&&d[d.length-2]&&(d[d.length-2].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||d[d.length-2].match(/@/))){o=o.replace(d[d.length-1],"");var s=$.substring(o.lastIndexOf(d[d.length-2]),$.indexOf(l[0])+l[0].length);$=$.replace(s,"")}else if(d[d.length-1]&&d[d.length-1].match(/\b(from|on)\b/)&&d[d.length-2]&&d[d.length-2].match(/\b(start)s?|(open)s?|starting|commence/)){o=o.replace(d[d.length-1],"");s=$.substring(o.lastIndexOf(d[d.length-2]),$.indexOf(l[0])+l[0].length);$=$.replace(s,"")}else{s=$.substring(o.lastIndexOf(d[d.length-1]),$.indexOf(l[0])+l[0].length);$=$.replace(s,"")}else if(d[d.length-1].match(/\b(next|this|first|second|third|fourth|last)/))if(d[d.length-2]&&d[d.length-2].match(/\b(from)/)&&d[d.length-3]&&d[d.length-3].match(/\b(start)s?|(open)s?|starting|commence/)){o=o.replace(d[d.length-1],"");s=$.substring(o.lastIndexOf(d[d.length-3]),$.indexOf(l[0])+l[0].length);$=$.replace(s,"")}else if(d[d.length-2]&&d[d.length-2].match(/\b(starts)s?|(commence)s?|from|starting|(open)s?|on|at|between?/)){o=o.replace(d[d.length-1],"");s=$.substring(o.lastIndexOf(d[d.length-2]),$.indexOf(l[0])+l[0].length);$=$.replace(s,"")}else{s=$.substring(o.lastIndexOf(d[d.length-1]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else $=$.replace(l[0],"");else if(""!=a&&0!=z){var d,o=$.substring(0,$.indexOf(a[0])),u=$.substring($.indexOf(a[0])+a[0].length,$.length),p=(u=u.trim()).split(Ne);if((d=(o=o.trim()).split(Ne)).length=""==d[d.length-1]||","==d[d.length-1]?d.length-1:d.length,d[d.length-1]&&(d[d.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on|tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||d[d.length-1].match(/@/)))if(d[d.length-1].match(/\b(tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)&&d[d.length-2]&&(d[d.length-2].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||d[d.length-2].match(/@/))){o=o.replace(d[d.length-1],"");s=$.substring(o.lastIndexOf(d[d.length-2]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else if(d[d.length-1]&&d[d.length-1].match(/\b(from|on)\b/)&&d[d.length-2]&&d[d.length-2].match(/\b(start)s?|(open)s?|starting|commence/)){o=o.replace(d[d.length-1],"");s=$.substring(o.lastIndexOf(d[d.length-2]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else{s=$.substring(o.lastIndexOf(d[d.length-1]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else if(d[d.length-1].match(/\b(next|this|first|second|third|last|fourth)/))if(d[d.length-2]&&d[d.length-2].match(/\b(from|on|at)\b/)&&d[d.length-3]&&d[d.length-3].match(/\b(start)s?|(open)s?|starting|commence\b/)){o=o.replace(d[d.length-1],"");s=$.substring(o.lastIndexOf(d[d.length-3]),$.indexOf(a[0])+a[0].length);if($=$.replace(s,""),p[0]&&p[0].match(/\b(of)\b/)&&p[1]&&-1<Oe.indexOf(p[1])){s=$.substring(u.indexOf(d[1])+d[1].length,$.length);$=$.replace(s,"")}}else if(d[d.length-2]&&d[d.length-2].match(/\b(starts)s?|(commence)s?|from|starting|(open)s?|on|at|between?\b/)){o=o.replace(d[d.length-1],"");s=$.substring(o.lastIndexOf(d[d.length-2]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else{s=$.substring(o.lastIndexOf(d[d.length-1]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else $=$.replace(a[0],"");P.push(Ue.indexOf(a[0]))}return S}}catch(e){}}function lt(e){try{for(var t=0;t<Z.length;t++)if(e.match(Z[t])){je=nt(e.match(Z[t]),t,e),m=16!=t?e.match(Z[t]):"";e.match(Z[t]);var a=e.match(Z[t]);if(10==t&&e.match(L)){var l=e;if(m=e.match(L),(e=e.replace(/\'/g," ")).match(Z[10])){S=nt(e.match(Z[10]),10,e);var c=l.match(L);a=""}}if(11==t){if(e.match(C)){c=$.match(C);a=""}if(e.match(E)){c=$.match(E);a=""}}if(14==t)if(e.match(T)){c=$.match(T);a=""}else if(e.match(D)){c=$.match(D);a=""}if(t=15){if(e.match(b)){var i="20"+(l=e).split("'")[1];if((n=(e=e.replace(/\'/g," ")).match(Z[15])[0]+" "+i).match(Z[15])){S=nt(n.match(Z[15]),15,e);c=l.match(b);m=l.match(b),a=""}}if(l&&l.match(y)||e.match(y)){if(l){var n,r=l;i="20"+l.split("'")[1];(n=(l=l.replace(/\'/g," ")).match(Z[15])[0]+" "+i).match(Z[15])&&(S=nt(n.match(Z[15]),15,l),m=r.match(y))}c=$.match(y);a=""}}if(""==a&&c&&0!=z)if((o=(d=(d=$.substring(0,$.indexOf(c[0]))).trim()).split(Ne)).length=""==o[o.length-1]||","==o[o.length-1]?o.length-1:o.length,o[o.length-1]&&o[o.length-1].match(/\b(to|(end)s?|-|and|on|(close)s?|till|until|over|ending|tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/))if(o[o.length-1].match(/\b(tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)&&o[o.length-2]&&o[o.length-2].match(/\b(to|(end)s?|-|and|on|(close)s?|till|until|over|ending)\b/)){d=d.replace(o[o.length-1],"");var s=$.substring(d.lastIndexOf(o[o.length-2]),$.indexOf(c[0])+c[0].length);$=$.replace(s,"")}else if(o[o.length-1]&&o[o.length-1].match(/\b(on)\b/)&&o[o.length-2]&&o[o.length-2].match(/\b(end)?s|(close)s?\b/)){if(d=d.replace(o[o.length-1],""),o[o.length-3]&&o[o.length-3].match(/\b(and)\b/))s=$.substring(d.lastIndexOf(o[o.length-3]),$.indexOf(c[0])+c[0].length);else s=$.substring(d.lastIndexOf(o[o.length-2]),$.indexOf(c[0])+c[0].length);$=$.replace(s,"")}else{s=$.substring(d.lastIndexOf(o[o.length-1]),$.indexOf(c[0])+c[0].length);$=$.replace(s,"")}else $=$.replace(c[0],"");else if(a&&0!=z){var d,o;if((o=(d=(d=$.substring(0,$.indexOf(a[0]))).trim()).split(Ne)).length=""==o[o.length-1]||","==o[o.length-1]?o.length-1:o.length,o[o.length-1]&&(o[o.length-1].match(/\b(to|(end)s?|and|on|(close)s?|till|until|over|ending|today|tomorrow|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||o[o.length-1].match("-")))if(o[o.length-1].match(/\b(today|tomorrow|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)&&o[o.length-2]&&o[o.length-2].match(/\b(to|(end)s?|-|and|on|(close)s?|till|until|over|ending)\b/)){d=d.replace(o[o.length-1],"");s=$.substring(d.lastIndexOf(o[o.length-2]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else if(o[o.length-1]&&o[o.length-1].match(/\b(on)\b/)&&o[o.length-2]&&o[o.length-2].match(/\b(end)?s|(close)s?\b/)){if(d=d.replace(o[o.length-1],""),o[o.length-3]&&o[o.length-3].match(/\b(and)\b/))s=$.substring(d.lastIndexOf(o[o.length-3]),$.indexOf(a[0])+a[0].length);else s=$.substring(d.lastIndexOf(o[o.length-2]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else{s=$.substring(d.lastIndexOf(o[o.length-1]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else if(o[o.length-1].match(/\b(next|this|first|second|third|fourth|last)\b/))if(o[o.length-2]&&o[o.length-2].match(/\b(on)\b/)&&o[o.length-3]&&o[o.length-3].match(/\b(end)?s|(close)s?|ending\b/)){if(d=d.replace(o[o.length-1],""),o[o.length-4]&&o[o.length-4].match(/\b(and)\b/))s=$.substring(d.lastIndexOf(o[o.length-4]),$.indexOf(a[0])+a[0].length);else s=$.substring(d.lastIndexOf(o[o.length-3]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else if(o[o.length-2]&&o[o.length-2].match(/\bto|(end)s?|till|untill|ending|over|(close)s?/)){d=d.replace(o[o.length-1],"");s=$.substring(d.lastIndexOf(o[o.length-2]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else{s=$.substring(d.lastIndexOf(o[o.length-1]),$.indexOf(a[0])+a[0].length);$=$.replace(s,"")}else $=$.replace(a[0],"")}return je}}catch(e){}}function ct(e){try{e=m?e.replace(m[0]," "):e;for(var t=0;t<A.length;t++)if(e.match(A[t])){var a=e?e.match(/[0-9]{1,2}\s?(hour|hours|minutes|minute)\s?after/)?e.match(/[0-9]{1,2}\s?(hour|hours|minutes|minute)\s?after/):e.match(/(after)\s?[0-9]{1,2}\s?(hour|hours|minutes|minute)/)?e.match(/(after)\s?[0-9]{1,2}\s?(hour|hours|minutes|minute)/):"":"",l=a?a[0].match(/[0-9]{1,2}/):"",c=a?e.match(/(hour|hours)/)?36e5*l[0]:6e4*l[0]:"";st=rt(e.match(A[t]),t),st=c?parseInt(st)+parseInt(c):st;var i=e?e.match(/(for)\s?[0-9]{1,2}\s?(hour|hours|minutes|minute)/)?e.match(/(for)\s?[0-9]{1,2}\s?(hour|hours|minutes|minute)/):e.match(/[0-9]{1,2}\s?(hours|hour|minutes|minute)\s?(from)/):"";l=i?i[0].match(/[0-9]{1,2}/):"",c=i?e.match(/(hour|hours)/)?36e5*l[0]:6e4*l[0]:"",a||(st=i?rt(e.match(A[t]),t):st),w=c&&st?parseInt(st)+parseInt(c):"";var n,r=e.match(A[t]);if(0==t)if(e.match(A[4]))st=rt(e.match(A[4]),4),n=e.match(A[4]),P.push(Ue.indexOf(n[0])),r="";else{var s=e.match(A[t]);if(!s[0].match(/(am|pm)/)&&e.match(/\b(0?[0-9]|1[0-9]|2[0-3])([:|.](0[0-9]|[1-4][0-9]|5[0-9]))\s?(am|pm|hrs)?\b/)&&0==z){n=e.match(/\b(0?[0-9]|1[0-9]|2[0-3])([:|.](0[0-9]|[1-4][0-9]|5[0-9]))\s?(am|pm|hrs)?\b/),r="",P.push(Ue.indexOf(n[0]));var d=e.match(/(am|pm|hrs)/);st=rt(e.match(/\b(0?[0-9]|1[0-9]|2[0-3])([:|.](0[0-9]|[1-4][0-9]|5[0-9]))\s?(am|pm|hrs)?\b/),d?0:1)}else!s[0].match(/(am|pm)/)&&e.match(/\b(0?[0-9]|1[0-9]|2[0-3])\s?(am|pm)\b/)&&0==z&&(n=e.match(/\b(0?[0-9]|1[0-9]|2[0-3])\s?(am|pm)\b/),r="",P.push(Ue.indexOf(n[0])),st=rt(e.match(/\b(0?[0-9]|1[0-9]|2[0-3])\s?(am|pm)\b/),0))}if(""==r&&n)if(0<$.indexOf(n[0]))if((p=(u=$.substring(0,$.indexOf(n[0]))).split(Ne)).length=""==p[p.length-1]?p.length-1:p.length,p[p.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||p[p.length-1].match(/@/)){var o=$.substring(u.lastIndexOf(p[p.length-1]),$.indexOf(n[0])+n[0].length);$=$.replace(o,"")}else $=$.replace(n[0],"");else $=$.replace(n[0],"");else if(""!=r)if(0<$.indexOf(r[0])){var u,p;if((p=(u=$.substring(0,$.indexOf(r[0]))).split(Ne)).length=""==p[p.length-1]?p.length-1:p.length,p[p.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||p[p.length-1].match(/@/)){o=$.substring(u.lastIndexOf(p[p.length-1]),$.indexOf(r[0])+r[0].length);$=$.replace(o,"")}else $=$.replace(r[0],"");P.push(Ue.indexOf(r[0]))}else $=$.replace(r[0],"");return st}}catch(e){}}function it(e){try{e=m&&e?e.replace(m[0]," "):e;for(var t=0;t<A.length;t++)if(e.match(A[t])){var a=e?e.match(/[0-9]{1,2}\s?(hour|hours|minutes|minute)\s?after/):"",l=a?a[0].match(/[0-9]{1,2}/):"",c=a?e.match(/(hour|hours)/)?36e5*l[0]:6e4*l[0]:"";if(0==t)if(e.match(A[4]))k=rt(e.match(A[4]),4),e=e.match(A[4])[0].split("-")[1];et=rt(e.match(A[t]),t),et=c&&a?parseInt(et)+parseInt(c):et;var i=e.match(A[t]);if(i){var n=$.substring(1,$.indexOf(i[0])),r=n.split(Ne);if(r.length=""==r[r.length-1]?r.length-1:r.length,r[r.length-1].match(/(to|(end)s?|-|and|on|(close)s?|till|until|over|ending|at)/)){var s=$.substring(n.lastIndexOf(r[r.length-1]),$.indexOf(i[0])+i[0].length);$=$.replace(s,"")}else $=$.replace(i[0],"")}return P.push(Ue.indexOf(i[0])),et}}catch(e){}}function nt(e,t,a){try{if(0==t||1==t||2==t||3==t||4==t||5==t||6==t||7==t){var l=(i=a.split(Ne)).indexOf(e[0]);e[0]=e[0].replace(/(-|\.)/g,"/");var c=e[0].split("/");if(!(i[l-1]&&i[l-1].match(/(from|after|before)/)&&i[l-2].match(/(day)s?/)&&i[l-3]&&i[l-3].match(/[0-9]{1,2}/))||He.isrem)return i[l+1]&&i[l+1].match("for")&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/)&&(Pe=Date.parse((0==t||2==t||4==t||6==t?(0==t||4==t||6==t)&&c[1]<=12&&c[0]<=12?c[0]:c[1]:1==t||5==t||7==t?c[0]:3==t?c[2]:"")+"/"+(parseInt(0==t||4==t||6==t?c[1]<=12&&c[0]<=12?c[1]:c[0]:1==t||3==t||5==t||7==t?c[1]:2==t?c[2]:"")+parseInt(i[l+2]))+"/"+(0==t||1==t?c[2]:2==t||3==t?c[0]:4==t||5==t?"20"+c[2]:6==t||7==t?Ae.getFullYear():""))),Date.parse((0==t||2==t||4==t||6==t?(0==t||4==t||6==t)&&c[1]<=12&&c[0]<=12?c[0]:c[1]:1==t||5==t||7==t?c[0]:3==t?c[2]:"")+"/"+(0==t||4==t||6==t?c[1]<=12&&c[0]<=12?c[1]:c[0]:1==t||3==t||5==t||7==t?c[1]:2==t?c[2]:"")+"/"+(0==t||1==t?c[2]:2==t||3==t?c[0]:4==t||5==t?"20"+c[2]:6==t||7==t?Ae.getFullYear():""));if("Invalid Date"!=(b=new Date(Date.parse((0==t||2==t||4==t||6==t?(0==t||4==t||6==t)&&c[1]<=12&&c[0]<=12?c[0]:c[1]:1==t||5==t||7==t?c[0]:3==t?c[2]:"")+"/"+(0==t||4==t||6==t?c[1]<=12&&c[0]<=12?c[1]:c[0]:1==t||3==t||5==t||7==t?c[1]:2==t?c[2]:"")+"/"+(0==t||1==t?c[2]:2==t||3==t?c[0]:4==t||5==t?"20"+c[2]:6==t||7==t?Ae.getFullYear():""))))&&i[l-4]&&"for"!=i[l-4]){if(i[l-1].match(/(from|after)/)?b.setDate(b.getDate()+parseInt(i[l-3])):i[l-1].match(/(before)/)&&b.setDate(b.getDate()-parseInt(i[l-3])),i[l+1]&&i[l+1].match(/(for)/)&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/))(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l+2])),Pe=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear());return Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear())}if("Invalid Date"!=b&&i[l-4]&&"for"==i[l-4])return(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l-3])),Pe=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear()),b;if("Invalid Date"==b)return Me}if(8==t||9==t||10==t||12==t||13==t){var i=a.split(Ne),n=e[0];c=e[0].match("-")?e[0].split("-"):e[0].match(/\./)?e[0].split("."):"";if(e[0]=""!=c?c[0]+" "+c[1]+" "+(3==c.length?c[2]:Ae.getFullYear()):e[0],""==c){var r=e[0].match(/[0-9]{4}/);if(r){var s=/january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/,d=e[0].match(s),o=e[0].match(/[0-9]{1,2}/);e[0]=(d[0]?d[0]:Ae.getMonth()+parseInt(1))+" "+(o||Ae.getDate())+" "+r}else{s=/january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/;var u=e[0].split(s),p=(d=e[0].match(s),o=10==t?u[0]?u[0]:"":12==t&&u[1]?u[1]:"",10==t&&u[1]?u[1]:Ae.getFullYear());o=o?o.replace(" ",""):"",p=10==t&&u[1]?p.replace(" ",""):p,d[0]=d[0]?d[0].replace(" ",""):"",e[0]=(d[0]?d[0]:Ae.getMonth()+parseInt(1))+" "+(o||Ae.getDate())+" "+(10==t&&u[1]?20+p:Ae.getFullYear())}}var m=n.split(" ");l=""==c?i.indexOf(m[0]):i.indexOf(n);if(i[l-1]&&i[l-1].match(/(from|after|before)/)&&i[l-2]&&i[l-2].match(/(day)s?/)&&i[l-3]&&i[l-3].match(/[0-9]{1,2}/)&&!He.isrem){if(Date.parse(e[0]))b=new Date(Date.parse(e[0]));else{var _=3==(y=e[0].split(" ")).length&&8==t?y[1]+" "+y[0]+" "+(y[2].match(/[0-9]{2}/)?20+y[2]:""):"";if(10==t||12==t){var z=y[0].split(/[0-9]{1,2}/),f=""!=z[0]?z[0]:z[1],v=y[0].match(/[0-9]{1,2}/);_=2==y.length?f+" "+v[0]+" "+(y[1].match(/[0-9]{4}/)?y[1]:20+y[1]):1==y.length?f+" "+v[0]+" "+Ae.getFullYear():""}b=new Date(Date.parse(_))}if("Invalid Date"!=b&&(i[l-4]&&"for"!=i[l-4]||!i[l-4])){if(i[l-4]&&"every"==i[l-4]?(Se.daily=1,he=i[l-3]):i[l-1].match(/(from|after)/)?b.setDate(b.getDate()+parseInt(i[l-3])):i[l-1].match(/(before)/)&&b.setDate(b.getDate()-parseInt(i[l-3])),l=3==m.length?i.indexOf(m[2]):i.indexOf(m[1]),i[l+1]&&i[l+1].match(/(for)/)&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/))(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l+2])),Pe=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear());return i[l+1]&&i[l+1].match("for")&&i[l+2]&&i[l+2].match("every")&&i[l+3].match(/[0-9]{1,2}/)&&i[l+4]&&i[l+4].match(/(day)s?/)&&(Se.daily=1,he=i[l+3]),Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear())}if("Invalid Date"!=b&&i[l-4]&&"for"==i[l-4])return(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l-3])),Pe=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear()),b;if("Invalid Date"==b)return Me}else{if(i[l-1]&&i[l-1].match("every")||a.match(/(every\s?year)/)){var h=e[0].match(/[0-9]{1,2}/),g=e[0];g=g.replace(/[^A-Za-z]/g,""),Se.yearly=1,ne="",ue=h[0],re=g,oe=1}if(a.match(/(every|all)\s?(weekday)s?/))Se.daily=1,ge=1;else if(a.match(/(every|all)\s?(weekend)s?/))Se.weekly=1,fe="saturday,sunday",Re=1;else if(!$e){l=(N=(N=Ue.replace(a," @ "))?N.split(Ne):"").indexOf("@");N[l-1]&&N[l-1].match(/\b(weekday)s?\b/)&&N[l-2]&&N[l-2].match(/\b(every|all)\b/)&&(Se.daily=1,ge=1),N[l-1]&&N[l-1].match(/\b(weekend)s?\b/)&&N[l-2]&&N[l-2].match(/\b(every|all)\b/)&&(Se.weekly=1,fe="saturday,sunday"),"days"==N[l-1]&&N[l-2]&&N[l-2].match(/[0-9]{1,2}/)&&"every"==N[l-3]&&(Se.daily=1,he=N[l-2],ge=1)}if(l=""==c?3==m.length?i.indexOf(m[2]):i.indexOf(m[1]):i.indexOf(n),i[l+1]&&i[l+1].match("for")&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(((day)s?)|((year)s?))/))if(i[l+3].match(/(day)s?/)){var C=new Date(Date.parse(e[0]));Pe=Date.parse(C.getMonth()+parseInt(1)+"/"+(parseInt(C.getDate())+parseInt(i[l+2]))+"/"+C.getFullYear())}else!i[l+3].match(/(year)s?/)&&1!=Se.yearly||(de=Date.parse("12/31/"+(Ae.getFullYear()+parseInt(i[l+2]))));return i[l+1]&&i[l+1].match("for")&&i[l+2]&&i[l+2].match("every")&&i[l+3]&&i[l+3].match(/[0-9]{1,2}/)&&i[l+4]&&i[l+4].match(/(day)s?/)&&(Se.daily=1,he=i[l+3],$e&&(ge=1)),Date.parse(e[0])?Date.parse(e[0]):(_=""==(_=3==(y=e[0].split(" ")).length&&8==t?y[1]+" "+y[0]+" "+(y[2].match(/[0-9]{2}/)?20+y[2]:""):"")?Me:_,Date.parse(_));var y}}if(14==t||11==t){i=a.split(Ne);var L=(c=e[0].replace(/(\s|,)/g,"/")).split("/");l=i.indexOf(L[0]);if(!(i[l-1]&&i[l-1].match(/(from|after|before)/)&&i[l-2]&&i[l-2].match(/(day)s?/)&&i[l-3]&&i[l-3].match(/[0-9]{1,2}/))||He.isrem)return l=3==L.length?i.indexOf(L[2]):i.indexOf(L[1]),i[l+1]&&i[l+1].match("for")&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/)&&(Pe=3==L.length?Date.parse((14==t?L[0]:L[1])+"/"+(parseInt(14==t?L[1]:L[0])+parseInt(i[l+2]))+"/"+(L[2].match(/((19|20)\d\d)/)?L[2]:20+L[2])):Date.parse((14==t?L[0]:L[1])+"/"+(parseInt(14==t?L[1]:L[0])+parseInt(i[l+2]))+"/"+Ae.getFullYear())),3==L.length?Date.parse((14==t?L[0]:L[1])+(14==t?L[1].replace(/[^(\d+)]/g,""):L[0].replace(/[^(\d+)]/g,""))+"/"+(L[2].match(/((19|20)\d\d)/)?L[2]:20+L[2])):Date.parse((14==t?L[0]:L[1])+(14==t?L[1].replace(/[^(\d+)]/g,""):L[0].replace(/[^(\d+)]/g,""))+"/"+Ae.getFullYear());if(3==L.length)var b=new Date(Date.parse((14==t?L[0]:L[1])+(14==t?L[1].replace(/[^(\d+)]/g,""):L[0].replace(/[^(\d+)]/g,""))+"/"+(L[2].match(/((19|20)\d\d)/)?L[2]:20+L[2])));else b=new Date(Date.parse((14==t?L[0]:L[1])+(14==t?L[1].replace(/[^(\d+)]/g,""):L[0].replace(/[^(\d+)]/g,""))+"/"+Ae.getFullYear()));if("Invalid Date"!=b&&i[l-4]&&"for"!=i[l-4]){if(i[l-1].match(/(from|after)/)?b.setDate(b.getDate()+parseInt(i[l-3])):i[l-1].match(/(before)/)&&b.setDate(b.getDate()-parseInt(i[l-3])),l=3==L.length?i.indexOf(L[2]):i.indexOf(L[1]),i[l+1]&&i[l+1].match(/(for)/)&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/))(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l+2])),Pe=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear());return Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear())}if("Invalid Date"!=b&&i[l-4]&&"for"==i[l-4])return(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l-3])),Pe=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear()),b;if("Invalid Date"==b)return Me}if(16==t||17==t){var E=e[0];e[0]=16!=t&&Te.indexOf(e[0].toLowerCase())<0?Te[Ze.indexOf(e[0].toLowerCase())]:e[0];i=a.split(Ne);var T=a.match(xe),D=17==t?-1<i.indexOf(e[0])?Le[ye.indexOf(e[0])]:T?Le[ye.indexOf(T[0])]:"":"";if((-1<i.indexOf("from")||-1<i.indexOf("after")||-1<i.indexOf("before"))&&(-1<i.indexOf("days")||-1<i.indexOf("day"))&&-1<i.indexOf(E)&&i[i.indexOf(E)-1].match(/(from|after|before)/)&&!He.isrem){l=i.indexOf(E)-1;if(i[l-1]&&i[l-1].match(/(day)s?/)&&i[l-2]&&i[l-2].match(/[0-9]{1,2}/)){var Z=(q=a.split(Ne)).indexOf(E),A=q[Z-1]&&q[Z-1].match(/(next)/)?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":q[Z-1]&&q[Z-1].match(/(this)/)?-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"":D||(-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"");if("Invalid Date"!=(b=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear())))&&(i[l-3]&&"for"!=i[l-3]||!i[l-3])){if(i[l-3]&&"every"!=i[l-3]||!i[l-3]?i[l]&&i[l].match(/(from|after)/)?b.setDate(b.getDate()+parseInt(i[l-2])):i[l]&&i[l].match(/(before)/)&&b.setDate(b.getDate()-parseInt(i[l-2])):i[l-3]&&(Se.daily=1,he=i[l-2]),l=i.indexOf(E),i[l+1]&&i[l+1].match(/(for)/)&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/))(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l+2])),Pe=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear());var M,S=Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear());if(null!=$e){if(S<$e||$e<S){S=new Date(S);var k=new Date($e);A=q[Z-1]&&q[Z-1].match(/(next)/)?dt(k,S.getDay()):(q[Z-1]&&q[Z-1].match(/(this)/),ot(k,S.getDay())),M=S=Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear())}}else M=S;return M}if("Invalid Date"!=b&&i[l-3]&&"for"==i[l-3])return(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l-2])),Pe=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear()),b;if("Invalid Date"==b)return Me}else{if(l=i.indexOf(E),"Invalid Date"!=(A=i[l-1].match(/(next)/)?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":i[l-1].match(/(this)/)?-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"":D||(-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:""))&&i[l+1]&&i[l+1].match("for")&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/))(F=new Date).setDate(A.getDate()),F.setMonth(A.getMonth()),F.setFullYear(A.getFullYear()),F.setDate(F.getDate()+parseInt(i[l+2])),Pe=Pe||Date.parse(F.getMonth()+parseInt(1)+"/"+F.getDate()+"/"+F.getFullYear());if("Invalid Date"!=A)return Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear());if("Invalid Date"==A)return Me}}else{if(!a.match(Ie)){Z=(q=a.split(Ne)).indexOf(E);var w=0;if(i[Z+1]&&i[Z+1].match("of")&&i[Z+2]&&i[Z+2].match(/(next|last|every)/)){if("month"!=i[Z+3]&&ke.indexOf(i[Z+3])<0)A="next"==i[Z+2]?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":"last"==i[Z+2]?-1<Te.indexOf(e[0])?Ee[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ee[Ze.indexOf(e[0])]:"":-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"";else if(i[Z+2].match(/(next|last)/)&&ke.indexOf(i[Z+3])<0){var O=we[Ae.getMonth()+parseInt(1)];A=mt("first",e[0],O,"");if($e&&1==Se.weekly){var I=new Date($e);I=mt("first",Te[I.getDay()],O,""),$e=Date.parse(I.getMonth()+parseInt(1)+"/"+I.getDate()+"/"+I.getFullYear());e=new Date(I.getFullYear(),I.getMonth()+1,0,0,0,0);ze=ze||Date.parse(e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear())}if(a.match("every"))if(Se.weekly=1,$e||1!=Se.weekly||"Invalid Date"==A){if("Invalid Date"==A)return Me}else{e=new Date(A.getFullYear(),A.getMonth()+1,0,0,0,0);ze=ze||Date.parse(e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear())}}else if(i[Z+2]&&i[Z+2].match(/(next|last)/)&&-1<ke.indexOf(i[Z+3])){A=mt("first",e[0],ke[ke.indexOf(i[Z+3])],Ae.getFullYear()+1);if($e&&1==Se.weekly){I=new Date($e);I=mt("first",Te[I.getDay()],ke[ke.indexOf(i[Z+3])],Ae.getFullYear()+1),$e=Date.parse(I.getMonth()+parseInt(1)+"/"+I.getDate()+"/"+I.getFullYear());e=new Date(I.getFullYear(),I.getMonth()+1,0,0,0,0);ze=ze||Date.parse(e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear())}if(a.match("every"))if(Se.weekly=1,$e||1!=Se.weekly||"Invalid Date"==A){if("Invalid Date"==A)return Me}else{e=new Date(A.getFullYear(),A.getMonth()+1,0,0,0,0);ze=ze||Date.parse(e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear())}}if("every"==i[Z+2])if(i[Z+3].match(/(month|week)/)){Se.weekly=1;A=be[Te.indexOf(e[0])]}else if(i[Z+3]&&i[Z+3].match(/[0-9]{1,2}/)&&i[Z+4]&&i[Z+4].match(/(week)/)){Se.weekly=1;A=be[Te.indexOf(e[0])];ve=i[Z+3]}w="next"==i[Z+2]?"1":"2"}else if(i[Z+1]&&i[Z+1].match("of")&&i[Z+2]&&-1<ke.indexOf(i[Z+2]))if($e&&1==Se.weekly){A=mt("first",e[0],i[Z+2],""),e=new Date($e);$e=mt("first",Ze[e.getDay()],i[Z+2],""),t=""!=(t="Invalid Date"!=A?new Date(A.getFullYear(),A.getMonth()+1,0,0,0,0):"")?Date.parse(t.getMonth()+parseInt(1)+"/"+t.getDate()+"/"+t.getFullYear()):"",ze=ze||t}else{if(a.match("every"))t=""!=(t="Invalid Date"!=(A=mt("first",e[0],i[Z+2],""))?new Date(A.getFullYear(),A.getMonth()+1,0,0,0,0):"")?Date.parse(t.getMonth()+parseInt(1)+"/"+t.getDate()+"/"+t.getFullYear()):"",ze=ze||t}else if(i[Z+1]&&i[Z+1].match("for")&&i[Z+2]&&i[Z+2].match(/[0-9]{1,2}/)&&i[Z+3]&&i[Z+3].match(/((day)s?|(month)s?|(week)s?)/))if(i[Z+3].match(/(day)s?/)){A=q[Z-1]&&q[Z-1].match(/(next)/)?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":q[Z-1]&&q[Z-1].match(/(this)/)?-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"":17==t?T?Le[ye.indexOf(T[0])]:"":-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"";Pe=Date.parse(A.getMonth()+parseInt(1)+"/"+(A.getDate()+parseInt(i[Z+2]))+"/"+A.getFullYear())}else if(a.match(/(every|all)/)&&i[Z+3].match(/(month)s?/)||1==Se.weekly){Se.weekly=1,(W=new Date).setMonth(W.getMonth()+(parseInt(i[Z+2])+1)),W.setDate(0);A=q[Z-1]&&q[Z-1].match(/(next)/)?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":q[Z-1]&&q[Z-1].match(/(this)/)?-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"":17==t?T?Le[ye.indexOf(T[0])]:"":-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"";ze=W}else if(a.match(/(every|all)/)&&i[Z+3].match(/(week)s?/)||1==Se.weekly){var x=0==(X=(W=new Date).getDay())?7*(i[Z+2]-1):7*(i[Z+2]-1)+(7-X);W.setDate(W.getDate()+parseInt(x));A=q[Z-1].match(/(next)/)?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":q[Z-1].match(/(this)/)?-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"":17==t?T?Le[ye.indexOf(T[0])]:"":-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"";Se.weekly=1,ze=W}else A=q[Z-1].match(/(next)/)?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":q[Z-1].match(/(this)/)?-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"":17==t?T?Le[ye.indexOf(T[0])]:"":-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"";else{if(a.match("every"))if(a.match(/(every|all)\s?(weekday)s?/))Se.daily=1,ge=1;else if(a.match(/(every|all)\s?(weekend)s?/))Se.weekly=1,fe="saturday,sunday",Re=1;else{if(Se.weekly=1,fe=$e?"":e[0],a.match(/(for)\s?[0-9]{1,2}\s?(month)s?/)){L=a.match(/(for)\s?[0-9]{1,2}\s?(month)s?/)[0].match(/[0-9]{1,2}/);(J=new Date).setMonth(J.getMonth()+parseInt(L[0])),J.setDate(0),ze=J}if(a.match(/(for)\s?[0-9]{1,2}\s?(week)s?/)){L=a.match(/(for)\s?[0-9]{1,2}\s?(week)s?/)[0].match(/[0-9]{1,2}/),x=0==(X=(W=new Date).getDay())?7*(i[Z+2]-1):7*(i[Z+2]-1)+(7-X);W.setDate(W.getDate()+parseInt(x)),ze=J}if(a.match(/(every)\s?[0-9]{1,2}\s?(week)s?/)){L=a.match(/(every)\s?[0-9]{1,2}\s?(week)s?/)[0].match(/[0-9]{1,2}/);Se.weekly=1,ve=L[0]}}else if(!$e){var N;l=(N=(N=Ue.replace(a," @ ")).split(Ne)).indexOf("@");N[l-1]&&N[l-1].match(/\b(weekday)s?\b/)&&N[l-2].match(/\b(every|all)\b/)&&(Se.daily=1,ge=1),N[l-1]&&N[l-1].match(/\b(weekend)s?\b/)&&N[l-2]&&N[l-2].match(/\b(every|all)\b/)&&(Se.weekly=1,fe="saturday,sunday"),N[l-1]&&N[l-1].match(/(day)s?/)&&N[l-2]&&N[l-2].match(/[0-9]{1,2}/)&&"every"==N[l-3]&&(Se.daily=1,he=N[l-2],ge=1)}A=-1<Z&&q[Z-1].match(/(next)/)?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":-1<Z&&q[Z-1].match(/(this)/)?-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"":D||(-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"")}var R;S="Invalid Date"!=A&&null!=A?Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()):"";if(null!=$e&&""!=S)if(S<$e){S=new Date(S);k=new Date($e);R=A=-1<Z&&q[Z-1].match(/(next)/)?dt(k,S.getDay()):-1<Z&&q[Z-1].match(/(this)/)?ot(k,S.getDay()):1==w?dt(k,S.getDay()):D||ot(k,S.getDay())}else R=S;else R=""!=S?S:Me;return R}var $,P,H=a.match(Ie),l=i.indexOf(E);if(i[l-2]&&i[l-2].match(/(from|after|before)/)&&i[l-3]&&i[l-3].match(/(day)s?/)&&i[l-4]&&i[l-4].match(/[0-9]{1,2}/)&&!He.isrem&&(i[l-5]&&i[l-5].match(/(for)/)?P=i[l-4]:i[l-5]&&!i[l-5].match(/(every)/)?$=i[l-4]:(Se.daily=1,he=i[l-4])),i[l+1]&&i[l+1].match("of")&&i[l+2]&&i[l+2].match(/(jan|feb|mar|apr|may|jun|july|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)/)){var U=i[l+3]&&i[l+3].match(/[0-9]{4}/)?i[l+3]:"";a.match(/every/)&&(Se.yearly=1,se=e[0],re=i[l+2],ne=H[1]);var j=mt(H[1],e[0],i[l+2],U);if($&&(i[l-2].match(/(from|after)/)&&j.setDate(j.getDate()+parseInt($)),i[l-2].match(/(before)/)&&j.setDate(j.getDate()-parseInt($))),P)(Y=new Date).setDate(j.getDate()),Y.setMonth(j.getMonth()),Y.setFullYear(j.getFullYear()),Y.setDate(Y.getDate()+parseInt(P)),Pe=Date.parse(Y.getMonth()+parseInt(1)+"/"+Y.getDate()+"/"+Y.getFullYear());var S=Date.parse(j.getMonth()+parseInt(1)+"/"+j.getDate()+"/"+j.getFullYear());if(null==$e||!S)return S||Me;if($e<S||S<$e)return S=new Date(S),(k=new Date($e)).getMonth()<S.getMonth()&&""==U?(S=mt(H[1],e[0],i[l+2],k.getFullYear()),$&&(i[l-2].match(/(from|after)/)?S=Date.parse(S.getMonth()+parseInt(1)+"/"+(S.getDate()+parseInt($))+"/"+S.getFullYear()):i[l-2].match(/(from|after)/)&&(S=Date.parse(S.getMonth()+parseInt(1)+"/"+(S.getDate()-parseInt($))+"/"+S.getFullYear()))),S):(""==U&&(S=mt(H[1],e[0],i[l+2],k.getFullYear()+1),$&&(i[l-2].match(/(from|after)/)?S=Date.parse(S.getMonth()+parseInt(1)+"/"+(S.getDate()+parseInt($))+"/"+S.getFullYear()):i[l-2].match(/(before)/)&&(S=Date.parse(S.getMonth()+parseInt(1)+"/"+(S.getDate()-parseInt($))+"/"+S.getFullYear())))),S||Date.parse(Ae.getMonth()+parseInt(1)+"/"+Ae.getDate()+"/"+Ae.getFullYear()))}else{if(i[l+1]&&i[l+1].match(/(of|for)/)&&i[l+2]&&i[l+2].match(/(next|this|every)/)&&(i[l+3]&&!i[l+3].match("month")&&i[l+3].match(/[0-9]{1,2}/)&&i[l+4]&&i[l+4].match("month")||i[l+3]&&i[l+3].match("month"))){"every"==i[l+2]&&(Se.monthly=1,me=e[0],pe=H[1],i[l+3].match(/[0-9]{1,2}/)&&i[l+4].match("month")&&(_e=i[l+3]));c=i[l+2];i[l+2]="next"==i[l+2]?Oe[Ae.getMonth()+1]:Oe[Ae.getMonth()];j=mt(H[1],e[0],i[l+2],"");if($&&(i[l-2].match(/(from|after)/)?j.setDate(j.getDate()+parseInt($)):i[l-2].match(/(before)/)&&j.setDate(j.getDate()-parseInt($))),P)(Y=new Date).setDate(j.getDate()),Y.setMonth(j.getMonth()),Y.setFullYear(j.getFullYear()),Y.setDate(Y.getDate()+parseInt(P)),Pe=Date.parse(Y.getMonth()+parseInt(1)+"/"+Y.getDate()+"/"+Y.getFullYear());S=Date.parse(j.getMonth()+parseInt(1)+"/"+j.getDate()+"/"+j.getFullYear());if(null!=$e&&S){if(S<$e){S=new Date(S);var k=new Date($e),B=c.match("next")&&Oe.indexOf(i[l+2])!=k.getMonth()?Oe[k.getMonth()+1==12?"0":k.getMonth()+1]:Oe[k.getMonth()];return j=mt(H[1],e[0],B,k.getFullYear()),Date.parse(j.getMonth()+parseInt(1)+"/"+j.getDate()+"/"+j.getFullYear())}return S}return S||Me}if(i[l+1]&&i[l+1].match(/(of|for)/)&&i[l+2]&&i[l+2].match(/(next|this|every)/)&&-1<ke.indexOf(i[l+3])){U=i[l+3]&&i[l+3].match(/[0-9]{4}/)?i[l+3]:"next"==i[l+2]?parseInt(Ae.getFullYear())+parseInt(1):"";a.match(/every/)&&(Se.yearly=1,se=e[0],re=i[l+3],ne=H[1]);j=mt(H[1],e[0],i[l+3],U),S=Date.parse(j.getMonth()+parseInt(1)+"/"+j.getDate()+"/"+j.getFullYear());if(null==$e||!S)return S||Me;if($e<S||S<$e)return S=new Date(S),(k=new Date($e)).getMonth()<S.getMonth()&&""==U?"Invalid Date"!=(S=mt(H[1],e[0],i[l+2],k.getFullYear()))?S:Me:(""==U&&(S=mt(H[1],e[0],i[l+2],k.getFullYear()+1)),"Invalid Date"!=S?S:Me)}else{if(i[l-1]&&i[l-1].match("every")||i[l-2]&&i[l-2].match("every"))return Se.monthly=1,me=e[0],pe=H[1],"Invalid Date"!=(S=mt(H[1],e[0],we[Ae.getMonth()],Ae.getFullYear()))?S:Me;if(i[l-3]&&i[l-3].match(/\b(weekday)s?\b/)&&i[l-4]&&i[l-4].match(/\b(every|all)\b/))return Se.daily=1,"Invalid Date"!=(S=mt(H[ge=1],e[0],we[Ae.getMonth()],Ae.getFullYear()))?S:Me;if(!a.match(/\b(every|all)\b/)){var F,Y;if((j=H[0].match("next")||H[0].match("this")?H[0].match(/(next)/)?-1<Te.indexOf(e[0])?Ce[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ce[Ze.indexOf(e[0])]:"":-1<Te.indexOf(e[0])?be[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?be[Ze.indexOf(e[0])]:"":H[0].match("last")&&!$e?-1<Te.indexOf(e[0])?Ee[Te.indexOf(e[0])]:-1<Ze.indexOf(e[0])?Ee[Ze.indexOf(e[0])]:"":mt(H[1],e[0],we[Ae.getMonth()],""))&&i[l+1]&&i[l+1].match("for")&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/))(F=new Date).setDate(j.getDate()),F.setMonth(j.getMonth()),F.setFullYear(j.getFullYear()),F.setDate(F.getDate()+parseInt(i[l+2])),Pe=Pe||Date.parse(F.getMonth()+parseInt(1)+"/"+F.getDate()+"/"+F.getFullYear());if($&&j.setDate(j.getDate()+parseInt($)),P)(Y=new Date).setDate(j.getDate()),Y.setMonth(j.getMonth()),Y.setFullYear(j.getFullYear()),Y.setDate(Y.getDate()+parseInt(P)),Y.setDate(Y.setDate()+parseInt(P)),Pe=Date.parse(Y.getMonth()+parseInt(1)+"/"+Y.getDate()+"/"+Y.getFullYear());return Date.parse(j.getMonth()+parseInt(1)+"/"+j.getDate()+"/"+j.getFullYear())}if(a.match(/(every|all)\s?(weekday)s?/))return Se.daily=1,"Invalid Date"!=(S=mt(H[ge=1],e[0],we[Ae.getMonth()],Ae.getFullYear()))?S:Me;if(a.match(/(every|all)\s?(weekend)s?/))return Se.weekly=1,fe="saturday,sunday","Invalid Date"!=(S=mt(H[Re=1],e[0],we[Ae.getMonth()],Ae.getFullYear()))?S:Me;if(a.match(/every\s([0-9]{1,2})?\s?(month)s?/)){var V=a.match(/every\s([0-9]{1,2})?\s?(month)s?/),L=V[0].match(/[0-9]{1,2}/)?V[0].match(/[0-9]{1,2}/):"";return Se.monthly=1,pe=i[l-1],me=e[0],_e=L[0]?L[0]:"","Invalid Date"!=(S=mt(H[1],e[0],we[Ae.getMonth()],Ae.getFullYear()))?S:Me}}}}}if(15==t){i=a.split(Ne),L=(c=e[0].replace(/(\s|,)/g,"/")).split("/"),l=i.indexOf(L[0]);if(!(i[l-1].match(/(from|after)/)&&i[l-2].match(/(day)s?/)&&i[l-3]&&i[l-3].match(/[0-9]{1,2}/)))return l=4==L.length?i.indexOf(L[3]):i.indexOf(L[2]),i[l+1]&&i[l+1].match("for")&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/)&&(je=4==L.length?Date.parse(L[2]+(parseInt(L[0].replace(/[^(\d+)]/g,""))+parseInt(i[l+2]))+"/"+L[3]):Date.parse(L[2]+"/"+(parseInt(L[0].replace(/[^(\d+)]/g,""))+parseInt(i[l+2]))+"/"+Ae.getFullYear())),4==L.length?Date.parse(L[2]+L[0].replace(/[^(\d+)]/g,"")+"/"+L[3]):Date.parse(L[2]+L[0].replace(/[^(\d+)]/g,"")+"/"+Ae.getFullYear());if(4==L.length)b=new Date(Date.parse(L[2]+L[0].replace(/[^(\d+)]/g,"")+"/"+L[3]));else b=new Date(Date.parse(L[2]+L[0].replace(/[^(\d+)]/g,"")+"/"+Ae.getFullYear()));if("Invalid Date"!=b&&i[l-4]&&"for"!=i[l-4]){var G;if(b.setDate(b.getDate()+parseInt(i[l-3])),l=3==L.length?i.indexOf(L[2]):i.indexOf(L[1]),i[l+1]&&i[l+1].match(/(for)/)&&i[l+2]&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3]&&i[l+3].match(/(day)s?/))(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l+2])),je=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear());return Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear())}if("Invalid Date"!=b&&i[l-4]&&"for"==i[l-4])return(G=new Date(Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()))).setDate(G.getDate()+parseInt(i[l-3])),je=Date.parse(G.getMonth()+parseInt(1)+"/"+G.getDate()+"/"+G.getFullYear()),b;if("Invalid Date"==b)return Me}if(18==t){var q;l=(q=a.split(Ne)).indexOf(e[0]);if(-1<De.indexOf(e[0])&&"next"!=q[l-1]){A=be[De.indexOf(e[0])];if(q[l+(Se.weekly=1)]&&q[l+1].match("for")&&q[l+2]&&q[l+2].match(/[0-9]{1,2}/)&&q[l+3].match(/((month)s?)/))(W=new Date).setMonth(W.getMonth()+(parseInt(q[l+2])+1)),W.setDate(0),ze=W;else if(q[l+1]&&q[l+1].match("for")&&q[l+2]&&q[l+2].match(/[0-9]{1,2}/)&&q[l+3].match(/((week)s?)/)){x=0==(X=(W=new Date).getDay())?7*(q[l+2]-1):7*(q[l+2]-1)+(7-X);W.setDate(W.getDate()+parseInt(x)),ze=W}return""!=(S="Invalid Date"!=A?Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()):"")?S:Me}}if(19==t){l=(i=a.split(Ne)).indexOf(e[0]);if($e){A=(i[l-1]&&i[l-1].match("this")?ot:i[l-1]&&i[l-1].match("next")?dt:ot)(new Date,0);return S=Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear())}A=(i[l-1]&&i[l-1].match("this")?ot:i[l-1]&&i[l-1].match("next")?dt:ot)(new Date,6),S=Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear());if(i[l+1]&&i[l+1].match("for")&&i[l+2].match(/[0-9]{1,2}/)&&i[l+3].match(/((month)s?|(week)s?)/))if(i[l+3].match(/(month)s?/)){var J;L=a.match(/(for)\s?[0-9]{1,2}\s?(month)s?/)[0].match(/[0-9]{1,2}/);(J=new Date).setMonth(J.getMonth()+parseInt(L[0])),J.setDate(0),ze=J}else{var W,X;L=a.match(/(for)\s?[0-9]{1,2}\s?(week)s?/)[0].match(/[0-9]{1,2}/),x=0==(X=(W=new Date).getDay())?7*(i[l+2]-1):7*(i[l+2]-1)+(7-X);W.setDate(W.getDate()+parseInt(x)),ze=W}if(i[l+1]&&i[l+1].match(/(from|of|in)/)&&-1<ke.indexOf(i[l+2])){var Q=-1<we.indexOf(i[l+2])?we.indexOf(i[l+2]):-1<Oe.indexOf(i[l+2])?Oe.indexOf(i[l+2]):"";if(S=Date.parse(Q+parseInt(1)+"/01/"+Ae.getFullYear()),Se.weekly=1,fe="saturday,sunday",i[l+1].match(/(of|in)/))(K=new Date(S)).setMonth(K.getMonth()+1),K.setDate(0),ze=Date.parse(K.getMonth()+parseInt(1)+"/"+K.getDate()+"/"+K.getFullYear())}if(i[l+1]&&i[l+1].match(/(from|of|in)/)&&i[l+2].match(/(this|next)/)&&i[l+3].match("month")){var K;Q=i[l+2].match("this")?Ae.getMonth():Ae.getMonth()+1;if(S=Date.parse(Q+parseInt(1)+"/01/"+Ae.getFullYear()),i[l+1].match(/(of|in)/))(K=new Date(S)).setMonth(K.getMonth()+1),K.setDate(0),ze=Date.parse(K.getMonth()+parseInt(1)+"/"+K.getDate()+"/"+K.getFullYear())}return S}if(20==t||21==t){var ee;a.match(/[0-9]{4}/)&&(ee=a.match(/[0-9]{4}/));var te=e[0].split("-"),ae=20==t?te[0].split(/[0-9]{1,2}/):21==t?te[1].split(/[0-9]{1,2}/):"";return Pe=Pe||(20==t?Date.parse(ae[0]+" "+te[1]+" "+(ee&&ee[0]?ee[0]:Ae.getFullYear())):21==t?Date.parse(te[1]+" "+(ee&&ee[0]?ee[0]:Ae.getFullYear())):""),20==t?Date.parse(te[0]+" "+(ee&&ee[0]?ee[0]:Ae.getFullYear())):21==t?Date.parse(ae[1]+" "+te[0]+" "+(ee&&ee[0]?ee[0]:Ae.getFullYear())):""}if(22==t){c=(ie=e[0].split("-"))[0].replace(/(\s)/g,"/");var le=ie[1].replace(/(\s)/g,"/"),ce=(L=c.split("/"),le.split("/"));return Pe=Pe||Date.parse(ce[0].replace(/[^(\d+)]/g,"")+" "+ce[1]+" "+Ae.getFullYear()),Date.parse(L[0].replace(/[^(\d+)]/g,"")+" "+L[1]+" "+Ae.getFullYear())}if(23==t||24==t){var ie=e[0].split("-");ce=(le=23==t?ie[1].replace(/(\s)/g,"/"):ie[0].replace(/(\s)/g,"/")).split("/");return Pe=Pe||Date.parse((23==t?ce[0].replace(/[^(\d+)]/g,""):ie[1].replace(/[^(\d+)]/g,""))+" "+(23==t?ce[1]:ce[0])+" "+Ae.getFullYear()),Date.parse((23==t?ie[0].replace(/[^(\d+)]/g,""):ce[1].replace(/[^(\d+)]/g,""))+" "+(23==t?ce[1]:ce[0])+" "+Ae.getFullYear())}}catch(e){}}function rt(e,t){try{if(0==t){if(e[0].match(/(:|\.)/)){if((o=e[0].match(/(:)/)?e[0].split(":"):e[0].match(/(.)/)?e[0].split("."):"")[0]=o[1].match("pm")?o[0]<12?12+parseInt(o[0]):o[0]:12==o[0]||24==o[0]?0:o[0],0!=z)o[1]=o[1].match("pm")?o[1].replace("pm",""):o[1].match("am")?o[1].replace("am",""):o[1].match("hrs")?o[1].replace("hrs",""):"";else{if(k&&1==O){var a=parseInt(k/36e5),l=parseInt(k/6e4)%60,c=o[1].match("pm")?a<12?parseInt(a)+parseInt(12):a:o[1].match("am")?a:o[1].match("hours")&&a<12?a+parseInt(12):a;k=36e5*c+parseInt(6e4*l)}O=o[1].match(/(am|pm|hrs)/)?0:1,o[1]=o[1].match("pm")?o[1].replace("pm",""):o[1].match("am")?o[1].replace("am",""):o[1].match("hrs")?o[1].replace("hrs",""):o[1]}var i=0!=o[0]?36e5*o[0]:1;return i+=0!=o[1]?6e4*o[1]:1e3}if(0!=z){if(!e[0].match(/(hrs)/)){var n=e[0].match("pm")?"1":e[0].match("am")?"0":null;e[0]=e[0].match("pm")?e[0].replace("pm",""):e[0].match("am")?e[0].replace("am",""):""}}else{if(k&&1==O){a=parseInt(k/36e5),l=parseInt(k/6e4)%60,c=e[0].match("pm")?a<12?parseInt(a)+parseInt(12):a:e[0].match("am")?a:e[0].match("hours")&&a<12?a+parseInt(12):a;k=36e5*c+parseInt(l?6e4*l:0)}if(O=e[0].match(/(am|pm|hrs)/)?0:1,!e[0].match(/(hrs)/)){n=e[0].match("pm")?"1":(e[0].match("am"),"0");e[0]=e[0].match("pm")?e[0].replace("pm",""):e[0].match("am")?e[0].replace("am",""):e[0]}}if(e[0].match(/(hrs)/))return e[0]=e[0].match(/(hrs)/)?e[0].replace("hrs","").trim():e[0],2==e[0].length&&e[0]<24||4==e[0].length&&e[0]<2400?(i=0==(i=2==e[0].length?36e5*e[0]:4==e[0].length?36e5*parseInt(e[0]/100):"")?1e3:i,i=2==e[0].length?i:4==e[0].length?i+e[0]%100*6e4:""):"";if(!e[0].match(/(hrs)/))return e[0]=1==n?e[0]<12?12+parseInt(e[0]):e[0]:0==n?12==e[0]?-1:e[0]:"",i=""!=e[0]?-1!=e[0]?36e5*e[0]:1e3:""}if(2==t||3==t)if(M[e[0]])return i=M[e[0]];if(4==t){var r=e[0].split("-"),s=r[1].match(/(am|pm)/);if(r[0].match(/(:|\.)/)){(o=r[0].match(/(:)/)?r[0].split(":"):r[0].match(/(\.)/)?r[0].split("."):"")[0]=o[1].match("pm")?o[0]<12?12+parseInt(o[0]):o[0]:o[1].match("am")?12==o[0]?-1:o[0]:s[0].match("pm")?o[0]<12?12+parseInt(o[0]):o[0]:12==o[0]?-1:o[0],o[1]=o[1].match("pm")?o[1].replace("pm",""):o[1].match("am")?o[1].replace("am",""):o[1];i=o[0]?-1!=o[0]?36e5*o[0]:1e3:"";if(i+=6e4*o[1],r[1].match(/(:|\.)/)){(o=r[1].match(/(:)/)?r[1].split(":"):r[1].match(/(\.)/)?r[1].split("."):"")[0]=o[1].match("pm")&&o[0]<12?12+parseInt(o[0]):o[0],o[1]=o[1].match("pm")?o[1].replace("pm",""):o[1].match("am")?o[1].replace("am",""):"";var d=36e5*o[0];d+=6e4*o[1],w=w||d}else{n=r[1].match("pm")?"1":r[1].match("am")?"0":"";r[1]=r[1].match("pm")?r[1].replace("pm",""):r[1].match("am")?r[1].replace("am",""):r[1],r[1]=1==n?r[1]<12?12+parseInt(r[1]):r[1]:0==n?r[1]:"";d=r[1]?36e5*r[1]:"";w=w||d}return i}n=r[0].match("pm")?"1":r[0].match("am")?"0":r[1].match("pm")?"1":r[1].match("am")?"0":"";r[0]=r[0].match("pm")?r[0].replace("pm",""):r[0].match("am")?r[0].replace("am",""):r[0],r[0]=1==n?r[0]<12?12+parseInt(r[0]):r[0]:0==n?12==r[0]?-1:r[0]:"";i=r[0]?-1!=r[0]?36e5*r[0]:1e3:"";if(r[1].match(/(:|\.)/)){(o=r[1].match(/(:)/)?r[1].split(":"):r[1].match(/(.)/)?r[0].split("."):"")[0]=o[1].match("pm")&&o[0]<12?12+parseInt(o[0]):o[0],o[1]=o[1].match("pm")?o[1].replace("pm",""):o[1].match("am")?o[1].replace("am",""):"";d=36e5*o[0];d+=6e4*o[1],w=w||d}else{n=r[1].match("pm")?"1":r[1].match("am")?"0":"";r[1]=r[1].match("pm")?r[1].replace("pm",""):r[1].match("am")?r[1].replace("am",""):r[1],r[1]=1==n?r[1]<12?12+parseInt(r[1]):r[1]:0==n?r[1]:"";d=r[1]?36e5*r[1]:"";w=w||d}return i}if(1==t&&e[0].match(/(:|\.)/)){i=36e5*(o=e[0].match(/(:)/)?e[0].split(":"):e[0].match(/(.)/)?e[0].split("."):"")[0];return i+=6e4*o[1]}if(5==t)return 36e5*Ae.getHours()+parseInt(6e4*Ae.getMinutes());if(6==t&&k){var o=e[0],u=e[0].match(/(hour|hours|hr|hrs)/)?1:e[0].match(/(minute|minutes|min|mins)/)?0:"",p=e[0].match(/[0-9]{1,2}/),m=e[0].match(/(after|in)/)?1:0,_=1==u?36e5*p[0]:0==u?6e4*p[0]:"";return 1==m&&_?parseInt(k)+parseInt(_):""}}catch(e){}}function dt(e,t){try{var a=7+t-e.getDay();if(t<e.getDay()&&0==t)a=14-e.getDay();return e.setDate(e.getDate()+a),e}catch(e){}}function ot(e,t){try{if(t>=e.getDay())var a=t-e.getDay();else a=7+t-e.getDay();return e.setDate(e.getDate()+a),e}catch(e){}}function ut(e,t){try{return e.setDate(e.getDate()+t),e}catch(e){}}function pt(e,t){try{return e.setDate(e.getDate()-e.getDay()-(7-t)),e}catch(e){}}function mt(e,t,a,l){try{var c,i,n,r;return 4==N.indexOf(e)?(i=new Date,""!=l&&i.setFullYear(l),i.setMonth(-1<we.indexOf(a.toLowerCase())?we.indexOf(a.toLowerCase())+parseInt(1):Oe.indexOf(a.toLowerCase())+parseInt(1)),i.setDate(0),i.setDate(i.getDate()-7),l=(n=i.getDay())<(-1<Te.indexOf(t)?Te.indexOf(t):-1<Ze.indexOf(t)?Ze.indexOf(t):"")?(-1<Te.indexOf(t)?Te.indexOf(t):-1<Ze.indexOf(t)?Ze.indexOf(t):"")-n:7-(n-(-1<Te.indexOf(t)?Te.indexOf(t):-1<Ze.indexOf(t)?Ze.indexOf(t):"")),i.setDate(i.getDate()+l),i):(c=N.indexOf(e),i=new Date,""!=l&&i.setFullYear(l),i.setDate(1),i.setMonth(-1<we.indexOf(a.toLowerCase())?we.indexOf(a.toLowerCase()):Oe.indexOf(a.toLowerCase())),l=(n=i.getDay())<=(-1<Te.indexOf(t)?Te.indexOf(t):-1<Ze.indexOf(t)?Ze.indexOf(t):"")?(-1<Te.indexOf(t)?Te.indexOf(t):-1<Ze.indexOf(t)?Ze.indexOf(t):"")-n:7-(n-(-1<Te.indexOf(t)?Te.indexOf(t):-1<Ze.indexOf(t)?Ze.indexOf(t):"")),(r=new Date).setDate(i.getDate()+l+7*c),r.setMonth(i.getMonth()),r.setFullYear(i.getFullYear()),r)}catch(e){}}if(Ue.match(/(remind|reminder|notify|notification)/)){var _t=Ue.match(/(remind|reminder|notify|notification)/),zt=Ue.split(_t[0]);if(zt[1].match(/((in)?\s?[0-9]{1,2}\s?(day|hour|hr|minute|min)s?)/)){var ft=zt[1].match(/((in|after|before)?\s?[0-9]{1,2}\s?(day|hour|hr|minute|min)s?\s?(after|before)?)/),vt=(tt=ft[0].match(/[0-9]{1,2}/),ft[0].match(/(day)s?/)?864e5:ft[0].match(/(hour|hr)s?/)?36e5:ft[0].match(/(minute|min)s?/)?6e5:""),ht=ft[0].match(/after/)?1:ft[0].match(/before/)?0:1,gt=tt*vt,Ct=!0;He.isrem=Ct,He.remt=gt,He.remty=ht}zt[0].match(/([0-9]{1,2}\s?(day|hour|hr|minute|min)s?)/)&&(He.isrem="")}if(null==k&&null==$e){if($e=at(Ue),Ue.match(/((this|next)?\s?weekend)/)&&$e){var yt=Ue.match(/((this|next)?\s?weekend)/),Lt=(yt[0].match("this")?ot:yt[0].match("next")?dt:ot)(new Date,0);Pe=Date.parse(Lt.getMonth()+parseInt(1)+"/"+Lt.getDate()+"/"+Lt.getFullYear())}if(Ue.match(/(every|all)\s?(weekend)s?/)&&$e){Se.weekly=1;var bt=ot(new Date,6);Date.parse(bt.getMonth()+parseInt(1)+"/"+bt.getDate()+"/"+bt.getFullYear());fe="saturday,sunday",Pe=$e}if($e&&!Se.daily&&!Se.monthly&&!Se.weekly&&!Se.yearly){if(Ue.match(/(every)\s?(first|second|third|fourth|last)\s?(saturday|sunday|monday|tuesday|wednesday|thursday|friday)/)){Se.monthly=1;var Et=Ue.match(/(every)\s?(first|second|third|fourth|last)\s?(saturday|sunday|monday|tuesday|wednesday|thursday|friday)/)[0].split("every")[1].split(" ");me=Et[2],pe=Et[1]}if(Ue.match(/every/)){for(var Tt=(Vt=Ue.split(/every(.+)?/))[1].split(Ne),Dt="",Zt=0;Zt<Tt.length;Zt++){if(Tt[Zt].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)&&!Tt[Zt-1].match(/(first|second|third|fourth|last)/))Dt+=(Gt=(Gt=Tt[Zt].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/))||Tt[Zt].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/))?Gt[0]+",":""}Dt&&(Se.weekly=1,fe=Dt||fe,Re=1)}}if($e&&1==Se.weekly&&m&&m[0].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)&&Ue.match(/every/)){for(Tt=(Vt=Ue.split(/every(.+)?/))[1].split(Ne),Dt="",Zt=0;Zt<Tt.length;Zt++){if(Tt[Zt].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/))Dt+=(Gt=(Gt=Tt[Zt].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/))||Tt[Zt].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/))?Gt[0]+",":""}Se.weekly=1,fe=Dt||fe,Re=1}I=$e||"0"}if(null==I&&0!=I||null!=k||(k=ct(Ue)),null==$e&&null==Pe){if($e=Date.parse(Ae.getMonth()+parseInt(1)+"/"+Ae.getDate()+"/"+Ae.getFullYear()),Pe=$e,Ue.match(/(every|all)\s?(weekday)s?/)&&(Se.daily=1,ge=1),Ue.match(/(every|all)\s?(weekday)s?\s?(of|from|in)\s?(january|jan|february|feb|march|mar|april|apr|may|jun|june|jul|july|august|aug|september|sep|october|oct|november|nov|december|dec)/)){var At=Ue.match(/(every|all)\s?(weekday)s?\s?(of|from|in)\s?(january|jan|february|feb|march|mar|april|apr|may|jun|june|jul|july|august|aug|september|sep|october|oct|november|nov|december|dec)/),Mt=At[0].match(/(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/)?At[0].match(/(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/):At[0].match(/(january|february|march|april|may|june|july|august|september|october|november|december)/)?At[0].match(/(january|february|march|april|may|june|july|august|september|october|november|december)/):"",St=-1<we.indexOf(Mt[0])?we.indexOf(Mt[0]):-1<Oe.indexOf(Mt[0])?Oe.indexOf(Mt[0]):"";if($e=Date.parse(St+parseInt(1)+"/01/"+Ae.getFullYear()),Pe=$e,At[0].match(/(of|in)/)){var kt=new Date($e);kt.setMonth(kt.getMonth()+1),kt.setDate(0),l=Date.parse(kt.getMonth()+parseInt(1)+"/"+kt.getDate()+"/"+kt.getFullYear())}}if(Ue.match(/[0-9]{1,2}\s?of\s?every\s?([0-9]{1,2})?\s?month/)){var wt;Ke=(wt=Ue.split("every"))[0].match(/[0-9]{1,2}/);if(wt[1].match(/[0-9]{1,2}\s?month/)){tt=wt[1].match(/[0-9]{1,2}\s?month/)[0].match(/[0-9]{1,2}/);Se.monthly=1,a=Ke[0],_e=tt[0]}else Se.monthly=1,a=Ke[0]}if(Ue.match(/every\s?([0-9]{1,2})?\s?(day)s?/)||Ue.match("daily")){var Ot=Ue.match(/every\s?([0-9]{1,2})?\s?(day)s?/)?Ue.match(/every\s?([0-9]{1,2})?\s?(day)s?/):Ue.match("daily")?Ue.match("daily"):"";tt=Ot[0].match(/[0-9]{1,2}/)?Ot[0].match(/[0-9]{1,2}/):"1";Se.daily=1,he=tt[0]}if(Ue.match(/((in)\s?[0-9]{1,2}\s?(day)s?)/)&&!He.isrem){var It=Ue.match(/((in|after)\s?[0-9]{1,2}\s?(day)s?)/)[0].match(/[0-9]{1,2}/);(xt=new Date($e)).setDate(xt.getDate()+parseInt(It[0])),Pe=$e=xt}if(Ue.match(/((for)\s?[0-9]{1,2}\s?(day)s?)/)&&!He.isrem){var xt;It=Ue.match(/((for)\s?[0-9]{1,2}\s?(day)s?)/)[0].match(/[0-9]{1,2}/);(xt=new Date($e)).setDate(xt.getDate()+parseInt(It[0])),Pe=xt}}if($e&&!Pe){if(1==Se.weekly&&m&&m[0].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)&&Ue.match(/every/)){for(Tt=(Vt=Ue.split(/every(.+)?/))[1].split(Ne),Dt="",Zt=0;Zt<Tt.length;Zt++){if(Tt[Zt].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/))Dt+=(Gt=(Gt=Tt[Zt].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/))||Tt[Zt].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/))?Gt[0]+",":""}if(Dt&&(Se.weekly=1,fe=Dt||fe,Re=1,Ue.match(/for\s?[0-9]{1,2}\s?(week|month)s?/))){var Nt=Ue.match(/for\s?[0-9]{1,2}\s?(week|month)s?/);if(Nt[0].match(/(month)s?/)){tt=Nt[0].match(/[0-9]{1,2}/);var Rt=new Date;Rt.setMonth(Rt.getMonth()+parseInt(tt[0])),Rt.setDate(0),ze=Rt}else{tt=Nt[0].match(/[0-9]{1,2}/);var $t=new Date,Pt=$t.getDay(),Ht=0==Pt?7*(tt[0]-1):7*(tt[0]-1)+(7-Pt);$t.setDate($t.getDate()+parseInt(Ht)),ze=$t}}}Pe=$e}if(Pe&&null==$e&&($e=Date.parse(Ae.getMonth()+parseInt(1)+"/"+Ae.getDate()+"/"+Ae.getFullYear())),k&&!w&&(w=parseInt(k)+parseInt(36e5)),!k&&w&&(k=w-36e5),!k&&!w){if(Ue.match(/(in|after)\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/)){vt=(jt=Ue.match(/(in|after)\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/))[0].match(/(hours|hour|hr|hrs)/)?1:0;var Ut=jt[0].match(/[0-9]{1,2}/);k=1==vt?parseInt(36e5*Ae.getHours())+parseInt(36e5*Ut[0]):6e4*(Ae.getMinutes()+parseInt(Ut[0]))+parseInt(36e5*Ae.getHours())}if(Ue.match(/(for)\s?(next)?\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/))if(k){vt=(jt=Ue.match(/(for)\s?(next)?\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/))[0].match(/(hours|hour|hr|hrs)/)?1:0,Ut=jt[0].match(/[0-9]{1,2}/);w=1==vt?k+parseInt(36e5*Ut[0]):k+parseInt(6e4*Ut[0])}else{k=36e5*Ae.getHours()+parseInt(6e4*Ae.getMinutes());var jt;vt=(jt=Ue.match(/(for)\s?(next)?\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/))[0].match(/(hours|hour|hr|hrs)/)?1:0,Ut=jt[0].match(/[0-9]{1,2}/);w=1==vt?k+parseInt(36e5*Ut[0]):k+parseInt(6e4*Ut[0])}k=k||w?w&&!k?k-36e5:k:"",w=w||k?k&&!w?k+36e5:w:""}if(k&&w&&w<k&&$e==Pe&&-1!=w){(qt=new Date($e)).setDate(qt.getDate()+1);var Bt=Date.parse(qt.getMonth()+parseInt(1)+"/"+qt.getDate()+"/"+qt.getFullYear());Pe=Bt}if($e&&Pe){if($e==Pe||Se.daily||Se.monthly||Se.weekly||Se.yearly){if($e!=Pe&&1==Se.weekly){var Ft=0;if(Ue.match(/every/)){for(Tt=(Vt=Ue.split(/every(.+)?/))[1].split(Ne),Dt="",Zt=0;Zt<Tt.length;Zt++){if(Tt[Zt].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/))if(Dt+=(Gt=(Gt=Tt[Zt].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/))||Tt[Zt].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/))?Gt[0]+",":"",Tt[Zt+1]&&Tt[Zt+1].match(/to/)){Ft=1;break}}Se.weekly=1,fe=Dt||fe,Re=1==Ft?"":1}}}else{if(Ue.match(/(every)\s?(first|second|third|fourth|last)\s?(saturday|sunday|monday|tuesday|wednesday|thursday|friday)/)){Se.monthly=1;Et=Ue.match(/(every)\s?(first|second|third|fourth|last)\s?(saturday|sunday|monday|tuesday|wednesday|thursday|friday)/)[0].split("every")[1].split(" ");me=Et[2],pe=Et[1],Re=1}if(Ue.match(/(every|all)\s?(weekend)s?/)&&(Se.weekly=1,fe="saturday sunday",Re=1),Ue.match(/(every\s?day)|(daily)/)&&(Se.daily=1,ge=he=1),Ue.match(/every\s?[0-9]{1,2}\s?(day)s?/)){var Yt=Ue.match(/every\s?[0-9]{1,2}\s?(day)s?/)[0].match(/[0-9]{1,2}/);Se.daily=1,he=Yt[0],ge=1}for(var Vt,Tt=(Vt=Ue.match("every")?Ue.split(/every(.+)?/):"")?Vt[1].split(Ne):"",Dt="",Zt=0;Zt<Tt.length;Zt++){var Gt;if(Tt[Zt].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)&&!Tt[Zt-1].match(/(first|second|third|fourth|last)/))Dt+=(Gt=(Gt=Tt[Zt].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/))||Tt[Zt].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/))?Gt[0]+",":""}Dt&&(Se.weekly=1,fe=Dt||fe,Re=1),Ue.match(/every\s?(weekday)s?/)&&(Se.daily=1,ge=1)}if(Pe<$e){var qt;(qt=new Date(Pe)).setFullYear(qt.getFullYear()+1);Bt=Date.parse(qt.getMonth()+parseInt(1)+"/"+qt.getDate()+"/"+qt.getFullYear());Pe=Bt}}var Jt={};if(Jt.typ,Jt.day,Jt.idx,Jt.month,Jt.ct,Jt.until,Jt.dat,Jt.wkday,1==Se.yearly||1==Se.monthly){if($e==Pe&&(Jt.typ=1==Se.yearly?3:2,Jt.day=3==Jt.typ?se||"":me||"",Jt.idx=3==Jt.typ?ne||"":pe||"",Jt.month=3==Jt.typ?re:"",Jt.ct=2==Jt.typ&&_e||"",Jt.until=3==Jt.typ?de||"":(Jt.typ,""),Jt.dat=3==Jt.typ?ue||"":2==Jt.typ&&a||""),$e!=Pe&&1==oe){var Wt=new Date($e);Jt.typ=1==Se.yearly?3:2,Jt.day=2==Jt.typ?Wt.getDate():"",Jt.idx="",Jt.month=we[Wt.getMonth()],Jt.ct="",Jt.until=de||"",Jt.dat=3==Jt.typ?Wt.getDate():""}$e!=Pe&&1==Re&&(Jt.typ=2,Jt.day=me,Jt.idx=pe||"",Jt.ct=2==Jt.typ&&_e||"",Jt.until=Pe&&Pe!=$e?Pe:"",Pe=Jt.until?$e:Pe)}if(1==Se.weekly)if(1!=Re){var Xt=new Date($e);Jt.typ=1,Jt.day=fe||Ze[Xt.getDay()],Jt.idx="",Jt.month="",Jt.ct=ve||"",Jt.until=ze||""}else 1==Re&&(Jt.typ=1,Jt.day=fe||"",Jt.idx="",Jt.month="",Jt.ct=ve||"",Jt.until=Pe?$e!=Pe?Pe:ze||"":"",Pe=Jt.until?$e:Pe);if(1==Se.daily&&($e==Pe?(Jt.typ=0,Jt.ct=he||"",Jt.idx="",Jt.month="",Jt.day="",Jt.until=l||"",Jt.wkday=ge||""):1==ge&&(Jt.typ=0,Jt.ct=he||"",Jt.idx="",Jt.month="",Jt.day="",Jt.until=Pe||"",Pe=Jt.until?$e:Pe,Jt.wkday=Jt.ct?"":1)),n&&!s&&(Jt.typ=0,Jt.ct=n,Jt.idx="",Jt.month="",Jt.day="",Jt.until=$e!=Pe?Pe:"",Pe=Jt.until?$e:Pe),s&&!n&&$e==Pe){var Qt=new Date($e),Kt=new Date($e);Kt.setDate(Kt.getDate()-parseInt(7));var ea=new Date($e);if(ea.setDate(ea.getDate()+parseInt(7)),Qt.getMonth()!=Kt.getMonth())Jt.idx="first";else if(Qt.getMonth()!=ea.getMonth())Jt.idx="last";else{for(B=1;Qt.getMonth()==Kt.getMonth();)Kt.setDate(Qt.getDate()-7*B),B++;Jt.idx=3==B?"second":4==B?"third":5==B?"fourth":""}Jt.typ=2,Jt.month="",Jt.day=Te[Qt.getDay()],Jt.ct=s}if(He.isrem=He.remt?""==He.isrem?Ct:He.isrem:"",""==He.isrem)He={};for(var ta=0;ta<i.length;ta++)if(Ue.match(i[ta])){Ue.match(i[ta]);aa(ta,Ue.match(i[ta]))}function aa(e,t){if(0==e&&(r.typ="PC",r.details.machine=t[0]),1==e&&Ue.match(d)){var a=Ue.match(d);r.typ="CAB",r.details.destn=a[0]}if(2==e)if(Ue.match(o)){var l=Ue.match(o);r.typ="ROOM",r.details.room=l[0];var c=(n=Ue.match(/[0-9]{1,2}(st|nd|rd)\sfloor/))?n[0].match(/[0-9]{1,2}/):"",i=Ue.match(u);r.details.flrdt=c?c[0]:"",r.details.loc=i?i[0]:""}else{r.typ="ROOM";var n;c=(n=Ue.match(/[0-9]{1,2}(st|nd|rd)\sfloor/))?n[0].match(/[0-9]{1,2}/):"",i=Ue.match(u);r.details.flrdt=c?c[0]:"",r.details.room="",r.details.loc=i?i[0]:""}}var la,ca,ia,na,ra=$;if(ra.match(/\[(\s+)?\]/g)||ra.match(/\((\s+)?\)/g)){var sa,da,oa=ra.match(/\[(\s+)?\]/)?ra.match(/\[(\s+)?\]/):ra.match(/\((\s+)?\)/g);if(oa&&0!=z)if((da=(sa=(sa=ra.substring(0,ra.indexOf(oa[0])-1)).trim()).split(Ne)).length=""==da[da.length-1]||","==da[da.length-1]?da.length-1:da.length,da[da.length-1]&&(da[da.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on|tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||da[da.length-1].match(/@/)))if(da[da.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||da[da.length-1].match(/@/)||null==da[da.length-1].match(/\b(today|tomorrow|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||!da[da.length-2]||null==da[da.length-2].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)&&null==da[da.length-2].match(/@/)){ua=ra.substring(sa.lastIndexOf(da[da.length-1]),ra.indexOf(oa[0])+oa[0].length);ra=ra.replace(ua,"")}else{sa=sa.replace(da[da.length-1],"");var ua=ra.substring(sa.lastIndexOf(da[da.length-2]),ra.indexOf(oa[0])+oa[0].length);ra=ra.replace(ua,"")}else ra=ra.replace(oa[0],"");if(oa&&0==z)if((da=(sa=(sa=ra.substring(0,ra.indexOf(oa[0])-1)).trim()).split(Ne)).length=""==da[da.length-1]||","==da[da.length-1]?da.length-1:da.length,da[da.length-1]&&(da[da.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||da[da.length-1].match(/@/))){ua=ra.substring(sa.lastIndexOf(da[da.length-1]),ra.indexOf(oa[0])+oa[0].length);ra=ra.replace(ua,"")}else ra=ra.replace(oa[0],"")}var pa=new Date($e);la=pa.getFullYear()+""+(pa.getMonth()+parseInt(1)<10?"0"+(pa.getMonth()+parseInt(1)):pa.getMonth()+parseInt(1))+(pa.getDate()<10?"0"+pa.getDate():pa.getDate()),rst=pa.getFullYear()+""+(pa.getMonth()+parseInt(1)<10?"0"+(pa.getMonth()+parseInt(1)):pa.getMonth()+parseInt(1))+(pa.getDate()<10?"0"+pa.getDate():pa.getDate());var ma,_a,za=new Date(Pe);ca=za.getFullYear()+""+(za.getMonth()+parseInt(1)<10?"0"+(za.getMonth()+parseInt(1)):za.getMonth()+parseInt(1))+(za.getDate()<10?"0"+za.getDate():za.getDate()),rst=za.getFullYear()+""+(za.getMonth()+parseInt(1)<10?"0"+(za.getMonth()+parseInt(1)):za.getMonth()+parseInt(1))+(za.getDate()<10?"0"+za.getDate():za.getDate());ma=k?parseInt(k/36e5):"",_a=k?parseInt(k/6e4)%60:"";ia=(ma.toString().match(/^[0-9]{1}$/)?"0"+ma:ma)+""+(_a.toString().match(/^[0-9]{1}$/)?"0"+_a:_a),ma=w?parseInt(w/36e5):"",_a=w?parseInt(w/6e4)%60:"",w&&parseInt(w/1e3);if(na=(ma.toString().match(/^[0-9]{1}$/)?"0"+ma:ma)+""+(_a.toString().match(/^[0-9]{1}$/)?"0"+_a:_a),0==Jt.typ){if(_.RFRQ=Jt.typ,_.ROPT=""!=Jt.ct?"0":"1",_.RIVL=""==Jt.ct?"1":Jt.ct,_.RDAY=[],_.RTOWK="",_.RDATE="",_.RMON="",_.RCNT="",Jt.until)ha=(ha=new Date(Jt.until)).getFullYear()+""+(ha.getMonth()+parseInt(1)<10?"0"+(ha.getMonth()+parseInt(1)):ha.getMonth()+parseInt(1))+(ha.getDate()<10?"0"+ha.getDate():ha.getDate()),_.RUTL=ha;else _.RUTL="";_.RST=rst}if(1==Jt.typ){if(_.RFRQ=Jt.typ,_.ROPT=0,_.RIVL=""!=Jt.ct?Jt.ct:"1",Jt.day){_.RDAY=[];for(var fa=Jt.day.replace(/,/g," ").split(Ne),va=0;va<fa.length;va++)(-1<Te.indexOf(fa[va])||-1<Ze.indexOf(fa[va]))&&_.RDAY.push(-1<Te.indexOf(fa[va])?Te.indexOf(fa[va])+parseInt(1):Ze.indexOf(fa[va])+parseInt(1))}else _.RDAY=[];if(_.RTOWK="",_.RDATE="",_.RMON="",_.RCNT="",Jt.until)ha=(ha=new Date(Jt.until)).getFullYear()+""+(ha.getMonth()+parseInt(1)<10?"0"+(ha.getMonth()+parseInt(1)):ha.getMonth()+parseInt(1))+(ha.getDate()<10?"0"+ha.getDate():ha.getDate()),_.RUTL=ha;else _.RUTL="";_.RST=rst}if(2==Jt.typ){if(_.RFRQ=Jt.typ,_.ROPT=Jt.idx?"1":"0",_.RIVL=""!=Jt.ct?Jt.ct:"1",_.RDATE=Jt.dat?Jt.dat:"",_.RTOWK=Jt.idx&&-1<c.indexOf(Jt.idx)?c.indexOf(Jt.idx):"",Jt.day){_.RDAY=[];for(fa=Jt.day.replace(/,/g," ").split(Ne),va=0;va<fa.length;va++)(-1<Te.indexOf(fa[va])||-1<Ze.indexOf(fa[va]))&&_.RDAY.push(-1<Te.indexOf(fa[va])?Te.indexOf(fa[va])+parseInt(1):Ze.indexOf(fa[va])+parseInt(1))}else _.RDAY=[];var ha;if(_.RMON="",_.RCNT="",Jt.until)ha=(ha=new Date(Jt.until)).getFullYear()+""+(ha.getMonth()+parseInt(1)<10?"0"+(ha.getMonth()+parseInt(1)):ha.getMonth()+parseInt(1))+(ha.getDate()<10?"0"+ha.getDate():ha.getDate()),_.RUTL=ha;else _.RUTL="";_.RST=rst}var ga={};1==He.isrem&&(ga.ACTYPE="1",ga.REMTIME=He.remt.toString(),ga.REMTYPE=He.remty.toString());var Ca=[];Ca.push(ga);var ya=input.split(Ne),La=input.toLowerCase().split(Ne),ba=ra.split(Ne);Tt="";for(var Ea in ba)for(var G in La)if(La[G]==ba[Ea]){Tt=""!=Tt?Tt+" "+ya[G]:ya[G];break}return 1==ya.length&&""==Tt&&(Tt=ya[0]),ra=Tt||$,p.SD=la,p.ED=ca,p.ST=ia,p.ET=na,p.REP=_,p.ALARM=Ca[0].REMTYPE?Ca:"",p.SUM=ra,p.DESC=input,p};
