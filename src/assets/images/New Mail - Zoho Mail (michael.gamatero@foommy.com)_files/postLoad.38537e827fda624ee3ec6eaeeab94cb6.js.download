"use strict";define([],function(t){var e=t("zmUtil"),i=t("zmAppLoader");return e.loadWms(),zmail.isWSEnabled&&zmModules.getWebsocketModule(),t("ZE_Init").init(),zmail.fromOtherService&&"wp"!==zmail.fromService||(e.updateStreamUnread(),e.addClickHandlerForStreams(),i.load("updater",{forceLoad:!0,avoidCache:!0}).then(function(){var e=t("_updater");e&&"function"==typeof e.init&&e.init("5")})),e.addClickHandlerForMailTo(),e.addClickHandlerForTasks(),e.addClickHandlerForNotes(),zmModules.getRHSModule().then(function(e){(0,e.rhs)($.q(".zmCaRWra"))}),{}}),function(i){var a=i("_"),e=i("zmail.Commander"),n=i("zmail.ValueTypeInferrer.TYPES"),o=zmText.get("zm-settings-core","quickAccess"),s=zmText.get("commonUtils").quickAccess,r={MAILVIEW:"goto-mail-view"},t=[];t.push({name:"mail",group:"goto",description:[s.gotoMail],searchable:!0,action:function(){i("zmApp").showApp("m")}},{name:"new-mail",group:"goto-mail",description:[s.newMail],searchable:!0,action:function(){i("zmUtil").hideMenu(),i("zmUtil").compose()}},{name:"goto-folder",searchable:!1,description:[s.gotoFolder],type:n.Folder.name,getDisplayValue:function(e){return e.path},action:function(e){this.execute("mail");var t=e;a.isObject(e)&&(t=e.id),i("zmList").showMailListing({fId:t})}},{name:"select-mail-view",description:[o.mailView],searchable:!0,action:function(){var i=this,e=o.mailViewOptions;this.preventDefault(),this.setPlaceholder(o.mailView),this.showList({provider:[{name:e.vertical,mailView:"vertical"},{name:e.horizontal,mailView:"horizontal"},{name:e.newTab,mailView:"tab"},{name:e.window,mailView:"window"}],text:"name",filterProps:"name"}).then(function(e){var t=zmail.Settings.MailSuite.Settings.Mail.ReadingPane.Setting.set(e.mailView);zmail.Settings&&zmail.Settings.Mail&&zmail.Settings.Mail.AppModel.set({readingPane:e.mailView}),t.promise&&t.promise.then(function(){_zm.succErrMsg("s",o.success)}).catch(function(){_zm.succErrMsg("e",o.error)}),i.reset()})}},{name:"select-compose-view",description:[o.composeView],searchable:!0,action:function(){var i=this,e=o.composeViewOptions;this.preventDefault(),this.setPlaceholder(o.composeView),this.showList({provider:[{name:e.window,composeView:0},{name:e.tab,composeView:1},{name:e.inline,composeView:2}],text:"name",filterProps:"name"}).then(function(e){var t=zmail.Settings.MailSuite.Settings.Compose.ComposeTarget.Setting.set(e.composeView);t.promise&&t.promise.then(function(){_zm.succErrMsg("s",o.success)}).catch(function(){_zm.succErrMsg("e",o.error)}),i.reset()})}},{name:"select-textDirecction-mode",description:[o.textDirection],searchable:!0,action:function(){var i=this,e=o.textDirectionOptions;this.preventDefault(),this.setPlaceholder(o.textDirection),this.showList({provider:[{name:e.ltr,textDirection:0},{name:e.rtl,textDirection:1}],text:"name",filterProps:"name"}).then(function(e){var t=zmail.Settings.MailSuite.Settings.Compose.TextDirection.Setting.set(Boolean(e.textDirection));t.promise&&t.promise.then(function(){_zm.succErrMsg("s",o.success)}).catch(function(){_zm.succErrMsg("e",o.error)}),i.reset()})}},{name:"select-editor-mode",description:[o.editorMode],searchable:!0,action:function(){var i=this,e=o.editorModeOptions;this.preventDefault(),this.setPlaceholder(o.editorMode),this.showList({provider:[{name:e.rich,textMode:1},{name:e.plain,textMode:0}],text:"name",filterProps:"name"}).then(function(e){var t=zmail.Settings.MailSuite.Settings.Compose.ComposeEditorMode.Setting.set(e.textMode);t.promise&&t.promise.then(function(){_zm.succErrMsg("s",o.success)}).catch(function(){_zm.succErrMsg("e",o.error)}),i.reset()})}},{name:"read-receipt",description:[o.readReceipt],searchable:!0,action:function(){var i=this,e=o.readReceiptOptions;this.preventDefault(),this.setPlaceholder(o.readReceipt),this.showList({provider:[{name:e.always,readreceipt:"always"},{name:e.never,readreceipt:"never"},{name:e.ask,readreceipt:"ask"}],text:"name",filterProps:"name"}).then(function(e){var t=zmail.Settings.MailSuite.Settings.Mail.ReadReceipt.Setting.set(e.readreceipt);zmail.Settings&&zmail.Settings.Mail&&zmail.Settings.Mail.AppModel.set({readReceipt:e.readreceipt}),t.promise&&t.promise.then(function(){_zm.succErrMsg("s",o.success)}).catch(function(){_zm.succErrMsg("e",o.error)}),i.reset()})}},{name:"list-attachments",description:[o.listAttachment],searchable:!0,action:function(){var i=this,e=o.listAttachmentOptions;this.preventDefault(),this.setPlaceholder(o.listAttachment),this.showList({provider:[{name:e.below,attPreference:"Bottom"},{name:e.above,attPreference:"Top"}],text:"name",filterProps:"name"}).then(function(e){var t=zmail.Settings.MailSuite.Settings.Mail.AttachmentPreference.Setting.set(e.attPreference);zmail.Settings&&zmail.Settings.Mail&&zmail.Settings.Mail.AppModel.set({readReceipt:e.attPreference}),t.promise&&t.promise.then(function(){_zm.succErrMsg("s",o.success)}).catch(function(){_zm.succErrMsg("e",o.error)}),i.reset()})}},{name:"load-external-image",description:[o.loadExtImage],searchable:!0,action:function(){var i=this,e=o.loadExtImageOptions;this.preventDefault(),this.setPlaceholder(o.loadExtImage),this.showList({provider:[{name:e.always,externalImg:"always"},{name:e.ask,externalImg:"ask"}],text:"name",filterProps:"name"}).then(function(e){var t=zmail.Settings.MailSuite.Settings.Mail.LoadExternalImage.Setting.set(e.externalImg);zmail.Settings&&zmail.Settings.Mail&&zmail.Settings.Mail.AppModel.set({loadExternalImage:e.externalImg}),t.promise&&t.promise.then(function(){_zm.succErrMsg("s",o.success)}).catch(function(){_zm.succErrMsg("e",o.error)}),i.reset()})}},{name:"time-format",description:[o.timeFormat],searchable:!0,action:function(){var i=this,e=o.timeFormatOptions;this.preventDefault(),this.setPlaceholder(o.timeFormat),this.showList({provider:[{name:e.twelve,format:"12"},{name:e.twentyFour,format:"24"}],text:"name",filterProps:"name"}).then(function(e){var t=zmail.Settings.MailSuite.Settings.Mail.DisplayTimeFormat.Setting.set(e.format);t.promise&&(t.promise.then(function(){_zm.succErrMsg("s",o.success)}).catch(function(){_zm.succErrMsg("e",o.error)}),zmail.Settings&&zmail.Settings.Mail&&zmail.Settings.Mail.AppModel.set({timeFormat:e.format})),i.reset()})}},{name:"select-and-goto-folder",group:"goto-mail-folders",description:[s.gotoFolder],searchable:!0,action:function(){var t=this;this.preventDefault(),t.setPlaceholder(s.selectFolder),this.showList({provider:i("zmfolAction").getMailFolderPaths(),text:"path",filterProps:"path"}).then(function(e){t.execute("goto-folder",e),t.reset()})}},{name:r.MAILVIEW,searchable:!1,description:[s.gotoView],type:n.MailView.name,getDisplayValue:function(e){return e.name},action:function(e){this.execute("mail");var t=e;a.isObject(e)&&(t=e.id),i("zmList").showMailListing({fId:t})}},{name:"select-and-goto-mail-view",group:r.MAILVIEW,description:[s.gotoView],searchable:!0,action:function(){var t=this;this.preventDefault(),t.setPlaceholder(o.selectView),this.showList({provider:n.MailView.supportedValues,text:"name",filterProps:"name"}).then(function(e){t.execute(r.MAILVIEW,e),t.reset()})}},{name:"goto-tag",searchable:!1,description:[s.gotoTag],type:n.Tag.name,getDisplayValue:function(e){return e.dispName},action:function(e){this.execute("mail");var t=e;a.isObject(e)&&(t=e.id),i("zmList").showMailListing({fId:t})}},{name:"select-and-goto-tag",group:"goto-mail-tag",description:[s.gotoTag],searchable:!0,action:function(){var t=this;this.preventDefault(),t.setPlaceholder(s.tagName),this.showList({provider:a.toArray(zmail.labInfo),text:"dispName",filterProps:"dispName"}).then(function(e){t.execute("goto-tag",e),t.reset()})}},{name:"create-bookmark",description:[s.bookmark],action:function(e){i("zmUtil").loadLink({mode:"create"})}},{name:"goto-saved-search",searchable:!1,description:[s.savedSearch],type:n.SavedSearch.name,getDisplayValue:function(e){return e.FN},action:function(e){var t=i("zmSearch");if(t&&t.processSavedSearch)return t.processSavedSearch({id:e.id,mode:"get"})}},{name:"create-bookmark-value",searchable:!1,description:[s.addBookmark],type:n.Link.name,getDisplayValue:function(e){return e},action:function(e){i("zmUtil").loadLink({mode:"create",link:e})}},{name:"goto-streams-entity",searchable:!1,description:[s.gotoLink],type:n.StreamsLink.name,getDisplayValue:function(e){return e},action:function(e){i("zmUtil").openStreamsUrl(e)}},{name:"calendar",group:"goto",description:[s.gotoCalendar],searchable:!0,action:function(){i("zmApp").showApp("c")}},{name:"new-calendar-event",group:"goto-calendar",description:[s.newEvent],searchable:!0,action:function(){i("zmUtil").hideMenu(),i("zmApp").loadCalendar("/calendar/event")}},{name:"task",group:"goto",description:[s.gotoTask],searchable:!0,action:function(){i("zmApp").showApp("t")}},{name:"new-task",group:"goto-task",description:[s.newTask],searchable:!0,action:function(){i("zmUtil").hideMenu(),i("zmUtil").loadTask({action:"addCTask",groupId:zmail.zuid})}},{name:"notes",group:"goto",description:[s.gotoNotes],searchable:!0,action:function(){i("zmApp").showApp("n")}},{name:"new-notes",group:"goto-notes",description:[s.newNote],searchable:!0,action:function(){i("zmUtil").hideMenu(),"n"===i("zmApp").currentApp?i("znNote").createInlineNotes():i("zmUtil").loadNotes("popup")}}),_zm.isStreamsEnabled()&&t.push({name:"streams",group:"goto",description:[s.gotoStreamsHome],searchable:!0,action:function(){return i("zmsuite").loadStreams()}},{name:"goto-streams-group",searchable:!1,description:[s.gotoStreams],type:n.Group.name,getDisplayValue:function(e){return zmail.ContactBook.isGroup(e)?e.get("name"):e.name},action:function(e){var t=e;a.isObject(e)&&(t=e.id),i("zmsuite").loadStreams(t)}},{name:"select-and-goto-streams-group",group:"goto-streams",description:[s.gotoStreamsGroup],searchable:!0,action:function(){var t=this;this.preventDefault(),t.setPlaceholder(s.selectGroupName),this.showList({provider:zmail.ContactBook.getGroups().map(function(e){return e.attrs}),text:"name",filterProps:"name"}).then(function(e){t.execute("goto-streams-group",e),t.reset()})}}),t.push({name:"attachment",group:"goto",description:[s.attachmentViewer],searchable:!0,action:function(){i("zmsuite").loadAttachView()}}),"wp"!==zmail.fromService&&t.push({name:"theme",searchable:!1,description:[o.theme],action:function(e){zmAdHocSettings.setTheme(e);try{var t=_zm.getThemeNameForTheme(e);zmail.Settings&&zmail.Settings.MailSuite.Settings.General&&(zmail.Settings.MailSuite.Settings.General.UITheme.Setting.set(t),zmail.Settings.AppModel&&zmail.Settings.AppModel.set({theme:t}))}catch(e){}}},{name:"select-theme-apply",description:[o.theme],searchable:!0,action:function(){var t=this,e=o.themeOptions;this.preventDefault(),this.setPlaceholder(o.theme),this.showList({provider:[{name:e.blueD,value:"theme1"},{name:e.blueL,value:"theme4"},{name:e.greenD,value:"theme2"},{name:e.greenL,value:"theme3"},{name:e.yellowD,value:"theme7"},{name:e.yellowL,value:"theme8"},{name:e.redD,value:"theme5"},{name:e.redL,value:"theme6"},{name:e.black,value:"theme9"},{name:e.vintage,value:"theme10"}],text:"name",filterProps:"name"}).then(function(e){t.execute("theme",e.value),t.reset()})}}),e.register(t)}(zmail.Core.Namespaces.get);