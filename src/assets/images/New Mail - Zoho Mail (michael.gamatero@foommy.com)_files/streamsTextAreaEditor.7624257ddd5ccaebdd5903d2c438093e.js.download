"use strict";define([],function(e){var t=e("zmail.Streams.Components"),n=e("zmail.Components.TextAreaEditor.BaseEditor"),d=n.EVENTS;d.mentionAdded="MENTION_ADDED",d.mentionRemoved="MENTION_REMOVED";var r=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initBlockRenderers",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initBlockRenderers",this).call(this),this.setBlockRenderer("mention",this.mentionBlockRenderer)}},{key:"mentionBlockRenderer",value:function(e,t){var n=(t=t||{}).className||"zm_groupMember";return e.data&&e.data.isInvitee&&(n="zm_otherMember"),React.createElement("b",{className:n},e.value)}}]),t}(n.BackgroundContent),i=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getBackgroundContentClass",value:function(){return r}},{key:"blockRemovedHandler",value:function(e,t){var n=this;"mention"===t.type&&setTimeout(function(){$.e(n).triggerHandler(d.mentionRemoved,{id:t.id})})}},{key:"bindEvents",value:function(){var e=this;babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"bindEvents",this).call(this),e.blockRemovedHandler=e.blockRemovedHandler.bind(e),$.e(e).on(n.EVENTS.blockRemoved,e.blockRemovedHandler)}},{key:"unbindEvents",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"bindEvents",this).call(this),$.e(this).off(n.EVENTS.blockRemoved,this.blockRemovedHandler)}},{key:"replaceCurrentTypingWordWithMention",value:function(e){var t=this;if(!(e=e||{}).id||!e.text)return!1;var n=t.getCursorPositionWithBOM(),r=n-t.getCurrentTypingWord().length,i=n;t.replaceTextRangeWith(e.text,r,i);var o=r,s=r+e.text.length,l=t.addMetaBlock({id:e.id,type:"mention",start:o,end:s,text:e.text,data:e});return l&&(t.checkCursorPositionAndAdjust(),setTimeout(function(){$.e(t).triggerHandler(d.mentionAdded,{id:e.id})})),l}},{key:"replaceCurrentWordWithMention",value:function(e,t){var n=this;if(t=t||"",!(e=e||{}).id||!e.text||!t.length)return!1;var r=n.getCursorPositionWithBOM(),i=r-t.length,o=r;n.replaceTextRangeWith(e.text,i,o);var s=i,l=i+e.text.length,a=n.addMetaBlock({id:e.id,type:"mention",start:s,end:l,text:e.text,data:e});return a&&(n.checkCursorPositionAndAdjust(),setTimeout(function(){$.e(n).triggerHandler(d.mentionAdded,{id:e.id})})),a}},{key:"replaceTextBeforeCursorWith",value:function(e,t){var n=this,r=n.getCursorPositionWithBOM(),i=r-e.length,o=r;n.replaceTextRangeWith(t,i,o),n.syncText()}},{key:"insertTextAtCursorPosition",value:function(e,t){var n=this.textarea,r=n.value;r=r.substring(0,n.selectionStart)+e+r.substring(n.selectionEnd),t+=e.length,n.value=r,this.setCursorPosition(t),this.syncText()}}]),t}(n);return i.EVENTS=d,t.StreamsEditor=i,t.StreamsEditor});