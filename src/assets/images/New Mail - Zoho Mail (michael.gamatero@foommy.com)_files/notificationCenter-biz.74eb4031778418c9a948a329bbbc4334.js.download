"use strict";!function(){var o,f,n=zmNCenter.Common.Utils.UtilMethods,i=zmNCenter.Common.Constants.URLS.BIZ_URL,s=$.publish,d=function(){function r(){babelHelpers.classCallCheck(this,r)}return babelHelpers.createClass(r,null,[{key:"loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r.planInfo=(e=e||{}).info||{},n.ajaxRequest({u:i,param:{mode:"bannerMsg"},setHeader:!1,callback:{fn:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];r.bizData=e,r.bizDataCount=e.length||0,o(),f();for(var n=0,i=r.bizData.length;n<i;n++){var t=r.bizData[n];t&&("offer"===t.type.toLowerCase()&&t.offerType&&"yearendoffer2019"!==t.offerType.toLowerCase()&&--r.bizDataCount)}r.isYearEndOfferPresent&&r.isYearEndOfferIconClicked&&(r.bizDataCount=0<--r.bizDataCount?r.bizDataCount:0),s("zmncenter/counter/increment",{count:r.bizDataCount}),zmNCenter.bizNotification.bizResolve()}}})}}]),r}(),a={initOfferSeenState:function(){var e=zmAdHocSettings.getWhatsNewVersion()||{};e.isOfferSeen=e.isOfferSeen||d.isOfferSeen,d.isOfferSeen=e.isOfferSeen},updateOfferSeenState:function(e){var n=zmAdHocSettings.getWhatsNewVersion()||{};n.isOfferSeen=e,zmAdHocSettings.setWhatsNewVersion(n)},initFreeOrgOfferSeenState:function(){var e=zmAdHocSettings.getWhatsNewVersion()||{};e.isFreeOrgOfferSeen=e.isFreeOrgOfferSeen||d.isFreeOrgOfferSeen,d.isFreeOrgOfferSeen=e.isFreeOrgOfferSeen},updateFreeOrgOfferSeenState:function(e){var n=zmAdHocSettings.getWhatsNewVersion()||{};n.isFreeOrgOfferSeen=e,zmAdHocSettings.setWhatsNewVersion(n)},initOfferCloseIconState:function(){var e=zmAdHocSettings.getWhatsNewVersion()||{};e.isOfferCloseIconClicked=e.isOfferCloseIconClicked||d.isOfferCloseIconClicked,d.isOfferCloseIconClicked=e.isOfferCloseIconClicked},updateOfferCloseIconState:function(e){var n=zmAdHocSettings.getWhatsNewVersion()||{};n.isOfferCloseIconClicked=e,zmAdHocSettings.setWhatsNewVersion(n)},initFreeOrgOfferCloseIconState:function(){var e=zmAdHocSettings.getWhatsNewVersion()||{};e.isFreeOrgOfferIconClicked=e.isFreeOrgOfferIconClicked||d.isFreeOrgOfferIconClicked,d.isFreeOrgOfferIconClicked=e.isFreeOrgOfferIconClicked},updatePremiumOfferCloseIconState:function(e){var n=zmAdHocSettings.getWhatsNewVersion()||{};n.isFreeOrgOfferIconClicked=e,zmAdHocSettings.setWhatsNewVersion(n)},initYearEndOfferSeenState:function(){var e=zmAdHocSettings.getWhatsNewVersion()||{};e.isYearEndOfferSeen=void 0!==e.isYearEndOfferSeen?e.isYearEndOfferSeen:d.isYearEndOfferSeen,d.isYearEndOfferSeen=e.isYearEndOfferSeen},updateYearEndOfferSeenState:function(e){var n=zmAdHocSettings.getWhatsNewVersion()||{};d.isYearEndOfferSeen=n.isYearEndOfferSeen=e,zmAdHocSettings.setWhatsNewVersion(n)},initYearEndOfferCloseIconState:function(){var e=zmAdHocSettings.getWhatsNewVersion()||{};e.isYearEndOfferIconClicked=void 0!==e.isYearEndOfferIconClicked?e.isYearEndOfferIconClicked:d.isYearEndOfferIconClicked,d.isYearEndOfferIconClicked=e.isYearEndOfferIconClicked},updateYearEndOfferCloseIconState:function(e){var n=zmAdHocSettings.getWhatsNewVersion()||{};d.isYearEndOfferIconClicked=n.isYearEndOfferIconClicked=e,zmAdHocSettings.setWhatsNewVersion(n)}};d.planInfo={},d.bizData=[],d.bizDataCount=void 0,d.isOfferCloseIconClicked=!1,d.isOfferPresent=!1,d.isOfferSeen=!1,d.isFreeOrgOfferIconClicked=!1,d.isFreeOrgOfferPresent=!1,d.isFreeOrgOfferSeen=!1,d.isYearEndOfferIconClicked=!1,d.isYearEndOfferPresent=!1,d.isYearEndOfferSeen=!1,f=function(){["initOfferCloseIconState","initFreeOrgOfferCloseIconState","initFreeOrgOfferSeenState","initOfferSeenState","initYearEndOfferSeenState","initYearEndOfferCloseIconState"].forEach(function(e){return a[e]()})},o=function(){d.isOfferPresent=!1,d.isFreeOrgOfferPresent=!1,d.isYearEndOfferPresent=Boolean((d.bizData||[]).filter(function(e){return e&&"yearEndOffer2019"===e.offerType}).length)};var m={HIDE:{display:"none"}},l=function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=e.find(".js-actions"),f=$.e(document.createDocumentFragment()),s=n.length;n.forEach(function(e,n){var i,t=$.e(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.text;return"goto"===e.type?zdom("span",null,n):zdom("b",null)}(e)),r=e.uri,o=e.type;f.appendDOM(t),n!==s-1&&f.appendDOM(zdom("span",{className:"zmSDot"})),"goto"===o&&(i=r,t.off("click").on("click",function(){return zmUtil.openWindowWithNoOpener(i)}))}),i.appendDOM(f)},O=function(e,n){var i={icon:"msi-zohoMail zmDoubleIcon",stateClass:"notiNorm"};switch(e.notificationState&&e.notificationState.toLowerCase()){case"danger":i.stateClass="notiDang",i.icon="msi-fail zmDoubleIcon";break;case"safe":break;case"warning":i.stateClass="notiWarn",i.icon="msi-warning zmDoubleIcon"}n.addClass(i.stateClass),n.find(".js-icon").addClass(i.icon)},c="zmncenter/biz/yearEndOfferNotificationClose",z="notificationCenter-biz",u="js-click-handler",g="js-close-icon-handler";$.subscribe("zmncenter/biz/offerNotificationClose",function(){d.isOfferCloseIconClicked=!0,a.updateOfferCloseIconState(!0)}),$.subscribe("zmncenter/biz/premiumOfferNotificationClose",function(){d.isFreeOrgOfferIconClicked=!0,a.updatePremiumOfferCloseIconState(!0)}),$.subscribe(c,function(){d.isYearEndOfferIconClicked=!0,a.updateYearEndOfferCloseIconState(!0)}),$.subscribe("zmncenter/biz/freeOrgOfferSeen",function(){!d.isFreeOrgOfferSeen&&d.isFreeOrgOfferPresent&&(d.isFreeOrgOfferSeen=!0,a.updateFreeOrgOfferSeenState(!0))}),$.subscribe("zmncenter/biz/offerSeen",function(){!d.isOfferSeen&&d.isOfferPresent&&(d.isOfferSeen=!0,a.updateOfferSeenState(!0))}),$.subscribe("zmncenter/biz/yearEndOfferSeen",function(){!d.isYearEndOfferSeen&&d.isYearEndOfferPresent&&(d.isYearEndOfferSeen=!0,a.updateYearEndOfferSeenState(!0))}),zmail.isBaihui||_zm.isEU()||_zm.isIN();var C,N,e,t=function(e){return e&&e.stopPropagation()},S=function(e){return e.slideUp("slow","swing",function(){return e.remove()})},p=function(){return zdom("span",{className:"zmNotiUPOffPerImg"})},I=function(e){return zdom("span",null,e)},v=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i=2<arguments.length?arguments[2]:void 0,t=3<arguments.length?arguments[3]:void 0;"function"==typeof i&&(i=i());var r=document.createDocumentFragment(),o=e.indexOf(n),f=e.substring(0,e.indexOf(n)),s=o+n.length,a=e.substring(s);return r.appendChild(t(f)),r.appendChild(i),r.appendChild(t(a)),r},b=(C=function(e){t(e),zmUtil.openWindowWithNoOpener(zmail.bizControlPanelUrl+"#offers")},N=function(e){t(e),S($.e(e.target).closest("."+u)),$.publish(c)},function(e,n,i){if(a.initYearEndOfferCloseIconState(),!d.isYearEndOfferIconClicked){var t,r=$.e(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"popout",n=zmText.get(z,"yearEndOffer");return"popout"===e?zdom("div",{className:"js-yearEndOffer js-biz-noti"},zdom("div",{className:"zmNotiUPOff "+u},zdom("div",{className:"zmNotiUPOffCont"},zdom("h2",null,n.bigLeap),zdom("p",null,n.startPro),zdom("div",{className:"zmNotiUPOffBtn"},zdom("span",null,zmText.get(z,"goPremiumOffer").goPremium))),zdom("div",{className:"zmNotiUPOffImgWrap"},zdom("span",{className:"zmNotiUPOffImgBg zmNotiUPOffCir1"}),zdom("span",{className:"zmNotiUPOffImgBg zmNotiUPOffCir2"}),zdom("span",{className:"zmNotiUPOffImgBg zmNotiUPOffCir3"}),zdom("div",{className:"zmNotiUPOffImg"},zdom("div",{className:"zmNotiUPOffImgTxt"},v(n.upto,"{{percentage}}",p,I)))),zdom("div",{className:"zmNotiUPOffClose "+g},zdom("i",{className:"msi-close"})))):zdom("div",{className:"js-yearEndOffer js-biz-noti"},zdom("div",{className:"zmNotiUPOff "+u},zdom("div",{className:"zmNotiUPOffImgWrap"},zdom("span",{className:"zmNotiUPOffImgBg zmNotiUPOffCir1"}),zdom("span",{className:"zmNotiUPOffImgBg zmNotiUPOffCir2"}),zdom("span",{className:"zmNotiUPOffImgBg zmNotiUPOffCir3"})),zdom("div",{className:"zmNotiUPOffCont"},zdom("h2",null,n.bigLeap),zdom("p",null,n.startPro),zdom("div",{className:"zmNotiUPOffImgTxt"},v(n.saveupto,"{{percentage}}",p,I)),zdom("div",{className:"zmNotiUPOffBtn"},zdom("span",null,zmText.get(z,"goPremiumOffer").goPremium))),zdom("div",{className:"zmNotiUPOffClose "+g},zdom("i",{className:"msi-close"}))))}(i.from));$.e(n).prependDOM(r),t=r,$.subscribe(c,function(){$.e(document.body).has(t).length&&S(t)}),t.find("."+u).off("click").on("click",C),t.find("."+g).off("click").on("click",N)}}),E=zmNCenter.Common.Constants.COMMON_CONSTANTS,h=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.type,i=zmail.globalI18N||{},t=i.companyName||E.COMPANY_NAME,r=i.productName||E.PRODUCT_NAME,o=$.extend({},e.placeholder,{companyName:t,planName:d.planInfo.planName||"",productName:r}),f=[n,"OWNER","COMMON"].join("/");return f="notificationTypes."+f,zmText.get("notificationCenter-biz",f,o)},r=zmail.Core.Namespaces.create("zmNCenter.bizNotification");r.render=function(){return function(e){for(var n,i,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=d.bizData,o=r.length,f=0;f<o;f++){var s=r[f];if(s)if("offer"===s.type.toLowerCase())s.offerType&&"yearendoffer2019"===s.offerType.toLowerCase()&&b(s,e[0],t);else{var a=s.actions,c=$.e((n=h(s),i=(zmail.globalI18N||{}).productName||zmNCenter.Common.Constants.SYSTEM_NAME,zdom("div",{className:"js-biz-noti zmNotiList zmSysNoti"},zdom("div",{className:"zmNotiListData"},zdom("div",{className:"zmNotiImg"},zdom("i",{className:"js-icon"})),zdom("div",{className:"zmNotiDtl"},zdom("div",{className:"zmSysNotiH"},i),zdom("div",{className:"zmSysNotiSub"},n),zdom("div",{className:"zmSysNotiBtm js-actions"})),zdom("div",{className:"zmNotiAction",style:m.HIDE},zdom("i",{className:"msi-close"}))))));a&&Array.isArray(a)&&l(c,a),O(s,c),e.appendDOM(c)}}}.apply(void 0,arguments)},r.bizLoader=function(){return e instanceof Object?e:e=new Promise(function(e,n){r.bizResolve=e,r.bizReject=n})},r.bizLoader(),r.data=function(){return d.bizData},r.count=function(){return d.bizDataCount},r.load=function(){return d.loadData()},r.isOfferCloseIconClicked=d.isOfferCloseIconClicked,r.isOfferPresent=d.isOfferPresent,r.isOfferSeen=d.isOfferSeen,r.isFreeOrgOfferIconClicked=d.isFreeOrgOfferIconClicked,r.isFreeOrgOfferPresent=d.isFreeOrgOfferPresent,r.isFreeOrgOfferSeen=d.isFreeOrgOfferSeen,r.isYearEndOfferIconClicked=function(){return a.initYearEndOfferCloseIconState(),d.isYearEndOfferIconClicked},r.isYearEndOfferPresent=function(){return o(),d.isYearEndOfferPresent},r.isYearEndOfferSeen=function(){return a.initYearEndOfferSeenState(),d.isYearEndOfferSeen},r.getOfferIcoState=function(){return a.initOfferCloseIconState(),d.isOfferCloseIconClicked},r.getFreeOfferIcoState=function(){return a.initFreeOrgOfferCloseIconState(),d.isFreeOrgOfferIconClicked},r.getYearEndOfferIcoState=function(){return a.initYearEndOfferCloseIconState(),d.isYearEndOfferIconClicked}}(),window.__rollupModule=void 0;