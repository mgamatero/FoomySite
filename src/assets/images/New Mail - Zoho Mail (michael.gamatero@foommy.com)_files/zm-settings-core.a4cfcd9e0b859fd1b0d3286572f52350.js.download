"use strict";_defineSettingsModule("Categories",function(e,t){var n={title:zmText.get("zm-settings-core","category").labels.allCategory},i=t("Platform.Components").CategoryManager.create("all",{props:{title:n.title},attributes:{default:!0}});e.All=i},"MailSuite"),_defineSettingsModule("Categories",function(e,t){var n={title:zmText.get("zm-settings-core","category").labels.generalCategory},i=t("Platform.Components").CategoryManager.create("general",{props:{title:n.title}});e.General=i},"MailSuite"),_defineSettingsModule("Categories",function(e,t){var n={title:zmText.get("zm-settings-core","category").labels.mailCategory},i=t("Platform.Components").CategoryManager.create("mail",{props:{title:n.title}});e.Mail=i},"MailSuite"),_defineSettingsModule("Categories",function(e,t){var n={title:zmText.get("zm-settings-core","category").labels.groupsCategory},i=t("Platform.Components").CategoryManager.create("groups",{props:{title:n.title}});e.General=i},"MailSuite"),_defineSettingsModule("Categories",function(e,t){},"MailSuite"),_defineSettingsModule("Utils",function(e){var t=zmail.urls.accURL,n=function(e){setTimeout(function(){window.open(e)},0)},i={openPersonalInfoPage:function(){n(t+"/u/h#profile/personal")},openActivityHistoryPage:function(){n(t+"/u/h#sessions/useractivityhistory")},openActiveSessionsPage:function(){n(t+"/u/h#sessions/useractivesessions")},openSecurityQuestionPage:function(){n(t+"/u/h#security/security_qa")},openChangePasswordPage:function(){n(t+"/u/h#security/security_pwd")}};e.Actions=i},"MailSuite.Settings.Account"),_defineSettingsModule("Cards",function(e,t){var n={cardTitle:zmText.get("zm-settings-core","accountSettings").card.title},i=t("Platform.Components").SettingCardManager.create("account-settings",{props:{openable:!1,title:n.cardTitle},attributes:{category:"general"},searchCommand:{on:"goto",callback:function(){zmail.Settings.SearchCommandIntegrator.showAutoFill(this.getDependentCommands())}}});e.Account=i},"MailSuite"),function(e){var t="account-settings",n="personal-info",i="activity-history",a="active-sessions",r="security-questions",o="change-password",s={cardItem:{title:zmText.get("zm-settings-core","accountSettings").cardItems.labels}},c=e("Platform.Components"),l=e("Platform.Entities"),u=e("MailSuite.Settings.Account.Utils").Actions,p=c.SettingCardItemManager,d=l.SettingCardItem.Types,g=function(e,t){t=t||{},p.create(e,t)};g(n,{props:{loadFrameworkOnCommandExecution:!1,title:s.cardItem.title.personalInfo},attributes:{type:d.Action,card:t},primaryAction:function(){u.openPersonalInfoPage()}}),g(i,{props:{loadFrameworkOnCommandExecution:!1,title:s.cardItem.title.activityHistory},attributes:{type:d.Action,card:t},primaryAction:function(){u.openActivityHistoryPage()}}),g(a,{props:{loadFrameworkOnCommandExecution:!1,title:s.cardItem.title.activeSessions},attributes:{type:d.Action,card:t},primaryAction:function(){u.openActiveSessionsPage()}}),g(r,{props:{loadFrameworkOnCommandExecution:!1,title:s.cardItem.title.securityQuestions},attributes:{type:d.Action,card:t},primaryAction:function(){u.openSecurityQuestionPage()}}),g(o,{props:{loadFrameworkOnCommandExecution:!1,title:s.cardItem.title.changePassword},attributes:{type:d.Action,card:t},primaryAction:function(){u.openChangePasswordPage()}})}(zmail.Settings.Modules.import),function(e){var t="account-settings",n="personal-info",i="activity-history",a="active-sessions",r="security-question",o="change-password",s=zmText.get("zm-settings-core","accountSettings").quickNavigatorItems.labels,c=e("Platform.Components"),l=e("MailSuite.Settings.Account.Utils"),u=c.QuickNavigatorSectionManager,p=c.QuickNavigatorItemManager,d=l.Actions;u.create(t,{props:{title:s.sectionTitle},state:{selected:!1}}),p.create(n,{props:{title:s.personalInfoTitle},attributes:{section:t},openAction:function(){d.openPersonalInfoPage()}}),p.create(i,{props:{title:s.activityHistoryTitle},attributes:{section:t},openAction:function(){d.openActivityHistoryPage()}}),p.create(a,{props:{title:s.activeSessionsTitle},attributes:{section:t},openAction:function(){d.openActiveSessionsPage()}}),p.create(r,{props:{title:s.securityQuestionTitle},attributes:{section:t},openAction:function(){d.openSecurityQuestionPage()}}),p.create(o,{props:{title:s.changePasswordTitle},attributes:{section:t},openAction:function(){d.openChangePasswordPage()}})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(e,t){var n="general-settings",i=t("Platform.Components"),a=t("Platform.Entities"),r={title:zmText.get("zm-settings-core","generalSettings").page.title},o=i.SettingPageManager,s=a.SettingPage.Types,c=o.create(n,{props:{title:r.title},attributes:{type:s.PageAlone,category:"general",card:n,pageContainerClassNames:"zmSetPage",pageCSSClass:"zmSetNPwra",appContainer:!0}});e.General=c},"MailSuite"),_defineSettingsModule("Cards",function(e,t){var n=zmText.get("zm-settings-core","generalSettings"),i={cardTitle:n.card.title,searchCommandTitle:n.card.searchCommandTitle},a=t("Platform.Components").SettingCardManager,r=a.create("general-settings",{props:{openable:!0,title:i.cardTitle},state:{hidden:!1},attributes:{category:"general"},searchCommand:{title:i.searchCommandTitle},openAction:a.CardActions.OpenPageAction("general-settings")});e.General=r},"MailSuite"),_defineSettingsModule("Persister",function(e,p){var d=p("Platform.System.Utils");e.save=function(){var t=d.makeDeferred(),e=p("MailSuite.Settings.General"),n=e.StartupAction,i=e.StartupApp,a=e.MailAppStartup,r={},o=n.Constants.MODES;r[o.NEW_SESSION]="none",r[o.RESTORE_SESSION]="restore",r[o.NEW_SESSION_WITH_TARGET]="app";var s=n.Setting.get(),c=i.Setting.get(),l=r[s];if(s===o.NEW_SESSION_WITH_TARGET&&(l=l+"-"+c,c===i.Constants.MODES.MAIL)){var u=a.Setting.get();l=l+"-"+u,zmail.mailOpt.isFol="inbox"===u?1:0,zmAjq.XHR({u:zmail.conPath+"/userSettings.do",p:{mode:"viewVO",settings:JSON.stringify({defaultFolder:zmail.mailOpt.isFol})},t:"post",fn:function(e){t.resolve({success:!0,response:e})},efn:function(e){t.reject({success:!1,response:e})}})}return zmAdHocSettings.setLPageType(l),t.resolve(),t.promise()}},"MailSuite.Settings.StartupSetting"),_defineSettingsModule("StartupAction",function(e,t){var n=t("Platform.Components").SettingManager,i=t("Platform.System.Utils"),a=t("MailSuite.Settings.StartupSetting.Persister"),r="restore-session",o="new-session-with-target",s={MODES:{NEW_SESSION_WITH_TARGET:o,RESTORE_SESSION:r}},c=n.create("startup-action",{props:{defaultValue:o,options:[o,r]},type:"option",category:"general",persister:{errors:function(e){return"Error occurred (E"+e+")"},fetch:function(){var e=i.makeDeferred(),t=zmAdHocSettings.getLPageType(),n="app-mail-"+("1"===String(zmail.mailOpt.isFol)?"inbox":"unread");switch((t=(t||"").split("-"))[0]){case"restore":"restore"!==t[0]||_zm._isPrivilegedUser()?t=r:(t=o,zmAdHocSettings.setLPageType(n));break;case"app":t=o;break;default:t=o,zmAdHocSettings.setLPageType(n)}return e.resolve(t),e.promise()},save:function(){var e=i.makeDeferred();return a.save(),e.resolve(),e.promise()}}});e.Setting=c,e.Constants=s},"MailSuite.Settings.General"),_defineSettingsModule("mailTo",function(e,t){var n;n=t("Platform.Components").SettingManager.create("mail-to",{props:{defaultValue:!1},attributes:{category:"general"}}),e.Setting=n},"MailSuite.Settings.General"),_defineSettingsModule("StartupApp",function(e,t){var n,i,a=t("Platform.Components"),r=t("Platform.System.Utils"),o=a.SettingManager,s=t("MailSuite.Settings.StartupSetting.Persister"),c="mail",l="calendar",u="contacts",p="bookmarks",d="streams",g=function(){return[c,l,"tasks","notes",d,u,p]},m=function(){return{MAIL:c,CALENDAR:l,TASKS:"tasks",NOTES:"notes",CONTACTS:u,BOOKMARKS:p,STREAMS:d}},f={MODES:m(),REVERSE_MODES:(n={},i=m(),Object.keys(i).forEach(function(e){n[i[e]]=e}),n),ORDER:g()},S=o.create("startup-app",{props:{defaultValue:c,options:g()},type:"option",category:"general",persister:{errors:function(e){return"Error occurred (E"+e+")"},fetch:function(){var e=r.makeDeferred(),t=zmAdHocSettings.getLPageType();return"app"===(t=(t||"").split("-"))[0]&&t[1]&&f.REVERSE_MODES[t[1]]?e.resolve(t[1]):e.resolve(c),e.promise()},save:function(){var e=r.makeDeferred();return s.save(),e.resolve(),e.promise()}}});e.Setting=S,e.Constants=f},"MailSuite.Settings.General"),_defineSettingsModule("MailAppStartup",function(e,t){var n=t("Platform.Components").SettingManager,i=t("Platform.System.Utils"),a=t("MailSuite.Settings.StartupSetting.Persister"),r=n.create("mail-app-startup",{props:{defaultValue:"unread"},type:"default",category:"general",persister:{errors:function(e){return"Error occurred (E"+e+")"},fetch:function(){var e=i.makeDeferred(),t=zmAdHocSettings.getLPageType(),n="1"===String(zmail.mailOpt.isFol)?"inbox":"unread";return"app"===(t=(t||"").split("-"))[0]&&"mail"===t[1]?(t.shift(),t.shift(),(t=t.join("-"))!==n&&(t=n,zmAdHocSettings.setLPageType("app-mail-"+n))):t=n,e.resolve(t),e.promise()},save:function(){var e=i.makeDeferred();return a.save(),e.resolve(),e.promise()}}});r.initialize(),e.Setting=r},"MailSuite.Settings.General"),_defineSettingsModule("TrashCleanup",function(e,t){var n=t("Platform.Components"),i=t("Platform.Validators.Basic"),r=t("Platform.System.Utils"),o=t("Platform.UI.Utils"),a=n.SettingManager,s={range:{max:180,min:1}},c="trash-cleanup",l={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+c,e),t.resolve(zmail.userOptions.trashCleanupDays),t.promise()},save:function(e,t){var i=r.makeDeferred();r.debugLog("saving "+c,e,t);var n={settings:JSON.stringify({trashCleanupDays:e}),mode:"commonVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.trashCleanupDays=t.value,i.resolve(t.value);var n=zmText.get("zm-settings-app-generalsettings","trashcleanup");o.showSuccessMessage(n.succ)},p:n,csr:"s",ep:a,setSessionId:!0}),i.promise()}},u=a.create(c,{props:{defaultValue:-1},persister:l,validations:[{validator:i.RangeValidator,opts:s.range}],type:"default",category:"general"});u.initialize(),zmComponent.notifier.addHandler("mail",function(e,t){var n=_zm.getProperty(t,"data.act"),i=_zm.getProperty(t,"data.data");n&&i&&"USEROPTIONS_UPDATE"===n&&(zmail.userOptions.trashCleanupDays=i.trashCleanupDays,u.set(i.trashCleanupDays,{noSave:!0}))}),e.Setting=u,e.Constants=s},"MailSuite.Settings.General"),_defineSettingsModule("UIFontFamily",function(e,t){var n=t("Platform.Components"),i=t("Platform.System.Utils"),a=n.SettingManager,r="lato",o="pt-sans",s="arial",c="lato 2",l={FONTS:{LATO:r,LATO2:c,PT_SANS:o,ARIAL:s},ADHOC_VALUE_MAP:{Lato:r,"Lato 2":c,"PT Sans":o,Arial:s},ADHOC_VALUE_REVERSE_MAP:{}};l.ADHOC_VALUE_REVERSE_MAP[r]="Lato",l.ADHOC_VALUE_REVERSE_MAP[o]="PT Sans",l.ADHOC_VALUE_REVERSE_MAP[s]="Arial",l.ADHOC_VALUE_REVERSE_MAP[c]="Lato 2";var u=a.create("ui-font-family",{props:{defaultValue:r,options:["lato","lato 2","pt-sans","arial"]},persister:{errors:function(e){return"Error occurred ( E-"+e+")"},fetch:function(){var e=zmAdHocSettings.getFont(),t=i.makeDeferred();return t.resolve(l.ADHOC_VALUE_MAP[e]),t.promise()},save:function(e){var t=i.makeDeferred();return zmAdHocSettings.setFont(l.ADHOC_VALUE_REVERSE_MAP[e]),t.resolve(),t.promise()}},type:"option",category:"general"});e.Setting=u,e.Constants=l},"MailSuite.Settings.General"),_defineSettingsModule("UIFontSize",function(e,t){var n=t("Platform.Components").SettingManager,a=t("Platform.System.Utils"),r={1:10,2:12,3:14,4:16,5:18},i={FONTOPTIONS:{BROWSER:"BROWSER",CUSTOM:"CUSTOM"},FONTS:{vSmall:"Very Small",small:"Small",medium:"Medium",large:"Large",vLarge:"Very Large"},valueMap:r},o=n.create("ui-font-size",{props:{defaultValue:0},type:"default",category:"general",persister:{errors:function(e){return"Error occurred ( E-"+e+")"},fetch:function(){var e=a.makeDeferred();return e.resolve(0),e.promise()},save:function(e){var t=a.makeDeferred();t.resolve();var n=document.children[0];if(0!==e){var i=r[e]/.875+"px";n.style.fontSize=i}else n.style.removeProperty("font-size");return t.promise()}}});e.Setting=o,e.constants=i},"MailSuite.Settings.General"),_defineSettingsModule("UITheme",function(e,t){var n,i=t("Platform.Components"),a=t("Platform.System.Utils"),r=i.SettingManager,o="blue-light",s="blue-dark",c="green-light",l="green-dark",u="yellow-light",p="yellow-dark",d="red-light",g="red-dark",m="black-light",f="vintage-white",S=function(){return{COBALT_BLUE_LIGHT:o,COBALT_BLUE_DARK:s,FERN_GREEN_LIGHT:c,FERN_GREEN_DARK:l,TANGERINE_YELLOW_LIGHT:u,TANGERINE_YELLOW_DARK:p,CARDINAL_RED_LIGHT:d,CARDINAL_RED_DARK:g,OBSIDIAN_BLACK_LIGHT:m,VINTAGE_WHITE_LIGHT:f}},v={THEMES:S(),ADHOC_THEME_MAP:{theme1:s,theme2:l,theme3:c,theme4:o,theme5:g,theme6:d,theme7:p,theme8:u,theme9:m,theme10:f}},A=r.create("ui-theme",{props:{defaultValue:v.THEMES.COBALT_BLUE_DARK,options:(n=S(),Object.keys(n).map(function(e){return n[e]}))},persister:{errors:function(e){return"Error occurred ( E-"+e+" )"},fetch:function(){var e=zmAdHocSettings.getTheme(),t=a.makeDeferred();return t.resolve(v.ADHOC_THEME_MAP[e]),t.promise()},save:function(t){var e=a.makeDeferred();return t=(t=Object.keys(v.ADHOC_THEME_MAP).filter(function(e){return v.ADHOC_THEME_MAP[e]===t}))[0],zmAdHocSettings.setTheme(t),e.resolve(),e.promise()}},type:"option",category:"general"});e.Setting=A,e.Constants=v},"MailSuite.Settings.General"),_defineSettingsModule("UserLang",function(e,t){var n=t("Platform.Components"),r=t("Platform.System.Utils"),i=n.SettingManager,o={SUPPORTED_LANGUAGES:_.map(zmText.languageConfig,function(e){return e.code})},a=i.create("ui-user-lang",{props:{defaultValue:"en"},persister:{errors:function(e){return"Error occurred ( E-"+e+")"},fetch:function(){var e=r.makeDeferred(),t=zmail.user.lang;return e.resolve(t),e.promise()},save:function(e){var t,n=r.makeDeferred(),i={},a={};return t=e,-1<o.SUPPORTED_LANGUAGES.indexOf(t)?(i.mode="userProfileInfoVO",e&&(a.lang=e),i.settings=JSON.stringify({lang:e}),zmAjq.XHR({u:"/zm/userSettings.do",t:"POST",fn:function(e,t){zmail.user.lang=t.lang,n.resolve(t.lang)},p:i,csr:"s",ep:a})):n.reject(400),n.promise()}},category:"general"});a.initialize(),e.Setting=a,e.Constants=o},"MailSuite.Settings.General"),_defineSettingsModule("MailSoundNotifier",function(e,t){var n=t("Platform.Components"),i=t("Platform.System.Utils"),a=n.SettingManager,r=function(){return zmComponent.soundNotifier._allowedValues},o=a.create("mail-sound-notifier",{props:{defaultValue:0,options:r()},persister:{errors:function(e){return"Error occurred ( E-"+e+" )"},fetch:function(){var e=zmAdHocSettings.getMailSoundNotifier(),t=i.makeDeferred();return t.resolve(Number(e)),t.promise()},save:function(e){var t=i.makeDeferred();return e=String(e),zmAdHocSettings.setMailSoundNotifier(e),t.resolve(),t.promise()}},type:"option",category:"general"}),s=a.create("stream-sound-notifier",{props:{defaultValue:0,options:r()},persister:{errors:function(e){return"Error occurred ( E-"+e+" )"},fetch:function(){var e=zmAdHocSettings.getStreamSoundNotifier(),t=i.makeDeferred();return t.resolve(Number(e)),t.promise()},save:function(e){var t=i.makeDeferred();return e=String(e),zmAdHocSettings.setStreamSoundNotifier(e),t.resolve(),t.promise()}},type:"option",category:"general"});o.initialize(),zmAdHocSettings.subscribeMailSoundNotifierChange(function(e,t){o.set(Number(t.value))}),s.initialize(),zmAdHocSettings.subscribeStreamSoundNotifierChange(function(e,t){s.set(Number(t.value))}),e.Setting=o,e.StreamSetting=s},"MailSuite.Settings.General"),_defineSettingsModule("StreamSoundNotifier",function(e,t){var n=t("Platform.Components"),i=t("Platform.System.Utils"),a=n.SettingManager.create("stream-sound-notifier",{props:{defaultValue:0,options:zmComponent.soundNotifier._allowedValues},persister:{errors:function(e){return"Error occurred ( E-"+e+" )"},fetch:function(){var e=zmAdHocSettings.getStreamSoundNotifier(),t=i.makeDeferred();return t.resolve(Number(e)),t.promise()},save:function(e){var t=i.makeDeferred();return e=String(e),zmAdHocSettings.setStreamSoundNotifier(e),t.resolve(),t.promise()}},type:"option",category:"general"});a.initialize(),zmAdHocSettings.subscribeStreamSoundNotifierChange(function(e,t){a.set(Number(t.value))}),e.StreamSetting=a},"MailSuite.Settings.General"),_defineSettingsModule("UserCountry",function(e,t){var n=t("Platform.Components"),a=t("Platform.System.Utils"),i=n.SettingManager.create("ui-user-country",{props:{defaultValue:"US"},persister:{errors:function(e){return"Error occurred ( E-"+e+")"},fetch:function(){var e=a.makeDeferred(),t=zmail.user.countrycode;return e.resolve(t),e.promise()},save:function(e){var n=a.makeDeferred(),t={},i={};return t.mode="userProfileInfoVO",e&&(i.country=e),t.settings=JSON.stringify({country:e}),zmAjq.XHR({u:"/zm/userSettings.do",t:"POST",fn:function(e,t){zmail.user.countrycode=t.country,n.resolve(t.country)},p:t,csr:"s",ep:i}),n.promise()}},category:"general"});i.initialize(),e.Setting=i,e.Constants={}},"MailSuite.Settings.General"),function(e){var t,n,i,a="general-settings",r="font-family",o="ui-theme",s="startup-action",c="display-language",l="sound-alerts",u="mailto-handler",p=zmText.get("zm-settings-core","generalSettings").cardItems,d=e("Platform.Components"),g=e("Platform.Entities"),m=e("MailSuite.Settings.General"),f=m.UIFontFamily,S=m.UITheme,v=m.StartupAction,A=m.StartupApp,h=m.UserLang,y=m.MailSoundNotifier,C=m.mailTo,b=d.SettingCardItemManager,M=g.SettingCardItem.Types,P=f.Setting,E=S.Setting,z=h.Setting,w=y.Setting,O=v.Setting,I=A.Setting,T=C.Setting,D=f.Constants.FONTS,k=S.Constants.THEMES,_=v.Constants.MODES,R=function(e,t){for(var n in t)if(t[n]===e)return n},L=function(e){e=e||P.get();var t=R(e,D);return p.fontFamily.fontNames[t]},V=b.create(r,{props:{title:p.fontFamily.cardItem.title,value:L()},attributes:{type:M.LabelValue,card:a},searchCommand:{title:p.fontFamily.searchCommand.title},primaryAction:function(){b.CardItemActions.OpenPageAction("general-settings",{showSection:"ui-font"})()}}),N=function(e){e=e||E.get();var t=R(e,k);return p.uiTheme.themeNames[t]};i=b.create(o,{props:{title:p.uiTheme.cardItem.title,value:N(),addToSearch:!1},attributes:{type:M.LabelValue,card:a},primaryAction:function(){b.CardItemActions.OpenPageAction("general-settings",{showSection:"ui-theme"})()}}),"wp"===zmail.fromService&&i.setProp("showInCard",!1);var H=function(e){e=e||z.get();var t=_zm.getProperty(zmText.languageConfig,e);return t?t.displayText:"English"},F=b.create(c,{props:{title:p.displayLanguage.cardItem.title,value:H()},attributes:{type:M.LabelValue,card:a},primaryAction:function(){b.CardItemActions.OpenPageAction("general-settings",{showSection:"display-language"})()}}),x=function(e){return(e=e||w.get())?zmComponent.soundNotifier.soundCodesMap[e]:p.soundNotifier.options.none},U=b.create(l,{props:{title:p.soundNotifier.cardItem.title,value:x()},attributes:{type:M.LabelValue,card:a},primaryAction:function(){b.CardItemActions.OpenPageAction("general-settings",{showSection:"sound-alerts"})()}}),B=function(e){e=e||O.get();var t=R(e,_),n=p.startupAction.modes[t];return"new-session-with-target"===e&&(n=zmText.applyArgs(n,{appName:p.startupAction.appName[I.get()]})),n},Z=b.create(s,{props:{title:p.startupAction.cardItem.title,value:B()},attributes:{type:M.LabelValue,card:a},primaryAction:function(){b.CardItemActions.OpenPageAction("general-settings",{showSection:"startup-action"})()}});navigator.registerProtocolHandler&&(n=function(e){return""},t=b.create(u,{props:{title:p.MailToHandler.cardItem.title,value:n()},attributes:{type:M.LabelValue,card:a},primaryAction:function(){b.CardItemActions.OpenPageAction("general-settings",{showSection:"mailto-handler"})()}}));P.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&V.setProp({value:L(e.changed.value)})}),E.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&i.setProp({value:N(e.changed.value)})}),O.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&Z.setProp({value:B()})}),I.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&Z.setProp({value:B()})}),zmail.Settings.Events.on("initialized",function(){Z.setProp({value:B()})}),z.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&F.setProp({value:H(e.changed.value)})}),w.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&U.setProp({value:x(e.changed.value)})}),navigator.registerProtocolHandler&&T.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&t.setProp({value:n("Disable")})})}(zmail.Settings.Modules.import),function(e){var t="general-settings",n="startup-action",i="ui-display-font",a="ui-theme",r=zmText.get("zm-settings-core","generalSettings").pageItems,o=e("Platform.Components"),s=e("Platform.Entities").SettingPageSection.Types,c=o.SettingPageSectionManager;c.create(n,{props:{title:r.startupAction.sectionTitle},attributes:{page:t,type:s.PageAlone}}),c.create(i,{props:{title:r.font.sectionTitle},attributes:{page:t,type:s.PageAlone}}),c.create(a,{props:{title:r.theme.sectionTitle},attributes:{page:t,type:s.PageAlone}})}(zmail.Settings.Modules.import),_defineSettingsModule("GeneralSettings",function(e,t){var n,i=t("Platform.Components").SettingAppManager,a=t("Platform.System.Utils"),r=function(){return zmAppLoader.load("zm-settings-app-generalsettings")},o=function(){return t("MailSuite.Apps.GeneralSettings.AppCore")},s=function(){var e=a.makeDeferred();return r().then(function(){o().initialize({process:e})},function(){a.debugLog("Module load failed !!!"),e.reject()}),e.promise()},c=function(){var e=a.makeDeferred();return r().done(function(){o().uninitialize({process:e})}),e.promise()},l=function(){return o().getSettingsAppView()},u=function(){var e=o(),t=Array.prototype.slice.call(arguments);return e?e.handleContainerEvent.apply(this,t):null};e.getStreamSounds=function(){var e=zmAdHocSettings.getStreamSoundNotifier(),t=zmComponent.soundNotifier._getAudioObject(String(e));zmComponent.soundNotifier._isSupported&&void 0!==t&&t.play()};n=i.create("general-settings",{attributes:{page:"general-settings",isReactApp:!0},initialize:s,uninitialize:c,getView:l,handleContainerEvent:u}),e.App=n},"MailSuite.Apps"),function(e){var t="general-settings",n="font-family",i="ui-theme",a=zmText.get("zm-settings-core","generalSettings").quickNavigatorItems,r="general-settings",o="ui-font",s="ui-theme",c=e("Platform.Components"),l=c.QuickNavigatorSectionManager,u=c.QuickNavigatorItemManager;l.create(t,{props:{title:a.sectionTitle},state:{selected:!1}}),u.create(n,{props:{title:a.fontFamilyTitle,linkedPage:r,linkedPageSection:o,selectable:!0},attributes:{section:t}}),u.create(i,{props:{title:a.uiThemeTitle,linkedPage:r,linkedPageSection:s,selectable:!0},attributes:{section:t}})}(zmail.Settings.Modules.import);var readableHash={"shift+openBracket":"{","shift+closeBracket":"}","shift+backSlash":"|","shift+backtick":"~","shift+singleQuote":'"',"shift+semiColon":":","shift+equalTo":"+","shift+minus":"_",upArrow:"↑",downArrow:"↓",leftArrow:"←",rightArrow:"→",forwardSlash:"/",backSlash:"\\",openBracket:"[",closeBracket:"]",backtick:"`",singleQuote:"'",semiColon:";",period:".",comma:",",equalTo:"=",minus:"-",ctrl:"Ctrl",shift:"Shift",enter:"Enter",delete:"Delete",esc:"Esc",alt:_zm.is_mac?"Opt":"alt",metaKey:_zm.is_mac?"Cmd":"Super"},getSingleText=function(e){return readableHash[e]||e.toLowerCase()},getCombinedText=function(e,t){return readableHash[e+t]},getReadableTextOfSingleKeySet=function(e){var t,n=e.split(/[+|/]/),i=n.length,a=[],r="";for(t=0;t<i;t++)(r=getCombinedText(n[t],n[t+1]))?(a.push(r),t+=1):a.push(getSingleText(n[t]));return a},getReadableText=function(e){var t=e.split("/"),n=[];return t.forEach(function(e){n.push.apply(n,babelHelpers.toConsumableArray(getReadableTextOfSingleKeySet(e)))}),n},getKeyString=function(e,t){var n,i=zmshCut[e];return _.isArray(i)&&(n=_(i).find(function(e){return e.uid===t})),n&&n.keyStr};window.zmshCut=window.zmshCut||{},window.zmshCut.getReadableText=getReadableText,window.zmshCut.getKeyString=getKeyString,_defineSettingsModule("keyboardshortcuts",function(a,r){var n,i,o,e,t=r("Platform"),s=t.Components,c=t.Entities,l=t.System,u=l.Utils,p=l.Base.Entity.Events,d=s.SettingManager,g=s.SettingCardManager,m=s.SettingCardItemManager,f=s.SettingPageManager,S=s.SettingAppManager,v=c.SettingPage,A=c.SettingCardItem,h=v.Types,y=A.Types,C=zmText.get("zm-settings-core","keyboardShortcuts"),b=C,M="keyboardshortcuts",P="keyboardshortcuts",E="sa-keyboardshortcuts",z="general",w="zm-settings-app-keyboardshortcuts-custom",O="keyboardshorctus-toggle",I=function(e){i.getProp("toggleSwitchActive")!==e&&(i.setProp({toggleSwitchActive:e}),zmail.mailOpt.isKey=e?1:0)},T={errors:function(e){return"Error occured ! Error Code = ".concat(e)},fetch:function(e){var t=u.makeDeferred();return u.debugLog("fetching mail-setting ".concat(O),e),t.resolve(zmail.mailOpt.isKey),t.promise()},save:function(e,t){var i=u.makeDeferred();u.debugLog("saving mail-setting ".concat(O),e,t);var n={},a={};return a.status=e?1:0,n.mode="enable",n.status=e?"enable":"disable",zmAjq.XHR({u:"/zm/zmShortcuts.do",t:"POST",fn:function(e,t){var n=t.status;i.resolve(n),Dialog.confirm(C.refresh,function(){document.location.reload(!0)})},p:n,csr:"s",ep:a}),i.promise()}},D=function(){return zmAppLoader.load(w)},k=function(){var e=u.makeDeferred();return D().then(function(){zmail.Settings.Apps.keyboardshortcuts.initializeData(),e.resolve()},function(){e.reject()}),e.promise()},_=function(){var e=u.makeDeferred();return D().then(function(){zmail.Settings.Apps.keyboardshortcuts.clearTrace(),e.resolve()}),e.promise()},R=function(){return zmail.Settings.Apps.keyboardshortcuts.getView()},L=function(){S.create(E,{attributes:{page:P,isReactApp:!0},initialize:k,uninitialize:_,getView:R,handleContainerEvent:function(e,t){var n,i=r("Apps.keyboardshortcuts");i&&i.handleContainerEvent(e,t),"active"===e?(!function(){var n,t=f.get(P),e=r("Platform.UI.Components").ToggleSwitch,i=!1,a=r("MailSuite.App.Core.Framework.Sections.Category").breadcrumbSection();(n=new e).init({props:{onText:b.toggleSwitchText.ON,offText:b.toggleSwitchText.OFF},state:{on:zmail.mailOpt.isKey}}),n.addTo(a,{targetView:"Lcomponent"});n.on(e.Events.stateChanged,function(){var e=n.getState();i=!0,t.setProp({toggleSwitchActive:e.on})}),t.on(p.propsChange,function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).changed||{};for(var t in e)switch(t){case"toggleSwitchOnText":n.setProp({onText:e.toggleSwitchOnText});break;case"toggleSwitchOffText":n.setProp({offText:e.toggleSwitchOffText});break;case"toggleSwitchActive":i||n.setState({on:e.toggleSwitchActive}),i=!1}})}(),n=r("MailSuite.App.Core.Framework.Sections.Category.getComponents")(),o=n.breadcrumbSection,ReactDOM.render(a.getResetView({collection:ZMStore.getInstance("KSCollection")}),o.getRightHeaderComponentWrapper())):ReactDOM.unmountComponentAtNode(o.getLeftHeaderComponentWrapper())}})};g.create(M,{props:{title:b.title,openable:!0},attributes:{category:z},openAction:g.CardActions.OpenPageAction(P)}),e=function(){var e=d.get(O),t=!0!==e.get();e.set(t)},(n=d.create(O,{props:{defaultValue:!1},category:z,type:"boolean",persister:T,cardItem:{props:{title:b.title},attributes:{type:y.LabelAction,card:M},transformer:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"props"===e&&t.hasOwnProperty("value")&&(t.value=!0===t.value?b.enabled:b.disabled),t},primaryAction:m.CardItemActions.OpenPageAction(P),secondaryAction:e,searchCommand:{title:b.searchCommandTitle,callback:function(){e()}}}})).initialize(),zmshCut.collectionInstance.fetchList().then(function(){}),i=f.create(P,{props:{title:b.title,showTitle:!1,toggleSwitchOnText:b.toggleSwitchText.ON,toggleSwitchOffText:b.toggleSwitchText.OFF,toggleSwitchActive:zmail.mailOpt.isKey},attributes:{card:P,category:"general",appContainer:!0,type:h.PageAlone,showActionable:!1,pageCSSClassName:""}}),L(),n.props.on("change",function(e){var t=e.changed;i.setProp({toggleSwitchActive:t.value})}),i.props.on("change:toggleSwitchActive",function(e){var t=e.changed.toggleSwitchActive;n.set(t)}),$.subscribe("/zm-settings/mailsuite-app/opened",function(){}),$.subscribe("/zm-settings/mailsuite-app/closed",function(){}),a.pageRef=i,a.toggleActiveStatus=I},"Apps"),_defineSettingsModule("Pages",function(e,t){var n="mail-view-options",i=t("Platform.Components"),a=t("Platform.Entities"),r=zmText.get("zm-settings-core","mailViewOptions").page,o=i.SettingPageManager,s=a.SettingPage.Types,c=o.create(n,{props:{title:r.title},attributes:{type:s.PageAlone,card:n,category:"mail",pageContainerClassNames:"zmSetPage",pageCSSClass:"zmSetNPwra",appContainer:!0}});e.MailViewOptions=c},"MailSuite"),_defineSettingsModule("Pages",function(e,t){var n="event-mail-action",i=t("Platform.Components"),a=t("Platform.Entities"),r=zmText.get("zm-settings-core","eventMailAction").page,o=i.SettingPageManager,s=a.SettingPage.Types,c=o.create(n,{props:{title:r.title},attributes:{type:s.Title,pageCSSClass:"event-mail-action-page",category:"mail",card:n,appContainer:!0}});e.EventMailAction=c},"MailSuite"),_defineSettingsModule("Cards",function(e,t){var n=zmText.get("zm-settings-core","mailViewOptions").card,i=t("Platform.Components").SettingCardManager,a=i.create("mail-view-options",{props:{openable:!0,title:n.title},state:{hidden:!1},attributes:{category:"mail"},openAction:i.CardActions.OpenPageAction("mail-view-options")});e.MailViewOptions=a},"MailSuite"),_defineSettingsModule("Persister",function(e,t){var i=t("Platform.System.Utils"),n=t("Platform.Components"),r=t("MailSuite.Settings.Mail"),a=n.SettingManager,o={MailReadingPane:"mail-reading-pane",ReadReceipt:"mail-read-receipt",LoadExternalImage:"load-external-image",TimeFormat:"display-time-format",FolderListSortMode:"folder-list-sort-mode",TagListSortMode:"tag-list-sort-mode",summarySubjectMode:"subject-and-summary",attachmentPreference:"attachment-section-preference"},s=function(e){var t=e.getAttribute("id"),n=o,i=e.get(),a={mode:"viewVO",settings:{}};switch(t){case n.MailReadingPane:a.settings.mailView=function(e){var t=null,n=r.ReadingPane.Constants.MODES;switch(e){case n.VERTICAL:t=0;break;case n.TAB:t=2;break;case n.WINDOW:t=1;break;case n.HORIZONTAL:t=4}return t}(i);break;case n.ReadReceipt:a.settings.askReceiptOnRead=function(e){var t=null,n=r.ReadReceipt.Constants.MODES;switch(e){case n.ALWAYS:t=0;break;case n.ASK_USER:t=1;break;case n.NEVER:t=2}return t}(i);break;case n.LoadExternalImage:a.settings.loadExternalImages=function(e){var t=null,n=r.LoadExternalImage.Constants.MODES;switch(e){case n.ALWAYS:t=0;break;case n.CONTACTS:case n.ASK_USER:t=2}return t}(i);break;case n.TimeFormat:a.settings.isRailTime=function(e){var t=null,n=r.DisplayTimeFormat.Constants.MODES;switch(e){case n.TWELVE_HOUR:t=!1;break;case n.TWENTY_FOUR_HOUR:t=!0}return t}(i);break;case n.FolderListSortMode:a.settings.sortFolders=function(e){var t=null,n=r.FolderListSortMode.Constants.MODES;switch(e){case n.ALPHABETICAL:t=1;break;case n.USER_PREFERENCE:t=0}return t}(i);break;case n.TagListSortMode:a.settings.sortTags=function(e){var t=null,n=r.TagListSortMode.Constants.MODES;switch(e){case n.ALPHABETICAL:t=1;break;case n.USER_PREFERENCE:t=0}return t}(i);break;case n.summarySubjectMode:a.settings.showSummary=function(e){var t=null,n=r.SubjectAndSummary.Constants.MODES;switch(e){case n.SUBSUM:t=1;break;case n.SUBONLY:t=0}return t}(i);break;case n.attachmentPreference:a.settings.showAttachment=function(e){var t=null,n=r.AttachmentPreference.Constants.MODES;switch(e){case n.TOP:t=1;break;case n.BOTTOM:t=0}return t}(i)}return a.settings=JSON.stringify(a.settings),a};e.save=function(e){var t=i.makeDeferred(),n=e;return"string"==typeof(e=e||this)&&(e=a.get(e)),e?"comment-box-hide-mode"===n?(zmAdHocSettings.setCommentBoxView("show"===e.get()?"on":"off"),t.resolve()):function(e){e=e||{};var t=i.makeDeferred();return zmAjq.XHR({u:e.url,p:e.data,t:"post",fn:function(e){t.resolve({success:!0,response:e})},efn:function(e){t.reject({success:!1,response:e})}}),t.promise()}({url:zmail.conPath+"/userSettings.do",data:s(e)}).done(function(e){t.resolve(e.response)}).fail(function(e){t.reject(e.response)}):t.reject(),t.promise()}},"MailSuite.Settings.Mail"),_defineSettingsModule("ReadReceipt",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Mail.Persister"),a=t("Platform.System.Utils"),r=n.SettingManager,o="mail-read-receipt",s="always",c="never",l="ask",u={MODES:{ALWAYS:s,NEVER:c,ASK_USER:l},VALUE_MAP:{always:0,never:2,ask:1},VALUE_REVERSE_MAP:{0:s,1:l,2:c}},p=r.create(o,{props:{defaultValue:l,options:[s,c,l]},persister:{errors:function(e){return"Error occurred ( E"+e+")"},fetch:function(){var e=a.makeDeferred(),t=u.VALUE_REVERSE_MAP[zmail.mailOpt.askReceipt];return e.resolve(t),e.promise()},save:function(){var e=a.makeDeferred();return i.save(o).done(e.resolve).fail(e.fail),e.resolve(),e.promise()}},type:"option",category:"mail"});p.on("props.change",function(e){if((e=e||{}).changed.hasOwnProperty("value")){var t=u.VALUE_MAP[e.changed.value];zmail.mailOpt=zmail.mailOpt||{},zmail.mailOpt.askReceipt=u.VALUE_MAP[e.changed.value],$.publish("SETTINGS_ASK_RECEIPT_ON_READ",t)}}),e.Setting=p,e.Constants=u},"MailSuite.Settings.Mail"),_defineSettingsModule("ReadingPane",function(e,t){var n=t("Platform.Components"),i=t("Platform.System.Utils"),a=t("MailSuite.Settings.Mail.Persister"),r=n.SettingManager,o="mail-reading-pane",s="vertical",c="window",l="horizontal",u={MODES:{VERTICAL:s,HORIZONTAL:l,TAB:"tab",WINDOW:c},VALUE_MAP:{0:s,4:l,1:c,2:"tab"},VALUE_REVERSE_MAP:{vertical:0,window:1,tab:2,horizontal:4}},p=r.create(o,{props:{defaultValue:s,options:[s,"tab",c,l]},persister:{errors:function(e){return"Error occurred ( E"+e+")"},fetch:function(){var e=i.makeDeferred(),t=u.VALUE_MAP[zmail.userOptions.mailView];return e.resolve(t),e.promise()},save:function(){var e=i.makeDeferred();return a.save(o).done(e.resolve).fail(e.fail),e.resolve(),e.promise()}},type:"option",category:"mail"});p.initialize();p.on("props.change",function(e){if((e=e||{}).changed.hasOwnProperty("value")){var t=u.VALUE_REVERSE_MAP[e.changed.value];zmail.userOptions=zmail.userOptions||{},0!==(zmail.userOptions.mailView=t)&&4!==t||zmAdHocSettings.setMailPreviewSize("63"),$.publish("SETTINGS_MAIL_VIEW",t)}}),e.Setting=p,e.Constants=u},"MailSuite.Settings.Mail"),_defineSettingsModule("SubjectAndSummary",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Mail.Persister"),a=t("Platform.System.Utils"),r=n.SettingManager,o="subject-and-summary",s="Subject and Summary",c="Subject Only",l={MODES:{SUBSUM:s,SUBONLY:c},VALUE_MAP:{0:s,1:c},VALUE_REVERSE_MAP:{"Subject and Summary":0,"Subject Only":1}},u=r.create(o,{props:{defaultValue:s,options:[s,c]},persister:{errors:function(e){return"Error Occured + Erroe Code = "+e},fetch:function(e){var t=a.makeDeferred();a.debugLog("fetching Mail Setting"+o,e);var n=zmail.mailOpt.isshowSummary,i=l.VALUE_MAP[n?0:1];return t.resolve(i),t.promise()},save:function(){var e=a.makeDeferred();return i.save(o).done(e.resolve).fail(e.fail),e.promise()}}});u.on("props.change",function(e){if((e=e||{}).changed.hasOwnProperty("value")){var t=!1;0===l.VALUE_REVERSE_MAP[e.changed.value]&&(t=!0),zmail.mailOpt.isshowSummary=t}}),e.Setting=u,e.Constants=l},"MailSuite.Settings.Mail"),_defineSettingsModule("AttachmentPreference",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Mail.Persister"),a=t("Platform.System.Utils"),r=n.SettingManager,o="attachment-section-preference",s="Bottom",c={MODES:{BOTTOM:s,TOP:"Top"},VALUE_MAP:{0:s,1:"Top"},VALUE_REVERSE_MAP:{Bottom:0,Top:1}},l=r.create(o,{props:{defaultValue:s,options:[s,"Top"]},persister:{errors:function(e){return"Error Occured + Erroe Code = "+e},fetch:function(e){var t=a.makeDeferred();a.debugLog("fetching Mail Setting"+o,e);var n=zmail.userOptions.showAttachment,i=c.VALUE_MAP[n];return t.resolve(i),t.promise()},save:function(){var e=a.makeDeferred();return i.save(o).done(e.resolve).fail(e.fail),e.promise()}}});l.on("props.change",function(e){if((e=e||{}).changed.hasOwnProperty("value")){var t=c.VALUE_REVERSE_MAP[e.changed.value];zmail.userOptions.showAttachment=t}}),e.Setting=l,e.Constants=c},"MailSuite.Settings.Mail"),_defineSettingsModule("LoadExternalImage",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Mail.Persister"),a=t("Platform.System.Utils"),r=n.SettingManager,o="load-external-image",s="always",c="contacts",l="ask",u={MODES:{ALWAYS:s,ASK_USER:l},VALUE_MAP:{0:s,1:c,2:l},VALUE_REVERSE_MAP:{always:0,contacts:1,ask:2}},p=r.create(o,{props:{defaultValue:l,options:[s,c,l]},persister:{errors:function(e){return"Error occurred ( E"+e+")"},fetch:function(){var e=a.makeDeferred();1===zmail.userOptions.loadExternalImages&&(zmail.userOptions.loadExternalImages=2);var t=u.VALUE_MAP[zmail.userOptions.loadExternalImages];return e.resolve(t),e.promise()},save:function(){var e=a.makeDeferred();return i.save(o).done(e.resolve).fail(e.fail),e.resolve(),e.promise()}},type:"option",category:"mail"});p.on("props.change",function(e){if((e=e||{}).changed.hasOwnProperty("value")){var t=u.VALUE_REVERSE_MAP[e.changed.value];zmail.userOptions=zmail.userOptions||{},zmail.userOptions.loadExternalImages=t,$.publish("SETTINGS_LOAD_EXTERNAL_IMAGES",t)}}),e.Setting=p,e.Constants=u},"MailSuite.Settings.Mail"),_defineSettingsModule("DisplayTimeFormat",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Mail.Persister"),a=t("Platform.System.Utils"),r=n.SettingManager,o="display-time-format",s={MODES:{TWELVE_HOUR:"12",TWENTY_FOUR_HOUR:"24"},VALUE_MAP:{false:"12",true:"24"},VALUE_REVERSE_MAP:{12:!1,24:!0}},c=r.create(o,{props:{defaultValue:"12",options:["12","24"]},persister:{errors:function(e){return"Error occurred ( E"+e+")"},fetch:function(){var e=a.makeDeferred(),t=s.VALUE_MAP[zmail.userOptions.isRailTime];return e.resolve(t),e.promise()},save:function(){var e=a.makeDeferred();return i.save(o).done(e.resolve).fail(e.fail),e.resolve(),e.promise()}},type:"option",category:"mail"});c.on("props.change",function(e){if((e=e||{}).changed.hasOwnProperty("value")){var t=s.VALUE_REVERSE_MAP[e.changed.value];zmail.userOptions=zmail.userOptions||{},zmail.userOptions.isRailTime=t,$.publish("SETTINGS_TIME_FORMAT",t)}}),e.Setting=c,e.Constants=s},"MailSuite.Settings.Mail"),_defineSettingsModule("FolderListSortMode",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Mail.Persister"),a=t("Platform.System.Utils"),r=n.SettingManager,o="folder-list-sort-mode",s="alphabetical",c="user-preference",l={MODES:{ALPHABETICAL:s,USER_PREFERENCE:c},VALUE_MAP:{"user-preference":0,alphabetical:1},VALUE_REVERSE_MAP:{0:c,1:s}},u=r.create(o,{props:{defaultValue:s,options:[s,c]},persister:{errors:function(e){return"Error occurred ( E"+e+")"},fetch:function(){var e=a.makeDeferred(),t=l.VALUE_REVERSE_MAP[zmail.mailOpt.folSort];return e.resolve(t),e.promise()},save:function(){var e=a.makeDeferred();return i.save(o).done(e.resolve).fail(e.fail),e.resolve(),e.promise()}},type:"option",category:"mail"});u.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&(zmail.mailOpt=zmail.mailOpt||{},zmail.mailOpt.folSort=l.VALUE_MAP[e.changed.value])}),e.Setting=u,e.Constants=l},"MailSuite.Settings.Mail"),_defineSettingsModule("CommentBoxHide",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Mail.Persister"),a=t("Platform.System.Utils"),r=n.SettingManager,o="comment-box-hide-mode",s="show",c="hide",l=function(){var e=zmAdHocSettings.getCommentBoxView();return"0"===e&&!zmail.isOrg||zmail.isOrg&&"off"===e},u={MODES:{SHOW:s,HIDE:c},VALUE_MAP:{show:"on",hide:"off"},VALUE_REVERSE_MAP:{on:s,off:c}},p=r.create(o,{props:{defaultValue:u.VALUE_REVERSE_MAP[l()?"off":"on"],options:[s,c]},persister:{errors:function(e){return"Error occurred ( E"+e+")"},fetch:function(){var e=a.makeDeferred(),t=u.VALUE_REVERSE_MAP[l()?"off":"on"];return e.resolve(t),e.promise()},save:function(){var e=a.makeDeferred();return i.save(o).done(e.resolve).fail(e.fail),e.resolve(),e.promise()}},type:"option",category:"mail"});e.Setting=p,e.Constants=u},"MailSuite.Settings.Mail"),_defineSettingsModule("TagListSortMode",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Mail.Persister"),a=t("Platform.System.Utils"),r=n.SettingManager,o="tag-list-sort-mode",s="alphabetical",c="user-preference",l={MODES:{ALPHABETICAL:s,USER_PREFERENCE:c},VALUE_MAP:{"user-preference":0,alphabetical:1},VALUE_REVERSE_MAP:{0:c,1:s}},u=r.create(o,{props:{defaultValue:s,options:[s,c]},persister:{errors:function(e){return"Error occurred ( E"+e+")"},fetch:function(){var e=a.makeDeferred(),t=l.VALUE_REVERSE_MAP[zmail.mailOpt.labSort];return e.resolve(t),e.promise()},save:function(){var e=a.makeDeferred();return i.save(o).done(e.resolve).fail(e.fail),e.resolve(),e.promise()}},type:"option",category:"mail"});u.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&(zmail.mailOpt=zmail.mailOpt||{},zmail.mailOpt.labSort=l.VALUE_MAP[e.changed.value])}),e.Setting=u,e.Constants=l},"MailSuite.Settings.Mail"),_defineSettingsModule("CalendarServiceSetting",function(e,t){var n=t("Platform.Components"),i=t("Platform.System.Utils"),a=n.SettingManager,r="zcal",o="zcrm",s={MODES:{ZCAL:r,ZCRM:o},VALUE_MAP:{zcal:r,zcrm:o},VALUE_REVERSE_MAP:{zcal:"zcal",zcrm:"zcrm"}},c=a.create("calendar-service-setting",{props:{defaultValue:r,options:[r,o]},persister:{errors:function(e){return"Error occurred ( E"+e+")"},fetch:function(){var e=i.makeDeferred(),t=s.VALUE_MAP[zmAdHocSettings.getCalServiceName()];return e.resolve(t),e.promise()},save:function(){var e=i.makeDeferred();return zmAdHocSettings.setCalServiceName(c.get()),e.resolve(),e.promise()}},type:"option",category:"mail"});e.Setting=c,e.Constants=s},"MailSuite.Settings.Mail"),_defineSettingsModule("Cards",function(e,t){var n="event-mail-action",i=zmText.get("zm-settings-core","eventMailAction"),a=i.card,r=t("MailSuite.App"),o=t("Platform.Events.Base"),s=t("Platform.Components"),c=s.SettingCardManager,l=s.SettingCardItemManager,u=s.SettingManager,p=t("Platform.Entities").SettingCardItem.Types,d=c.create(n,{props:{openable:!0,title:a.title,addToSearch:!1},state:{hidden:!1},attributes:{category:"mail"},openAction:c.CardActions.OpenPageAction("event-mail-action")}),g=i.cardItems.mailEventSaveTarget,m=l.create("calendar-service-setting",{props:{title:g.cardItem.title,value:"...",addToSearch:!1},attributes:{type:p.LabelValue,card:n},primaryAction:function(){l.CardItemActions.OpenPageAction("event-mail-action",{showSection:"calendar-service-setting"})()}}),f=function(){var e=u.get("calendar-service-setting");return zmText.applyArgs(g.cardItem.values[e.get()],{companyName:zmail.globalI18N.companyName})};zmail.postJsDeffered.promise.then(function(){zmUtil.integStatusFetchProcess.then(function(){_zm.checkForCRMMailAddonUser().done(function(){window.zmail.isCRMMailAddonUser||d.setState({hidden:!0})})})}),u.get("calendar-service-setting").on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&m.setProp({value:f()})}),o.subscribeEvent(r,r.Events.OPEN,function(){m.setProp({value:f()})}),e.EventMailAction=d},"MailSuite"),_defineSettingsModule("MailViewOptions",function(e,t){var n,i=t("Platform.Components").SettingAppManager,a=t("Platform.System.Utils"),r=function(){return zmAppLoader.load("zm-settings-app-mailviewoptions")},o=function(){return t("MailSuite.Apps.MailViewOptions.AppCore")},s=function(){var e=a.makeDeferred();return r().then(function(){o().initialize({process:e})},function(){a.debugLog("Module load failed !!!"),e.reject()}),e.promise()},c=function(){var e=a.makeDeferred();return r().then(function(){o().uninitialize({process:e})}),e.promise()},l=function(){return o().getSettingsAppView()},u=function(){var e=o(),t=Array.prototype.slice.call(arguments);return e?e.handleContainerEvent.apply(this,t):null};n=i.create("mail-view-options",{attributes:{page:"mail-view-options",isReactApp:!0},initialize:s,uninitialize:c,getView:l,handleContainerEvent:u}),e.App=n},"MailSuite.Apps"),_defineSettingsModule("EventMailAction",function(e,t){var n,i=t("Platform.Components").SettingAppManager,a=t("Platform.System.Utils"),r=function(){return zmAppLoader.load("zm-settings-app-eventmailaction")},o=function(){return t("MailSuite.Apps.EventMailAction.AppCore")},s=function(){var e=a.makeDeferred();return r().done(function(){o().initialize({process:e})},function(){a.debugLog("Module load failed !!!"),e.reject()}),e.promise()},c=function(){var e=a.makeDeferred();return r().then(function(){o().uninitialize({process:e})}),e.promise()},l=function(){return o().getSettingsAppView()},u=function(){var e=o(),t=Array.prototype.slice.call(arguments);return e?e.handleContainerEvent.apply(this,t):null};n=i.create("event-mail-action",{attributes:{page:"event-mail-action",isReactApp:!0},initialize:s,uninitialize:c,getView:l,handleContainerEvent:u}),e.App=n},"MailSuite.Apps"),function(e){var t,n="mail-view-options",i="mail-reading-pane",a="read-receipt",r="load-external-images",o="display-time-format",s="folder-list-sort-mode",c="tag-list-sort-mode",l="sub-sum-mode",u="attachment-preference-mode",p=zmText.get("zm-settings-core","mailViewOptions").cardItems,d=e("Platform"),g=d.Components,m=d.Entities,f=e("MailSuite.Settings.Mail"),S=f.ReadingPane,v=f.ReadReceipt,A=f.LoadExternalImage,h=f.DisplayTimeFormat,y=f.FolderListSortMode,C=f.TagListSortMode,b=f.SubjectAndSummary,M=f.AttachmentPreference,P=g.SettingCardItemManager,E=m.SettingCardItem.Types,z=function(e,t){for(var n in t)if(t[n]===e)return n},w=function(e){e=e||S.Setting.get();var t=z(e,S.Constants.MODES);return p.readingPane.modes[t]},O=P.create(i,{props:{title:p.readingPane.cardItem.title,value:w()},attributes:{type:E.LabelValue,card:n},primaryAction:function(){P.CardItemActions.OpenPageAction("mail-view-options",{showSection:"reading-pane"})()}}),I=function(e){e=e||v.Setting.get();var t=z(e,v.Constants.MODES);return p.readReceipt.modes[t]},T=P.create(a,{props:{title:p.readReceipt.cardItem.title,value:I()},attributes:{type:E.LabelValue,card:n},primaryAction:function(){P.CardItemActions.OpenPageAction("mail-view-options",{showSection:"read-receipt"})()}}),D=function(e){e=e||A.Setting.get();var t=z(e,A.Constants.MODES);return p.loadExternalImages.modes[t]},k=P.create(r,{props:{title:p.loadExternalImages.cardItem.title,value:D()},attributes:{type:E.LabelValue,card:n},primaryAction:function(){P.CardItemActions.OpenPageAction("mail-view-options",{showSection:"load-external-images"})()}}),_=function(e){e=e||h.Setting.get();var t=z(e,h.Constants.MODES);return p.displayTimeFormat.modes[t]},R=P.create(o,{props:{title:p.displayTimeFormat.cardItem.title,value:_()},attributes:{type:E.LabelValue,card:n},primaryAction:function(){P.CardItemActions.OpenPageAction("mail-view-options",{showSection:"time-format"})()}}),L=function(e){e=e||y.Setting.get();var t=z(e,y.Constants.MODES);return p.folderListSortMode.modes[t]},V=P.create(s,{props:{title:p.folderListSortMode.cardItem.title,value:L()},attributes:{type:E.LabelValue,card:n},primaryAction:function(){P.CardItemActions.OpenPageAction("mail-view-options",{showSection:"folder-list-sort-mode"})()}}),N=function(e){e=e||C.Setting.get();var t=z(e,C.Constants.MODES);return p.tagListSortMode.modes[t]},H=P.create(c,{props:{title:p.tagListSortMode.cardItem.title,value:N()},attributes:{type:E.LabelValue,card:n},primaryAction:function(){P.CardItemActions.OpenPageAction("mail-view-options",{showSection:"tag-list-sort-mode"})()}}),F=function(e){e=e||b.Setting.get();var t=z(e,b.Constants.MODES);return p.subjectAndSummaryMode.modes[t]},x=P.create(l,{props:{title:p.subjectAndSummaryMode.cardItem.title,value:F()},attributes:{type:E.LabelValue,card:n},primaryAction:function(){P.CardItemActions.OpenPageAction("mail-view-options",{showSection:"sub-sum-mode"})()}}),U=function(e){e=e||M.Setting.get();var t=z(e,M.Constants.MODES);return p.AttachmentPreference.modes[t]};t=P.create(u,{props:{title:p.AttachmentPreference.cardItem.title,value:U()},attributes:{type:E.LabelValue,card:n},primaryAction:function(){P.CardItemActions.OpenPageAction("mail-view-options",{showSection:"attachment-preference-mode"})()}});S.Setting.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&O.setProp({value:w(e.changed.value)})}),v.Setting.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&T.setProp({value:I(e.changed.value)})}),A.Setting.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&k.setProp({value:D(e.changed.value)})}),h.Setting.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&R.setProp({value:_(e.changed.value)})}),y.Setting.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&V.setProp({value:L(e.changed.value)})}),b.Setting.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&x.setProp({value:F(e.changed.value)})}),M.Setting.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&t.setProp({value:U(e.changed.value)})}),C.Setting.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&H.setProp({value:N(e.changed.value)})})}(zmail.Settings.Modules.import),function(e){var t="mail-view-options",n="mail-reading-pane",i="read-receipt",a="load-external-images",r="display-time-format",o=zmText.get("zm-settings-core","mailViewOptions.quickNavigatorItems"),s="mail-view-options",c="reading-pane",l="read-receipt",u="load-external-images",p="time-format",d=e("Platform.Components"),g=d.QuickNavigatorSectionManager,m=d.QuickNavigatorItemManager;g.create(t,{props:{title:o.sectionTitle},state:{selected:!1}}),m.create(n,{props:{title:o.readingPane,linkedPage:s,linkedPageSection:c,selectable:!0},attributes:{section:t}}),m.create(i,{props:{title:o.readReceipt,linkedPage:s,linkedPageSection:l,selectable:!0},attributes:{section:t}}),m.create(a,{props:{title:o.loadExternalImages,linkedPage:s,linkedPageSection:u,selectable:!0},attributes:{section:t}}),m.create(r,{props:{title:o.displayTimeFormat,linkedPage:s,linkedPageSection:p,selectable:!0},attributes:{section:t}})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(e,t){var n="compose-settings",i=t("Platform.Components"),a=t("Platform.Entities"),r=zmText.get("zm-settings-core","compose").page,o=i.SettingPageManager,s=a.SettingPage.Types,c=o.create(n,{props:{title:r.title},attributes:{type:s.PageAlone,card:n,pageContainerClassNames:"zmSetPage",category:"mail",pageCSSClass:"zmSetNPwra"},onComponentCreate:function(e){var t=e._view.refs.settingsContainer;$.e(t).on("scroll",function(){zmUtil.hideMenu()})}});e.Compose=c},"MailSuite"),_defineSettingsModule("Cards",function(e,t){var n={cardTitle:zmText.get("zm-settings-core","compose").card.title},i=t("Platform.Components").SettingCardManager,a=i.create("compose-settings",{props:{openable:!0,title:n.cardTitle},attributes:{category:"mail"},openAction:i.CardActions.OpenPageAction("compose-settings")});e.Compose=a},"MailSuite"),_defineSettingsModule("ComposeTarget",function(e,t){var n=t("Platform.Components"),r=t("Platform.System.Utils"),i=n.SettingManager,o="compose-target",a={ALLOWED_VALUES:[0,1,2],TARGET_MODE:{0:"window",1:"tab",2:"inline"}},s={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(zmail.userOptions.composeView),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t);var i={settings:JSON.stringify({composeView:e}),mode:"composeVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.composeView=t.value,n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}},c=i.create(o,{props:{defaultValue:zmail.userOptions.composeView,options:[0,1,2]},persister:s,type:"option",category:"compose"});c.initialize(),e.Setting=c,e.Constants=a},"MailSuite.Settings.Compose"),_defineSettingsModule("ContentEncoding",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-content-encoding",i=function(){return zmail.userOptions.encodings},a={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(zmail.userOptions.encoding),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t);var i={settings:JSON.stringify({encoding:e}),mode:"composeVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.encoding=t.value,n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}},s={allowedValues:i()},c=n.create(o,{props:{defaultValue:"UTF-8",options:i()},persister:a,type:"option",category:"compose"});c.initialize(),e.Setting=c,e.Constants=s},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeEditorMode",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-editor-mode",s={plaintext:0,richtext:1,mailBasedPlain:3,mailBasedRich:4},i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(Boolean(zmail.cmpdata.HTML_ENABLED)),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t),void 0!==s[e]&&(e=s[e]);var i={mode:"editor",etype:e},a={etype:e};return zmAjq.XHR({u:zmail.conPath+"/chgEditor.do",t:"POST",fn:function(e,t){zmail.cmpdata.HTML_ENABLED=t.etype,n.resolve()},p:i,ep:a,csr:"s"}),n.promise()}},a=n.create(o,{props:{defaultValue:1},persister:i,category:"compose"});a.initialize(),e.Setting=a},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeFontFamily",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-font-family",i=function(){return zmail.userOptions.composeFonts.slice()},a={allowedValues:i()},s={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),"Default"===zmail.userOptions.fontFamily&&(zmail.userOptions.fontFamily="Arial"),t.resolve(zmail.userOptions.fontFamily),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t);var i={settings:JSON.stringify({fontFamily:e}),mode:"composeVO"},a={value:e,opts:t};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){t.opts.hasOwnProperty("customFont")||(zmail.userOptions.fontFamily=t.value),n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}},c=n.create(o,{props:{defaultValue:zmail.userOptions.fontFamily},persister:s,category:"compose"});c.initialize(),e.Setting=c,e.Constants=a,e.fontFamilyList=i},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeFontSize",function(e,t){var n=t("Platform.Components"),r=t("Platform.System.Utils"),i=n.SettingManager,o="compose-font-size",a={allowedValues:[8,10,12,14,18,24,36,"custom"]},s={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(zmail.userOptions.fontSize),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t);var i={settings:JSON.stringify({fontSize:e}),mode:"composeVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.fontSize=t.value,n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}},c=i.create(o,{props:{defaultValue:zmail.userOptions.fontSize,options:function(){for(var e=[],t=8;t<100;)e.push(t),t+=.5;return e}()},persister:s,type:"option",category:"compose"});c.initialize(),e.Setting=c,e.Constants=a},"MailSuite.Settings.Compose"),_defineSettingsModule("AutoAddContacts",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-auto-add-contacts",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(Boolean(zmail.userOptions.autoAddContacts)),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t),e=e?1:0;var i={settings:JSON.stringify({autoAddContacts:e}),mode:"composeVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.composeView=t.value,n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}},a=n.create(o,{props:{defaultValue:!0},persister:i,type:"boolean",category:"compose"});a.initialize(),e.Setting=a},"MailSuite.Settings.Compose"),_defineSettingsModule("OutboxDelayDuration",function(e,t){var n=t("Platform.Components"),i=t("Platform.Validators.Basic"),o=t("Platform.System.Utils"),a=n.SettingManager,s=t("MailSuite.Settings.Compose"),r={range:{max:120,min:-120}},c="compose-outbox-delay-duration",l={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=o.makeDeferred();return o.debugLog("fetching mail-setting "+c,e),t.resolve(zmail.userOptions.outboxInterval),t.promise()},save:function(e,t){var n=o.makeDeferred();o.debugLog("saving "+c,e,t);var i=s.OutboxDelayDuration.Setting.get(),a={settings:JSON.stringify({outboxInterval:i,outboxIntervalUnit:s.OutboxDelayDuration.Setting.getProp("customProp")}),mode:"composeVO"},r={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.outboxInterval=t.value,n.resolve(t.value)},p:a,csr:"s",ep:r}),n.promise()}},u=a.create(c,{props:{defaultValue:-1,customProp:zmail.userOptions.outboxIntervalUnit},persister:l,validations:[{validator:i.RangeValidator,opts:r.range}],type:"default",category:"compose"});u.initialize(),e.Setting=u,e.Constants=r},"MailSuite.Settings.Compose"),_defineSettingsModule("OutboxDelayState",function(e,t){var n=t("Platform.Components"),i=t("MailSuite.Settings.Compose").OutboxDelayDuration.Setting,a=n.SettingManager.create("compose-outbox-delay-state",{props:{defaultValue:!1,customProp:zmail.userOptions.outboxIntervalUnit},type:"boolean",category:"compose"});a.initialize({value:0<i.get()}),e.Setting=a;i.on("props.change",function(e){"undefined"!==e.changed.customProp?a.set(e.changed.customProp,{customProp:!0}):a.set(0<e.changed.value)}),a.on("props.change",function(e){var t=i.get("value");e.changed.value&&0<t||(e.changed.value?t<0&&(t=-t):0<t&&(t=-t),i.set(t))})},"MailSuite.Settings.Compose"),_defineSettingsModule("AskReceipt",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-ask-receipt",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(Boolean(zmail.cmpdata.ASKRECEIPT)),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t),e=e?1:0;var i={settings:JSON.stringify({askReceipt:e}),mode:"composeVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.askReceipt=t.value,n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}},a=n.create(o,{props:{defaultValue:Boolean(zmail.cmpdata.ASKRECEIPT)},persister:i,type:"boolean",category:"compose"});a.initialize(),e.Setting=a},"MailSuite.Settings.Compose"),_defineSettingsModule("hugeAttachment",function(e,t){var n=t("Platform.Components").SettingManager,i=t("Platform.System.Utils"),a="compose-huge-attachment",r={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=i.makeDeferred();return i.debugLog("fetching mail-setting "+a,e),t.promise()},save:function(e,t){var n=i.makeDeferred();return i.debugLog("saving "+a,e,t),n.promise()}},o=n.create(a,{props:{defaultValue:0},persister:r,type:"boolean",category:"compose"});o.initialize(),e.Setting=o},"MailSuite.Settings.Compose"),_defineSettingsModule("ShowCC",function(e,t){var n=t("Platform.Components").SettingManager,a=t("Platform.System.Utils"),r="compose-show-cc",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=a.makeDeferred();a.debugLog("fetching mail-setting "+r,e);var n="1"===zmAdHocSettings.getShowCCOption();return t.resolve(n),t.promise()},save:function(e,t){var n=a.makeDeferred();a.debugLog("saving "+r,e,t);var i="0";return e&&(i="1"),zmAdHocSettings.setShowCCOption(i),n.resolve(e),n.promise()}},o=n.create(r,{props:{defaultValue:"1"===zmAdHocSettings.getShowCCOption()},persister:i,type:"boolean",category:"compose"});o.initialize(),e.Setting=o},"MailSuite.Settings.Compose"),_defineSettingsModule("ShowBCC",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-show-bcc",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(Boolean(zmail.cmpdata.SHOWBCC)),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t),e=e?1:0;var i={settings:JSON.stringify({showBcc:e}),mode:"composeVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.showBCC=t.value,zmail.cmpdata.SHOWBCC=t.value,n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}},a=n.create(o,{props:{defaultValue:Boolean(zmail.cmpdata.SHOWBCC)},persister:i,type:"boolean",category:"compose"});a.initialize(),e.Setting=a},"MailSuite.Settings.Compose"),_defineSettingsModule("SuggestContacts",function(e,t){var n=t("Platform.Components").SettingManager,a=t("Platform.System.Utils"),r="compose-suggest-contacts",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=a.makeDeferred();a.debugLog("fetching mail-setting "+r,e);var n="1"===zmAdHocSettings.getContactsSuggestionType();return t.resolve(n),t.promise()},save:function(e,t){var n=a.makeDeferred();a.debugLog("saving "+r,e,t);var i="0";return e&&(i="1"),zmAdHocSettings.setContactsSuggestionType(i),n.resolve(e),n.promise()}},o=n.create(r,{props:{defaultValue:"1"===zmAdHocSettings.getContactsSuggestionType()},persister:i,type:"boolean",category:"compose"});o.initialize(),e.Setting=o},"MailSuite.Settings.Compose"),_defineSettingsModule("ReminderPrompt",function(e,t){var n=t("Platform.Components").SettingManager,a=t("Platform.System.Utils"),r="compose-reminder-prompt",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=a.makeDeferred();a.debugLog("fetching mail-setting "+r,e);var n="1"===zmAdHocSettings.getReminderWarningState();return t.resolve(n),t.promise()},save:function(e,t){var n=a.makeDeferred();a.debugLog("saving "+r,e,t);var i="0";return e&&(i="1"),zmAdHocSettings.setReminderWarningState(i),n.resolve(e),n.promise()}},o=n.create(r,{props:{defaultValue:"1"===zmAdHocSettings.getReminderWarningState()},persister:i,type:"boolean",category:"compose"});o.initialize(),e.Setting=o},"MailSuite.Settings.Compose"),_defineSettingsModule("UndoSendInterval",function(e,t){var n=t("Platform.Components"),i=t("Platform.Validators.Basic"),s=t("Platform.System.Utils"),a=n.SettingManager,r={range:{max:30,min:-30,allowed:5}},c="compose-undo-send-interval",o={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=s.makeDeferred();return s.debugLog("fetching mail-setting "+c,e),-1===zmail.userOptions.undoInterval&&(zmail.userOptions.undoInterval=-5),t.resolve(zmail.userOptions.undoInterval),t.promise()},save:function(e,t){var n,i=s.makeDeferred();s.debugLog("saving "+c,e,t);var a=-1;!0===t.undoSendState&&(a=e),(n=a)<0&&(n=-zmail.userOptions.undoInterval),0<n&&n<5&&(n=a=5);var r={mode:"composeVO",settings:JSON.stringify({undoInterval:a})},o={value:n};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.undoInterval=t.value,i.resolve(t.value)},p:r,csr:"s",ep:o,setSessionId:!0}),i.promise()}},l=a.create(c,{props:{defaultValue:-1},persister:o,validations:[{validator:i.RangeValidator,opts:r.range}],type:"default",category:"compose"});l.initialize(),e.Setting=l,e.Constants=r},"MailSuite.Settings.Compose"),_defineSettingsModule("TextDirection",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-textdirection",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(Boolean(zmail.userOptions.typeOption)),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t),e=e?1:0;var i={mode:"composeVO",settings:JSON.stringify({typeOption:e})},a={type:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.typeOption=t.type,n.resolve()},p:i,ep:a,csr:"s"}),n.promise()}},a=n.create(o,{props:{defaultValue:0},persister:i,type:"boolean",category:"compose"});a.initialize(),e.Setting=a},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeFontColor",function(e,t){var n,i=t("Platform.Components"),r=t("Platform.System.Utils"),a=i.SettingManager,o="compose-font-color",s={allowedValues:["#ffffff","#cceeff","#ccccff","#e5ccff","#ffccff","#ffccee","#ffcccc","#ffe5cc","#ffffcc","#ccffcc","#ccffff","#cccccc","#99ccff","#9999ff","#cc99ff","#ff99ff","#ff99cc","#ff9999","#ffcc99","#ffff99","#99ff99","#99ffff","#c0c0c0","#66ccff","#6666ff","#b266ff","#ff66fe","#ff66b2","#ff6666","#ffb266","#feff66","#66ff66","#66feff","#999999","#399cfd","#3333ff","#9933ff","#ff33fe","#ff3398","#ff3333","#ff9933","#feff33","#33ff33","#33feff","#666666","#3399ff","#0000ff","#7700ff","#ff00ee","#ff0077","#ff0000","#ff7f00","#feff00","#00ff00","#00feff","#cc00cc","#444444","#0065cc","#0000cc","#6600cc","#cc00cb","#cc0000","#cc6600","#cbcc00","#00cc00","#00cbcc","#333333","#004c99","#000099","#4B0099","#990098","#99004c","#990000","#994c00","#989900","#009900","#009899","#000000","#003366","#000066","#330066","#660066","#660032","#660000","#663300","#666600","#006600","#006666"]},c={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(zmail.userOptions.fontColor),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t);var i={settings:JSON.stringify({fontColor:e}),mode:"composeVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.fontColor=t.value,n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}};(n=a.create(o,{props:{defaultValue:zmail.userOptions.fontColor},persister:c,category:"compose"})).initialize(),e.Setting=n,e.Constants=s},"MailSuite.Settings.Compose"),function(e){var t=(0,zmail.Settings.Modules["import"])("MailSuite.Settings.Compose"),n=t.AutoAddContacts.Setting,i=t.OutboxDelayDuration.Setting,a=t.ComposeFontSize.Setting,r=t.ComposeFontFamily.Setting,o=t.ContentEncoding.Setting,s=t.ComposeTarget.Setting,c=t.AskReceipt.Setting,l=t.ShowBCC.Setting,u=t.SuggestContacts.Setting,p="CS_ADD_RECIPIENTS_CHANGED",d="CS_EDITOR_TYPE_CHANGED",g="CS_ENCODING_CHANGED",m="CS_FONT_FAMILY_CHANGED",f="CS_FONT_SIZE_CHANGED",S="CS_SENDING_DELAY_CHANGED",v="CS_ASK_RECEIPT_CHANGED",A="CS_SHOW_BCC_CHANGED",h="CS_SUGGEST_CONTACTS_CHANGED",y=function(t){return function(e){(e=e||{}).changed.hasOwnProperty("value")&&$.publish(t,e.changed.value)}};i.props.on("change",y(S)),n.props.on("change",y(p)),a.props.on("change",y(f)),r.props.on("change",y(m)),o.props.on("change",y(g)),s.props.on("change",y(d)),c.props.on("change",y(v)),l.props.on("change",y(A)),u.props.on("change",y(h))}(),_defineSettingsModule("QuotedLinePosition",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-quotedlineposition",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(Boolean(zmail.userOptions.quotedLinePosition)),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t),e=e?1:0;var i={mode:"viewVO",settings:JSON.stringify({quotedLinePosition:e})},a={type:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.quotedLinePosition=t.type,n.resolve()},p:i,ep:a,csr:"s"}),n.promise()}},a=n.create(o,{props:{defaultValue:0},persister:i,type:"boolean",category:"compose"});a.initialize(),e.Setting=a},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeMessageReply",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-replymessageto",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(Boolean(zmail.userOptions.replyFrom)),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t),e=e?1:0;var i={mode:"composeVO",settings:JSON.stringify({replyFrom:e})},a={type:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.replyFrom=t.type,n.resolve()},p:i,ep:a,csr:"s"}),n.promise()}},a=n.create(o,{props:{defaultValue:0},persister:i,type:"boolean",category:"compose"});a.initialize(),e.Setting=a},"MailSuite.Settings.Compose"),_defineSettingsModule("ComposeModeWhenReply",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="compose-editor-mode",s={plaintext:0,richtext:1,mailBasedPlain:3,mailBasedRich:4},i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(zmail.userOptions.htmlenabled),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t),0===s[e]?4===zmail.userOptions.htmlenabled&&(e="mailBasedPlain"):1===s[e]&&3===zmail.userOptions.htmlenabled&&(e="mailBasedRich"),e=s[e];var i={mode:"composeVO",settings:JSON.stringify({htmlenabled:e})},a={htmlEnabled:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.htmlenabled=t.htmlEnabled,n.resolve()},p:i,ep:a,csr:"s"}),n.promise()}},a=n.create(o,{props:{defaultValue:1},persister:i,category:"compose"});a.initialize(),e.Setting=a},"MailSuite.Settings.Compose"),function(e){var t,n="compose-settings",i="compose-settings",a="compose-target",r="compose-encoding",o="auto-add-contacts",s="compose-font-family",c="compose-font-size",l="compose-outbox-delay-duration",u="compose-show-bcc",p="undo-send",d="text-direction",g="compose-editor-mode",m="quoted-line-position",f="composemode-when-reply",S="when-replyto-message",v=zmText.get("zm-settings-core","compose.cardItems"),A=e("Platform.Components"),h=e("Platform.Entities"),y=e("MailSuite.Settings.Compose"),C=y.ComposeTarget,b=y.ContentEncoding,M=y.AutoAddContacts,P=y.ComposeFontFamily,E=y.ComposeFontSize,z=y.OutboxDelayDuration,w=y.ShowBCC,O=A.SettingCardItemManager,I=h.SettingCardItem.Types,T=C.Setting,D=b.Setting,k=M.Setting,_=P.Setting,R=E.Setting,L=z.Setting,V=w.Setting,N=C.Constants.TARGET_MODE,H="props.change",F=function(e){e=e||T.get();var t=N[e];return v.composeTarget.targetModes[t]},x=function(e){return void 0===e&&(e=L.get()),e<=0?v.outboxDelayDuration.valueNotSet:1===zmail.userOptions.outboxIntervalUnit?e+" "+v.outboxDelayDuration.minutes:e+" "+v.outboxDelayDuration.seconds},U=O.create(a,{props:{title:v.composeTarget.cardItem.title,value:F()},attributes:{type:I.LabelValue,card:n},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:a})}),B=O.create(r,{props:{title:v.contentEncoding.cardItem.title,value:D.get()},attributes:{type:I.LabelValue,card:n},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:r})}),Z=O.create(s,{props:{title:v.composeFontFamily.cardItem.title,value:_.get()},attributes:{type:I.LabelValue,card:n},searchCommand:{title:v.composeFontFamily.searchCommand.title},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:s})}),G=O.create(c,{props:{title:v.composeFontSize.cardItem.title,value:R.get()},attributes:{type:I.LabelValue,card:n},searchCommand:{title:v.composeFontSize.searchCommand.title},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:c})}),q=O.create(l,{props:{title:v.outboxDelayDuration.cardItem.title,value:x(),outboxIntervalUnit:zmail.userOptions.outboxIntervalUnit},attributes:{type:I.LabelValue,card:n},transformer:function(e,t){t=t||{},"props"===e&&t.hasOwnProperty("value")&&(t.value=x(t.value))},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:c})}),j=O.create(o,{props:{title:v.autoAddContacts.cardItem.title},attributes:{type:I.LabelAction,card:n},transformer:function(e,t){return t=t||{},"props"===e&&t.hasOwnProperty("value")&&(t.value=!0===t.value?v.autoAddContacts.enabled:v.autoAddContacts.disabled),t},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:o}),secondaryAction:function(){var e=k,t=!0!==e.get();e.set(t)}}),K=O.create(p,{props:{title:"",showInCard:!1},attributes:{type:I.LabelValue,card:n},searchCommand:{title:v.undoSend.cardItem.title},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:p})});O.create(d,{props:{title:"",showInCard:!1},attributes:{type:I.LabelValue,card:n},searchCommand:{title:v.textDirection.cardItem.searchCommand},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:d})}),O.create(S,{props:{title:"",showInCard:!1},attributes:{type:I.LabelValue,card:n},searchCommand:{title:v.textDirection.cardItem.searchCommand},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:S})}),O.create(g,{props:{title:"",showInCard:!1},attributes:{type:I.LabelValue,card:n},searchCommand:{title:v.editorMode.cardItem.searchCommand},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:g})}),zmail.showFeature&&O.create(f,{props:{title:"",showInCard:!1},attributes:{type:I.LabelValue,card:n},searchCommand:{title:"Compose Mode while reply"},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:f})}),zmail.showFeature&&O.create(m,{props:{title:"",showInCard:!1},attributes:{type:I.LabelValue,card:n},searchCommand:{title:"quoted line position"},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:m})}),zmail.policyBasedHiddenItems.isBCCEnabled&&(t=O.create(u,{props:{title:v.showBcc.cardItem.title},attributes:{type:I.LabelAction,card:n},transformer:function(e,t){return t=t||{},"props"===e&&t.hasOwnProperty("value")&&(t.value=!0===t.value?v.showBcc.disabled:v.showBcc.enabled),t},primaryAction:O.CardItemActions.OpenPageAction(i,{showSection:o}),secondaryAction:function(){var e=V,t=!0!==e.get();e.set(t)}}));zmail.Settings.composeOptions=q,zmail.Settings.UndoSend=K,T.on(H,function(e){(e=e||{}).changed.hasOwnProperty("value")&&U.setProp({value:F(e.changed.value)})}),D.on(H,function(e){(e=e||{}).changed.hasOwnProperty("value")&&B.setProp({value:e.changed.value})}),_.on(H,function(e){(e=e||{}).changed.hasOwnProperty("value")&&Z.setProp({value:e.changed.value})}),R.on(H,function(e){(e=e||{}).changed.hasOwnProperty("value")&&G.setProp({value:e.changed.value})}),L.on(H,function(e){if((e=e||{}).changed.hasOwnProperty("value"))q.setProp({value:x(e.changed.value)});else if(e.changed.hasOwnProperty("customProp")){zmail.userOptions.outboxIntervalUnit=e.changed.customProp;var t=L.get("value");q.setProp({value:x(t)})}}),O.bindSetting(j,k),zmail.policyBasedHiddenItems.isBCCEnabled&&O.bindSetting(t,V)}(zmail.Settings.Modules.import),function(a){var n,e,t,i="compose-settings",r="compose-target",o="compose-encoding",s="compose-editor-mode",c="auto-add-contacts",l="compose-font",u="outbox-inteval",p="compose-ask-receipt",d="compose-show-cc",g="compose-reminder-prompt",m="compose-show-bcc",f="compose-suggest-contacts",S="huge-attachment",v="undo-send",A="text-direction",h="quoted-line-position",y="composemode-when-reply",C="when-replyto-message",b="sa-compose-target",M="sa-compose-encoding",P="compose-editor-mode",E="sa-auto-add-contacts",z="compose-font",w="outbox-interval",O="compose-ask-receipt",I="compose-show-cc",T="compose-reminder-prompt",D="compose-show-bcc",k="compose-suggest-contacts",_="huge-attachment",R="undo-send",L="text-direction",V="quoted-line-position",N="composemode-when-reply",H="when-replyto-message",F="change:toggleSwitchActive",x="zm-settings-app-composesettings",U=zmText.get("zm-settings-core","compose.page"),B=a("Platform.Components"),Z=a("Platform.Entities").SettingPageSection,G=B.SettingAppManager,q=Z.Types,j=B.SettingPageSectionManager,K=a("MailSuite.Settings.Compose"),W=K.AutoAddContacts.Setting,X=K.OutboxDelayDuration.Setting,J=K.OutboxDelayState.Setting,Y=K.AskReceipt.Setting,Q=K.ShowCC.Setting,ee=K.ReminderPrompt.Setting,te=K.ShowBCC.Setting,ne=K.SuggestContacts.Setting,ie=K.UndoSendInterval.Setting,ae=K.ComposeEditorMode.Setting,re=K.TextDirection.Setting,oe=K.QuotedLinePosition.Setting,se=K.ComposeModeWhenReply.Setting,ce=K.ComposeMessageReply.Setting,le=function(){return zmAppLoader.load(x)},ue=zmail.policyBasedHiddenItems.isBCCEnabled;j.create(r,{props:{title:U.section.composeTarget.title},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.composeTarget.quickLink,linkedPage:i,linkedPageSection:r,selectable:!0},attributes:{section:i}}}),j.create(o,{props:{title:U.section.defaultEncoding.title},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.defaultEncoding.quickLink,linkedPage:i,linkedPageSection:o,selectable:!0},attributes:{section:i}}}),zmail.showFeature&&j.create(h,{props:{title:"Quoted line"},attributes:{page:i,type:q.PageAlone,appContainer:!0}}),j.create(s,{props:{title:U.section.editorMode.title},attributes:{page:i,type:q.PageAlone,appContainer:!0}}),j.create(C,{props:{title:U.section.replyFromSetting.title},attributes:{page:i,type:q.PageAlone,appContainer:!0}}),zmail.showFeature&&j.create(y,{props:{title:U.section.composeModeWhenReply.header},attributes:{page:i,type:q.PageAlone,appContainer:!0}}),j.create(A,{props:{title:U.section.textDirection.title},attributes:{page:i,type:q.PageAlone,appContainer:!0}}),j.create(l,{props:{title:U.section.fontOptions.title},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.fontOptions.quickLink,linkedPage:i,linkedPageSection:l,selectable:!0},attributes:{section:i}}});var pe=j.create(u,{props:{title:U.section.outboxDelay.title,toggleSwitchFlex:!0,toggleSwitchOnText:U.section.toggleSwitch.on,toggleSwitchOffText:U.section.toggleSwitch.off,toggleSwitchActive:0<X.get()},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.outboxDelay.quickLink,linkedPage:i,linkedPageSection:u,selectable:!0},attributes:{section:i}}});e=j.create(v,{props:{title:U.section.undosend.title,toggleSwitchFlex:!0,toggleSwitchOnText:U.section.toggleSwitch.on,toggleSwitchOffText:U.section.toggleSwitch.off,toggleSwitchActive:0<zmail.userOptions.undoInterval},attributes:{page:i,type:q.PageAlone,appContainer:!0}});var de=j.create(c,{props:{title:U.section.autoAddContacts.title,toggleSwitchFlex:!0,toggleSwitchOnText:U.section.toggleSwitch.on,toggleSwitchOffText:U.section.toggleSwitch.off,toggleSwitchActive:W.get()},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.autoAddContacts.quickLink,linkedPage:i,linkedPageSection:c,selectable:!0},attributes:{section:i}}}),ge=j.create(p,{props:{title:U.section.askReceipt.title,toggleSwitchFlex:!0,toggleSwitchOnText:U.section.toggleSwitch.on,toggleSwitchOffText:U.section.toggleSwitch.off,toggleSwitchActive:!Y.get()},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.askReceipt.quickLink,linkedPage:i,linkedPageSection:p,selectable:!0},attributes:{section:i}}}),me=j.create(d,{props:{title:U.section.showCc.title,toggleSwitchFlex:!0,toggleSwitchOnText:U.section.toggleSwitch.on,toggleSwitchOffText:U.section.toggleSwitch.off,toggleSwitchActive:!Q.get()},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.showCc.quickLink,linkedPage:i,linkedPageSection:d,selectable:!0},attributes:{section:i}}});Q.props.on("change",function(e){e.changed.hasOwnProperty("value")&&me.setProp({toggleSwitchActive:!e.changed.value})}),me.props.on(F,function(e){var t=e.changed.toggleSwitchActive;Q.set(!t)}),t=j.create(m,{props:{title:U.section.showBcc.title,toggleSwitchFlex:!0,showSection:ue,toggleSwitchOnText:U.section.toggleSwitch.on,toggleSwitchOffText:U.section.toggleSwitch.off,toggleSwitchActive:!te.get()},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.showBcc.quickLink,linkedPage:i,linkedPageSection:m,selectable:!0},attributes:{section:i}}});var fe=j.create(f,{props:{title:U.section.suggestContacts.title,toggleSwitchFlex:!0,toggleSwitchOnText:U.section.toggleSwitch.on,toggleSwitchOffText:U.section.toggleSwitch.off,toggleSwitchActive:!ne.get()},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.suggestContacts.quickLink,linkedPage:i,linkedPageSection:f,selectable:!0},attributes:{section:i}}});ne.props.on("change",function(e){e.changed.hasOwnProperty("value")&&fe.setProp({toggleSwitchActive:!e.changed.value})}),fe.props.on(F,function(e){var t=e.changed.toggleSwitchActive;ne.set(!t)});var Se=j.create(g,{props:{title:U.section.reminderPrompt.title,toggleSwitchFlex:!0,toggleSwitchOnText:U.section.toggleSwitch.on,toggleSwitchOffText:U.section.toggleSwitch.off,toggleSwitchActive:!ee.get()},attributes:{page:i,type:q.PageAlone,appContainer:!0},quickNavigation:{props:{title:U.section.showCc.quickLink,linkedPage:i,linkedPageSection:d,selectable:!0},attributes:{section:i}}});ee.props.on("change",function(e){e.changed.hasOwnProperty("value")&&Se.setProp({toggleSwitchActive:!e.changed.value})}),Se.props.on(F,function(e){var t=e.changed.toggleSwitchActive;ee.set(!t)});var ve=function(){return le()},Ae=function(){return le()},he=function(){return a("MailSuite.Settings.Compose.Views").getComposeTargetComponent()};!function(){if(G.create(b,{attributes:{pageSection:r,isReactApp:!0},initialize:ve,uninitialize:Ae,getView:he,handleContainerEvent:function(){}}),G.create(M,{attributes:{pageSection:o,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getContentEncodingComponent()},handleContainerEvent:function(){}}),G.create(P,{attributes:{pageSection:s,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){var e=a("MailSuite.Settings.Compose.Views"),t=U.section.editorMode.modes,n="richtext";0!==zmail.cmpdata.HTML_ENABLED&&3!==zmail.cmpdata.HTML_ENABLED||(n="plaintext");var i={initialSelected:n,onSelect:function(e){ae.set(e)},options:[{id:"richtext",title:t.richText},{id:"plaintext",title:t.plainText}]};return e.getComposeEditorMode(i)}}),zmail.showFeature&&G.create(N,{attributes:{pageSection:y,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){var e=a("MailSuite.Settings.Compose.Views"),t="richtext";0!==zmail.userOptions.htmlenabled&&3!==zmail.userOptions.htmlenabled||(t="plaintext");var n=U.section.composeModeWhenReply,i={initialSelected:t,onSelect:function(e){se.set(e)},options:[{id:"richtext",title:n.rich},{id:"plaintext",title:n.plain}]};return e.getComposeModeReply(i)}}),G.create(z,{attributes:{pageSection:l,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getComposeFontComponent()},handleContainerEvent:function(){}}),zmUtil.sendHugeAttEnabledReq().then(function(){zmUtil.isHugeAttachmentUploadEnabled()&&(j.create(S,{props:{title:U.section.hugeAttachment.title},attributes:{page:i,type:q.PageAlone,appContainer:!0}}),G.create(_,{attributes:{pageSection:S,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){var e=a("MailSuite.Settings.Compose.Views"),t=U.section.hugeAttachment.modes,n=zmAdHocSettings.getAttachComp().hugeAttPref;n||(n="askMe");var i={initialSelected:n,onSelect:function(e){zmAdHocSettings.setAttachComp({hugeAttPref:e})},options:[{id:"askMe",title:t.ask},{id:"yes",title:t.yes},{id:"no",title:t.no}]};return e.getHugeAttachment(i)}}))}),G.create(L,{attributes:{pageSection:A,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){var e=a("MailSuite.Settings.Compose.Views"),t=U.section.textDirection.modes,n="ltr";1===zmail.userOptions.typeOption&&(n="rtl");var i={initialSelected:n,onSelect:function(e){re.set(!re.get())},options:[{id:"ltr",title:t.ltr},{id:"rtl",title:t.rtl}]};return e.getTextDirection(i)}}),n=G.create(H,{attributes:{pageSection:C,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){var e=a("MailSuite.Settings.Compose.Views"),t=U.section.replyFromSetting.modes,n="sameaddress";1===zmail.userOptions.replyFrom&&(n="defaultaddress");var i={initialSelected:n,onSelect:function(e){ce.set(!ce.get())},options:[{id:"sameaddress",title:t.newAddress},{id:"defaultaddress",title:React.createElement(React.Fragment,null,t.default," ",React.createElement("b",null,"("+zmail.cmpdata.DEFFRM_ADDR+")"))}]};return e.getWhenReplyToMessage(i)}}),G.create(w,{attributes:{pageSection:u,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getOutboxDelayDurationComponent()},handleContainerEvent:function(){}}),G.create(R,{attributes:{pageSection:v,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getUndoSendIntervalComponent()},handleContainerEvent:function(){}}),G.create(E,{attributes:{pageSection:c},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getAutoAddContactDOM()},handleContainerEvent:function(){}}),G.create(O,{attributes:{pageSection:p},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getAskReceiptDOM()},handleContainerEvent:function(){}}),G.create(I,{attributes:{pageSection:d},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getShowCcDOM()},handleContainerEvent:function(){}}),G.create(D,{attributes:{pageSection:m},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getShowBccDOM()},handleContainerEvent:function(){}}),G.create(k,{attributes:{pageSection:f},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getSuggestContactsDOM()},handleContainerEvent:function(){}}),G.create(T,{attributes:{pageSection:g},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getReminderPromptDOM()},handleContainerEvent:function(){}}),zmail.showFeature){var e="vertical";zmail.userOptions.quotedLinePosition&&(e="horizontal");var t={initialSelected:e,onSelect:function(e){oe.set(!oe.get())},options:[{id:"vertical",title:"vetrical"},{id:"horizontal",title:"horizontal"}]};G.create(V,{attributes:{pageSection:h,isReactApp:!0},initialize:function(){return le()},uninitialize:function(){return le()},getView:function(){return a("MailSuite.Settings.Compose.Views").getQuotedLinePosition(t)},handleContainerEvent:function(){}})}}(),$.subscribe("settings/mail-accounts/fromAddressChange",function(e,t){t.obj.accId===zmail.accId&&(zmail.cmpdata.DEFFRM_ADDR=t.obj.sendAsEmail,n.triggerViewUpdate())}),$.subscribe("/mail/accountSwitch",function(e,t){"success"===(t=t||{}).status&&n.triggerViewUpdate()}),de.props.on(F,function(e){var t=e.changed.toggleSwitchActive;W.set(t)}),W.props.on("change",function(e){e.changed.hasOwnProperty("value")&&de.setProp({toggleSwitchActive:e.changed.value})}),ge.props.on(F,function(e){var t=e.changed.toggleSwitchActive;Y.set(!t)}),Y.props.on("change",function(e){e.changed.hasOwnProperty("value")&&ge.setProp({toggleSwitchActive:!e.changed.value})}),te.props.on("change",function(e){e.changed.hasOwnProperty("value")&&t.setProp({toggleSwitchActive:!e.changed.value})}),t.props.on(F,function(e){var t=e.changed.toggleSwitchActive;te.set(!t)}),pe.props.on(F,function(e){(e=e||{}).changed.hasOwnProperty("toggleSwitchActive")&&J.set(e.changed.toggleSwitchActive)}),e.props.on(F,function(){var e,t=!1;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).changed.toggleSwitchActive&&(t=!0),e=-zmail.userOptions.undoInterval,ie.set(e,{undoSendState:t})}),J.props.on("change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&pe.setProp({toggleSwitchActive:e.changed.value})}),zmail.Settings.MailSuite.ComposeSettings={},zmail.Settings.MailSuite.ComposeSettings.undo=e}(zmail.Settings.Modules.import),_defineSettingsModule("ComposeClassConstants",function(e,t){e.classConstants={btnCls:"zmSelectBtn",selCls:" zmSel",customFontCls:"zmSelectBtnCE zmCenterAlign zmSBCEditable",placeHolderCls:"zmPlaceholder",customFontPlaceHolder:"zmSelectBtnCE zmPlaceholder zmSBCEditable",separatorCls:"zmSLine",customFntCls:"zmSelectBtnCE",titleCls:"zmSetARLabel",helpIcon:"msi-helpRound zmDoubleIcon",bulpIcon:"msi-bulb zmModeBG greyText",selectionRowCls:"zmSetActionRow zmFlex",fontColorSelRowCls:"zmSetActionRow zmFlex",imgTxtCls:"zmSetImgTxtBox",flexCls:"zmFlex",hideCls:" zmHideD",infoCls:"zmSetInfo",groupingCls:"zmSetActionGroup zmSetAGIndent",actionWrapperCls:"zmSetActionWra",fontPreviewCls:"zmSetFontPreview zmModeBdr"}},"MailSuite.Settings.Compose"),function(e){var t=zmText.get("zm-settings-core","compose.quickNavigatorItems");e("Platform.Components").QuickNavigatorSectionManager.create("compose-settings",{props:{title:t.sectionTitle},state:{selected:!1}})}(zmail.Settings.Modules.import),_defineSettingsModule("Cards",function(e,t){var n={cardTitle:zmText.get("zm-settings-core","activesync").card.title};zmail.Settings.Modules.create("mSyncDeferred"),zmail.Settings.mSyncDeferred=$.Deferred();var i=t("Platform.Components").SettingCardManager.create("activesync",{props:{openable:!1,title:n.cardTitle},attributes:{category:"general"}});zmail.postJsDeffered.promise.then(function(){"false"===zmail.mailOpt.activeSync&&i.setState({hidden:!0})}),e.activeSync=i},"MailSuite"),_defineSettingsModule("activeSyncMailSetting",function(e,t){var n=t("Platform.Components").SettingManager,a=t("Platform.System.Utils"),r="activesync",o={true:1,false:0},i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=a.makeDeferred();a.debugLog("fetching mail-setting "+r,e);return"true"===zmail.mailOpt.activeSync?(zmAjq.XHR({u:zmail.conPath+"/userSettings.do",p:{mode:"getMSyncdata"},t:"POST",fn:function(e){e.msyncData.length||(e={}),zmail.Settings.mSyncDeferred.resolve(e),zmail.Settings.mSyncDeferred.done(function(e){e.hasOwnProperty("msyncData")&&e.msyncData.length?t.resolve(Boolean(e.msyncData[0].mail)):t.resolve({})})},csr:"s"}),t.promise()):t.resolve()},save:function(e,t){var n=a.makeDeferred();a.debugLog("saving "+r,e,t);var i={settings:JSON.stringify({mail:o[e]}),mode:"setMSyncdata"};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e){n.resolve(e.value)},p:i,csr:"s"}),n.promise()}},s=n.create(r,{props:{defaultValue:!1},persister:i,type:"boolean",category:"general"});s.initialize(),e.Setting=s},"MailSuite.Settings.activeSync"),_defineSettingsModule("activeSyncCalendarSetting",function(e,t){var n=t("Platform.Components").SettingManager,a=t("Platform.System.Utils"),r="activesync",o={true:1,false:0},i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=a.makeDeferred();return a.debugLog("fetching mail-setting "+r,e),zmail.Settings.mSyncDeferred.done(function(e){e.hasOwnProperty("msyncData")?t.resolve(Boolean(e.msyncData[0].calendar)):t.resolve({})}),t.promise()},save:function(e,t){var n=a.makeDeferred();a.debugLog("saving "+r,e,t);var i={settings:JSON.stringify({calendar:o[e]}),mode:"setMSyncdata"};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e){n.resolve(e.value)},p:i,csr:"s"}),n.promise()}},s=n.create(r,{props:{defaultValue:!1},persister:i,type:"boolean",category:"general"});s.initialize(),e.Setting=s},"MailSuite.Settings.activeSync"),_defineSettingsModule("activeSyncContactSetting",function(e,t){var n=t("Platform.Components").SettingManager,a=t("Platform.System.Utils"),r="activesync",o={true:1,false:0},i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=a.makeDeferred();return a.debugLog("fetching mail-setting "+r,e),zmail.Settings.mSyncDeferred.done(function(e){e.hasOwnProperty("msyncData")?t.resolve(Boolean(e.msyncData[0].contact)):t.resolve({})}),t.promise()},save:function(e,t){var n=a.makeDeferred();a.debugLog("saving "+r,e,t);var i={settings:JSON.stringify({contact:o[e]}),mode:"setMSyncdata"};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e){n.resolve(e.value)},p:i,csr:"s"}),n.promise()}},s=n.create(r,{props:{defaultValue:!1},persister:i,type:"boolean",category:"general"});s.initialize(),e.Setting=s},"MailSuite.Settings.activeSync"),function(e){var t="activesync",n="mail",i="calendar",a="contacts",r=e("Platform.Components"),o=e("Platform.Entities"),s=zmText.get("zm-settings-core","activesync"),c=e("MailSuite.Settings.activeSync"),l=r.SettingCardItemManager,u=o.SettingCardItem.Types,p=s.state,d=c.activeSyncMailSetting.Setting,g=c.activeSyncCalendarSetting.Setting,m=c.activeSyncContactSetting.Setting,f=function(e,t){return t=t||{},"props"===e&&t.hasOwnProperty("value")&&(t.value=!0===t.value?p.enable:p.disable),t},S=l.create(n,{props:{title:s.cardItems.mail.title,value:"Disabled"},attributes:{type:u.LabelAction,card:t},transformer:function(e,t){return f(e,t)},secondaryAction:function(){var e=d,t=!0!==e.get();e.set(t)}}),v=l.create(i,{props:{title:s.cardItems.calendar.title,value:"Disabled"},attributes:{type:u.LabelAction,card:t},transformer:function(e,t){return f(e,t)},secondaryAction:function(){var e=g,t=!0!==e.get();e.set(t)}}),A=l.create(a,{props:{title:s.cardItems.contacts.title,value:"Disabled"},attributes:{type:u.LabelAction,card:t},transformer:function(e,t){return f(e,t)},secondaryAction:function(){var e=m,t=!0!==e.get();e.set(t)}});l.bindSetting(S,d),l.bindSetting(v,g),l.bindSetting(A,m)}(zmail.Settings.Modules.import),_defineSettingsModule("Cards",function(e,t){var n=zmText.get("zm-settings-core").offline,i=t("Platform.Components").SettingCardManager;if(zmail.isZMOfflineEnabled){var a=i.create("offline-settings",{props:{openable:!0,title:n.title},attributes:{category:"mail"},openAction:i.CardActions.OpenPageAction("offline-settings")});e.Offline=a}},"MailSuite"),function(e){var t="mail-offline",n=e("Platform.Components"),i=e("Platform.Entities"),a=n.SettingCardItemManager,r=i.SettingCardItem.Types;if(zmail.isZMOfflineEnabled){var o=a.create(t,{props:{title:"Mail"},attributes:{type:r.LabelAction,card:"offline-settings"},transformer:function(e,t){return t=t||{},"props"===e&&t.hasOwnProperty("value")&&(t.value=!0===t.value?"enabled":"disabled"),t},primaryAction:a.CardItemActions.OpenPageAction("offline-settings",{showSection:t})});zmail.Settings.OfflineSetting=o}}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(t,e){var n="offline-settings",i=e("Platform.Components"),a=e("Platform.Entities"),r=zmText.get("zm-settings-core","offlineSettings"),o=i.SettingPageManager,s=a.SettingPage.Types,c=o.create(n,{props:{title:r.page.title},attributes:{type:s.PageAlone,card:n,pageContainerClassNames:"zmSetPage zmSetOfflinePage",category:"mail",pageCSSClass:"zmSetNPwra"},onComponentCreate:function(e){t.Offline.SettingContainer=e}});t.Offline=c},"MailSuite"),function(r,e){var o,n,t="offline-settings",i="mail-offline",a="sa-mail-offline",s="zm-settings-app-offlinesettings",c=zmText.get("zm-settings-core","offlineSettings"),l=!1,u="ZMOffline/",p=r("Platform.Components"),d=r("Platform.Entities").SettingPageSection,g=p.SettingAppManager,m=d.Types,f=p.SettingPageSectionManager,S=function(){return zmAppLoader.load(s)},v=function(e){localStorage.removeItem(e)};_zm.isSafari&&(v(u+zmail.zuid),v("ZMOffline_KeepData/"+zmail.zuid),v("ZMOffline_Mail_Days/"+zmail.zuid),v("ZMOffline_Mail_WithAtt/"+zmail.zuid)),n=_zm.isOfflineSupportAvailableInBrowser()?f.create(i,{props:{title:c.labels.title,enableFrom:!1,highlight:!1,toggleSwitchFlex:!0,toggleSwitchOnText:c.on,toggleSwitchOffText:c.off,triggeredVia:!0,toggleSwitchActive:(l=!1,"true"===localStorage.getItem(u+zmail.zuid))},attributes:{page:t,type:m.PageAlone,appContainer:!0}}):f.create(i,{props:{title:"",enableFrom:!1,highlight:!1},attributes:{page:t,type:m.PageAlone,appContainer:!0}}),(r("MailSuite.Apps").OfflineSettingPageSection=n).props.on("change:toggleSwitchActive",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=r("MailSuite.Apps.Offline.mailOfflineSetting.Setting");r("MailSuite.Apps.Offline").mailOfflineSection=n,l=!0,e.changed.hasOwnProperty("triggeredVia")&&!e.changed.triggeredVia&&(l=!1),"false"!==localStorage.getItem(u+zmail.zuid)||e.changed.toggleSwitchActive||(l=!1),e.changed.toggleSwitchActive?t.set(!0):t.set(!1,{triggerViaUser:e.attributes.triggeredVia}),o.triggerViewUpdate(),setTimeout(function(){l=!1},1e3)});var A=function(){return S()},h=function(){return S()},y=function(){var e=r("MailSuite.Settings.Offline.Views"),t=r("MailSuite.Apps.Offline");t.App=o;var n=t.mailOfflineSection;n?(n=n.props.attributes.toggleSwitchActive)?(n="true",t.mailOfflineSection.props.attributes.triggeredVia||(l=!0),"true"===localStorage.getItem(u+zmail.zuid)&&(l=!1)):n="false":n=localStorage.getItem(u+zmail.zuid);var i=r("MailSuite.Apps.Offline.mailOfflineSection");i||(i=r("MailSuite.Apps.OfflineSettingPageSection"));var a=i.props.attributes.enableFrom;return i&&!i.props.attributes.toggleSwitchActive&&localStorage.setItem("ZMOfflineSync","false"),_zm.isOfflineSupportAvailableInBrowser()?e.getMailOfflineSetting(l,n,a):e.getUnSupportInfoMsgSetting()};zmail.isZMOfflineEnabled&&(o=g.create(a,{attributes:{pageSection:i,isReactApp:!0},initialize:A,uninitialize:h,getView:y,handleContainerEvent:function(){var e=r("MailSuite.Pages.Offline");e=e.SettingContainer._view.refs.settingsContainer,$.e(e).on("scroll",function(){zmUtil.hideMenu()})}}))}(zmail.Settings.Modules.import),_defineSettingsModule("mailOfflineSetting",function(e,t){var n=t("Platform.Components"),i=t("Platform.System.Utils"),a=n.SettingManager,r="mail-offline-setting",o={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=i.makeDeferred();i.debugLog("fetching mail-setting "+r,e);var n=!1;return null===localStorage.getItem("ZMOffline/"+zmail.zuid)&&localStorage.setItem("ZMOffline/"+zmail.zuid,!1),_zm.isOfflineEnabled()&&(n=!0),t.resolve(n),t.promise()},save:function(e,t){var n=i.makeDeferred();return i.debugLog("saving "+r,e,t),n.resolve(e)}};if(zmail.isZMOfflineEnabled){var s=a.create(r,{props:{defaultValue:!1},persister:o,type:"boolean",category:"mail"});s.initialize(),e.Setting=s}},"MailSuite.Apps.Offline"),_defineSettingsModule("notesOfflineSetting",function(e,t){var n=t("Platform.Components"),i=t("Platform.System.Utils"),a=n.SettingManager,r="notes-offline-setting",o={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=i.makeDeferred();i.debugLog("fetching mail-setting "+r,e);var n=!1;return null===localStorage.getItem("ZMNotesOffline/"+zmail.zuid)&&localStorage.setItem("ZMNotesOffline/"+zmail.zuid,!1),"true"===localStorage.getItem("ZMNotesOffline/"+zmail.zuid)&&(n=!0),t.resolve(n),t.promise()},save:function(e,t){var n=i.makeDeferred();i.debugLog("saving "+r,e,t);return localStorage.setItem("ZMNotesOffline/"+zmail.zuid,e),Dialog.confirm("To Avail changes a refresh is required?",function(){window.location.reload()}),n.resolve(e)}};zmail.isZMOfflineEnabled&&a.create(r,{props:{defaultValue:!1},persister:o,type:"boolean",category:"mail"})},"MailSuite.Apps.Offline"),_defineSettingsModule("Pages",function(e,t){var n="conversation-settings",i="conversation-settings",a=t("Platform"),r=a.Components,o=a.Entities,s=t("MailSuite.Settings.Conversation"),c=zmText.get("zm-settings-core","conversation"),l=r.SettingCardManager,u=r.SettingCardItemManager,p=r.SettingPageManager,d=r.SettingAppManager,g=o.SettingPage,m=o.SettingCardItem,f=g.Types,S=s.ViewState,v=s.SortOrder,A=m.Types,h=S.Setting,y=v.Setting,C=S.Constants.MODE_MAP,b=v.Constants.MODE_MAP,M="zm-settings-app-conversationsettings";l.create(i,{props:{openable:!0,title:c.card.title},attributes:{category:"mail"},openAction:l.CardActions.OpenPageAction(n)});var P="converation-view",E="conversation-sort",z=function(e){e=void 0!==e?e:h.get();var t=C[e];return c.cardItems.conversationView.viewModes[t]},w=function(e){e=void 0!==e?e:y.get();var t=b[e];return c.cardItems.conversationSort.sortModes[t]},O=u.create(P,{props:{title:c.cardItems.conversationView.cardItem.title,value:z()},attributes:{type:A.LabelValue,card:i},primaryAction:u.CardItemActions.OpenPageAction(n),searchCommand:{title:c.cardItems.quickActionTitle.state}}),I=u.create(E,{props:{title:c.cardItems.conversationSort.cardItem.title,value:w()},attributes:{type:A.LabelValue,card:i},primaryAction:u.CardItemActions.OpenPageAction(n),searchCommand:{title:c.cardItems.quickActionTitle.sortOrder}}),T=function(){return zmAppLoader.load(M)};p.create(n,{props:{title:c.page.title},attributes:{type:f.PageAlone,card:n,appContainer:!0,category:"mail",pageCSSClass:"conversation-settings-page"}}),d.create("conversation-settings",{attributes:{page:n,isReactApp:!0},initialize:function(){return T()},uninitialize:function(){return T()},getView:function(){return s.getView()},handleContainerEvent:function(){}}),h.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&O.setProp({value:z(e.changed.value)})}),y.on("props.change",function(e){(e=e||{}).changed.hasOwnProperty("value")&&I.setProp({value:w(e.changed.value)})})},"MailSuite"),_defineSettingsModule("Integrations",function(e){var t=zmText.get("zm-settings-app-integrationsettings-apps-model");e.DNOTIFY_SETTING_ID="desktop-notification-toggle",e.TWITTER_SETTING_ID="twitter-integration",e.SMARTMENU_SETTING_ID="smart-menu-toggle",e.CARD_ID="integrations-settings",e.PAGE_ID="integrations-settings",e.APP_ID="sa-integrations-settings",e.CATEGORY_ID="general",e.APPCORE_MODULE_ID="zm-settings-app-integrationsettings",e.HASH_MAP={1:"Apps",2:"DeveloperSpace",3:"Marketplace",4:"MyApps",5:"Channels"},e.REVERSE_HASH_MAP={Apps:1,DeveloperSpace:2,Marketplace:3,MyApps:4,Channels:5},e.TEXT_MAP={1:t.page.apps,2:t.page.devSpace,3:t.page.marketplace,4:t.page.apps,5:t.page.channels}},"MailSuite.Constants"),_defineSettingsModule("View",function(e,t){var a=zmail.Core.Namespaces.get("zmail.DataLayer.Utils"),n=t("Platform.System.Utils"),r=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"init",value:function(e,t){var n=this;if("string"!=typeof e)throw new Error("Give a proper id for Integration");n.id=e,a.isFunction(t.getView)||n.throwError("getView must be Functions"),n.destroy=t.destroy,n.getView=t.getView,n.afterMount=t.afterMount}},{key:"mount",value:function(e,t){this.elm=e;try{this.isReactApp?ReactDOM.render(this.view(t),e):($.e(e).clearHTML(),$.e(e).appendDOM(this.view())),a.isFunction(this.afterMount)&&this.afterMount()}catch(e){n.debugLogError(e)}}},{key:"rhsmount",value:function(e){try{this.settingElm=e,this.isReactApp?ReactDOM.render(this.view(),e):($.e(e).clearHTML(),$.e(e).appendDOM(this.view())),a.isFunction(this.afterMount)&&this.afterMount()}catch(e){n.debugLogError(e)}}},{key:"rhsunmount",value:function(){try{this.isReactApp?ReactDOM.unmountComponentAtNode(this.settingElm):(a.isFunction(this.destroy)&&this.destroy(),$.e(this.settingElm).clearHTML())}catch(e){n.debugLogError(e)}}},{key:"unmount",value:function(){try{this.isReactApp?ReactDOM.unmountComponentAtNode(this.elm):(a.isFunction(this.destroy)&&this.destroy(),$.e(this.elm).clearHTML())}catch(e){n.debugLogError(e)}}},{key:"initialize",value:function(){this._init()}},{key:"throwError",value:function(e){throw new Error(e)}}]),e}(),i=function(){function e(){babelHelpers.classCallCheck(this,e),this.integrations={}}return babelHelpers.createClass(e,[{key:"add",value:function(e,t){if(!(t instanceof r))throw new Error("Given integration is not a instance of Base IntegEntity");this.integrations[e]=t}},{key:"get",value:function(e){return this.integrations[e]}},{key:"remove",value:function(){delete this.integrations[name]}},{key:"register",value:function(e,t,n){var i;return t instanceof r?i=t:((i=new r).init(e,{destroy:t.destroy,getView:t.getView,afterMount:t.afterMount}),n&&a.copyProperties(i.prototype,n)),this.add(e,i),this.get(e)}}]),e}(),o=new i;return e.ViewManager=o,e.Integration=r,i},"MailSuite.Settings.Integration"),_defineSettingsModule("Pages",function(e,a){var r,t=a("Platform.Components"),n=a("Platform.Entities"),o=a("MailSuite.Constants.Integrations"),i=zmText.get("zm-settings-app-integrationsettings-apps-model","page"),s=t.SettingPageManager,c=n.SettingPage,l=t.SettingAppManager,u=c.Types,p=function(){return zmAppLoader.load(o.APPCORE_MODULE_ID)};r=s.create(o.PAGE_ID,{props:{title:i.title},attributes:{type:u.PageAlone,card:o.PAGE_ID,category:"general",appContainer:!0,defaultPageName:"Extensions",showActionable:!1,pageCSSClassName:""}});var d,g=function(){return p()},m=function(){return p()},f=function(){return a("MailSuite.Settings.Integration").getView()},S=function(e,t){var n,i=a("MailSuite.Settings.Integration").Apps.Tabs;"active"===e?(n=r.getProp("focusedSection"))?(i.set({currentTab:o.REVERSE_HASH_MAP[n]},{silent:!0}),i.trigger("change",{triggerHash:!1})):(i.get("selectedTab")!==i.get("currentTab")&&i.set({currentTab:1},{silent:!0}),i.trigger("change",{triggerHash:!0})):zmsuite.isWorkspaceAvailable("zm-settings")&&(i.set({currentTab:1},{silent:!0}),i.trigger("change",{triggerHash:!1,unMount:!0}),r.setProp({focusedSection:o.HASH_MAP[1],extraHash:"",extraParam:""}))};d=l.create(o.APP_ID,{attributes:{page:o.PAGE_ID,isReactApp:!0},initialize:g,uninitialize:m,getView:f,handleContainerEvent:S}),e.Integrations=r,e.App=d,e.Page=r},"MailSuite"),_defineSettingsModule("Cards",function(e,i){var t,n=zmText.get("zm-settings-app-integrationsettings-apps-model"),a=i("Platform.Components"),r=i("MailSuite.Constants.Integrations"),o=i("Platform.Entities"),s=i("MailSuite.Settings.Integration.Apps.Collection"),c=a.SettingCardManager,l=a.SettingCardItemManager,u=o.SettingCardItem.Types,p=l.CardItemActions.OpenPageAction(r.PAGE_ID),d="integration-devmode",g=function(t,n){zmAppLoader.load(r.APPCORE_MODULE_ID).then(function(){p();var e=i("MailSuite.Settings.Integration").Apps.Tabs;e.set({currentTab:t,selectedTab:t},{silent:!0}),e.trigger("change",{triggerHash:n})})},m=function(){(s.has(14)||s.has(12))&&(zmail.isInternalOrgUser||zmail.isdevPlatformenabled)&&l.create(d,{props:{title:n.page.devSpace},attributes:{type:u.Action,card:r.CARD_ID},primaryAction:function(){g(2,!0)}})},f=c.create(r.CARD_ID,{props:{openable:!0,title:n.card.title},attributes:{category:r.CATEGORY_ID},openAction:c.CardActions.OpenPageAction(r.PAGE_ID)});l.create("integration-apps",{props:{title:n.page.apps,showInBreadCrumb:!0,showListCards:{list:(t=[{htm:n.page.apps,data:{action:1}}],(zmail.isInternalOrgUser||zmail.isdevPlatformenabled)&&t.push({htm:n.page.devSpace,data:{action:2}}),t.push({htm:n.page.channels,data:{action:5}}),t),clk:function(e,t){zmUtil.hideMenu(),g(e.action,!0)},customHeaderAction:function(){g(1,!0)},defaultPageName:n.page.apps}},attributes:{type:u.Action,card:r.CARD_ID},primaryAction:function(){g(1,!0)}}),zmail.isInternalOrgUser||zmail.isdevPlatformenabled?l.create(d,{props:{title:n.page.devSpace},attributes:{type:u.Action,card:r.CARD_ID},primaryAction:function(){g(2,!0)}}):s.isLoaded?m():s.on("fetched",function(){m()});var S=l.get("integration-apps");new Promise(function(t){zmail.fromOtherService?t({info:{isAdmin:!1}}):zmail.fetchPlanDetails().then(function(e){t(e)})}).then(function(e){e.info.isAdmin?l.create("integration-channel",{props:{title:n.page.channels},attributes:{type:u.Action,card:r.CARD_ID},primaryAction:function(){g(5,!0)}}):delete S.getProp("showListCards").list[2];zmUtil.getIntegSettings().then(function(){if(zmail.IntegrationSettingData.freeOrg&&zmail.isAdmin){l.get(d).setProp({htmlTitle:$.e(zdom("i",{className:"msi-crown"}))});var e=S.getProp("showListCards").list;r.TEXT_MAP[2]=$.e(zdom("span",null,n.page.devSpace,zdom("i",{className:"msi-crown"}))),e[1].htm=$.e(zdom("span",null,n.page.devSpace,zdom("i",{className:"msi-crown"})))[0]}})}),e.Integrations=f,e.changeTab=g},"MailSuite"),_defineSettingsModule("DesktopNotification",function(e,t){var n=t("Platform.Components"),o=t("MailSuite.Constants.Integrations"),s=t("Platform.System.Utils"),i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=s.makeDeferred();return s.debugLog("fetching mail-setting "+o.DNOTIFY_SETTING_ID,e),t.resolve(Boolean(zmail.mailOpt.dtNotify)),t.promise()},save:function(e,t){var n=s.makeDeferred();s.debugLog("saving "+o.DNOTIFY_SETTING_ID,e,t);var i=e?1:0,a={settings:JSON.stringify({notifyDesktop:i}),mode:"viewVO"},r={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.mailOpt.dtNotify=i,n.resolve(t.value)},p:a,csr:"s",ep:r}),n.promise()}},a=n.SettingManager.create(o.DNOTIFY_SETTING_ID,{props:{defaultValue:!1},type:"boolean",category:o.CATEGORY_ID,persister:i});a.initialize(),e.Setting=a},"MailSuite.Settings.General"),_defineSettingsModule("SmartMenu",function(e,t){var n,i=t("Platform.Components"),a=t("MailSuite.Constants.Integrations"),r=t("Platform.System.Utils"),o=i.SettingManager,s={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+a.SMARTMENU_SETTING_ID,e),t.resolve(zmAdHocSettings.getHelperBlockVisibility()),t.promise()},save:function(e,t){var n=r.makeDeferred();return r.debugLog("saving "+a.SMARTMENU_SETTING_ID,e,t),zmAdHocSettings.setHelperBlockVisibility(e)?n.resolve(e):n.reject(),n.promise()}};(n=o.create(a.SMARTMENU_SETTING_ID,{props:{defaultValue:"0",options:["0","1"]},type:"option",category:a.CATEGORY_ID,persister:s})).initialize(),e.Setting=n},"MailSuite.Settings.General"),_defineSettingsModule("TwitterIntegration",function(e,t){var a=zmail.Core.Namespaces.create("zmail.twitterInteg"),r=zmText.get("zm-settings-core","integrations.twitter");a.twitterData={error:!0};ZMStore.getInstance("IntegAppsCollection").fetchList().then(function(){var n,i,e;_zm.isTwitterIntegrationEnabled()&&(a.fetchDeferred=(i=$.Deferred(),e=function(){a.twitterData={error:!0},n=!1,i.resolve(n)},zmAjq.XHR({u:"/integPlatform/integAction.do",t:"GET",fn:function(e){if(n=!1,"success"===(e=e||{}).status){var t=e.data[0];a.twitterData=t,n=1===t.status}else a.twitterData={};i.resolve(n)},p:{action:"GET_CONFIGURED_ACCS",appType:"twitter"},onnetfailure:e,onerror:e}),i.promise()),$.subscribe("integration/configure",function(e,t){var n=t.type,i=t.data;"twitter"===n&&function(e,t){if(t=t||"{}",t=JSON.parse(t),"success"===e)t.msg?_zm.succErrMsg("e",t.msg):t.reAuth?_zm.succErrMsg("s",r.succAuth):(_zm.succErrMsg("s",r.succAuth),a.configured&&a.configured(t));else{var n=t.msg?t.msg:r.common;_zm.succErrMsg("e",n)}}(i.status,i.data)}))})},"MailSuite.Settings.Integration"),function(e){var t=zmText.get("zm-settings-core","integrations.quickNavigatorItems");e("Platform.Components").QuickNavigatorSectionManager.create("integration-settings",{props:{title:t.sectionTitle},state:{selected:!1}})}(zmail.Settings.Modules.import),window.zmail=window.zmail||{},window.zmail.integConfigSettings=function(e,t){t=t||"{}",t=JSON.parse(t),$.publish("integration/configure",{type:e,data:t})},window.zmail.connectorConfigSettings=function(e,t){t=t||"{}",t=JSON.parse(t),$.publish("integration/connector/configure",{name:e,data:t})},_defineSettingsModule("FolderSettings",function(t,e){var n,i,a=zmail.Core.Namespaces,r=a.get("zmail.Settings.Platform.Components"),o=a.get("zmail.Settings.Platform.Entities"),s=a.get("zmail.Settings.Platform.System.Utils"),c=a.create("zmail.Settings.MailSuite.Apps.FolderSettings"),l=r.SettingCardManager,u=r.SettingCardItemManager,p=r.SettingPageManager,d=r.SettingAppManager,g=o.SettingPage,m=o.SettingCardItem,f=g.Types,S=m.Types,v=zmText.get("zm-settings-core","folders.labels"),A={CARD_ID:"folders",PAGE_ID:"folders",APP_ID:"sa-folders",CATEGORY_ID:"mail",FOLDER_PROP_CARD_ITEM_ID:"folder-props",NEW_FOLDER_CARD_ITEM_ID:"new-folder",ARCHIVE_POLICY_CARD_ITEM_ID:"archive-policy",APPCORE_MODULE_ID:"zm-settings-app-init",APPCORE_MODULE_NAMESPACE:"MailSuite.Apps.FolderSettings.AppCore"},h=function(){return zmAppLoader.load(A.APPCORE_MODULE_ID)},y=function(){return e(A.APPCORE_MODULE_NAMESPACE)},C=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i.setAttribute("accId",t.accountID)},b=function(){var t=s.makeDeferred();return h().then(function(){zmAppLoader.load("sharefolder").then(function(){});var e=zmail.Settings.MailSuite.Apps.FolderSettings.Page.getAttribute("accId");zmail.Settings.MailSuite.Apps.FolderSettings.init(t,e)},function(){s.debugLog("Module load failed !!!"),t.reject()}),t.promise()},M=function(){var e=s.makeDeferred();return h().then(function(){y().uninitialize({progress:e})}),e.promise()},P=function(){return y().appCoregetAppView()},E=function(){var e,t=zmail.Settings.MailSuite.App.Core.Framework.Sections.Category.breadcrumbSection();if(1<Object.keys(zmail.aInfo).length){var n=(e=c.createTemp(),$.e(e));$.e(t.getRightHeaderComponentWrapper()).children().remove(),$.e(t.getRightHeaderComponentWrapper()).prependDOM(n)}},z=function(e,t){var n=y();n&&(E(),n.handleContainerEvent(e,t))};l.create(A.CARD_ID,{props:{title:v.title,openable:!0},attributes:{category:A.CATEGORY_ID},openAction:l.CardActions.OpenPageAction(A.PAGE_ID)}),u.create(A.NEW_FOLDER_CARD_ITEM_ID,{props:{title:v.createFolder,loadFrameworkOnCommandExecution:!1},attributes:{type:S.Action,card:A.CARD_ID},primaryAction:function(){zmfolAction.showCreateFolderPopUp({noMask:!1,noAnchor:!0,mode:"new"})}}),u.create(A.FOLDER_PROP_CARD_ITEM_ID,{props:{title:v.manageNotifications},attributes:{type:S.Action,card:A.CARD_ID},primaryAction:u.CardItemActions.OpenPageAction(A.PAGE_ID)}),i=p.create(A.PAGE_ID,{props:{title:v.title},attributes:{type:f.PageAlone,card:A.PAGE_ID,category:"mail",pageCSSClass:"zmSetNPwra",appContainer:!0,showActionable:!0,accId:zmail.accId},onComponentCreate:function(e){t.pageComponent=e}}),n=d.create(A.APP_ID,{attributes:{page:A.PAGE_ID,isReactApp:!0},initialize:b,uninitialize:M,getView:P,handleContainerEvent:z}),t.Constants=A,t.App=n,t.Page=i,$.subscribe("/mail/accountSwitch",C)},"MailSuite.Apps"),_defineSettingsModule("ArchivePolicy",function(e,t){var n=t("Platform.Components"),i=t("Platform.Entities"),a=t("Platform.System.Utils"),r=n.SettingPageManager,o=n.SettingAppManager,s=n.SettingCardManager,c=n.SettingCardItemManager,l=i.SettingPage,u=i.SettingCardItem,p=l.Types,d=u.Types,g=zmText.get("zm-settings-core","archivePolicy"),m="archivepolicy",f="archivepolicy",S="sa-archivepolicy",v="mail",A="zm-settings-app-archivepolicy",h="archive-policy",y="MailSuite.Apps.ArchivePolicy.AppCore",C=function(){return zmAppLoader.load(A)},b=function(){var e=a.makeDeferred();return C().then(function(){ZMStore.getInstance("ArchivePolicy").fetchList({accountID:zmUtil.getZohoAccId()}).then(function(){e.resolve()})},function(){a.debugLog("Module load failed !!!"),e.reject()}),e.promise()},M=function(){var e=a.makeDeferred();return C().then(function(){e.resolve()}),e.promise()},P=function(){return t(y).getAppView()},E=function(e,t){};s.create(m,{props:{title:g.labels.title,openable:!0},attributes:{category:v},openAction:s.CardActions.OpenPageAction(f)}),c.create(h,{props:{title:g.labels.title},attributes:{type:d.Action,card:m},primaryAction:c.CardItemActions.OpenPageAction("archivepolicy")}),r.create(f,{props:{title:g.labels.title},attributes:{type:p.PageAlone,appContainer:!0,card:f,category:"mail",pageCSSClassName:"archive-policy"}}),o.create(S,{attributes:{page:f,isReactApp:!0},initialize:b,uninitialize:M,getView:P,handleContainerEvent:E})},"MailSuite.Apps"),_defineSettingsModule("Filter",function(e,n){var i,a,t,r=n("Platform.Components"),o=n("Platform.Entities"),c=n("Platform.System.Utils"),s=r.SettingCardManager,l=r.SettingCardItemManager,u=r.SettingPageManager,p=r.SettingAppManager,d=o.SettingPage,g=o.SettingCardItem,m=d.Types,f=g.Types,S=zmText.get("zm-settings-core","filters"),v=!1,A={title:S.title,createFilter:S.createNew,createOutgoingFilter:S.createOutgoingNew,importFilter:S.importFilter,exportFilter:S.exportFilter,smartFilters:S.smartFilters,enabled:S.enabled,disabled:S.disabled},h="filters",y="filters",C="sa-filters",b="mail",M="create-filter",P="create-outgoing-filter",E="import-filter",z="export-filter",w="smart-filters",O="zm-settings-app-filters-new",I=r.SettingManager,T="smart-filter",D={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=c.makeDeferred();return c.debugLog("fetching mail-setting "+T,e),Backbone.ajax({url:zmail.conPath+"/filter.do",data:{accId:zmail.accId,mode:"getSmartFilterStatus"}}).done(function(e){1===e[0]&&t.resolve(Boolean(e[1].SmartFilterStatus))}),t.promise()},save:function(o,e){var s=c.makeDeferred();return c.debugLog("saving "+T,o,e),Backbone.ajax({url:zmail.conPath+"/filter.do",data:{mode:o?"enableSmartFilter":"disableSmartFilter",accId:zmail.accId}}).done(function(e){var t=ZMStore.getInstance("IncomingFilterCollection");if(t){var n=t.query().where("filterType","is",3).select();0===n.length?($.publish("smartFilter/all",o),t.resetAndFetchCollectionOf(!0)):n.forEach(function(e){e.set("enable",o)})}else $.publish("smartFilter/all",o);if(o&&!v){v=!0;var i,a=S.longDesc,r={title:A.smartFilters,$content:a,right:[],buttons:[{name:zmText.get("dialog","ok"),selected:!0}],closeAction:function(){v=!1}};r.buttons[0].callback=function(){v=!1,i.remove()},i=Dialog.new(r),s.resolve(!o)}}),s.promise()}},k=I.create(T,{props:{defaultValue:!1},persister:D,type:"boolean",category:"filter"});k.initialize();var _=function(){return zmAppLoader.load(O)},R=function(){return _()},L=function(){n("Apps.Filter.Views.Utils")._reset()},V=function(){var e,t;a.getProp().showNewFilter?(n("Apps.Filter.Models").filterTabs.set({currentTab:1}),ZMStore.getInstance("IncomingFilterCollection").fetchFilters().then(function(){n("Apps.Filter.Events").trigger("create-new-filter"),a.setProp({showNewFilter:!1})})):a.getProp().showNewOutgoingFilter&&(n("Apps.Filter.Models").filterTabs.set({currentTab:2}),ZMStore.getInstance("OutgoingFilterCollection").fetchFilters().then(function(){n("Apps.Filter.Events").trigger("create-new-filter"),a.setProp({showNewOutgoingFilter:!1})})),e=n("MailSuite.Common.React.UIComponents.AccountsBand"),t=n("MailSuite.App.Core.Framework.Sections.Category.getComponents")(),i=t.breadcrumbSection,ReactDOM.render(React.createElement(e),i.getRightHeaderComponentWrapper())},N=function(){n("Apps.Filter.Views.Utils")._reset(),ReactDOM.unmountComponentAtNode(i.getRightHeaderComponentWrapper())};return s.create(h,{props:{addToSearch:!1,title:A.title,openable:!0},attributes:{category:b},openAction:function(){s.CardActions.OpenPageAction(y)()}}),l.create(M,{props:{title:A.createFilter},attributes:{type:f.Action,card:h},primaryAction:function(){a.setProp({showNewFilter:!0}),l.CardItemActions.OpenPageAction(y)()}}),l.create(P,{props:{title:A.createOutgoingFilter},attributes:{type:f.Action,card:h},primaryAction:function(){a.setProp({showNewOutgoingFilter:!0}),l.CardItemActions.OpenPageAction(y)()}}),l.create(E,{props:{title:A.importFilter},attributes:{type:f.Action,card:h},primaryAction:function(){_().then(function(){n("Apps.Filter.Views.Utils").importFilters()})}}),l.create(z,{props:{title:A.exportFilter},attributes:{type:f.Action,card:h},primaryAction:function(){_().then(function(){n("Apps.Filter.Views.Utils").exportFilters()})}}),t=l.create(w,{props:{title:A.smartFilters},attributes:{type:f.LabelAction,card:h},transformer:function(e,t){return t=t||{},"props"===e&&t.hasOwnProperty("value")&&(t.value=!0===t.value?A.enabled:A.disabled),t},primaryAction:function(){a.setProp({showNewFilter:!0}),l.CardItemActions.OpenPageAction(y)()},secondaryAction:function(){var e=!0!==k.get();k.set(e)}}),u.create(y,{props:{title:A.title,showTitle:!1},attributes:{type:m.PageAlone,card:y,category:"mail",appContainer:!0,pageCSSClassName:""},onComponentCreate:function(e){i=e}}),a=p.create(C,{attributes:{page:y,isReactApp:!0},initialize:R,uninitialize:L,getView:function(){return zmail.Settings.Apps.Filter.Views.UIComponents.getView()},handleContainerEvent:function(e,t){c.debugLog("Container event",e,t),"active"===e?V():N()}}),l.bindSetting(t,k),e.smartFilterSetting=k,e},"Apps"),_defineSettingsModule("Signature",function(E,z){var w,O=z("Platform.Components"),I=z("Platform.Entities"),T=z("Platform.System.Utils");E.loadSignatureModule=function(){return zmAppLoader.load("zm-settings-signatureModel")},zmail.Settings.initSettings().then(function(){w=z("MailSuite.Apps.Signature");var t,e=O.SettingCardManager,n=O.SettingCardItemManager,i=O.SettingPageManager,a=O.SettingAppManager,r=I.SettingPage,o=I.SettingCardItem,s={},c=w.replySetting,l=r.Types,u=o.Types,p=zmText.get("zm-settings-core","signature.labels"),d="signatures",g="signatures",m="sa-signatures",f="reply",S="signature-new",v="mail",A="zm-settings-signature",h=n.CardItemActions.OpenPageAction(g),y=function(){return zmAppLoader.load(A)},C=function(e){var t=T.makeDeferred();return y().then(function(){zmail.Settings.Apps.Signature.initRequest().done(function(){t.resolve()})},function(){t.reject()}),t.promise()},b=function(){var e=T.makeDeferred();return y().then(function(){e.resolve()}),e.promise()},M=function(){return zmail.Settings.Apps.Signature.init()},P=function(e,t){"active"===e&&function(){var e=z("Platform.UI.Components"),t=z("MailSuite.App.Core.Framework.Sections.Category").breadcrumbSection(),n=e.ToggleSwitch,a=new n;a.init({props:{onText:p.replySetting.on,offText:p.replySetting.off},state:{on:!zmail.userOptions.hideSignatureInReply}}),s._view.refs.settingsContainer.addEventListener("scroll",function(){zmUtil.hideMenu()}),a.addTo(t,{targetView:"Rcomponent"});a.on(n.Events.stateChanged,function(){var e=a.getState(),t=c.Setting;if(e.on){var n=!0!==t.get();t.set(n)}else{var i=!0!==t.get();t.set(i)}});var i=p.replySetting.header;$.e(t.getRightHeaderComponentWrapper()).prependDOM(zdom("span",null,i))}();var n=z("Apps.Signature");n&&n.handleContainerEvent(e,t)};e.create(d,{props:{title:p.title,openable:!0},attributes:{category:v},openAction:e.CardActions.OpenPageAction(g)}),function(){n.create(S,{props:{title:p.addNewSignature},attributes:{type:u.Action,card:d},primaryAction:function(){t.setProp({openNew:!0}),h()}});var e=n.create(f,{props:{title:p.replySetting.title},attributes:{type:u.LabelAction,card:d},transformer:function(e,t){return"props"===e&&t.hasOwnProperty("value")&&(t.value=!0===t.value?p.replySetting.disable:p.replySetting.enable),t},secondaryAction:function(){var e=c.Setting,t=!0!==e.get();e.set(t)},primaryAction:function(){h();var e=z("MailSuite.App.Core.Framework.Sections.Category").breadcrumbSection();setTimeout(function(){$.e(e._view.refs.Rcomponent).addClass("highlightClass"),setTimeout(function(){$.e(e._view.refs.Rcomponent).removeClass("highlightClass")},5e3)},3e3)}});n.bindSetting(e,c.Setting)}(),i.create(g,{props:{title:p.title},attributes:{type:l.PageAlone,card:g,category:"mail",appContainer:!0,pageContainerClassNames:"zmSetPage",pageCSSClass:"zmSetNPwra"},onComponentCreate:function(e){s=e}}),t=a.create(m,{attributes:{page:g,isReactApp:!0},initialize:C,uninitialize:b,getView:M,handleContainerEvent:P}),E.App=t})},"Apps"),_defineSettingsModule("HotKeys",function(e,t){var i,n,a,r=t("Platform.Components"),o=t("Platform.Entities"),s=t("Platform.System.Utils"),c=r.SettingCardManager,l=r.SettingCardItemManager,u=r.SettingPageManager,p=r.SettingAppManager,d=o.SettingPage,g=o.SettingCardItem,m=d.Types,f=g.Types,S=zmText.get("zm-settings-core","hotkeys"),v="hotkeys",A="hotkeys",h="sa-hotkeys",y="hotkeys-new",C="mail",b=function(){zmAdHocSettings.setHotKeysOnboarding("2"),c.CardActions.OpenPageAction(A)()},M=function(){return zmModules.gethotkeysViewModule()},P=function(){var e=s.makeDeferred();return M().then(function(){zmail.Settings.Apps.HotKeys.initRequest().done(function(){e.resolve()})},function(){e.reject()}),e.promise()},E=function(){var e=s.makeDeferred();return M().then(function(){e.resolve()}),e.promise()},z=function(e,t){var n=i.attributes.get("showSampleKeys");"active"!==e||n||zmail.Settings.Apps.HotKeys.views.breadCrumbActionContainer()},w=function(){var e=i.attributes.get("showSampleKeys"),t=i.attributes.get("triggerViaOnboarding");return zmail.HotKeys.allHotKeys.models.length||e||t||(i.attributes.set({showSampleKeys:!0}),e=i.attributes.get("showSampleKeys")),zmail.Settings.Apps.HotKeys.views.init(!1,t,e)};n=!1,"0"!==(a=zmAdHocSettings.getHotKeysOnboarding())&&"1"!==a||(n=!0),c.create(v,{props:{title:S.labels.title,openable:!0,indicateNew:n,indicateNewText:S.newIndicator.title},attributes:{category:C},openAction:b}),l.create(y,{props:{title:S.cardItems.title},attributes:{type:f.Action,card:v},searchCommand:{title:S.searchCommand.title},primaryAction:function(){i.setAttribute({showNew:!0}),b()}}),u.create(A,{props:{title:S.labels.title},attributes:{type:m.PageAlone,card:A,category:"mail",appContainer:!0,pageCSSClass:"zmSetNPwra"}}),i=p.create(h,{attributes:{page:A,isReactApp:!0,showOnboarding:!1,showSampleKeys:!1,triggerViaOnboarding:!1},initialize:P,uninitialize:E,getView:w,handleContainerEvent:z}),e.App=i,e.initializeHotkeys=P},"Apps"),zmail.Settings.Modules.create("Apps.HotKeys").initRequest=function(){return zmail.HotKeys.initialize()},define([],function(){var e=zmail.Core.Namespaces,t=e.get("zmail.DataLayer").DSModel,n=e.create("zmail.HotKeys"),i=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"defaults",value:function(){return{key:"",value:"",keyId:null,sequence:"",contentEditable:!1,selected:!1}}},{key:"getIdAttribute",value:function(){return"key"}},{key:"parse",value:function(e){return e}},{key:"cloneAttributes",value:function(){return this.attributes}}]),t}(t);return n.model=i}),define([],function(){var e=zmail.Core.Namespaces,n=e.create("zmail.HotKeys"),t=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getBaseModelClass",value:function(){return n.model}}]),t}(e.get("zmail.DataLayer").DSCollection);return n.collection=t,n}),define([],function(){var e=zmail.Core.Namespaces,t=e.get("zmail.DataLayer").Adapter.HTTPAdapter,n=e.get("zmail.HotKeys"),c=zmail.HotKeys,i=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getUrl",value:function(){return"/zm/textReplace.do"}},{key:"getDefaultRequestMethods",value:function(){return{create:"POST",update:"POST",patch:"POST",delete:"POST",read:"GET"}}},{key:"serialize",value:function(e,t,n){var i={};return"fetchAll"===e?i.mode="get":"create"===e?(i.mode="add",i.key=n.key,i.value=n.value):"update"===e?(i.mode="edit",i.key=n.attrs.attrs.key,i.value=n.attrs.attrs.value,i.oldKey=n.attrs.attrs.oldkey):"delete"===e||"bulkDelete"===e?(i.mode="delete",n.keyId?i.key=n.keyId:i.key=n.key):"reArrange"===e&&(i.mode="reorder",i.key=c.Utils.getModelKeyIds()),i}},{key:"normalize",value:function(e,n,t){var i=[];if("fetchAll"!==e)return"create"===e?{key:t.key,keyId:n.keyId,value:t.value,contentEditable:!1,selected:!1,index:c.Utils.getLastIndex()}:"update"===e?{key:t.attrs.attrs.key,value:t.attrs.attrs.value,contentEditable:!1,selected:!1}:"delete"===e||"bulkDelete"===e||"reArrange"===e?{}:void 0;var a,r={},o=n.HotKeySequence,s=n.keyIdMap||{};return o.forEach(function(e,t){a=null,s[e]&&(a=s[e]),r={key:e,keyId:a,index:t,value:n.keyValueMap[e],contentEditable:!1,selected:!1},i.push(r),c.Utils.updateCard()}),i}}]),t}(t);return n.Adapter=i,n}),define([],function(){var a,n,r=zmail.Core.Namespaces.get("zmail.HotKeys"),o=zmail.Settings.Modules.import("Platform.System.Base");r.Utils={};var i=function(e){return(a=r.allHotKeys).get(e)},c=r.Utils;c.preDefinedKeys={NM:"Nice to e-meet you!",HBD:"Wish you a very Happy Birthday!",PFA:"Please find the attached file.",TYE:"Thank you so much for the email.",TTYL:"Talk to you later."},c.getLastIndex=function(){return r.allHotKeys.models.length},c.getHotKeysAsArr=function(){var e=r.allHotKeys.models,t=[],n={};return e.forEach(function(e){n={},n={key:e.attributes.key,value:e.attributes.value,keyId:e.attributes.keyId,index:e.attributes.index,toHide:e.attributes.toHide,contentEditable:e.attributes.contentEditable,selected:e.attributes.selected},t.push(n)}),t},c.getModelKeyIds=function(){var e=r.allHotKeys.models,t=[];return e.forEach(function(e){t.push(e.get("keyId"))}),t},c.reArrangeModels=function(){ZMStore.getInstance("hotkeys").models.forEach(function(e,t){e.set({index:t,toHide:!1})})},c.handleCardExchange=function(e,t){var n=ZMStore.getInstance("hotkeys").models;if(e!==t){var i=n[e];n.splice(e,1),n.splice(t,0,i),c.reArrangeModels(),i.set({toHide:!0}),zmail.Settings.Apps.HotKeys.App.triggerViewUpdate()}},c.handleDrop=function(){c.reArrangeModels(),zmail.Settings.Apps.HotKeys.App.triggerViewUpdate(),ZMStore.getInstance("hotkeys").triggerAction("reArrange")},c.getCurrentMatchingWord=function(i){var e=$.Deferred();return r.getAllHotKeys().done(function(){var t=[],n={};return c.getHotKeysAsArr().forEach(function(e){(c.isMatchFound(e.key,i)||""===i||e.key.includes(i))&&(n={},n={key:e.key,value:e.value},t.push(n))}),e.resolve(t)}),e.promise()},c.isMatchFound=function(e,t){if((e=(new DOMParser).parseFromString(e,"text/html").getElementsByTagName("body")[0].innerText).length<t.length)return!1;e=e.substr(e,t.length).split(""),t=t.split("");for(var n=!1,i=e.length,a=0;a<i;a++){if(e[a].trim()!==t[a].trim())return n=!1;n=!0}return n},c.getSmartSuggestedWords=function(t){var n=$.Deferred(),i=[],a={};return c.getCurrentMatchingWord(t).done(function(e){0<e.length?n.resolve(e):(c.getHotKeysAsArr().forEach(function(e){e.value=e.value.replace(/&nbsp;/g,""),c.isMatchFound(e.value,t)&&(a={key:e.key,value:e.value,index:e.value.indexOf(t)},i.push(a))}),n.resolve(i,{keyNotMatched:!0}))}),n.promise()},c.createNewModel=function(i,a){return new Promise(function(n,e){var t=new r.model({attrs:i.attrs});c.addNewModel(t,i.opts).then(function(e){var t=zmail.Settings.Apps.HotKeys.App;t.attributes.set({showSampleKeys:!1}),t.triggerViewUpdate(),n(a)})})},c.addNewModel=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t.isNew=!0,ZMStore.createRecord("hotkeys",e,t).then(function(e){return e},function(e){return e})},c.isEditableHotKeyPresent=function(e){var t=c.getHotKeysAsArr();if(e)return!!(a=r.allHotKeys).get(e).contentEditable;var n=!1;return t.forEach(function(e){e.contentEditable&&(n=!0)}),n},c.updateSelection=function(e,t){var n=zmail.Settings.Apps.HotKeys.App;a=r.allHotKeys,e&&""!==e?a.get(e).set(t,{silent:!0}):(t&&t.hasOwnProperty("updateAll")?t.updateAll?a.forEach(function(e){e.set({selected:!0},{silent:!0})}):a.forEach(function(e){e.set({selected:!1},{silent:!0})}):a.forEach(function(e){e.set({selected:!1},{silent:!0})}),n.triggerViewUpdate())},c.updateModel=function(e,t){a=r.allHotKeys,e&&a.get(e).set(t,{silent:!0}),n&&(a.get(n)||a.get(e)).set({contentEditable:!1},{silent:!0}),n=e,zmail.Settings.Apps.HotKeys.App.triggerViewUpdate()},c.updateCard=function(){zmail.Settings.Platform.Components.SettingCardManager.get("hotkeys").setProp({indicateNew:!1})},c.save=function(e,t){i(e).save({attrs:t}).then(function(e){c.updateModel(e.opts.attrs.attrs.key,e.opts.attrs.attrs),n=void 0})},c.destroy=function(e,t){i(e).destroy({key:e,keyId:t}).then(function(e){a=r.allHotKeys;var t=zmail.Settings.Apps.HotKeys.App;a.length||(t.setAttribute({showSampleKeys:!0}),t.triggerViewUpdate()),c.updateModel()})},c.validate=function(e,t,n,i){if(a=r.allHotKeys,""===e.trim()&&""===t.trim())throw new o.Error(0);if(""===e.trim())throw new o.Error(3);if(e.trim().includes("/"))throw new o.Error(5);if(""===t.trim())throw new o.Error(4);if((i||n)&&a.get(e))throw new o.Error(1);if(5e3<t.length)throw new o.Error(2);return!0},c.moveCursorToEnd=function(e){var t;if(document.createRange){(t=document.createRange()).selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else document.selection&&((t=document.body.createTextRange()).moveToElementText(e),t.collapse(!1),t.select());var i=e.scrollHeight;e.scrollTop=i},c.pasteAction=function(e,t,n){var i=(e.originalEvent||e).clipboardData.getData("text/html"),a=i.match(/<meta(?!\s*(?:name|value)\s*=)[^>]*?charset\s*=[\s"']*([a-zA-Z0-9-]+)[\s"'/]*>/g),r=n.innerHTML;(null!==a&&(i=i.replace(a[0],"")),50===t)&&(i=(new DOMParser).parseFromString(i,"text/html").getElementsByTagName("body")[0].innerText);i=(i+=r).substring(0,t),$.e(n).dangerouslySetInnerHTML(i),c.moveCursorToEnd(n)},c.addPreDefinedKeys=function(){var n,e=Object.keys(c.preDefinedKeys),i=[];e.forEach(function(e){var t={key:e,value:c.preDefinedKeys[e]};n=c.createNewModel({opts:t}),i.push(n)}),Promise.all(i).then(function(){zmail.Settings.Apps.HotKeys.App.triggerViewUpdate()})},c.eraseAndAddNewModels=function(e){var t=ZMStore.getInstance("hotkeys").models,n=zmail.HotKeys.collectionInstance;t.forEach(function(e){n.remove(e)}),zmail.HotKeys.fetchAllData().then(function(){zmail.Settings.Apps.HotKeys.App.triggerViewUpdate()})},c.isSelectionAvl=function(){var e=r.allHotKeys,t=!1,n=0,i=e.length;return e.forEach(function(e){e.attributes.selected&&(t=!0,n++)}),{isSelected:t,totalSelected:n,totalModels:i}},c.bulkDelete=function(){var e=r.allHotKeys,t=zmail.HotKeys.collectionInstance,n=[],i=[];e.forEach(function(e){e.attributes.selected&&(i.push(e.attributes.key),e.attributes.keyId?n.push(e.attributes.keyId):n.push(e.attributes.key))}),t.triggerAction("bulkDelete",{key:n}).then(function(){t.remove(i);var e=zmail.Settings.Apps.HotKeys.App;e.setAttribute({triggerViaOnboarding:!1}),e.triggerViewUpdate()})},c.uploadNewFile=function(){var n,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=new Promise(function(e,t){n=e}),i=new window.FormData,a=zmAjq.getCookie("zmcsr");i.append("zmrcsr",a);var r=encodeURI(e.fileName);i.append("importFile",e.file,r);var o=zmail.conPath+"/textReplace.do?mode=import",s=new XMLHttpRequest;return s.open("POST",o,!0),s.onreadystatechange=function(){var e;4===s.readyState&&(200===s.status?(c.eraseAndAddNewModels(),n()):400===s.status&&(e=$.parseJSON(s.responseText)[1].msg,_zm.succErrMsg("e",e)))},s.send(i),t};var s=Object.keys(c.preDefinedKeys),e=function t(n){var e,i,a=c.preDefinedKeys[s[n]],r={key:s[n],value:a};return(e=r,i=n,c.createNewModel({opts:e},i)).then(function(e){if(4!==e)return t(n+1)})};return c.bulkModelAddition=function(){e(0)},r}),function(){var e=zmail.Core.Namespaces,t=e.get("zmail.HotKeys"),i=null,n=t.collection,a=e.get("zmail.HotKeys"),r=$.Deferred(),o=function(){var n,e=new Promise(function(e,t){n=e});return i.fetchAll().then(function(e){a.allHotKeys=i,r.resolve(e),n()}),e},s=function(){var e={adapters:[{id:"http-adapter",type:"default",classObj:t.Adapter}],default:"http-adapter"};return ZMStore.getInstance("hotkeys")?i=ZMStore.getInstance("hotkeys"):(i=ZMStore.createInstance("hotkeys",n,{adapterConfig:e}),o()),t.collectionInstance=i,r.promise()};s(),t.initialize=s,t.getAllHotKeys=function(){return r.promise()},t.fetchAllData=o}(),_defineSettingsModule("saveInSentFolder",function(e,t){var n=t("Platform.Components").SettingManager,r=t("Platform.System.Utils"),o="vacationreply",i={errors:function(e){return"Error occured ! Error Code = "+e},fetch:function(e){var t=r.makeDeferred();return r.debugLog("fetching mail-setting "+o,e),t.resolve(Boolean(zmail.userOptions.storeVacationMail)),t.promise()},save:function(e,t){var n=r.makeDeferred();r.debugLog("saving "+o,e,t);var i={settings:JSON.stringify({storeVacationMail:e}),mode:"commonVO"},a={value:e};return zmAjq.XHR({u:zmail.conPath+"/userSettings.do",t:"POST",fn:function(e,t){zmail.userOptions.storeVacationMail=t.value,n.resolve(t.value)},p:i,csr:"s",ep:a}),n.promise()}},a=n.create(o,{props:{defaultValue:!0},persister:i,type:"boolean",category:"mail"});a.initialize(),e.Setting=a},"MailSuite.Apps.VacationReply"),_defineSettingsModule("VacationReply",function(e,r){var t,n=r("Platform"),o=r("MailSuite.Apps.VacationReply.saveInSentFolder"),i=n.Components,a=n.Entities,s=i.SettingCardManager,c=i.SettingCardItemManager,l=i.SettingPageManager,u=i.SettingAppManager,p=a.SettingPage,d=a.SettingCardItem,g=p.Types,m=d.Types,f=zmText.get("zm-settings-core","vacationreply"),S="outofoffice",v="outofoffice",A="sa-outofoffice",h="mail",y="savemailinsentfolder",C="zm-settings-app-vacationreply",b="vacationreply-new",M=s.CardActions.OpenPageAction(v),P=function(){return zmAppLoader.load(C)},E=function(){return P()},z=function(){return P()},w=function(){return zmail.Settings.Apps.VacationReply.getView()},O=function(e,t){"active"===e&&function(){var e=r("Platform.UI.Components"),t=r("MailSuite.App.Core.Framework.Sections.Category").breadcrumbSection(),n=e.ToggleSwitch,a=new n;a.init({props:{onText:f.keepMailsSetting.on,offText:f.keepMailsSetting.off},state:{on:zmail.userOptions.storeVacationMail}}),a.addTo(t,{targetView:"Rcomponent"});a.on(n.Events.stateChanged,function(){var e=a.getState(),t=o.Setting;if(e.on){var n=!0!==t.get();t.set(n)}else{var i=!0!==t.get();t.set(i)}});var i=f.keepMailsSetting.title;$.e(t.getRightHeaderComponentWrapper()).prependDOM(zdom("span",null,i))}();var n=r("Apps.VacationReply");n&&n.handleContainerEvent(e,t)};s.create(S,{props:{title:f.title,openable:!0},attributes:{category:h},openAction:s.CardActions.OpenPageAction(v)}),function(){c.create(b,{props:{title:f.createNew},attributes:{type:m.Action,card:S},primaryAction:function(){t.setProp({openNew:!0}),M()}});var e=c.create(y,{props:{title:f.keepMailsSetting.header},attributes:{type:m.LabelAction,card:S},transformer:function(e,t){return"props"===e&&t.hasOwnProperty("value")&&(t.value=!0===t.value?f.keepMailsSetting.enable:f.keepMailsSetting.disable),t},secondaryAction:function(){var e=o.Setting,t=!0!==e.get();e.set(t)}});c.bindSetting(e,o.Setting)}(),l.create(v,{props:{title:f.title},attributes:{type:g.PageAlone,showActionable:!1,card:v,category:"mail",appContainer:!0}}),t=u.create(A,{attributes:{page:v,isReactApp:!0},initialize:E,uninitialize:z,getView:w,handleContainerEvent:O}),e.App=t},"Apps"),_defineSettingsModule("AntiSpam",function(i,e){var a,r=zmail.Settings.Modules,t=r.import("Platform.Components"),n=r.import("Platform.Entities"),o=r.import("Platform.System.Utils"),s=t.SettingCardManager,c=t.SettingCardItemManager,l=t.SettingPageManager,u=t.SettingAppManager,p=n.SettingPage,d=n.SettingCardItem,g=p.Types,m=d.Types,f=zmText.get("zm-settings-core","antispam"),S="antispam",v="antispam",A="antispam",h="mail",y="zm-settings-app-antispam",C="domain-list",b="email-list",M="unsubscribed-list",P="language-filter-list",E="trusted-rejected-list",z=function(){return s.CardActions.OpenPageAction(v)()},w=function(){return zmAppLoader.load(y).then(function(){})},O=function(){return w()},I=function(){ZMStore.getInstance("WLEmailCollection").resetList(),ZMStore.getInstance("BLEmailCollection").resetList(),ZMStore.getInstance("WLDomainCollection").resetList(),ZMStore.getInstance("BLDomainCollection").resetList()},T=function(){u.create(A,{attributes:{page:v,isReactApp:!0},initialize:O,uninitialize:I,getView:function(){return i.getView()},handleContainerEvent:function(e,t){var n;o.debugLog("Container event",e,t),"active"===e?(n=r.import("MailSuite.App.Core.Framework.Sections.Category.getComponents")(),a=n.breadcrumbSection,ReactDOM.render(React.createElement(i.StatusBand),a.getLeftHeaderComponentWrapper())):ReactDOM.unmountComponentAtNode(a.getLeftHeaderComponentWrapper())}})};s.create(S,{props:{addToSearch:!1,title:f.title,openable:!0},attributes:{category:h},openAction:z}),c.create(b,{props:{title:f.email},attributes:{type:m.Action,card:S},primaryAction:function(){w().then(function(){zmail.Settings.MailSuite.Apps.AntiSpam.Models.tabs.set({currentTab:1}),zmail.Settings.MailSuite.Apps.AntiSpam.Models.emailAddrTabs.set({currentTab:1}),z()})}}),c.create(E,{props:{title:f.trustreject},attributes:{type:m.Action,card:S},primaryAction:function(){w().then(function(){zmail.Settings.MailSuite.Apps.AntiSpam.Models.tabs.set({currentTab:1}),zmail.Settings.MailSuite.Apps.AntiSpam.Models.emailAddrTabs.set({currentTab:2}),z()})}}),c.create(C,{props:{title:f.domain},attributes:{type:m.Action,card:S},primaryAction:function(){w().then(function(){zmail.Settings.MailSuite.Apps.AntiSpam.Models.tabs.set({currentTab:2}),z()})}}),c.create(M,{props:{title:f.unsubscribedlist},attributes:{type:m.Action,card:S},primaryAction:function(){w().then(function(){zmail.Settings.MailSuite.Apps.AntiSpam.Models.tabs.set({currentTab:3}),z()})}}),c.create(P,{props:{title:f.langfilter},attributes:{type:m.Action,card:S},primaryAction:function(){w().then(function(){zmail.Settings.MailSuite.Apps.AntiSpam.Models.tabs.set({currentTab:4}),z()})}}),l.create(v,{props:{title:f.pageTitle},attributes:{type:g.PageAlone,card:v,category:"mail",appContainer:!0,pageCSSClassName:""},onComponentCreate:function(e){a=e}}),T()},"MailSuite.Apps"),_defineSettingsModule("ImportExport",function(e,a){var r,t=a("Platform.Components"),n=a("Platform.Entities"),o=a("Platform.System.Utils"),i=t.SettingCardManager,s=t.SettingCardItemManager,c=t.SettingPageManager,l=t.SettingAppManager,u=n.SettingPage,p=n.SettingCardItem,d=u.Types,g=p.Types,m=zmText.get("zm-settings-core","importexport"),f={title:m.title,importLog:m.importLog,exportLog:m.exportLog},S="importexport",v="importexport",A="sa-importexport",h="mail",y="zm-settings-app-importexport",C="import-log",b="export-log",M=function(){return zmAppLoader.load(y)},P=function(){return M().then(function(){var e=a("Apps.ImportExport.Models");e.ImportList.initialize(),e.ExportList.initialize()})},E=function(){var e=a("Apps.ImportExport.Models");e.ImportList.uninitialize(),e.ExportList.uninitialize()},z=function(){l.create(A,{attributes:{page:v,isReactApp:!0},initialize:P,uninitialize:E,getView:function(){return a("Apps.ImportExport.Views.UIComponents").getView()},handleContainerEvent:function(e,t){var n,i;"active"===e?(n=a("MailSuite.Common.React.UIComponents.AccountsBand"),i=a("MailSuite.App.Core.Framework.Sections.Category"),r=i.breadcrumbSection(),ReactDOM.render(React.createElement(n),r.getRightHeaderComponentWrapper())):ReactDOM.unmountComponentAtNode(r.getRightHeaderComponentWrapper()),o.debugLog("Container event",e,t)}})};i.create(S,{props:{addToSearch:!1,title:f.title,openable:!0},attributes:{category:h},openAction:function(){i.CardActions.OpenPageAction(v)()}}),s.create(C,{props:{title:f.importLog},attributes:{type:g.Action,card:S},primaryAction:function(){M().then(function(){s.CardItemActions.OpenPageAction(v)(),a("Apps.ImportExport.Views.Utils").showImportList()})}}),s.create(b,{props:{title:f.exportLog},attributes:{type:g.Action,card:S},primaryAction:function(){M().then(function(){s.CardItemActions.OpenPageAction(v)(),a("Apps.ImportExport.Views.Utils").showExportList()})}}),c.create(v,{props:{title:f.title,showTitle:!1},attributes:{category:"mail",appContainer:!0,type:d.PageAlone,card:v,showActionable:!1,pageCSSClassName:""},onComponentCreate:function(e){r=e}}),z()},"MailSuite.Apps"),zmail.Settings.Modules.create("Apps.SendMailAs.models").accountInfo=Zmail.Model.extend({defaults:{},initialize:function(){},idAttribute:"accId",validate:function(){},parse:function(e){var t={};return t.accId=e.accId||e.acId,t.sendId=e.sendId,t.emailId=e.eMail,t},url:zmail.conPath+"/jsp/sendMailAs.jsp",serialized:function(e,t){var n=null;return"delete"===e&&(n={mode:"delete",accId:this.id}),n},fetchContent:function(e){return this.sync("get",this,e).done(function(e){})}},{}),function(){var e=zmail.Settings.Modules.create("Apps.SendMailAs.models"),i="getList";e.accIdCollection=Zmail.Collection.extend({initialize:function(){},model:e.accountInfo,url:zmail.conPath+"/jsp/sendMailAs.jsp",serialized:function(e,t){var n=null;return"read"===e&&(n={mode:i}),n},fetchCompleted:!1,fetchList:function(){return this.fetch()},parse:function(e,t){var n=[];return"object"===babelHelpers.typeof(e)?(e.acId||e.accId)&&(n=[e]):Array.isArray(n)&&(n=_(e).each(function(e){(e.acId||e.accId)&&n.push(e)})),n},resetAndSetAll:function(e){}},{getCollection:function(){}})}(),define([],function(){var e=zmail.Settings.Modules.create("Apps.SendMailAs.models"),t=zmail.Core.Namespaces.get("zmail.DataLayer").DSModel,i="SERVERDETAIL_FETCH_STARTED",a="SERVERDETAIL_FETCH_COMPLETED",n=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getDefaults",value:function(){return{isDefault:!1,isSmimeEnabled:!1,dispName:"",isGroup:!1,isEnabled:!1,isAliasOrGroup:!1,isReplyVerified:!1,replyTo:"",mode:"",order:"",isSelected:!1,serverDetails:{},CertificateDetails:[]}}},{key:"getIdAttribute",value:function(){return"sendId"}},{key:"getAttrsConfig",value:function(){return{dispName:"string",isGroup:"boolean"}}},{key:"parse",value:function(e){var t={};return e.sendId&&(t.sendId=e.sendId),e.isAlias&&(t.isEnabled=e.isAlias&&"true"===e.isAlias),e.group&&(t.isGroup=e.group&&"true"===e.group),e.isZoho&&(t.isAliasOrGroup=e.isZoho&&"true"===e.isZoho),e.isDefault&&(t.isDefault=e.defaut&&"true"===e.defaut),e.dispName&&(t.dispName=e.dispName||""),e.fromAddr&&(t.fromAddr=e.fromAddr||""),e.replyTo&&(t.replyTo=e.replyTo||""),e.CertificateDetails&&(t.CertificateDetails=e.CertificateDetails||[]),e.hasOwnProperty("isSmimeEnabled")&&(t.isSmimeEnabled=e.isSmimeEnabled||!1),e.hasOwnProperty("isSelected")&&(t.isSelected=e.isSelected||!1),e.order&&(t.order=e.order),e.isReplyVerified&&(t.isReplyVerified=e.isReplyVerified&&"true"===e.isReplyVerified),e.mode&&(t.mode=Number(e.mode)),t}},{key:"fetchServerDetails",value:function(e){var n=this;return n.serverDataFetched=!1,n.trigger(i),n.url="/zm/sendMailAs.do",n.triggerAction("frmEdit",n,e).then(function(e){var t=e.resp;n.serverDataFetched=!0,n.updateServerDetails(t),n.trigger(a)})}},{key:"fetchSmimeCertificates",value:function(e){var n=this;return n.smimeCertificateFetched=!1,n.trigger(i),e=e||{},n.url="/zm/SMimeAction.do",n.triggerAction("getAllCertificate",n,e).then(function(e){var t=e;n.updateSmimeCertificateDetail(t),n.smimeCertificateFetched=!0,n.trigger(a)})}},{key:"DisableSmime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=this;return n.url="/zm/SMimeAction.do",n.action=e.action,n.triggerAction("DisableSmime",n,e).then(function(e){if("success"===e.resp.status){var t=e;n.updateDisableStatus(t),n.trigger(a),n.triggerPublish({addr:e.model.attributes.fromAddr,mode:"disabled"})}})}},{key:"triggerPublish",value:function(e){$.publish("sendmailas/smimeCertChange",e)}},{key:"EnableSmime",value:function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=this;return i.url="/zm/SMimeAction.do",i.action=n.action,i.certId=n.certId,i.triggerAction("EnableSmime",i,n).then(function(e){if("success"===e.resp.status){var t=e;t.certId=n.certId,i.updateEnableStatus(t),i.trigger(a),i.triggerPublish({addr:e.model.attributes.fromAddr,mode:"enabled"})}})}},{key:"DeleteCertificate",value:function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=this;return i.url="/zm/SMimeAction.do",i.action=n.action,i.certId=n.certId,i.triggerAction("DeleteCertificate",i,n).then(function(e){if("success"===e.resp.status){var t=e;t.certId=n.certId,i.updateCertificate(t),i.trigger(a)}})}},{key:"updateSmimeCertificateDetail",value:function(e){var t=this,n=e.resp;0<n.length&&n.forEach(function(e){"true"===e.active&&t.set({isSmimeEnabled:!0})}),t.set({CertificateDetails:e.resp})}},{key:"updateCertificate",value:function(t){var e=this.attributes.CertificateDetails,n=[];e.forEach(function(e){t.certId!==e.certificateId&&n.push(e)}),this.set({CertificateDetails:n})}},{key:"updateDisableStatus",value:function(e){var t=!1;e.isEnabled&&(t=!0),this.set({isSmimeEnabled:t});var n=this.attributes.CertificateDetails,i=[];n.forEach(function(e){e.active="false",i.push(e)}),this.set({CertificateDetails:i})}},{key:"updateEnableStatus",value:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).certId;this.set({isSmimeEnabled:!0});var e=this.attributes.CertificateDetails,n=[];e.forEach(function(e){e.certificateId===t?e.active="true":e.active="false",n.push(e)}),this.set({CertificateDetails:n})}},{key:"updateServerDetails",value:function(e){var t,n={mode:e[0],name:e[1]};e[2]&&(n.server=e[2]),4===e.length&&e[3].repTo?(t=e[3],n.repTo=e[3].repTo):3===e.length&&e[2].repTo&&(t=e[2]),t&&(n.repProp={repTo:t.repTo,isRepVeri:t.isRepVeri}),this.set({serverDetails:n})}}]),t}(t);return e.SendMailAs=n}),define([],function(){var n=zmail.Settings.Modules.create("Apps.SendMailAs.models"),e=zmail.Core.Namespaces.get("zmail.DataLayer").DSCollection,a=$.Deferred(),i=n.SendMailAs,t=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getBaseModelClass",value:function(){return i}},{key:"smimeEnabledAddress",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this;return e.url=zmail.conPath+"/SMimeAction.do",e.type="GET",e.isXHRNeeded=!1,t.triggerAction("smimeEnabledAddress",e).then(function(i){return t.models.forEach(function(e){var t=e.get("fromAddr"),n=i.resp[t];n?e.set({isSmimeEnabled:n}):e.set({curFromAddr:n})}),a.resolve(i,t.model)}),a.promise()}},{key:"checkisSmimeEnabled",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return e.url=zmail.conPath+"/SMimeAction.do",e.type="get",e.isXHRNeeded=!1,this.triggerAction("checkisSmimeEnabled",e).then(function(e){n.isSmimeEnabled=e.resp.enabled,t.resolve(e.resp)}),t.promise()}}]),t}(e);return n.SendMailAsCollection=t}),define([],function(){var C=zmail.Settings.Modules.create("Apps.SendMailAs.models"),e=zmail.Core.Namespaces.get("zmail.DataLayer").Adapter.HTTPAdapter,c="frmList",l="frmSave",u="frmDelete",p="frmResend",d="frmVerify",g="frmZacc",m="frmUpdate",f="getAll",S="frmEdit",v="replyToResend",A="replyToVerify",h="certificateAction",b=["DisableSmime","EnableSmime","DeleteCertificate","smimeEnabledAddress","checkisSmimeEnabled"],t=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getUrl",value:function(){return zmail.conPath+"/sendMailAs.do"}},{key:"getDefaultRequestMethods",value:function(){return{create:"POST",update:"POST",patch:"POST",delete:"POST",read:"GET"}}},{key:"serialize",value:function(e,t,n){var i,a,r=null;if("create"===e)r={mode:l,dispName:t.get("dispName"),emailId:t.get("fromAddr")},n.isZoho?r.isZ=!0:(r.smtpServer=n.smtpServer,r.smtpPort=n.smtpPort,r.sslMode=n.sslMode,n.auth&&(r.uName=n.uName,r.pass=n.pass)),n.replyTo&&(r.replyTo=n.replyTo);else if("delete"===e)r={mode:u,smId:t.id};else if("update"===e)a=n.attrs,r={smId:t.id,dispName:a.dispName,emailId:a.emailId},t.get("isAliasOrGroup")?i=g:(i=m,r.otMode=a.accMode,a.isZoho?r.isZ=!0:(r.smtpServer=a.smtpServer,r.smtpPort=a.smtpPort,r.sslMode=a.sslMode,a.auth&&(r.uName=a.uName,r.pass=a.pass))),a.replyTo&&(r.replyTo=a.replyTo),r.mode=i;else if("fetchAll"===e)r={mode:c};else if("frmEdit"===e)r={mode:S,smId:t.id,isDef:t.get("isDefault")};else if("resendCode"===e)r={smId:t.id,emailId:t.get("fromAddr"),mode:p};else if("resendCode_replyto"===e)r={emailId:t.get("fromAddr"),replyTo:t.get("replyTo"),mode:v};else if("verify_replyto"===e)r={emailId:t.get("fromAddr"),mode:A,vCode:n.code};else if("verify"===e)r={smId:t.id,emailId:t.get("fromAddr"),mode:d,vCode:n.code};else if("getAllCertificate"===e)r={emailAddress:t.get("fromAddr"),mode:f};else if("DisableSmime"===e)r={email:t.get("fromAddr"),action:n.action,mode:h};else if("EnableSmime"===e||"DeleteCertificate"===e)r={email:t.get("fromAddr"),action:n.action,mode:h,certificateId:n.certId};else if("smimeEnabledAddress"===e){var o=C.API.getConfirmedList(),s=[];o.forEach(function(e){s.push(e.emailId)}),r={emailAddresses:s.toString(),mode:"isSmimeEmail"}}else"checkisSmimeEnabled"===e&&(r={mode:"isSmimeEnabled"});return r}},{key:"normalize",value:function(e,t,n){var i,a,r={};if("fetchAll"===e){var o=(t=t[0]).fact;C.sendMailIdMap=t.acLst;var s=[];for(i in o)o[i].sendId&&s.push(o[i]);r=s}else if("create"===e){var c,l,u,p,d,g;if("Success"===(c=t[0]).oth.st){for(p=(u=Object.keys(c.fact)).length,d=0;d<p;d++)if(c.fact[u[d]].fromAddr===c.semId.emId){l=c.fact[u[d]].sendId;break}C.API.updateModel(c.fact),g=!0,void 0!==c.vfyst&&"false"===c.vfyst&&(g=!1),r.sendId=l,a=c.fact[l],r.isReplyVerified=a.isReplyVerified,a.isAlias&&"true"===a.isAlias&&(g=!0),r.isEnabled=g,r.mode=a.mode,r.isAlias=a.isAlias,r.order=a.order,r.replyTo=a.replyTo||""}else r.error=!0}else if("update"===e){var m;"Success"===(m=t[0]).oth.st?(a=m.fact[n.attrs.sendId],C.API.updateModel(m.fact),r.isReplyVerified=a.isReplyVerified,r.isEnabled=a.isAlias&&"true"===a.isAlias,r.order=a.order,r.serverDetails={}):r.error=!0}else if("resendCode"===e||"resendCode_replyto"===e){var f;"Error"===(f=t[0]).oth.st?r.error=!0:r.status="s",r.msg=f.oth.msg}else if("verify"===e){var S=t[0];"Error"===S.oth.st?r.status="e":(r.status="s",a=S.fact[n.sendId],r.isReplyVerified=a.isReplyVerified&&"true"===a.isReplyVerified,r.isEnabled=a.isAlias&&"true"===a.isAlias),r.msg=S.oth.msg}else if("verify_replyto"===e){var v=t[0],A="",h="";if(v.oth)A=v.oth.st,h=v.oth.msg;else{var y=t[1];A=y.st,h=y.msg}"Error"===A?r.status="e":(r.status="s",a=v.fact[n.sendId],r.isReplyVerified=a.isReplyVerified&&"true"===a.isReplyVerified,r.isEnabled=a.isAlias&&"true"===a.isAlias),r.msg=h}else"getAllCertificate"===e?r=t[n.get("fromAddr")]:b.includes(e)?r=t:"frmEdit"===e?t[0]&&(r=(t[0].isZ&&"zohosmtp"===t[0].isZ&&(t[0].isZoho=!0),t)):r=t;return r}}]),t}(e);return C.HTTPAdapter=t}),function(){var e,t=zmail.Settings.Modules.import("Apps.SendMailAs.models"),n=zmText.get("zm-settings-core","sendmailas"),i="FETCH_STARTED",a="FETCH_COMPLETED",r=t.SendMailAsCollection,o=null,s=$.Deferred(),c=function(){o.trigger(i),o.fetchAll().then(function(e){s.resolve(),o.checkisSmimeEnabled().then(function(e){"true"===e.enabled&&o.smimeEnabledAddress()}),o.trigger(a)})},l=function(e){$.publish("FROM_ADDRESS/CHANGE",{attr:e.attributes,dispName:e.get("dispName"),emailId:e.get("fromAddr")})},u=function(e){$.publish("FROM_ADDRESS/ADD",{id:e.id,dispName:e.get("dispName"),emailId:e.get("fromAddr"),attr:e.attributes})},p=function(e){$.publish("FROM_ADDRESS/REMOVE",{id:e.id,emailId:e.get("fromAddr")})};e={adapters:[{id:"http-adapter",type:"default",classObj:t.HTTPAdapter}],default:"http-adapter"},o=ZMStore.createInstance("sendmailas",r,{adapterConfig:e}),c(),o.on("change:dispName",l),o.on("change:isEnabled",u),o.on("change:isReplyVerified",l),o.on("add",u),o.on("remove",p),t.getSendMailAsCollection=function(){return ZMStore.getInstance("sendmailas")},t.resetAndFetch=function(){return s=$.Deferred(),o.reset(),c()},t.deleteModel=function(e){var t="object"===babelHelpers.typeof(e)?e.id:e;return o.get(t).destroy().then(function(){o.remove(t),zmUtil.succErrMsg("s",n.succMsg.deleted)})},t.addNewModel=function(e,t){return ZMStore.createRecord("sendmailas",e,t).then(function(e){zmUtil.succErrMsg("s",n.succMsg.added)},function(e){var t=e.resp[0];throw t=t&&t.oth,zmUtil.succErrMsg("e",t.msg),t})},t.resendConfirmation=function(e){return o.get(e).triggerAction("resendCode",{})},t.verifyFromAddress=function(e,t){var n=o.get(e);return n.triggerAction("verify",{code:t,sendId:e}).then(function(e){return"e"!==e.resp.status&&n.set({isEnabled:!0}),e})},t.resendReplyToConfirmation=function(e){return o.get(e).triggerAction("resendCode_replyto",{})},t.verifyReplyTo=function(e,t){var n=o.get(e);return n.triggerAction("verify_replyto",{code:t,sendId:e}).then(function(e){return"e"!==e.resp.status&&n.set({isReplyVerified:!0}),e})},t.sendMailCollectionDeferred=s}(),_defineSettingsModule("models",function(e,t,n){var i={},a=function(e){return{id:e.id,dispName:e.get("dispName"),emailId:e.get("fromAddr"),isEnabled:e.get("isEnabled"),mode:e.get("mode"),order:e.get("order"),isSmimeEnabled:e.get("isSmimeEnabled")}},r=function(){return ZMStore.getInstance("sendmailas")},o=function(){var t,n,e=r(),i=[];return e.forEach(function(e){(n=e.get("mode"))&&(n=Number(n)),t=e.get("isEnabled"),6!==n&&t&&i.push(a(e))}),i},s={gmail:"smtp.gmail.com",aol:"smtp.aol.com"};i.getConfirmedList=o,i.getFromAddressList=function(){var e=r(),t=[];return e.forEach(function(e){t.push(a(e))}),t},i.getFromAddrDetails=function(e){var t,n=r();if(e&&(t=n.get(e)))return a(t)},i.getUnverifiedListCount=function(){var t=0;return r().forEach(function(e){e.get("isEnabled")||t++}),t},i.getAliasListCount=function(){var t=0;return r().forEach(function(e){!e.get("isAliasOrGroup")||e.get("isGroup")||e.get("isDefault")||t++}),t},i.getSendMailId=function(e){for(var t=zmail.Settings.Modules.create("Apps.SendMailAs.models"),n=Object.keys(t.sendMailIdMap),i=n.length,a=0;a<i;a++)if(t.sendMailIdMap[n[a]].eMail===e)return{sendMailId:t.sendMailIdMap[n[a]].sendId,mailID:t.sendMailIdMap[n[a]].acId}},i.getAliasList=function(){var t=[];return r().forEach(function(e){!e.get("isAliasOrGroup")||e.get("isGroup")||e.get("isDefault")||t.push(e.get("fromAddr"))}),t},i.getPrimaryEmail=function(){var e=o(),t={};return e.forEach(function(e){e.emailId===zmail.aInfo[zmUtil.getZohoAccId()].mailId&&(t=e)}),t},i.updateModel=function(n){var i=r();Object.keys(n).forEach(function(e){var t=i.get(n[e].sendId);t&&t.set({order:n[e].order})})},i.getServerDetails=function(e){var t,n,i,a;if(a=e.indexOf("@"),i=e.substr(0,a),t=(n=e.substr(a+1)).substr(0,n.indexOf(".")),t=s[t])return{uName:i,sName:t}},i.checkIsNumber=function(e){return/^\d+$/.test(e)},e.API=i},"Apps.SendMailAs"),_defineSettingsModule("Validators",function(e,t){var i=zmail.Utils.EmailValidator,r=zmText.get("zm-settings-core","sendmailas").errMsg;e.validateUserCred=function(e){var t=!0,n="",i=e.uName,a=e.pass;return i?a||(t=!1,n=r.emptyPass):(t=!1,n=r.emptyUname),{valid:t,errMsg:n}},e.validateServerName=function(e){var t=!0,n="";return e||(t=!1,n=r.emptyServerDetails),t&&((t=!zmUtil.hasSpecialChars(e,"dispName"))||(n=r.serverDetailsHasSpecialChar)),{valid:t,errMsg:n}},e.validateDispName=function(e){var t=!0,n="";return e||(t=!1,n=r.emptyName),t&&((t=!zmUtil.hasSpecialChars(e,"dispName"))||(n=r.nameHasSpecialChar)),{valid:t,errMsg:n}},e.validateEmailId=function(e){if(!e)return{valid:!1,errMsg:r.emptyEmail};var t=i.validate(e),n={};return n.valid=t.status,t.status||(n.errMsg=r.validEmail),n},e.validateReplyToId=function(e){var t=i.validate(e),n={};return n.valid=t.status,t.status||(n.errMsg=r.validReplyToEmail),n}},"Apps.SendMailAs"),_defineSettingsModule("SendMailAs",function(e,a){var t,n,i,r,o=a("Platform.Components"),s=a("Platform.Entities"),c=a("Platform.System.Utils"),l=o.SettingCardManager,u=o.SettingCardItemManager,p=o.SettingPageManager,d=o.SettingAppManager,g=s.SettingPage,m=s.SettingCardItem,f=g.Types,S=m.Types,v=a("Apps.SendMailAs.models"),A=zmText.get("zm-settings-core","sendmailas"),h="sendmailas",y="sendmailas",C="sa-sendmailas",b="mail",M="sendmailas-new",P="sendmailas-manage",E="sendmailas-unverified",z="sendmailas-alias",w="remove",O="add",I="change:isEnabled",T="Apps.SendMailAs.BaseView",D=l.CardActions.OpenPageAction(y),k=function(){return zmModules.getSendMailAsViewModule()},_=function(){var e=c.makeDeferred();return k().then(function(){a(T).initialize({_settingPageComponent:t}),e.resolve()},function(){e.reject()}),e.promise()},R=function(){var e=c.makeDeferred();return k().then(function(){a(T).uninitialize({_settingPageComponent:t}),e.resolve()}),e.promise()},L=function(){var e,t,n=a("MailSuite.App.Core.Framework.Sections.Category").breadcrumbSection(),i=(e=zmText.get("zm-settings-app-sendmailas"),t=zdom("span",{className:"zmLink"}," ",e.setDefault),$.e(t).on("click",function(){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage("mailaccounts")}),$.e(t));$.e(n.getRightHeaderComponentWrapper()).prependDOM(i)},V=function(){return a(T).getAppView()},N=function(e,t){var n=a(T);n&&n.handleContainerEvent(e,t),"active"===e&&L()},H=function(){var e=v.API;n.setProp({value:e.getUnverifiedListCount()})},F=function(){var e=v.API;i.setProp({value:e.getAliasListCount()})},x=function(){v.sendMailCollectionDeferred.done(function(){var e,t;e=v.API,n=u.create(E,{props:{title:A.unverifiedList,value:e.getUnverifiedListCount()},attributes:{type:S.LabelValue,card:h},primaryAction:function(){D()}}),i=u.create(z,{props:{title:A.aliasAddress,value:e.getAliasListCount()},attributes:{type:S.LabelValue,card:h},primaryAction:function(){D()}}),(t=ZMStore.getInstance("sendmailas")).on(w,H),t.on(O,H),t.on(I,H),t.on(O,F)})},U=function(){r.setProp({openNew:!0}),D()};l.create(h,{props:{title:A.title,openable:!0},attributes:{category:b},openAction:l.CardActions.OpenPageAction(y)}),u.create(M,{props:{title:A.createNew},attributes:{type:S.Action,card:h},primaryAction:function(){r.setProp({openNew:!0}),D()}}),u.create(P,{props:{title:A.manageFromAddress},attributes:{type:S.Action,card:h},primaryAction:function(){D()}}),p.create(y,{props:{title:A.title,showTitle:!0},attributes:{type:f.PageAlone,card:y,category:"mail",appContainer:!0,pageContainerClassNames:"zmSetPage noPad",pageCSSClass:"zmSetNPwra"},onComponentCreate:function(e){t=e}}),r=d.create(C,{attributes:{page:y,isReactApp:!0},initialize:_,uninitialize:R,getView:V,handleContainerEvent:N}),x(),e.App=r,e.createNew=U},"Apps"),_defineSettingsModule("Models",function(e,t){var n=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getDefaults",value:function(){return{accountUsageSize:"",displayName:"",email:"",externalPOPAllowed:!1,id:"",imapIncomingServerAddress:"",imapIncomingServerPort:"",imapIncomingServerSecureMode:"",isCurrentActiveAccount:!1,isBlocked:!1,isDefault:!1,isEnabled:!1,isImapEnabled:!1,isImapExpungeMailsActive:!1,isImapFeatureAvailable:!1,isPopAccount:!1,isPopDeleteMailsActive:!1,isPopEnabled:!1,isPopEnabledForAllMails:!1,isPopFeatureAvailable:!1,isReplyToEmailVerified:!1,isSendAsEmailVerified:!1,isSpamFolderIncludedInPop:!1,isZohoAccount:!1,popIncomingServerAddress:"",popIncomingServerPort:"",popIncomingServerSecureMode:"",reasonForBlock:-1,replyToEmail:"",saveSentCopy:!1,sendAsEmail:"",sendAsEmailID:"",sequenceNumber:1,smtpOutgoingServerAddress:"",smtpOutgoingServerPort:"",smtpOutgoingServerSecureMode:"",mailForwardSettings:{isMailForwardFeatureAvailable:!1,keepEmailCopyOnForward:0},mailForwardList:[],expanded:!1,lastSyncTime:"",initialSyncCompleted:!0}}},{key:"getIdAttribute",value:function(){return"id"}},{key:"parse",value:function(e){return e}},{key:"cloneAttributes",value:function(){return this.attributes}}]),t}(zmail.Core.Namespaces.get("zmail.DataLayer").DSModel);e.ZohoAccountModel=n},"Apps.PopAccounts"),_defineSettingsModule("Models",function(e,t){var n=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getDefaults",value:function(){return{accountUsageSize:"",displayName:"",email:"",id:"",imapIncomingServerAddress:"",imapIncomingServerPort:"",incomingServerSSLEnabled:!1,incomingServerUserName:"",isCurrentActiveAccount:!1,isBlocked:!1,isDefault:!1,isEnabled:!1,isPopAccount:!1,isSendAsEmailVerified:!1,isZohoAccount:!1,popDeleteMessagesDaysToKeep:"",popDeleteMessagesOnServerMode:"",popDisabledReason:"",reasonForBlock:-1,sendAsEmail:"",sendAsEmailID:"",sequenceNumber:1,serviceProvider:-1,expanded:!1,lastSyncTime:"",initialSyncCompleted:!0}}},{key:"getIdAttribute",value:function(){return"id"}},{key:"parse",value:function(e){return e}},{key:"cloneAttributes",value:function(){return this.attributes}}]),t}(t("Apps.PopAccounts.Models.ZohoAccountModel"));e.PopAccountModel=n},"Apps.PopAccounts"),_defineSettingsModule("Models",function(e,t){var n=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getDefaults",value:function(){return{email:"",fetchDelay:"",fetchMailCountPerCycle:""}}},{key:"getIdAttribute",value:function(){return"email"}},{key:"parse",value:function(e){return e}},{key:"cloneAttributes",value:function(){return this.attributes}}]),t}(t("Apps.PopAccounts.Models.ZohoAccountModel"));e.popFetchModel=n},"Apps.PopAccounts"),_defineSettingsModule("Collection",function(e,o){var t=zmail.Core.Namespaces,a=o("Apps.PopAccounts"),n=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getBaseModelClass",value:function(e){return a.Models.ZohoAccountModel}},{key:"addExistingPopToModel",value:function(t){var n,e=Object.keys(t),i=a.Util.Util;e.forEach(function(e,t){e.isZohoAccount&&(n=t)}),e.splice(n,1),e.forEach(function(e){i.addModelToCollection(t[e])}),i.reArrangeInitialModels()}},{key:"fetchSettingModel",value:function(e,t){a.Util.Util.addFetchModelToCollection({fetchDelay:e.fetchDelay,fetchMailCountPerCycle:e.fetchMailCountPerCycle,email:t,fetchModel:!0})}},{key:"fetchZohoAccount",value:function(){var n=this;return new Promise(function(t,e){n.triggerAction("fetchZohoAccount").then(function(e){t(e.resp)})})}},{key:"verifyMailForward",value:function(e){var i=this;return new Promise(function(t,n){i.triggerAction("verifyMailForward",e).then(function(e){t(e.resp)},function(e){n(e)})})}},{key:"addNewPopAccount",value:function(e,a){var r=this;return new Promise(function(i,t){var n=r;n.triggerAction("validateAccountConfig",e).then(function(e){if(!1===e.resp.valid&&2===e.resp.errorCode)return t(),!1;n.triggerAction("addNewAccount",a).then(function(e){i(e.resp);var t=o("Apps.PopAccounts.Util").Util,n=t.addModelToCollection(e.resp);zmail.accId===n[0].id&&(n[0].isCurrentActiveAccount=!0),n[0].set({initialSyncCompleted:!1}),t.addNewModToCollection(n[0]),e.resp.isDefault&&t.updateDefaultAccState(e.resp.id)},function(e){t(e)})},function(e){t(e)})})}},{key:"verifyReplyToEmail",value:function(e){var i=this;return new Promise(function(t,n){i.triggerAction("verifyReplyToEmail",e).then(function(e){t(e.resp)},function(e){n(e)})})}},{key:"reOrderAccounts",value:function(e){var i=this;return new Promise(function(t,n){i.triggerAction("reOrderAccounts",e).then(function(e){t(e.resp)},function(e){n(e)})})}},{key:"fetchAllAccounts",value:function(){var e=this;return new Promise(function(t,n){e.triggerAction("fetchAllAccounts").then(function(e){t(e.resp)},function(e){n(e)})})}},{key:"resendReplyToVerificationCode",value:function(e){var i=this;return new Promise(function(t,n){i.triggerAction("resendReplyToVerificationCode",e).then(function(e){t(e.resp)},function(e){n(e)})})}},{key:"resendMailForwardVerificationCode",value:function(e){var i=this;return new Promise(function(t,n){i.triggerAction("resendMailForwardVerificationCode",e).then(function(e){t(e.resp)},function(e){n(e)})})}},{key:"deleteAccount",value:function(e){var i=this;return new Promise(function(t,n){i.triggerAction("deleteAccount",e).then(function(e){t(e.resp)},function(e){n(e)})})}}]),t}(t.get("zmail.DataLayer").DSCollection);e.collection=n},"Apps.PopAccounts"),_defineSettingsModule("Adapter",function(e,r){var t=zmail.Core.Namespaces.get("zmail.DataLayer").Adapter.HTTPAdapter,a=["verifyMailForward","resendMailForwardVerificationCode","verifyReplyToEmail","resendReplyToVerificationCode","create","update","delete"],n=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getUrl",value:function(){return"/zm/mailAccounts.do"}},{key:"getDefaultRequestMethods",value:function(){return{create:"POST",update:"POST",patch:"POST",delete:"POST",read:"GET"}}},{key:"updateActiveAccountState",value:function(t){Object.keys(t).forEach(function(e){zmail.accId===t[e].id&&(t[e].isCurrentActiveAccount=!0)})}},{key:"serialize",value:function(e,t,n){var i=r("Apps.PopAccounts.Util").Util,a={};if("fetchAll"===e||"fetchAllAccounts"===e)a.mode="getAllAccountsInfo";else{if("create"===e)return n;"update"===e?(a.mode="updateZohoAccount",Object.assign(a,n.attrs)):"delete"===e?(a.mode="deleteAccount",a.accountID=t.attributes.id):"fetchZohoAccount"===e?(a.mode="getAccountInfo",a.accountID=i.getZohoAccount().id):"verifyMailForward"===e?(a.mode=e,a.email=n.email,a.confirmationCode=n.code):"resendMailForwardVerificationCode"===e?(a.mode="resendMailForwardVerification",a.email=n.email):"verifyReplyToEmail"===e?(a.mode="verifyReplyToEmail",a.accountID=n.accountID,a.confirmationCode=n.code):"resendReplyToVerificationCode"===e?(a.mode="resendReplyToVerification",a.accountID=n.accountID):"validateAccountConfig"===e||"addNewAccount"===e?delete(a=n).isCollectionAction:"reOrderAccounts"===e&&(a.mode="updateAccountOrder",a.accountSequence=n.accList)}return a}},{key:"normalize",value:function(e,t,n){var i=[];return"fetchAll"===e?(this.updateActiveAccountState(t.accounts),i.push(t.accounts[0]),i):"fetchZohoAccount"===e?t.account:(a.includes(e),t)}}]),t}(t);e.Adapter=n},"Apps.PopAccounts"),_defineSettingsModule("Util",function(e,r){var p,d,t,o,i="0",n=r("Apps.PopAccounts.Models"),a=[],s=!1,c=!1,l=r("Apps.PopAccounts"),u=r("Platform.UI.Utils"),g={updateAppProp:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r("Apps.PopAccounts.App").setProp(e),g.updateApp()},addModelToCollection:function(e){var t=new n.PopAccountModel({attrs:e});return a.push(t),a},isForwardListExist:function(t){if(r("Apps.PopAccounts.Validators").Validators.emailAddress(t)){var n=!1,e=g.getZohoAccount();return e.mailForwardList.forEach(function(e){e.email===t&&(n=!0)}),n||t!==e.email?n:"Mailbox address not able to add"}return"Invalid Email Address"},isAccountExist:function(t){var e=r("Apps.PopAccounts.Validators").Validators,n=!1;e.emailAddress(t)&&ZMStore.getInstance("PopAccounts").models.forEach(function(e){e.attributes.email===t&&(n=!0)});return n},addNewModToCollection:function(e){var t=ZMStore.getInstance("PopAccounts");t.push(e);var n=g.getPopFetchModel();(t=t.models).splice(n.index,1),t.push(n.model),g.updateApp()},isRearrangeAvl:function(){return 3<ZMStore.getInstance("PopAccounts").models.length},getPopFetchModel:function(){var n,i;return ZMStore.getInstance("PopAccounts").forEach(function(e,t){e.attributes.hasOwnProperty("id")||(n=e,i=t)}),{model:n,index:i}},reArrangeInitialModels:function(){a.sort(function(e,t){return e.attributes.sequenceNumber>t.attributes.sequenceNumber?1:-1});var t=ZMStore.getInstance("PopAccounts");a.forEach(function(e){t.push(e)}),g.addBaseIdentificationNumber(t.models),a=[]},createNewAccountModel:function(){return t=new n.NewPopAccountModel},addFetchModelToCollection:function(e){var t=new n.popFetchModel({attrs:e});ZMStore.getInstance("PopAccounts").push(t)},createNewModel:function(e){var t=new n.PopAccountModel({attrs:e.attrs});g.addNewModel(t,e.opts).then(function(e){})},addNewModel:function(e,t){return ZMStore.createRecord("PopAccounts",e,t).then(function(e){return e},function(e){return e})},addBaseIdentificationNumber:function(e){var t=1;e.forEach(function(e){e.attributes.id&&(e.attributes.BaseIdentification=t),t++})},findIndex:function(e,n){var i;return e.forEach(function(e,t){e.attributes.sequenceNumber===n&&(i=t)}),i},handleDragStart:function(e){o=e},updateApp:function(){var e=r("Apps.PopAccounts.App");e&&e.triggerViewUpdate()},sortAppModels:function(e){e.sort(function(e,t){return e.attributes.sequenceNumber>t.attributes.sequenceNumber?1:-1}),g.addBaseIdentificationNumber(e)},sortAppModelsBasedOnIdentification:function(e){e.sort(function(e,t){return e.attributes.BaseIdentification>t.attributes.BaseIdentification?1:-1}),e.forEach(function(e){e.attributes.hasOwnProperty("sequenceNumber")&&(e.attributes.sequenceNumber=e.attributes.BaseIdentification)})},handleDragEnd:function(){setTimeout(function(){if(!c){c=!1;var e=ZMStore.getInstance("PopAccounts").models;e.forEach(function(e){e.attributes.hasOwnProperty("toHide")&&delete e.attributes.toHide}),g.sortAppModels(e),g.updateApp()}},0)},handleCardExchange:function(e,t){var n=ZMStore.getInstance("PopAccounts").models;if(e!==t){var i=g.findIndex(n,e),a=g.findIndex(n,t),r=n[i];n.splice(i,1),n.splice(a,0,r),0<(i=g.findIndex(n,o))&&(n[i].attributes.toHide=!0),g.addBaseIdentificationNumber(n),s=!0,g.updateApp()}},destroyExistingStoreModels:function(){var e=ZMStore.getInstance("PopAccounts").models;e.splice(1,e.length)},getAccountIds:function(){var e=ZMStore.getInstance("PopAccounts").models,t=[];return e.forEach(function(e){e.attributes.id&&t.push(e.attributes.id)}),{accList:t.toString()}},getAllAccounts:function(){var e=g.getZohoAccount(),t=g.getAllPopAccount();return t.unshift(e),t},updateAllAccounts:function(){r("Apps.PopAccounts.init").fetchAllAccounts().then(function(e){g.updateStore(e.accounts,!0)})},handleDropCardExchange:function(e,t,n){var i=r("Apps.PopAccounts.init"),a=g.getAccountIds();g.sortAppModelsBasedOnIdentification(ZMStore.getInstance("PopAccounts").models),g.sortAppModels(ZMStore.getInstance("PopAccounts").models),g.updateApp(),i.reOrderAccounts(a).then(function(){r("Apps.PopAccounts").Publishers.reOrderAccounts(a.accList.split(",")),i.fetchAllAccounts().then(function(e){g.updateStore(e.accounts,n)})})},updateStore:function(e,t){var n=ZMStore.getInstance("PopAccounts").models;n.forEach(function(t){e.forEach(function(e){delete t.attributes.toHide,t.attributes.id&&t.attributes.id===e.id&&t.set({sequenceNumber:e.sequenceNumber},{silent:!0})})}),g.addBaseIdentificationNumber(n),g.updateModelInStores(),g.updateApp()},handleEditCardExchange:function(t,n){var i,a;(n=parseInt(n),t!==n)&&(ZMStore.getInstance("PopAccounts").models.forEach(function(e){e.attributes.BaseIdentification===t?i=e.attributes.sequenceNumber:e.attributes.BaseIdentification===n&&(a=e.attributes.sequenceNumber)}),g.handleCardExchange(i,a),g.handleDropCardExchange(i,a,!0))},saveChanges:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};n.idAttribute=n.idAttribute||"id";var i,a,r,o=g.getModel(t,n.idAttribute),s=Object.assign({},o.attributes),c=new Promise(function(e,t){p=e,d=t}),l=!1;n.hasOwnProperty("mailForwardSettings")&&2===n.mailForwardSettings.keepEmailCopyOnForward?l=!0:s.hasOwnProperty("mailForwardSettings")&&2===s.mailForwardSettings.keepEmailCopyOnForward&&(l=!0);var u={};switch(e){case"updateZohoAccountBasic":u={mode:"updateZohoAccount",accountID:s.id,displayName:n.displayName||s.displayName,sendAsEmailID:n.sendAsEmailID||s.sendAsEmailID,deleteMailCopyOnForward:l},n.hasOwnProperty("isPopEnabled")?u.popEnabled=n.isPopEnabled:u.popEnabled=s.isPopEnabled,n.hasOwnProperty("isSpamFolderIncludedInPop")?u.popIncludeSpam=n.isSpamFolderIncludedInPop:u.popIncludeSpam=s.isSpamFolderIncludedInPop,n.hasOwnProperty("isPopDeleteMailsActive")?u.popAutoDeleteMail=n.isPopDeleteMailsActive:u.popAutoDeleteMail=s.isPopDeleteMailsActive,n.hasOwnProperty("isImapExpungeMailsActive")?u.imapAutoExpungeMail=n.isImapExpungeMailsActive:u.imapAutoExpungeMail=s.isImapExpungeMailsActive,n.hasOwnProperty("saveSentCopy")?u.saveSentCopy=n.saveSentCopy:u.saveSentCopy=s.saveSentCopy,n.hasOwnProperty("isImapEnabled")?u.imapEnabled=n.isImapEnabled:u.imapEnabled=s.isImapEnabled,n.hasOwnProperty("replyToEmail")?u.replyToEmail=n.replyToEmail:u.replyToEmail=s.replyToEmail,s.isPopEnabled?s.isPopEnabled&&s.isPopEnabledForAllMails?u.popMode=1:u.popMode=2:u.popMode=0;break;case"addMailForward":u={mode:"addMailForward",email:n.email};break;case"deleteMailForward":u={mode:"removeMailForward",email:n.email,isFilterForward:n.isFilterForward};break;case"enableFilter":u={mode:"enableMailForward",email:n.email};break;case"disableFilter":u={mode:"disableMailForward",email:n.email};break;case"updatePopAccontBasic":u={mode:"updateAccountBasicInfo",accountID:s.id,displayName:n.displayName||s.displayName,sendAsEmailID:n.sendAsEmailID||s.sendAsEmailID},""===n.replyToEmail?u.replyToEmail="":u.replyToEmail=n.replyToEmail||s.replyToEmail;break;case"updatePopAccount":i=n.hasOwnProperty("deleteMessagesMode")?n.deleteMessagesMode:s.popDeleteMessagesOnServerMode,a=n.hasOwnProperty("deleteMessagesDaysCount")?n.deleteMessagesDaysCount:s.popDeleteMessagesDaysToKeep,r=n.hasOwnProperty("useSSL")?n.useSSL:s.incomingServerSSLEnabled,u={mode:"updatePOPAccount",accountID:s.id,username:n.incomingServerUserName||s.incomingServerUserName,password:n.password,serverAddress:n.incomingServerAddress||s.incomingServerAddress,serverPort:n.incomingServerPort||s.incomingServerPort,displayName:n.displayName||s.displayName,sendAsEmailID:n.sendAsEmailID||s.sendAsEmailID,deleteMessagesMode:i,deleteMessagesDaysCount:a,useSSL:r},""!==s.replyToEmail&&(u.replyToEmail=n.replyToEmail||s.replyToEmail);break;case"enableAccount":u={accountID:t,mode:"enableAccount"};break;case"disableAccount":u={accountID:t,mode:"disableAccount"};break;case"updatePopFetchSetting":u={mode:"updatePopFetchSetting",popFetchDelay:n.fetchDelay,popFetchMailCountPerCycle:n.fetchMailCountPerCycle};break;case"deleteAccount":u={mode:"deleteAccount",accountID:n.id};break;case"setAsDefault":u={mode:"setAsDefault",accountID:n.id};break;case"updateSaveSentCopy":u={mode:"setSaveSentCopyOption",enabled:n.saveSentCopy};break;case"updateZohoAccountGeneral":u={mode:"updateZohoAccount",accountID:s.id,displayName:n.displayName||s.displayName,sendAsEmailID:n.sendAsEmailID||s.sendAsEmailID},n.hasOwnProperty("replyToEmail")?u.replyToEmail=n.replyToEmail:u.replyToEmail=s.replyToEmail;break;case"updateZohoAccountImapDetails":u={mode:"updateZohoAccount",accountID:s.id},delete n.idAttribute,Object.assign(u,n);break;case"updateZohoAccountPopDetails":u={mode:"updateZohoAccount",accountID:s.id},n.hasOwnProperty("isPopEnabled")?u.popEnabled=n.isPopEnabled:u.popEnabled=s.isPopEnabled,s.isPopEnabled?s.isPopEnabled&&s.isPopEnabledForAllMails?u.popMode=1:u.popMode=2:u.popMode=0,delete n.idAttribute,Object.assign(u,n)}return g.save(o,u),c},save:function(e,t){e.save(t).then(function(e){p(e)},function(e){d(e)})},deleteAccount:function(e){var t=g.getModel(e),n=r("Apps.PopAccounts.App");t.destroy().then(function(){r("Apps.PopAccounts").Publishers.deletePopAccount(e),n.triggerViewUpdate()})},getZohoAccount:function(){var t;return ZMStore.getInstance("PopAccounts").models.forEach(function(e){e.attributes.isZohoAccount&&(t=e)}),t.attributes},updateModelInStores:function(){var n,i,a,r,e=ZMStore.getInstance("PopAccounts").models;e.forEach(function(e,t){e.attributes.hasOwnProperty("id")||(i=e,r=t)}),e.splice(r,r+1),g.sortAppModels(e),e.forEach(function(e,t){e.attributes.hasOwnProperty("id")&&e.attributes.isZohoAccount&&(n=e,a=t)}),e.splice(a,1),e.splice(0,0,n),e.push(i)},getAllPopAccount:function(){var e=ZMStore.getInstance("PopAccounts").models,t=[];if(e.constructor===Array){var n=JSON.parse(JSON.stringify(e));s||(g.updateModelInStores(),n.sort(function(e,t){return e.sequenceNumber>t.sequenceNumber?1:-1})),s=!1,n.forEach(function(e){e.id&&!e.isZohoAccount&&t.push(e)})}return t},getFethModel:function(){var e=ZMStore.getInstance("PopAccounts").models,t={};return e.forEach(function(e){e.attributes.hasOwnProperty("fetchModel")&&(t=e.attributes)}),t},getFormattedAccountSize:function(e){for(var t=["Bytes","KB","MB","GB","TB"],n=0,i=e;0<Math.round(i/1024);)if(i/=1024,t.length<=++n){n=t.length-1;break}return Math.round(i)+" "+t[n]},setExpandToCollapse:function(){var e=ZMStore.getInstance("PopAccounts").models;i="0",e.forEach(function(e){e.set({expanded:!1})})},updateExpandCollapseState:function(t){g.setExpandToCollapse();var e=ZMStore.getInstance("PopAccounts").models;if(void 0===t){var n=g.getZohoAccount();t=n.id}i=t,e.forEach(function(e){t===e.id&&e.set({expanded:!0})})},getCurrentExpandedCardId:function(){return i},getModel:function(t,n){var i;return n=n||"id",ZMStore.getInstance("PopAccounts").models.forEach(function(e){e.get(n)===t&&(i=e)}),i},getNewPopAccountModel:function(){return t},updateEnableState:function(t){ZMStore.getInstance("PopAccounts").models.forEach(function(e){t!==e.id?e.set({isEnabled:!1}):e.set({isEnabled:!0})})},updateDefaultAccState:function(t){ZMStore.getInstance("PopAccounts")&&ZMStore.getInstance("PopAccounts").models.forEach(function(e){t!==e.id?e.set({isDefault:!1,isCurrentActiveAccount:!1}):e.set({isDefault:!0,isCurrentActiveAccount:!0})})},updateCurrentActiceAccountState:function(e){ZMStore.getInstance("PopAccounts")&&ZMStore.getInstance("PopAccounts").models.forEach(function(e){zmail.accId!==e.id?e.set({isCurrentActiveAccount:!1}):e.set({isCurrentActiveAccount:!0})})},getCurrentFilterIndex:function(n){var i;return ZMStore.getInstance("PopAccounts").models[0].attributes.mailForwardList.forEach(function(e,t){e.email===n&&(i=t)}),i},updateZohoAccount:function(e,t){var n,i,a=ZMStore.getInstance("PopAccounts").models[0];switch(t){case"removeFilter":n=e.email,void 0!==(i=g.getCurrentFilterIndex(n))&&(a.attributes.mailForwardList.splice(i,1),a.set(a.attributes));break;case"enableFilter":n=e.email,void 0!==(i=g.getCurrentFilterIndex(n))&&(a.attributes.mailForwardList[i].enabled=!0);break;case"disableFilter":n=e.email,void 0!==(i=g.getCurrentFilterIndex(n))&&(a.attributes.mailForwardList[i].enabled=!1);break;default:a.set(e)}r("Apps.PopAccounts.App").triggerViewUpdate()},getReplyToAddressList:function(t){var e=ZMStore.getInstance("PopAccounts").models,i=[],a={};if(e.forEach(function(n){n.get("isReplyToEmailVerified")&&(i.forEach(function(e,t){e.email===n.get("replyToEmail")&&i.splice(t,1)}),a={id:n.get("id"),email:n.get("replyToEmail")},i.push(a))}),""===t.trim())return i;var n=[];return i.forEach(function(e){0<=e.email.indexOf(t)&&n.push(e)}),n},verifyMailForward:function(t){var n=l.AppI18N.getText(),e=r("Apps.PopAccounts.DialogComponents"),i=r("Apps.PopAccounts.init"),a=e.verifyMailForward({email:t,onVerify:function(e){i.verifyMailForward({email:t,code:e.code}).then(function(){i.FetchZohoAccount(),a.remove()},function(e){_zm.succErrMsg("e",e.err.respObj.msg)})},onResendCode:function(){i.resendMailForwardVerificationCode({email:t}).then(function(e){u.showSuccessMessage(zmText.applyArgs(n.replyToCodeResent,{email:'"'.concat(t,'"')}))},function(e){_zm.succErrMsg("e",e.err.respObj.msg)})}})}},m=g.comparator=function(e,t){return e.order<t.order?-1:e.dispName>t.dispName?1:0},f=function(e,t){return{dom:zdom("zmfrag",null,e.dispName+"\t<"+e.emailId+">",t&&zdom("i",{className:"msi-tick zmThmClr"})),data:{sendAsEmailID:e.id,sendAsEmail:e.emailId}}},S=function(e){return{dom:zdom("zmfrag",null,zdom("b",null,e)),className:"nohr zmDDSecHdr"}};g.getEmailAddressListForDropdown=function(e,t){var n=l.AppI18N.getText().addressSegregation,i=[],a=[],r=[],o=[],s=[],c=!1;return e.forEach(function(e){c=!1,t===e.emailId&&(c=!0),e.emailId===zmail.aInfo[zmUtil.getZohoAccId()].mailId?i.push(f(e,c)):6===e.mode?a.push(f(e,c)):2===e.mode?r.push(f(e,c)):0===e.mode||1===e.mode?o.push(f(e,c)):s.push(f(e,c))}),s=s.sort(m),a=a.sort(m),r=r.sort(m),o=o.sort(m),0<i.length&&i.unshift(S(n.primaryAddr)),0<o.length&&o.unshift(S(n.aliasAddr)),0<s.length&&s.unshift(S(n.externalAddr)),0<r.length&&r.unshift(S(n.groupAddr)),0<a.length&&a.unshift(S(n.delegatedAddress)),i.concat(o,s,r,a)},g.getDateTimeSeconds=function(e){var t=e.getHours(),n=e.getMinutes(),i=e.getSeconds();return t<10&&(t="0"+t),i<10&&(i="0"+i),n<10&&(n="0"+n),t+":"+n},zmComponent.notifier.addHandler("mail",function(e,t){if("EXTERNAL_ACCOUNT_UPDATION"===t.data.act){var n=ZMStore.getInstance("PopAccounts").get(t.data.AID);if(n){var i=t.data.data;if(i.hasOwnProperty("SYNCTIME")){var a=new Date(t.data.data.SYNCTIME),r=g.getDateTimeSeconds(a);n.set({lastSyncTime:r,initialSyncCompleted:!0,popDisabledReason:""})}else i.hasOwnProperty("SYNCCOMP")?n.set({initialSyncCompleted:!0}):i.hasOwnProperty("DISABLED_REASON")&&n.set({popDisabledReason:i.DISABLED_REASON,initialSyncCompleted:!0,lastSyncTime:""});g.updateApp()}}}),e.Util=g},"Apps.PopAccounts"),_defineSettingsModule("init",function(e,t){var n,i,a,r,o=t("Apps.PopAccounts"),s=null,c=o.Collection.collection,l=function(){var e={adapters:[{id:"http-adapter",type:"default",classObj:o.Adapter.Adapter}],default:"http-adapter"};return ZMStore.getInstance("PopAccounts")?s=ZMStore.getInstance("PopAccounts"):(s=ZMStore.createInstance("PopAccounts",c,{adapterConfig:e}),r=new Promise(function(t,e){s.fetchAll().then(function(e){o.allModels=s.models,s.addExistingPopToModel(e.opts.resp.accounts),s.fetchSettingModel(e.opts.resp.fetchSettings,s.models[0].attributes.email),t()})})),r};l(),e.initialize=l,e.FetchZohoAccount=function(){return a=new Promise(function(e,t){n=e}),s.fetchZohoAccount().then(function(e){t("Apps.PopAccounts.Util").Util.updateZohoAccount(e),n()}),a},e.verifyMailForward=function(e){return a=new Promise(function(e,t){n=e,i=t}),s.verifyMailForward(e).then(function(e){n()},function(e){i(e)}),a},e.verifyReplyToEmail=function(e){return a=new Promise(function(e,t){n=e,i=t}),s.verifyReplyToEmail(e).then(function(e){n()},function(e){i(e)}),a},e.resendMailForwardVerificationCode=function(e){return a=new Promise(function(e,t){n=e,i=t}),s.resendMailForwardVerificationCode(e).then(function(e){n()},function(){i()}),a},e.resendReplyToVerificationCode=function(e){return a=new Promise(function(e,t){n=e,i=t}),s.resendReplyToVerificationCode(e).then(function(e){n(e)},function(e){i(e)}),a},e.addNewAccount=function(e,t){return a=new Promise(function(e,t){n=e,i=t}),s.addNewPopAccount(e,t).then(function(e){n(e)},function(e){i(e)}),a},e.deleteAccount=function(e){return a=new Promise(function(e,t){n=e,i=t}),s.deleteAccount(e).then(function(e){n(e)},function(e){i(e)}),a},e.fetchAllAccounts=function(){return a=new Promise(function(e,t){n=e}),s.fetchAllAccounts().then(function(e){n(e)}),a},e.reOrderAccounts=function(e){return a=new Promise(function(e,t){n=e}),s.reOrderAccounts(e).then(function(){n()}),a}},"Apps.PopAccounts"),_defineSettingsModule("initInteg",function(e,t){t("Apps.PopAccounts").initRequest=function(){return t("Apps.PopAccounts").init.initialize()}},"Apps.PopAccounts"),_defineSettingsModule("Publishers",function(e,t){var n;e.addNewAccountPublisher=function(e){e.emailAddress=e.email,$.publish("settings/mail-accounts/pop-account-added",{id:e.id,data:e})},e.deletePopAccount=function(e){$.publish("settings/mail-accounts/pop-account-removed",{id:e})},e.reOrderAccounts=function(e){$.publish("pop-accounts/reOrder",{accIds:e})},e.replyToEmailRemoved=function(e){$.publish("settings/mail-accounts/replyToEmailRemoved",{obj:e})},e.replyToEmailAdded=function(e){$.publish("settings/mail-accounts/replyToEmailRemoved",{obj:e})},e.fromAddressChange=function(e){$.publish("settings/mail-accounts/fromAddressChange",{obj:e})},e.displayNameChange=function(e){$.publish("settings/mail-accounts/displayNameChange",{obj:e})},e.unsubscribe=function(){$.unsubscribe("mailsuite/appOpened",function(){}),$.unsubscribe("/integ/rhs/start",function(){}),$.unsubscribe("/integ/rhs   ",function(){})},n=t("Apps.PopAccounts.Util").Util,$.subscribe("/mail/accountSwitch",function(e,t){n.updateCurrentActiceAccountState(t.accountID),n.updateApp()}),$.subscribe("/integ/rhs/start",function(){n.updateApp()}),$.subscribe("/integ/rhs",function(){n.updateApp()})},"Apps.PopAccounts"),_defineSettingsModule("PopAccounts",function(t,o){var i,e=o("Platform.Components"),n=o("Platform.Entities"),a=o("Platform.System.Utils"),r=e.SettingCardManager,s=e.SettingCardItemManager,c=e.SettingPageManager,l=e.SettingAppManager,u=n.SettingPage,p=n.SettingCardItem,d=u.Types,g=p.Types,m=zmText.get("zm-settings-core","mailAccounts"),f="mailaccounts",S="mailaccounts",v="sa-mailaccounts",A="mailaccounts",h="mail",y="zm-settings-app-popaccounts",C="sci-manage-pop-new",b="sci-manage-imap-new",M="sci-manage-forwards-new",P="sci-manage-fetch-new",E=function(){i.props.attributes.reactInstance&&i.props.attributes.reactInstance.updatePanel()},z=r.CardActions.OpenPageAction(S),w=function(){return zmAppLoader.load(y)},O=function(){var e=a.makeDeferred();return w().then(function(){zmail.Settings.Apps.PopAccounts.initRequest().then(function(){e.resolve(),$.e(window).on("resize",E)})},function(){e.reject()}),e.promise()},I=function(){var e=a.makeDeferred();return $.e(window).off("resize",E),w().then(function(){e.resolve()}),e.promise()},T=function(){},D=function(){var e=function(){var e=o("Apps.PopAccounts.App"),t=e.getProp("action"),n=e.getProp("newPopAcc"),i=e.getProp("showPop3FetchSetting");void 0===n&&(n=!1),void 0===i&&(i=!1);var a={};switch(t){case"showNewPopAccCreation":a.showNewPopAccCreation=!0;break;case"showPop":a.showPop=!0;break;case"showImap":a.showImap=!0;break;case"showForward":a.showForward=!0;break;case"showPopFetch":a.showPopFetch=!0;break;case"showSMTP":a.showSMTP=!0;break;case"showGeneral":a.showGeneral=!0}a.showNewPopAccCreation=n,a.showPopFetch=i;var r=o("Apps.PopAccounts.Util").Util;return a.expandedId=r.getCurrentExpandedCardId(),a}();return zmail.Settings.Apps.PopAccounts.views.init(e)};r.create(f,{props:{title:m.labels.title,openable:!0},attributes:{category:h},openAction:r.CardActions.OpenPageAction(S)}),s.create(A,{props:{title:m.cardItems.title.addAccount},attributes:{type:g.Action,card:f},primaryAction:function(){l.get(v).setProp({newPopAcc:!0}),z()}}),s.create(C,{props:{title:m.cardItems.title.managePop},attributes:{type:g.Action,card:f},primaryAction:function(){l.get(v).setProp({action:"showPop"}),z()}}),s.create(b,{props:{title:m.cardItems.title.manageImap},attributes:{type:g.Action,card:f},primaryAction:function(){l.get(v).setProp({action:"showImap"}),z()}}),s.create(M,{props:{title:m.cardItems.title.manageForwards},attributes:{type:g.Action,card:f},primaryAction:function(){l.get(v).setProp({action:"showForward"}),z()}}),s.create(P,{props:{title:m.cardItems.title.manageFetch},attributes:{type:g.Action,card:f},primaryAction:function(){l.get(v).setProp({showPop3FetchSetting:!0}),z()}}),c.create(S,{props:{title:m.labels.title},attributes:{type:d.PageAlone,card:S,category:"mail",appContainer:!0,showActionable:!0,pageContainerClassNames:"zmSetPage",pageCSSClass:"zmSetNPwra"},onComponentCreate:function(e){t.pageComponent=e}}).state.on("change",function(e,t){i.props.attributes.reactInstance&&i.props.attributes.reactInstance.updatePanel(),$.subscribe("mailsuite/appOpened",function(e,t){"zm-settings"===t&&i.props.attributes.reactInstance&&i.props.attributes.reactInstance.updatePanel()});var n=o("Apps.PopAccounts.Util").Util;void 0!==i.getProp("action")&&(n.updateExpandCollapseState(),n.updateApp()),i.setProp({action:void 0,showPop3FetchSetting:void 0})}),i=l.create(v,{attributes:{page:S,isReactApp:!0,showOnboarding:!0},initialize:O,uninitialize:I,getView:D,handleContainerEvent:T}),t.App=i},"Apps"),_defineSettingsModule("Cards",function(e,t){var n={cardTitle:zmText.get("zm-settings-core","groups.cardTitle")},i=t("Platform.Components").SettingCardManager.create("group-settings",{props:{title:n.cardTitle},state:{hidden:!1},attributes:{category:"groups"}});e.MailAccountSettings=i},"MailSuite"),function(e){var t,n,i={cardItem:{title:{groupSettings:zmText.get("zm-settings-core","groups.cardItems.manageGroups")}}},a=e("Platform.Components"),r=e("Platform.Entities"),o=a.SettingCardItemManager,s=r.SettingCardItem.Types,c=function(){var e;_zm.isStreamsEnabled()?zmUtil.loadGroupManagement().then(function(){zmStreamsApp.GroupManageApp.init({groupManage:!0})}):(e="/biz/groups.do",setTimeout(function(){window.open(e)},0))};n=(n={props:{loadFrameworkOnCommandExecution:!(t="group-settings"),title:i.cardItem.title.groupSettings},attributes:{type:s.Action,card:"group-settings"},primaryAction:function(){c()}})||{},o.create(t,n)}(zmail.Settings.Modules.import),_defineSettingsModule("AccountData",function(e,t){var o=t("Platform.System.Utils"),s={},c=zmail.Utils.DeferredCollection.create({keepDeferreds:!1});e.getAccountData=function(t,e){!0===(e=e||{}).refresh&&(c.clear(t),s[t]=void 0,delete s[t]);var n,i,a=!c.has(t),r=c.get(t);return s[t]?r.resolve(o.copyProperties(s[t],{},!0)).promise():(a&&(n=t,i=o.makeDeferred(),zmAjq.XHR({u:[zmail.conPath,"swAcc.do"].join("/"),p:{accId:n,mode:"json"},t:"post",fn:function(e){i.resolve({data:e})},efn:function(){i.reject()}}),i.promise()).done(function(e){s[t]=e.data,r.resolve(o.copyProperties(s[t],{},!0))}).fail(function(){r.reject()}),r.promise())},e.getAccountDataSync=function(e){return s[e]}},"MailSuite.Common"),_defineSettingsModule("External",function(e,t){var a=t("Platform.System.Utils"),n=function(){var e,t,n=$.Deferred(),i=(e=$.Deferred(),t=function(){"resolved"!==e.state()&&e.resolve()},setTimeout(t,3e3),zmApp.loadCalendarSettingsResources().done(t).fail(t),e.promise());return $.when(i).done(function(){n.resolve()}).fail(function(){a.debugLog("_initializeExternalIntegrations - failed"),n.resolve()}),n.promise()};e.loadSettingsCore=function(){return n()}},"Platform");