var Deferred=function(){function e(e){return"[object Array]"===Object.prototype.toString.call(e)}function t(t,n){if(e(t))for(var i=0;i<t.length;i++)n(t[i]);else n(t)}function n(i){var o="pending",r=[],a=[],s=[],d=null,p={done:function(){for(var t=0;t<arguments.length;t++)if(arguments[t])if(e(arguments[t]))for(var n=arguments[t],i=0;i<n.length;i++)"resolved"===o&&n[i].apply(this,d),r.push(n[i]);else"resolved"===o&&arguments[t].apply(this,d),r.push(arguments[t]);return this},fail:function(){for(var t=0;t<arguments.length;t++)if(arguments[t])if(e(arguments[t]))for(var n=arguments[t],i=0;i<n.length;i++)"rejected"===o&&n[i].apply(this,d),a.push(n[i]);else"rejected"===o&&arguments[t].apply(this,d),a.push(arguments[t]);return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},progress:function(){for(var t=0;t<arguments.length;t++)if(arguments[t])if(e(arguments[t]))for(var n=arguments[t],i=0;i<n.length;i++)"pending"===o&&s.push(n[i]);else"pending"===o&&s.push(arguments[t]);return this},then:function(){arguments.length>1&&arguments[1]&&this.fail(arguments[1]),arguments.length>0&&arguments[0]&&this.done(arguments[0]),arguments.length>2&&arguments[2]&&this.progress(arguments[2])},promise:function(e){if(null==e)return p;for(var t in p)e[t]=p[t];return e},state:function(){return o},debug:function(){console.log("[debug]",r,a,o)},isRejected:function(){return"rejected"===o},isResolved:function(){return"resolved"===o},pipe:function(e,i){return n(function(n){t(e,function(e){l.done("function"==typeof e?function(){var t=e.apply(this,arguments);t&&"function"==typeof t?t.promise().then(n.resolve,n.reject,n.notify):n.resolve(t)}:n.resolve)}),t(i,function(e){l.fail("function"==typeof e?function(){var t=e.apply(this,arguments);t&&"function"==typeof t?t.promise().then(n.resolve,n.reject,n.notify):n.reject(t)}:n.reject)})}).promise()}},l={resolveWith:function(e){if("pending"===o){o="resolved";for(var t=d=arguments.length>1?arguments[1]:[],n=0;n<r.length;n++)r[n].apply(e,t)}return this},rejectWith:function(e){if("pending"===o){o="rejected";for(var t=d=arguments.length>1?arguments[1]:[],n=0;n<a.length;n++)a[n].apply(e,t)}return this},notifyWith:function(e){if("pending"===o)for(var t=d=arguments.length>1?arguments[1]:[],n=0;n<s.length;n++)s[n].apply(e,t);return this},resolve:function(){return this.resolveWith(this,arguments)},reject:function(){return this.rejectWith(this,arguments)},notify:function(){return this.notifyWith(this,arguments)}},c=p.promise(l);return i&&i.apply(c,[c]),c}return n.when=function(){if(arguments.length<2){var e=arguments.length?arguments[0]:void 0;return e&&"function"==typeof e.isResolved&&"function"==typeof e.isRejected?e.promise():n().resolve(e).promise()}return function(e){for(var t=n(),i=e.length,o=0,r=new Array(i),a=0;a<e.length;a++)!function(n){var a=null;e[n].done?e[n].done(function(){r[n]=arguments.length<2?arguments[0]:arguments,++o==i&&t.resolve.apply(t,r)}).fail(function(){t.reject(arguments)}):(a=e[n],e[n]=new Deferred,e[n].done(function(){r[n]=arguments.length<2?arguments[0]:arguments,++o==i&&t.resolve.apply(t,r)}).fail(function(){t.reject(arguments)}).resolve(a))}(a);return t.promise()}(arguments)},n}();!function(e){var t={GRAMMAR:{INCORRECT_ARTICLE_BEFORE_A_PROPER_NOUN:{TITLE:"Incorrect article before a proper name",CONTENT:"Articles <i>a</i>, <i>an</i>, or <i>the</i> do not need to be added before the names of countries and languages. You can, however, use a definite article (<i>the</i>) for names that are used in plural or preceded or followed by words like <i>united</i>, <i>kingdom</i>, <i>republic</i>, etc (like <i>the Philippines</i>, or <i>the Kingdom of Belgium</i>)."},INDEFINITE_ARTICLE_BEFORE_A_PLURAL_NOUN:{TITLE:"Indefinite article before a plural noun",CONTENT:"An indefinite article like <i>a</i> or <i>an</i> is used to describe a singular object or noun. It is not used to modify a plural noun."},INCORRECT_ARTICLE_WITH_SET_EXPRESSION:{TITLE:"Incorrectly used set expression",CONTENT:"Set expressions are phrases whose words are fixed in a particular order. You seem to have used a modified version of such an expression here. Consider rephrasing it."},REDUNDANT_ARTICLE:{TITLE:"Redundant article",CONTENT:"The article you've inserted isn't required here. Consider removing it from this sentence."},MISSING_ARTICLE_BEFORE_A_SUPERLATIVE:{TITLE:"Missing article before a superlative",CONTENT:"Superlatives (like <i>best</i>, <i>closest</i>) are preceded by the definite article <i>the</i>."},MISSING_ARTICLE:{TITLE:"Missing article",CONTENT:"Articles <i>a</i>, <i>an</i>, or <i>the</i> are used to establish the specificity of a noun. Use a definite article (<i>the</i>) for a specific reference, and indefinite (<i>a</i> or <i>an</i>) for an unspecific reference."},INCORRECT_INDEFINITE_ARTICLE:{TITLE:"Incorrect indefinite article",CONTENT:"Indefinite articles <i>a</i> and <i>an</i> are used based on the sound of the first letter of the word that follows. Use <i>an</i> if the word begins with a vowel sound. If it begins with a consonant sound, use <i>a</i>."},INCORRECT_ARTICLE:{TITLE:"Incorrect article",CONTENT:"Choose articles based on whether the noun you are referring to is specific or not. Use a definite article (<i>the</i>) for a specific reference or before a superlative (like <i>best</i>), and an indefinite article (<i>a</i> or <i>an</i>) for an unspecific reference."},INCORRECT_VERB_FORM_DO:{TITLE:"Incorrect verb form after do, does or did",CONTENT:"When a verb follows <i>do</i>, <i>does</i>, or <i>did</i>, it should usually be used in the infinitive form (without any endings like <i>-s</i>, <i>-ing</i>, or <i>-ed</i>)."},INCORRECT_VERB_FORM_HAVE:{TITLE:"Incorrect verb form after have, has or had",CONTENT:"When a verb follows <i>have</i>, <i>has</i>, or <i>had</i>, it should usually be used in the past participle form (which usually ends in <i>-d</i>, <i>-ed</i>, <i>-en</i>, <i>-n</i>, or <i>-t</i>)."},INCORRECT_VERB_FORM_MODAL:{TITLE:"Incorrect verb form after modal",CONTENT:"Modal verbs like <i>can</i>/<i>could</i> or <i>will</i>/<i>would</i> are used to express ability, possibility, permission, or obligation. The verb that follows a modal verb must be in its infinitive form (without any endings such as <i>-s</i>, <i>-ing</i>, and <i>-ed</i>)."},INFINITIVE_VERB_INSTEAD_OF_GERUND:{TITLE:"Infinitive verb instead of gerund",CONTENT:"The verb you've used here is usually followed by a gerund (verb form with the ending <i>-ing</i>), not an infinitive verb."},INCORRECT_VERB_FORM_INFINITIVE:{TITLE:"Incorrect verb form",CONTENT:"The verb form you've used doesn't seem to fit with the sentence structure here. Consider changing it to a different form."},INCORRECT_VERB_FORM_PERSONAL_PRONOUN:{TITLE:"Incorrect verb form after personal pronoun",CONTENT:"The verb form you've used does not seem to agree with the personal pronoun (<i>he</i>, <i>she</i>, etc) before it. Consider changing the verb to a different form."},INCORRECT_VERB_FORM:{TITLE:"Incorrect verb form",CONTENT:"The verb form you've used does not seem to agree with the subject before it. Consider changing the verb to a different form."},MISSING_AUXILIARY_VERB_PAST_PARTICIPLE:{TITLE:"Missing auxiliary verb",CONTENT:"Auxiliary verbs (or helping verbs) like have, <i>has</i>, <i>had</i>, <i>do</i>, etc. help add meaning to the main verb. Consider adding an auxiliary verb here, or restructuring the sentence."},INCORRECT_VERB:{TITLE:"Incorrect verb",CONTENT:"The verb you've used does not seem to fit with the context of the sentence here. Consider replacing it with a different one."},MISSING_VERB:{TITLE:"Missing verb",CONTENT:"This sentence does not seem to have a verb. Consider adding a verb here or restructuring the sentence."},REDUNDANT_VERB:{TITLE:"Redundant verb",CONTENT:"The verb you've inserted isn't required here. Consider removing it from this sentence."},PREPOSITION_ADJECTIVE_MISMATCH:{TITLE:"Preposition-adjective mismatch",CONTENT:"The preposition you've used doesn't seem to fit with the adjective before it. Consider replacing it with a different one as prepositions can change the meaning of a sentence if used incorrectly."},INCORRECT_PREPOSITION_USED:{TITLE:"Incorrect preposition used",CONTENT:"This preposition you've used doesn't seem to fit with the context of the sentence here. Consider replacing it with a different one as prepositions can change the meaning of a sentence if used incorrectly."},MISSING_PREPOSITION:{TITLE:"Missing preposition",CONTENT:"This sentence appears to be missing a preposition. Consider adding a proposition here or restructuring the sentence."},REDUNDANT_PREPOSITION:{TITLE:"Redundant preposition",CONTENT:"The preposition you've inserted isn't required here. Consider removing it from this sentence."},INCORRECT_ADJECTIVE:{TITLE:"Incorrect adjective",CONTENT:"The adjective you've used doesn't fit the context here. Consider replacing it with a different one."},INCORRECT_QUANTIFIER:{TITLE:"Incorrect quantifier",CONTENT:"The quantifier you've used doesn't seem to go well with the context here. Consider replacing it with a different one."},NOUN_QUANTIFIER_MISMATCH_PLURAL_NOUN:{TITLE:"Noun-quantifier mismatch",CONTENT:"You appear to have used a plural noun after a singular quantifier here. Consider replacing the noun with a singular one or changing the adjective before it."},NOUN_QUANTIFIER_MISMATCH_SINGULAR_NOUN:{TITLE:"Noun-quantifier mismatch",CONTENT:"You appear to have used a singular noun after a plural quantifier here. Consider replacing the noun with a plural one or changing the adjective before it."},INCORRECT_NOUN_FORM:{TITLE:"Incorrect noun form",CONTENT:"The noun form you've used doesn't fit the context of the sentence here. Consider replacing it or restructuring the sentence."},REDUNDANT_NOUN:{TITLE:"Redundant noun",CONTENT:"The noun you've inserted isn't required here. Consider removing it from this sentence."},SUBJECT_PRONOUN_IN_PLACE_OF_OBJECT_PRONOUN:{TITLE:"Subject pronoun in place of object pronoun",CONTENT:"You appear to have used a subject pronoun (<i>I</i>, <i>we</i>, <i>he</i>, <i>she</i>, <i>it</i>, <i>you</i> or <i>they</i>) here instead of an object pronoun (<i>me</i>, <i>you</i>, <i>him</i>, <i>her</i>, <i>it</i> or <i>them</i>). Consider replacing it."},OBJECT_PRONOUN_IN_PLACE_OF_SUBJECT_PRONOUN:{TITLE:"Object pronoun in place of subject pronoun",CONTENT:"You appear to have used an object pronoun (<i>me</i>, <i>you</i>, <i>him</i>, <i>her</i>, <i>it</i> or <i>them</i>) here instead of a subject pronoun (<i>I</i>, <i>we</i>, <i>he</i>, <i>she</i>, <i>it</i>, <i>you</i> or <i>they</i>). Consider replacing it."},INCORRECT_PRONOUN:{TITLE:"Incorrect pronoun",CONTENT:"The pronoun you've used doesn't fit the context here. Consider replacing it with a different one."},MISSING_PRONOUN:{TITLE:"Missing pronoun",CONTENT:"This sentence appears to be missing a pronoun. Consider adding one here or restructuring the sentence."},REDUNDANT_PRONOUN:{TITLE:"Redundant pronoun",CONTENT:"The pronoun you've inserted isn't required here. Consider removing it from this sentence."},ADVERB_IN_PLACE_OF_ADJECTIVE:{TITLE:"Adverb in place of adjective",CONTENT:"You appear to have used an adverb (words that modify a verb, like <i>kindly</i>, <i>slowly</i>) instead of an adjective (words that describe a noun, like <i>beautiful</i>, <i>faithful</i>). Consider replacing it."},ADJECTIVE_IN_PLACE_OF_ADVERB:{TITLE:"Adjective in place of adverb",CONTENT:"You appear to have used an adjective (word that describes a noun, like <i>beautiful</i>, <i>faithful</i>) instead of an adverb (part of speech that modifies a verb, like <i>kindly</i>, <i>slowly</i>). Consider replacing it."},NOUN_IN_PLACE_OF_ADJECTIVE:{TITLE:"Noun in place of adjective",CONTENT:"You appear to have used a noun (word that indicates a person, animal, place, thing, or idea) instead of an adjective (word that describes a noun, like <i>beautiful</i>, <i>faithful</i>). Consider replacing it."},ADJECTIVE_IN_PLACE_OF_NOUN:{TITLE:"Adjective in place of noun",CONTENT:"You appear to have used an adjective (word that describes a noun, like <i>beautiful</i>, <i>faithful</i>) instead of a noun (word that indicates a person, animal, place, thing, or idea). Consider replacing it."},INCORRECT_WORDS:{TITLE:"Probably miswritten word(s)",CONTENT:"This word doesn't fit the context here. Consider replacing it with a different word."},POSSIBLY_MISSING_WORD:{TITLE:"Possibly missing word",CONTENT:"This sentence appears to be missing a word. Consider adding a word here or restructuring the sentence."},REDUNDANT_WORD:{TITLE:"Redundant word",CONTENT:"The word you've inserted isn't required here. Consider removing it from this sentence."},REPEATED_WORD:{TITLE:"Repeated word",CONTENT:"You have entered the same word twice. Consider removing one of them."},INCORRECT_WORD_FORM:{TITLE:"Incorrect word form",CONTENT:"The word form you've used doesn't fit the context here. Consider replacing it with a different form, (e.g. changing <i>beautifully</i> to <i>beautiful</i>)."},INCORRECTLY_USED_CONJUNCTION:{TITLE:"Incorrectly used conjunction",CONTENT:"The conjunction you've used doesn't fit the context here. Consider removing it or replacing it with a different one."},POSSIBLY_REDUNDANT_WORDS:{TITLE:"Possibly redundant words",CONTENT:"The words you've inserted aren't required here. Consider removing them from this sentence."},INCORRECT_WORD_ORDER:{TITLE:"Incorrect word order",CONTENT:"The order in which the two words appear here seems to be incorrect. Consider interchanging their positions."},POSSIBLY_CONFUSED_WORD:{TITLE:"Possibly confused words",CONTENT:"You might have used a word that's commonly confused with a different word that looks or sounds alike, but has a different meaning (like <i>meet</i> and <i>meat</i>). Consider comparing their definition to see if it fits the context here."},POSSESSIVE_FAULT:{TITLE:"Incorrect plural possessive",CONTENT:"To make the possessive form of a plural noun, add an apostrophe at the end of the noun (without an <i>s</i> following it). For example, the possessive form of the plural noun <i>Kids</i> is <i>Kids'</i> and not <i>Kids's</i>."},INCORRECT_POSSESSIVE_ENDING:{TITLE:"Incorrect possessive ending",CONTENT:"The possessive ending (<i>apostrophe</i>+<i>s</i> form) you've used doesn't fit the context here. Consider replacing it."},MISWRITTEN_COMPOUND_WORD:{TITLE:"Miswritten compound word",CONTENT:"These words appear to be part of a closed compound word where two words are used together to form a new meaning. Closed compound words (like <i>notebook</i>, which is a combination of <i>note</i> and <i>book</i>) are written without a space between them."},MISSING_HYPHEN_COMPOUND:{TITLE:"Missing hyphen",CONTENT:"These words appear to be part of a hyphenated compound word (like <i>left-handed</i>), where two words are joined together with a hyphen to form a new meaning"},DOUBLE_NEGATIVE:{TITLE:"Double negatives",CONTENT:"A double-negative is when two negative words are used in one sentence. This usually results in them negating each other, and forming a positive statement. For example, the statement <i>I can't see no errors</i> means <i>you can see some errors.</i>"},MISSING_COMMA:{TITLE:"Missing comma",CONTENT:"This sentence appears to be missing a comma. Consider adding one here or restructuring the sentence."},MISSING_PERIOD:{TITLE:"Missing period",CONTENT:"This sentence appears to be missing a period at the end. Consider adding one here."},DOUBLE_PERIOD:{TITLE:"Double period",CONTENT:"Always end sentences with a single period, even if the sentence ends with an abbreviation. If the sentence ends with a question mark, or exclamation point, do not use a period as well."},MISSING_PUNCTUATION:{TITLE:"Missing punctuation",CONTENT:"This sentence appears to be missing proper punctuation. Consider adding punctuation here or restructuring the sentence."},INCORRECTLY_USED_COMMA:{TITLE:"Incorrectly used comma",CONTENT:"The comma you've used doesn't fit the context of this sentence. Consider removing it as punctuation can change the meaning of a sentence if used incorrectly."},INCORRECT_PUNCTUATION:{TITLE:"Incorrect punctuation",CONTENT:"The punctuation you've used doesn't fit the context of this sentence. Consider replacing it with a different one as punctuation can change the meaning of a sentence if used incorrectly."},CAPITALIZATION_ERROR:{TITLE:"Capitalization Error",CONTENT:"You seem to have incorrectly capitalized this word. Consider replacing it."},INCORRECT_SPACING:{TITLE:"Incorrect spacing",CONTENT:"You seem to have inserted too many space characters between the two words here. Consider keeping it to just one."},REDUNDANT_SPACING:{TITLE:"Redundant spacing",CONTENT:"The space inserted between the two words here might be unnecessary. Consider combining them into a single word."},MISSING_SPACE:{TITLE:"Missing space",CONTENT:"This word is usually written as two words with a space in between."}},STYLE:{WEAK_ADJECTIVE:{TITLE:"Weak adjective",CONTENT:"The combination of an intensifier like <i>very</i> with a weak adjective like <i>cold</i> fails to convey how cold something is. Replacing them with a strong adjective like freezing helps readers create exact images of what they are reading in their minds."},WEAK_ADVERB:{TITLE:"Weak adverb",CONTENT:"Replacing phrases like <i>she ran quickly</i> with <i>she sprinted</i> helps tighten up your writing, and avoids the risk of making it look boring."},REDUNDANT_ADVERB:{TITLE:"Redundant adverb",CONTENT:"An adverb becomes redundant if you use it with a verb with the same meaning. For example, in the phrase <i>he whispered quietly</i>, the adverb is redundant as whispering usually happens quietly."},INFLATED_PHRASE:{TITLE:"Inflated phrase",CONTENT:"Inflated phrases like <i>as a result of</i> are phrases that can be replaced with one or two words without changing the meaning of a sentence. They can make your sentences wordy and confusing to read."},NOMINALIZATION:{TITLE:"Nominalization",CONTENT:"Nominalization is the process of turning a word from a verb into a noun. Avoid nominalization by using the direct verb form of a noun (like replacing <i>had a discussion</i> with <i>discussed</i>). This helps make your writing more concise."},HEDGING_EXPRESSION:{TITLE:"Hedging expression",CONTENT:"Hedging phrases like <i>seems to be</i> make your language more cautious and less direct. Use these only when you want to sound polite or unsure about what you're talking about."},EMPTY_PHRASE:{TITLE:"Empty phrase",CONTENT:"Empty words or phrases, like <i>as a matter of fact</i>, are used as fillers in a sentence. They can distract the reader and undermine the substance of your writing."},REDUNDANT_PHRASE:{TITLE:"Tautological phrase",CONTENT:"Phrases like <i>past history</i>, when the same concept is repeated using different words, are considered tautologies. They make your writing monotonous and unnecessarily wordy."},REDUNDANT_ACRONYM:{TITLE:"Redundant acronym",CONTENT:"Acronym redundance happens when an acronym is accompanied by a word that's already in the acronymâ€”like adding <i>machine</i> after <i>ATM</i>, which stands for <i>automated teller machine</i>."},INCORRECT_ADVERB_PLACEMENT:{TITLE:"Incorrect adverb placement",CONTENT:"Adverbs of frequency (like <i>often</i>) are usually placed directly before the main verb. You can also try placing them at the end of your sentence."},CONJUNCTION_AT_START:{TITLE:"Conjunction at the beginning of a sentence",CONTENT:"Though not grammatically incorrect, using conjunctions like <i>and</i>, <i>or</i>, or <i>but</i> at the beginning of a sentence is not recommended in formal writing. It tends to make sentences sound more dramatic."},SPLIT_INFINITIVE:{TITLE:"Split Infinitive",CONTENT:"The infinitive (<i>to</i>+<i>verb</i>) here has been split with an adverb in between. Though not incorrect, we recommend avoiding split infinitives in formal writing. Consider rephrasing the sentence."},UNCLEAR_PRONOUN:{TITLE:"Unclear pronoun",CONTENT:"It is unclear whom this pronoun represents. A pronoun must clearly represent one particular antecedent. Rephrase your sentence to be more specific."}}};"undefined"!=typeof e&&("undefined"==typeof ZWP&&(e.ZWP={}),e.ZWP.MESSAGES=t)}(window),function(e){var t=function(){var e,t,n={VERSION:"v1_8"},i=window.document.documentMode,o=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS"),r=function(){var e=a();e.done(function(){d()});var t=G.init();return Deferred.when(e,t)},a=function(){var e=new Deferred,t=1,i=function(e,t){C({type:"GET",url:"/proofing/initialize",data:{},dataType:"json",success:e,error:t})},o=function(t){var i=JSON.parse(t);n.COOKIE_NAME=i.RESPONSE[0],n.CSRF_PARAM_NAME=i.RESPONSE[1],n.TRACK_ACTIVITIES=i.RESPONSE[2],e.resolve()},r=function(n,a,s){if(t++,3>=t)i(o,r);else{var d={};d.message="Initialize request which gets csrf details failed",s.status&&(d.message+="\nStatus: "+s.status),s.response&&(d.message+="\nResponse: "+s.response),d.code="BP_002",e.reject(s)}};return i(o,r),e},s=function(n){if(!e){for(var i=window,o="unknown";""===i.location.host&&o!==i.location.host;)o=i.location.host,i=i.parent;e=i.location.host,t=i.location.protocol+"//"}var r="";return n&&(r+=t),r+=e},d=function(){var e={};e.domain=s(!0),e.csrfParamName=n.CSRF_PARAM_NAME,e.isLinkIgnored=!0,ZWJsThreadExecutor.execFn("ProofReader.init",e)},p=function(e,t,n){return t<=e.start&&e.end<=n?!0:!1},l=function(e,t,n){return e.start<t&&n<e.end?!0:!1},c=function(e,t,n){return t<=e.start&&e.start<n&&e.end>n?!0:!1},u=function(e,t,n){return t<e.end&&e.end<=n&&e.start<t?!0:!1},f=function(e,t,n){var i=!1;t.length>0&&(i=!0);for(var o=0;o<e.length;o++)for(var r=e[o],a=0;a<t.length;a++){var s=ZWP.ErrorsCollection.get(t[a]),d=s.getStart(),l=s.getEnd();p(r,d,l)&&E(r.getElement(),t[a],n)}},g=function(e,t){var n={};return e&&e.startContainer===t?(n.updateStart=!0,n.start=e.startOffset,e.canUpdate=!0):e&&e.startContainer.nodeType!==Node.TEXT_NODE&&e.startContainer.contains(t)&&(n.updateStart=!0,n.startBlockNode=!0,n.start=e.startOffset,n.startContainer=e.startContainer,e.canUpdate=!0),e&&e.endContainer===t?(n.updateEnd=!0,n.end=e.endOffset,e.canUpdate=!0):e&&e.endContainer.nodeType!==Node.TEXT_NODE&&e.endContainer.contains(t)&&(n.updateEnd=!0,n.endBlockNode=!0,n.end=e.endOffset,n.endContainer=e.endContainer,e.canUpdate=!0),n},h=function(e,t,n){e.updateStart&&!e.startBlockNode?t.setStart(n.firstChild,e.start):e.startBlockNode&&(t.actualStartOffset=e.start,t.actualStartContainer=e.startContainer),e.updateEnd&&!e.endBlockNode?t.setEnd(n.firstChild,e.end):e.endBlockNode&&(t.actualEndOffset=e.end,t.actualEndContainer=e.endContainer)},m={childList:!0},w=function(e,t){var n=e[0].target.getAttribute("data-zwp-id");t.disconnect();var i=ZWP.ErrorsCollection.get(n);if(i){var o=i.getProofingNodeId(),r=ZWP.NodesMap.get(o)[ZWP.CONSTANTS.INSTANCE];ZWPNodesHandler.bindElement(r)}},T="undefined"!=typeof MutationObserver?new MutationObserver(w):!1,N=function(e){T&&T.observe(e,m)},E=function(e,t,n){var i=document.createElement("span");i.setAttribute("data-zwp-id",t),B(i,"zbp-node");var o=document.createTextNode(e.textContent);switch(i.appendChild(o),ZWP.ErrorsCollection.get(t).type){case"spell":i.onclick=ZWP.PopupHandler.spellPopup.openCard,B(i,"zwp-spell-error");break;case"grammar":i.onclick=ZWP.PopupHandler.grammarPopup.openCard,B(i,"zwp-grammar-error");break;case"style":i.onclick=ZWP.PopupHandler.grammarPopup.openCard,B(i,"zwp-style-error")}N(i);var r=g(n,e);e.parentNode.replaceChild(i,e),h(r,n,i)},v=function(e,t){for(var n=t.getSelection()&&t.getSelection().rangeCount&&t.getSelection().getRangeAt(0),r={},a=e.getElementsByClassName("zbp-node"),s=0,d=a.length;d>s;s++){var p=a.item(s);n&&(p.contains(n.startContainer)?(r.updateStart=!0,n.startContainer===p?(r.startOffset=p.textContent.length,r.updateStartContainer=!0):(r.updateStartOffset=!0,r.startOffset=0)):!r.updateStart&&n.startContainer.contains(p)&&(r.updateStart=!0,r.startOffset=n.startOffset,r.startContainer=n.startContainer),p.contains(n.endContainer)?(r.updateEnd=!0,n.endContainer===p?(r.endOffset=p.textContent.length,r.updateEndContainer=!0):(r.updateEndOffset=!0,r.endOffset=0)):!r.updateEnd&&n.endContainer.contains(p)&&(r.updateEnd=!0,r.endOffset=n.endOffset,r.endContainer=n.endContainer));for(var l,c=p.childNodes,u=0;u<c.length;u++)l=c[u],r.updateStartOffset&&(n.startContainer===l||l.contains(n.startContainer))&&(r.startOffset=n.startOffset,r.startContainer=n.startContainer),r.updateEndOffset&&(n.endContainer===l||l.contains(n.endContainer))&&(r.endOffset=n.endOffset,r.endContainer=n.endContainer),u===c.length-1&&(r.updateStartContainer&&(r.startContainer=l,r.startOffset=l.nodeType===Node.TEXT_NODE?l.textContent.length:l.childNodes?l.childNodes.length:0),r.updateEndContainer&&(r.endContainer=l,r.endOffset=l.nodeType===Node.TEXT_NODE?l.textContent.length:l.childNodes?l.childNodes.length:0));r.updateStartOffset&&(r.updateStartOffset=!1),r.updateEndOffset&&(r.updateEndOffset=!1),r.updateStartContainer&&(r.updateStartContainer=!1),r.updateEndContainer&&(r.updateEndContainer=!1)}!r.updateStart&&n&&(r.startContainer=n.startContainer,r.startOffset=n.startOffset),!r.updateEnd&&n&&(r.endContainer=n.endContainer,r.endOffset=n.endOffset);for(var f,g,h,m,w=[];a.length>0;){for(h=a.item(0),f=document.createDocumentFragment(),g=h.childNodes;g.length>0;)f.appendChild(g[0]);if(o&&1===f.childNodes.length&&f.childNodes[0].nodeType===Node.TEXT_NODE){var T,N,E="",v=f.childNodes[0];if(h.previousSibling&&h.previousSibling.nodeType===Node.TEXT_NODE?(T=h.previousSibling,E+=T.textContent):T=void 0,E+=v.textContent,h.nextSibling&&h.nextSibling.nodeType===Node.TEXT_NODE?(N=h.nextSibling,E+=N.textContent):N=void 0,T||N){var C=t.document.createTextNode(E);switch(r.startContainer){case T:r.startContainer=C;break;case v:T&&(r.startOffset+=T.textContent.length),r.startContainer=C;break;case N:T&&(r.startOffset+=T.textContent.length),r.startOffset+=v.textContent.length,r.startContainer=C}switch(r.endContainer){case T:r.endContainer=C;break;case v:T&&(r.endOffset+=T.textContent.length),r.endContainer=C;break;case N:T&&(r.endOffset+=T.textContent.length),r.endOffset+=v.textContent.length,r.endContainer=C}T&&h.parentNode.removeChild(T),N&&h.parentNode.removeChild(N),f.removeChild(f.childNodes[0]),f.appendChild(C)}}m=h.parentNode,h.parentNode.replaceChild(f,h),o||w.indexOf(m)>=0||w.push(m)}if(r.updateStart||r.updateEnd||i||o){var I=t.getSelection();if(I.rangeCount){var y=t.document.createRange();y.setStart(r.startContainer,r.startOffset),y.setEnd(r.endContainer,r.endOffset),I.removeAllRanges(),I.addRange(y)}}if(!o)for(var O=0,b=w.length;b>O;O++)w[O]&&w[O].normalize&&w[O].normalize()},C=function(e){e=e||{url:""},e.type=e.type.toUpperCase()||"GET",e.headers=e.headers||{},e.timeout=parseInt(e.timeout)||0,e.success=e.success||function(){},e.error=e.error||function(){},e.async="undefined"==typeof e.async?!0:e.async;var t=e.data,n="";for(var i in t)if(t.hasOwnProperty(i)){""!==n&&(n+="&");var o="";o=i,o+="=";var r=t[i];if(Array.isArray(r)){for(var a="",s=0;s<r.length;s++)0==s&&(a+="["),a+='"',a+=r[s],a+='"',s==r.length-1&&(a+="]");o+=a}else o+=encodeURIComponent(r);n+=o}"GET"!==e.type&&"DELETE"!==e.type||!n||(e.url+="?"+n);var d=new XMLHttpRequest;e.timeout>0&&(d.timeout=e.timeout,d.ontimeout=function(){e.error("timeout","timeout",d)}),d.open(e.type,e.url,e.async),d.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),d.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var s in e.headers)e.headers.hasOwnProperty(s)&&d.setRequestHeader(s,e.headers[s]);return d.send(n),d.onreadystatechange=function(){if(4==this.readyState&&(this.status>=200&&this.status<300||304==this.status)){{var t=this.responseText;this.getResponseHeader("Content-Type")}e.success(t,this.statusText,this)}else 4==this.readyState&&e.error(this.status,this.statusText,this)},0==e.async&&(4==d.readyState&&(d.status>=200&&d.status<300||304==d.status)?e.success(d.responseText,d):4==d.readyState&&e.error(d.status,d.statusText,d)),d},I=function(e){var t={word:e};ZWJsThreadExecutor.execFn("ProofReader.ignoreWordInSpell",t)},y=function(e){var t={word:e};ZWJsThreadExecutor.execFn("ProofReader.unIgnoreWordInSpell",t)},O=function(e,t,n){var i={sentence:e,start:t,end:n};ZWJsThreadExecutor.execFn("ProofReader.ignoreSentenceSuggestion",i)},b=function(e,t){var i={};i.language=e.getLang(),i.from=A(),"spell"!=e.getType()&&(i.classification=e.getClassification()),"grammar"!==e.getType()||"applySuggestion"!==t&&"report"!==t&&"ignore"!==t||(i.start=e.getStartInSentence(),i.end=e.getEndInSentence(),i.text=e.getText(),i.suggestions=JSON.stringify(e.getSuggestions()||[]),("report"===t||n.TRACK_ACTIVITIES)&&(i.sentence=e.getSentence())),ActivityTracker.track(e.getType(),t,i)},x=function(e){P(e,!1);var t={};t.type=e.getType(),t.text=e.getText(),t.lang=e.getLang(),t.suggestions=JSON.stringify(e.getSuggestions()),"spell"!=e.getType()&&(t.sentence=e.getSentence(),t.start=e.getStartInSentence(),t.end=e.getEndInSentence(),t.classification=e.getClassification());var n={};M(n),C({type:"POST",url:"/proofing/v1/content/suggestion/report",data:t,dataType:"json",headers:n,error:function(){},success:function(){b(e,"report")}})},z=function(e){"success"===e.status&&b(this,"addToDictionary")},S=function(e){H.add(e.getLang(),e.getText(),z.bind(e)),P(e,!1)},P=function(e,t){for(var n=document.querySelectorAll('[data-zwp-id="'+e.getId()+'"]'),i=n.length-1;i>=0;i--){var o=document.createTextNode(n[i].textContent);n[i].parentNode.replaceChild(o,n[i])}switch(t&&b(e,"ignore"),e.getType()){case"spell":I(e.getText());break;default:O(e.getSentence(),e.getStartInSentence(),e.getEndInSentence())}var r=ZWP.NodesMap.get(e.getProofingNodeId())[ZWP.CONSTANTS.INSTANCE];ZWPNodesHandler.bindElement(r)},L=function(e,t){for(var n=ZWP.NodesMap.get(e.getProofingNodeId()),i=n[ZWP.CONSTANTS.WINDOW_OBJECT],o=i.document.querySelectorAll('[data-zwp-id="'+e.getId()+'"]'),r=0;r<o.length;r++)t?B(o[r],"zwp-ui-active"):F(o[r],"zwp-ui-active")},_=function(e,t){var n=ZWP.NodesMap.get(e.getProofingNodeId()),i=n[ZWP.CONSTANTS.WINDOW_OBJECT],r=i.document.querySelectorAll('[data-zwp-id="'+e.getId()+'"]'),a=r.length-1;for("spell"==e.getType()&&e.setAction("replace"),t||(t="");a>0;a--)r[a].parentNode.removeChild(r[a]);var s=document.createTextNode(t);o?r[a].replaceChild(s,r[a].childNodes[0]):r[a].parentNode.replaceChild(s,r[a]);var d=i.getSelection();if(d){var p=i.document.createRange();p.setStart(s,s.length),p.setEnd(s,s.length),d.removeAllRanges(),d.addRange(p)}b(e,"applySuggestion");var l=n[ZWP.CONSTANTS.INSTANCE];l.element.focus(),n[ZWP.CONSTANTS.ON_APPLYSUGG]&&n[ZWP.CONSTANTS.ON_APPLYSUGG](),ZWPNodesHandler.bindElement(l)},R="unknown",k=function(e){R=e;var t={};t.from=e,ZWJsThreadExecutor.execFn("ProofingWorkerUtil.setFrom",t)},A=function(){return R},W=function(){function e(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var o=n[i].trim();if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""}return e(n.COOKIE_NAME)},D=function(e){e[n.CSRF_PARAM_NAME]=W()},M=function(e){e["X-ZCSRF-TOKEN"]=n.CSRF_PARAM_NAME+"="+W()},Z=function(e){var t=document.createElement("span");return t.textContent=e,t.innerHTML},U=function(e,t){var n="",e=Z(e),i=Z(t[0]),o=Z(t[1]);return n=t.length>2?"It is unclear if <b>"+e+"</b> addresses <b>"+i+"</b>, <b>"+o+"</b> or other subjects in this sentence. Consider rephrasing it.":"It is unclear if <b>"+e+"</b> addresses <b>"+i+"</b> or <b>"+o+"</b> in this sentence. Consider rephrasing it."},B=function(e,t){if("undefined"!=typeof e.classList)e.classList.add(t);else{var n=e.className.split(" ");-1==n.indexOf(t)&&(e.className+=" "+t)}},F=function(e,t){if("undefined"!=typeof e.classList)e.classList.remove(t);else{var n=new RegExp("\\b"+t+"\\b","g");e.className=e.className.replace(n,"")}},j=function(e,t){var i=e+" - Bluepencil Error\n\nException: "+t;i+="\nUserAgent: "+navigator.userAgent,i+="\nDomain: "+s(),i+="\nFrom: "+A(),i+="\nVersion: "+n.VERSION;var o={};o.errorcode=e,o.message=i;var r={};M(r),C({type:"POST",global:!1,url:"/proofing/errorlog",async:!0,data:o,dataType:"json",headers:r,error:function(){},success:function(){}})},H=function(){var e=function(e,t,n){if(!e)throw"Language is mandatory for adding to Dictionary";if(!t)throw"Word is mandatory for adding to Dictionary";I(t);var i={};i.language=e,i.word=t,i.csrfParamValue=W(),ZWJsThreadExecutor.execFn("PersonalDictionary.add",i,n);var o=ZWP.NodesMap.getAll();for(var r in o)ZWPNodesHandler.bindElement(o[r][ZWP.CONSTANTS.INSTANCE])},t=function(e,t,n){if(!e)throw"Language is mandatory for deleting from Dictionary";if(!t)throw"Word is mandatory for deleting from Dictionary";y(t);var i={};i.language=e,i.word=t,i.csrfParamValue=W(),ZWJsThreadExecutor.execFn("PersonalDictionary.delete",i,n);var o=ZWP.NodesMap.getAll();for(var r in o)ZWPNodesHandler.bindElement(o[r][ZWP.CONSTANTS.INSTANCE])},n=function(e,t){if(!e)throw"Language is mandatory for getting Dictionary words";var n={};n.language=e,ZWJsThreadExecutor.execFn("PersonalDictionary.get",n,t)};return{add:e,"delete":t,get:n}}(),G=function(){var e=[],t=function(){var t=new Deferred,n=1,i=function(e,t){C({type:"GET",url:"/proofing/v1/spellcheck/getsupportedlanguages",data:{},dataType:"json",success:e,error:t})},o=function(n){e=JSON.parse(n).supported_languages,t.resolve()},r=function(e,a,s){if(n++,3>=n)i(o,r);else{var d={};d.message="Get SupportedLanguages request to bluepencil server failed",s.status&&(d.message+="\nStatus: "+s.status),s.response&&(d.message+="\nResponse: "+s.response),d.code="BP_003",t.reject(d)}};return i(o,r),t},n=function(){return e};return{init:t,getAll:n}}();return{init:r,ignoreWordInWorker:I,msie:i,safari:o,markError:f,removeErrors:v,ajax:C,addToUserDictionary:S,isFullyExcludedNodeInRange:l,isEndOnlyIncludedNodeInRange:u,isStartOnlyIncludedNodeInRange:c,ignoreSuggestion:P,applySuggestion:_,reportSuggestion:x,setFrom:k,getFrom:A,registerErrorNodeActivity:b,getCsrf:W,setCsrfParam:D,setCsrfParamInHeader:M,getUnclearText:U,addClass:B,removeClass:F,updateSuggestionHighlight:L,sendErrorMail:j,personalDictionary:H,SupportedLanguages:G}}(ZWP.ErrorsCollection);"undefined"!=typeof e&&("undefined"==typeof ZWP&&(e.ZWP={}),e.ZWP.Utils=t)}(window);var ActivityTracker=function(){var e,t,n,i,o="undefined"!=typeof navigator&&"undefined"!=typeof navigator.sendBeacon?!0:!1,r=3,a=function(o,r,a,s){i=o,e=r,n=s,t=a},s=function(n,i){var o=new Deferred,r={};return t(r),e({type:"POST",url:n,data:i,headers:r,error:function(e){o.reject(e)},success:function(e){o.resolve(e)}}),o},d=function(e,t){return navigator.sendBeacon(e,t)},p=function(e,t,a){var p,l=0,c=0;if(a=a||{},!e||!t)throw"Error: You need to pass MODULE_NAME & ACTION to track any activity";p=i+"/activities/"+e+"/"+t;var u=function(){var e,t=!1;if(o&&r>=l){++l,n(a);var i=new FormData;for(key in a)i.append(key,a[key]);t=d(p,i),t||f()}else r>=c&&(++c,e=s(p,a),e.promise().done(function(){}),e.promise().fail(function(e){f(e)}))},f=function(){u()};u()};return{initialize:a,track:p}}();!function(e){var t=function(){var e,t,n=!1,i=!1,o=!1,r=function(i){var r=i.element;e=r,n=!0;var a="http",s="https",d=document.getElementsByTagName("head")[0],p=document.createElement("style");p.innerHTML='@font-face {     font-family: "proxima_nova_rgregular";     src: url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Reg-webfont.eot");     src: url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Reg-webfont.eot?#iefix") format("embedded-opentype"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Reg-webfont.woff") format("woff"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Reg-webfont.ttf") format("truetype"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Reg-webfont.svg#proxima_nova_rgregular") format("svg");     font-weight: normal;     font-style: normal;     }     @font-face {     font-family: "proxima_novasemibold";     src: url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Sbold-webfont.eot");     src: url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Sbold-webfont.eot?#iefix") format("embedded-opentype"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Sbold-webfont.woff") format("woff"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Sbold-webfont.ttf") format("truetype"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Sbold-webfont.svg#proxima_novasemibold") format("svg");     font-weight: normal;     font-style: normal;     }     @font-face {     font-family: "proxima_novaextrabold";     src: url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Bold-webfont.eot");     src: url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Bold-webfont.eot?#iefix") format("embedded-opentype"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Bold-webfont.woff") format("woff"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Bold-webfont.ttf") format("truetype"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Bold-webfont.svg#proxima_novaextrabold") format("svg");     font-weight: normal;     font-style: normal;     }     @font-face {     font-family: "proxima_nova_light";     src: url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Light-webfont.eot");     src: url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Light-webfont.eot?#iefix") format("embedded-opentype"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Light-webfont.woff") format("woff"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Light-webfont.ttf") format("truetype"), url("'+s+'://fonts.zohowebstatic.com/proxima/ProximaNova-Light-webfont.svg#proxima_nova_light") format("svg");     font-weight: normal;     font-style: normal;     } .zwp-ui-show {     display: block; } .zwp-ui-hide {     display: none; } .zwp-clearfix {     clear: both; } .zwp-clearfix:after, .zwp-clearfix:before {     content: " ";     clear: both;     display: table; } .zwp-ui-fl {     float: left; } .zwp-ui-fr {     float: right; } .zwp-ui-top-margin-medium {     margin-top: 10px; } .zwp-ui-right-margin-small {     margin-right: 5px; } .zwp-ui-bottom-margin-medium {     margin-bottom: 10px; } .zwp-ui-left-margin-small {     margin-left: 5px; } .zwp-ui-left-margin-large {     margin-left: 15px; } .zwp-ui-ms-pointer {     cursor: pointer; } .zwp-ui-pos-rel {     position: relative; } .zwp-zbutton__icon {     width: 16px;     height: 16px;     display: block;     position: relative;     z-index: 1;     margin-right: 8px; } .zwp-ui-icon-more-sm {     width: 16px;     height: 16px;     margin-left: 10px; } .zwp-ui-icon-more-sm:before {     content: "";     width: 3px;     height: 3px;     position: absolute;     top: 1px;     right: 7px;     border-radius: 50%;     background-color: #9a9ea2;     box-shadow: 0 5px 0 #9a9ea2, 0 10px 0 #9a9ea2; } .zwp-ui-icon-info {     width: 9px;     height: 9px;     border-radius: 50%;     position: relative;     background-color: #9a9ea2;     margin-top: 2px; } .zwp-ui-icon-info:before, .zwp-ui-icon-info:after {     content: "";     background-color: #ffffff;     position: absolute;     width: 1px;     left: 4px; } .zwp-ui-icon-info:before {     height: 1px;     border-radius: 50%;     top: 2px; } .zwp-ui-icon-info:after {     height: 3px;     border-radius: 20%;     top: 4px; } .zwp-ui-sg-card-ctrl {     position: absolute; right: 10px; } .zwp-ui-sg-container {     /* position: absolute; */     position: fixed;     top: 158px;     left: 395px;     background: #FFFFFF;     padding: 10px 15px;     font-family: proxima_nova_rgregular,open_sans_regular,sans-serif;     font-size: 17px;     line-height: 22px;     color: #000000;     border: 1px solid #dbdbdb;     border-radius: 4px;     box-shadow: 0px 0px 16px 0px rgba(0, 0, 0, 0.1);     z-index: 999;     min-width: 315px;     max-width: 350px;     margin-top: 2px;     transition: all 0.2s ease;     box-sizing: border-box; } .zwp-ui-sg-container:before {     content: "";     position: absolute;     width: 1px;     height: 100%;     left: -1px;     top: -1px;     box-sizing: content-box;     border: 1px solid transparent;     border-top-left-radius: 4px;     border-bottom-left-radius: 4px; } .zwp-ui-sg-container.zwp-ui-spl-card-container:before {     background-color: #FF7272; } .zwp-ui-sg-container.zwp-ui-grm-sug-card-container:before {     background-color: #0DB45F; } .zwp-ui-sg-container.zwp-ui-sty-sug-card-container:before {     background-color: #FFB016; } .zwp-ui-sg-wrong-word {     color: #000;     position: relative;     line-height: 18px;     display: inline;     text-decoration: line-through;     text-decoration-color: red;     cursor: pointer; } .zwp-ui-zia-sug-title, .zwp-ui-scrt-info, .zwp-ui-sg-wrong-word {     font-weight: 600;     font-size: 15px;     line-height: 18px;     word-break: break-word;     -webkit-hyphens: auto;     -moz-hyphens: auto;     -ms-hyphens: auto;     hyphens: auto; } .zwp-ui-zia-arw-container {     height: 18px; } .zwp-ui-zia-sug-arrow {     width: 5px;     height: 5px;     position: relative;     border-right: 1px solid;     border-bottom: 1px solid;     border-color: #435869;     -moz-transform: rotate(-45deg);     -o-transform: rotate(-45deg);     -ms-transform: rotate(-45deg);     -webkit-transform: rotate(-45deg);     transform: rotate(-45deg);     top: 8px;     margin-left: 14px;     margin-right: 14px; } .zwp-ui-zia-sug-arrow:before {     content: "";     width: 10px;     height: 13px;     position: absolute;     top: -10px;     -moz-transform: rotate(-45deg);     -o-transform: rotate(-45deg);     -ms-transform: rotate(-45deg);     -webkit-transform: rotate(-45deg);     transform: rotate(-45deg);     left: -2px;     border-left: 1px solid #435869; } .zwp-ui-scorrect-label {     cursor: pointer;     position: relative;     clear: initial;     line-height: 18px; } .zwp-ui-scrt-info, .zwp-ui-scrt-info span {     color: #0DB45F;     position: relative;     cursor: pointer;     line-height: 18px;     box-shadow: 0 0 0 0 white inset, 0 -2px 0 0 transparent inset;     transition: all .3s ease-in; } .zwp-ui-scrt-info:hover, .zwp-ui-scrt-info:hover span {     transition: all .3s ease-out;     box-shadow: 0 0 0 0 white inset, 0 -2px 0 0 #0DB45F inset; } .zwp-ui-sg-btn {     display: block;     font-family: proxima_novasemibold, open_sans_semi_bold, sans-serif;     font-size: 12px;     line-height: 14px;     text-transform: uppercase;     color: #4190f2;     cursor: pointer;     margin-top: 2px; } .zwp-ui-sg-btn-cont {     font-size: 12px;     line-height: 16px;     padding-top: 11px;     padding-bottom: 3px;     margin-top: 11px;     border-top: 1px solid #D5D5D5; } .zwp-ui-zia-report-txt {     font-family: "Lato", sans-serif;     font-size: 11px;     font-style: italic;     color: #425769;     position: relative; } .zwp-ui-zia-report-txt i {     text-decoration: underline;     cursor: pointer; } [area-label]:hover:after {     content: attr(area-label); padding: 8px 10px; border-radius: 3px; position: absolute; top: 19px; left: 0; background: black; color: white; font-size: 13px; z-index: 1; max-width: 225px; width: max-content; } [area-label]:hover:before {     content: " ";     top: 90%;     left: 50%;     width: 0;     height: 0;     position: absolute;     border-left: 5px solid transparent;     border-right: 5px solid transparent;     border-bottom: 5px solid black;     transform: translate(-50%);     z-index: 1; } .zwp-ui-wg-unclear.zwp-ui-zia-info-txt{     margin-top: 0px;     padding-top: 0px;     border: 0px; } .zwp-ui-zia-info-txt {     font-family: proxima_novasemibold, open_sans_semi_bold, sans-serif;     color: #4c4c4c;     font-size: 14px;     line-height: 18px;     display: block;     margin-top: 4px;     padding-top: 13px;     border-top: 1px solid #efefef; } .zwp-ui-zia-sug-discription {     font-family: proxima_nova_light, open_sans_light, sans-serif;     font-size: 13px;     line-height: 17px;     color: #6f6f6f;     margin-top: 6px;     margin-bottom: 0px;     overflow: hidden; } .zwp-ui-zia-sug-discription i {     font-family: proxima_novasemibold, open_sans_semi_bold, sans-serif; } .zwp-ui-shrink.zwp-ui-sg-container {     min-width: 220px;     max-width: 0px;     transition: all 0.2s ease; } .zwp-ui-addtodic {     position: relative; } .zwp-ui-shrink .zwp-ui-addtodic-txt, .zwp-ui-shrink .zwp-ui-rep-txt, .zwp-ui-shrink .zwp-ui-icon-info {     display: none; } .zwp-ui-shrink .zwp-ui-zia-dict-container {     position: relative;     top: 27px;     margin-left: 24px; } .zwp-ui-shrink .zwp-ui-addtodic {     float: left; } .zwp-ui-shrink .zwp-ui-sg-btn-cont {     margin-top: 0px; } .zwp-ui-shrink.zwp-ui-sty-sug-card-container .zwp-ui-zia-sug-discription {     display: none; } .zwp-ui-shrink.zwp-ui-sty-sug-card-container .zwp-ui-zia-info-txt {     color: #BBBBBB;     margin-top: 3px;     margin-bottom: 5px;     padding-top: 0px;     border-top: 0px; } .zwp-ui-shrink.zwp-ui-grm-sug-card-container .zwp-ui-zia-sug-discription {     display: none; } .zwp-ui-shrink.zwp-ui-grm-sug-card-container .zwp-ui-zia-info-txt {     color: #BBBBBB;     margin-top: 3px;     margin-bottom: 5px;     padding-top: 0px;     border-top: 0px; } .zwp-spell-error {     border-bottom: 2px solid #ff0013; } .zwp-spell-error.zwp-ui-active {     background-color: rgba(255, 114, 114, 0.2); } .zwp-grammar-error {     border-bottom: 2px solid #13af8c; } .zwp-grammar-error.zwp-ui-active {     background-color: rgba(22, 207, 166, 0.2); } .zwp-style-error {     border-bottom: 2px solid #ffb015; } .zwp-style-error.zwp-ui-active {     background-color: rgba(253, 231, 188, 0.7); } .zwp-pos-rel {     position: relative; } .zwp-card-container {     position: fixed;     z-index: 14479975; } .zbp-node {     display: inline !important; }',d.appendChild(p);var l=ZWP.NodesMap.get(i.id),f=l[ZWP.CONSTANTS.WINDOW_OBJECT];if(f!=window){var g=f.document,h=g.createElement("style");h.innerHTML=p.innerHTML,g.getElementsByTagName("head")[0].appendChild(h),t=g}if(!o){var m=document.createElement("div");m.id="zwp_suggestions_container",m.innerHTML='<div id="zwp-proofpop-spell" class="zwp-ui-sg-container zwp-ui-spl-card-container zwp-ui-shrink zwp-ui-hide">    <div class="zwp-clearfix">        <div id="zwp-proofpop-spell-ctrl" class="zwp-ui-sg-card-ctrl">            <svg id="zwp-proofpop-spell-toggleshrink" class="zwp-ui-fl zwp-ui-ms-pointer" width="16px" height="16px">                <use xlink:href="#zwp-zia-icon-expand" style="pointer-events: none;"></use>            </svg>            <i class="zwp-ui-fl zwp-ui-ms-pointer zwp-ui-icon-more-sm zwp-ui-hide"></i>        </div>        <div id="zwp-proofpop-spell-title" class="zwp-ui-fl zwp-ui-zia-sug-title zwp-ui-right-margin-small zwp-ui-bottom-margin-medium">focs</div> <!-- NO I18N -->        <div class="zwp-ui-fl zwp-ui-zia-arw-container"><span class="zwp-ui-zia-sug-arrow zwp-ui-fl"></span></div>        <div class="zwp-ui-fl ui-zia-sug-content zwp-ui-bottom-margin-medium">            <div class="zwp-ui-scorrect-label">                <span id="zwp-proofpop-spell-word" class="zwp-ui-scrt-info">xxx</span> <!-- NO I18N -->            </div>            <div id="zwp-proofpop-spell-content">                <div class="zwp-ui-top-margin-medium"></div> <!-- NO I18N -->                <div class="zwp-ui-top-margin-medium"></div> <!-- NO I18N -->            </div>        </div>    </div>    <div class="zwp-ui-zia-dict-container zwp-clearfix">        <div id="zwp-proofpop-spell-bot-ignore" class="zwp-ui-fr zwp-ui-left-margin-large zwp-ui-sg-btn">Ignore All</div> <!-- NO I18N -->        <div id="zwp-proofpop-spell-addtodic" area-label="Add to Dictionary" class="zwp-ui-fr zwp-ui-addtodic zwp-ui-ms-pointer">            <svg class="zwp-ui-fl" width="15px" height="16px">                <use xlink:href="#zwp-zia-icon-dict" style="pointer-events: none;"></use>            </svg>            <span id="zwp-proofpop-spell-addtodic-txt" class="zwp-ui-sg-btn zwp-ui-addtodic-txt" noi18n="true" style="margin-left: 20px;">ADD TO DICTIONARY</span> <!-- NO I18N -->        </div>    </div>    <div class="zwp-ui-sg-btn-cont zwp-clearfix">     <div class="zwp-ui-fl zwp-pos-rel" area-label="Reporting an inappropriate suggestion will help us understand its context in this sentence and improve the quality of the suggestions we provide.">         <div class="zwp-ui-fl zwp-ui-pos-rel zwp-ui-ms-pointer"><!-- NO I18N -->             <svg id="zwp-proofpop-spell-report" width="16px" height="16px"><use xlink:href="#zwp-zia-icon-flag" style="pointer-events: none;"></use></svg>         </div>         <div class="zwp-ui-zia-report-txt zwp-ui-left-margin-small ui-top-margin-small zwp-ui-fl" id="zwp-proofpop-spell-report-expanded"             data-title-is-message-html-encoded="true">             <div class="zwp-ui-fl zwp-ui-rep-txt">Inappropriate suggestion?</div> <!-- NO I18N -->             <i id="zwp-proofpop-spc-report-spell" class="zwp-ui-left-margin-small zwp-ui-fl zwp-ui-rep-txt">Report Now</i> <!-- NO I18N -->             <i class="zwp-ui-icon-info zwp-ui-fl zwp-ui-left-margin-small"></i>         </div>     </div> </div></div><div id="zwp-proofpop-grammar" class="zwp-ui-sg-container zwp-ui-shrink zwp-ui-hide" style="left: 637px">    <div class="zwp-clearfix">    	<div id="zwp-proofpop-grammar-ctrl" class="zwp-ui-sg-card-ctrl"> <svg id="zwp-proofpop-grammar-toggleshrink" class="zwp-ui-fl zwp-ui-ms-pointer" width="16px" height="16px"> <use xlink:href="#zwp-zia-icon-expand" style="pointer-events: none;"></use> </svg> <i class="zwp-ui-fl zwp-ui-ms-pointer zwp-ui-icon-more-sm zwp-ui-hide"></i></div><div id="zwp-proofpop-grammar-replace-blk" class="zwp-ui-fl"><div id="zwp-proofpop-grammar-replace" class="zwp-ui-fl zwp-ui-zia-sug-title zwp-ui-right-margin-small zwp-ui-bottom-margin-medium">later on</div><div class="zwp-ui-fr zwp-ui-bottom-margin-medium"><div class="zwp-ui-fl zwp-ui-zia-arw-container"><span class="zwp-ui-zia-sug-arrow zwp-ui-fl"></span></div><div class="zwp-ui-fl ui-zia-sug-content"><div class="zwp-clearfix"><div class="zwp-ui-fl zwp-ui-scorrect-label"> <span id="zwp-proofpop-grammar-word" class="zwp-ui-scrt-info">later</span></div></div><div id="zwp-proofpop-grammar-cont"></div></div></div></div>        <!-- DELETE BLOCK -->        <div id="zwp-proofpop-grammar-delete-blk">            <div id="zwp-proofpop-grammar-delete"                class="zwp-ui-fl zwp-ui-sg-wrong-word zwp-ui-right-margin-small zwp-ui-bottom-margin-medium">later on</div><!-- NO I18N -->        </div>        <div class="zwp-clearfix">            <span class="zwp-ui-zia-info-txt" id="zwp-proofpop-grammar-title">Tautological phrase</span> <!-- NO I18N -->        </div>        <p id="zwp-proofpop-grammar-content" class="zwp-ui-zia-sug-discription">Phrases like past history, when the same concept<!-- NO I18N -->            is repeated using different words, are considered tautologies. They make your writing monotonous and<!-- NO I18N -->            unnecessarily wordy.</p> <!-- NO I18N -->    </div>    <div class="zwp-ui-zia-dict-container zwp-clearfix">        <div id="zwp-proofpop-grammar-bot-ignore" class="zwp-ui-fr zwp-ui-left-margin-large zwp-ui-sg-btn">Ignore All</div> <!-- NO I18N -->    </div>    <div class="zwp-ui-sg-btn-cont zwp-clearfix"> <div class="zwp-ui-fl zwp-pos-rel" area-label="Reporting an inappropriate suggestion will help us understand its context in this sentence and improve the quality of the suggestions we provide."> <div class="zwp-ui-fl zwp-ui-pos-rel zwp-ui-ms-pointer"> <!-- NO I18N --> <svg class="zwp-ui-fl zwp-ui-ms-pointer" id="zwp-proofpop-grammar-report" width="16px" height="16px"> <use xlink:href="#zwp-zia-icon-flag" style="pointer-events: none;"></use> </svg> </div> <div class="zwp-ui-zia-report-txt zwp-ui-left-margin-small ui-top-margin-small zwp-ui-fl" data-title-is-message-html-encoded="true"> <div class="zwp-ui-fl zwp-ui-rep-txt">Inappropriate suggestion?</div> <!-- NO I18N --> <i id="zwp-proofpop-spc-report-grammar" class="zwp-ui-left-margin-small zwp-ui-fl zwp-ui-rep-txt">Report Now</i> <!-- NO I18N --> <i class="zwp-ui-icon-info zwp-ui-fl zwp-ui-left-margin-small"></i> </div> </div></div></div><svg id="zwp-zw-svg" version="1.1" xmlns="'+a+'://www.w3.org/2000/svg" xmlns:xlink="'+a+'://www.w3.org/1999/xlink"    style="position: absolute; z-index: -1; display: none;">    <symbol id="zwp-zia-icon-dict" viewBox="0 0 15 16"> <!-- NO I18N -->        <g> <!-- NO I18N -->            <path d="M2.042,15.9628 C0.937,15.9628 0.042,15.0678 0.042,13.9628 L0.042,2.0388 C0.042,0.9342305 0.9374305,0.0388 2.042,0.0388 L11,0.0388 C12.104,0.0388 13,0.9338 13,2.0388 L13,13.9628 C13,15.0678 12.104,15.9628 11,15.9628 L2.042,15.9628 Z" fill="#FFFFFF"></path> <!-- NO I18N -->            <path d="M15,12.5 C15,14.433 13.433,16 11.5,16 C9.567,16 8,14.433 8,12.5 C8,10.567 9.567,9 11.5,9 C13.433,9 15,10.567 15,12.5" fill="#3EB355"></path> <!-- NO I18N -->            <path d="M12,12 L12,11 C12,10.724 11.776,10.5 11.5,10.5 C11.224,10.5 11,10.724 11,11 L11,12 L10,12 C9.724,12 9.5,12.224 9.5,12.5 C9.5,12.776 9.724,13 10,13 L11,13 L11,14 C11,14.276 11.224,14.5 11.5,14.5 C11.776,14.5 12,14.276 12,14 L12,13 L13,13 C13.276,13 13.5,12.776 13.5,12.5 C13.5,12.224 13.276,12 13,12 L12,12 Z" fill="#FFFFFF"></path> <!-- NO I18N -->            <path d="M11,0 L2,0 C0.896,0 0,0.896 0,2 L0,12 L0,13 L0,14 C0,15.104 0.896,16 2,16 L5.5,16 C5.776,16 6,15.776 6,15.5 C6,15.224 5.776,15 5.5,15 L2,15 C1.447,15 1,14.552 1,14 L1,13 L6.5,13 C6.776,13 7,12.776 7,12.5 C7,12.224 6.776,12 6.5,12 L1,12 L1,2 C1,1.448 1.447,1 2,1 L11,1 C11.553,1 12,1.448 12,2 L12,6.475 C12,6.752 12.222,6.98 12.5,6.987 L12.513,6.987 C12.781,6.987 13,6.769 13,6.5 L13,2 C13,0.896 12.104,0 11,0" fill="#425769"></path> <!-- NO I18N -->            <path d="M5.8389,6.5 L6.4999,4.847 L7.1619,6.5 L5.8389,6.5 Z M6.9649,3.315 C6.9159,3.192 6.8179,3.089 6.6859,3.036 C6.4299,2.934 6.1389,3.058 6.0359,3.314 L6.0349,3.315 L4.0359,8.314 C3.9339,8.571 4.0589,8.862 4.3149,8.964 C4.5699,9.067 4.8609,8.942 4.9649,8.686 L5.4409,7.497 C5.4599,7.499 5.4799,7.5 5.4999,7.5 L7.4999,7.5 C7.5209,7.5 7.5409,7.499 7.5609,7.497 L8.0359,8.686 C8.1389,8.942 8.4299,9.067 8.6859,8.964 C8.9429,8.862 9.0669,8.571 8.9649,8.314 L6.9649,3.315 Z" fill="#425769"></path> <!-- NO I18N -->        </g> <!-- NO I18N -->    </symbol> <!-- NO I18N -->    <symbol id="zwp-zia-icon-flag" viewBox="0 0 16 16"> <!-- NO I18N -->        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <!-- NO I18N -->            <g> <!-- NO I18N -->                <rect x="0" y="0" width="16" height="16"></rect> <!-- NO I18N -->                <path d="M2.5,0.5 L2.5,15.5446414" stroke="#425769" stroke-linecap="round" stroke-linejoin="round"> </path> <!-- NO I18N -->                <polygon stroke="#F98D8D" fill="#F98D8D" stroke-linecap="round" stroke-linejoin="round" points="5.51798146 0.5 5.51798146 9.4909653 13.5370953 4.51583119"></polygon> <!-- NO I18N -->            </g> <!-- NO I18N -->        </g> <!-- NO I18N -->    </symbol> <!-- NO I18N -->    <symbol id="zwp-zia-icon-shrink" viewBox="0 0 16 16"> <!-- NO I18N -->        <g transform="translate(8.000000, 8.000000) rotate(-180.000000) translate(-8.000000, -8.000000) translate(1.000000, 1.000000)" fill="#9A9EA2" fill-rule="nonzero"> <!-- NO I18N -->            <path d="M4.3001224,8.99609999 L0.503577491,8.99609999 C0.227435116,8.99609999 0.00357749061,8.77224237 0.00357749061,8.49609999 C0.00357749061,8.21995762 0.227435116,7.99609999 0.503577491,7.99609999 L4.50357749,7.99609999 C5.33200462,7.99609999 6.00357749,8.66767287 6.00357749,9.49609999 L6.00357749,13.4961 C6.00357749,13.7722424 5.77971987,13.9961 5.50357749,13.9961 C5.22743512,13.9961 5.00357749,13.7722424 5.00357749,13.4961 L5.00357749,9.70685564 L0.853411617,13.8536951 C0.658071203,14.048879 0.341488739,14.048752 0.146304892,13.8534116 C-0.048878954,13.6580712 -0.0487520307,13.3414887 0.146588383,13.1463049 L4.3001224,8.99609999 Z M9.70710678,5 L13.5,5 C13.7761424,5 14,5.22385763 14,5.5 C14,5.77614237 13.7761424,6 13.5,6 L9.5,6 C8.67157288,6 8,5.32842712 8,4.5 L8,0.5 C8,0.223857625 8.22385763,-2.4158453e-13 8.5,-2.4158453e-13 C8.77614237,-2.4158453e-13 9,0.223857625 9,0.5 L9,4.29289322 L13.1464466,0.146446609 C13.3417088,-0.0488155365 13.6582912,-0.0488155365 13.8535534,0.146446609 C14.0488155,0.341708755 14.0488155,0.658291245 13.8535534,0.853553391 L9.70710678,5 Z"> </path> <!-- NO I18N -->        </g> <!-- NO I18N -->    </symbol> <!-- NO I18N -->    <symbol id="zwp-zia-icon-expand" viewBox="0 0 16 16"> <!-- NO I18N -->        <g transform="translate(1.000000, 1.000000)" fill="#9A9EA2" fill-rule="nonzero"> <!-- NO I18N -->            <path d="M1.70710678,13 L5.5,13 C5.77614237,13 6,13.2238576 6,13.5 C6,13.7761424 5.77614237,14 5.5,14 L1.5,14 C0.671572875,14 1.95399252e-14,13.3284271 1.95399252e-14,12.5 L1.95399252e-14,8.5 C1.95399252e-14,8.22385763 0.223857625,8 0.5,8 C0.776142375,8 1,8.22385763 1,8.5 L1,12.2928932 L5.14644661,8.14644661 C5.34170876,7.95118446 5.65829124,7.95118446 5.85355339,8.14644661 C6.04881554,8.34170876 6.04881554,8.65829124 5.85355339,8.85355339 L1.70710678,13 Z M12.2996345,1 L8.5,1 C8.22385763,1 8,0.776142375 8,0.5 C8,0.223857625 8.22385763,-1.00364161e-13 8.5,-1.00364161e-13 L12.5,-9.9475983e-14 C13.3284271,-9.9475983e-14 14,0.671572875 14,1.5 L14,5.5 C14,5.77614237 13.7761424,6 13.5,6 C13.2238576,6 13,5.77614237 13,5.5 L13,1.71389589 L8.36712223,6.37511407 C8.1724564,6.57097071 7.85587538,6.57193606 7.66001873,6.37727023 C7.46416209,6.1826044 7.46319674,5.86602338 7.65786257,5.67016674 L12.2996345,1 Z"> </path> <!-- NO I18N -->        </g> <!-- NO I18N -->    </symbol> <!-- NO I18N --></svg>',ZWP.Utils.addClass(m,"zwp-card-container"),document.body.appendChild(m),c.init({element:document.getElementById("zwp-proofpop-spell")}),u.init({element:document.getElementById("zwp-proofpop-grammar")}),o=!0}},a=function(e){n=e},s=function(e){var t=ZWP.NodesMap.get(e)[ZWP.CONSTANTS.WINDOW_OBJECT],n=t.frameElement,i={};if(i.top=0,i.left=0,!n||t==window)return i;var o;do o=n.getBoundingClientRect(),i.left+=o.left,i.top+=o.top,t=t.parent,t&&t!=window&&(n=t.frameElement);while(n&&t!=window);return i},d=function(e,t,n,i){var o={visibility:e.style.visibility,display:e.style.display};e.style.visibility="hidden",e.style.display="block";var r=e.offsetHeight,a=e.offsetWidth;e.style.visibility=o.visibility,e.style.display=o.display,position={};var d=s(i),p=t.getBoundingClientRect(),l={};l.top=p.top+d.top,l.left=p.left+d.left,l.height=p.height;var c={};c.left=n.clientX+d.left,c.top=n.clientY+d.top;var u=l.top;return position.top=u+l.height+r<window.innerHeight?u+l.height:u-r,position.left=c.left+a<window.innerWidth?c.left:c.left-a,position},p=!0,l=function(){var e=document.getElementById("zwp-proofpop-spell"),t=document.getElementById("zwp-proofpop-grammar");p?(ZWP.Utils.removeClass(e,"zwp-ui-shrink"),document.getElementById("zwp-proofpop-spell-toggleshrink").firstElementChild.setAttribute("xlink:href","#zwp-zia-icon-shrink"),ZWP.Utils.removeClass(t,"zwp-ui-shrink"),document.getElementById("zwp-proofpop-grammar-toggleshrink").firstElementChild.setAttribute("xlink:href","#zwp-zia-icon-shrink")):(ZWP.Utils.addClass(e,"zwp-ui-shrink"),document.getElementById("zwp-proofpop-spell-toggleshrink").firstElementChild.setAttribute("xlink:href","#zwp-zia-icon-expand"),ZWP.Utils.addClass(t,"zwp-ui-shrink"),document.getElementById("zwp-proofpop-grammar-toggleshrink").firstElementChild.setAttribute("xlink:href","#zwp-zia-icon-expand")),p=!p},c=function(){var o,r,a,s="zwp-proofpop-spell-",p=function(o){if(a&&c(),a=ZWP.ErrorsCollection.get((o.srcElement||o.target).getAttribute("data-zwp-id")),!a){var s=ZWP.NodesMap.getAll(),d=Object.keys(s).length,p=s[Object.keys(s)[0]];return void ZWP.Utils.sendErrorMail("BP_101","Proofing errorNode not found\nNumber of instances: "+d+"\nNormalizedTextLength: "+p.normalizedText.length)}for(var l=ZWP.NodesMap.get(a.proofingNodeId),f=l[ZWP.CONSTANTS.WINDOW_OBJECT].document.querySelectorAll('[data-zwp-id="'+a.getId()+'"]'),g="",h=0;h<f.length;h++)g+=f[h].textContent;return g!==a.getText()?void ZWP.Utils.sendErrorMail("BP_102","Proofing errorNode text does not match text in span\nNumber of error spans: "+f.length+"\nNormalizedTextLength: "+l.normalizedText.length):(ZWP.Utils.registerErrorNodeActivity(a,"view"),void(n&&(r=o.srcElement||o.target,u(o,a.proofingNodeId),i=!0,setTimeout(function(){document.addEventListener("click",c),t&&t.addEventListener("click",c),document.addEventListener("scroll",c),t&&t.addEventListener("scroll",c),document.addEventListener("keydown",c),t&&t.addEventListener("keydown",c),e.addEventListener("scroll",c),ZWP.Utils.updateSuggestionHighlight(a,!0)},50))))},c=function(){ZWP.Utils.addClass(o,"zwp-ui-hide"),document.removeEventListener("click",c),t&&t.removeEventListener("click",c),document.removeEventListener("scroll",c),t&&t.removeEventListener("scroll",c),document.removeEventListener("keydown",c),t&&t.removeEventListener("keydown",c),e.removeEventListener("scroll",c),i=!1,ZWP.Utils.updateSuggestionHighlight(a,!1);for(var n=document.getElementById(s+"content");n.firstChild;)n.removeChild(n.firstChild)},u=function(e,t){document.getElementById(s+"title").textContent=a.text;var n=a.suggestions;document.getElementById(s+"word").textContent=n[0];for(var i=1,p=n.length;p>i;i++){var l=document.createElement("div"),c=document.createElement("span");c.setAttribute("id","zwp-proofpop-sp-sug-"+i),c.setAttribute("class","zwp-ui-scrt-info"),c.textContent=n[i],l.appendChild(c),l.setAttribute("class","zwp-ui-top-margin-medium"),document.getElementById(s+"content").appendChild(l)}position=d(o,r,e,t),o.style.top=position.top+"px",o.style.left=position.left+"px",ZWP.Utils.removeClass(o,"zwp-ui-hide")},f=function(e){var t=e.target.id,n=e.target.parentNode&&e.target.parentNode.id||"",i=e.target.parentNode&&(e.srcElement||e.target).parentNode.parentNode&&(e.srcElement||e.target).parentNode.parentNode.id||"";if("undefined"!=typeof t){var o=!0;"zwp-proofpop-spell-word"==t||t.indexOf("zwp-proofpop-sp-sug-")>-1?ZWP.Utils.applySuggestion(a,e.target.textContent):"zwp-proofpop-spell-bot-ignore"==t?ZWP.Utils.ignoreSuggestion(a,!0):"zwp-proofpop-spell-toggleshrink"==t||"zwp-proofpop-spell-ctrl"==t||"zwp-proofpop-spell-ctrl"==n?(l(),o=!1):"zwp-proofpop-spell-addtodic"==n||"zwp-proofpop-spell-addtodic"==i?ZWP.Utils.addToUserDictionary(a):"zwp-proofpop-spell-report"==n||"zwp-proofpop-spell-report-expanded"==n||"zwp-proofpop-spell-report"==t||"zwp-proofpop-spc-report-spell"==t?ZWP.Utils.reportSuggestion(a):o=!1,o||e.stopPropagation()}},g=function(e){o=e.element,o.addEventListener("click",f)};return{init:g,handlePopupEvent:f,openCard:p,showCard:u,hideCard:c}}(),u=function(){var o,r,a,s="zwp-proofpop-grammar-",p=function(o){if(a&&c(),a=ZWP.ErrorsCollection.get((o.srcElement||o.target).getAttribute("data-zwp-id")),!a){var s=ZWP.NodesMap.getAll(),d=Object.keys(s).length,p=s[Object.keys(s)[0]];return void ZWP.Utils.sendErrorMail("BP_101","Proofing errorNode not found\nNumber of instances: "+d+"\nLanguage: "+p[ZWP.CONSTANTS.INSTANCE].lang+"\nNormalizedTextLength: "+p.normalizedText.length)}for(var l=ZWP.NodesMap.get(a.proofingNodeId),f=l[ZWP.CONSTANTS.WINDOW_OBJECT].document.querySelectorAll('[data-zwp-id="'+a.getId()+'"]'),g="",h=0;h<f.length;h++)g+=f[h].textContent;return g!==a.getText()?void ZWP.Utils.sendErrorMail("BP_102","Proofing errorNode text does not match text in span\nNumber of error spans: "+f.length+"\nLanguage: "+l[ZWP.CONSTANTS.INSTANCE].lang+"\nNormalizedTextLength: "+l.normalizedText.length):(ZWP.Utils.registerErrorNodeActivity(a,"view"),void(n&&(r=o.srcElement||o.target,u(o,a.proofingNodeId),i=!0,setTimeout(function(){document.addEventListener("click",c),t&&t.addEventListener("click",c),document.addEventListener("scroll",c),t&&t.addEventListener("scroll",c),document.addEventListener("keydown",c),t&&t.addEventListener("keydown",c),e.addEventListener("scroll",c),ZWP.Utils.updateSuggestionHighlight(a,!0)},50))))},c=function(){ZWP.Utils.addClass(o,"zwp-ui-hide"),document.removeEventListener("click",c),t&&t.removeEventListener("click",c),document.removeEventListener("scroll",c),t&&t.removeEventListener("scroll",c),document.removeEventListener("keydown",c),t&&t.removeEventListener("keydown",c),e.removeEventListener("scroll",c),i=!1,ZWP.Utils.updateSuggestionHighlight(a,!1);for(var n=document.getElementById(s+"cont");n.firstChild;)n.removeChild(n.firstChild)},u=function(e,t){switch(a.action){case"replace":ZWP.Utils.addClass(document.getElementById(s+"delete-blk"),"zwp-ui-hide"),document.getElementById(s+"replace").textContent=a.text;var n=a.suggestions;document.getElementById(s+"word").textContent=n[0];for(var i=1,p=n.length;p>i;i++){var l=document.createElement("div"),c=document.createElement("span");c.setAttribute("id","zwp-proofpop-grm-sug-"+i),c.setAttribute("class","zwp-ui-scrt-info"),c.textContent=n[i],l.appendChild(c),l.setAttribute("class","zwp-ui-top-margin-medium"),document.getElementById(s+"cont").appendChild(l)}ZWP.Utils.removeClass(document.getElementById(s+"replace-blk"),"zwp-ui-hide");break;case"delete":ZWP.Utils.addClass(document.getElementById(s+"replace-blk"),"zwp-ui-hide");var u=document.getElementById(s+"delete");u.textContent=a.text,ZWP.Utils.addClass(u,"zwp-ui-sg-wrong-word"),ZWP.Utils.removeClass(document.getElementById(s+"delete-blk"),"zwp-ui-hide");break;case"suggest":ZWP.Utils.addClass(document.getElementById(s+"replace-blk"),"zwp-ui-hide"),ZWP.Utils.addClass(document.getElementById(s+"delete-blk"),"zwp-ui-hide")}var f=document.getElementById(s+"title");ZWP.Utils.removeClass(f,"zwp-ui-wg-unclear");var g=document.getElementById(s+"content");switch(a.type){case"grammar":ZWP.Utils.addClass(o,"zwp-ui-grm-sug-card-container"),ZWP.Utils.removeClass(o,"zwp-ui-sty-sug-card-container"),f.innerHTML=ZWP.MESSAGES.GRAMMAR[a.classification].TITLE,g.innerHTML=ZWP.MESSAGES.GRAMMAR[a.classification].CONTENT;break;case"style":ZWP.Utils.removeClass(o,"zwp-ui-grm-sug-card-container"),ZWP.Utils.addClass(o,"zwp-ui-sty-sug-card-container"),f.innerHTML=ZWP.MESSAGES.STYLE[a.classification].TITLE,"UNCLEAR_PRONOUN"==a.getClassification()?(ZWP.Utils.addClass(f,"zwp-ui-wg-unclear"),g.innerHTML=ZWP.Utils.getUnclearText(a.getText(),a.getSuggestions())):g.innerHTML=ZWP.MESSAGES.STYLE[a.classification].CONTENT}position=d(o,r,e,t),o.style.top=position.top+"px",o.style.left=position.left+"px",ZWP.Utils.removeClass(o,"zwp-ui-hide")},f=function(e){{var t=e.target.id,n=e.target.parentNode&&e.target.parentNode.id||"";e.target.parentNode&&(e.srcElement||e.target).parentNode.parentNode&&(e.srcElement||e.target).parentNode.parentNode.id||""}if("undefined"!=typeof t){var i=!0;"zwp-proofpop-grammar-delete"==t?ZWP.Utils.applySuggestion(a):"zwp-proofpop-grammar-word"==t||t.indexOf("zwp-proofpop-grm-sug-")>-1?ZWP.Utils.applySuggestion(a,e.target.textContent):"zwp-proofpop-grammar-bot-ignore"==t?ZWP.Utils.ignoreSuggestion(a,!0):"zwp-proofpop-grammar-toggleshrink"==t||"zwp-proofpop-grammar-ctrl"==t||"zwp-proofpop-grammar-ctrl"==n?(l(),i=!1):"zwp-proofpop-grammar-report"==n||"zwp-proofpop-grammar-report"==n||"zwp-proofpop-grammar-report"==t||"zwp-proofpop-spc-report-grammar"==t?ZWP.Utils.reportSuggestion(a):i=!1,i||e.stopPropagation()}},g=function(e){o=e.element,o.addEventListener("click",f)};return{init:g,handlePopupEvent:f,openCard:p,showCard:u,hideCard:c}}();return{init:r,enablePopup:a,spellPopup:c,grammarPopup:u}}(ZWP.ErrorsCollection);"undefined"!=typeof e&&("undefined"==typeof ZWP&&(e.ZWP={}),e.ZWP.PopupHandler=t)}(window),function(e){var t=function(){var e=function(){var e=function(e,t,n,i,o,r,a,s,d,p,l,c){this.start=e,this.end=t,this.text=n,this.type=i,this.classification=o,this.action=r,this.suggestions=a,this.sentence=s,this.lang=d,this.startInSentence=p,this.endInSentence=l,this.proofingNodeId=c,this.id=("x"+Math.random()).replace(/\D/g,"")};return e.prototype={setStart:function(e){this.start=e},getStart:function(){return this.start},setEnd:function(e){this.end=e},getEnd:function(){return this.end},setText:function(e){this.text=e},getText:function(){return this.text},getId:function(){return this.id},setType:function(e){this.type=e},getType:function(){return this.type},setClassification:function(e){this.classification=e},getClassification:function(){return this.classification},setAction:function(e){this.action=e},getAction:function(){return this.action},setSuggestions:function(e){this.suggestions=e},getSuggestions:function(){return this.suggestions},setSentence:function(e){this.sentence=e},getSentence:function(){return this.sentence},setLang:function(e){this.lang=e},getLang:function(){return this.lang},setStartInSentence:function(e){this.startInSentence=e},getStartInSentence:function(){return this.startInSentence},setEndInSentence:function(e){this.endInSentence=e},getEndInSentence:function(){return this.endInSentence},getProofingNodeId:function(){return this.proofingNodeId}},e}(),t={},n=function(n){var i,o=new e(n.start,n.end,n.text,n.type,n.classification,n.action,n.suggestions,n.sentence,n.lang,n.startInSentence,n.endInSentence,n.proofingNodeId);return i=o.getId(),t[i]=o,i},i=function(e,t){var i=[];return e=e||[],e.forEach(function(e){e.proofingNodeId=t,i.push(n(e))}),i},o=function(e){return t[e]},r=function(){return t},a=function(){t={}};return{add:n,addAll:i,get:o,clear:a,getAll:r}}();"undefined"!=typeof e&&("undefined"==typeof ZWP&&(e.ZWP={}),e.ZWP.ErrorsCollection=t)}(window),function(e){var t={},n=function(e){return new Error("Module `{{name}}` cannot be found. Possible reasons: \n #1) Module is not loaded \n #2) Module loading failed because of errors (check previous console errors).".replace("{{name}}",e))},i=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(200===n.status?t(!0,n.responseText):t(!1))},n.open("GET",e,!0),n.send(null)},o=function(e,t){var n=document.createElement("link");return n.type="text/css",n.rel="stylesheet",n.href=e,document.getElementsByTagName("head")[0].appendChild(n),t(!0),e},r=function(){var e=function(e){var t=document.createElement("script");return t.type="text/javascript",t.charset="utf-8",t.async=!0,t.src=e,t};return function(t,n){var i=e(t);i.addEventListener("load",n.bind(this,!0),!1),i.addEventListener("error",n.bind(this,!1),!1);var o=document.getElementsByTagName("head")[0];o.appendChild(i)}}(),a=function(e,t){this.list=e,this.cb=t};a.prototype.resolve=function(e){var t=this.list.indexOf(e);t>-1&&this.list.splice(t,1),this.list.length||this.cb()};var s=function(e,n,s){var d=e.js||[],p=e.css||[],l=e.html||[],c=[].concat(d).concat(p).concat(l),u=new a(c,n);c.length||n();for(var f=function(e,n,i,o){if(!i){var r=new Error("Script/HTML download failed: "+e);throw s&&s(r),r}t[e]=n?o:!0,u.resolve(e)},g=0;g<p.length;g++){var h=p[g];t[h]?u.resolve(h):o(h,f.bind(this,h,!1))}for(var g=0;g<l.length;g++){var h=l[g];t[h]?u.resolve(h):i(h,f.bind(this,h,!0))}for(var g=0;g<d.length;g++){var h=d[g];t[h]?u.resolve(h):r(h,f.bind(this,h,!1))}},d=function(e,n){if(!n)return e.concat({});var i=n.reduce(function(e,n){return e[n]=t[n],e},{});return e=e.concat(i)},p=function(e,t,i,o,r){s(e,function(){t=t.map(function(e){if(window[e])return window[e];var t=n(e);throw o&&o(t),t}),t=d(t,e.html),i.apply(r,t)},o)},l=function(t,i,o,r,a,p){s(i,function(){o=o.map(function(e){if(window[e])return window[e];var t=n(e);throw a&&a(t),t}),o=d(o,i.html);var s=r.apply(p,o);e[t]=s},a)};e.zw=e.zw||{},e.zw.require=p,e.zw.define=l}(window);var ZWJsThreadExecutor=function(e){function t(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0,o=e.length;o>i;i++)n[i]=e.charCodeAt(i);return t}var n,i="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof URL&&"undefined"!=typeof URL.createObjectURL&&"undefined"!=typeof Blob&&"undefined"!=typeof Worker,o=function(){return(""+Math.random()).replace(/\D/g,"")},r={},a={},s=function(e,t){var i,o=!1;return n=new l(e),i=n.load(t),i.promise().done(function(){o=!0}).fail(function(){o=!1}),a[n.id]=n,i},d=function(t,n){var i=1,o=function(n,i){e({type:"GET",url:t,error:i,success:n})},r=function(e){var i={fileName:t,status:"success",fileContent:e};n&&n.resolve(i)},a=function(){if(i++,3>=i)o(r,a);else{var e={fileName:t,status:"failure"};n&&n.reject(e)}};o(r,a)},p=function(e){var t=e.data,n=t.threadId;a[n]&&a[n].processDataFromWorker(e)},l=function(e){this.fileName=e,this.worker,this.callBackFnsMap={},this.id=o()};l.prototype={load:function(e){var t=new Deferred;if(i){var n=this;if(e){var o=new Deferred;d(n.fileName,o),o.promise().done(function(e){e&&"success"===e.status&&(r[e.fileName]=e.fileContent);try{var i=window.URL.createObjectURL(new Blob([r[n.fileName]]));n.worker=new Worker(i)}catch(o){}n.worker.onmessage=function(e){ZWJsThreadExecutor.processDataFromWorker(e)},t.resolve()}).fail(function(){var e={};e.message="Request for js file zbluepencil_jsengine_min_all failed",e.code="BP_104",t.reject(e)})}else try{n.worker=new Worker(n.fileName),n.worker.onmessage=function(e){ZWJsThreadExecutor.processDataFromWorker(e)},t.resolve()}catch(a){var s={};s.message="Failed to initialize ZW js thread executor",a.stack&&(s.message+="\nStack: "+a.stack),s.code="BP_001",t.reject(s)}}else{var n=this;zw.require({js:[n.fileName]},[],function(){n.worker=ZWJsThread,t.resolve()})}return t},execFn:function(e,n,r){var a=o();r&&(this.callBackFnsMap[a]=r);var s={};s.fnName=e,s.callerId=a,s.threadId=this.id,s.params=n,s=i?t(JSON.stringify(s)):{data:s},this.worker.postMessage(s)},getWorker:function(){return this.worker},processDataFromWorker:function(e){var t=e.data,n=t.callerId,i=t.response;this.callBackFnsMap[n]&&this.callBackFnsMap[n](i)}};var c=function(e,t,i){n.execFn(e,t,i)};return{init:s,execFn:c,fileContentCache:r,processDataFromWorker:p}}(ZWP.Utils.ajax);!function(e){var t={INSTANCE:"instance",TIMER:"timer",TEXT_NODES:"textNodes",TEXT:"text",HTML:"html",IS_REGISTERED:"isRegistered",IS_CONTENT_MODIFIED:"isContentModified",IS_PROCESSED:"isProcessed",NORMALIZED_TEXT:"normalizedText",DEFAULT_SENTENCE_SPLITTER:"	",WINDOW_OBJECT:"window_object",ON_COMPLETE:"on_complete",ON_PROGRESS:"on_progress",ON_APPLYSUGG:"on_applysugg",OPTIONS:"options"},n=function(){var e={},t=function(t){return e[t]?e[t]:{}},n=function(t,n){e[t]=n},i=function(t,n){e[t]||(e[t]={}),Object.keys(n).forEach(function(i){e[t][i]=n[i]})},o=function(){return e};return{get:t,getAll:o,set:n,append:i}}(),i=function(e,n){var i=function(){var e=function(e,t){this.text=e.textContent,this.start=t,this.end=t+e.textContent.length,this.el=e};return e.prototype={getText:function(){return this.text},getStart:function(){return this.start},getEnd:function(){return this.end},getElement:function(){return this.el},setText:function(e){this.text=e},setStart:function(e){this.start=e},setEnd:function(e){this.end=e},setElement:function(e){this.el=e}},e}(),o=["DIV","BR","IMG","TD","ADDRESS","BLOCKQUOTE","BUTTON","CAPTION","DD","DEL","DL","DT","FIELDSET","FORM","H1","H2","H3","H4","H5","H6","HR","IFRAME","INS","LEGEND","LI","MAP","NOFRAMES","NOSCRIPT","OBJECT","OL","P","PRE","TABLE","TBODY","TFOOT","TH","THEAD","TR","UL"],r=function(e){var n,r,a,s=0,d="",p=!1,l=function(e,a){if(e.hasAttribute&&e.hasAttribute("data-zbluepencil-ignore")&&"true"===e.getAttribute("data-zbluepencil-ignore"))return{textNodes:[],isBlockNode:!0};var c,u,f=[],g=e instanceof Element||1===e.nodeType?e.tagName:"",h=o.indexOf(g)>-1?!0:!1;if((h||a)&&(p?(d+=t.DEFAULT_SENTENCE_SPLITTER,s+=1,a=!1):p=!0),e.nodeType===Node.TEXT_NODE){n=e.textContent,r=n.length;var m=new i(e,s);f.push(m),s+=r,d+=n,p=!0}else{var w=e.childNodes;for(u=0,c=w.length;c>u;u++){var T=l(w[u],a),N=T.textNodes;a=T.isBlockNode,f.push.apply(f,N)}}return{textNodes:f,isBlockNode:h}};return a={textNodes:l(e).textNodes,normalizedText:d}},a=function(t,o){for(var r=0;r<o.length;r++){var a,s,d,p,l,c,u,f,g=e.get(o[r]),h=g.getStart(),m=g.getEnd();for(a=0;a<t.length;a++)s=t[a],n.isStartOnlyIncludedNodeInRange(s,h,m)?(d=s.getElement().splitText(m-s.start),p=new i(d,m),t.splice(a+1,0,p),s.setEnd(m),s.setText(s.el.textContent)):n.isEndOnlyIncludedNodeInRange(s,h,m)?(d=s.getElement().splitText(h-s.start),p=new i(d,h),t.splice(a+1,0,p),s.setEnd(h),s.setText(s.el.textContent)):n.isFullyExcludedNodeInRange(s,h,m)&&(l=s.getElement().splitText(m-s.start),c=new i(l,m),t.splice(a+1,0,c),u=s.getElement().splitText(h-s.start),f=new i(u,h),t.splice(a+1,0,f),s.setEnd(h),s.setText(s.el.textContent))}};return{parseElementIntoTextNodes:r,splitNodesWRTSuggestions:a}}(ZWP.ErrorsCollection,ZWP.Utils),o=function(e,n,i,r){var a=function(n){var i,r,r=e.get(n.id),a=r[t.IS_REGISTERED];a||(i=this,n.element.setAttribute("data-zwproofread-id",n.id),n.element.setAttribute("spellcheck",!1),ZWP.Utils.msie?(n.element.addEventListener("keyup",o.onKeyDown),n.element.addEventListener("cut",o.onKeyDown),n.element.addEventListener("paste",o.onKeyDown),n.element.addEventListener("mouseup",o.onKeyDown)):(n.element.addEventListener("input",o.onKeyDown),n.element.addEventListener("keyup",o.onKeyDown)),o.bindElement(n),r={},r[t.IS_REGISTERED]=!0,e.append(n.id,r))},s=function(n){var i={};i[t.TEXT_NODES]=[],i[t.TEXT]="",i[t.NORMALIZED_TEXT]="",i[t.HTML]="",i[t.IS_REGISTERED]=!1,i[t.TIMER]="",e.append(n.id,i),ZWP.Utils.msie?(n.element.removeEventListener("keyup",o.onKeyDown),n.element.removeEventListener("cut",o.onKeyDown),n.element.removeEventListener("paste",o.onKeyDown),n.element.removeEventListener("mouseup",o.onKeyDown)):(n.element.removeEventListener("input",o.onKeyDown),n.element.removeEventListener("keyup",o.onKeyDown))},d=function(a){var s=a.id,d=e.get(a.id),p=d[t.TIMER],l=d[t.OPTIONS],c=d[t.IS_PROCESSED];clearTimeout(p);var u=d[t.WINDOW_OBJECT];d={},d[t.TEXT_NODES]=[],d[t.TEXT]="",d[t.NORMALIZED_TEXT]="",e.append(a.id,d),d=e.get(a.id),d[t.ON_PROGRESS]&&d[t.ON_PROGRESS](),r.removeErrors(a.element,u),n.clear(),p=setTimeout(function(){var n=i.parseElementIntoTextNodes(a.element),d=n.textNodes,p=n.normalizedText,u={};u[t.TEXT_NODES]=d,u[t.NORMALIZED_TEXT]=p,"undefined"==typeof c||c===!0?(u[t.IS_PROCESSED]=!1,e.append(a.id,u),o.sendToWorker(s,p,a.lang,r.postProcess,a,l)):(u[t.IS_CONTENT_MODIFIED]=!0,e.append(a.id,u))},1e3),d={},d[t.TIMER]=p,e.append(a.id,d)},p=function(){var n=e.get(this.getAttribute("data-zwproofread-id")).instance,i=this;setTimeout(function(){var e=i.innerHTML;n[t.HTML]!=e&&(n[t.HTML]=e,d(n))})},l=function(e,t){var n,i,o,r=[];return t=t||[],t.forEach(function(t){n=t.start,i=t.end,o=t.type,"spell"===o&&e._checkSpell&&!t.is_ignored&&r.push(t),"grammar"===o&&e._checkGrammar&&"undefined"!=typeof ZWP.MESSAGES.GRAMMAR[t.classification]&&r.push(t),"style"===o&&e._checkStyle&&"undefined"!=typeof ZWP.MESSAGES.STYLE[t.classification]&&r.push(t)}),r},c=function(a){var s=a.nodeId,p=e.get(s),l=p[t.INSTANCE],c=a.status&&"error"===a.status;c&&r.sendErrorMail("BP_100",a.error+"\nLanguage: "+l.lang+"\nContentLength: "+a.content.length);var u,f,g,h=a.content,m=a.suggestions;g=p[t.TEXT_NODES];var w=p[t.WINDOW_OBJECT];if(h===p[t.NORMALIZED_TEXT]){u=o.filterSuggestions(l,m),f=n.addAll(u,l.id);var T=w.document.getSelection().rangeCount&&w.document.getSelection().getRangeAt(0);if(i.splitNodesWRTSuggestions(g,f),r.markError(g,f,T),T&&(T.canUpdate||r.msie||r.safari)){"undefined"!=typeof T.actualStartOffset&&T.setStart(T.actualStartContainer,T.actualStartOffset),"undefined"!=typeof T.actualEndOffset&&T.setEnd(T.actualEndContainer,T.actualEndOffset);var N=w.getSelection();N.removeAllRanges(),N.addRange(T)}}if(p.instance[t.HTML]=p.instance.element.innerHTML,p[t.ON_COMPLETE]){var E={};c?E.status="failure":(E.status="success",E.count=l.getErrorsCount()),p[t.ON_COMPLETE](E)}p[t.IS_PROCESSED]=!0,p.hasOwnProperty([t.IS_CONTENT_MODIFIED])&&1==p[t.IS_CONTENT_MODIFIED]&&(p[t.IS_CONTENT_MODIFIED]=!1,e.append(l.id,p),d(l))},u=function(e,t,n,i,o,a){var s={nodeId:e,text:t,lang:n,csrfParamValue:r.getCsrf(),options:a};s.from=r.getFrom(),ZWJsThreadExecutor.execFn("ProofReader.process",s,c)};return{registerProofingNode:a,deregisterProofingNode:s,bindElement:d,onKeyDown:p,postProcess:c,filterSuggestions:l,sendToWorker:u}}(n,ZWP.ErrorsCollection,i,ZWP.Utils),r=function(e){var i=function(e,i){this.id=(""+Math.random()).replace(/\D/g,""),this.element=e,this.lang,this._checkSpell=!1,this._checkGrammar=!1,this._checkStyle=!1;var o={};o[t.INSTANCE]=this;var r=e.ownerDocument.defaultView||e.ownerDocument.parentWindow;if(o[t.WINDOW_OBJECT]=r,r!=window&&""!==r.location.origin&&"null"!==r.location.origin&&r.location.origin!==window.location.origin)throw"If element is in different iFrame, it must have same origin as script file";o[t.OPTIONS]=i,n.append(this.id,o)};return i.prototype.checkSpell=function(t){if(!t)throw"You must pass Language to process spellcheck";this.stopProofing(),this.lang=t,this._checkSpell=!0,this._checkGrammar=!1,this._checkStyle=!1,e.registerProofingNode(this)},i.prototype.checkGrammar=function(t){this.stopProofing(),this.lang=t,this._checkSpell=!0,this._checkGrammar=!0,this._checkStyle=!1,e.registerProofingNode(this)},i.prototype.checkStyle=function(t){this.stopProofing(),this.lang=t,this._checkSpell=!0,this._checkGrammar=!0,this._checkStyle=!0,e.registerProofingNode(this)},i.prototype.setSpellCheckLanguage=function(t){if(!t)throw"You must pass Language to process spellcheck";this.lang=t,e.bindElement(this)},i.prototype.stopProofing=function(){this._checkSpell=!1,this._checkGrammar=!1,this._checkStyle=!1;var i=n.get(this.id)[t.WINDOW_OBJECT];ZWP.Utils.removeErrors(this.element,i),ZWP.ErrorsCollection.clear(),e.deregisterProofingNode(this)},i.prototype.on=function(e,i){var o={};if("progress"===e)o[t.ON_PROGRESS]=i;else if("complete"===e)o[t.ON_COMPLETE]=i;else{if("applysuggestion"!==e)throw'You can register either "progress" or "complete" or "applysuggestion" events only';o[t.ON_APPLYSUGG]=i}n.append(this.id,o)},i.prototype.getErrorsCount=function(){var e,t,n,i=ZWP.ErrorsCollection.getAll(),o=0,r=0,a=0,s={};for(e in i)i.hasOwnProperty(e)&&(t=i[e],n=t.getType(),"spell"===n?o++:"grammar"===n?r++:"style"===n&&a++);return s={spell:o,grammar:r,style:a,all:o+r+a}},i}(o),a=new Deferred,s=function(e,t){var n=function(){return t.SupportedLanguages.getAll()},i=function(n,i,o){if(!i)throw"You must register a DOM element to process Proofing";t.setFrom(n);var r=o||{},a=new e(i,r);return ZWP.PopupHandler.init(a),a},o=function(e){a.done(e)},r=function(e){a.fail(e)},s=function(){return t.personalDictionary},d=function(e){var t=document.createElement("div");t.innerHTML=e;for(var n,i,o,r=t.getElementsByClassName("zbp-node");r.length>0;){for(o=r.item(0),n=document.createDocumentFragment(),i=o.childNodes;i.length>0;)n.appendChild(i[0]);o.parentNode.replaceChild(n,o)}return t.innerHTML};return{initialize:i,onload:o,onerror:r,getSupportedLanguages:n,getPersonalDictionary:s,eraseMarks:d}}(r,ZWP.Utils),d=ZWJsThreadExecutor.init("/proofing/v1_8/js/zbluepencil_jsengine_min_all.js"),p=ZWP.Utils.init();Deferred.when(d,p).done(function(){a.resolve()}).fail(function(e){ZWP.Utils.sendErrorMail(e.code,e.message),a.reject()}),ActivityTracker.initialize("/proofing",ZWP.Utils.ajax,ZWP.Utils.setCsrfParamInHeader,ZWP.Utils.setCsrfParam),"undefined"!=typeof e&&(e.ZBluePencil=s,e.ZWP.NodesMap=n,e.ZWPNodesHandler=o,e.ZWP.CONSTANTS=t)}(window);