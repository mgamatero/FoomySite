(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"/70n":function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a=n("q1tI"),i=n.n(a),o=n("sEfC"),s=n.n(o),r=n("8lxu"),c=n("YC+u"),l=n("92Lq"),d=n("RzHV"),u=n("YV/N"),p=function(e){function t(e,a){var i;return babelHelpers.classCallCheck(this,t),i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,a)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"reRender",function(){i.forceUpdate()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"setTopLeft",function(){var e=i.props.noteList.listInfo;e&&"stickyNote"===e.mode||!i.props.noteList.length||Object(c.g)(!1,i.props.noteList.mountingElem)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"openStickyNote",function(e){var t=i.props.noteList.get(e.id);t&&(!0===t.get("showStickyNote")?t.trigger("change:addedagain"):t.showNote(!0))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"getAvailableTopLeft",function(){var e=babelHelpers.assertThisInitialized(i).top,t=babelHelpers.assertThisInitialized(i).left;i.incrementTopLeft(),i.top>document.body.clientHeight-400&&(i.top=30),i.left>document.body.clientWidth-400&&(i.left=30);var n=i.maxZIndex;return i.maxZIndex<100&&i.incrementZIndex(),{top:e,left:t,zIndex:n}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"incrementZIndex",function(){i.maxZIndex+=1}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"incrementTopLeft",function(){i.top+=60,i.left+=30}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleZIndex",function(e){i.maxZIndex>=99&&(i.props.noteList.each(function(e){e.set({zIndex:1})}),i.maxZIndex=2),e.get("zIndex")+1!==i.maxZIndex&&(e.set({zIndex:i.maxZIndex}),i.incrementZIndex())}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"setOpenNote",function(e){i.previewId=e}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"getOpenNote",function(){return i.previewId||""}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleCreate",function(){Promise.all([n.e(0),n.e(6),n.e(20),n.e(21),n.e(22),n.e(24),n.e(29),n.e(109)]).then(n.bind(null,"CHNO")).then(function(e){(0,e.createInlineNotes)()})}),i.initializeValue(),i.handleWindowResize=s()(i.setTopLeft,500),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentDidUpdate",value:function(){this.setTopLeft()}},{key:"componentDidMount",value:function(){var e=this,t=this.props.noteList;$.e(window).resize(this.handleWindowResize),$.subscribe("/apps/tabSwitched",this.setTopLeft),$.subscribe("/integ/rhs",this.setTopLeft),t.on("alignNoteBox",this.setTopLeft),t.on("add reset remove change:renamenotecat",this.reRender),setTimeout(function(){e.setTopLeft()},100),t.listInfo&&"stickyNote"===t.listInfo.mode&&(r.a.on("openStickyNote",this.openStickyNote,this),t.on("change:showStickyNote",this.reRender))}},{key:"initializeValue",value:function(){this.top=this.top||30,this.left=this.left||30,this.maxZIndex=this.maxZIndex||2}},{key:"getCurrentTopLeft",value:function(){return{top:this.top,left:this.left}}},{key:"componentWillUnmount",value:function(){this.props.noteList.stopSubscriptions(),$.e(window).off("resize",this.handleWindowResize),$.unsubscribe("/apps/tabSwitched",this.setTopLeft),$.unsubscribe("/integ/rhs",this.setTopLeft)}},{key:"appendList",value:function(){this.props.noteList.concat()}},{key:"noteView",value:function(e,t){this.noteViewList=this.noteViewList||{},this.noteViewList[t.get("id")]=e}},{key:"getTopLeft",value:function(e){var t=this.noteViewList[e];return{top:t.top,left:t.left}}},{key:"getWidthHeight",value:function(e){return{width:this.noteViewList[e].width,height:this.noteViewList[e].getDescriptionHeight()}}},{key:"render",value:function(){var e,t,n,a,o=this,s=this.props,r=s.stickyNote,c=s.noteList,p=c.listInfo,h=p.mode;r&&(n=this.handleZIndex,a=this.getAvailableTopLeft);var m=function(e){return function(t){o.noteView(t,e)}};if(c.length)return i.a.createElement("div",{id:"wrapperNoteDiv",ref:"wrapDiv"},c.map(function(t){return e=t.get("oldId")||t.get("id"),!1===t.get("showStickyNote")?null:i.a.createElement(d.a,{note:t,ref:m(t),stickyNote:r,handleOnOpenNote:o.setOpenNote,openedNote:o.getOpenNote,getAvailableTopLeft:a,handleZIndex:n,readMode:o.props.readMode,key:e,mountingElem:c.mountingElem})}));var b="stickyNote"===h?"zmInfoWarnMsg zmHideD":"zmInfoWarnMsg";return t=["byuser","sharedtome","archive","createdbyme"].includes(h)||l.c.isGroupDisabled(p.groupId)?Object(u.b)("bd3581ce55a6d98ee256744762f66c16"):"search"===h?Object(u.b)("7279bbdc0846ecf593f05273c1c916f0"):Object(u.a)(Object(u.b)("3d6590bcdd6aed78fc8b2f11e55c658d"),{create:i.a.createElement("span",{className:"zmLink",onClick:this.handleCreate}," ",Object(u.b)("309ae27723377cfbd66856ec10e482fa")," ")}),i.a.createElement("div",{id:"wrapperNoteDiv",ref:"wrapDiv"},i.a.createElement("div",{id:"nonotes",className:b},t))}}]),t}(i.a.Component)},"34oF":function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"b",function(){return r}),n.d(t,"a",function(){return c}),n.d(t,"f",function(){return g}),n.d(t,"d",function(){return y}),n.d(t,"l",function(){return I}),n.d(t,"h",function(){return k}),n.d(t,"n",function(){return l}),n.d(t,"j",function(){return u}),n.d(t,"p",function(){return p}),n.d(t,"g",function(){return v}),n.d(t,"i",function(){return N}),n.d(t,"k",function(){return C}),n.d(t,"e",function(){return h}),n.d(t,"o",function(){return m}),n.d(t,"m",function(){return b}),n.d(t,"q",function(){return f});var a,i,o,s={appid:"zm_notes",appicon:"msi-notes",modulename:"notes"},r={currLayId:"",rgtMenuId:"",scrolling:!1},c=function(e){a=zmComponent.loadingBand(e)},l=function(){a&&(a(),a=void 0)},d={},u=function(){return d},p=function(e){d=e},h=function(){return i},m=function(e){i=e},b=function(){return o},f=function(e){o=e},g=function(){return zmsuite.getCenter(s.appid)},v=function(){return g()[0].getNodes()[1].$el},y=function(){return $.e(g()[0].getCustomElements()[1].$el)},I=function(){return $.e(g()[0].getCustomElements()[0].$el)},N=function(){return $.e(v().find(".zmAHRow")[0])},k=function(){return $.e(g()[0].getCustomElements()[2].$el)},C=function(){return g()[0].getNodes()[2].getListElem()}},"3dfV":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=new(n("keaJ").a)(200);window.zNoteLogger=a},"83P7":function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"b",function(){return h});var a,i=n("q1tI"),o=n.n(i),s=n("i8i4"),r=n.n(s),c=n("/Qv1"),l=n("8lxu"),d=n("Kz78"),u=n("EkmJ"),p=n("/70n"),h=function(){return a},m=function(){var e=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zmModules.getRHSModule();case 2:t=e.sent,(0,t.rhs)().rhsBar.getApp("StickyNotes").updateCounter(c.f.getInstance("stickynote").length);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(t,n){var i,s,h,b,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=t).type=n||"add",i.showStickyNote=void 0===i.showStickyNote||i.showStickyNote,s=function(e){a=e},!(h=c.f.getInstance("stickynote"))||!h.findWhere({id:i.id})){e.next=8;break}return l.a.trigger("openStickyNote",{namespaceId:i.namespaceId,id:i.id}),e.abrupt("return");case 8:return h?$.publish("/note/addstickynote",i):(b=$.e(Object(d.z)()),$.q("body").appendDOM(b),h=Object(u.b)(i,{mode:"stickyNote",type:"stickynote"}),r.a.render(o.a.createElement(p.a,{ref:s,stickyNote:!0,noteList:h}),b[0]),h.on("remove reset",m)),e.next=11,zmModules.getRHSModule();case 11:f=e.sent,(0,f.rhs)().rhsBar.getApp("StickyNotes").updateCounter(h.length);case 14:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}();l.a.on("addAsStickyNote",b)},"8lxu":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=new(n("Xuck").a)},EkmJ:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"b",function(){return r}),n.d(t,"a",function(){return c});var a=n("ubdq"),i=n("Q6iu"),o=n("/Qv1"),s=function(e,t,s,r,c){var l=i.a,d=Object(a.a)(),u=s.type||"note";t&&t.showHeader&&s&&"mailassociated"===s.type&&(u="mailassociatedList"),u.startsWith("mailassociated")&&(u+=s.msgid);var p=o.f.getInstance(u);return p?p.reset():(p=o.f.createInstance(u,l,{adapterConfig:d,offlineEnabled:zmail.isOfflineEnabled}),"note"===u&&Promise.all([n.e(0),n.e(20),n.e(21)]).then(n.bind(null,"/dGo")).then(function(e){var t=e.constructViewIcons;Promise.all([n.e(0),n.e(20),n.e(21),n.e(121)]).then(n.bind(null,"iy54")).then(function(e){var n=e.updateHeaderBandWithObj,a=e.updateHeaderBand;t({updateHeaderBandWithObj:n,updateHeaderBand:a})})})),p.initialize(t,s,r),p.add(e[0].Notes),p},r=function(e,t){var n=i.a,s=Object(a.a)(),r=t.type;t.deletePreviousInstance&&o.f.deleteInstance(r);var c=o.f.getInstance(r);return t&&!c&&(c=o.f.createInstance(r,n,{adapterConfig:s,offlineEnabled:zmail.isOfflineEnabled})),c.initialize(void 0,{mode:t.mode}),c.add(e),c},c=function(e,t){var n=o.f.getInstance(t);if(n){var a=n.get(e);a&&n.remove(a)}}},HzOS:function(e,t,n){"use strict";function a(e){if(void 0===e.which||!e.ctrlKey&&!e.metaKey&&!e.altKey&&8!==e.which&&13!==e.which)return!0}function i(e){return e?e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&#39;/g,"'").replace(/&amp;/g,"&"):""}function o(e){return e?e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/'/g,"&#39;"):""}n.d(t,"a",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return s});var s=function(e){var t="";if(void 0!==window.getSelection){var n,a=window.getSelection();if((n=a.rangeCount)>0)for(var i,o=document.createRange(),s=0;s<n;++s)o.selectNodeContents(e),1===(i=a.getRangeAt(s)).compareBoundaryPoints(o.START_TO_END,o)&&-1===i.compareBoundaryPoints(o.END_TO_START,o)&&(1===i.compareBoundaryPoints(o.START_TO_START,o)&&o.setStart(i.startContainer,i.startOffset),-1===i.compareBoundaryPoints(o.END_TO_END,o)&&o.setEnd(i.endContainer,i.endOffset),t+=o.toString())}else if(void 0!==document.selection&&"Text"===document.selection.type){var r=document.selection.createRange(),c=r.duplicate();c.moveToElementText(e),1===r.compareEndPoints("EndToStart",c)&&-1===r.compareEndPoints("StartToEnd",c)&&(1===r.compareEndPoints("StartToStart",c)&&c.setEndPoint("StartToStart",r),-1===r.compareEndPoints("EndToEnd",c)&&c.setEndPoint("EndToEnd",r),t=c.text)}return t}},Q6iu:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("s5DJ"),i=n("/Qv1"),o=n("YV/N"),s=function(e){var t=zmail.Search,n=t.SearchWatcher,a=t.Environment;if("notes"!==n.getOpenTabContextID())return!1;var i=a.toJSON(),o=!0,s=!1,r=void 0;try{for(var c,l=i[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var d=c.value;if(d.name===e)return d}}catch(e){s=!0,r=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw r}}return!1},r=function(e){function t(){var e,n;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"addNoteToCollection",function(e,t){var a=babelHelpers.assertThisInitialized(n).listInfo;"mailassociated"===a.id&&a.msgid===t.email.msgid&&n.unshift(t),["c","modifieddatedesc"].includes(a.mode)&&("zn_catAll"===a.id&&a.groupId===t.namespaceId||a.id===t.cat)&&(t.newNote=!0,n.unshift(t)),["modifieddateasc"].includes(a.mode)&&(a.id===t.cat||"zn_catAll"===a.id&&a.groupId===t.namespaceId)&&n.options&&n.options.page&&"1"!==n.options.page.showNextPage&&(t.newNote=!0,n.add(t)),"stickyNote"===n.listInfo.mode&&void 0!==t.showStickyNote&&n.unshift(t),"createdbyme"===n.listInfo.mode&&t.ownerZUID===zmail.zuid&&n.unshift(t)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"removeNoteFromCollection",function(e,t){t.noteIds&&(n.remove(t.noteIds,{silent:!0}),n.trigger("remove")),n.get(t)&&n.remove(n.get(t))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"deleteNoteCat",function(e,t){var a=n.where({cat:t});a.length&&(n.remove(a,{silent:!0}),n.trigger("remove"))}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initialize",value:function(e,t,n){var a=this;this.prevId="-1",this.options=e,this.listInfo=t,this.mountingElem=n,this.unmountCalled=!1,this.on("change:cat",function(e){"c"===t.mode&&t.id!==e.get("cat")&&"zn_catAll"!==t.id&&a.remove(e)}),this.on("change:archived",function(e){(e.get("archived")&&"c"===t.mode||!e.get("archived")&&"archive"===t.mode)&&a.remove(e)}),this.on("change:tagId",function(e){"l"!==a.listInfo.mode||e.get("tagId").includes(a.listInfo.id)||a.remove(e)}),this.on("change:starred",function(e){if("fav"===a.listInfo.mode&&!1===e.get("starred"))a.remove(e);else if("search"===a.listInfo.mode){s("in favourites")&&a.remove(e)}}),this.on("change:selected",function(e){"c"===a.listInfo.mode&&$.publish("/note/selected",[{selectedNotes:a.where({selected:!0}).length}])}),this.on("change:color",function(e){if("search"===a.listInfo.mode){var t=s("note color");t&&t.obj&&t.obj.value!==e.get("color")&&a.remove(e)}}),this.on("reset",function(){a.prevId="-1"}),$.subscribe("/note/add",this.addNoteToCollection),$.subscribe("/note/copy",this.addNoteToCollection),$.subscribe("/note/delete",this.removeNoteFromCollection),$.subscribe("/delete/notescat",this.deleteNoteCat),this.listInfo&&"stickyNote"===this.listInfo.mode&&($.subscribe("/note/closeStickyNote",this.removeNoteFromCollection),$.subscribe("/note/addstickynote",this.addNoteToCollection))}},{key:"bulkDelete",value:function(){var e=this,t=this.where({selected:!0}),n=[];t.forEach(function(e){n.push(e.get("id"))});var a={entityIds:n.join(","),actionType:"delEntity",entityType:"2",groupId:this.listInfo.groupId,mode:"deleteNotes"};this.triggerAction("bulkdelete",{param:a}).then(function(n){_zm.succErrMsg("s",Object(o.b)("f9eea45736bc56a63c7a806f1590e98f")),t.forEach(function(e){e.set("selected",!1)}),t=e.where({selected:!0}),$.publish("/note/selected",[{selectedNotes:t.length}])})}},{key:"stopSubscriptions",value:function(){this.off(),$.unsubscribe("/note/delete",this.removeNoteFromCollection),$.unsubscribe("/note/add",this.addNoteToCollection),$.unsubscribe("/delete/notescat",this.deleteNoteCat),"stickyNote"===this.listInfo.mode&&($.unsubscribe("/note/closeStickyNote",this.removeNoteFromCollection),$.unsubscribe("/note/addstickynote",this.addNoteToCollection)),this.unmountCalled=!0}},{key:"getBaseModelClass",value:function(){return a.a}},{key:"handleBulkDeselect",value:function(){this.forEach(function(e){e.get("selected")&&e.set({selected:!1})})}},{key:"handleBulkSelect",value:function(){for(var e,t=this.where({selected:!0}).length,n=0;n<this.length;n++)if(t<50){var a=this.models[n];!a.get("selected")&&a.isOwnerOrGrpAdmin()&&(a.set("selected",!0),t++)}else e=!0;e&&_zm.succErrMsg("e",Object(o.b)("4025b030d8d1b0a6e57660fbba3c8dd3")),this.trigger("change:selected")}},{key:"handleSelect",value:function(e,t){if(this.where({selected:!0}).length>=50&&!t.get("selected"))_zm.succErrMsg("e",Object(o.b)("13802368558f5229c3b830f3eac65b3a"));else{var n,a=this.prevId,i=this.indexOf(this.get(a)),s=this.indexOf(t);if(!e.shiftKey||e.shiftKey&&("-1"===a||i===s))t.set("selected",!t.get("selected"));else{var r,c=this.where({selected:!0}).length;if(t.get("selected")){var l=s,d=i;for(s>i&&(l=i,d=s),r=l;r<=d;r++)this.models[r].set("selected",!1)}else n=s>i?this.multiSelectForward(i,s,c):this.multiSelectBackward(i,s,c)}n&&_zm.succErrMsg("e",Object(o.b)("4025b030d8d1b0a6e57660fbba3c8dd3")),this.prevId=t.get("id"),this.trigger("change:selected")}}},{key:"multiSelectForward",value:function(e,t,n){var a,i=!1;for(a=e;a<=t;a++)if(n<50){var o=this.models[a];!o.get("selected")&&o.isOwnerOrGrpAdmin()&&(o.set("selected",!0),n++)}else i=!0;return i}},{key:"multiSelectBackward",value:function(e,t,n){var a,i=!1;for(a=e;a>=t;a--)if(n<50){var o=this.models[a];!o.get("selected")&&o.isOwnerOrGrpAdmin()&&(o.set("selected",!0),n++)}else i=!0;return i}}]),t}(i.a)},RzHV:function(e,t,n){"use strict";n.d(t,"a",function(){return O});var a=n("q1tI"),i=n.n(a),o=n("uNFK"),s=n("sEfC"),r=n.n(s),c=n("Kz78"),l=n("eXgx"),d=n("c8D3"),u=n("w0m/"),p=n("uwyq"),h=n("YC+u"),m=n("vr4s"),b=n("HzOS"),f=n("DoNX"),g=n("V61T"),v=n("92Lq"),y=n("pucZ"),I=n("nLCp"),N=n("YV/N"),k=n("n1Te"),C="".concat(zmail.conPath,"/FileDownload?attachId="),O=function(e){function t(e,n){var a;return babelHelpers.classCallCheck(this,t),a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleNoteModelChange",function(){var e=a.props.stickyNote;a.reRender(),e||Object(h.g)(!1,a.props.mountingElem[0])}),a.debouncedViewNote=r()(function(){a.viewNote()},1e3,{leading:!0}),a.setWrapperRef=function(e){a.noteElm=$.e(e)},a.setTitleCompRef=function(e){a.titleComp=e},a.setContentCompRef=function(e){a.contentComp=e},_zm.autoBind(babelHelpers.assertThisInitialized(a),["handleMouseUp","handlePopOutNote","handleOnMinimize","handleOnClose","viewNote","handleOpenNote","reRender","setContentFocus"]),a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"setContentFocus",value:function(){this.contentComp.contentElm.focus()}},{key:"reRender",value:function(){this.forceUpdate()}},{key:"setDragHandler",value:function(){var e=this;this.noteElm.draggable({scroll:!1,containment:"window",stop:function(t,n){e.left=n.position.left,e.top=n.position.top,e.props.note.set({left:n.position.left,top:n.position.top},{silent:!0}),$.publish("stickyNoteMod")},start:function(){Object(o.c)()},drag:function(){Object(o.c)()},stack:this.noteElm[0]})}},{key:"setResizeHandler",value:function(){var e=this,t=this.contentComp.contentWrapperElm,n=this.contentComp.contentElm,a=this.noteElm;t.resizable({containment:"document",handles:{se:t.find(".zmNoteResizeNWSE")[0],e:t.find(".zmNoteResizeEW")[0],s:t.find(".zmNoteResizeNS")[0]},maxHeight:500,maxWidth:500,minHeight:24,minWidth:200,start:function(){n.css("maxHeight","500px")},resize:function(e,i){var o=i.size.width+36,s=i.size.height;a.css("width","".concat(o,"px")),n.css("height","".concat(s,"px")),document.body.clientHeight<a.position().top+a.outerHeight(!0)&&(n.css("height","".concat(s-30,"px")),t.css("height","".concat(s-30,"px")),$.e(this).resizable("widget").trigger("mouseup"))},stop:function(t,n){e.width=n.size.width,e.height=n.size.height,e.props.note.set({width:n.size.width+36,height:n.size.height},{silent:!0}),$.publish("stickyNoteMod")}})}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.note,a=t.stickyNote;n.on("change",this.handleNoteModelChange),n.on("change:renamenotecat",this.reRender);var i=this.noteElm;n.get("newNote")&&(n.set("newNote",void 0),i.addClass("zmNewNote"),setTimeout(function(){i.removeClass("zmNewNote")},2e3)),a&&("restore"!==n.get("type")&&"new"!==n.get("type")&&$.publish("stickyNoteMod"),setTimeout(function(){i.removeClass("stickingNote")},500),this.setDragHandler(),this.setResizeHandler(),i.mousedown(function(){e.props.handleZIndex(n)}),n.on("change:addedagain",function(t){e.props.handleZIndex(n),e.noteElm.addClass("shakeNote"),setTimeout(function(){e.noteElm.removeClass("shakeNote")},500)}),this.noteElm.on("mousedown",function(){document.activeElement.blur()}),"add"===n.get("type")&&n.set({type:"restore"},{silent:!0}))}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0;var e=this.props,t=e.stickyNote,n=e.note;void 0===n.changed.showStickyNote&&n.stopSubscriptions(),t||Object(m.hideMenu)()}},{key:"handleOnClose",value:function(){this.props.note.closeNote(),$.publish("stickyNoteMod")}},{key:"setDescriptionHeight",value:function(e){this.height=e}},{key:"getDescriptionHeight",value:function(){return this.height}},{key:"viewNote",value:function(){var e=this;if(""===this.props.openedNote()){var t=this.props.note;this.props.handleOnOpenNote(t.get("id")),Promise.all([n.e(0),n.e(6),n.e(7),n.e(11),n.e(19)]).then(n.bind(null,"jenI")).then(function(n){(0,n.openNoteInPopup)({id:t.get("id"),namespaceId:t.get("namespaceId")},{handleOnOpen:e.props.handleOnOpenNote,isUnMounted:function(){return e.isUnmounted},noteElm:e.noteElm})})}}},{key:"handleOnMinimize",value:function(){var e=this,t=this.noteElm;this.left=t.offset().left-20,this.top=t.offset().top-20;var n=$.q("#sNoteTab").find(".msi-stickyNote").offset().left,a=$.q("#sNoteTab").find(".msi-stickyNote").offset().top,i=t.outerHeight(!0),o=t.outerWidth(!0),s=t.width();t.animate({left:n-16,top:a-20,height:0,width:0},{complete:function(){t.css({top:"".concat(e.top,"px"),left:"".concat(e.left,"px")}),t.outerHeight(i),t.outerWidth(o),t.css("height",""),t.width(s),e.props.note.showNote(!1)},duration:700})}},{key:"handleMouseUp",value:function(){this.selection=Object(b.b)(this.noteElm[0])}},{key:"handleOpenNote",value:function(){(this.selection=Object(b.b)(this.noteElm[0]),this.selection.length)||(this.props.stickyNote||this.debouncedViewNote())}},{key:"handlePopOutNote",value:function(e){e.stopPropagation(),this.debouncedViewNote()}},{key:"render",value:function(){var e,t=this.props,n=t.note,a=t.stickyNote,o=n.get("color"),s="zmNote jsNote ".concat(a?"stickyNote ":"thumbNote ").concat(d.a.COLORCODE[o]);!1===n.get("showStickyNote")&&(s+=" zmHideD");var r={transform:"translateX(-1000px)",width:"276px"};return a?(r={width:"276px"},!0===n.get("showStickyNote")&&"add"===n.get("type")&&(s+=" stickingNote"),void 0!==n.get("top")&&(this.top=n.get("top"),n.set({top:void 0},{silent:!0})),void 0!==n.get("left")&&(this.left=n.get("left"),n.set({left:void 0},{silent:!0})),void 0!==this.left&&void 0!==this.top&&void 0!==n.get("zIndex")||(e=this.props.getAvailableTopLeft()),void 0!==n.get("width")?this.width=n.get("width"):(this.width=276,n.set({width:"276"},{silent:!0})),void 0===n.get("zIndex")&&e&&n.set({zIndex:e.zIndex},{silent:!0}),this.left=void 0!==this.left?this.left:e.left,this.top=void 0!==this.top?this.top:e.top,n.set({left:this.left},{silent:!0}),n.set({top:this.top},{silent:!0}),r.left="".concat(this.left,"px"),r.top="".concat(this.top,"px"),r.width="".concat(this.width,"px"),r.zIndex=n.get("zIndex")):s+=n.get("selected")?" zmNoteCheck":"",i.a.createElement("div",{className:s,onMouseUp:this.handleMouseUp,onClick:this.handleOpenNote,ref:this.setWrapperRef,style:r},a&&i.a.createElement("div",{className:"zmNoteMove",ref:"dragband",title:Object(N.b)("c0b4bf139d97d45ecf452b79c448c2a4")}),a&&i.a.createElement("div",{className:"zmNoteMkRmStky",onClick:this.handleOnClose,"data-tooltip":Object(N.b)("afd4daa47f770743072df6862067c39e")},i.a.createElement("i",{className:"msi-stiPNotes"})),i.a.createElement(T,{note:n,stickyNote:a}),i.a.createElement("div",{className:"zmNoteWra"},i.a.createElement("div",{className:"zmNoteHdr"},i.a.createElement(w,{note:n}),i.a.createElement(z,{note:n,stickyNote:a}),a&&i.a.createElement("div",{className:"zmNoteHdrIcons"},i.a.createElement("div",{className:"zmAMB"},i.a.createElement(p.b,null,"new"!==n.get("type")&&i.a.createElement(p.a,{small:!0,iconClass:"msi-popout",onClickHandler:this.handlePopOutNote}),i.a.createElement(p.a,{small:!0,iconClass:"msi-minus",onClickHandler:this.handleOnMinimize}))))),i.a.createElement(A,{note:n,ref:this.setTitleCompRef,stickyNote:a,setContentFocus:this.setContentFocus}),i.a.createElement(j,{note:n,print:this.props.print,viewNote:this.viewNote,stickyNote:a,mountingElem:this.props.mountingElem,ref:this.setContentCompRef})),i.a.createElement("div",{className:"zmNoteAction"},i.a.createElement("div",{className:"zmNoteActionIcons"},i.a.createElement("div",{className:"zmAMB"},i.a.createElement(p.b,null,i.a.createElement(u.b,{note:n}),i.a.createElement(l.c,{note:n,stickyNote:a,boxView:!0}),i.a.createElement(l.b,{note:n,stickyNote:a}),i.a.createElement(u.c,{ref:"showmore",note:n,stickyNote:a})))),i.a.createElement("div",{className:"zmNoteComment"},i.a.createElement("div",{className:"zmAMB"},i.a.createElement(p.b,null,i.a.createElement(l.a,{note:n,boxView:!0}),i.a.createElement(u.a,{note:n}))))),i.a.createElement("div",{className:"zmNoteBtm"},i.a.createElement("div",{className:"zmNoteData"},i.a.createElement(E,{note:n,stickyNote:a}),i.a.createElement(H,{note:n,stickyNote:a})),i.a.createElement(k.a,{ref:"attDiv",note:n})))}}]),t}(i.a.Component),w=function(e){function t(e){var n;return babelHelpers.classCallCheck(this,t),(n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e))).setCreatorRef=function(e){n.creatorElm=$.e(e)},n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.note;zmail.ContactBook.get({zuid:t.get("ownerZUID"),type:"org"}).then(function(t){var n=t[0];n&&n.attrs&&n.attrs.fn&&e.creatorElm.attr("data-tooltip",n.attrs.fn).appendDOM(n.avatar())})}},{key:"render",value:function(){return i.a.createElement("span",{ref:this.setCreatorRef})}}]),t}(i.a.Component),z=function(e){function t(){var e,n;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"reRender",function(){n.forceUpdate()}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentDidMount",value:function(){this.props.stickyNote&&(this.intervalId=setInterval(this.reRender,5e3))}},{key:"componentWillUnmount",value:function(){this.props.stickyNote&&clearInterval(this.intervalId)}},{key:"render",value:function(){var e,t=this.props,n=t.stickyNote,a=t.note;return e=_zm._isPrivilegedUser()&&n&&a.get("updatedTime")?zmComponent.dateTimeUtil.getRelativeTimeInNoteFormat(a.get("updatedTime"),"mm dd at hr:min"):a.get("disptime"),i.a.createElement("div",{className:"zmNoteDate"},e)}}]),t}(i.a.Component),T=function(e){function t(){var e,n;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleSetCheck",function(e){var t=n.props.note;e.stopPropagation(),t._collection.handleSelect(e,t)}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props,t=e.note,n=e.stickyNote,a=t._collection.listInfo;return n?null:a&&"c"!==a.mode||!t.isOwnerOrGrpAdmin()?i.a.createElement("div",{className:"zmNoteChk"},i.a.createElement("i",{className:"msi-tick zmHideV"})):i.a.createElement("div",{className:"zmNoteChk"},i.a.createElement("i",{className:"msi-tick",onClick:this.handleSetCheck}))}}]),t}(i.a.Component),H=function(e){function t(e){var n;return babelHelpers.classCallCheck(this,t),(n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e))).setLabelRef=function(e){n.labelElm=e},_zm.autoBind(babelHelpers.assertThisInitialized(n),["handleAddLabel"]),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"handleAddLabel",value:function(e){e.stopPropagation();var t=this.props,n=t.stickyNote,a=t.note,i=e.target.closest(".zmNoteLbl");Object(f.c)({parent:i,labelState:{labelList:this.props.note.get("tagId")},spanClass:n?"zmArmZI":"",note:a,onHide:function(){i.classList.remove("active")}}),i.classList.add("active")}},{key:"render",value:function(){var e=this.props.note;if("new"===e.get("type"))return null;var t={backgroundColor:""},n=e.get("tagId");return n&&n.length>0?i.a.createElement("div",{className:"zmNoteLbl",onClick:this.handleAddLabel},i.a.createElement("div",{className:"zmLblGrp"},n.map(function(e,n){if(n>=3)return null;var a=Object(g.v)("default")[e];return!!a&&(t={backgroundColor:a.color},i.a.createElement("div",{className:"zmLbl",title:a.label},i.a.createElement("span",{style:t})))}),n.length>3&&i.a.createElement("div",{className:"zmLbl"},i.a.createElement("font",{className:"moreLbl"},"+",n.length-3)))):i.a.createElement("div",{className:"zmNoteLbl"},i.a.createElement("div",{className:"zmAMB"},i.a.createElement(p.b,null,i.a.createElement(p.a,{small:!0,iconClass:"msi-label",tooltip:Object(N.b)("2efd89b3ccc76b0b03a34196fc6d1c8b"),onClickHandler:this.handleAddLabel}))))}}]),t}(i.a.Component),E=function(e){function t(e,n){var a;return babelHelpers.classCallCheck(this,t),a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n)),_zm.autoBind(babelHelpers.assertThisInitialized(a),["handleChangeBook","handleChangeGroup"]),a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"handleChangeGroup",value:function(e){var t=this.props.note;if(t.isOwnerOrGrpAdmin()){e.stopPropagation();var n=this.props.stickyNote,a={ignoreGroupId:t.get("namespaceId"),parent:e.target.closest("li"),spanClass:n?"zmArmZI":"",onSelect:function(e){var a={okButtonName:Object(N.b)("93cba07454f06a4a960172bbd6e2a435"),cancelButtonName:Object(N.b)("bafd7322c6e97d25b6299b5d6fe8920b"),$content:"".concat(Object(N.b)("624a58d84c009babde678e819bfdb03d")," ").concat(v.c.getGroupName(e),"?")};Dialog.confirm(void 0,function(){t.changeGroup({namespaceId:e},{sticky:n})},void 0,a)}};Object(f.b)(a)}}},{key:"handleChangeBook",value:function(e){var t=this.props,n=t.note,a=t.stickyNote,i=n.get("namespaceId");if(n.isOwnerOrGrpAdmin()){e.stopPropagation();var o={id:i,catId:n.get("cat"),parent:e.target.closest("li"),onSelect:function(e){n.changeBook(e)},onCreate:function(e){n.changeBook(e)}};a&&(o.spanClass="zmArmZI"),Object(f.a)(o)}}},{key:"render",value:function(){var e=this.props.note,t=v.c.getGroupName(e.get("namespaceId")),n=Object(y.h)(e.get("cat"),e.get("namespaceId")),a=""===t?"zmNoteGrp zmHideD":"zmNoteGrp",o=Boolean(_zm.isStreamsEnabled()),s=e.isOwnerOrGrpAdmin(),r=s?Object(N.b)("2cbc774c43fbab4c03068b27cd134627"):void 0;return i.a.createElement("div",{className:a},i.a.createElement("div",{className:"zmAMB"},i.a.createElement(p.b,null,o&&i.a.createElement(p.a,{small:!0,text:t,tooltip:s?Object(N.b)("68adc414d6126241892438f8ebc2589d"):"",onClickHandler:this.handleChangeGroup,noHover:!s}),o&&i.a.createElement(p.a,{small:!0,disabled:!0,noPadding:!0,iconClass:"msi-rarrow"}),i.a.createElement(p.a,{small:!0,text:n,tooltip:s?r:"",onClickHandler:this.handleChangeBook,noHover:!s}))))}}]),t}(i.a.Component),j=function(e){function t(e,n){var a;babelHelpers.classCallCheck(this,t),a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handlePaste",function(e){a.ispaste=!0,Object(h.b)(e.target),setTimeout(function(){a.ispaste=!1},200)});var i=a.props.note,o=!1;return i.get("desc")&&i.get("desc").length>=255&&!a.props.print&&(o=!0),a.ispaste=!1,a.state={height:0,readmore:o},a.setContentRef=function(e){a.contentElm=$.e(e)},a.setContentWrapperRef=function(e){a.contentWrapperElm=$.e(e)},a.debouncedViewNote=r()(function(){e.viewNote()},1e3,{leading:!0}),_zm.autoBind(babelHelpers.assertThisInitialized(a),["handleSaveSelection","handleSetDescription","handleSetHeight","handleOpenNote"]),a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentDidMount",value:function(){var e,t=this.contentElm,n=this.props,a=n.note;n.stickyNote&&(t.css({"max-height":"300px","overflow-y":"auto","overflow-x":"hidden"}),t.on("mousedown",function(e){e.stopPropagation()}),"new"===a.get("type")&&t.focus()),void 0===a.get("height")||null===a.get("height")||isNaN(parseInt(a.get("height")))?0!==t.height()&&(e=t.height()>200?200:t.height(),this.setState({height:e}),a.set({height:e},{silent:!0})):(this.setState({height:a.get("height")}),t.css("height","".concat(a.get("height"),"px")),t.css({"max-height":"500px"})),t.on("mousedown","a",I.a),t.on("click","a",function(e){e.preventDefault(),e.stopPropagation()})}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.note,n=e.stickyNote,a=this.contentElm;a.off("mousedown","a"),a.off("click","a"),n&&"new"!==t.get("type")&&t.isOwner()&&setTimeout(function(){t.clearInlineImages()},0)}},{key:"handleOpenNote",value:function(e){e.stopPropagation(),this.debouncedViewNote()}},{key:"UNSAFE_componentWillReceiveProps",value:function(){this.props.note.get("desc")&&this.props.note.get("desc").length>=255?this.setState({readmore:!0}):this.setState({readmore:!1})}},{key:"handleSetDescription",value:function(e){!1===this.ispaste&&this.descOnFocus!==this.contentElm[0].innerHTML&&this.props.note.saveDescription(this.contentElm[0].innerHTML)}},{key:"setImage",value:function(e){var t=this.selection;this.contentElm.trigger("focus",!0,!0);var n=Object.keys(e[0].inline[0])[0],a="".concat(C+e[0].inline[0][n].Id+"&entityType=2&entityId="+this.props.note.get("id"),"&actionType=viewGroupEntity&groupId=").concat(this.props.note.get("namespaceId"),"&streamsView=Notes&mode=view&attachType=inline");Object(h.e)(this.contentElm[0],t)||this.contentElm.trigger("focus"),h.d?Object(h.c)(Object(c.j)(e[0].inline[0][n].Id,a)):document.execCommand("insertHTML",!1,Object(c.j)(e[0].inline[0][n].Id,a).outerHTML)}},{key:"handleSetHeight",value:function(){this.selection=Object(h.f)(this.contentElm[0]),this.state.height!==this.contentElm.height()&&this.setState({height:this.contentElm.height()})}},{key:"handleSaveSelection",value:function(e,t,n){Object(m.hideMenu)(),this.descOnFocus=this.contentElm[0].innerHTML,n||(this.selection=Object(h.f)(this.contentElm[0]))}},{key:"restoreSelection",value:function(){Object(h.e)(this.contentElm[0],this.selection)}},{key:"fillSummary",value:function(){this.setState({readmore:!1})}},{key:"render",value:function(){var e,t=Object(N.b)("51440b11241f13dca2fa77fae56e8e68"),n=this.props,a=n.stickyNote,o=n.note,s=a;"new"===o.get("type")||o.isOwner()||(s=!1),e=o.get("desc")?o.get("desc").replace(/\n/g,Object(c.b)().outerHTML):"";var r=this.state.readmore&&!s?"zmNoteContent zmNoteTrunc":"zmNoteContent";return i.a.createElement("div",{className:"zmNoteContentWra",ref:this.setContentWrapperRef},i.a.createElement("div",{className:r,ref:this.setContentRef,"data-plhr":t,contentEditable:s,onPaste:s?this.handlePaste:null,onFocus:s?this.handleSaveSelection:null,onKeyUp:s?this.handleSetHeight:null,onBlur:s?this.handleSetDescription:null,dangerouslySetInnerHTML:{__html:e}}),this.state.readmore&&!s&&i.a.createElement("div",{className:"zmNoteMore",onClick:this.handleOpenNote},i.a.createElement("u",null,Object(N.b)("1b6f8933de135dc10cc93b9816be733a"))),a&&i.a.createElement("div",{className:"zmNoteResize",title:Object(N.b)("9d723d04c40bfd81835c0766a698cf63")},i.a.createElement("div",{className:"ui-resizable-handle zmNoteResizeHandle zmNoteResizeEW"}),i.a.createElement("div",{className:"ui-resizable-handle zmNoteResizeHandle zmNoteResizeNS"}),i.a.createElement("div",{className:"ui-resizable-handle zmNoteResizeHandle zmNoteResizeNWSE"},i.a.createElement("i",{className:"msi-resize"}))))}}]),t}(i.a.Component),A=function(e){function t(e,n){var a;return babelHelpers.classCallCheck(this,t),a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handlePaste",function(e){Object(h.b)(e.target)}),a.setTitleRef=function(e){a.titleElm=$.e(e)},_zm.autoBind(babelHelpers.assertThisInitialized(a),["handleFocus","handleSetTitle","handleKeyDown"]),a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"handleFocus",value:function(){Object(m.hideMenu)()}},{key:"componentDidMount",value:function(){this.props.stickyNote&&this.titleElm.on("mousedown",function(e){e.stopPropagation()})}},{key:"handleSetTitle",value:function(e){var t=this.props.stickyNote;e.target.textContent.trim().length||this.titleElm.text(""),this.props.note.saveTitle(e.target.textContent,{sticky:t})}},{key:"handleKeyDown",value:function(e){13===e.keyCode&&(e.preventDefault(),this.props.setContentFocus())}},{key:"render",value:function(){var e=Object(N.b)("363b819548608faed67e73d592c05976"),t=this.props,n=t.note,a=t.stickyNote;"new"===n.get("type")||n.isOwner()||(a=!1);var o=n.get("title");return o=o?Object(b.d)(o):"new"!==n.get("type")?h.a.defaultTitle:"",i.a.createElement("div",{className:"zmNoteTitle",contentEditable:a,ref:this.setTitleRef,"data-plhr":e,onFocus:this.handleFocus,onBlur:this.handleSetTitle,onKeyDown:this.handleKeyDown,onPaste:this.handlePaste},o)}}]),t}(i.a.Component)},TKYQ:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("/Qv1"),i=n("meS2"),o=a.c.Utils,s=function(e,t,n){return idb.open(e,t,n)},r=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onUpgradeNeeded",value:function(e){if(0===e.oldVersion){e.createObjectStore("notes",{keyPath:["namespaceId","id"]});var t=e.transaction.objectStore("notes");t.createIndex("groupId_timestamp",["namespaceId","modified"]),t.createIndex("favourites_timestamp",["starred","modified"]),t.createIndex("tagId","tagId",{multiEntry:!0}),t.createIndex("catId_timestamp",["cat","modified"])}}},{key:"getDatabaseName",value:function(){return"".concat(zmail.zuid,"_notes")}},{key:"getDBVersion",value:function(){return"1"}},{key:"updateNoteRecord",value:function(e,t){var n=this.getDatabaseName(),a=this.getDBVersion(),i=this.onUpgradeNeeded,o=this.serialize("updateNote",e,t),r=o.key,c=o.val,l=o.objStoreName;return new Promise(function(e,t){s(n,a,i).then(function(n){var a=n.transaction(l,"readwrite");a.objectStore(l).put(c,r),a.complete.then(function(){e(c),n.close()},function(){window.console.log("transaction failure"),t(),n.close()})})})}},{key:"fetchNoteDetails",value:function(e,t){var n=this,a=this.getDatabaseName(),i=this.getDBVersion(),o=this.onUpgradeNeeded,r=this.serialize("fetchNoteDetails",e,t),c=r.objStoreName,l=r.key;return new Promise(function(e,r){s(a,i,o).then(function(e){return e.transaction(c,"readonly").objectStore(c).get(l)}).then(function(a){var i=n.normalize("fetchNoteDetails",a,t);t.resp=i,e({opts:t})})})}},{key:"fetchNoteRecords",value:function(e,t){var n,a=this,i=this.getDatabaseName(),o=this.getDBVersion(),r=this.onUpgradeNeeded,c=this.serialize("fetchNotes",e,t),l=c.objStoreName,d=c.data,u=d.indexName,p=[];return new Promise(function(c,h){s(i,o,r).then(function(e){var t=e.transaction(l,"readonly").objectStore(l);if("tagId"===u)return(n=t.index(u)).openCursor(d.indexValue);n=t.index(u);var a=IDBKeyRange.bound([d.indexValue,0],[d.indexValue,(new Date).getTime()]);return n.openCursor(a,"prev")}).then(function e(t){if(t)return p.push(t.value),t.continue().then(e)}).then(function(){var n=a.normalize("fetchNotes",p,t);t.resp=[{page:{start:0},Notes:n}],c({resp:n,opts:t,model:e})})})}},{key:"getMethodMap",value:function(){return{fetchNotes:"fetchNoteRecords",fetchAll:"fetchNoteRecords",fetchNoteDetails:"fetchNoteDetails",updateNote:"updateNoteRecord"}}},{key:"getModelSnapShot",value:function(e,t){return e.toJSON()}},{key:"serialize",value:function(e,t,n){var a,i=null;if("updateNote"===e||"update"===e){var s=this.getModelSnapShot(t,n);return a=o.extendProperties(s,n.attrs),n.param&&"editNContent"===n.param.mode&&(a.desc=n.param.desc),!0===a.starred?a.starred=1:delete a.starred,a.modified&&(a.modified=parseFloat(a.modified)),{val:a,objStoreName:"notes"}}if("fetchAll"===e)return{objStoreName:"notes"};if("delete"===e)return{namespaceId:(a=this.getModelSnapShot(t)).namespaceId,id:a.id},{key:[a.namespaceId,a.id],objStoreName:"notes"};if("fetchNoteDetails"===e)return a=this.getModelSnapShot(t),{objStoreName:"notes",key:[n.param.groupId,n.param.entityId]};if("fetchNotes"===e){var r=n.param;return i={},"getCatNotes"===r.mode&&(i.indexName="catId_timestamp",i.indexValue=r.catId,i.param=r),"getAllNotes"===r.mode&&(i.indexName="groupId_timestamp",i.indexValue=r.groupId,i.param=r),"getTagNotes"===r.mode&&(i.indexName="tagId",i.indexValue=r.tagId,i.param=r),"getAllFavNotes"===r.mode&&(i.indexName="favourites_timestamp",i.indexValue=1,i.param=r),{objStoreName:"notes",data:i}}return i}},{key:"normalize",value:function(e,t,n){if("create"===e){return t.errorCode?{error:!0}:t.note.data}return"update"===e&&"success"!==t[0].response?{error:!0}:"fetchNotes"===e?t:"fetchNoteDetails"===e?Object(i.a)(t):{}}}]),t}(a.e)},UK2x:function(e,t,n){"use strict";n.d(t,"e",function(){return h}),n.d(t,"f",function(){return m}),n.d(t,"g",function(){return b}),n.d(t,"b",function(){return f}),n.d(t,"h",function(){return g}),n.d(t,"d",function(){return v}),n.d(t,"i",function(){return y}),n.d(t,"a",function(){return I}),n.d(t,"c",function(){return N}),n.d(t,"j",function(){return k});var a=n("c8D3"),i=n("83P7"),o=n("DoNX"),s=n("Kz78"),r=n("92Lq"),c=n("pucZ"),l=(n("V61T"),n("lrgh")),d=n("HzOS"),u=n("YV/N"),p="".concat(zmail.conPath,"/NotesAction.do"),h=function(e,t){return"color"===t?a.a.COLORNAME[e]:""},m=function(e){var t={entityIds:e.id,groupIds:e.groupId,mode:"getNotes"};return onerror=function(){},zmAjq.XHR({u:p,t:"POST",p:t,onerror:onerror}).then(function(e){return function(e){return e&&e[1]&&e[1].length&&e[1].forEach(function(e){e.cloud&&e.cloud.length&&(e.attachments=(e.attachments||[]).concat(e.cloud))}),e}(e)})},b=function(e,t){if(!$.e(e).hasClass("zm_snd")){var n="";$.e(e).addClass("zm_snd");var a=zmail.ContactBook.get({zuid:t.ownerZUID,promise:!1,type:"org"})[0];a&&a.attrs&&a.attrs.fn&&(n=t.ownerZUID===zmail.zuid?"".concat(a.attrs.fn," ").concat(Object(u.b)("32d4440188aab80d21418e5f65bc526d")):"".concat(a.attrs.fn," ").concat(Object(u.b)("c271af16695a7943c018d8f6ad4020f6")," ").concat(r.c.getGroupName(t.namespaceId))),zmAjq.XHR({u:"".concat(zmail.conPath,"/post.do"),p:{mode:"participants",entityType:"2",entityId:t.id,groupId:t.namespaceId,data:n},t:"POST"}).then(function(n){n=n[1];var a=[];$.isEmptyObject(n)||(a=n.participants),e=$.e(e).parents("b");var i={zuids:a,id:t.id,etype:"3",groupId:t.namespaceId,elm:e};zmAppLoader.load("chatlet").then(function(){zmail.Components.Chatlet.core.init(i)})})}},f=function(e,t,n){Object(r.f)().then(function(){var a=$.extend(!0,{},e);r.c.isGroupDisabled(e.namespaceId)&&(a.namespaceId=zmail.zuid,a.catId=Object(c.f)(a.namespaceId));var i,l=function(e){function t(e){this.attr=$.extend(!0,{},e),this.emitChange={},this.changed={}}return t.prototype.set=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)this.attr[t[n]]=e[t[n]],this.changed[t[n]]=this.attr[t[n]],this.emitChange[t[n]](this)},t.prototype.onChanged=function(e,t){this.emitChange[e]=t},t.prototype.get=function(e){return this.attr[e]},new t(e)}(a),p={true:"msi-check",false:"msi-uncheck"},h=$.e(Object(s.e)({checkBoxClass:p[l.get("comments")]}));l.onChanged("title",function(e){h.find("#zcpTitle").val(Object(d.d)(e.get("title")))}),l.onChanged("namespaceId",function(e){h.find("#zncpGroup").val(r.c.getGroupName(e.get("namespaceId")))}),l.onChanged("catId",function(e){h.find("#zncpBook").val(Object(c.h)(e.get("catId"),e.get("namespaceId")))}),l.onChanged("comments",function(e){h.find("#attIn").removeClass(p[!l.get("comments")]).addClass(p[l.get("comments")])}),l.set({title:l.get("title"),namespaceId:l.get("namespaceId"),catId:l.get("catId")}),h.find("#zcpTitle").on("blur",function(){l.set({title:this.value})}),h.find("#attIn").on("click",function(){l.set({comments:!l.get("comments")})}),h.find("#zncpGroup").on("click",function(){r.c.showGroupsList({parentDOM:$.e(h).find("#zncpGroup")[0],displayAs:"dropdown",onSelectHandler:function(e){var t=e.id;l.set({namespaceId:t}),l.set({catId:Object(c.f)(t)})},allowHidden:!0,allowDisabled:!1,ignoreGroupId:l.get("namespaceId")})}),h.find("#zncpBook").on("click",function(){var e=l.get("namespaceId"),t={id:e,catId:l.get("catId"),parent:$.e(h).find("#zncpBook")[0],onSelect:function(e){l.set({catId:e})}};r.c.isGroupOwner(e)&&(t.onCreate=function(e){t.onSelect(e)}),i=Object(o.a)(t)});var m={title:"copyNote"===n.type?Object(u.b)("b6dc54fec959471d9498275172a5f833"):Object(u.b)("93febe185b7ade3aa5c8ba1957e15328"),mask:"black",defaultCloseIcon:!0,contentWrapperClass:"SC_PU",maskWrapperClass:"SC_Pop",$content:h,buttons:[{name:Object(u.b)("e0aa021e21dddbd6d8cecec71e9cf564"),callback:function(n){t({catId:l.get("catId"),namespaceId:l.get("namespaceId"),title:l.get("title"),comments:l.get("comments"),prevCatId:e.catId,prevGroupId:e.namespaceId,entityId:e.entityId}).then(function(){n.remove()})}},{name:Object(u.b)("ea4788705e6873b424c65e91c2846b19"),isCancel:!0,callback:function(e){e.remove()}}],dialogDidMount:function(e){e.$els.$maskWrapper.on("mousedown",function(){i&&i.hide()})}};Dialog.new(m)})},g=function(e,t){return!(e.top<0||e.left<0||window.innerHeight<e.top+t.height||window.innerWidth<e.left+t.width)},v=function(){var e=zmAdHocSettings.getNotes(),t=[];return e.stickyNotes&&e.stickyNotes.length?t=e.stickyNotes.map(function(e){var t={entityId:e.entityId,groupId:e.groupId};return t.state=e.state,t.top=parseInt(e.top),t.left=parseInt(e.left),t.width=parseInt(e.width),t.height=parseInt(e.height),t}):t},y=function(e){var t=!1;e.comments&&(t=e.comments);var n={toNamespace:e.namespaceId,entityId:e.entityId,mode:"changeGroup",groupId:e.prevGroupId,title:e.title,catId:e.catId,deleteOriginal:!1,commentsNeeded:t,entityType:a.a.entityType,actionType:"addEntity"};return zmAjq.XHR({u:p,t:"POST",fn:function(e){var t=Object(l.a)(e[0].data);_zm.succErrMsg("s","".concat(Object(u.b)("510a85bed492898902402ce1b32f8a5f")," ").concat(r.c.getGroupName(n.toNamespace))),$.publish("/note/add",[t]),$.publish("note/updateCount",[{mode:"addNote",cat:t.cat,namespaceId:t.namespaceId}])},p:n})},I=function(e,t){if(e.prevGroupId===e.namespaceId)return _zm.succErrMsg("e",Object(u.b)("e070d6aeb894fe8ff9bb34123f5c4d04")),Promise.reject();var n=void 0===e.comments||e.comments,o={toNamespace:e.namespaceId,entityId:e.entityId,mode:"changeGroup",groupId:e.prevGroupId,streamsView:"Notes",actionType:"addEntity",entityType:a.a.entityType,deleteOriginal:!0,commentsNeeded:n};void 0!==e.title&&(o.title=e.title),e.catId&&(o.catId=e.catId);var s=$.extend(!0,{},o);s.cat=e.prevCatId;return zmAjq.XHR({u:p,t:"POST",fn:function(e){var n=Object(l.a)(e[0].data);_zm.succErrMsg("s","".concat(Object(u.b)("2580e56e9b6471f3b2ccb86aa8de1746")," ").concat(r.c.getGroupName(s.toNamespace))),$.publish("/note/delete",[o.entityId,o.groupId]),$.publish("note/deleteNote",[{pid:o.entityId,gid:o.groupId}]),$.publish("note/updateCount",{mode:"delNote",cat:s.cat,groupId:s.groupId}),$.publish("/note/add",[n]),$.publish("note/updateCount",[{mode:"addNote",cat:n.cat,namespaceId:n.namespaceId}]),t&&t.sticky&&Object(i.a)(n)},p:o})},N=function(e,t){var n={entityId:e.id,mode:"delNote",groupId:e.groupId,streamsView:"Notes",actionType:"delEntity",entityType:a.a.entityType},i={id:e.id,mode:"delNote"};zmAjq.XHR({u:p,t:"POST",fn:function(e,a){t&&t(a),$.publish("/note/delete",[n.entityId,n.groupId]),$.publish("note/deleteNote",[{pid:n.entityId,gid:n.groupId}]),$.publish("note/updateCount",n)},p:n,ep:i})},k=function(){return zmail.fromOtherService&&"wp"===!zmail.fromService||zmail.isAusCustomer}},"YC+u":function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"f",function(){return p}),n.d(t,"e",function(){return h}),n.d(t,"g",function(){return m}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return f});var a,i=n("t22n"),o=n("pucZ"),s=n("34oF"),r=[],c=0,l=function(){return!!(window.navigator.userAgent.indexOf("MSIE ")>0||Boolean(navigator.userAgent.match(/Trident.*rv:11\./)))},d={ntWid:300,ntBorPad:20,defaultTitle:"Untitled",nColClsArr:{noteBg1:"0",noteBg2:"1",noteBg3:"2",noteBg4:"3"},nColArr:["noteBg1","noteBg2","noteBg3","noteBg4"]},u=function(e){a=e;var t=window.getSelection(),n=[];if(t.rangeCount)for(var i=0,o=t.rangeCount;i<o;++i)n.push(t.getRangeAt(i));return n},p=function(e){if(window.getSelection().rangeCount){var t=window.getSelection().getRangeAt(0),n=t.cloneRange();n.selectNodeContents(e),n.setEnd(t.startContainer,t.startOffset);var a=n.toString().length;return{start:a,end:a+t.toString().length}}return{start:0,end:0}},h=function(e,t){if(t){var n=0,a=document.createRange();a.setStart(e,0),a.collapse(!0);for(var i,o=[e],s=!1,r=!1;!r&&(i=o.pop());)if(3===i.nodeType){var c=n+i.length;!s&&t.start>=n&&t.start<=c&&(a.setStart(i,t.start-n),s=!0),s&&t.end>=n&&t.end<=c&&(a.setEnd(i,t.end-n),r=!0),n=c}else for(var l=i.childNodes.length;l--;)o.push(i.childNodes[l]);var d=window.getSelection();return d.removeAllRanges(),d.addRange(a),!0}return!1},m=function(e,t){if(1===Object(s.m)()&&[o.c.appid,"zm_notes_search"].includes(zmTab.currentTab)&&$.e(t).is(":visible")){var n=t?$.e(t).children():Object(s.k)(),a=(t?$.e(t).width():n.width())-20,i=d.ntWid;if(0!==n.find(".zmNote.thumbNote").length&&!(e&&e.sno&&n.children().length<=e.sno)){e&&e.width&&(a=e.width-20);var r,l=[],u=n.children(),p=u.length,h=0,m=Math.floor(a/i);r=m=Math.max(m,1);var b=Math.floor((a-m*i)/m),f=i-d.ntBorPad+b;for(u.each(function(){$.e(this).css("width")!=="".concat(f,"px")&&$.e(this).css({width:"".concat(f,"px")})});r--;)l.push(0);if(e&&void 0!==e.sno&&void 0!==e.cno&&void 0!==e.top){var g=e.sno,v=e.cno,y=e.top,I=m;l[v]=parseInt(y),[].push(v);for(var N=1,k=1;k<=g;k++){var C=$.e(u[g-k]),O=C.attr("data-cno");if(0===l[O]){var w=C.css("top");w=w.replace("px",""),w=parseInt(w),l[O]=w+C.outerHeight()+parseInt(19),++N}if(N===I)break}h=parseInt(g)}setTimeout(function e(){var n=Math.min.apply(Math,l),a=l.indexOf(n),o=(t?$.e(t).children():Object(s.k)()).children()[h],r=$.e(o);if(l[a]===n){var d="".concat(a*(i+b),"px"),u="".concat(n,"px");r.attr({"data-cno":a,"data-sno":h}).css({top:u,transform:"translateX(".concat(d,")")}),l[a]=parseInt(r.outerHeight())+parseInt(n)+parseInt(19)}(h+=1)<p?setTimeout(e,0):(c=Math.max.apply(Math,l),$.e(t).children().eq(0).css("height",c))},0)}}},b=function(e){var t,n;if(window.getSelection&&(t=window.getSelection()).getRangeAt&&t.rangeCount){var a;(n=t.getRangeAt(0)).deleteContents(),a="string"==typeof e?zdom("div",{dangerouslySetInnerHTML:e}):zdom("div",null).appendChild(e);for(var i,o,s=document.createDocumentFragment();i=a.firstChild;)o=s.appendChild(i);n.insertNode(s),o&&((n=n.cloneRange()).setStartAfter(o),n.collapse(!0),t.removeAllRanges(),t.addRange(n))}},f=function(e,t,n){var o;r=u(e),document.body.appendChild(zdom("div",{id:"d1",contentEditable:!0,style:{left:"-500px",wordWrap:"break-word",maxHeight:"300px",maxWidth:"300px",overflow:"hidden",position:"relative"}})),$.q("#d1").focus(),setTimeout(function(){o=Object(i.c)($.q("#d1")),$.q("#d1").remove(),o=o.replace(/\n/g,zdom("br",null).outerHTML);var s=Object(i.f)(o);n&&(s=s.replace(/<br>/g," ").slice(0,n)),$.e(e).trigger("focus",!0),function(e){if(a&&r.length&&(a[0]===e[0]||a[0].isSameNode&&a[0].isSameNode(e[0]))){var t=window.getSelection();t.removeAllRanges();for(var n=0,i=r.length;n<i;++n)t.addRange(r[n]);return!0}}(e),l()?b(s):document.execCommand("insertHTML",!1,s),t&&m(function(e){var t=$.q("#".concat(e,".zmNote"));if(t.length){var n=parseInt(t.attr("data-sno"))+1,a=t.attr("data-cno");a=parseInt(a);var i=t.css("top");return i=i.replace("px",""),{sno:n,cno:a,top:i=t.outerHeight()+parseInt(i)+parseInt(19)}}}(t)),r=u(e),setTimeout(function(){!function(e){if(void 0!==window.getSelection&&void 0!==document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if(void 0!==document.body.createTextRange){var a=document.body.createTextRange();a.moveToElementText(e),a.collapse(!1),a.select()}}(e)},100)},100)}},eXgx:function(e,t,n){"use strict";n.d(t,"b",function(){return p}),n.d(t,"c",function(){return h}),n.d(t,"a",function(){return m});var a=n("q1tI"),i=n.n(a),o=n("YV/N"),s=n("DoNX"),r=n("vr4s"),c=n("uwyq"),l=n("c8D3"),d=".zmNoteActionIcons",u="zm/closeAllOpenDialog",p=function(e){function t(e,n){var a;return babelHelpers.classCallCheck(this,t),a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"beforeAttach",function(e){a.props.note.addNote({}).then(function(){a.attRefObj.updateConfig({}),e()})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleAddAttachment",function(e){if(!_zm.isTeamDriveEnabled()){e.stopPropagation();var t=a.attRefObj.configJSON;a.props.note.get("id")?t.beforeAttach=!1:t.beforeAttach=a.beforeAttach,a.attRefObj.updateConfig(t),a.attRefObj.init()}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleMoreAction",function(e){e.stopPropagation()}),a.setIconRef=function(e){a.attachElm=$.e(e)},a.attObj={tempLocation:[],myAttachment:[]},a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"saveVirusPendingAttachments",value:function(e){var t=e.tempLocation;if(t.length)for(var n=t.slice(),a=0;a<n.length;a++)!0!==n[a].virusFree&&this.attObj.tempLocation.push(n[a])}},{key:"handleUpdateVirus",value:function(e){for(var t=e.fp,n=e.value,a=this.attObj.tempLocation.length,i={tempLocation:[],myAttachment:[],cloudAttList:[]},o=0;o<a;o++)if(this.attObj.tempLocation[o].fP===t){this.attObj.tempLocation[o].virusFree=n,i.tempLocation.push(this.attObj.tempLocation[o]),this.attObj.tempLocation.splice(o,1);break}this.props.note.saveAttachment(i)}},{key:"setAttachmentConfig",value:function(){var e=this,t=this.props,n=t.note,a=t.stickyNote,i=t.boxView;if(n.isOwner()){var o={container:a?this.attachElm.closest(".jsNote")[0]:void 0,parent:this.attachElm.closest(".jsNote").find(".zmNoteAtt"),updateVirus:function(t){e.handleUpdateVirus(t)},$dropCenter:this.attachElm.closest(".jsNote"),$actionEle:this.attachElm,onInit:function(t){e.attRefObj=t},onOpenClose:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i){var n=e.attachElm.closest(d);"select"===t.type?n.addClass("active"):n.removeClass("active")}},onAllUploadFinish:{handler:function(t){Object(r.isNettyUploadEnabled)()&&e.saveVirusPendingAttachments(t),n.saveAttachment(t)},resetData:!0,removeAttachDOM:!0}};n.get("id")?o.beforeAttach=!1:o.beforeAttach=this.beforeAttach,Object(s.f)(o)}}},{key:"componentDidMount",value:function(){this.setAttachmentConfig()}},{key:"render",value:function(){var e=this.props,t=e.note,n=e.boxView;return t.isOwner()?i.a.createElement(c.a,{small:Boolean(n),iconClass:"msi-attachment",tooltip:Object(o.b)("8d677e3fbff2d712edac6104c1187400"),onClickHandler:_zm.isTeamDriveEnabled()?null:this.handleAddAttachment,moreAction:_zm.isTeamDriveEnabled(),moreActionClickHandler:this.handleMoreAction,setIconRef:this.setIconRef}):null}}]),t}(i.a.Component),h=function(e){function t(){var e,n;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"setPaletteRef",function(e){n.paletteElm=$.e(e)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleSetColor",function(e){if(e.stopPropagation(),n.colorPaletteObj&&n.colorPaletteObj.menuObj)return Object(r.hideMenu)();var t=n.props,a=t.note,i=t.stickyNote,o=t.boxView,c=o?"active":"sel",u=o?$.e(e.target).closest(d):$.e(n.paletteElm.closest(".jsNote"));n.colorPaletteObj=Object(s.d)({color:l.a.COLORCODE[a.get("color")],par:$.e(e.target).closest("li"),stickyNote:i,onClick:function(e){u.removeClass(c),a.saveColor(l.a.COLOR[e])},onHide:function(){u.removeClass(c),n.colorPaletteObj=void 0}}),u.addClass(c)}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props,t=e.note,n=e.boxView;return t.isOwnerOrGrpAdmin()?i.a.createElement(c.a,{small:Boolean(n),iconClass:"msi-nclr",tooltip:Object(o.b)("dfdf0ea751f54f1ae7031674690e618d"),onClickHandler:this.handleSetColor,setIconRef:this.setPaletteRef}):null}}]),t}(i.a.Component),m=function(e){function t(){var e,n;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleViewAssociatedMail",function(e){e.stopPropagation(),$.publish(u);var t={},a=n.props.note,i=a.get("email");i.accid!==zmail.accId&&(t={actionType:"viewGroupMailEntity",entityId:i.msgid,entityType:"1",streamsView:"true",groupId:a.get("ownerZUID"),accId:i.accid}),zmList.getMailData({msgId:i.msgid,opentype:2,type:"lt",src:"external",eprm:t})}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props,t=e.note,n=e.boxView,a=void 0!==n&&n,s=t.get("email");return!s||$.isEmptyObject(s)?null:i.a.createElement(c.a,{small:a,iconClass:"msi-mailopen",onClickHandler:this.handleViewAssociatedMail,tooltip:Object(o.b)("297ca353fb245b04993e02cab8a98dfb")})}}]),t}(i.a.Component)},lnd7:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a="".concat(zmail.conPath,"/NotesAction.do"),i=function(e,t){zmAjq.XHR({u:a,fn:function(){},t:"POST",p:{entityId:e,groupId:t,mode:"clearInline"}})}},meS2:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=function(e){var t={notes:{},gnrl:{group:{}},cntnt:{},cmnt:{},myact:{},attach:[]},n=t.notes;n.id=t.id=e.id,n.title=t.cntnt.title=e.title,n.notecont=e.desc,t.gnrl.group.id=e.namespaceId,n.starred=e.starred,n.color=e.color,n.disptime=e.disptime,n.desc=t.cntnt.summary=e.summary,n.isRichText=e.isRichText,t.gnrl.by=e.ownerZUID,n.email=$.extend(!0,{},e.email),t.cmnt.total=e.commentCount,t.myact.label=e.tagId.slice(0),t.gnrl.cdate=e.disptime,t.myact.starred=e.starred,t.gnrl.lastModifiedTime=e.modified,t.attach=[],e.attachments=e.attachments||[];for(var a=0;a<e.attachments.length;a++){var i=e.attachments[a],o={};i.inline||(o[i.Id]={Id:i.Id,s:i.s,fn:i.fn,ft:i.ft,p:i.p},t.attach.push(o))}return t}},n1Te:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("q1tI"),i=n.n(a),o=n("k4Da"),s=n.n(o),r=n("vr4s"),c=n("92Lq"),l=n("YV/N"),d=function(e){function t(){var e,n;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleImageClick",function(e){e.stopPropagation();var t=n.props,a=t.note,i=t.atObj,o=t.index,s=i.attType,d=i.cloudLink,u=[],p=a.get("attachments");if(5===s&&d){window.open(d,"_blank").opener=null}else{for(var h=0,m=p.length;h<m;h++)for(var b in p[h]){var f=$.extend(!0,{},p[h][b]);f.gId=a.get("namespaceId"),f.gId!==zmail.zuid&&(f.type="viewGroupData"),5===f.attType||f.inline||u.push(f)}var g={};Object(c.d)(a.get("namespaceId"),a.get("ownerZUID"))&&(g.trash={class:"msi-trash",title:Object(l.b)("16f5bdd43dd27f706574c80433540a46"),after:".msi-download",events:[{name:"click",listener:function(e,t,n){var i=t.e,o=t.Id;a.delAtt(i,o,n)}}]});var v={extraIcons:g,hideOptions:["#etyIcon"]};Object(r.initAttSlideShow)(u,o,!1,v)}}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getThumbNail",value:function(){var e,t,n,a=this.props,o=a.atObj,s=a.note;if("msi-attimg"===(e=5===o.attType?Object(r.fileTyp)(o.name,zmAttachUtility.fileType.hugeAttachment):Object(r.fileTyp)(o.name))[1]&&5!==o.attType)Object(r.isNettyThumbNailEnabled)()?t=zmDownload.viewDocument({returnUrl:!0,mode:"thb"},{Id:o.id,et:2,e:s.get("id"),gId:s.get("namespaceId")}):(t="".concat(zmail.conPath,"/FileDownload?attachId=").concat(o.id,"&entityType=2&")+"entityId=".concat(s.get("id"),"&groupId=").concat(s.get("namespaceId"))+"&mode=thb",s.get("id")!==zmail.zuid&&(t+="&streamsView=Notes&actionType=viewGroupEntity")),n=i.a.createElement("img",{src:t});else{var c="".concat(e[1]," zmAttTypeBG");n=i.a.createElement("i",{className:c})}return n}},{key:"render",value:function(){var e=this.props.atObj;return i.a.createElement("div",{className:"zmNoteAttItem",title:e.name||e.fn,key:e.Id,onClick:this.handleImageClick},this.getThumbNail())}}]),t}(i.a.Component),u=function(e){function t(e){var n;return babelHelpers.classCallCheck(this,t),(n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e))).setAttachWrapperRef=function(e){n.attachWrapperElm=$.e(e)},n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentDidMount",value:function(){zmAppLoader.load("download")}},{key:"componentDidUpdate",value:function(){var e=this.props.options;e&&e.componentUpdated&&e.componentUpdated({type:"attachment"})}},{key:"render",value:function(){var e=this.props.note,t=e.get("attachments")&&s()(e.get("attachments"),function(e){return!e.inline});return t&&t.length?i.a.createElement("div",{className:"zmNoteAtt",ref:this.setAttachWrapperElm},i.a.createElement("span",{className:"zmNoteAttPin"},i.a.createElement("i",{className:"msi-attachpin"})),i.a.createElement("div",{className:"zmNoteAttItemWra"},t.map(function(t,n){var a=t[Object.keys(t)[0]];return i.a.createElement(d,{atObj:a,index:n,key:t.id,note:e})}))):i.a.createElement("div",{ref:this.setAttachWrapperElm,className:"zmNoteAtt zmHideD"})}}]),t}(i.a.Component)},nLCp:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("Kz78"),i=n("vr4s"),o=function(e){e.preventDefault(),e.stopPropagation(),$.q("#ngoto").remove();var t=e.target.getBoundingClientRect(),n=t.left,o=t.bottom,s={left:"".concat(n,"px"),top:"".concat(o,"px"),right:"auto",zIndex:"1001"},r=$.e(Object(a.m)({style:s,handleOnClick:function(){Object(i.openLink)(e.target.href)}}));$.q("body").appendDOM(r),$.q("#ngoto").on("mousedown",function(e){e.stopPropagation()}),$.q("#ngoto").on("click",function(){$.q("#ngoto").remove()}),$.q("#nlink").on("click",function(e){e.stopPropagation(),$.q("#ngoto").remove()})}},s5DJ:function(e,t,n){"use strict";n.d(t,"a",function(){return O});var a=n("sEfC"),i=n.n(a),o=n("Kz78"),s=n("/Qv1"),r=n("8lxu"),c=n("HzOS"),l=n("92Lq"),d=n("pucZ"),u=n("YC+u"),p=n("t22n"),h=n("lrgh"),m=n("lnd7"),b=n("YV/N"),f=n("Q/Su"),g=n("p2EH"),v="streams/changeArchive",y="label/deleted",I="/streams/comment",N="attachment/addLabel",k="attachment/removeLabel",C="change:renamenotecat",O=function(e){function t(){var e,n;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(o))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"customEvent",function(e){if(e.id===n.get("id"))if("title"===e.cattribute)n.set({title:Object(c.c)(e.p.title),updatedTime:e.p.updatedTime});else if("category"===e.cattribute)n.set("cat",e.p.catId);else if("color"===e.cattribute)n.set({color:e.p.color,updatedTime:e.p.updatedTime});else if("desc"===e.cattribute)n.set({notecont:e.p.desc,desc:e.p.desc,summary:Object(p.e)(e.p.desc),updatedTime:e.p.updatedTime});else if("archive"===e.cattribute)n.set("archived",e.p.archived);else if("starred"===e.cattribute)n.set("starred",e.p.starred);else if("addLabel"===e.cattribute||"removeLabel"===e.cattribute)n.set("tagId",e.p);else if("commentCount"===e.cattribute)n.set("commentCount",e.p.commentCount);else if("removeAttachment"===e.cattribute){var t=(n.get("notes").attachments||[]).slice();$.each(t,function(n,a){if(a[e.p.attachId])return t.splice(n,1),!1}),n.set("attachments",t),n.trigger("change"),n._collection.trigger("alignNoteBox")}else if("addAttachment"===e.cattribute){var a=n.get("attachments")?n.get("attachments").slice():[],i=[];e.cloudAttList&&e.cloudAttList.length&&(i=e.cloudAttList.map(function(e){return e.attType=5,e.shT=e.shType,e.fn=e.fName,e.name=e.fName,{cloudAtt:e}}));var o=a.concat(e.p.attachments||[],i);n.set("attachments",o),n.trigger("change"),n._collection.trigger("alignNoteBox")}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleBookRename",function(e,t){n.get("cat")===t.catId&&n.trigger(C)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleTagRename",function(e,t){n.get("tagId").includes(t.labId)&&n.trigger(C)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleTagDelete",function(e,t){n.get("tagId").includes(t.labelID)&&(e.type===y&&n.removeTagDone(t.labelID),n.trigger(C))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleEditedStickyNote",function(e,t){t.id===n.get("id")&&n.set(t)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"triggerUpdateModel",function(e,t){var a,i={};if(t.id&&t.id.includes("#"))i.id=t.id.slice(t.id.indexOf("#")+1,t.id.length),i.id===n.get("id")&&(void 0!==t.starred?(i.starred=t.starred,r.a.trigger("editNote",{id:i.id,cattribute:"starred",p:i})):!0===t.isAddLabel?(a=t.label,r.a.trigger("editNote",{id:i.id,cattribute:"addLabel",p:a})):!1===t.isAddLabel&&(a=t.label,r.a.trigger("editNote",{id:i.id,cattribute:"removeLabel",p:a})));else if(t.entityId===n.get("id"))if(e.type===v){var o={archived:t.archived};n.customEvent({id:t.entityId,cattribute:"archive",p:o})}else e.type===I&&r.a.trigger("editNote",{id:t.entityId,cattribute:"commentCount",p:{commentCount:t.total}})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"updateAttachmentData",function(e,t){n.get("id")===t.attObj.e&&(e.type===k?delete n.get("attachments")[0][t.attObj.Id]:(e.type,n.get("attachments")[0][t.attObj.Id]=t.attObj))}),n.debounceAddNote=i()(n.addNote,1e3),n.view=0,n.subscribe(),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"addAttachment",value:function(e){r.a.trigger("editNote",{id:this.get("id"),cattribute:"addAttachment",p:e[0]})}},{key:"subscribe",value:function(){r.a.on("editNote",this.customEvent,this),$.subscribe("zmstreamsapp/addLabel",this.triggerUpdateModel),$.subscribe(v,this.triggerUpdateModel),$.subscribe("/rename/notescat",this.handleBookRename),$.subscribe("label/renamed",this.handleTagRename),$.subscribe(y,this.handleTagDelete),$.subscribe(I,this.triggerUpdateModel),$.subscribe(N,this.updateAttachmentData),$.subscribe(k,this.updateAttachmentData),$.subscribe("attachment/changeFavourite",this.updateAttachmentData),void 0!==this.get("showStickyNote")&&$.subscribe("stickyNotes/EditNotified",this.handleEditedStickyNote)}},{key:"stopSubscriptions",value:function(){this.view-=1,this.view<=0&&(r.a.off("editNote",this.customEvent,this),$.unsubscribe(v,this.triggerUpdateModel)),r.a.off("editNote",this.updateModel,this),this.off(null,null,null),$.unsubscribe("zmstreamsapp/addLabel",this.triggerUpdateModel),$.unsubscribe(I,this.triggerUpdateModel),$.unsubscribe("/rename/notescat",this.handleBookRename),$.unsubscribe("label/renamed",this.handleTagRename),$.unsubscribe(y,this.handleTagDelete),$.unsubscribe(N,this.updateAttachmentData),$.unsubscribe(k,this.updateAttachmentData),$.unsubscribe("attachment/changeFavourite",this.updateAttachmentData),$.unsubscribe(v,this.triggerUpdateModel),$.unsubscribe("stickyNotes/EditNotified",this.handleEditedStickyNoteSubscription)}},{key:"updateViewCount",value:function(){this.view+=1}},{key:"getViewCount",value:function(){return this.view}},{key:"isOwner",value:function(){return!l.c.isGroupDisabled(this.get("namespaceId"))&&this.get("ownerZUID")===zmail.zuid}},{key:"isGrpAdmin",value:function(){return l.c.isGroupOwner(this.get("namespaceId"))}},{key:"isOwnerOrGrpAdmin",value:function(){var e=this.get("namespaceId");return!l.c.isGroupDisabled(e)&&(this.get("ownerZUID")===zmail.zuid||l.c.isGroupOwner(e))}},{key:"addNote",value:function(e){var t=this,n={richTextSummary:e.desc||this.get("newdesc")||this.get("desc"),mode:"addNote",groupId:this.get("namespaceId"),catId:this.get("cat")||Object(d.f)(this.get("namespaceId")),title:e.title||this.get("title"),color:e.color||this.get("color")};return this.triggerAction("add",{param:n}).then(function(e){var n=t.toJSON();t.set({type:"",oldId:n.id});var a=e.opts.resp,i=Object(h.a)(a[0].data);t.set(i),t.set("showstream",!0),$.publish("/note/add",[i]),$.publish("/note/addNote",[a[0].data]),i.mode="addNote",$.publish("note/updateCount",[i])})}},{key:"saveTitle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e!==this.get("title"))if("new"!==this.get("type")&&this.get("id")){e.trim().length||(e=u.a.defaultTitle);var t={title:e,entityId:this.get("id"),mode:"editNTitle",groupId:this.get("namespaceId")};this.save({title:e},{param:{mode:"editNTitle",actionType:"changeEntity"}}).then(function(e){var n=e.opts.resp;t.updatedTime=n[0].updatedTime,r.a.trigger("editNote",{id:t.entityId,cattribute:"title",p:t})})}else{if(!e.trim().length)return;this.debounceAddNote({title:e})}}},{key:"saveAttachment",value:function(e){var t,n=this,a=[],i=[],o={mode:"addAttach",entityId:this.get("id"),groupId:this.get("namespaceId"),attType:"attach"};if(e.tempLocation){for(var s=Object(g.v)(),c=0;c<e.tempLocation.length;c++)s&&!0!==e.tempLocation[c].virusFree||(a.push(e.tempLocation[c].fP),i.push(e.tempLocation[c].sN));o.attachname=a,o.attachstore=i}e.myAttachment&&(t=JSON.stringify(e.myAttachment),o.attEntObj=t),e.cloudAttList&&(o.cloudAttList=JSON.stringify(e.cloudAttList)),(o.attachname.length||e.myAttachment.length||e.cloudAttList.length)&&this.save({attEntObj:e.myAttachment,attachname:a,attachstore:i,cloudAttList:o.cloudAttList},{param:{mode:"addAttach",actionType:"addEntity"}}).then(function(t){var a=t.opts.resp;r.a.trigger("editNote",{id:o.entityId,cattribute:"addAttachment",p:a[0],cloudAttList:e.cloudAttList}),$.publish("note/editNote",[{mode:"addAttachment",gid:n.get("namespaceId"),p:a[0],resp:a[0],pid:o.entityId,cloudAttList:e.cloudAttList}])})}},{key:"changeBook",value:function(e){if("new"!==this.get("type")){var t=this.get("cat"),n={catId:e,entityId:this.get("id"),mode:"moveNote",groupId:this.get("namespaceId")},a=$.extend(!0,{},n);a.pCatId=t,this.save({catId:e},{param:{mode:"moveNote",actionType:"changeEntity"}}).then(function(){r.a.trigger("editNote",{id:n.entityId,cattribute:"category",p:n}),$.publish("note/updateCount",a)})}else this.set("cat",e)}},{key:"postAsNew",value:function(e){var t=!1;e.comments&&(t=!0);var n={toNamespace:e.namespaceId,mode:"changeGroup",actionType:"addEntity",title:e.title,catId:e.catId,commentsNeeded:t,deleteOriginal:!1},a=n;return this.triggerAction("changeGroup",{param:n}).then(function(e){var t=e.opts.resp,n=Object(h.a)(t[0].data);_zm.succErrMsg("s","".concat(Object(b.b)("510a85bed492898902402ce1b32f8a5f")," ").concat(l.c.getGroupName(a.toNamespace))),$.publish("/note/add",[n]),$.publish("note/updateCount",[{mode:"addNote",cat:n.cat,namespaceId:n.namespaceId}])})}},{key:"changeGroup",value:function(e,t){var n=this;if("new"!==this.get("type")){if(this.get("namespaceId")===e.namespaceId)return _zm.succErrMsg("e",Object(b.b)("e070d6aeb894fe8ff9bb34123f5c4d04")),Promise.reject();var a=void 0===e.comments||e.comments,i={toNamespace:e.namespaceId,entityId:this.get("id"),mode:"changeGroup",actionType:"addEntity",deleteOriginal:!0,commentsNeeded:a};void 0!==e.title&&(i.title=e.title),e.catId&&(i.catId=e.catId);var o=$.extend(!0,{},i);return o.cat=this.get("cat"),o.groupId=this.get("namespaceId"),this.triggerAction("changeGroup",{param:i}).then(function(e){var a=e.opts.resp,i=Object(h.a)(a[0].data);_zm.succErrMsg("s","".concat(Object(b.b)("2580e56e9b6471f3b2ccb86aa8de1746")," ").concat(l.c.getGroupName(o.toNamespace))),!1===n.get("showstream")&&n.set("showstream",!0),$.publish("/note/delete",[o.entityId,o.groupId]),$.publish("/note/groupChange",[a[0].data]),$.publish("note/deleteNote",[{pid:o.entityId,gid:o.groupId}]),$.publish("note/updateCount",{mode:"delNote",cat:o.cat,groupId:o.groupId}),$.publish("/note/add",[i]),$.publish("note/updateCount",[{mode:"addNote",cat:i.cat,namespaceId:i.namespaceId}]),t&&t.sticky&&r.a.trigger("addAsStickyNote",i),n.set(i)})}this.set({namespaceId:e.namespaceId,cat:Object(d.f)(e.namespaceId)})}},{key:"archiveOrUnarchiveNote",value:function(e){var t=this,n=this.get("cat"),a=e.archived?"archive":"unarchive",i={mode:a,entityId:this.get("id"),groupId:this.get("namespaceId")},o=$.extend(!0,{},i);o.pCatId=n,o.archived="archive"===a,this.save({archived:o.archived},{param:{mode:a}}).then(function(){var e="archive"===a?Object(b.b)("65375be43a3bfa40e64e57f9e6b82f47"):Object(b.b)("0fd56583b51e60fb5a09061dd73bc21e");_zm.succErrMsg("s",e),r.a.trigger("editNote",{id:i.entityId,cattribute:"archive",p:o}),$.publish("note/editNote",[{mode:"changeArchive",pid:t.get("id"),gid:t.get("namespaceId"),archived:o.archived}])})}},{key:"clearInlineImages",value:function(){var e=this;this._collection&&(this.savePromise?this.savePromise.then(function(){Object(m.a)(e.get("id"),e.get("namespaceId"))}):Object(m.a)(this.get("id"),this.get("namespaceId")))}},{key:"saveDescription",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(e!==this.get("desc")&&(0!==e.trim().length||e.trim()!==this.get("desc")))if("new"!==this.get("type")){if(0===Object(p.b)(Object(p.d)(e)).trim().length)return _zm.succErrMsg("e",Object(b.b)("279887fe0ca5f0e52931f00bb912ba14")),void(this.savePromise=Promise.resolve());var n={desc:e,entityId:this.get("id"),mode:"editNContent",groupId:this.get("namespaceId")};this.savePromise=this.save({},{setSessionId:!0,param:{mode:"editNContent",desc:e,actionType:"changeEntity",isRichText:"true"}}).then(function(e){var a=e.opts.resp;n.updatedTime=a[0].updatedTime,t(!0),r.a.trigger("editNote",{id:n.entityId,cattribute:"desc",p:n}),t(!0)})}else this.debounceAddNote({desc:e})}},{key:"delAtt",value:function(e,t){$.publish("attachment/closeSlideshow");var n={mode:"delAttach",entityId:this.get("id"),groupId:this.get("namespaceId"),attachId:t};this.save({attachId:t},{param:{mode:"delAttach",actionType:"delEntity"}}).then(function(e){r.a.trigger("editNote",{id:n.entityId,cattribute:"removeAttachment",p:n})})}},{key:"hideStream",value:function(){this.set("showstream",!1)}},{key:"addTag",value:function(e){var t=this,n={tagId:e,entityId:this.get("id"),mode:"setTag",groupId:this.get("namespaceId")};this.triggerAction("updateTag",{param:{tagId:e,mode:"setTag",actionType:"addLabel"}}).then(function(a){var i=t.get("tagId").slice();i.push(e),r.a.trigger("editNote",{id:n.entityId,cattribute:"addLabel",p:i}),$.publish("note/editNote",[{mode:"addLabel",gid:t.get("namespaceId"),pid:n.entityId,labelId:e}]),zmail.isOfflineEnabled&&t.triggerAction("updateNote",{attrs:t.toJSON(),adapterId:"indexDB"})})}},{key:"saveColor",value:function(e){if("new"!==this.get("type")){var t={color:e,entityId:this.get("id"),mode:"editNColor",groupId:this.get("namespaceId")};this.save({color:e},{param:{mode:"editNColor",actionType:"changeEntity"}}).then(function(e){var n=e.opts.resp;t.updatedTime=n[0].updatedTime,r.a.trigger("editNote",{id:t.entityId,cattribute:"color",p:t})})}else this.set("color",e)}},{key:"saveFavourite",value:function(){var e=this,t=!this.get("starred"),n=t?"addLabel":"deleteLabel",a={starred:t,entityId:this.get("id"),mode:"editNFav",groupId:this.get("namespaceId")};this.save({starred:t},{param:{mode:"editNFav",actionType:n}}).then(function(){r.a.trigger("editNote",{id:a.entityId,cattribute:"starred",p:a}),$.publish("note/editNote",[{mode:"changeFavourite",pid:a.entityId,gid:e.get("namespaceId"),starred:t}])})}},{key:"showNote",value:function(e,t){this.set("showStickyNote",e),t&&t.silent||$.publish("stickyNoteMod")}},{key:"openStickyNote",value:function(e){e.id===this.get("id")&&(!0===this.get("showStickyNote")?this.trigger("change:addedagain"):this.showNote(!0))}},{key:"removeTag",value:function(e){var t=this;this.triggerAction("updateTag",{param:{tagId:e,mode:"removeTag",actionType:"addLabel"}}).then(function(n){t.removeTagDone(e)})}},{key:"removeTagDone",value:function(e){var t=this.get("tagId").slice();t.splice(this.get("tagId").indexOf(e),1),r.a.trigger("editNote",{id:this.get("id"),cattribute:"removeLabel",p:t}),$.publish("note/editNote",[{mode:"removeLabel",pid:this.get("id"),gid:this.get("namespaceId"),labelId:e}]),zmail.isOfflineEnabled&&this.triggerAction("updateNote",{attrs:this.toJSON(),adapterId:"indexDB"})}},{key:"deleteNote",value:function(){var e=this,t={entityId:this.get("id"),mode:"delNote",groupId:this.get("namespaceId")},n=$.extend(!0,{},t);n.cat=this.get("cat"),this.destroy().then(function(){$.publish("/note/delete",[e.get("id"),e.get("namespaceId")]),$.publish("note/deleteNote",[{pid:e.get("id"),gid:e.get("namespaceId")}]),$.publish("note/updateCount",n)})}},{key:"sendAsMail",value:function(){var e=[],t={SUBJECT:this.get("title"),CONTENT:(this.get("newdesc")||this.get("desc")||"").replace(/\n/g,Object(o.b)().outerHTML)},n=this.get("attachments");if(n&&n.length){for(var a=n.length,i=0;i<a;i++){var s=n[i];for(var r in s){var c={gId:this.get("namespaceId"),Id:s[r].Id,e:this.get("id"),et:2,fn:s[r].fn,fs:s[r].fs,p:s[r].p,ft:s[r].ft};e.push(c)}}t.NEWATT=e}Object(f.i)(t,{entityType:"note"})}},{key:"closeNote",value:function(){$.publish("/note/closeStickyNote",[this.get("id"),this.get("namespaceId")])}}]),t}(s.b)},ubdq:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("/Qv1"),i=n("c8D3"),o=n("3dfV"),s=n("TKYQ"),r=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getUrl",value:function(){return"".concat(zmail.conPath,"/NotesAction.do")}},{key:"getAttributesFromModel",value:function(e){return{id:e.get("id"),namespaceId:e.get("namespaceId")}}},{key:"getDefaultRequestMethods",value:function(){return{create:"POST",update:"POST",patch:"POST",delete:"POST",read:"GET"}}},{key:"serialize",value:function(e,t,n){var a,s=this.getAttributesFromModel(t);if("delete"===e)a={entityId:s.id,mode:"delNote",groupId:s.namespaceId,streamsView:"Notes",actionType:"delEntity",entityType:i.a.entityType};else if("update"===e){var r=n.attrs,c=n.param;a={mode:c.mode,entityId:s.id,groupId:s.namespaceId},r.color&&(a.color=r.color,a.streamsView="Notes",a.actionType=c.actionType,a.entityType="2"),r.title&&(a.title=r.title,a.streamsView="Notes",a.actionType=c.actionType,a.entityType="2"),void 0!==r.starred&&(a.starred=r.starred,a.streamsView="Notes",a.actionType=c.actionType,a.entityType="2"),r.catId&&(a.catId=r.catId,a.streamsView="Notes",a.actionType=c.actionType,a.entityType="2"),c&&c.desc&&(a.desc=c.desc,a.streamsView="Notes",a.actionType=c.actionType,a.entityType="2",o.a.push(c.desc,a)),(r.attEntObj||r.attachname&&r.attachname.length)&&(r.attEntObj&&r.attEntObj.length>0&&(a.attEntObj=JSON.stringify(r.attEntObj)),r.attachname.length&&(a.attachname=r.attachname,a.attachstore=r.attachstore),a.streamsView="Notes",a.actionType=c.actionType,a.entityType="2"),r.cloudAttList&&(a.cloudAttList=r.cloudAttList),r.attachId&&(a.attachId=r.attachId,a.streamsView="Notes",a.actionType=c.actionType,a.entityType="2")}else if("fetchNotes"===e||"fetchNoteDetails"===e){a=n.param}else if("updateTag"===e){var l=n.param;a={mode:l.mode,tagId:l.tagId,entityId:s.id,groupId:s.namespaceId,streamsView:"Notes",actionType:l.actionType,entityType:"2"}}else if("changeGroup"===e){var d=n.param;a={mode:d.mode,toNamespace:d.toNamespace,entityId:s.id,groupId:s.namespaceId,streamsView:"Notes",actionType:d.actionType,entityType:"2"},d.catId&&(a.catId=d.catId),void 0!==d.title&&(a.title=d.title),d.deleteOriginal&&(a.deleteOriginal=d.deleteOriginal),d.commentsNeeded&&(a.commentsNeeded=d.commentsNeeded)}else if("bulkdelete"===e)a=n.param;else if("add"===e){var u=n.param;a={mode:u.mode,groupId:u.groupId,entityType:i.a.entityType,streamsView:"Notes",actionType:"addEntity",catId:u.catId,title:u.title,color:u.color},u.desc&&(a.desc=u.desc),u.richTextSummary&&(a.richTextSummary=u.richTextSummary),u.senderid&&(a.senderid=u.senderid),u.accid&&(a.accid=u.accid),u.actionSrc&&(a.actionSrc=u.actionSrc),u.msgid&&(a.msgid=u.msgid),u.attachname&&u.attachname.length&&u.attachname&&u.attachname.length&&(a.attachname=u.attachname,a.attachstore=u.attachstore),u.attEntObj&&u.attEntObj.length>0&&(a.attEntObj=u.attEntObj),u.cloudAttList&&(a.cloudAttList=JSON.stringify(u.cloudAttList)),u.hasOwnProperty("lockinvites")&&(a.lockinvites=u.lockinvites)}return a}},{key:"normalize",value:function(e,t,n){if("create"===e){return t.errorCode?{error:!0}:t.note.data}return"update"===e&&"success"!==t[0].response?{error:!0}:{}}}]),t}(a.d),c=function(){return{adapters:[{id:"http-adapter",type:"default",classObj:r},{id:"indexDB",type:"offline",classObj:s.a}],default:"http-adapter"}}},"w0m/":function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"c",function(){return b}),n.d(t,"a",function(){return f});var a=n("q1tI"),i=n.n(a),o=n("uwyq"),s=n("DoNX"),r=n("vr4s"),c=n("UK2x"),l=n("92Lq"),d=n("YV/N"),u=n("83P7"),p=n("/Qv1"),h=".zmNoteActionIcons",m=function(e){function t(){var e,n;babelHelpers.classCallCheck(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(i))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleSetFavourite",function(e){e.stopPropagation(),n.props.note.saveFavourite()}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props.note;if("new"===e.get("type"))return null;var t=e.get("starred");return i.a.createElement(o.a,{small:!0,additionalWrapperClass:t?"favNote":"",iconClass:t?"msi-fav zmFav":"msi-fav",tooltip:Object(d.b)("0d08e894cf9e80f17662fecb7cf5ab4e"),onClickHandler:this.handleSetFavourite})}}]),t}(i.a.Component),b=(i.a.Component,function(e){function t(e,n){var a;return babelHelpers.classCallCheck(this,t),a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleMoreOptionsClick",function(e){if(e.stopPropagation(),a.menuObj)return Object(r.hideMenu)();var t=a.props,n=t.stickyNote,i=t.note,o=i.get("namespaceId"),s=Boolean(_zm.isStreamsEnabled()),u=i.isOwnerOrGrpAdmin(),p=s&&u,m=s&&l.c.isGroupAvailable(o),b={txt:i.get("archived")?Object(d.b)("9fd02d2eb5ce348a74372eea202a0aec"):Object(d.b)("e727b00944f81e1d0a95c12886ac4641"),data:{action:"archive"}},f={txt:a.isStickyNote()?Object(d.b)("afd4daa47f770743072df6862067c39e"):Object(d.b)("e0db3f844569a56900f21c13dac3f4c8"),data:{action:"stickyNote"}},g=[].concat(babelHelpers.toConsumableArray(u&&"new"!==i.get("type")?[b]:[]),[{txt:Object(d.b)("a1f51c8be58267e666d74a427aae870e"),data:{action:"sendMail"}},{txt:Object(d.b)("d7c14092c2a6b6305118ee18148f52d2"),data:{action:"openintab"}}],babelHelpers.toConsumableArray(m?[{txt:Object(d.b)("b6dc54fec959471d9498275172a5f833"),data:{action:"copyNote"}}]:[]),babelHelpers.toConsumableArray(p?[{txt:Object(d.b)("93febe185b7ade3aa5c8ba1957e15328"),data:{action:"moveNote"}}]:[]),babelHelpers.toConsumableArray(n||Object(c.j)()?[]:[f]),[{txt:Object(d.b)("13dba24862cf9128167a59100e154c8d"),data:{action:"print"}}],babelHelpers.toConsumableArray(u?[{sep:!0}]:[]),babelHelpers.toConsumableArray(u?[{txt:Object(d.b)("f2a6c498fb90ee345d997f888fce3b18"),data:{action:"delNote"}}]:[])),v=$.e(e.target).closest(h),y={par:$.e(e.target).closest("li"),showArrow:!0,spanClass:n?"zmArmZI":"",list:g,direction:"bottom",clk:function(e,t){$.e(t).hasClass("SC_op3")||a.popupClick(e)},onHide:function(){a.menuObj=void 0,v.removeClass("active")}};a.menuObj=zmsuite.showMenu(y),v.addClass("active")}),a.attObj={tempLocation:[],myAttachment:[]},a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"popupClick",value:function(e){Object(r.hideMenu)();var t=this.props.note;switch(e.action){case"archive":this.archiveOrUnarchiveNote();break;case"stickyNote":this.isStickyNote()?$.publish("/note/closeStickyNote",[t.get("id"),t.get("namespaceId")]):Object(u.a)(t.toJSON());break;case"sendMail":t.sendAsMail();break;case"delNote":Dialog.confirm(Object(d.b)("07248fd5b0b0bf2777c1ac728ec9a789"),function(){t.deleteNote(t.get("id"))});break;case"copyNote":Object(c.b)({title:t.get("title"),catId:t.get("cat"),namespaceId:t.get("namespaceId"),comments:!0},t.postAsNew.bind(t),{type:"copyNote"});break;case"moveNote":Object(c.b)({title:t.get("title"),catId:t.get("cat"),namespaceId:t.get("namespaceId"),comments:!0},t.changeGroup.bind(t),{type:"moveNote"});break;case"print":Promise.all([n.e(0),n.e(6),n.e(7),n.e(11),n.e(19)]).then(n.bind(null,"jenI")).then(function(e){(0,e.printNote)({id:t.get("id"),namespaceId:t.get("namespaceId")})});break;case"openintab":Promise.all([n.e(0),n.e(6),n.e(7),n.e(11),n.e(19)]).then(n.bind(null,"jenI")).then(function(e){(0,e.openNoteInTab)({id:t.get("id"),namespaceId:t.get("namespaceId")})})}}},{key:"archiveOrUnarchiveNote",value:function(){var e=this.props.note,t=!e.get("archived");e.archiveOrUnarchiveNote({archived:t})}},{key:"isStickyNote",value:function(){var e=p.f.getInstance("stickynote"),t=this.props.note;return!(!e||!e.findWhere({id:t.get("id")}))}},{key:"render",value:function(){return"new"===this.props.note.get("type")?null:i.a.createElement(o.a,{small:!0,iconClass:"msi-nmore",tooltip:Object(d.b)("284716247b12b363fd6b6a71bff0918e"),onClickHandler:this.handleMoreOptionsClick})}}]),t}(i.a.Component)),f=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props.note;return Boolean(_zm.isStreamsEnabled())&&e.get("commentCount")&&0!==e.get("commentCount")?i.a.createElement(o.a,{noHover:!0,small:!0,iconClass:"msi-lcmnt",tooltip:Object(d.b)("0dfe5d30e3cc745f0918409bc79ab602"),text:e.get("commentCount")}):null}}]),t}(i.a.Component)}}]);