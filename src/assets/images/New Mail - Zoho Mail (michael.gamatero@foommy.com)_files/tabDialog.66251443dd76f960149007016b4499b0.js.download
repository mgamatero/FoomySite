"use strict";define([],function(t){var e=t("zmail.Core.Namespaces"),n=t("zmail.Utils.DOM"),s=e.create("zmsDialog");return s.templates=s.templates||{},$.extend(s.templates,{tabsDialogTemplate:function(t){return n.element(zdom("div",{className:"SC_Pop SC_cent wht",id:t+"_tabPopupDialog"},zdom("div",{className:"SC_pe SC_PopTop"},zdom("div",{className:"SC_PU"},zdom("div",{className:"SC_PUtt"},zdom("div",{className:"SC_flt"},zdom("ul",{id:t+"_tabContainer",className:"SCS_tab"})),zdom("div",{id:t+"_tabIconCont",className:"SC_frt"}),zdom("div",{className:"SCmb"},zdom("div",{id:t+"_closeIcon",className:"SC_frt"},zdom("ul",null,zdom("li",null,zdom("b",null,zdom("div",{className:"SC_hd"}),zdom("span",{className:"SC_ttip ttr","data-tooltip":"Close"},zdom("i",{className:"msi-close"})))))))),zdom("div",{className:"SC_PUcen",style:{overflow:"auto"}})))))},listingBox:function(){return n.element(zdom("div",null))},buttonTemplate:function(){return n.element(zdom("span",{className:"sel"}))},headerTemplate:function(){return n.element(zdom("li",null))},iconTemplate:function(){return n.element(zdom("li",null,zdom("b",null,zdom("span",null,zdom("i",null)))))},tabTextBox:function(){return n.element(zdom("span",null))},iconContainer:function(){return n.element(zdom("div",{className:"SCmb SC_flt"},zdom("ul",null)))},buttonContainer:function(){return n.element(zdom("div",{className:"SC_PUbtm"}))},succErrMsgBox:function(){return n.element(zdom("div",{style:{display:"none"},className:"SC_msg SC_emsg"},zdom("span",null,zdom("font",null),zdom("i",{className:"msi-close"}))))},dialogTitle:function(){return n.element(zdom("h3",{style:{paddingBottom:"20px"}}))}},!0),s}),define([],function(l){var c,t=l("zmText"),e=l("zmail.Core.Namespaces"),r=l("zmComponent"),u=l("zmail.Utils.DOM"),b=t.get("dialog"),n=e.create("zmsDialog"),h=n.templates;function a(t,e){t.addClass(e)}function d(t,e){t.css(e)}function m(t,e){t.attr(e)}function f(t){t.hide()}function C(t,n,s){var o=u.element(h.headerTemplate());return n.id&&(o[0].id=n.id),n.text&&o.text(n.text),o.on("click",function(){var t,e=Number(o.attr("tabid"));e!==s.selectedTabId&&(t=s.tabsInfo[e],o.addClass("stSel"),s.hideTab(s.selectedTabId,!0),s.showTab(e),!n.onClk||t.dataLoaded&&!n.forceCall||(n.hideButtons&&!t.dataLoaded&&s.getButtonContainer().addClass("SC_vh"),n.onClk(s,e,t.dataLoaded)),t.dataLoaded=!0)}),n.selected&&(a(o,"stSel"),s.selectedTab=o),n.classes&&a(o,n.classes),n.styles&&d(o,n.styles),n.attr&&m(o,n.attr),n.hide&&f(o),o}function I(t,e,n){var s=u.element(h.buttonTemplate());return t.id&&(s[0].id=t.id,n.id=t.id),t.text&&s.text(t.text),t.onClk&&(n.onClk=function(){t.onClk(e)},s.on("click",n.onClk)),t.classes&&a(s,t.classes),t.styles&&d(s,t.styles),t.attr&&m(s,t.attr),t.hide&&s.attr("style","display:none !important"),s}function g(t,e,n){var s,o=u.element(h.iconTemplate());return t.id&&(o[0].id=t.id,n.id=t.id),t.onClk&&(n.onClk=function(){o.find("b").addClass("SC_sel"),t.onClk(e)},o.on("click",n.onClk)),t.iconClass&&o.find("i").addClass(t.iconClass),t.selected&&o.find("b").addClass("SC_sel"),t.text&&(o.addClass("SCtxt"),(s=u.element(h.tabTextBox())).text(t.text),u.mount(s,u.selector("span",o))),t.attr&&m(o,t.attr),t.hide&&f(o),o}function s(t){$.e(document.body).addClass("zmDialogOn"),this.configOption=t,this.id=t.id||"def_tab_dialog",this.selectedTabId=void 0,this.tabsInfo=[],this.tabNameMap={},this.$el=void 0,this.maskWrapperClass="SC_Pop",this.positionWrapperClass="SC_pe",this.contentWrapperClass="SC_PU",this.headerClass="SC_PUtt",this.contentClass="SC_PUcen",this.ignoreMouseDown=t.ignoreMouseDown,this.onMouseDown=t.onMouseDown}function T(t,e){this.$tabEle=t,this.$buttons=void 0,this.$icons=void 0,this.$centerElem=void 0,this.$errBand=void 0,this.isSelected=e,this.onCancel=void 0,this.onClick=void 0,this.removeloadingband=function(){},this.dataLoaded=!1,this.tabId=void 0,this.iconsInfo=[],this.buttonsInfo=[]}function p(t,e){this.id=void 0,this.$iconEle=t,this.isSelected=e,this.onClk=function(){}}function v(t,e){this.id=void 0,this.$buttonEle=t,this.isSelected=e,this.onClk=function(){}}return s.prototype={customizeDialog:function(){var t=this.configOption,e=this,n=this.id,s=this,o=this.$el.find("#"+n+"_closeIcon");if(t.classes&&this.$el.addClass(t.classes),t.hideCloseIcon?o.hide():o.on("click",function(){e.close(e)}),this.ignoreMouseDown||this.$el.on("mousedown mouseup",function(t){l("zmUtil").stopEvents(t,!0),"function"==typeof s.onMouseDown&&s.onMouseDown(t,s)}),t.title){var i=u.element(h.dialogTitle()),a=this.$el.find(".SC_PUtt .SC_flt");i.text(t.title),u.mountAtStart(i,a),a.find(" .SCS_tab").css("clear","both"),u.mountAfter(a.find(" .SCS_tab"),this.$el.find(".SC_PUtt .SC_frt").eq(0))}},close:function(){this.$el.remove(),$.e(document.body).removeClass("zmDialogOn"),c&&r.keybindings.setScope(c),r.keybindings.dropScope("tabDialog"),this.configOption.onClose&&this.configOption.onClose()},create:function(){var t,e,n,s,o,i,a=(e=this.id,u.element(h.tabsDialogTemplate(e))),l=this.configOption,d=u.element(document.body);u.mount(a,d),this.$el=a,n=this,s=u.element(document.body),o=s.height(),i=s.width(),o=65*o/100,i=75*i/100,n.$el.find("."+n.contentClass).css({"max-height":o+"px","max-width":i+"px",width:60*i/100+"px"}),n.$el.find("."+n.contentWrapperClass).css({"max-width":i+"px"}),n.$el.find("."+n.positionWrapperClass).css({top:10*o/100+"px"}),t=l.tabs,function(){var t,e=this;c=r.keybindings.getScope(),t={allowDefaultScope:!1,shortcuts:[{uid:"close",keyStr:"esc",actions:[function(){e.close()}]}],scope:"tabDialog"},Array.isArray(e.configOption.shortcuts)&&(t.shortcuts=t.shortcuts.concat(e.configOption.shortcuts)),r.keybindings.registerAll(t),r.keybindings.setScope("tabDialog")}.call(this),this.createTabs(t),this.customizeDialog(),function(){var t=this.tabsInfo[this.selectedTabId];this.configOption.tabs[this.selectedTabId].hideButtons&&this.getButtonContainer().addClass("SC_vh"),t.onClick&&t.onClick(this),t.dataLoaded=!0}.call(this),l.dialogDidMount&&l.dialogDidMount(this)},createTabs:function(t,e){for(var n,s,o,i,a,l,d=t.length,c=0;c<d;c++)s=e||c,(n=t[c]).attr?n.attr.tabid=s:n.attr={tabid:s},this.tabNameMap[n.tabName]=s,i=new T(o=C(this.id,n,this),!1),u.mount(o,this.$el.find("#"+this.id+"_tabContainer")),n.selected&&(i.isSelected=!0,this.selectedTabId=c),a=n.icons?this.createIcons(n.icons,s,n.selected):null,i.$icons=null!==a&&a.$iconCont?a.$iconCont:null,i.iconsInfo=null!==a&&a.iconsInfo?a.iconsInfo:[],l=n.buttons?this.createButtons(n.buttons,s,n.selected):null,i.$buttons=null!==l&&l.$buttonCont?l.$buttonCont:null,i.buttonsInfo=null!==l&&l.buttonsInfo?l.buttonsInfo:[],n.listingArea||(n.listingArea={}),i.$centerElem=n.listingArea?this.createListingArea(n.listingArea,s,n.selected):null,i.$errBand=this.createErrBand(),i.onClick=n.onClk,i.name=n.tabName,n.hideCloseButton||this.createCloseButton(s,i),this.tabsInfo.push(i)},createErrBand:function(){var t=u.element(h.succErrMsgBox()),e=this;return t.find("i").off("click").on("click",function(){e.hideSuccErrMsg()}),u.mount(t,this.$el.find(".SC_pe")),t},createIcons:function(t,e,n){var s,o,i=t.length,a=this.$el.find("#"+e+"_tabIcons"),l=[];a.length||((a=u.element(h.iconContainer())).attr("id",e+"_tabIcons"),u.mount(a,this.$el.find("#"+this.id+"_tabIconCont"))),n||a.hide();for(var d=0;d<i;d++)o=g(t[d],this,s=new p(void 0,!1)),s.$iconEle=o,u.mount(o,a.find("ul")),l.push(s);return{$iconCont:a,iconsInfo:l}},createButtons:function(t,e,n){var s,o,i,a=this.$el.find("#"+e+"_tabPopupButton"),l=[];a.length||((a=u.element(h.buttonContainer())).attr("id",e+"_tabPopupButton"),u.mount(a,this.$el.find(".SC_PU"))),n||a.hide(),s=t.length;for(var d=0;d<s;d++)i=I(t[d],this,o=new v(void 0,!1)),o.$buttonEle=i,u.mount(i,this.$el.find("#"+e+"_tabPopupButton")),l.push(o);return{$buttonCont:a,buttonsInfo:l}},createListingArea:function(t,e,n){var s,o,i;return n||(t.hide=!0),o=t,i=u.element(h.listingBox()),o.id&&(i[0].id=o.id),o.ele&&u.__dangerouslySetInnerHTML(i,o.ele),o.classes&&a(i,o.classes),o.styles&&d(i,o.styles),o.attr&&m(i,o.attr),o.parEle&&o.parEle.append&&(u.mount(i,o.parEle),i=o.parEle),o.hide&&f(i),s=i,u.mount(s,this.$el.find("."+this.contentClass)),s},replaceButtons:function(t,e){var n,s=e?this.getTabNumberByTabName(e):this.selectedTabId,o=s===this.selectedTabId,i=this.tabsInfo[s];i.$buttons&&u.clearHTML(i.$buttons),n=this.createButtons(t,s,o),i.$buttons=n&&n.$buttonCont?n.$buttonCont:null,i.buttonsInfo=n&&n.buttonsInfo?n.buttonsInfo:[]},replaceIcons:function(t,e){var n,s,o=e?this.getTabNumberByTabName(e):this.selectedTabId,i=o===this.selectedTabId;(s=this.tabsInfo[o]).$icons&&u.clearHTML(s.icons),n=this.createIcons(t,o,i),s.$icons=n&&n.$iconCont?n.$iconCont:null,s.iconsInfo=n&&n.iconsInfo?n.iconsInfo:[]},replaceCenterArea:function(t,e){var n=e?this.getTabNumberByTabName(e):this.selectedTabId;"string"==typeof t&&(t=u.__dangerouslyParseHTML(t)),u.__dangerouslySetInnerHTML(t,this.tabsInfo[n].$centerElem)},createCloseButton:function(t,e){var n,s=t||this.selectedTabId,o=[],i={},a=this,l=e||this.tabsInfo[s],d=Boolean(l.isSelected);i.text=b.cancel,i.attr={"data-val":"Cancel"},i.onClk=function(){a.close(a),a.tabsInfo[s]&&a.tabsInfo[s].onCancel&&a.tabsInfo[s].onCancel()},o.push(i),n=this.createButtons(o,s,d),l.$buttons=n&&n.$buttonCont?n.$buttonCont:null,l.buttonsInfo.concat(n&&n.buttonsInfo?n.buttonsInfo:[])},createNewTab:function(t){var e=[],n=this.tabsInfo.length;e.push(t),this.createTabs(e,n)},createNewButton:function(t,e){var n,s=e?this.getTabNumberByTabName(e):this.selectedTabId,o=[],i=this.tabsInfo[s];o.push(t),n=this.createButtons(o,s,i.isSelected),i.$buttons=n&&n.$buttonCont?n.$buttonCont:null,i.buttonsInfo.concat(n&&n.buttonsInfo?n.buttonsInfo:[])},createNewIcon:function(t,e){var n,s=e?this.getTabNumberByTabName(e):this.selectedTabId,o=[],i=this.tabsInfo[s];o.push(t),n=this.createIcons(o,s,i.isSelected),i.$icons=n&&n.$iconCont?n.$iconCont:null,i.iconsInfo.concat(n&&n.iconsInfo?n.iconsInfo:[])},getAllIconsInfo:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;return this.tabsInfo[e].iconsInfo},getAllButtonsInfo:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;return this.tabsInfo[e].buttonsInfo},getSelectedTab:function(){return this.tabsInfo[this.selectedTabId].$tabEle},getCenterElem:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;return this.tabsInfo[e].$centerElem},getIconContainer:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;return this.tabsInfo[e].$icons},getButtonContainer:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;return this.tabsInfo[e].$buttons},getSelectedTabId:function(){return Number(this.tabsInfo[this.selectedTabId].$tabEle.attr("tabid"))},getTabNumberByID:function(t){return Number(this.$el.find("#"+t).attr("tabid"))},getTabNumberByTabName:function(t){return this.tabNameMap[t]},currentTab:function(){return this.tabsInfo[this.selectedTabId].name},showTab:function(t){var e=this.tabsInfo[t],n=e.$errBand;e.$tabEle.show().addClass("stSel"),e.$icons&&e.$icons.show(),e.$buttons&&e.$buttons.show(),e.$centerElem&&e.$centerElem.show(),n.attr("visibilityInUI")&&n.show(),this.selectedTabId=t,e.isSelected=!0},hideTab:function(t,e){var n=this.tabsInfo[t];e||n.$tabEle.hide(),n.$tabEle.removeClass("stSel"),n.$icons&&n.$icons.hide(),n.$buttons&&n.$buttons.hide(),n.$centerElem&&n.$centerElem.hide(),n.$errBand.hide(),n.isSelected=!1},showLoadingBand:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId,n=this.tabsInfo[e];n.removeloadingband=r.loadingBand({container:n.$centerElem[0],type:"pagination"})},removeLoadingBand:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId,n=this.tabsInfo[e];n.removeloadingband&&(n.removeloadingband(),n.removeloadingband=void 0)},setDataLoaded:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;this.tabsInfo[e].dataLoaded=!0,this.removeLoadingBand(e)},unsetDataLoaded:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;this.tabsInfo[e].dataLoaded=!1},getDataLoaded:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;return this.tabsInfo[e].dataLoaded},hideSuccErrMsg:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;this.tabsInfo[e].$errBand.hide().removeAttr("visibilityInUI")},showSuccErrMsg:function(t,e,n,s){var o=n?this.getTabNumberByTabName(n):this.selectedTabId,i=this.tabsInfo[o].$errBand,a=this;void 0!==e&&(t="w"===(t=t||"e")?"i":t,i.find("font").text(e),i.show().attr({visibilityInUI:"true",class:"SC_msg SC_"+t+"msg"}),s&&window.setTimeout(function(){a.hideSuccErrMsg()},s))},showButtons:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId,n=this.tabsInfo[e].$buttons;n&&n.removeClass("SC_vh")},hideButtons:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId,n=this.tabsInfo[e].$buttons;n&&n.addClass("SC_vh")},showIcons:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;this.tabsInfo[e].$icons.show()},hideIcons:function(t){var e=t?this.getTabNumberByTabName(t):this.selectedTabId;this.tabsInfo[e].$icons.hide()},setDialogDimension:function(t,e){var n=this.$el.find("."+this.contentClass);t&&n.css("height",t),e&&n.css("width",e)},setDialogPosition:function(t){var e=this.$el.find("."+this.positionWrapperClass);t&&(t.style&&e.css(t.style),t.classes&&e.addClass(t.classes))}},n.createTabPopupDialog=function(t){window.zmTooltip&&zmTooltip.remove();var e=new s(t);return e.create(),e},n});