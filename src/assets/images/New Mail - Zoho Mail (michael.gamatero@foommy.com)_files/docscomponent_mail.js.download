//$Id$
/**
 * IMPORTANT NOTE: This compressed javascript includes thirdparty javascripts
 * listed at docs.zoho.com/html/thirdparty.html
 * The original javascript sources are available in the above location.
 */
function ZDDialog(){}function ZDUtils(){}function ZDConstants(){this.openTarget="_blank",this.callback=!1,this.folderArray=[],this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.templates="false",this.nameSortArrow="",this.nameSortOrder="",this.timeSortArrow="",this.timeSortOrder="desc",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.startFrom="0",this.fetchLimit="50",this.isShareEnabled=!1,this.advSearchFile=!1,this.trashsort=!1,this.searchQuery="",this.jsonData="",this.includeJSandCSSFiles=!1,this.selectedLeftPanel="recentservicedocs",this.templateObj={},this.rename_openfile={id:"rename_openfile",label:zd_js_obj.rename,icon:"zdc-rename_css",attr:{title:zd_js_obj.rename}},this.trash_openfile={id:"trash_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.delete_openfile={id:"delete_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.restore_openfile={id:"restore_openfile",label:zd_js_obj.restore,icon:"zdc-restoreicon_css",attr:{title:zd_js_obj.restore}},this.viewer={id:"zd_viewer_perm",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator={id:"zd_collaborator_perm",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner={id:"zd_coowner_perm",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_only={id:"zd_comment_perm",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.readfill={id:"zd_readfill_perm",label:zd_js_obj.label_read_fill,icon:"viewer",attr:{title:zd_js_obj.label_read_fill}},this.SCR_WTH="",this.SCR_HT="",this.searchType="relevance",this.createFolder={id:"createfolder",label:zd_js_obj.create,icon:"zdc-foldericon_css"},this.renameFolder={id:"renamefolder",label:zd_js_obj.rename,icon:"zdc-rename_css"},this.deleteFolder={id:"deletefolder",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive"},this.viewer_details={id:"viewer_details",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator_details={id:"collaborator_details",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner_details={id:"coowner_details",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_details={id:"comment_details",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.readfill_details={id:"readfill_details",label:zd_js_obj.label_read_fill,icon:"viewer",attr:{title:zd_js_obj.label_read_fill}},this.trimmedEmails="",this.trimmedPerGroupIds="",this.trimmedOrgGroupIds="",this.groupNameList=[],this.groupNameAndIdList=[],this.docId,this.allShareJson={},this.isInternalMailId=!0,this.isCo_owner=!1,this.isFolderShare=!1,this.isVisibility=!1,this.updateShareStatus=!1,this.folderIds,this.resIds,this.autocomplete_selectValue="",this.G_fromAutoComplete=[],this.G_zdc_permissionType="2",this.defaultText="",this.templateCount=0}function ATTACHDIALOG(){this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.nameSortArrow="",this.timeSortArrow="",this.sortOrder="",this.orderBy="",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.asLink="false",this.startFrom="0",this.fetchLimit="50",this.jsonData="",this.selectedLeftPanel="recentservicedocs",this.SCR_WTH="",this.SCR_HT="",this.folderId="folder",this.folderpermission="",this.searchenabled=!1,this.defaultObj={servicename:"",attachCount:"5",handbckobj:"",sharedDocs:!0,search:!0,workspace:!0,positionObj:[],isDraggable:!0,isResize:!1,height:570,width:650,staticURL:location.protocol+"//css.zohostatic.com/personal/docs_v492/docscomponents"},this.attachObj={},this.docsURL="",this.gridObj={documentNameHeader:!0,lastModifiedTimeHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,authorName:!1,lastModifiedTime:!0}}function ADDDOCDIALOG(){this.urlInvoker,this.filename="",this.fileext="",this.folderid="-1",this.workspaceid="-1",this.wsfolderid="-1",this.issharedws=!1,this.SCR_WTH="",this.SCR_HT="",this.parentId=[],this.permission=[],this.folderlevel=[],this.rootvalue="",this.theme="lightgrey",this.docsURL="",this.defaultObj={servicename:"",filename:"",handbckobj:"",positionObj:[150,150],isDraggable:!0,isResize:!1,callback:""},this.adddocObj={},this.foldertree=[]}ZDDialog.showCommonDialog=function(e,t,a,i,s,o,d,r,n,l,c,p){p=p?p:1e4;ZD("#"+a).dialog({autoOpen:!0,zIndex:p,title:e,modal:t,resizable:n,closeText:"closeIcon",buttons:i,position:s,width:o,minWidth:l,minHeight:c,draggable:d,height:r,drag:function(){if("sharedialogdiv"==a){if(ZD("#zd_sharetextarea").is(":visible")){var e=ZD("#zd_sharetextarea").offset().top,t=ZD("#zd_sharetextarea").offset().left;ZD(".zdc_shareautocompletedialog.ui-autocomplete").css({top:e+45,left:t})}if(ZD("#zdc_visible_default_hidediv").is(":visible")){var i=ZD("#zdc_visible_changelink"),s=ZD(i).offset(),o=s.left-100,d=s.top+30;ZD("#zdc_visible_default_hidediv").css({top:d,left:o})}}},open:function(){ZD("#"+a).parent().addClass("docsdialog").prev();if("undefined"!=typeof G_OF_OBJ&&!ZD("#docsdialoguidialogzindex").length&&"zohosheet"===G_OF_OBJ.urlInvoker){var e=ZD(this).closest(".ui-dialog"),t=parseInt(e.css("z-index"))+5,i=document.createElement("style");i.type="text/css",i.id="docsdialoguidialogzindex";var s=".docsdialog.ui-dialog{z-index:";s+=t+" !important;}",i.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(i)}},resize:function(e,t){ZDDialog.resizeDialog(e,t,a)}});return ZD("#"+a).bind("dialogclose",function(){return ZDDialog.closePopUp(a),ZD(document).trigger("dialogbeforeclose"),!1}),!1},ZDDialog.resizeDialog=function(e,t,a){if("attachopenfiledialogdiv"==a){var i=t.size.height-92;ZD("#showopenservicefilespace").css("height",i),ZD("#showopenservicefilespace").openfiledatagrid("resize")}else if("sharedialogdiv"==a){ZD("#zd_initial_sharetextarea").is(":visible")&&ZD("#zd_initial_sharetextarea").trigger("focus");var i=t.size.height-279;ZD("#sharedialogdiv").css("overflow","hidden"),ZD(".privateshare-list").css("height",i),ZD("#zd_top_menu").is(":visible")&&ZD(".privateshare-list").css("height",i-93)}else if("attachfiledialogdiv"==a){var i=t.size.height-225;ZD("div#showattachfilespace").css("height",i),ZD("div#showattachfilespace").attachfiledatagrid("resize")}else if("adddocdialogdiv"==a){var i=t.size.height-255;ZD("div#tree_container").css("height",i).parent().css("height",i+40)}},ZDDialog.openAlert=function(e,t,a,i,s,o,d){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),o=350;var r=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(r).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:i,position:s,width:o,draggable:d,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+t+"</p>").removeAttr("style"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),!1}),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.componentAlert=function(e,t,a,i,s,o,d){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[]),o=520;var r=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(r).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,dialogClass:"zdocsalert",buttons:i,position:s,width:o,draggable:d,height:"auto",open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+t+"</p>").removeAttr("style"),ZD(".zdocsalert").find(".ui-icon-closethick").hide(),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.createNewFolderDialog=function(e,t,a,i,s,o){ZD("#createnewfolderdiv").remove();var d=ZD('<div id="createnewfolderdiv" style="display:none;"></div>');ZD(d).appendTo("body");ZD("#createnewfolderdiv").dialog({autoOpen:!0,zIndex:10008,title:e,modal:t,resizable:!1,closeText:"closeIcon",buttons:a,position:i,width:s,draggable:!0,height:o,open:function(){ZD("#createnewfolderdiv").parent().addClass("docsdialog")}});ZD("#createnewfolderdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("createnewfolderdiv"),!1})},ZDDialog.showValidatePasswordDialog=function(e,t,a,i,s,o){ZD("#passworddialogdiv").remove();var d=ZD('<div id="passworddialogdiv" style="display:none;"></div>');ZD(d).appendTo("body");ZD("#passworddialogdiv").dialog({autoOpen:!0,zIndex:10008,title:e,modal:t,resizable:!1,closeText:"closeIcon",buttons:a,position:i,width:s,draggable:!0,height:o,open:function(){ZD(".ui-dialog-titlebar-close").hide()},closeOnEscape:!1,open:function(){ZD("#passworddialogdiv").parent().addClass("docsdialog")}});ZD("#passworddialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("passworddialogdiv"),!1})},ZDDialog.showDialogForSendingMail=function(e,t,a,i,s,o){ZD("#securesharedialogdiv").remove();var d=ZD('<div id="securesharedialogdiv" style="display:none;"></div>');ZD(d).appendTo("body");ZD("#securesharedialogdiv").dialog({autoOpen:!0,zIndex:100008,title:e,modal:!1,resizable:!1,closeText:"closeIcon",buttons:a,position:i,width:s,draggable:!0,height:o,open:function(){ZD("#securesharedialogdiv").parent().addClass("docsdialog")}});ZD("#securesharedialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("securesharedialogdiv"),!1})},ZDDialog.closePopUp=function(e,t){ZD("#"+e).unbind("dialogclose"),"attachopenfiledialogdiv"==e?(ZD("#zd_leftmenu,#zd_rightmenu").unbind().remove(),ZD("#recentservicedocs").addClass("selectedView"),ZD("#serviceDialogLeftPanel,#showopenservicefilespace,div#selectboxdiv,div#searchdivforservicefiles,#servicefilepagination,table.toolbar").undelegate(),ZD("#attachopenfiledialogdiv").unbind("dialogclose"),ZD("div#showopenservicefilespace").openfiledatagrid("destroy"),ZD("#attachopenfiledialogdiv").dialog("destroy"),ZD("#attachopenfiledialogdiv").filedialog("destroy").remove(),ZD("#createnewfolderdiv,#frameDiv").dialog("destroy").remove()):"passworddialogdiv"==e?ZD("#passworddialogdiv").dialog("destroy").remove():"securesharedialogdiv"==e?(ZD("#securesharedialogdiv").dialog("destroy").remove(),public_PwdExpiryDate="",ZD_G_CurrentVisibility=""):"linkdocsdialogdiv"==e?(ZD("#recentservicedocs").addClass("selectedView"),ZD("div#showopenservicefilespace").linkdocsdatagrid("destroy"),ZD("#linkdocsdialogdiv").dialog("destroy"),ZD("#linkdocsdialogdiv").linkdocsdialog("destroy").remove()):"attachfiledialogdiv"==e?(ZD("#attachfiledialogdiv").unbind("dialogclose"),ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("div#attachfiledialogdiv").attachfiledialog("destroy").remove(),ZD("#attachfiledialogdiv").dialog("destroy").remove()):"zdattachcontainer"==e?(ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("#zdattachcontainer").attachfiledialog("destroy").remove()):"adddocdialogdiv"==e?(ZD("#adddocdialogdiv").unbind("dialogclose"),ZD("#expand_view,#folder_container").undelegate(),ZD("#"+e).dialog("destroy").remove()):"frameDiv"==e||"createnewfolderdiv"==e||"sharedialogdiv"==e||"uploadConfirmDiv"==e?("sharedialogdiv"==e&&(ZD(".zdc_shareautocompletedialog.ui-autocomplete").remove(),ZD("#zd_leftmenu,#visibilityoptions_top").unbind(),ZD("#zd_leftmenu,#visibilityoptions_top").remove(),ZD("#sharedialogdiv").undelegate(),ZD("#zdc_visible_default_hidediv").undelegate(),ZD("body").undelegate("#sharedialogdiv, #zdc_visible_default_hidediv, .ui-widget-overlay","click"),ZD("#zd_sharetextarea").autocomplete("destroy"),ZD("#zd_sharetextarea,#share_via_link_edit").unbind(),ZD("#frameDiv").dialog("destroy").remove(),G_COMP_OBJ.isReqFromDocs&&ZDUtils.deSelectDocs(),G_OF_OBJ.autocomplete_selectValue="",G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="",G_OF_OBJ.G_fromAutoComplete=[],G_OF_OBJ.isCo_owner=!1),"passwordvalidation"!=t&&ZD("#zdc_visible_default_hidediv").remove(),ZD("#"+e).dialog("destroy").remove()):"sharecollabupgradediv"==e?ZD("#"+e).dialog("destroy").remove():"mycollaboratorslistdiv"==e?ZD("#"+e).dialog("destroy").remove():"dialogdiv"==e?ZD("#"+e).html("").removeAttr("style").dialog("destroy"):"statusdialogdiv"==e?ZD("#"+e).dialog("destroy").remove():"customfieldsdialogdiv"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"sharefileaslinkcontainer"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"ui-zmoveto-dialog"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"ui-zdocssaveas-dialog"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"initSaveAs"===e&&(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove())},ZDDialog.showExternalUsersList=function(e,t,a,i,s,o){ZD("#frameDiv").remove(),(void 0==a||""==a)&&(a=[200,350]),width=450;var d=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(d).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:a,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"invalidList"==s?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_invalid+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"):3==i&&"externalList"==s&&0==o?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_coowner_permission_not_allowed+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_continue_remove_users_share_again+"</div></div></div>").removeAttr("style"):ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_list_contains_people_not_part_organization+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_are_you_sure_you_want_to_share+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showNonZohoUserList=function(e,t,a){ZD("#frameDiv").remove(),(void 0==a||""==a)&&(a=[200,350]),width=450;var i,s=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');i="NONE"==zd_third_party||""==zd_third_party||"undefined"==zd_third_party||void 0==zd_third_party?"zoho":zd_third_party.toLowerCase(),ZD(s).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:a,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div  style="display: block;"><div><div>'+ZDUtils.replaceParams(zd_js_obj.label_users_groups_listed_invalid,new Array(i))+':</div><div class="zdc-external-list"></div></div></div>').removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showInactiveUserList=function(e,t,a){ZD("#frameDiv").remove(),(void 0==a||""==a)&&(a=[200,350]),width=450;var i=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(i).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:a,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_are_inactive+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.sharePolicyFailList=function(e,t,a,i,s){ZD("#frameDiv").remove(),(void 0==a||""==a)&&(a=[200,350]),width=450;var o=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(o).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:a,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"ext_fail"==i?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Your organization policy does not allow you to share with below users:</div><div class="zdc-external-list"></div><div>To continue sharing, please contact your administrator.</div></div></div>').removeAttr("style"):"accept_fail"==i&&ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Organization policy of below user(s) does not allow you to share with them :</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),"undefined"==typeof s&&(ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton()),!1}),!1},ZDDialog.showStatusDialog=function(e,t,a,i,s){var o=ZD('<div id="statusdialogdiv" style="display:none;"></div>');if(ZD(o).appendTo("body"),(""===a||void 0===a)&&(a=[SCR_WTH-SCR_WTH/1.6,SCR_HT-SCR_HT/1.6]),ZDdialog=ZD("#statusdialogdiv").dialog({autoOpen:!0,title:e,modal:t,resizable:!1,closeText:"",buttons:"",position:a,width:i,draggable:!0,height:s,open:function(){ZD(".ui-dialog-titlebar-close").hide()}}),!ZD("#statusdialogdiv").parent(".dialog-inner-container").length){var d=ZD('<div class="ui-corner-all dialog-inner-container" style="display:block;"></div>');d.insertBefore(ZD("#statusdialogdiv")).append(ZD("#statusdialogdiv"))}if(ZD(".sshow_layoutcontainer").length){var r=parseInt(ZD(".sshow_layoutcontainer").css("z-index"));ZD("#statusdialogdiv").closest(".ui-dialog").css("z-index",r+5)}ZD("#statusdialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("statusdialogdiv"),!1})},ZDDialog.showPreviewImg=function(e,t,a){ZDDialog.showCommonDialog(e,!0,"dialogdiv","","",SCR_WTH/1.35,!0,SCR_HT/1.5);var i='<div align="center"  style="padding:10px;"><img src="'+a+'" style="max-height:'+SCR_HT/1.5+'px" /></div>';ZD("#dialogdiv").html(i)},ZDUtils.SIZE_CALC_WITH_BYTES=1024,ZDUtils.getHeight=function(){var e;return self.innerHeight?e=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight:document.body&&(e=document.body.clientHeight),e},ZDUtils.getWidth=function(){var e;return self.innerHeight?e=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientWidth:document.body&&(e=document.body.clientWidth),e},ZDUtils.isEmailId=function(e){if(!e)return!1;e=e.trim();var t=/^(([\w\.]+)|[\w]([\w\-\.\+\'\/]*)@([\w\.\-]+\.[a-zA-Z]{2,22}))$/i;return t.test(e)},ZDUtils.substringName=function(e,t){var a=e;return a.length>t&&(a=a.substring(0,t),a+=".."),a},ZDUtils.escapeSpecialCharacters=function(e){e+="";var t=e.replace(/"/g,"&quot;"),a=t.replace(/'/g,"&apos;"),i=a.replace(/</g,"&lt;"),s=i.replace(/>/g,"&gt;");return s},ZDUtils.hasSpecialChar=function(e,t){var a="!@#$%^&*()+=-[]\\';,/{}|\":<>?";"docrename"==t?a="<>*%#&?\\',\"()":"emailidchk"==t&&(a="!#$%^&*()+=-[]\\';/{}|\":<>?");for(var i=1,s=0;s<e.length;s++)-1!=a.indexOf(e.charAt(s))&&(i+=1);return i>1?(FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.special_characters_validaton),!0):!1},ZDUtils.hasWhiteSpaceChar=function(e,t){return""===e?("renamefolder"==t?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.document_name_empty_validation),!0):!1},ZDUtils.showAlertBox=function(e,t){"rename"==t?FILEDIALOG.statusmsg("failure_status boldText",e):"folder"==t?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):ZDDialog.openAlert(zd_js_obj.alert,e,!0)},ZDUtils.LoadingMsg=function(e){var t=zd_js_obj.loading;""!=e&&void 0!=e&&(t=e),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" class="zdcomp_loading">'+t+"</span>")},ZDUtils.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ZDUtils.openFileLoadingMsg=function(e){var t="Loading...";""!=e&&void 0!=e&&(t=e);var a=ZD("#showopenservicefilespace").height()/2.2,i=ZD("#showopenservicefilespace").width()/2.2;ZD("#openfileloadingdiv").css({"margin-left":i,"margin-top":a,display:"block"}).find("span").html(t)},ZDUtils.hideOpenFileLoadingMsg=function(){ZD("#openfileloadingdiv").hide()},ZDUtils.showLoading=function(e,t){var a=zd_js_obj.loading;void 0!=t&&""!=t&&(a=t);var i=e+"_msg";ZD("#"+i).remove(),ZD("#"+e).append('<span  id="'+i+'" class="zdcomp_loading">'+a+"</span>")},ZDUtils.hideLoading=function(e){ZD("#"+e).hide()},ZDUtils.getI18N=function(e){ZDUtils.getUserRelatedDetails("",e)},ZDUtils.split=function(e){return e.split(/,\s*/)},ZDUtils.extractLast=function(e){var t=e.toString();return ZD.trim(ZDUtils.split(t).pop())},ZDUtils.startsWithRegEx=function(e,t){var a=e.label,i=a.substring(0,a.indexOf("(")-1).trim();if((void 0==i||""==i)&&(i=a),i=i.toLowerCase(),t=t.toLowerCase(),i.substring(0,t.length)==t)return e;var s=ZDUtils.getLastNameOfContact(i);if(s=s.toLowerCase(),s.substring(0,t.length)==t)return e;var o=a.substring(a.indexOf("(")+1,a.length);return o=o.toLowerCase(),void 0==o||""==o?"":o.substring(0,t.length)==t?e:void 0},ZDUtils.getLastNameOfContact=function(e){var t=e.substring(e.lastIndexOf(" ")+1,e.length);return t},ZDUtils.validateResource=function(e,t,a){temp=document.domain.split("."),temp[0]="workdrive",url="";for(var i=0;i<temp.length;i++)url+=temp[i],i!=temp.length-1&&(url+=".");var s="https://"+url+"/docs/getproductinfo.do?rid="+a;ZD.ajax({url:s,type:"GET",dataType:"html",success:function(i){ZDUtils.getCustomerRelatedDetails(e,t,a,i)},error:function(){var i='{"isTeamResource":false}';ZDUtils.getCustomerRelatedDetails(e,t,a,i)}})},ZDUtils.getUserDetails=function(e,t,a){ZDUtils.validateResource(e,t,a)},ZDUtils.getUserRelatedDetails=function(e,t,a){if(a)ZDUtils.validateResource(e,t,a);else{var i='{"isTeamResource":false}';ZDUtils.getCustomerRelatedDetails(e,t,a,i)}},ZDUtils.getCustomerRelatedDetails=function(e,t,a,i){var s=ZD.parseJSON(i),o="";if(s.isTeamResource)return window.ZD_IS_NEW_UI_ENABLED=!0,window.tdURL=s.pcUrl,void(window.wdResId=a);if(o="/docs/zduserdetails.do",""!=t&&void 0!=t){var d=t.charAt(t.length-1);"/"!=d&&(t+="/"),o=t+"docs/zduserdetails.do"}var r="_t="+ZD.now()+(G_COMP_OBJ.isReqFromDocs?"&service=docs":"");void 0!==a&&(r=r+"&resourceId="+a),ZD.ajax({url:o,type:"GET",data:r,dataType:"html",success:function(a){if(ZD("body").append(ZD(a).filter("#zd_user_details")[0]),ZD("body").append(ZD(a).filter("#zd_i18ndetails")[0]),zd_js_obj=JSON.parse(ZD("#zd_i18ndetails").attr("zd_js_obj")),ZD("body").append(ZD(a).filter("#zd_component_variables")[0]),window.ZUID=ZD("#zd_component_variables").attr("zuid"),window.zd_isorguser="true"==ZD("#zd_component_variables").attr("zd_isorguser")?!0:!1,window.orgnameofcurrentuser=ZD("#zd_component_variables").attr("orgnameofcurrentuser"),window.displayOrgnameofcurrentuser=ZD("#zd_component_variables").attr("displayOrgnameofcurrentuser"),window.orgLabel=zd_js_obj.label_everyone_org,orgnameofcurrentuser.length){var i=orgnameofcurrentuser;if(orgnameofcurrentuser.length>40)var i=orgnameofcurrentuser.substring(0,40);orgLabel=ZDUtils.replaceParams(zd_js_obj.label_everyone_orgname,new Array(i))}if(window.userFullName=ZD("#zd_component_variables").attr("userFullName"),window.PC_USER_PLAN_TYPE=parseInt(ZD("#zd_component_variables").attr("PC_USER_PLAN_TYPE")),window.zd_third_party=ZD("#zd_component_variables").attr("zd_third_party"),window.ZOHO_CN=ZD("#zd_component_variables").attr("ZOHO_CN"),window.docsCSRFParamNAME=ZD("#zd_component_variables").attr("docsCSRFParamNAME"),window.docsCSRFCookieName=ZD("#zd_component_variables").attr("docsCSRFCookieName"),window.isCommentEnabled="true"==ZD("#zd_component_variables").attr("isCommentEnabled")?!0:!1,window.serviceUrl=ZD("#zd_component_variables").attr("serviceUrl"),window.pcUrl=ZD("#zd_component_variables").attr("pcUrl"),window.zd_serviceName=ZD("#zd_component_variables").attr("zd_serviceName"),window.zd_udservicekey=ZD("#zd_component_variables").attr("zd_udservicekey"),window.zd_udserverurl=ZD("#zd_component_variables").attr("zd_udserverurl"),window.userCanShareExternally=ZD("#zd_component_variables").attr("userCanShareExternally"),window.IAM_URL=ZD("#zd_component_variables").attr("IAM_URL"),window.currentBrowserDetails=ZD("#zd_component_variables").attr("currentBrowserDetails"),window.isCommonErrorPageEnabled="true"==ZD("#zd_component_variables").attr("isCommonErrorPageEnabled")?!0:!1,window.ZD_GUEST_EDIT_SHEET="true"==ZD("#zd_component_variables").attr("ZD_GUEST_EDIT_SHEET")?!0:!1,window.ZD_GUEST_EDIT_SHOW="true"==ZD("#zd_component_variables").attr("ZD_GUEST_EDIT_SHOW")?!0:!1,window.ZD_COMMENT_ENABLEDFOR_SHEET="true"==ZD("#zd_component_variables").attr("ZD_COMMENT_ENABLEDFOR_SHEET")?!0:!1,window.ZD_COMMENT_ENABLEDFOR_SHOW="true"==ZD("#zd_component_variables").attr("ZD_COMMENT_ENABLEDFOR_SHOW")?!0:!1,window.ZD_SHARENOTE_GOTIT_ORGSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_ORGSHARE")?!0:!1,window.ZD_SHARENOTE_GOTIT_LINKSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_LINKSHARE")?!0:!1,window.ZD_SHARENOTE_GOTIT_SECUREEMAILSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_SECUREEMAILSHARE")?!0:!1,window.zdc_ContactsURL=ZD("#zd_component_variables").attr("zdc_ContactsURL"),window.css_lable=ZD("#zd_component_variables").attr("css_lable"),window.compStaticServer=ZD("#zd_component_variables").attr("compStaticServer"),window.staticVersionToLoad=ZD("#zd_component_variables").attr("staticVersionToLoad"),window.READ_CMT_ENABLED_SERVICES="zw",window.ZD_IS_NEW_UI_ENABLED=ZD("#zd_component_variables").attr("ZD_IS_NEW_UI_ENABLED"),ZD_COMMENT_ENABLEDFOR_SHEET&&(READ_CMT_ENABLED_SERVICES+="|zohosheet"),ZD_COMMENT_ENABLEDFOR_SHOW&&(READ_CMT_ENABLED_SERVICES+="|zohoshow"),window.ZDOCScsrfToken=ZD("#zd_component_variables").attr("ZDOCScsrfToken"),serviceUrl=window.location.origin,window.zdcsrfPair=window.docsCSRFParamNAME+"="+window.ZDOCScsrfToken,isCommonErrorPageEnabled&&("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&!currentBrowserDetails.IS_SUPPORTED_BROWSER){var s=ZD("#browser-error-msg").html();if(null!=s)if(ZD(document).znotifier)ZD(document).znotifier({type:"warning",iconclass:"ui-components-icon ui-state-warning-icon",position:"north",content:s,autohide:!1});else{var o='<div id="browserErrorMsg" style="width: auto; text-align: center; margin: 0 auto; -webkit-border-bottom-right-radius: 7px; -webkit-border-bottom-left-radius: 7px; -moz-border-radius-bottomright: 7px; -moz-border-radius-bottomleft: 7px; border-bottom-right-radius: 7px; border-bottom-left-radius: 7px; -moz-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; -webkit-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; position: fixed; top: 0; z-index: 9999; left: 40%; margin-left: -25%; background: #fff; border-color: #d1d6ed; color: #000; padding: 10px; font-size: 12px; border-left: 1px solid #d1d6ed; border-right: 1px solid #d1d6ed; overflow: hidden; text-align: center; border-bottom-right-radius: 7px;">'+s+'<span style="padding-left: 5px; padding-right: 5px;">|</span><a href="javascript:void(0)" style="cursor: pointer; text-decoration: underline;" onclick="ZD(\'#browserErrorMsg\').hide();">'+zd_js_obj.label_close+"</a></div>";ZD("body").append(o)}}"undefined"==typeof ZD_G_ContactSearchEnabled&&(window.ZD_G_ContactSearchEnabled=!0),ZDUtils.getPlanType("",t),void 0!=e&&""!=e&&"function"==typeof e&&e()}})},ZDUtils.triggerUploadList=function(e){var t=ZD("#zd_user_details").attr("serviceName"),a=e.files,i=a[0].fileName,s=a[0].fileSize,o=0;(""==i||void 0==i)&&(i=a[0].name),(""==s||void 0==s)&&(s=a[0].size);var d=i.split(".")[i.split(".").length-1],o=0;if(s>SIZE_CALC_WITH_BYTES*SIZE_CALC_WITH_BYTES)return alert("Upload files greater than 10MB"),ZDDialog.closePopUp("uploadConfirmDiv"),!1;if("WRITER"==t){if("doc"!=d.toLowerCase()&&"docx"!=d.toLowerCase()&&"odt"!=d.toLowerCase()&&"rtf"!=d.toLowerCase())return alert("Only this files doc,docx,odt,rtf are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}else if("SHEET"==t){if("xls"!=d.toLowerCase()&&"xlsx"!=d.toLowerCase()&&"sxc"!=d.toLowerCase()&&"ods"!=d.toLowerCase()&&"csv"!=d.toLowerCase()&&"tsv"!=d.toLowerCase())return alert("Only this files xls,xlsx,sxc,ods,csv,tsv are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}else if("SHOW"==t){if("pptx"!=d.toLowerCase()&&"ppsx"!=d.toLowerCase()&&"ppt"!=d.toLowerCase()&&"pps"!=d.toLowerCase()&&"odp"!=d.toLowerCase()&&"sxi"!=d.toLowerCase())return alert("Only this files pptx,ppsx,ppt,pps,odp,sxi are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}},ZDUtils.uploadProgress=function(e){var t=ZDUtils.updateFileNameSelected(e),a=ZD("#uploadfilediv"),i="target"+(new Date).getTime(),s=(ZDUtils.createIframe(i),ZDUtils.createForm(t,i)),o=(ZD(e).parent(),ZD(e).clone());ZD(o).unbind(),s.append(e),a.append(s)},ZDUtils.updateFileNameSelected=function(e){var t=ZD(e).attr("value"),a=ZDUtils.getFileName(t);-1!=a.toLowerCase().indexOf(".zip")&&(a=a.substring(0,a.length-4)+".zip");var i=(new Date).getTime();return ZDUtils.showFileList(a,i,!1,!1),i},ZDUtils.showFileList=function(e){return ZD(".fileinfo").text("Selected File"),ZD("#upload_detailview").text(e),ZD(".file_size_info").addClass("hidediv"),!1},ZDUtils.createIframe=function(e){var t=ZD('<iframe  name="'+e+'">').attr({height:"0",width:"0",id:e}).css("display","none");return ZD(t).appendTo("body"),t},ZDUtils.createForm=function(e,t){var a=ZD("<form></form>");return a.attr({id:"form-"+e,target:t,name:"form-"+e,method:"POST",encType:"multipart/form-data",encoding:"multipart/form-data"}),a.css({margin:0,display:"none"}),a},ZDUtils.getFileName=function(e){var t,a=e;t=a.lastIndexOf(isWin||chrome7||isSafari?"\\":"/");var i=a.substring(t+1);return i},ZDUtils.deSelectDocs=function(){var e=ZD("div.selecteddoc");e.each(function(){ZD(this).closest("div.dataDiv").removeClass("select"),ZD(this).attr("class","unselecteddoc"),ZD(this).children().attr("class","normalcheckboxicon_css")}),ZD("#selectAllCheckBox").hasClass("selectcheckboxicon_css")&&ZD("#selectAllCheckBox").attr({"class":"normalcheckboxicon_css",name:"allDocsUnSelected"})},ZDUtils.deSelectDoc=function(e){ZD("div[id="+e+"]").removeClass("select").find("div.selecteddoc").attr("class","unselecteddoc").children().attr("class","normalcheckboxicon_css")},ZDUtils.replaceParams=function(e,t){if("undefined"!=t&&t.length>0)for(i=0;i<t.length;i++)e=ZDUtils.replace(e,"{"+i+"}",t[i]);return e},ZDUtils.replace=function(e,t,a){var i=e.length,s=t.length;if(0===i||0===s)return e;var o=e.indexOf(t);if(!o&&t!=e.substring(0,s))return e;if(-1==o)return e;var d=e.substring(0,o)+a;return i>o+s&&(d+=ZDUtils.replace(e.substring(o+s,i),t,a)),d},ZDUtils.statusmsg=function(e,t,a){ZD("#docs_statusmsg_div").length&&ZD("#docs_statusmsg_div").remove();var i='<div style="width:100%;position:absolute;padding-top:5px;" id="docs_statusmsg_div"><div align="center"><span id="statusmsgdiv" class=""></span></div></div>';ZD("#"+a).prepend(i),ZD("span#statusmsgdiv").attr("class",e).html(t).parent().css("display","block"),setTimeout(function(){ZD("#docs_statusmsg_div").remove()},4e3)},ZDUtils.getMyContacts=function(e,t){var a;a="method=getContacts&_t="+ZD.now()+"&"+zdcsrfPair;var i=serviceUrl+"/docs/docsrequest.do";void 0!=t&&""!=t&&(i=t+"docs/docsrequest.do"),ZD.ajax({url:i,data:a,dataType:"json",type:"POST",success:function(e){docs_myContacts=e.contact_list}})},ZDUtils.getPersonalContacts=function(e){var t;t="method=getPersonalContacts&_t="+ZD.now()+"&"+zdcsrfPair;var a=serviceUrl+"/docs/docsrequest.do";void 0!=e&&""!=e&&(a=e+"docs/docsrequest.do"),ZD.ajax({url:a,data:t,dataType:"json",type:"POST",success:function(e){docs_myContacts=e.contact_list}})},ZDUtils.getPlanType=function(e,t){var a="undefined"==typeof e||""===e?!0:e;if(void 0!=t&&""!=t)var i=t+"docs/docsrequest.do?method=getPlanType";else var i=serviceUrl+"/docs/docsrequest.do?method=getPlanType";return ZD.ajax({async:a,url:i,dataType:"json",type:"GET",success:function(e){zdcomp_userType=e.response.result.PlanType.MESSAGE,("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&("FREE_PLAN_TYPE"!=zdcomp_userType&&""!=zdcomp_userType&&void 0!=zdcomp_userType&&"undefined"!=typeof zdcomp_userType?"undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled||ZDUtils.getMyContacts("",t):"undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled||ZDUtils.getPersonalContacts(t))},error:function(){zdcomp_userType=""}}),!1},ZDUtils.getSelectedDocuments=function(){var e="";"explorer"===G_SwitchTab?e="#explorergrid":"workspace"===G_SwitchTab?e="#wsdocsgrid":"group"===G_SwitchTab?e="#showgroupdocspace":"tag"===G_SwitchTab?e="#taggrid":"search"===G_SwitchTab&&(e="#searchgrid");var t=ZD("div.selectcheckboxicon_css",e);return t},ZDUtils.getOwnedSelectedDocs=function(){var e=ZDUtils.getSelectedDocuments(),t=[];return e.each(function(e){var a={},i=ZD(this).closest("div.dataDiv"),s=ZD(this).closest("div.folderDiv"),o=i.data("scope");if(0===o){var d=i.attr("id"),r=i.data("permission"),n=i.data("fileName"),l=i.data("encFileName"),c=i.data("encAttrFileName"),p=i.data("encUrlFileName"),_=i.data("serviceType"),D=i.data("fileType"),h=i.data("fileExt"),u=i.data("authorId"),v=i.data("classIconName"),f=i.data("encSharedDocId"),m=i.data("is_doc_author"),O=i.data("parentId"),g=i.attr("fileId");authorName=i.data("authorName"),isLocked=i.data("isLocked"),lockedBy=i.data("lockedBy"),a.isFolder=s.length?!0:!1,a.isDocAuthor=m,a.authorId=u,a.encSharedDocId=f,a.docId=d,a.scope=o,a.permission=r,a.fileId=g,a.file_name=n,a.encFile_name=l,a.encAttrFile_name=c,a.encUrlFile_name=p,a.service=_,a.filetype=D,a.fileext=h,a.classname=v,a.authorName=authorName,a.parentId=O,a.isLocked=isLocked,a.lockedBy=lockedBy,t[e]=a,parseInt(a.scope)>0&&(sharedDocExist=!0)}else 1===o&&(i.removeClass("select"),ZD(this).attr("class","normalcheckboxicon_css"))}),t},ZDUtils.getSelectedDocumentIds=function(){var e=ZDUtils.getOwnedSelectedDocs();if(!e.length)return alert("Document Visibility can be set for owned documents only."),!1;for(var t="",a=0;a<e.length;a++)t+=e[a].docId+",";return t},ZDUtils.insertDynamicButton=function(e,t,a,i,s){var o='<button style="margin-right:5px;"   class="ui-button ui-widget ui-state-default ui-corner-all  zd_dynamicbutton"><span class="ui-button-text">'+e+"</span></button>";if(ZD("#"+a+" button:nth-child("+t+")").remove(),1==t?ZD("#"+a).prepend(o):ZD("#"+a).append(o),i){var d='<span class="ui-button-icon-primary ui-icon ui-icon-loader"></span>';ZD(".zd_dynamicbutton").addClass("ui-button-disabled ui-state-disabled ui-status-icon ui-button-text-icon-primary").prepend(d)}else ZD(".zd_dynamicbutton").addClass("ui-button-text-only");""!=s&&void 0!=s&&ZD(".zd_dynamicbutton").unbind().bind("click",function(){return s(),!1})},ZDUtils.loadComponentsStaticFiles=function(e,t,a){var i=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/),s=(i?parseInt(i[1]):void 0,function(e,t){var a=document.getElementsByTagName("head")[0];if(!jQuery("#css_linkdocscomponents").length){var i=document.createElement("link");i.href=e,i.rel="stylesheet",i.type="text/css",i.id="css_linkdocscomponents",a.appendChild(i)}if(!jQuery("#js_linkdocscomponents").length){var s=document.createElement("script");s.src=t,s.type="text/javascript",s.id="js_linkdocscomponents",a.appendChild(s)}}),o=e+"/docs/docsrequest.do?method=loadComponentsStaticFiles",d="service="+t.toUpperCase()+"&_t="+(new Date).getTime();jQuery.ajax({url:o,type:"GET",dataType:"json",data:d,xhrFields:{withCredentials:!0},success:function(e){if("undefined"==typeof a){var t=e.cssfilepath,i=e.jsfilepath;s(t,i)}else a(e)}})},ZDUtils.loadZDCStaticFilesForEditors=function(e,t,a,i){var s=location.protocol+"//"+location.hostname+"/docs/docsrequest.do?method=loadComponentsStaticFiles",o="service="+e+"&_t="+(new Date).getTime();void 0!==t&&(o+="&jsfilename="+t),void 0!==a&&(o+="&cssfileName="+a),jQuery.ajax({url:s,type:"GET",dataType:"json",data:o,success:function(e){var t=e.cssfilepath,a=e.jsfilepath,s=(e.staticversiontoload,e.jsfilename),o=e.cssfilename;if("undefined"!=typeof i)i(e);else{var d=function(e,t){var a=document.getElementsByTagName("head")[0];if(!jQuery("#"+o).length){var i=document.createElement("link");i.href=e,i.rel="stylesheet",i.type="text/css",i.id=o,a.appendChild(i)}if(!jQuery("#"+s).length){var d=document.createElement("script");d.src=t,d.type="text/javascript",d.id=s,a.appendChild(d)}};d(t,a)}}})},ZDUtils.matchFullNameForCommentMentions=function(e,t){var a=e.name;return a=a.toLowerCase(),t=t.toLowerCase(),a.substring(0,t.length)===t?e:""},G_COMP_CONSTANTS=function(){this.isReqFromDocs=!1,this.serviceType=""};var G_COMP_OBJ=new G_COMP_CONSTANTS,zd_isIE="";!function(){var e=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);zd_isIE=e?parseInt(e[1]):void 0}();var G_OF_OBJ,G_FormDataArray=[],G_FileDataArray=[],G_UploadIndexCounter=0,ZD_collaboratorCount=0,docs_myContacts=[],user_emailContacts=[],ZD=jQuery,zd_js_obj="",zdcsrfPair,isWin=-1!=navigator.appVersion.indexOf("Win")?!0:!1,isSafari=navigator.userAgent.toLowerCase().indexOf("safari")>-1,userAgent=navigator.userAgent.toLowerCase(),us=userAgent.substring(userAgent.indexOf("chrome/")+7),chrome7=parseInt(us.substring(us,us.indexOf(".")))>=7?!0:!1,zdcomp_userType,ZD_G_CurrentVisibility="private",public_PwdExpiryDate="",G_OF_OBJ;ATTACHDIALOG.initMenu=function(e){("left"==e||"both"==e)&&(ZD("#leftmenu,#visibilityoptions_top").zmenu().bind("menubeforeshow",function(e,t){var a=ZDMenu.createLeftMenu(e,t);return a}),ZD("#leftmenu,#visibilityoptions_top").bind("menuitemclicked",function(e,t){return ZDMenu.leftMenuItemActions(e,t),!0})),("right"==e||"both"==e)&&(ZD("#rightmenu").zmenu().live("menubeforeshow",function(e,t){var a=ZDMenu.createContextMenu(e,t);return a}),ZD("#rightmenu").live("menuitemclicked",function(e,t){return ZDMenu.contextMenuItemActions(e,t),!0}))},ATTACHDIALOG.attachDocsFiles=function(){if("undefined"!=typeof teamMigrationObj&&"1"===teamMigrationObj.enabled&&"2"===teamMigrationObj.type&&"4"===teamMigrationObj.user_status)return alert("You have migrated your data from Docs to WorkDrive. You cannot perfom any action on Docs files"),!1;var e=ZD("div.selectbox","#selectboxdiv");if(0==e.length)return ATTACHDIALOG.statusmsg(zd_js_obj.select_the_documents),void ZDUtils.hideLoadingMsg();var t=ATTACHDIALOG.getSelectedDocs();if(t.length>G_OF_OBJ.attachObj.attachCount)return ATTACHDIALOG.statusmsg(ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_OF_OBJ.attachObj.attachCount+""))),void ZDUtils.hideLoadingMsg();for(var a={},i=[],s=0,o=t.length;o>s;s++){var d={},r=t[s].docId,n=t[s].docName,l=t[s].service;l="zw"==l?"writer":"zohoshow"==l?"show":"zohosheet"==l?"sheet":"upload";var c=t[s].isDocumentSharedToMe,p=t[s].encryptedId;"undefined"==p&&(p=""),d.docId=r,d.docName=n,d.service=l,d.isDocumentSharedToMe=c,d.encryptedId=p,i[s]=d}a.docObj=i,a.handbckobj=G_OF_OBJ.attachObj.handbckobj,("salesInbox"==G_OF_OBJ.urlInvoker||"zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"discussion"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker)&&attachDocsIntegCallBackFn(a),ZDDialog.closePopUp("attachfiledialogdiv")},ATTACHDIALOG.attachFiles=function(){if("undefined"!=typeof teamMigrationObj&&"1"===teamMigrationObj.enabled&&"2"===teamMigrationObj.type&&"4"===teamMigrationObj.user_status)return alert("You have migrated your data from Docs to WorkDrive. You cannot perfom any action on Docs files"),!1;var e=ZD("div.selectbox","#selectboxdiv"),t="",a="",i="",s="",o="",d="",r="",n="",l="",c="",p="",_=!1,D=!1,h=!1;if(0==e.length){var u={},v=parseInt(ZD("#attachfiledialogdiv").parent().css("left"))+160,f=parseInt(ZD("#attachfiledialogdiv").parent().css("top"))+180,m=[v,f],O=G_OF_OBJ.attachObj.isDraggable;return u[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},void ZDDialog.openAlert(zd_js_obj.alert,zd_js_obj.select_the_documents,!0,u,m,"",O)}var g=ATTACHDIALOG.getSelectedDocs();if(g.length>G_OF_OBJ.attachObj.attachCount){var u={},v=parseInt(ZD("#attachfiledialogdiv").parent().css("left"))+160,f=parseInt(ZD("#attachfiledialogdiv").parent().css("top"))+180,m=[v,f],O=G_OF_OBJ.attachObj.isDraggable;return u[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},void ZDDialog.openAlert(zd_js_obj.alert,ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_OF_OBJ.attachObj.attachCount+"")),!0,u,m,"",O)}for(var b=0,A=g.length;A>b;b++)s=g[b].docId,o=g[b].docName,d=g[b].service,_=g[b].isDocumentSharedToMe,c=g[b].encryptedId,"true"==_?(h=!0,"zw"==d?(r=r+s+",",l+="writer,"):"zohoshow"==d?(r=r+s+",",l+="show,"):"zohosheet"==d?(r=r+s+",",l+="sheet,"):(r=r+c+",",l+="upload,"),n=n+encodeURIComponent(o)+","):(D=!0,i+="zw"==d?"writer,":"zohoshow"==d?"show,":"zohosheet"==d?"sheet,":"upload,",t=t+s+",",a=a+encodeURIComponent(o)+",");D&&(t=t.substring(0,t.length-1),a=a.substring(0,a.length-1),i=i.substring(0,i.length-1),p+="docIds="+t+"&docNames="+a+"&service="+i),D&&h&&(p+="&"),h&&(r=r.substring(0,r.length-1),n=n.substring(0,n.length-1),l=l.substring(0,l.length-1),p+="sharedDocIds="+r+"&sharedDocNames="+n+"&sharedService="+l),"discussion"==G_OF_OBJ.urlInvoker&&attachDocsIntegCallBackFn(p),ZDDialog.closePopUp("attachfiledialogdiv")},ATTACHDIALOG.getSelectedDocs=function(){var e=ZD("div.selectbox","div#selectboxdiv"),t=[],a=0;return e.each(function(){if(!ZD(this).closest("div").hasClass("selectionblur")){var e={},i=ZD(this).closest("div"),s=i.attr("docId"),o=i.attr("docName"),d=i.attr("service"),r=i.attr("fileType"),n=i.attr("isDocumentSharedToMe"),l=i.attr("encryptedId");e.docId=s,e.docName=o,e.docType=r,e.service=d,e.docURL=G_OF_OBJ.docsURL+"/file/"+e.docId,e.isDocumentSharedToMe=n,e.encryptedId=l,t[a]=e,a++}}),t},ATTACHDIALOG.checkSelectedFiles=function(e){var t=ZD("div.selectbox","div#selectboxdiv"),a=!1;return t.each(function(){var t=ZD(this).closest("div"),i=t.attr("permission"),s=t.attr("scope");1==s&&3!==i&&(i=""!==G_OF_OBJ.folderpermission?Number(G_OF_OBJ.folderpermission):2),"undefined"==i||3==i||0==i||G_OF_OBJ.asLink!==!0||ZD("#selectedfile_"+t.attr("docId")).hasClass("selectionblur")||ZD("#selectedfile_"+t.attr("docId")).addClass("selectionblur"),e===t.attr("docId")&&(a=!0)}),a},ATTACHDIALOG.getDocAsLink=function(){var e=ATTACHDIALOG.getSelectedDocs(),t="",a="";t=1===e.length&&"zw"===e[0].service?{recipentsofemail:{permission:"ro rw rc co",expirydate:!1,password:!1},everyoneinorg:{permission:"ro rw rc",expirydate:!1,password:!1},everyoneininternet:{expirydate:!0,permission:!1,password:!1},extshare:{permission:"ro rw rc",expirydate:!0,password:!0}}:{recipentsofemail:{permission:"ro rw co",expirydate:!1,password:!1},everyoneinorg:{permission:"ro rw",expirydate:!1,password:!1},everyoneininternet:{expirydate:!0,permission:!1,password:!1},extshare:{permission:"ro rw",expirydate:!0,password:!0}},0===PC_USER_PLAN_TYPE?a="FREE":1===PC_USER_PLAN_TYPE?a="STANDARD":2===PC_USER_PLAN_TYPE&&(a="PREMIUM");var i={attachObj:e,shareLinkObj:t,ZD_USER_PLAN_TYPE:a,isOrgEnable:zd_isorguser};return i},ATTACHDIALOG.asLink=function(){G_OF_OBJ.asLink=!0,G_OF_OBJ.searchenabled===!0?ATTACHDIALOG.disableNonSharable():ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")},ATTACHDIALOG.asAttachment=function(){G_OF_OBJ.asLink=!1,G_OF_OBJ.searchenabled===!0?ATTACHDIALOG.disableNonSharable():(ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows"),ZD("#selectboxdiv").find("div").removeClass("selectionblur"))},ATTACHDIALOG.getSelectedDocsForOpenFileDialog=function(){var e=ZD("div#attachFileDataDiv table.zd_select"),t=[];return e.each(function(e){var a={},i=ZD(this).closest("div"),s=i.attr("id"),o=i.data("fileId"),d=i.data("service"),r=i.data("docName"),n=i.data("cssName"),l=i.data("isDocumentSharedToMe"),c=i.data("isTemplates"),p=i.data("encryptedId");a.docId=s,a.fileId=o,a.file_name=r,a.service=d,a.classname=n,a.isDocumentSharedToMe=l,a.encryptedId=p,a.isTemplates=c,t[e]=a}),t},ATTACHDIALOG.statusmsg=function(e){ZD("span#zd_statusmsgdiv").html(e).parent().css("display","block"),ZD("div.attach_message").css("margin-top","0px"),setTimeout(function(){ZD("span#zd_statusmsgdiv").html("").parent().css("display","none")},4e3)},ATTACHDIALOG.reset=function(){G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.prevIndex="1",G_OF_OBJ.nextIndex="10",G_OF_OBJ.startFrom="0",G_OF_OBJ.gridObj.authorName=!1},ATTACHDIALOG.selectRow=function(e){ZD("#"+e).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),ZD("#"+e).children("table.data-hover").addClass("zd_select")},ATTACHDIALOG.deselectRow=function(e){ZD("#"+e).find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),ZD("#"+e).children("table.data-hover").removeClass("zd_select"),ZD("#selectedfile_"+e).length&&ZD("#selectedfile_"+e).remove()},ATTACHDIALOG.showSelectedDocsToAttach=function(e){var t=ZD(e).closest("div.documentDataDiv"),a=t.attr("id");if(ZD(e).find(".checkboxtd").children().hasClass("selectcheckboxicon_css"))return void ATTACHDIALOG.deselectRow(a);ATTACHDIALOG.selectRow(a);var i=t.attr("serviceType");void 0===i&&(i=ZD("#"+a).data("service"));var s=t.attr("isDocumentSharedToMe"),o=t.attr("encryptedId"),d=t.data("encAttrFileName");void 0===d&&(d=ZD("#"+a).data("encfilename"));var r=t.data("permission"),n=ZD("#"+a).data("fileType"),l=ZDUtils.substringName(d,"10");void 0!==t.attr("data-encattrfilename")&&(d=t.attr("data-encattrfilename"));var c='<div class="selectbox flleft" style="overflow:hidden;" id="selectedfile_'+a+'" fileType="'+n+'" permission="'+r+'"  docId="'+a+'" docName="'+d+'" service="'+i+'" isDocumentSharedToMe="'+s+'" encryptedId="'+o+'"><span class="flleft" title="'+d+'" alt="'+d+'">'+l+'</span><span action="delete" id="'+a+'_delete" class="closeBtn_css flleft cursor cls" alt="'+zd_js_obj.remove+'" title="'+zd_js_obj.remove+'"></span></div>';if(ZD("#selectboxdiv").append(c),G_OF_OBJ.asLink===!0&&t.hasClass("opacityshare")){var p="You can share only the files you own or co-own via link. Please add as attachment.";void 0!=zd_js_obj.label_alert_while_click_shared&&(p=zd_js_obj.label_alert_while_click_shared),ATTACHDIALOG.statusmsg(p),ZD("#selectedfile_"+a).addClass("selectionblur")}},ATTACHDIALOG.selectOrdeselectRow=function(e,t){var a=ZD(t).closest(".documentDataDiv"),i=(currentObj.attr("id"),a.children("table.data-hover").hasClass("zd_select"));return i?(a.find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),a.children("table.data-hover").removeClass("zd_select")):(a.find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),a.children("table.data-hover").addClass("zd_select")),!1},ATTACHDIALOG.clearSelectedRows=function(){var e=ZD("#attachFileDataDiv").find("div.documentDataDiv").children("table.zd_select");ZD(e).each(function(e,t){ZD(t).removeClass("zd_select"),ZD(t).find("td.checkboxtd").children().toggleClass("normalcheckboxicon_css selectcheckboxicon_css")})},ATTACHDIALOG.getSharedDocs=function(e,t,a){ATTACHDIALOG.LoadingMsg(zd_js_obj.loading),G_OF_OBJ.selectedLeftPanel="shareddocs",null==e&&(e=0),null==t&&(t="time"),null==a&&(a="desc");var i=G_OF_OBJ.docsURL+"/docs/viewsearchresults.do?method=attachFileSharedDocs&start="+e+"&field="+t+"&action="+a+"&_t="+(new Date).getTime(),s=ZD("#showattachfilespace").children();ZD(s).each(function(e,t){ZD(t).empty().remove()}),ZD.ajax({url:i,xhrFields:{withCredentials:!0},type:"POST",datatype:"html",success:function(e){ZD("#showattachfilespace").html(e),ATTACHDIALOG.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs()}})},ATTACHDIALOG.clearText=function(){"Searchfiles"==ZD("#searchFileName").value&&(ZD("#searchFileName").value="")},ATTACHDIALOG.LoadingMsg=function(e){var t=zd_js_obj.loading;""!=e&&void 0!=e&&(t=e),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" style="padding:3px 5px;background-color:#848484;color:#FFF;font-size:11px;font-weight:bold;text-align:center;right:3px;position:absolute;">'+t+"</span>")},ATTACHDIALOG.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ATTACHDIALOG.getDocAsList=function(e,t){var a;""!=e&&void 0!=e?a=ZD(e).attr("id"):""!=t&&void 0!==t&&(a=t),ZD("#actionMenuOpenFile").css("display","block"),("desktopservicedocs"===a||"sharedservicedocs"===a)&&(G_OF_OBJ.folderId="folder"),"workspacelist"===a&&(G_OF_OBJ.folderId="wshome",G_OF_OBJ.wsId="wshome"),""!=a&&void 0!=a&&(ATTACHDIALOG.changeAllToNormalView(a),G_OF_OBJ.selectedLeftPanel=a),ATTACHDIALOG.resetAll();var i=G_OF_OBJ.gridObj;ZD("#sharedservicedocs").hasClass("selectedView")&&(i.authorName=!0),ZD("div#showattachfilespace").attachfiledatagrid("populateDataPanel",i)},ATTACHDIALOG.getSortDocAsList=function(e,t){var a;""!=e&&void 0!=e?a=ZD(e).attr("id"):""!=t&&void 0!==t&&(a=t),ZD("#actionMenuOpenFile").css("display","block"),""!=a&&void 0!=a&&(ATTACHDIALOG.changeAllToNormalView(a),G_OF_OBJ.selectedLeftPanel=a),ATTACHDIALOG.resetAll();var i=G_OF_OBJ.gridObj;"sharedservicedocs"==a&&(i.authorName=!0),ZD("div#showattachfilespace").attachfiledatagrid("populateDataPanel",i)},ATTACHDIALOG.resetAll=function(){ATTACHDIALOG.reset();var e=ZD("#showattachfilespace").children();ZD(e).each(function(e,t){ZD(t).empty().remove()}),ZD("#showattachfilespace").attachfiledatagrid("resetOptions"),ZD("#servicefilepagination").css("display","none")},ATTACHDIALOG.changeAllToNormalView=function(e){ZD("#serviceDialogLeftPanel").find("td.selectedView").toggleClass("selectedView normalView"),""!=e&&void 0!=e&&ZD("#"+e).addClass("selectedView").removeClass("normalView")},ATTACHDIALOG.setSortOrder=function(e){var t=ZD(e).attr("id");G_OF_OBJ.nameSortArrow=ZD(e).children().attr("class"),G_OF_OBJ.timeSortArrow=ZD(e).children("img").attr("class"),"nameHeader"==t?(G_OF_OBJ.timeSortArrow="",G_OF_OBJ.sortOrder="",G_OF_OBJ.orderBy="name",G_OF_OBJ.sortOrder=ZD(e).children().hasClass("DownArrow")?"asc":"desc"):"dateModifiedHeader"==t&&(G_OF_OBJ.nameSortArrow="",G_OF_OBJ.sortOrder="",G_OF_OBJ.orderBy="date",G_OF_OBJ.sortOrder=ZD(e).children().hasClass("DownArrow")?"asc":"desc")},ATTACHDIALOG.setClassAfterSorting=function(e){var t=ZD(e).attr("id");"nameHeader"==t?(ZD("#dateModifiedHeader").children("img:first").removeClass().addClass("DownArrowH"),ZD("#"+t).children("img:first").removeClass().addClass("UpArrow"==G_OF_OBJ.nameSortArrow?"DownArrow":"UpArrow")):"dateModifiedHeader"==t&&(ZD("#nameHeader").children("img:first").removeClass().addClass("DownArrowH"),ZD("#"+t).children("img:first").removeClass().addClass("UpArrow"==G_OF_OBJ.timeSortArrow?"DownArrow":"UpArrow"))},ATTACHDIALOG.getUserDocsPlan=function(e){var t=e+"/docs/zduserdetails.do",a={};return ZD.ajax({url:t,type:"GET",dataType:"html",async:!1,cache:!1,xhrFields:{withCredentials:!0},success:function(e){ZD("#zd_user_details").remove(),ZD("body").append(e),ZD(e).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),0===PC_USER_PLAN_TYPE?userPlanType="FREE":1===PC_USER_PLAN_TYPE?userPlanType="STANDARD":2===PC_USER_PLAN_TYPE&&(userPlanType="PREMIUM"),a={ZD_USER_PLAN_TYPE:userPlanType,isOrgEnable:zd_isorguser}}}),a},ATTACHDIALOG.getI18N=function(e,t){var a=t+"/docs/zduserdetails.do";ZD.ajax({url:a,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),void 0!=e&&""!=e&&e()}})},ATTACHDIALOG.checkWorkspaceStatus=function(e,t){var a=t+"/docs/attachfilerequest.do?method=checkWorkspaceStatus";ZD.ajax({url:a,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(t){void 0!=e&&""!=e&&e(t.status)}})},ATTACHDIALOG.showAttachFileDialog=function(e,t){var a=e.docsURL;if(void 0==zd_js_obj||""==zd_js_obj){G_OF_OBJ=new ATTACHDIALOG;var i=function(){ATTACHDIALOG.showAttachFileDialog(e,t)};return ATTACHDIALOG.getI18N(i,a),!1}if(void 0===t||""===t){var s=function(t){ATTACHDIALOG.showAttachFileDialog(e,t)};return ATTACHDIALOG.checkWorkspaceStatus(s,a),!1}if(!ZD("#attachfiledialogdiv").length||1==e.isnewui&&"zmail"==G_OF_OBJ.urlInvoker){"undefined"==typeof G_OF_OBJ&&(G_OF_OBJ=new ATTACHDIALOG),G_OF_OBJ.docsURL=a,"undefined"!=typeof ZOHO_CN&&"true"===ZOHO_CN&&(G_OF_OBJ.defaultObj.staticURL=location.protocol+"//css.zohostatic.com.cn/personal/docs_v481/docscomponents"),G_OF_OBJ.attachObj=ZD.extend({},G_OF_OBJ.defaultObj,e),G_OF_OBJ.urlInvoker=G_OF_OBJ.attachObj.servicename,G_OF_OBJ.attachObj.staticURL=location.protocol+"//"+css_lable+"."+compStaticServer+"/personal/docs_"+staticVersionToLoad,G_OF_OBJ.spacerImagePath=G_OF_OBJ.attachObj.staticURL+"/images/spacer.gif",("zmail"!=G_OF_OBJ.urlInvoker||1!=e.isnewui)&&ZD("body").append('<div id="attachfiledialogdiv" style="display:none;">'),ZD("body").append('<ul id="zd_leftmenu" style="display:none;"></ul>'),ZD("body").append('<ul id="zd_rightmenu" style="display:none;"></ul>');var o={};"zmail"==G_OF_OBJ.urlInvoker&&1==e.isnewui?(ZD("#"+e.container_id).append('<div id="zdattachcontainer">'),$("#zdattachcontainer").addClass("docsdialog")):("discussion"==G_OF_OBJ.urlInvoker?o[zd_js_obj.label_attach]=function(){ATTACHDIALOG.attachFiles()}:("zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&(o[zd_js_obj.label_attach]=function(){ATTACHDIALOG.attachDocsFiles()}),o[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("attachfiledialogdiv")});var d=G_OF_OBJ.attachObj.positionObj,r=G_OF_OBJ.attachObj.isDraggable,n=G_OF_OBJ.attachObj.isResize,l=G_OF_OBJ.attachObj.height,c=G_OF_OBJ.attachObj.width,p=!0,_="undefined"!=typeof t?t:G_OF_OBJ.attachObj.workspace,D=G_OF_OBJ.attachObj.sharedDocs,h=400;zd_isIE&&"zcrm"==G_OF_OBJ.urlInvoker&&(h=600),G_OF_OBJ.attachObj.search||(p=!1),"zmail"==G_OF_OBJ.urlInvoker?l-=64:("zcrm"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&(l-=24);var u="undefined"!=typeof zd_third_party&&"FUJI"===zd_third_party?"fujidocs":"undefined"!=typeof zd_third_party&&"BAIHUI"===zd_third_party?"baihuidocs":"";"zmail"==G_OF_OBJ.urlInvoker&&1==e.isnewui?(ZD("div#zdattachcontainer").addClass(u).attachfiledialog({recentDocs:{name:zd_js_obj.label_recent_docs,title:zd_js_obj.label_recent_docs},desktopDocs:{name:zd_js_obj.my_folders,title:zd_js_obj.my_folders},myDocs:{name:zd_js_obj.label_my_docs,title:zd_js_obj.label_my_docs},mySheets:{name:zd_js_obj.label_my_spreadsheets,title:zd_js_obj.label_my_spreadsheets},myPresentations:{name:zd_js_obj.label_my_presentations,title:zd_js_obj.label_my_presentations},myPictures:{name:zd_js_obj.label_my_pictures,title:zd_js_obj.label_my_pictures},sharedDocs:{show:D,name:zd_js_obj.shared_with_me,title:zd_js_obj.shared_with_me},workspace:{show:_,name:zd_js_obj.label_workspaces,title:zd_js_obj.label_workspaces},trashedDocs:{show:!1},upOneLevel:!0,advSearchBox:p}),$("#selectboxdiv").css("height",50),G_OF_OBJ.asLink=!1):(ZDDialog.showCommonDialog(zd_js_obj.label_attach_from_zoho_docs,!0,"attachfiledialogdiv",o,d,c,r,l,n,450,h),("zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"discussion"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&ZD("div#attachfiledialogdiv").addClass(u).attachfiledialog({recentDocs:{name:zd_js_obj.label_recent_docs,title:zd_js_obj.label_recent_docs},desktopDocs:{name:zd_js_obj.my_folders,title:zd_js_obj.my_folders},myDocs:{name:zd_js_obj.label_my_docs,title:zd_js_obj.label_my_docs},mySheets:{name:zd_js_obj.label_my_spreadsheets,title:zd_js_obj.label_my_spreadsheets},myPresentations:{name:zd_js_obj.label_my_presentations,title:zd_js_obj.label_my_presentations},myPictures:{name:zd_js_obj.label_my_pictures,title:zd_js_obj.label_my_pictures},sharedDocs:{show:D,name:zd_js_obj.shared_with_me,title:zd_js_obj.shared_with_me},workspace:{show:_,name:zd_js_obj.label_workspaces,title:zd_js_obj.label_workspaces},trashedDocs:{show:!1},upOneLevel:!0,advSearchBox:p})),"undefined"!=typeof teamMigrationObj&&"1"===teamMigrationObj.enabled&&"2"===teamMigrationObj.type&&"4"===teamMigrationObj.user_status&&(ZD("#attachfiledialogdiv").prepend('<div id="wd_mig_message" style=" background:#fe5454; padding: 10px 5px 10px 5px; color: white;"><span>You have migrated your data from Docs to WorkDrive. you cannot perfom any action on Docs files</span></div>'),ZD("#attachfiledialogdiv").css({pointerEvents:"none"})),"zprojects"==G_OF_OBJ.urlInvoker&&ZD("div#attachfiledialogdiv").parent().css({"box-shadow":"0 0 8px #B0B0B0","-moz-box-shadow":"0 0 8px #B0B0B0","-webkit-box-shadow":"0 0 8px #B0B0B0","z-index":"999999999"}),ZD("div#showattachfilespace").attachfiledatagrid()}},ATTACHDIALOG.clearSelectedFiles=function(){for(var e=ATTACHDIALOG.getSelectedDocsForOpenFileDialog(),t=0,a=e.length;a>t;t++){var i=e[t].docId;ATTACHDIALOG.selectOrdeselectRow(i)}},ATTACHDIALOG.split=function(e){return e.split(/,\s*/)},ATTACHDIALOG.extractLast=function(e){return ATTACHDIALOG.split(e).pop()},ATTACHDIALOG.startsWithRegEx=function(e,t){var a=e.label,i="^"+t.toLowerCase();if(a.toLowerCase().match(i)==t.toLowerCase())return e;var s=e.fullname;return s.toLowerCase().match(i)==t.toLowerCase()?e:""},ATTACHDIALOG.showHideShareMsg=function(e){var t=ZD(e).hasClass("editmsg_add");t?(ZD(e).text("Discard Message"),ZD(e).removeClass("editmsg_add"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus()):(ZD(e).text("Add Message"),ZD(e).addClass("editmsg_add"),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""))},ATTACHDIALOG.showHideMsg=function(e){var t=ZD(e).attr("checked");t?(ZD(".docsdialog .checkbox_add").text("Add Message"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus()):(ZD(".docsdialog .checkbox_add").text(""),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""))},ATTACHDIALOG.searchMouseOver=function(e,t,a,i){e!=t&&("asc"==i?ZD("#"+a).attr("class","UpArrow"):ZD("#"+a).attr("class","DownArrow"))},ATTACHDIALOG.searchMouseOut=function(e,t,a){e!=t&&ZD("#"+a).attr("class","")},ATTACHDIALOG.searchFile=function(e){var e=ZD("#searchFileName").val();return"*"===ZD.trim(e)||""===ZD.trim(e)?(ATTACHDIALOG.statusmsg(zd_js_obj.enter_valid_text_search),void ZDUtils.hideLoadingMsg()):(ATTACHDIALOG.changeAllToNormalView(),G_OF_OBJ.selectedLeftPanel="search",void ATTACHDIALOG.getSearchResults(e,0))},ATTACHDIALOG.searchSorting=function(e,t){var a=ZD("#searchFileName").val();null==e&&(e="time"),null==t&&(t="desc"),ATTACHDIALOG.getSearchResults(a,0,e,t)},ATTACHDIALOG.getSearchResults=function(e,t,a,i){ZDUtils.LoadingMsg(zd_js_obj.loading),null==t&&(t=0),null==a&&(a="time"),null==i&&(i="desc");var s=ZD("#showopenservicefilespace").children();ZD(s).each(function(e,t){ZD(t).empty().remove()});var s=ZD("#showattachfilespace").children();ZD(s).each(function(e,t){ZD(t).empty().remove()});var o=G_OF_OBJ.docsURL+"/docs/viewsearchresults.do?method=attachFileSearch&start="+t+"&field="+a+"&action="+i+"&searchquery="+encodeURIComponent(e)+"&category="+G_OF_OBJ.urlInvoker+"&_t="+(new Date).getTime();ZD.ajax({url:o,xhrFields:{withCredentials:!0},datatype:"html",success:function(e){ZD("#showattachfilespace").html(e),ZD("#attachFileDataDiv strong").first().empty(),ZD("#attachFileDataDiv").css("height","302px"),ZDUtils.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs()}})},ATTACHDIALOG.constructSearchResults=function(e,t){for(var a='<div id="attachFileDataDiv" class="zd_scroll" style="padding-bottom:5px;vertical-align:top;border:0px solid #000000;height:320px;"><table class="docs-tabledata" width="100%" cellpadding="0" cellspacing="0" border="0" align="center">',i=e.documentListContainer.length,s=e.documentListContainer,o=0;i>o;o++){var d=s[o],r=d.encAttrDocId,n=d.encAttrDocName,l=d.encDocName,c=d.encUrlDocName,p=d.encAttrService,_=d.encAttrAuthorId,D=d.encAttrFileType,h=d.enclastEdited,u=d.encAttrFileExtn,v=d.encAttrEncryptedIds,f=d.encAttrClassName,m=(d.isAuthor,d.isDocumentSharedToMe),O=d.indexType,g=(d.shareicon,d.sharetitle,d.encAuthorName);G_OF_OBJ.asLink===!0&&ATTACHDIALOG.getPermission(r),a+='<tr><td nowrap="nowrap"><div class="documentDataDiv docs-tablediv " id="'+r+'" fileName="'+n+'" data-fileName="'+n+'" data-encFileName="'+l+'" data-encUrlFileName="'+c+'"  data-serviceType="'+p+'" data-authorId="'+_+'" data-author="'+g+'" data-indexType="'+O+'" data-fileType="'+D+'" data-authorName="'+g+'" data-service ="'+p+'" data-fileExt="'+u+'"    data-encryptedId="'+v+'" isDocumentSharedToMe="'+m+'">',a+=ZD("#selectedfile_"+r).length?'<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="data-hover zd_select"><tr><td colspan="4" nowrap="nowrap" width="100%"><table width="100%" cellpadding="0" border="0" class="docs-tablerow"><tr><td width="20" height="20" class="docscursor checkboxtd" elem="checkbox"><img src="'+G_OF_OBJ.spacerImagePath+'" class="selectcheckboxicon_css flleft"/></td><td nowrap="nowrap" width="20" elem="documenticon" ><div class="'+f+'"/></td><td nowrap="nowrap" align="left" elem="documenticon"><span title="'+n+'" class="docscursor">'+l+'</span></td><td width="50" nowrap="nowrap" align="center"><span>&nbsp;</span></td><td width="110" nowrap="nowrap"><span>&nbsp;'+g+'</span></td><td width="100" nowrap="nowrap"><span class="pad-lft">'+h+"</span></td></tr></table></td></tr></table></div>":'<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="data-hover"><tr><td colspan="4" nowrap="nowrap" width="100%"><table width="100%" cellpadding="0" border="0" class="docs-tablerow"><tr><td width="20" height="20" class="docscursor checkboxtd" elem="checkbox"><img src="'+G_OF_OBJ.spacerImagePath+'" class="normalcheckboxicon_css flleft"/></td><td nowrap="nowrap" width="20" elem="documenticon" ><div class="'+f+'"/></td><td nowrap="nowrap" align="left" elem="documenticon"><span title="'+n+'" class="docscursor">'+l+'</span></td><td width="50" nowrap="nowrap" align="center"><span>&nbsp;</span></td><td width="110" nowrap="nowrap"><span>&nbsp;'+g+'</span></td><td width="100" nowrap="nowrap"><span class="pad-lft">'+h+"</span></td></tr></table></td></tr></table></div>"}a+="</td></tr></table></div>",t.append(a);var b=e.field,A=e.changeaction,w=e.timeclassname,C=e.action,Z=e.searchquery,y=e.prevPage,G=e.nextPage,F=e.prevButtonClass,I=e.nextButtonClass,z=e.start,x=e.end,T=e.totalCount;x>T&&(x=T),ZD("#servicefilepagination").html('<table cellpadding="0" cellspacing="0" border="0"><tr><td id=searchpagestatusid" class="pagecount">'+z+" - "+x+" "+zd_js_obj.of+" "+T+'</td><td><div id="searchprevbuttonid" >&nbsp;</div></td><td><div id="searchnextbuttonid" >&nbsp;</div></td></tr></table>'),ZD("#attachFileDataDiv").data({prevButtonClass:F,nextButtonClass:I,start:z,end:x,totalCount:T,field:b,changeSortingAction:A,sortingClassNameOfTime:w,sortAction:C,searchquery:Z,prevPage:y,nextPage:G,noOfResults:10}),ZD("#searchprevbuttonid").addClass(F),ZD("#searchnextbuttonid").addClass(I),ZD("#servicefilepagination").show(),ZD("#attachFileHeader").delegate("td.searchauthorsort","mouseover mouseout",function(e){"mouseover"==e.type?ATTACHDIALOG.searchMouseOver("author",b,"searchauthorsortgif",A):ATTACHDIALOG.searchMouseOut("author",b,"searchauthorsortgif")}),ZD("#attachFileHeader").delegate("td.searchtimesort","mouseover mouseout",function(e){"mouseover"==e.type?ATTACHDIALOG.searchMouseOver("time",b,"searchtimesortgif",A):ATTACHDIALOG.searchMouseOut("time",b,"searchtimesortgif")}),ZD("#attachFileHeader").delegate("td.searchauthorsort","click",function(){ATTACHDIALOG.searchSorting("author",A)}),ZD("#attachFileHeader").delegate("td.searchtimesort","click",function(){ATTACHDIALOG.searchSorting("time",A)}),ZD("#ActionsPathDiv").undelegate(),ZD("#ActionsPathDiv").delegate("div#searchprevbuttonid","click",function(){ZD(this).hasClass("zd_prev")&&ATTACHDIALOG.getSearchResults(Z,y,b,C)}),ZD("#ActionsPathDiv").delegate("div#searchnextbuttonid","click",function(){ZD(this).hasClass("zd_next")&&ATTACHDIALOG.getSearchResults(Z,G,b,C)})},ATTACHDIALOG.updateSelectedDocs=function(){for(var e=ATTACHDIALOG.getSelectedDocs(),t=0,a=e.length;a>t;t++){var i=e[t].docId;ATTACHDIALOG.selectRow(i)}},ATTACHDIALOG.getPermission=function(e){ZD("#selectedfile_"+e).length&&(ZD("#"+e).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),ZD("#"+e).children("table.data-hover").addClass("zd_select"));var t=G_OF_OBJ.docsURL+"/docs/docsrequest.do?method=getShareDetailsPermission",a="docId="+e+"&_t="+ZD.now();ZD.ajax({url:t,data:a,dataType:"text",type:"GET",success:function(e){return"success"===e.trim()?e.trim():void 0},error:function(){ZD("#"+e).addClass("opacityshare"),ZD("#"+e).find(".data-hover").hasClass("zd_select")&&ZD("#selectedfile_"+e).addClass("selectionblur")}})},ATTACHDIALOG.disableNonSharable=function(){ZD(".documentDataDiv").each(function(){G_OF_OBJ.asLink===!0?ATTACHDIALOG.getPermission(ZD(this).attr("id")):ZD(this).hasClass("opacityshare")&&(ZD(this).removeClass("opacityshare"),ZD(this).find(".data-hover").hasClass("zd_select")&&ZD("#selectedfile_"+ZD(this).attr("id")).removeClass("selectionblur"))})},ATTACHDIALOG.showStatusMsg=function(e){ZD("#msg_content").html(e),ZD("#status_msg").fadeIn(400),setTimeout(function(){ZD("#status_msg").fadeOut(400),ZD("#msg_content").html("")},4e3)},ATTACHDIALOG.setSharingTypeForSelectedUser=function(e,t){var a={};ZD("#sharefileaslinkcontainer").remove();var i='<div id="sharefileaslinkcontainer" style="display:none;"></div>';ZD("body").append(i),a.Share=function(){return ATTACHDIALOG.getAPIDetails(t,e),ZD("#sharefileaslinkcontainer").dialog("destroy").remove(),ZD("#sharefileaslinkcontainer").remove(),!1},a.Cancel=function(){return ZD("#sharefileaslinkcontainer").dialog("destroy").remove(),ZD("#sharefileaslinkcontainer").remove(),!1},ZDDialog.showCommonDialog("Share File",!0,"sharefileaslinkcontainer",a,"","550",!0,"auto",!1);var s='<div id="multi_visiblity_container"><p style="font-size: 15px;">Choose how you want the share the selected files:</p><ul id="visibilityoptions_top" class="zd_visiblity_list_container"><li class="zdl-menu zdl-brdtp" id="zd_private_visible" visible_type="private"><span class="zdl-icon"><span class="ui-icon zdc-specific"></span></span><span class="zdl-text">Recipients of this email </span><span class="zdl-shortcut">Recipients must have a Zoho account.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zd-everyone-org" id="zd_anyone_link_visible" visible_type="anyone_link"><span class="zdl-icon"><span class="ui-icon zdc-anyoneshare"></span></span><span class="zdl-text">'+orgLabel+'</span><span class="zdl-shortcut">Members within Organization who have the link can access.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zdl-brdtp" id="zd_nosignin_visible" visible_type="everyone_internet"><span class="zdl-icon"><span class="ui-icon zdc-anyoneinternet"></span></span><span class="zdl-text">Everone In Internet</span><span class="zdl-shortcut">Anyone who has the link can access. No sign-in required.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zdl-brdtp" id="zd_secure_share" visible_type="secureshare"><span class="zdl-icon"><span class="ui-icon zdc-specific"></span></span><span class="zdl-text">Share file(s) with password protection to external contacts.</span><span class="zdl-shortcut">Anyone who has the link and its password can access.</span><span class="ui-zmenu-item-placeholder"></span></li></ul></div>';return ZD("#sharefileaslinkcontainer").html(s),ATTACHDIALOG.bindEventHandlers(),ZD("#visibilityoptions_top").find("li:first").trigger("click"),!1},ATTACHDIALOG.getAPIDetails=function(e,t){for(var a="",i="",s="",o="",d="",r=ZD("#visibilityoptions_top").find("li.zdl-selection").attr("id"),n=ZD("#"+r).find(".zd-selectdiv-sib").attr("permission"),l=0;l<e.length;l++)d+=e[l].docId+",";if("zd_private_visible"===r)a=G_OF_OBJ.docsURL+"/api/v2/files/share",i=zdcsrfPair,i+="&type=private&resids="+d+"&emailids=&pergroupIds=&orggroupIds=&message=&notify=false&permission="+n+"&ischangepermission=false";else if("zd_anyone_link_visible"===r){var c=!1;a=G_OF_OBJ.docsURL+"/api/v2/files/share",c=!0,i="type=orgshare&resids="+d+"&permission="+n+"&updatepermission=false&alloweveryoneaccess="+c+"&"+zdcsrfPair}else"zd_nosignin_visible"===r?(a=G_OF_OBJ.docsURL+"/api/v2/files/share",s=ZD("#"+r).find("#zdpublic_datepicker").val(),i="type=linkshare&resids="+d+"&permission=1&expiry_date="+s.trim()+"&"+zdcsrfPair):"zd_secure_share"===r&&(a=G_OF_OBJ.docsURL+"/api/v2/files/share",s=ZD("#"+r).find("#zdsecureshare_datepicker").val(),o=ZD("#"+r).find("#zd-secureshare-pwd").val(),i="type=userpwdlink&sendpasswordinmail=false&resids="+d+"&permission="+n+"&expiry_date="+s.trim()+"&password="+o+"&isCommonLink=true&emailids=&"+zdcsrfPair);return t({apiurl:a,apiparams:i})},ATTACHDIALOG.bindEventHandlers=function(){ZD("#visibilityoptions_top").undelegate().delegate("li","click",function(e){var t=ZD(e.target),a=t.closest("li").attr("id");if(ZD("#visibilityoptions_top").find("li").removeClass("zdl-selection").css("height",""),ZD("#"+a).addClass("zdl-selection"),"zd_private_visible"===a){if(0===ZD("#"+a).find(".visibility_permission_container").length){var i='<div style="margin-top:18px;float: left;padding-left: 50px;" class="visibility_permission_container"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Set Permission:<select class="zd-private-select" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option><option permission="3">Co-Owner</option></select></div></div>';ZD("#"+a).append(i)}ATTACHDIALOG.customizeSelectElement(ZD(".zd-private-select"))}else if("zd_anyone_link_visible"===a){if(0===ZD("#"+a).find(".visibility_permission_container").length){var s='<div style="margin-top: 10px;float: left;padding-left: 50px;" class="visibility_permission_container"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Whoever accesses can:<select class="zd-org_share" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option></select></div></div>';ZD("#"+a).append(s)}ATTACHDIALOG.customizeSelectElement(ZD(".zd-org_share"))}else if("zd_nosignin_visible"===a){if(0===ZD("#"+a).find(".zd-everyone-internet").length){var o='<div class="zd-everyone-internet zdc-extwrd visibility_permission_container" style="margin-top:10px;float:left;padding-left: 50px;display:block;"><div style="margin-bottom:5px;"><span class="zdpublic_setexpirylabel"><input style="margin:0 5px 0 0;" type="checkbox" id="set_expir_date_public_web"><label for="set_expir_date_public_web"><span>Set expiry date</span></label></span><p style="display:none;" class="datepicker_public">Expires on :<input type="text" id="zdpublic_datepicker" readonly="true/"></p></div></div>';ZD("#"+a).append(o),ZD("#zdpublic_datepicker").datepicker({minDate:1}),ZD("#set_expir_date_public_web").click(function(){var e=ZD(this);e.is(":checked")?(ZD(".datepicker_public").css("display","block"),ZD("#zdpublic_datepicker").datepicker("show")):(ZD(".datepicker_public").css("display","none"),ZD("#zdpublic_datepicker").datepicker("hide"))})}}else if("zd_secure_share"===a){if(0===ZD("#"+a).find(".zd-secureshare-container").length){var d='<div class="zd-secureshare-container visibility_permission_container" style="margin-top:10px;float:left;padding-left: 50px;display:block;"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Set Permission:<select class="zd-secure-share-selectelem" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option></select></div><div style="float:left;margin-bottom:10px;" class="zd-setpassword-container"><span>Set Password:</span><input id="zd-secureshare-pwd" style="outline:none;width:200px;height: 18px;margin-left: 9px;" type="password" value=""></input></div><div style="float:left;margin: 0px 0px 10px 30px;" id="zd-send-password-email"><input id="zd-ecs-sendpass" type="checkbox" name="check" value="" class="zd-checkbox"><label for="zd-ecs-sendpass" class="zd-checkbox-clone"> Send password through email </label></div><div style="float:left;width:100%;margin-left:30px;"><div><span class="zdsecureshare_setexpirylabel"><input style="margin:0 5px 0 0;" type="checkbox" id="set_expiry_date_secureshare"><label for="set_expiry_date_secureshare"><span>Set expiry date</span></label></span><p style="display:none;" class="zd-securesharedatepicker_container">Expires on :<input type="text" id="zdsecureshare_datepicker" readonly="true/"></p></div></div></div>';ZD("#"+a).append(d),ZD("#zdsecureshare_datepicker").datepicker({minDate:1}),ZD("#set_expiry_date_secureshare").click(function(){var e=ZD(this);e.is(":checked")?(ZD(".zd-securesharedatepicker_container").css("display","block"),ZD("#zdsecureshare_datepicker").datepicker("show")):(ZD(".zd-securesharedatepicker_container").css("display","none"),ZD("#zdsecureshare_datepicker").datepicker("hide"))})}ATTACHDIALOG.customizeSelectElement(ZD(".zd-secure-share-selectelem"))}var r=ZD(".zd_visiblity_list_container").find(".visibility_permission_container");r.css("display","none"),ZD("#"+a).find(".visibility_permission_container").css("display","block")})},ATTACHDIALOG.customizeSelectElement=function(e){e.each(function(){var t=ZD(this),a=ZD(this).children("option").length,i=e.closest("li");ZD(".zd-selectsib-ulcontainer").remove();var s="";if(0===t.closest(".zd-select-wrap").length){t.wrap('<div class="zd-select-wrap"></div>');var o=i.find(".zd-select-wrap");o.append('<div class="zd-selectdiv-sib"></div>'),i.find("div.zd-selectdiv-sib").attr("permission",1).text(t.children("option").eq(0).text())}s=i.find("div.zd-selectdiv-sib");for(var d=ZD("<ul />",{"class":"zd-selectsib-ulcontainer"}).appendTo("body"),r=0;a>r;r++)ZD("<li />",{text:t.children("option").eq(r).text(),permission:t.children("option").eq(r).attr("permission"),rel:t.children("option").eq(r).val()}).appendTo(d);var n=d.children("li");s.click(function(e){var t=(i.find(".zd-selectdiv-sib").offset(),s.offset());e.stopPropagation(),d.css({position:"absolute",top:t.top+23,left:t.left,"z-index":1e7}),ZD("div.zd-selectdiv-sib.active").each(function(){ZD(this).removeClass("active"),ZD("ul.zd-selectsib-ulcontainer").hide()}),ZD(this).toggleClass("active"),ZD("ul.zd-selectsib-ulcontainer").toggle()}),n.click(function(e){e.stopPropagation(),s.text(ZD(this).text()).removeClass("active"),s.attr("permission",ZD(this).attr("permission")),d.hide()}),ZD(document).click(function(){s.removeClass("active"),d.hide()})})},function(e){e.widget("ui.attachfiledialog",{options:{recentDocs:{show:!0,name:"recentDocs",id:"recentservicedocs",action:"getDocumentsByType",iconClass:"recentdocs-icon",title:"recentDocs"},desktopDocs:{show:!0,name:"My Folders",id:"desktopservicedocs",action:"getDocumentsForFolder",fid:"folder",iconClass:"zdc-foldericon_css",title:"My Folders"},myDocs:{show:!0,name:"My Docs",id:"mydocs",action:"getDocumentsByType",fid:"folder",iconClass:"mydocs_icon",title:"My Docs"},mySheets:{show:!0,name:"My Sheets",id:"mysheets",action:"getDocumentsByType",fid:"folder",iconClass:"myspreadsheet_icon",title:"My Sheets"},myPresentations:{show:!0,name:"My Presentations",id:"mypresentations",action:"getDocumentsByType",fid:"folder",iconClass:"mypresentation_icon",title:"My Presentations"},myPictures:{show:!0,name:"My Pictures",id:"mypictures",action:"getDocumentsByType",fid:"folder",iconClass:"mypic_icon",title:"My Pictures"},sharedDocs:{show:!0,name:"Shared Docs",id:"sharedservicedocs",action:"getShareddocs",iconClass:"shareTome",title:"Shared Docs"},workspace:{show:!0,name:"Workspaces",id:"workspacelist",action:"getWorkspaces",iconClass:"zdc-ws",title:"Workspaces"},trashedDocs:{show:!0,name:"Trash",id:"trashservicedocs",action:"getTrashedDocuments",iconClass:"trash-icon",fid:"trash"},actionsButton:{showAction:!1,action:!0,id:"actionMenuOpenFile",iconClass:"action-css",value:"Actions"},homeButton:!0,upOneLevel:!1,selectedView:"recentservicedocs",lookIn:!1,advSearchBox:!1},_create:function(){this._constructFileDialog(),this._constructLeftPanel(),this._constructRightPanel(),this._initDelegate();var t=G_OF_OBJ.attachObj.height-220;e("#showattachfilespace").css({height:t})},_constructFileDialog:function(){this.mainPanel=e('<div id="mainPanelforservicefiles" style="overflow:hidden;width:100%;margin: 12px 0px;">'),this.leftPanel=e('<div class="ui-left-panel flleft" style="width:145px;" >'),this.rightPanel=e('<div class="ui-rht-datadiv">'),this.selectedFilesRow=e('<div id="showSelectedBoxDiv" class="showdiv" style="margin-bottom:2px;"><table cellpadding="0" width="100%"  cellspacing="0"><tr><td width="107" align="center" class="selectfiles"><strong>'+zd_js_obj.selected_files_list+'</strong></td><td><div id="selectboxdiv" class="selectblock zd_scroll"></div></td></tr></table></div>'),this.element.append(this.mainPanel),this.mainPanel.append(this.leftPanel),this.mainPanel.append(this.rightPanel),this.mainPanel.append(this.selectedFilesRow)},_constructLeftPanel:function(){var t=e('<table id="serviceDialogLeftPanel" width="100%"  cellpadding="0" cellspacing="0" align="center" class="mailLeftPanel"></table>');if(this.options.advSearchBox){var a='<tr><td><div id="attachfilesearchdiv" style="padding-bottom:0px;margin-top:0px;"><div class="searchdiv ui-corner-all docscursor flright"><input type="submit" class="searchIcon flleft docscursor smallText" value=""><input type="text" id="searchFileName" class="searchtext flleft" value=""><input type="hidden" value="search_all_search" name="'+zd_js_obj.label_search_all+'" id="search_type_attachfile" class=""></div><div style="height:15px;border-bottom:1px solid #efefef;margin-bottom:13px;clear:both;"></div></div></td></tr>';e(t).append(a)}else e(t).append('<tr><td><div class="ui-left-heading">'+zd_js_obj.label_favorites+"</div></td></tr>");for(var i in this.options){var s=this.options[i];s&&s.show&&e(t).append('<tr><td  class="normalView docscursor" id="'+s.id+'" action="'+s.action+'" ><span class="'+s.iconClass+' flleft margright"></span><span class="flleft" style="line-height:15px;white-space:nowrap;overflow:hidden;" title="'+s.title+'" alt="'+s.title+'">'+s.name+"</span></td></tr>")}this.leftPanel.append(t),e("#"+this.options.selectedView).removeClass("normalView").addClass("selectedView")},_constructRightPanel:function(){this.rightPaneltopContainer=e("<div>"),this.rightPanel.append(this.rightPaneltopContainer),this._constructActionsRow(),this._constructStatusMessageRow(),this.rightPanelDataContainer=e('<div id="showattachfilespace" style="background:#fff;margin: 0px 0px 0px 12px;"></div>'),this.rightPanel.append(this.rightPanelDataContainer)},_constructActionsRow:function(){var e='<div id="ActionsPathDiv" class="toolbar-menu" style="padding: 0px 0px 12px 0px; height: 21px;"><table width="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td>';this.options.homeButton&&(e+='<span title="'+zd_js_obj.docs_home+'" class="sort-menu lightbluetxt flleft margright " id="homeButton"><span class="home flleft docscursor"></span></span>'),this.options.upOneLevel&&(e+='<span title="'+zd_js_obj.up_one_level+'" class="sort-menu lightbluetxt flleft margright non-hover" id="moveUpFolder"><span class="back-folder-inactive flleft"></span></span>'),this.options.lookIn&&(e+='<span class="flright boldText" style="padding-top:5px;color:#676565;">View</span>'),e+='</td><td align="right"><div id="servicefilepagination"  style="float:right; z-index:1000;padding-right:2px;display:none;"></div></td>',e+='<td><div id="openloadingmsg"></div></td></tr></table></div>',this.rightPaneltopContainer.append(e)},_constructStatusMessageRow:function(){this.rightPaneltopContainer.append('<div class="hidediv attach_message" style="display:none;"><span id="zd_statusmsgdiv"></span></div>')},_initDelegate:function(){G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),e("#serviceDialogLeftPanel").delegate("td.docscursor","click",function(){G_OF_OBJ.folderpermission="",G_OF_OBJ.searchenabled=!1,ATTACHDIALOG.getDocAsList(this)}),e("#showattachfilespace").delegate("div.folderDataDiv","click",function(t){var a=e(t.target);if("renameinputform"==a.attr("id"))return!1;ATTACHDIALOG.reset();var i=e(this).attr("folderId");void 0==i&&(i=-1),void 0!==e(this).attr("permission")&&(G_OF_OBJ.folderpermission=e(this).attr("permission"));var s=e(this).attr("pntFolderId"),o=e(this).attr("wsid");e("#servicefilepagination").show(),e("#showattachfilespace").css("display","block"),G_OF_OBJ.parentFolderId=s,G_OF_OBJ.folderId=i,G_OF_OBJ.wsId=o,ATTACHDIALOG.getDocAsList()}),e("#showattachfilespace").delegate("table.data-hover","click",function(t){var a=e(t.target);(a.hasClass("selectcheckboxicon_css")||a.hasClass("normalcheckboxicon_css")||a.is("td")||a.is("span"))&&ATTACHDIALOG.showSelectedDocsToAttach(this)}),e("div#selectboxdiv").delegate("span.closeBtn_css","click",function(){var t=e(this).parent().attr("docId");ATTACHDIALOG.deselectRow(t)}),e("div#servicefilepagination").delegate("div#prevbuttonid,div#nextbuttonid","click",function(){var t=e(this).attr("id");"prevbuttonid"==t?action="previousPage":"nextbuttonid"==t&&(action="nextPage"),e("#showattachfilespace").attachfiledatagrid(action)}),e("#showattachfilespace").delegate("td#nameHeader,td#dateModifiedHeader","click",function(){(e(this).find("img#_sortname").length||e(this).find("img#_sortdate").length)&&(e("div#servicefilepagination").hide(),ATTACHDIALOG.setSortOrder(this),ATTACHDIALOG.resetAll(),e("#desktopservicedocs").hasClass("selectedView")?G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId:e("#workspacelist").hasClass("selectedView")&&(G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId),ATTACHDIALOG.getSortDocAsList("",G_OF_OBJ.selectedLeftPanel),ATTACHDIALOG.setClassAfterSorting(this))}),e("#homeButton").bind("click",function(){G_OF_OBJ.folderpermission="",G_OF_OBJ.searchenabled=!1;var e="";ATTACHDIALOG.getDocAsList(e,"recentservicedocs")}),e("div#attachfilesearchdiv").delegate("input#searchFileName","focusin focusout keypress",function(t){if("focusin"==t.type)e("input#searchFileName").val(""),e("input#search_type_attachfile").addClass("searchquery");else if("focusout"==t.type)""==e("input#searchFileName").val()&&(e("input#searchFileName").val(e("input#search_type_attachfile").attr("name")),e("input#search_type_attachfile").removeClass("searchquery"));else if("keypress"==t.type&&"13"==t.keyCode){G_OF_OBJ.searchenabled=!0,G_OF_OBJ.folderpermission="";var a=e("input#searchFileName").val();ATTACHDIALOG.searchFile(a)}}),e("div#attachfilesearchdiv").delegate("input.searchIcon","click",function(){var t=e("input#searchFileName").val(),a=e("input#search_type_attachfile").attr("class");return""==t||null==t||"searchquery"!=a?(ATTACHDIALOG.statusmsg("failure_status boldText","Enter valid text to search"),void e("input#searchFileName").val(e("input#search_type_attachfile").attr("name"))):(G_OF_OBJ.folderpermission="",G_OF_OBj.searchenabled=!0,void ATTACHDIALOG.searchFile(t))}),e("#moveUpFolder").delegate(".back-folder","click",function(){G_OF_OBJ.folderpermission="",e("#desktopservicedocs").hasClass("selectedView")?(ATTACHDIALOG.changeAllToNormalView("desktopservicedocs"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList()):e("#sharedservicedocs").hasClass("selectedView")?(ATTACHDIALOG.changeAllToNormalView("sharedservicedocs"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.folderId="0"===G_OF_OBJ.parentFolderId||"1"===G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList()):e("#workspacelist").hasClass("selectedView")&&(ATTACHDIALOG.changeAllToNormalView("workspacelist"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.parentFolderId==G_OF_OBJ.wsId||"-1"==G_OF_OBJ.parentFolderId?(G_OF_OBJ.folderId="wshome",G_OF_OBJ.wsId="wshome"):G_OF_OBJ.folderId=G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList())})},destroy:function(){e.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName);var t=this.element,a=e(t).children();e(a).each(function(t,a){e(a).undelegate(),e(a).empty().remove()})}}),e.extend(e.ui.filedialog,{version:"1.8"})}(jQuery),function(e){e.widget("ui.attachfiledatagrid",{defaults:{documentNameHeader:!0,lastModifiedTimeHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,authorName:!1,lastModifiedTime:!0},_create:function(){this.options=e.extend({},this.defaults,this.options),this._constructHeader(),this.sendAjaxRequest(),this.resize()},resetOptions:function(){this.options.documentNameHeader=!0,this.options.lastModifiedTimeHeader=!0,this.options.documentIcon=!0,this.options.documentName=!0,this.options.authorName=!1,this.options.lastModifiedTime=!0},populateDataPanel:function(t){this.options=e.extend(this.options,this.defaults);for(var a in t)this.options[a]=t[a];this.clearData(),this._constructHeader(),this.sendAjaxRequest(),this.resize(),G_OF_OBJ.bottomLevelFetch=50},clearData:function(){var t=this.element,a=e(t).children();e(a).each(function(t,a){e(a).empty().remove()})},_constructHeader:function(){var e='<div id="docsHeaderTab"><table  id="table1" width="100%" cellpadding="0" cellspacing="0" border="0" class="docs-tableheader" align="center"><tr>';this.options.documentNameHeader&&(e+='<td width="20">&nbsp;</td><td id="nameHeader" height="23" nowrap="nowrap" align="left" class="docscursor sortfield namesortTd pad-lft" sortfield="name">'+zd_js_obj.name+'<img id="_sortname" src="'+G_OF_OBJ.spacerImagePath+'" class="" style="margin-left:2px;"></td>'),this.options.authorName&&(e+='<td width="20">&nbsp;</td><td id="authorHeader" width="110" nowrap="nowrap" align="left" class="docscursor sortfield authorsortTd pad-lft" sortfield="author"><span class="zd_divider">|</span>'+zd_js_obj.author+"</td>"),this.options.lastModifiedTimeHeader&&(e+='<td id="dateModifiedHeader" width="130" nowrap="nowrap" class="docscursor sortfield datesortTd" sortfield="date"><span class="zd_divider">|</span>'+zd_js_obj.date_modified+'<img id="_sortdate" src="'+G_OF_OBJ.spacerImagePath+'" style="margin-left: 2px;" class="DownArrow"></td>'),e+='</tr></table></div><div id="attachFileDataDiv" style="overflow:auto;vertical-align:top;border:0px solid #000000;">',this.element.append(e)},sendAjaxRequest:function(){ATTACHDIALOG.LoadingMsg(zd_js_obj.loading);var t=this._constructURLParameters();e.ajax({url:t,xhrFields:{withCredentials:!0},type:"GET",dataType:"json",success:function(t,a){return"success"==a?(G_OF_OBJ.jsonData=t,e("div#showattachfilespace").attachfiledatagrid("constructDocumentRows"),ATTACHDIALOG.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs(),(e("#recentservicedocs").hasClass("selectedView")||e("#workspacelist").hasClass("selectedView")&&"wshome"==G_OF_OBJ.wsId)&&(e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove()),G_OF_OBJ.moveUpFolder=!1,!1):void 0}})},_constructURLParameters:function(){var t="",a="",i=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id");return"workspacelist"!=i?(t="method="+e("#"+i).attr("action")+"&fromIndex="+G_OF_OBJ.startFrom+"&noOfDocuments="+G_OF_OBJ.fetchLimit,e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),"recentservicedocs"!=i&&(t+="&sortorder="+G_OF_OBJ.sortOrder+"&orderby="+G_OF_OBJ.orderBy),"desktopservicedocs"==i&&(t+="&fid="+G_OF_OBJ.folderId,"folder"!=G_OF_OBJ.folderId&&e("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),"sharedservicedocs"===i&&("folder"===G_OF_OBJ.folderId&&(G_OF_OBJ.folderId="-1"),t+="&folderid="+G_OF_OBJ.folderId,"folder"!==G_OF_OBJ.folderId&&e("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),"trashservicedocs"==i&&(t+="&fid=trash"),G_OF_OBJ.moveUpFolder&&"folder"!=G_OF_OBJ.folderId&&(t+="&isParentFolderDocs=true"),"recentservicedocs"==i?t+="&type=myrecentdocs":"mydocs"==i?t+="&type=mydocs":"mypresentations"==i?t+="&type=mypresentations":"mysheets"==i?t+="&type=myspreadsheets":"mypictures"==i&&(t+="&type=mypictures")):(e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),t="method="+e("#"+i).attr("action"),"wshome"!=G_OF_OBJ.folderId&&(t+="&fromIndex="+G_OF_OBJ.startFrom+"&noOfDocuments="+G_OF_OBJ.fetchLimit,t+="&sortorder="+G_OF_OBJ.sortOrder+"&orderby="+G_OF_OBJ.orderBy,t+="&fid="+G_OF_OBJ.folderId,t+="&wsid="+G_OF_OBJ.wsId,t+="&type=getwsdocs",G_OF_OBJ.moveUpFolder&&"wshome"!=G_OF_OBJ.folderId&&(t+="&isParentFolderDocs=true")),"wshome"!=G_OF_OBJ.folderId&&e("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),t+="&_t="+(new Date).getTime(),a=G_OF_OBJ.docsURL+"/docs/attachfilerequest.do?"+t},constructDocumentRows:function(){var t="";this.containerDiv=e("div#attachFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():(this.containerDiv.empty(),this.containerDiv.find(".documentDataDiv").remove());var a=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id");if("desktopservicedocs"===a||"sharedservicedocs"===a){if(0==G_OF_OBJ.jsonData.FOLDER.length&&0==G_OF_OBJ.jsonData.DOC.length)return this.noDocuments=e("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.label_no_items_are_present+"</div></td></tr></table>",e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove(),void this.noDocuments.append(t)}else if("workspacelist"==a){if(void 0!=G_OF_OBJ.jsonData.WORKSPACE&&0==G_OF_OBJ.jsonData.WORKSPACE.length)return this.noDocuments=e("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.no_workspace+"</div></td></tr></table>",void this.noDocuments.append(t);if(void 0!=G_OF_OBJ.jsonData.DOC&&0==G_OF_OBJ.jsonData.DOC.length&&void 0!=G_OF_OBJ.jsonData.FOLDER&&0==G_OF_OBJ.jsonData.FOLDER.length)return this.noDocuments=e("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.dashboard_msg_no_documents+"</div></td></tr></table>",e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove(),void this.noDocuments.append(t)}else if(0==G_OF_OBJ.jsonData.DOC.length)return this.noDocuments=e("div#attachFileDataDiv"),t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.dashboard_msg_no_documents+"</div></td></tr></table>",e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove(),void this.noDocuments.append(t);void 0!==G_OF_OBJ.jsonData.FOLDER&&G_OF_OBJ.jsonData.FOLDER.length>0&&1===Math.abs(G_OF_OBJ.prevIndex)&&("desktopservicedocs"===a||"workspacelist"===a||"sharedservicedocs"===a)?this._constructFolderInfoRows():G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,void 0!=G_OF_OBJ.jsonData.WORKSPACE&&G_OF_OBJ.jsonData.WORKSPACE.length>0&&1==Math.abs(G_OF_OBJ.prevIndex)&&"workspacelist"==a&&this._constructWSInfoRows(),void 0!=G_OF_OBJ.jsonData.DOC&&G_OF_OBJ.jsonData.DOC.length>0&&(G_OF_OBJ.totalFiles=e("#recentservicedocs").hasClass("selectedView")?G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.jsonData.TOTALDOCS[0].NOOFDOCS,this._constructPaginationData(),this._constructDocInfoRows()),"folder"==G_OF_OBJ.folderId&&e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft")},_constructDocInfoRows:function(){var t="";t=G_OF_OBJ.endIndex>G_OF_OBJ.jsonData.DOC.length?G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.endIndex,this.containerDiv=e("div#attachFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():this.containerDiv.find(".documentDataDiv").remove();for(var a=(e("div.selectbox","div#selectboxdiv"),G_OF_OBJ.fromIndex);t>a;a++){var i=this.options.checkboxIcon,s=ATTACHDIALOG.checkSelectedFiles(G_OF_OBJ.jsonData.DOC[a].DOCID);s&&(i="flleft selectcheckboxicon_css");var o=e("<div>").addClass("documentDataDiv").attr({id:G_OF_OBJ.jsonData.DOC[a].DOCID,fileName:G_OF_OBJ.jsonData.DOC[a].DOCNAME,serviceType:G_OF_OBJ.jsonData.DOC[a].SERVICE_TYPE,isDocumentSharedToMe:!1}).data({serviceType:G_OF_OBJ.jsonData.DOC[a].SERVICE_TYPE,cssName:G_OF_OBJ.jsonData.DOC[a].CLASSNAME,encAttrFileName:G_OF_OBJ.jsonData.DOC[a].ENCATTR_DOCNAME,fileName:G_OF_OBJ.jsonData.DOC[a].DOCNAME,isDocumentSharedToMe:!1,isTemplates:!1,permission:G_OF_OBJ.jsonData.DOC[a].PERMISSION,scope:G_OF_OBJ.jsonData.DOC[a].SCOPE}),d=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="'+this.options.hoverclass+'">'),r=e("<tr>"),n=e('<td colspan="4" nowrap="nowrap" width="100%">'),l=G_OF_OBJ.jsonData.DOC[a].ENCATTR_DOCNAME,c=G_OF_OBJ.jsonData.DOC[a].ENC_DOCNAME;c=ZDUtils.substringName(c,"40");var p='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(p+='<td width="20" height="20" nowrap="nowrap" class="docscursor checkboxtd" elem="checkbox" ><img src="'+G_OF_OBJ.spacerImagePath+'" class="'+i+'"/></td>'),this.options.documentIcon&&(p+='<td width="20" nowrap="nowrap" elem="documenticon"><div class="'+G_OF_OBJ.jsonData.DOC[a].CLASSNAME+' flleft docscursor"></div></td>'),this.options.documentName&&(p+='<td nowrap="nowrap" align="left" elem="documentname">&nbsp;<span id="fileNameSpan_'+G_OF_OBJ.jsonData.DOC[a].DOCID+'" docId="'+G_OF_OBJ.jsonData.DOC[a].DOCID+'" service="'+G_OF_OBJ.jsonData.DOC[a].SERVICE_TYPE+'" docName="'+l+'" title="'+l+'" class="docscursor">'+c+"</span></td>"),this.options.authorName&&(p+='<td width="110" class="zdtext-truncate" title="'+G_OF_OBJ.jsonData.DOC[a].ENCATTR_AUTHOR_NAME+'" nowrap="nowrap" align="left" elem="authorname">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.DOC[a].ENCATTR_AUTHOR_NAME+"</span></a></td>"),this.options.lastModifiedTime&&(p+='<td width="100" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.DOC[a].LAST_MODIFIEDTIME+"</span></a></td>"),p+="</tr></table>",n.append(p),r.append(n),d.append(r),o.append(d),this.containerDiv.append(o),1===G_OF_OBJ.jsonData.DOC[a].SCOPE&&3!==G_OF_OBJ.jsonData.DOC[a].PERMISSION&&(G_OF_OBJ.jsonData.DOC[a].PERMISSION=""!==G_OF_OBJ.folderpermission?Number(G_OF_OBJ.folderpermission):2),G_OF_OBJ.asLink===!0&&void 0!==G_OF_OBJ.jsonData.DOC[a].PERMISSION&&3!==G_OF_OBJ.jsonData.DOC[a].PERMISSION&&0!==G_OF_OBJ.jsonData.DOC[a].PERMISSION&&(e("#"+G_OF_OBJ.jsonData.DOC[a].DOCID).addClass("opacityshare"),e("#selectedfile_"+G_OF_OBJ.jsonData.DOC[a].DOCID).addClass("selectionblur"))}},_constructFolderInfoRows:function(){for(var t=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id"),a=0,i=G_OF_OBJ.jsonData.FOLDER.length;i>a;a++){"desktopservicedocs"==t?(G_OF_OBJ.parentFolderId!=G_OF_OBJ.jsonData.FOLDER[a].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[a].PARENTFOLDERID),("1"==G_OF_OBJ.parentFolderId||"0"==G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")):"sharedservicedocs"===t?(G_OF_OBJ.parentFolderId!==G_OF_OBJ.jsonData.FOLDER[a].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[a].PARENTFOLDERID),("1"===G_OF_OBJ.parentFolderId||"0"===G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")):"workspacelist"==t&&(G_OF_OBJ.parentFolderId!=G_OF_OBJ.jsonData.FOLDER[a].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[a].PARENTFOLDERID),("1"==G_OF_OBJ.parentFolderId||"0"==G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")),this.folderDataDiv=e("div#attachFileDataDiv");var s=e("<div>").addClass("folderDataDiv").attr({id:G_OF_OBJ.jsonData.FOLDER[a].FOLDERID,permission:G_OF_OBJ.jsonData.FOLDER[a].PERMISSION,folderId:G_OF_OBJ.jsonData.FOLDER[a].FOLDERID,pntFolderId:G_OF_OBJ.jsonData.FOLDER[a].PARENTFOLDERID,wsid:G_OF_OBJ.jsonData.FOLDER[a].WORKSPACEID}).data({folderName:G_OF_OBJ.jsonData.FOLDER[a].ENCATTR_FOLDERNAME}),o=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="folderDiv">'),d=e("<tr>"),r=e("<td>"),n=ZDUtils.substringName(G_OF_OBJ.jsonData.FOLDER[a].ENCATTR_FOLDERNAME,"40"),l='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(l+='<td width="20" height="20" nowrap="nowrap" class="checkboxtd" elem="checkbox" ><img src="'+G_OF_OBJ.spacerImagePath+'" class="'+this.options.checkboxIcon+'" style="opacity:0.3;"/></td>'),this.options.documentIcon&&(l+='<td style="width:20px;" nowrap="nowrap"><div class="zdc-foldericon_css">&nbsp;</div></td>'),this.options.documentName&&(l+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_OF_OBJ.jsonData.FOLDER[a].ENCATTR_FOLDERNAME+'"><a style="padding-left:6px;">'+n+"</a></td>"),this.options.authorName&&(l+='<td width="110" class="zdtext-truncate" title="'+G_OF_OBJ.jsonData.FOLDER[a].ENCATTR_AUTHOR_NAME+'" nowrap="nowrap" align="left" elem="authorname">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.FOLDER[a].ENCATTR_AUTHOR_NAME+'</span></a></td><td width="100" nowrap="nowrap" ></td>'),l+="</tr></table>",r.append(l),d.append(r),o.append(d),s.append(o),this.folderDataDiv.append(s)}},_constructWSInfoRows:function(){for(var t=0,a=G_OF_OBJ.jsonData.WORKSPACE.length;a>t;t++){this.wsDataDiv=e("div#attachFileDataDiv");var i=e("<div>").addClass("folderDataDiv").attr({id:G_OF_OBJ.jsonData.WORKSPAwswsID,wsid:G_OF_OBJ.jsonData.WORKSPACE[t].wsID,pntFolderId:G_OF_OBJ.jsonData.WORKSPACE[t].PARENTFOLDERID}).data({wsName:G_OF_OBJ.jsonData.WORKSPACE[t].wsName}),s=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="workspaceDiv">'),o=e("<tr>"),d=e("<td>"),r=ZDUtils.substringName(G_OF_OBJ.jsonData.WORKSPACE[t].wsName,"40"),n='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(n+='<td style="width:20px" height="20"></td>'),this.options.documentIcon&&(n+="userws"==G_OF_OBJ.jsonData.WORKSPACE[t].type?'<td style="width:20px;" nowrap="nowrap"><div class="zdc-ws">&nbsp;</div></td>':'<td style="width:20px;" nowrap="nowrap"><div class="zdc-sharedws">&nbsp;</div></td>'),this.options.documentName&&(n+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_OF_OBJ.jsonData.WORKSPACE[t].wsName+'"><a style="padding-left:6px;">'+r+"</a></td>"),n+="</tr></table>",d.append(n),o.append(d),s.append(o),i.append(s),this.wsDataDiv.append(i)}},_constructPaginationData:function(){var t="";G_OF_OBJ.totalFiles>0&&(t='<table cellspacing="0" cellpadding="0" border="0" ><tr><td nowrap="nowrap" id="pagestatusid" class="pagecount smallText"></td><td><div id="prevbuttonid"  class="prevActive">&nbsp;</div></td><td><div id="nextbuttonid"  class="nextActive">&nbsp;</div></td></tr></table>',e("#servicefilepagination").html(t),G_OF_OBJ.nextIndex>=G_OF_OBJ.totalFiles&&(G_OF_OBJ.nextIndex=G_OF_OBJ.totalFiles,e("#prevbuttonid").removeClass().addClass("prevActive"),e("#nextbuttonid").removeClass().addClass("nextDis")),1==G_OF_OBJ.prevIndex&&e("#prevbuttonid").removeClass().addClass("preDis"),e("#pagestatusid").text(G_OF_OBJ.prevIndex+" - "+G_OF_OBJ.nextIndex+" "+zd_js_obj.of+" "+G_OF_OBJ.totalFiles),e("#servicefilepagination").show())},previousPage:function(){e("#prevbuttonid","#servicefilepagination").hasClass("preDis")||(G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.prevIndex)-Math.abs(1),G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)-(Math.abs(G_OF_OBJ.docsPerPage)-Math.abs(1)),G_OF_OBJ.prevIndex<G_OF_OBJ.topLevelFetch?(G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.prevIndex),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.topLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit)-Math.abs(1),G_OF_OBJ.endIndex="10",G_OF_OBJ.fromIndex="0",G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,e("div#showattachfilespace").attachfiledatagrid("sendAjaxRequest")):G_OF_OBJ.prevIndex<=G_OF_OBJ.bottomLevelFetch&&(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.fromIndex)-Math.abs(10),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)-Math.abs(10),e("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")),ATTACHDIALOG.hideLoadingMsg())},nextPage:function(){return e("#nextbuttonid","#servicefilepagination").hasClass("nextDis")?!1:(G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(1),G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(G_OF_OBJ.docsPerPage),G_OF_OBJ.nextIndex<=G_OF_OBJ.bottomLevelFetch?(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.endIndex),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)+Math.abs(G_OF_OBJ.docsPerPage),e("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")):(G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(1),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit),G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,e("div#showattachfilespace").attachfiledatagrid("sendAjaxRequest")),void ATTACHDIALOG.hideLoadingMsg())},resize:function(){e("#attachFileDataDiv").css({height:this.element.height()-30})},destroy:function(){e.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName);var t=this.element,a=e(t).children();e(a).each(function(t,a){e(a).undelegate(),e(a).empty().remove()})}}),e.extend(e.ui.attachfiledatagrid,{version:"1.8"})}(jQuery);var G_ADDDOCS_OBJ;ADDDOCDIALOG.showAddDocDialog=function(e,t){var a=e.docsURL;if(void 0==zd_js_obj||""==zd_js_obj){G_ADDDOCS_OBJ=new ADDDOCDIALOG;var i=function(){ADDDOCDIALOG.showAddDocDialog(e)};return ATTACHDIALOG.getI18N(i,a),!1}if(zd_isIE&&(t=!1),void 0===t||""===t){var s=function(t){ADDDOCDIALOG.showAddDocDialog(e,t)};return ADDDOCDIALOG.checkWorkspaceStatus(s,a),!1}if(!ZD("#adddocdialogdiv").length){void 0==G_ADDDOCS_OBJ&&(G_ADDDOCS_OBJ=new ADDDOCDIALOG),G_ADDDOCS_OBJ.docsURL=a,G_ADDDOCS_OBJ.adddocObj=ZD.extend({},G_ADDDOCS_OBJ.defaultObj,e),G_ADDDOCS_OBJ.urlInvoker=G_ADDDOCS_OBJ.adddocObj.servicename,G_ADDDOCS_OBJ.filename=G_ADDDOCS_OBJ.adddocObj.filename;{var o=G_ADDDOCS_OBJ.adddocObj.positionObj,d=G_ADDDOCS_OBJ.adddocObj.isDraggable;G_ADDDOCS_OBJ.adddocObj.isResize}ZD("body").append('<div id="adddocdialogdiv" style="display:none;">');var r={};r[zd_js_obj.add]=function(){ADDDOCDIALOG.addDocToZDocs()},r[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("adddocdialogdiv")},"zmail"===e.servicename&&e.isNewUI===!0?ADDDOCDIALOG.constructDialogMail(t,ZD("#"+e.containerDiv)):(ZDDialog.showCommonDialog(zd_js_obj.label_add_to_zoho_docs,!0,"adddocdialogdiv",r,o,400,d,"auto",!1),ZD("#adddocdialogdiv").addClass("custommargin_lightgrey dottedborder"),ADDDOCDIALOG.constructDialogContent(t))}},ADDDOCDIALOG.constructDialogMail=function(e,t){ZD("#adddocdialogdiv").remove(),t.append('<div id="adddocdialogdiv"></div>'),ZD("#adddocdialogdiv").addClass("custommargin_lightgrey dottedborder docsdialog"),ZD(".docsdialog").css("width","100%"),ZD(".docsdialog").css("height","auto"),ZD("#adddocdialogdiv").css({width:"100%",height:"100%"}),"undefined"!=typeof e&&0==e?(ZD("#adddocdialogdiv").append('<div id="leftpanel_addtozd" style="width:15%;"><div id="personal_folder" class="docscursor selectedView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\'><span class="zdc-foldericon_css flleft margright"> </span><span>'+zd_js_obj.label_personal_folder+'</span></div><div id="shared_folder" class="docscursor normalView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\' style="margin-top:2px;"><span class="shareTome flleft margright"></span><span>Shared Folders</span></div></div>'),ZD("#adddocdialogdiv").append('<div style="width:81%;" id="rightpanel_addtozd"></div>')):(ZD("#adddocdialogdiv").append('<div id="leftpanel_addtozd" style="width:15%;"><div id="personal_folder" class="docscursor selectedView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\'><span class="zdc-foldericon_css  flleft margright"> </span><span>'+zd_js_obj.label_personal_folder+'</span></div><div id="shared_folder" class="docscursor normalView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\' style="margin-top:2px;"><span class="shareTome flleft margright"></span><span>Shared Folders</span></div><div id="ws_folder" class="docscursor normalView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\'><span class="zdc-ws flleft margright"></span><span>'+zd_js_obj.label_workspaces+"</span></div></div>"),ZD("#adddocdialogdiv").append('<div style="width:81%;" id="rightpanel_addtozd"></div>')),ZD("#rightpanel_addtozd").append('<div id="path_display"><span title="Home" class="sort-menu lightbluetxt flleft margright " id="homeButton" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail();\'><span class="home flleft docscursor"></span></span><span title="Up one level" class="sort-menu lightbluetxt flleft margright non-hover" id="moveUpFolder" onclick=\'ADDDOCDIALOG.moveUpFolder();\'><span class="flleft back-folder-inactive"></span></span></div>'),ZD("#rightpanel_addtozd").append('<div id="folder_header"><button type="button" id="createFileBtn" style="width:45px;" class="docscursor" onclick=\'ADDDOCDIALOG.createNewFolderDiv();\'><span class="flleft createfolder" style="margin-left: 6px;"></span></button></div>'),ZD("#rightpanel_addtozd").append('<div id="folder_container"></div>'),ADDDOCDIALOG.sendAjaxReqForMail(),ZD(".docsdialog").find(".createfolder").css({"background-position":"-115px -492px",width:"18px"}),ZD("#adddocdialogdiv").append('<div id="bottompanel_addtozd" >'+zd_js_obj.label_saveas+' <input type="text" name="filenamecontainer" id="filenamecontainer"></div>'),ZD("#filenamecontainer").val(G_ADDDOCS_OBJ.filename),ZD("#filenamecontainer").focusin(function(){ZD(this).css("background-color","#F0F0F0"),ADDDOCDIALOG.editFileName()}),ZD("#filenamecontainer").focusout(function(){ZD(this).css("background-color","#FFFFFF"),ADDDOCDIALOG.setFileName()}),""!=G_ADDDOCS_OBJ.adddocObj.callback&&G_ADDDOCS_OBJ.adddocObj.callback()},ADDDOCDIALOG.editFileName=function(){var e=ZD("#filenamecontainer").val(),t="",a="",i="";e.indexOf(".")>=0&&(a=e.split(".")),t=a[a.length-1],G_ADDDOCS_OBJ.fileext=t;for(var s=0;s<a.length-1;s++)i+=a[s];ZD("#filenamecontainer").val(""),ZD("#filenamecontainer").val(i)},ADDDOCDIALOG.setFileName=function(){var e=ZD("#filenamecontainer").val(),t="";""!=e?(t=e+"."+G_ADDDOCS_OBJ.fileext,ZD("#filenamecontainer").val(t),G_ADDDOCS_OBJ.filename=ZD("#filenamecontainer").val()):ZD("#filenamecontainer").val(G_ADDDOCS_OBJ.filename)},ADDDOCDIALOG.sendAjaxReqForMail=function(e){var t=$(e).attr("id");if(G_ADDDOCS_OBJ.issharedws=!1,G_ADDDOCS_OBJ.foldertree=[],!ZD("#"+t).hasClass("selectedView")){ZD("#personal_folder").removeClass("selectedView").addClass("normalView"),ZD("#shared_folder").removeClass("selectedView").addClass("normalView"),ZD("#ws_folder").removeClass("selectedView").addClass("normalView");var a="",i="";void 0===e&&(t="personal_folder"),G_ADDDOCS_OBJ.parentId=[],G_ADDDOCS_OBJ.foldertree=[],ZD("#"+t).removeClass("normalView").addClass("selectedView"),ZD("#folderparent").empty(),ZD("#moveUpFolder").children("span").removeClass("back-folder").addClass("back-folder-inactive"),G_ADDDOCS_OBJ.rootvalue=t,"personal_folder"==t?(ZD("#createFileBtn").css("display","block"),a=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",i="type=foldertree&folderid=-1&"+zdcsrfPair+"&crossdomain=true"):"shared_folder"===t?(ZD("#createFileBtn").css("display","none"),a=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",i="type=sharedfoldertree&folderid=-1&"+zdcsrfPair+"&crossdomain=true"):"ws_folder"===t&&(ZD("#createFileBtn").css("display","none"),a=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/workspaces",i=zdcsrfPair+"&crossdomain=true"),ZD.ajax({url:a,data:i,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(e,a){return"success"==a?(ADDDOCDIALOG.constructList(t,e),ZDUtils.hideLoadingMsg(),!1):void 0}})}},ADDDOCDIALOG.constructList=function(e,t){var a=t;ZD("#folder_container").append('<table id="folderList"></table>'),ZD("#folderList").empty(),"personal_folder"===e?ZD.each(a.folders,function(e,t){ZD("#folderList").append('<tr><td width=30px><div class="zdc-foldericon_css docscursor folderdocs"> </div></td><td class="docscursor" id="'+t.res_id+'" onclick=\'ADDDOCDIALOG.constructSubList(this,"'+t.parent_folder_id+"\");'>"+t.enc_res_name+"</td></tr>"),ZD("#"+t.res_id).data("zd_folderobj",t)}):"shared_folder"===e?ZD.each(a,function(e,t){1!==t.PERMISSION&&(ZD("#folderList").append('<tr><td width=30px><div class="zdc-foldericon_css docscursor folderdocs"> </div></td><td class="docscursor" id="'+t.FOLDERID+'" onclick=\'ADDDOCDIALOG.constructSubList(this,"'+t.PARENTFOLDERID+"\");'>"+t.ENC_FOLDERNAME+"</td></tr>"),ZD("#"+t.FOLDERID).data("zd_folderobj",t))}):"ws_folder"===e&&(void 0===a.workspaces?ZD.each(a.folders,function(e,t){void 0!==t.res_id&&(ZD("#folderList").append('<tr><td width=30px><div class="zdc-foldericon_css docscursor folderdocs"> </div></td><td class="docscursor" id="'+t.res_id+'" onclick=\'ADDDOCDIALOG.constructSubList(this,"'+t.parent_folder_id+"\");'>"+t.enc_res_name+"</td></tr>"),ZD("#"+t.res_id).data("zd_folderobj",t))}):ZD.each(a.workspaces,function(e,t){void 0!==t.res_id&&(ZD("#folderList").append('<tr><td width=30px><div class="zdc-ws docscursor folderdocs"> </div></td><td class="docscursor" id="'+t.res_id+"\" onclick='ADDDOCDIALOG.constructSubList(this,1);'>"+t.enc_res_name+"</td></tr>"),ZD("#"+t.res_id).data("zd_folderobj",t))})),""==ZD("#folderList").html()&&ZD("#folderList").append('<center style=" padding-left: 200px;padding-top: 150px;">---- '+zd_js_obj.label_no_items_are_present+" ----</center>")},ADDDOCDIALOG.constructSubList=function(e,t){var a=$(e).attr("id");ZD("#moveUpFolder").children("span").removeClass("back-folder-inactive").addClass("back-folder"),G_ADDDOCS_OBJ.parentId.push(t);var i=ZD("#"+a).data("zd_folderobj");G_ADDDOCS_OBJ.foldertree.push(i),"ws_folder"===G_ADDDOCS_OBJ.rootvalue&&void 0!==G_ADDDOCS_OBJ.foldertree[0].type&&"shared"===G_ADDDOCS_OBJ.foldertree[0].type&&(G_ADDDOCS_OBJ.issharedws=!0);var s="",o="";"personal_folder"===G_ADDDOCS_OBJ.rootvalue?(s=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",o="type=foldertree&folderid="+a+"&"+zdcsrfPair+"&crossdomain=true"):"shared_folder"===G_ADDDOCS_OBJ.rootvalue?(G_ADDDOCS_OBJ.permission.push(i.PERMISSION),G_ADDDOCS_OBJ.folderlevel.push(i.FOLDER_LEVEL),s=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",o="type=sharedfoldertree&permission="+i.PERMISSION+"&parentfolderlevel="+i.FOLDER_LEVEL+"&folderid="+a+"&"+zdcsrfPair+"&crossdomain=true"):"ws_folder"===G_ADDDOCS_OBJ.rootvalue&&(s=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",o="type=wsfoldertree&folderid="+a+"&"+zdcsrfPair+"&crossdomain=true"),ZD.ajax({url:s,data:o,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(e,t){return"success"==t?(ADDDOCDIALOG.constructList(G_ADDDOCS_OBJ.rootvalue,e),ZDUtils.hideLoadingMsg(),!1):void 0}})},ADDDOCDIALOG.createNewFolderDiv=function(){ZD("#newFolderCreator").remove(),ZD("body").append('<div id="newFolderCreator" class="ui-draggable docsdialog"><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable ui-dialog-buttons docsdialog" tabindex="-1" style="outline: 0px; z-index: 10004; height: auto; width: 400px; top: 41px; left: 483px; display: block;" role="dialog" aria-labelledby="ui-id-3"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-3" class="ui-dialog-title">New Folder</span><a href="#" class="ui-dialog-titlebar-close ui-corner-all" id="closeImg" role="button"><span class="ui-icon ui-icon-closethick">close</span></a></div><div id="dialogviewdiv" class="ui-dialog-content ui-widget-content" scrolltop="0" scrollleft="0" style="width: auto; min-height: 0px; height: auto;"><div style="width:auto;padding-top:35px"><div id="folderlabel" style="margin-top: -25px;">Please Enter Folder Name</div><input type="text" id="createfolderinput"  style="width: 95%;margin-top: 12px;"></div></div> <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-widget ui-corner-all ui-button-text-only ui-zbutton-priority ui-button ui-state-default" id="createFolderBtn" role="button" aria-disabled="false"><span class="ui-button-text">Create</span></button><button type="button" class="ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" id="closeBtn" role="button" aria-disabled="false"><span class="ui-button-text">Cancel</span></button></div></div></div></div>'),ZD("#createfolderinput").focus(),ZD("#newFolderCreator").draggable(),ZD("#createFolderBtn").click(function(){var e=encodeURIComponent(ZD("#createfolderinput").val());if(e.length>=100)alert(zd_js_obj.folder_validation_max_100_characters),ZD("#createfolderinput").val(""),ZD("#createfolderinput").focus();else if(""!=e){var t=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/create",a="name="+e+"&parentfolderid=-1&"+zdcsrfPair+"&crossdomain=true";ZD.ajax({url:t,type:"POST",data:a,xhrFields:{withCredentials:!0},success:function(e,t){return"success"==t?(ADDDOCDIALOG.showFolderCreationStatus(e),ZDUtils.hideLoadingMsg(),!1):void 0}}),ZD("#newFolderCreator").remove()}}),ZD("#closeImg").click(function(){ZD("#newFolderCreator").remove()}),ZD("#closeBtn").click(function(){ZD("#newFolderCreator").remove()})},ADDDOCDIALOG.showFolderCreationStatus=function(e){ZD.parseJSON(e);"FOLDER_CREATED_SUCCESSFULLY"===e.message?ADDDOCDIALOG.sendAjaxReqForMail():"ALREADY_NAME_EXISTS"===e.response.result.message?(alert(zd_js_obj.label_create_foldername_already_exists),ADDDOCDIALOG.createNewFolderDiv()):(alert(zd_js_obj.label_unable_to_create_folder_error),ADDDOCDIALOG.sendAjaxReqForMail())},ADDDOCDIALOG.moveUpFolder=function(){var e="",t="",a=G_ADDDOCS_OBJ.parentId.length-1;ZD("#moveUpFolder").children("span").hasClass("back-folder")&&(G_ADDDOCS_OBJ.foldertree.pop(),"personal_folder"===G_ADDDOCS_OBJ.rootvalue?0===a?(ADDDOCDIALOG.sendAjaxReqForMail(),ZD("#moveUpFolder").children("span").removeClass("back-folder").addClass("back-folder-inactive")):(e=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",t="type=foldertree&folderid="+G_ADDDOCS_OBJ.parentId[a]+"&"+zdcsrfPair+"&crossdomain=true",G_ADDDOCS_OBJ.parentId.pop()):"shared_folder"===G_ADDDOCS_OBJ.rootvalue?(0===a?(e=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",t="type=sharedfoldertree&folderid=-1&"+zdcsrfPair+"&crossdomain=true",ZD("#moveUpFolder").children("span").removeClass("back-folder").addClass("back-folder-inactive"),G_ADDDOCS_OBJ.parentId.pop()):(e=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",t="type=sharedfoldertree&permission="+G_ADDDOCS_OBJ.permission[a]+"&parentfolderlevel="+G_ADDDOCS_OBJ.folderlevel[a]+"&folderid="+G_ADDDOCS_OBJ.parentId[a]+"&"+zdcsrfPair+"&crossdomain=true",G_ADDDOCS_OBJ.parentId.pop()),G_ADDDOCS_OBJ.permission.pop(),G_ADDDOCS_OBJ.folderlevel.pop()):"ws_folder"===G_ADDDOCS_OBJ.rootvalue&&(0===a?(e=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/workspaces",t=zdcsrfPair+"&crossdomain=true",ZD("#moveUpFolder").children("span").removeClass("back-folder").addClass("back-folder-inactive"),G_ADDDOCS_OBJ.parentId.pop(),G_ADDDOCS_OBJ.issharedws=!1):(e=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",t="type=wsfoldertree&folderid="+G_ADDDOCS_OBJ.parentId[a]+"&"+zdcsrfPair+"&crossdomain=true",G_ADDDOCS_OBJ.parentId.pop())),""!==e&&ZD.ajax({url:e,data:t,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(e,t){return"success"==t?(ADDDOCDIALOG.constructList(G_ADDDOCS_OBJ.rootvalue,e),ZDUtils.hideLoadingMsg(),!1):void 0}}))},ADDDOCDIALOG.addToZDocsNewUI=function(){{var e=G_ADDDOCS_OBJ.foldertree.length;G_ADDDOCS_OBJ.filename}if(0!==e){var t=G_ADDDOCS_OBJ.foldertree[e-1];"personal_folder"===G_ADDDOCS_OBJ.rootvalue?G_ADDDOCS_OBJ.folderid=t.res_id:"shared_folder"===G_ADDDOCS_OBJ.rootvalue?G_ADDDOCS_OBJ.folderid=t.FOLDERID:"ws_folder"===G_ADDDOCS_OBJ.rootvalue&&(G_ADDDOCS_OBJ.workspaceid=G_ADDDOCS_OBJ.foldertree[0].res_id,G_ADDDOCS_OBJ.folderid=t.res_id,G_ADDDOCS_OBJ.issharedws=G_ADDDOCS_OBJ.issharedws)}var a={fname:G_ADDDOCS_OBJ.filename,folderid:G_ADDDOCS_OBJ.folderid,workspaceid:G_ADDDOCS_OBJ.workspaceid,issharedws:G_ADDDOCS_OBJ.issharedws};return a.handbckobj=G_ADDDOCS_OBJ.adddocObj.handbckobj,a},ADDDOCDIALOG.constructDialogContent=function(e){ZD("#adddocdialogdiv").append('<table class="add-to-docs" width="100%" border="0" cellspacing="0" cellpadding="5"><tbody>'),ZD("#adddocdialogdiv > table").append('<tr id="status_msg" style="display:none;"><td colspan="3"><div class="status-message" id="msg_content"></div></td></tr>'),ZD("#adddocdialogdiv > table").append('<tr><td width="50" align="right"><span  style="margin-left:0px;">'+zd_js_obj.label_add_as+'</span></td><td><input class="inputtext txtinput flleft" id="add_doc_name" type="text" name="docname" style="height:25px;" value="'+G_ADDDOCS_OBJ.filename+'"></td><td width="30" align="right" id="expand_view"><button type="button" class="open-tree"></button></td></tr>'),ZD("#adddocdialogdiv > table").append('<tr id="selected_folder"><td align="right"><span>'+zd_js_obj.label_where+'</span></td><td><div class="add-to-my-folder"><span style="width:17px;height:16px;" class="zdc-add-to-docs-folder flleft margright"></span>'+zd_js_obj.my_folders+"</div></td></tr>"),ZD("#adddocdialogdiv > table").append("undefined"!=typeof e&&0==e?'<tr id="folder_container" style="display:none;"><td colspan="3" valign="top"><div style="border:1px solid #CBD3E2;height:260px;width:100%;"><div style="border-bottom:1px solid #CBD3E2;height:22px;padding:6px;width:auto;background:#f8f8f8;"><select class="toolbarselect flleft margright lookin-select" id="selectOption" style="height:22px;width:300px;"><optgroup label="'+zd_js_obj.label_select_view+'"><option id="opt_folder" value="opt_folder" class="pad-lft">'+zd_js_obj.label_personal_folder+'</option><option id="opt_sharedfolder" value="opt_sharedfolder" class="pad=lft">Shared Folders</option></optgroup></select></div><div id="openloadingmsg"></div><div id="tree_container" style="height: 222px;overflow: auto;"></div></div></td></tr>':'<tr id="folder_container" style="display:none;"><td colspan="3" valign="top"><div style="border:1px solid #CBD3E2;height:260px;width:100%;"><div style="border-bottom:1px solid #CBD3E2;height:22px;padding:6px;width:auto;background:#f8f8f8;"><select class="toolbarselect flleft margright lookin-select" id="selectOption" style="height:22px;width:300px;"><optgroup label="'+zd_js_obj.label_select_view+'"><option id="opt_folder" value="opt_folder" class="pad-lft">'+zd_js_obj.label_personal_folder+'</option><option id="opt_sharedfolder" value="opt_sharedfolder" class="pad=lft">Shared Folders</option><option id="opt_ws" value="opt_ws" class="pad-lft">'+zd_js_obj.label_workspaces+'</option></optgroup></select></div><div id="openloadingmsg"></div><div id="tree_container" style="height: 222px;overflow: auto;"></div></div></td></tr>'),ADDDOCDIALOG.initDelegate()},ADDDOCDIALOG.initDelegate=function(){ZD("#expand_view").delegate("button","click",function(){ADDDOCDIALOG.expandFolderView(this)}),ZD("#folder_container").delegate("select","change",function(){var e=ZD(this).val();"opt_ws"===e||"opt_sharedfolder"===e?ADDDOCDIALOG.constructTree(e,""):zd_isIE||ADDDOCDIALOG.sendAjaxRequest(e)})},ADDDOCDIALOG.expandFolderView=function(e){if(ZD(e).hasClass("open-tree")){{ZD("#adddocdialogdiv").height()}ZD("#selected_folder").hide(),ZD("#folder_container").show(),ZD(e).removeClass("open-tree").addClass("open-tree-selected"),ADDDOCDIALOG.sendAjaxRequest("opt_folder")}else{ZD("#selected_folder").show(),ZD("#folder_container").hide();{ZD("#adddocdialogdiv").height(),ZD("#adddocdialogdiv").height()}ZD(e).removeClass("open-tree-selected").addClass("open-tree")}document.getElementById("selectOption").selectedIndex=0},ADDDOCDIALOG.constructURL=function(e){var t=G_ADDDOCS_OBJ.docsURL+"/docs/adddocrequest.do?method=";return"opt_folder"==e?t+="getFolderTree":"opt_sharedfolder"===e&&(t+="getSharedFolderTree&folderid="+G_ADDDOCS_OBJ.folderid),t+="&_t="+(new Date).getTime()},ADDDOCDIALOG.checkWorkspaceStatus=function(e,t){var a=t+"/docs/adddocrequest.do?method=checkWorkspaceStatus";ZD.ajax({url:a,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(t){void 0!=e&&""!=e&&e(t.status)}})},ADDDOCDIALOG.constructTree=function(e,t){var a=ZD("div#tree_container");a.html(""),a.append(t);var i="";"opt_folder"===e?i=ZD("#addtozddiv"):"opt_sharedfolder"===e?(a.append('<form id="moveForm" name="moveForm">'),ZD("form#moveForm").append('<div id="addtozddiv">'),i=ZD("#addtozddiv")):"opt_ws"==e&&(a.append('<form id="moveForm" name="moveForm">'),ZD("form#moveForm").append('<div id="treecondivws">'),i=ZD("#treecondivws")),"opt_folder"==e?(i.jstree({core:{animation:0,initially_open:["node0"]},themes:{theme:"classic",url:G_ADDDOCS_OBJ.docsURL+"/docs/css/"+G_ADDDOCS_OBJ.theme+"/docs.tree.css"},plugins:["themes","html_data"]}),ZD("#collapse").remove()):"opt_sharedfolder"===e?(i.jstree({core:{animation:0,initially_open:["node0"]},themes:{theme:"classic",url:G_ADDDOCS_OBJ.docsURL+"/docs/css/"+G_ADDDOCS_OBJ.theme+"/docs.tree.css"},html_data:{ajax:{url:G_ADDDOCS_OBJ.docsURL+"/docs/adddocrequest.do?method=getSharedFolderTree",f_node:{},data:function(e){if(this.f_node=e,-1!==e){var t=ZD(e).attr("id"),a=new Date;t=t.replace("nodes","");var i="folderid="+t+"&_t="+a.getTime();return i}var a=new Date,i="folderid=-1&_t="+a.getTime();return i},dataType:"html",success:function(e){return e=e.replace(/^\s*|\s(?=\s)|\s*$/g,""),0===e.length?(e=null,e='<li class="graytxt smallText italicText">'+zd_js_obj.no_folder+"</li>"):"No Folders"===e&&(e='<div class="graytxt" style="padding:50px 0 0;text-align:center;">'+zd_js_obj.label_no_shared_folder+"</div>"),e}}},plugins:["themes","html_data"]}),ZD("#collapse").remove()):"opt_ws"==e&&i.jstree({core:{animation:0,initially_open:["rootnode-1"]},themes:{theme:"classic",url:G_ADDDOCS_OBJ.docsURL+"/docs/css/"+G_ADDDOCS_OBJ.theme+"/docs.tree.css"},ui:{select_limit:"1",initially_select:"",selected_parent_close:!1,select_prev_on_delete:!1},html_data:{ajax:{url:G_ADDDOCS_OBJ.docsURL+"/docs/adddocrequest.do?method=getWorkSpaceFolderTree&_t="+ZD.now(),f_node:{},data:function(e){if(this.f_node=e,-1!=e){var t=ZD(e).attr("id");return t=t.replace("node",""),"folderid="+t}return"folderid=-1"},dataType:"html",success:function(e){return e=e.replace(/^\s*|\s(?=\s)|\s*$/g,""),0==e.length?(e=null,e='<li class="graytxt smallText italicText">'+zd_js_obj.no_folder+"</li>"):"nofolder"===e?e='<li class="graytxt smallText italicText">'+zd_js_obj.no_folder+"</li>":"noworkspace"==e&&(e='<div class="graytxt" style="padding:50px 0 0;text-align:center;">'+zd_js_obj.no_workspace+"</div>"),e}}},plugins:["themes","html_data"]}),G_ADDDOCS_OBJ.folderid="-1",G_ADDDOCS_OBJ.workspaceid="-1",G_ADDDOCS_OBJ.wsfolderid="-1",G_ADDDOCS_OBJ.issharedws=!1},ADDDOCDIALOG.sendAjaxRequest=function(e){ZDUtils.LoadingMsg(zd_js_obj.loading);var t=ADDDOCDIALOG.constructURL(e);ZD.ajax({url:t,type:"GET",xhrFields:{withCredentials:!0},dataType:"html",success:function(t,a){return"success"==a?(ADDDOCDIALOG.constructTree(e,t),ZDUtils.hideLoadingMsg(),!1):void 0}})},ADDDOCDIALOG.showStatusMsg=function(e){ZD("#msg_content").html(e),ZD("#status_msg").fadeIn(400),setTimeout(function(){ZD("#status_msg").fadeOut(400),ZD("#msg_content").html("")},4e3)},ADDDOCDIALOG.hasSpecialChar=function(e){for(var t="<>*%#&?\\',\"",a=1,i=0;i<e.length;i++)-1!=ZD.inArray(e.charAt(i),t)&&(a+=1);return a>1?!0:!1},ADDDOCDIALOG.hasWhiteSpaceChar=function(e){return""==e||void 0==e?!0:!1},ADDDOCDIALOG.validateFileName=function(e){return void 0!=e&&ZD.trim(e).length<=0?(ADDDOCDIALOG.showStatusMsg(zd_js_obj.document_name_empty_validation),!1):ZD.trim(e).length>100?(ADDDOCDIALOG.showStatusMsg(zd_js_obj.document_validation_max_100_characters),!1):ADDDOCDIALOG.hasSpecialChar(e)?(ADDDOCDIALOG.showStatusMsg(zd_js_obj.special_characters_validaton),!1):!0},ADDDOCDIALOG.addDocToZDocs=function(){var e=ZD("#add_doc_name").val();if(!ADDDOCDIALOG.validateFileName(e))return!1;if(G_ADDDOCS_OBJ.filename=e,ZD("#expand_view > button").hasClass("open-tree"))G_ADDDOCS_OBJ.folderid="folder";else{var t=ZD("input[name='destFolderId']:checked"),a=ZD("#selectOption option:selected").val();if(void 0==t||0==t.length){var i=zd_js_obj.label_add_to_zd_notselect_folder;return"opt_ws"==a&&(i=zd_js_obj.label_add_to_zd_notselect_ws),ADDDOCDIALOG.showStatusMsg(i),!1}var s=t.val()+"";if("opt_ws"===ZD("#selectOption option:selected").val()){G_ADDDOCS_OBJ.workspaceid=t.attr("wsid"),G_ADDDOCS_OBJ.folderid=t.val();var o=t.parent().attr("sharedworkspacefolder");void 0!=o&&"true"==o&&(G_ADDDOCS_OBJ.issharedws=!0)}else G_ADDDOCS_OBJ.folderid=s,"0"==s&&(G_ADDDOCS_OBJ.folderid="folder")}var d={fname:G_ADDDOCS_OBJ.filename,folderid:G_ADDDOCS_OBJ.folderid,workspaceid:G_ADDDOCS_OBJ.workspaceid,issharedws:G_ADDDOCS_OBJ.issharedws};d.handbckobj=G_ADDDOCS_OBJ.adddocObj.handbckobj,addToZDCallBck(d),ZDDialog.closePopUp("adddocdialogdiv")},function(e){e.widget("ui.DocsFileUploader",{defaults:{service:"zdocs",container_id:"",fileLimit:3,maxFileSize:100,fileSizeInByte:1024,docs_url:"",udserver_url:"",permaLink:"",doc_conversion:!1,ie_url:"",folderId:"-1",workSpaceId:"",libraryId:"",callback:"",ieParams:"",udserver_upload:!0,zsoid:"",progresscallbck:"",UploadStatusObj:{},uploadto:"",handback:"",fileType:"",params:{isUploadStatus:!1,totalFilesCount:1,sharedType:""}},_create:function(){this.options=e.extend({},this.defaults,this.options),this.options.permaLink=this.options.docs_url;var t="?";for(var a in this.options.params)t=t+a+"="+this.options.params[a]+"&";t=""!=this.options.workSpaceId&&"-1"!=this.options.folderId?t+"doc_conversion="+this.options.doc_conversion+"&folderId="+this.options.folderId+"&isWSsubFolder=true&workSpaceUpload=true&workSpaceId="+this.options.workSpaceId:""!=this.options.libraryId&&"zdocs"===this.options.service?t+"workSpaceId="+this.options.libraryId+"&isWSsubFolder=false&folderId=-1&workSpaceUpload=true&libraryId="+this.options.libraryId:""!=this.options.workSpaceId&&"-1"===this.options.folderId?t+"doc_conversion="+this.options.doc_conversion+"&workSpaceUpload=true&folderId="+this.options.workSpaceId:t+"doc_conversion="+this.options.doc_conversion+"&folderId="+this.options.folderId,this.options.ie_url=this.options.docs_url,"zdocs"===this.options.service||"zwriter"===this.options.service?this.options.docs_url=this.options.docs_url+"/dndupload.do"+t:"cms"===this.options.service?this.options.docs_url=this.options.docs_url+"/ws/wsdndupload.do?zsoid="+this.options.zsoid+"&updateDoc=false&workSpaceId="+this.options.workSpaceId+"&folderId=-1&zsoidservice="+this.options.service:"zcrm"===this.options.service&&(this.options.url=this.options.url+t),this.options.ieParams=t,this._buttonInit()},_buttonInit:function(){var t=this;if(void 0==zd_js_obj||""==zd_js_obj){var a=function(){t._buttonInit()};return t.getI18N(a,t.options.docs_url),!1}if(this.options.isComp)""===this.options.fileType||"all"===this.options.fileType?e("#linkdocsdialogdiv").append('<input type="file" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'):"images"===this.options.fileType?e("#linkdocsdialogdiv").append('<input type="file" accept="image/*" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'):"videos"===this.options.fileType&&e("#linkdocsdialogdiv").append('<input type="file" accept="video/*" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'),e(this.element).click(function(){e("#zd_UploadButton").click()});else{e(this.element).append('<input type="file" id="zd_UploadButton" name="multiupload_file" value="" style="opacity:0;position:absolute;left:-2000px;" multiple>');var i=e(this.element).width();e("#zd_UploadButton").css("width",i),e(this.element).hover(function(){e("#zd_UploadButton").css("left","0px")},function(){e("#zd_UploadButton").css("left","-2000px")})}var t=this;e("#zd_UploadButton").bind("change",function(){""===t.options.container_id&&""===t.options.callback&&e("body").append('<table id="zd_contain"></table>');var a=t.options.docs_url,i=navigator.appVersion.split(";"),s=i[1],o=10;if(void 0!==s&&(o=parseInt(s.replace("MSIE ",""))),"Microsoft Internet Explorer"===navigator.appName&&(t.options.udserver_upload=!1),"Microsoft Internet Explorer"===navigator.appName&&9>=o){{e("#zd_UploadButton").attr("value")}curFileElement=e("#zd_UploadButton");var d=(new Date).getTime(),r="target"+(new Date).getTime(),n=e("#zd_UploadButton").parent(),l=e("#zd_UploadButton").clone();n.append(l);var c=e("<div />").appendTo("body");c.attr("id","uploadfilediv"),c.attr("height","1%");var p=e("<form></form>");p.attr({id:"form-"+d,target:r,name:"form-"+d,method:"POST",encType:"multipart/form-data",encoding:"multipart/form-data"}),p.css({margin:0,display:"none"}),p.append(curFileElement);var _=e('<iframe name="'+r+'">').attr({height:"0",width:"0",id:r}).css("display","none");e("body").append(_),e(c).append(p);var D=e("#uploadfilediv"),h=D.children("form"),u={};u.uid="docsUploadWidget",u.callbck=t.options.callback;var v=t.options.ie_url+"/uploadsingle.do"+t.options.ieParams+"&refFileElementId=docsUploadWidget"+t.options.callback;e(h[0]).attr("action",v),h[0].submit()}else{var f=this.files,m=f.length;m>t.options.fileLimit&&(m=t.options.fileLimit),m>100&&(m=100);for(var O=0;m>O;O++)t.docUpload(f[O],f[O].size,f[O].name,a,O)}})},getI18N:function(t,a){var i="https://"+a+"/docs/zduserdetails.do";e.ajax({url:i,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(a){e("#zd_user_details").remove(),e("body").append(a),void 0!=t&&""!=t&&t()}})},updateProgress:function(e,t,a,i){var s=this;if(t.lengthComputable){var o=Math.round(100*t.loaded/t.total);if(e.currentProgress!=o){e.currentProgress=o,s.fileUploadProgressUpdated(i,e.fileName,e.fileSize,e.currentProgress,a);var d=(new Date).getTime(),r=d-e.currentStart;if(r>3e3){{t.loaded-e.startData}e.startData=t.loaded,e.currentStart=d,e.currentStart=d}}}},fileUploadProgressUpdated:function(e,t,a,i){var s=this,o=i/100*100;"function"==typeof s.options.progresscallbck&&s.options.progresscallbck(o,t,a,e)},cancelUpload:function(e){var t=this;t.options.UploadStatusObj[e].abort()},docUpload:function(t,a,i,s,o){var d=this;"cms"===d.options.service&&(s=d.options.permaLink+"/ws/corswsdndupload.do?zsoid="+d.options.zsoid+"&updateDoc=false&workSpaceId="+d.options.workSpaceId+"&folderId="+d.options.folderId+"&zsoidservice="+d.options.service);var r=a/(d.options.fileSizeInByte*d.options.fileSizeInByte);if(r>d.options.maxFileSize)return alert(ZDUtils.replaceParams(zd_js_obj.file_chooser_file_size_is_greater_than_limit,[i,d.options.maxFileSize,"MB"])),!1;var n=new XMLHttpRequest,l=n.upload;l.fileIndex=o,l.fileName=i,l.fileSize=r,l.downloadStartTime=(new Date).getTime(),l.currentStart=l.downloadStartTime,l.currentProgress=0,l.startData=0;var c=o+"_new_"+e.now();if(l.upload_id=c,l.addEventListener("progress",function(e){"zcrm"===d.options.service?d.updateProgress(l,e,"CR",c):"cms"===d.options.service&&d.updateProgress(l,e,"cms",c)},!1),n.fileName=i,n.withCredentials=!0,"withCredentials"in n){if(d.options.udserver_upload){n.open("POST",zd_udserverurl+"/webupload",!0),n.setRequestHeader("Connection","Keep-Alive"),n.setRequestHeader("Content-type",t.type),n.setRequestHeader("x-service",zd_udservicekey),"zcrm"===d.options.service?(n.setRequestHeader("invoker","CR"),n.setRequestHeader("x-uploadto",d.options.uploadto)):"cms"===d.options.service?n.setRequestHeader("invoker","cms"):(n.setRequestHeader("invoker","Upload"),n.setRequestHeader("x-uploadTo","myfolders")),n.setRequestHeader("x-streammode","1"),n.setRequestHeader("upload-id",o+"_new_"+e.now()),n.setRequestHeader("x-content_type",t.type),n.setRequestHeader("x-filename",encodeURIComponent(t.name)),n.setRequestHeader("x-doc_conversion",!1),n.setRequestHeader("x-folderId",d.options.folderId),""!==d.options.workSpaceId&&void 0!==d.options.workSpaceId&&n.setRequestHeader("x-wsId",d.options.workSpaceId),""!==d.options.zsoid&&void 0!==d.options.zsoid&&n.setRequestHeader("x-zsoid",d.options.zsoid),n.setRequestHeader("charset","utf-8"),n.setRequestHeader("Content-Length",t.size);var p="";"zwriter"===d.options.service?p="WR":"zsheet"===d.options.service?p="ST":"zshow"===d.options.service?p="SW":"zbooks"===d.options.service?p="ZB":"zmail"===d.options.service?p="VO":"zcrm"===d.options.service?p="CR":"zplanner"===d.options.service?p="PL":"cms"===d.options.service&&(p="ZS"),n.setRequestHeader("x-notifyto",p),n.send(t)}else{var _=new FormData;_.append("multiupload_file",t),_.append(docsCSRFParamNAME,getDocsCsrfTokenFromCookie(docsCSRFCookieName)),n.open("POST",s,!0),n.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var t=this.response;e("body").append(t);var a=d.options.permaLink+"/file/"+e("#successdndmessagediv").attr("docId");e(d.element).text(zd_js_obj.file_chooser_label_upload_to_docs);var i="<a href="+a+' name="filelink" id="filelink">'+this.fileName+"</a>";if(e("#theImg").remove(),e(d.element).unbind("click"),e(d.element).bind("click",function(){e("#zd_UploadButton").click()}),e("#result").css("display","block"),""!=d.options.container_id&&""===d.options.callback)e("#"+d.options.container_id).append(i);else if(""!=d.options.callback&&"function"==typeof d.options.callback){var s="";s=""!=d.options.handback?e("#successdndmessagediv").attr("docId")+d.options.handback:e("#successdndmessagediv").attr("docId"),d.options.callback(s)}else e("#zd_contain").append("<tr><td>"+i+"</td></tr>");e("#successdndmessagediv").remove()}},n.send(_)}e(d.element).unbind("click"),e(d.element).text(zd_js_obj.file_chooser_label_uploading),e("#theImg").remove()}},_destroy:function(){e.widget.prototype.destroy.call(this)}})}(jQuery),"undefined"!=typeof Collaboration&&(Collaboration.prototype.constructor.handleCrossProductMessage=function(e){return function(){if("UDSERVER_UPLOAD"===arguments[1].action){var t=arguments[1];jQuery(":data(DocsFileUploader)").each(function(){var e=$(this).data("DocsFileUploader");e.options.isComp&&($(e.element).unbind("click"),$(e.element).bind("click",function(){$("#zd_UploadButton").click()}));var a=e.options.callback;a(t.resourceId)})}else if("CREATE_THUMBNAIL"==arguments[1].action){var t=arguments[1];jQuery(":data(DocsFileUploader)").each(function(){var e=$(this).data("DocsFileUploader");if(e.options.isComp){var a=e.options.permaLink+"/api/v2/files/properties?action=jsonobject&crossdomain=true&resourceid="+t.resourceId+"&"+zdcsrfPair;void 0!==G_LD_OBJ&&(a+="&accessService="+G_LD_OBJ.urlInvoker+"&zsoid="+G_LD_OBJ.zsoid),ZD.ajax({url:a,datatype:"json",xhrFields:{withCredentials:!0},success:function(e){ZD("#"+e.res_id).html(""),ZD("#"+e.res_id).append('<div style="width:75px;height:75px;"><img src="'+e.preview_url+'" style="height:75px;width:75px;" onerror="LINKDOCS.imgLoadingError(\''+e.no_preview_class+'\',this);"></div><div style="height:18px"><p style="font-size:small;margin-top:0px;height:18px;width:81px;overflow:hidden;margin-left:-3px;white-space: nowrap;" title="'+e.enc_res_name+'">'+e.enc_res_name+"</p></div>")}})}})}return e.apply(this,arguments)}}(Collaboration.prototype.constructor.handleCrossProductMessage));