"use strict";window._updater=function(e){var i,a,o,t,n,r,d,m,u,l,s,c,f,p,v,z,g,j,h,N,w,B,M=e.core={},C=zmText.get("updater"),I=!1,b=function(){return!o.isMouseOnMe()&&!t.isMouseOnMe()};i=n={emoji:function(e){var i="zmUpdateIcon";return e.emojiClass&&(i=e.emojiClass),zdom("div",{className:"zmUpdateIconWra"},zdom("span",{className:i}))},noticeBoardIgnoreAction:function(e){return e.showIgnore?zdom("fragment",null,zdom("span",{className:"SC_SLine"}),zdom("span",{className:"SC_link zmFrm","data-val":"Cancel","data-action":"ignoreCallback","data-id":e.id},e.ignoreMsg)):null},noticeBoard:function(e){var i=null;return e.title&&(i=zdom("fragment",null,e.title,zdom("br",null),zdom("br",null))),zdom("div",{style:{maxWidth:"350px"}},i,e.desc,zdom("br",null),zdom("br",null),zdom("span",{className:"SC_link zmFrm","data-action":"actionCallback","data-id":e.id},e.actionMsg),n.noticeBoardIgnoreAction(e))}},r={},m={1:{id:d=1,title:zmText.applyArgs(C.refreshBand.dearUser,{user:zmail.IAMFullName}),desc:C.refreshBand.desc,actionMsg:C.refreshBand.title,actionCallback:function(){window.location.reload(!0)}}},r.setCurrentBoardId=function(e){d=e||1},r.getCurrentBoardDetail=function(){return m[d]},r.get=function(e){return m[e]},r.add=function(e){if(e){var i=String(Date.now());e.id=i,m[i]=e}},r.remove=function(e){delete m[e],d===e&&(d=1)},a=r,u={},h={showNoticeBoard:_.throttle(function(e){return e.stopPropagation(),e.stopImmediatePropagation(),I||(I=!0,o.show(),c.stopJumping()),!1},100),hideNoticeBoard:_.throttle(function(){b()&&(zmUtil.hideMenu(),c.jump())},3e3)},u.create=function(){l=$.e(i.emoji(a.getCurrentBoardDetail())),s=l.find("span"),zmModules.getRHSModule().then(function(e){var i=(0,e.rhs)().rhsBar.topSectionContainer;$.e(l).insertDOMAfter(i)}),s.on("mouseenter mousedown",h.showNoticeBoard),s.on("mouseleave",h.hideNoticeBoard),zmail.emojiNotifier={$emojiTab:l,jumpingId:void 0}},u.createFromCache=function(){l=zmail.emojiNotifier.$emojiTab,s=l.find("i"),zmail.emojiNotifier&&zmail.emojiNotifier.jumpingId&&(clearInterval(zmail.emojiNotifier.jumpingId),zmail.emojiNotifier.jumpingId=void 0,c.jump())},v=function(){return s&&s.removeClass("updateJump")},z=function(){return s&&s.addClass("updateJump")},g=function(){s&&v().delay(100).queue(z).dequeue()},j=function(){return s&&s.removeClass("topToBottom")},(f={}).fallDown=function(){s&&((s&&s.addClass("topToBottom")).delay(1e3).queue(j),f.jump())},f.jump=function(){void 0===p&&(p=setInterval(g,5e3),zmail.emojiNotifier&&(zmail.emojiNotifier.jumpingId=p))},f.stopAnimating=function(){zmail.emojiNotifier&&(clearInterval(zmail.emojiNotifier.jumpingId),zmail.emojiNotifier.jumpingId=void 0),clearInterval(p),p=void 0},f.stopJumping=function(){void 0!==p&&(f.stopAnimating(),v())},c=f,u.getDOM=function(){return s},u.isMouseOnMe=function(){return s&&s.is(":hover")},u.isDefined=function(){return zmail.emojiNotifier&&void 0!==zmail.emojiNotifier.$emojiTab},u.remove=function(){c.stopAnimating(),l&&(l.remove(),s=void 0),zmail.emojiNotifier&&(zmail.emojiNotifier.$emojiTab&&zmail.emojiNotifier.$emojiTab.remove(),zmail.emojiNotifier=void 0)},u.actions=c,t=u,N={},B={mouseLeaveHandler:_.throttle(function(){b()&&(zmUtil.hideMenu(),t.actions.stopJumping(),t.actions.jump())},3e3),actionHandler:function(e,i){var o=(i=$.e(i)).data("action");if(o){var t=i.data("id"),n=a.get(t);n&&n[o]&&n[o]()}},hideHandler:function(){I=!1,w=void 0,t.isDefined()&&t.actions.jump()}},N.isMouseOnMe=function(){return w&&w.$el&&w.$el.is(":hover")},N.show=function(){(w=zmUtil.showMenu({divId:"updateNotifier",par:t.getDOM(),showArrow:!0,liHover:!1,direction:"rightBottom",clk:B.actionHandler,onHide:B.hideHandler,list:[{htm:i.noticeBoard(a.getCurrentBoardDetail())}]})).$el.on("mouseleave",B.mouseLeaveHandler)},N.remove=function(){zmUtil.hideMenu()},o=N,M.removeNoticeBoardAndEmoji=function(){t.remove(),o.remove()};return M.refreshAction=function(){M.removeNoticeBoardAndEmoji(),a.setCurrentBoardId(),t.isDefined()?t.createFromCache():(t.create(),t.actions.fallDown())},e}(window._updater||{}),window._updater=function(e){var t=(e=e||{}).core;return e.init=function(e,i,o){switch(e){case"1":zmail.isRebranded||t.whatsNewAction();break;case"2":void 0!==i&&zmail.staticVersion!==i&&t.refreshAction();break;case"3":o="string"==typeof(o=o||{})?$.parseJSON(o):o,$.publish("/whatsSeen/fromUpdater",o);break;case"4":zmail.isRHSEnabled&&zmModules.getRHSModule().then(function(e){(0,e.rhs)().rhsBar.getApp("EWidgets").showBadge(i)})}},e}(window._updater);