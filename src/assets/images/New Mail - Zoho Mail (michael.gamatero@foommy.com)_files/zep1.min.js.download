function _typeof(a){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}ZE.create=function(a){"use strict";return new ZE(a)},ZE.prototype.execCommand=function(a,b){"use strict";var c=function(a){var b=a.target.closest("li"),c=this.doc.getSelection();c.anchorNode&&3===c.anchorNode.nodeType&&0===c.anchorOffset&&b.classList&&("zeChecked"===b.classList[0]?b.className="":b.className="zeChecked")},d=document.getElementById("ze_spellcheck_options");d&&(d.parentElement.removeChild(d),ZE.removeClass(this.toolbarobject.spellcheck,"ze_dn ze_Sel"));var e=this.initobj.toolbarClsName,f=a.target;if(e)for(;"UL"!==f.nodeName;){if(f.hasAttribute("class")){var g=f.className,h=g.split(" ");if(h.includes(this.initobj.toolbarClsName))return"function"==typeof this.initobj.toolbarClkCallback&&this.initobj.toolbarClkCallback(a,b),!0}f=f.parentElement}var i,j,k,l=this,m=document,n=["zei-smiley","zei-table","zei-textclr","zei-bgclr"];l.toolbarobject&&(k=l.toolbarobject[b]),l._stopEvent(a),l.squireInstance.focus();var o=a.target,p=function(){var a,b,c=m.getElementsByClassName("ze_tbEd"),d=m.getElementsByClassName("IconDiv")[0],e=m.getElementById("ze_dropdown");a=function(){l.insertIconRef.className="ui-insert",l.insertIconRef.style.visibility="",l.paraIconRef.className="ui-paragraph",l.initobj.microParaToolbar?(l.paraIconRef.className="ui-paragraph",l.paraIconRef.style.visibility=""):l.paraIconRef.style.visibility="hidden"},b=m.getElementById("stickIcon"),b?"zei-unlink"===b.className||e||(c[0].parentElement.removeChild(c[0]),d.parentElement.removeChild(d)):(a(),e||c[0].parentElement.removeChild(c[0])),c[1]&&(a(),c[1].parentElement.removeChild(c[1]))};o.hasAttribute("class")&&n.indexOf(o.className)>=0?o=o.parentElement:"LI"===a.target.nodeName&&(o=o.firstChild);var q=l.toolbarobject;if("smartCompose"===l.initobj.editorType)for(var r in q)switch(q[r].title){case"Font":case"Font Size":case"Heading":case"Font Color":case"Background Color":case"Align Options":case"List Options":case"Smiley":case"Table":if(q[r].title===o.title){if(q[r].hasAttribute("sel"))return q[r].removeAttribute("sel"),ZE.removeClass(q[r],"ze_Sel"),!1;q[r].setAttribute("sel","selected"),ZE.addClass(q[r],"ze_Sel")}else q[r].hasAttribute("sel")&&(q[r].removeAttribute("sel"),ZE.removeClass(q[r],"ze_Sel"))}switch(b){case"forecolor":case"backcolor":case"fontfamily":case"fontsize":l.showDropDown(a,b);break;case"alignoptions":l.showDropDown(a,b,"align");break;case"listoptions":l.showDropDown(a,b,"list");break;case"scriptoptions":l.showDropDown(a,b,"scripts");break;case"directionoptions":l.showDropDown(a,b,"textDir");break;case"formatingoptions":l.showDropDown(a,b,"formatingoptions");break;case"alignLeft":case"alignRight":case"alignCenter":case"alignjustify":l.updateFormatoptions(a.target,k,"align");break;case"NumBullets":case"DotBullets":l.updateFormatoptions(a.target,k,"list");break;case"LefttoRight":case"RightToLeft":l.updateDirectionOptions(a.target,k,"textDir");break;case"indentoptions":l.showDropDown(a,b,"indent");break;case"otheroptions":"plaintext"===l.mode?(ZE_Init.removeTooltip(),l.richText(l.getContent())):l.showDropDown(a,b,"others");break;case"heading":l.showDropDown(a,b,"heading");break;case"switchToRichText":l.richText(l.getContent());break;case"smiley":l.showDropDown(a,b);break;case"link":l.createLink(),ZE_Init.needEditorStats&&l.updateCount(b),"smartCompose"===l.initobj.editorType&&p();break;case"tableGrid":l._createTableGrid(a,b),ZE_Init.needEditorStats&&l.updateCount(b);break;case"image":l.createImage(),ZE_Init.needEditorStats&&l.updateCount(b),"smartCompose"===l.initobj.editorType&&p();break;case"rtl":l.squireInstance.setTextDirection("rtl"),l.saveCurrentState(),l.updateToolbar();break;case"ltr":l.squireInstance.setTextDirection("ltr"),l.saveCurrentState(),l.updateToolbar();break;case"table":l.createTable(),ZE_Init.needEditorStats&&l.updateCount(b);break;case"save":if(l.initobj.saveContent){var s=l.doc,t="<html><head>"+s.getElementsByTagName("head")[0].innerHTML;t+="</head><body>"+s.body.innerHTML+"</body></html>",l.initobj.saveContent(t)}break;case"insertoptions":l.insertOptions(a);break;case"quote":l.squireInstance.focus(),l.insertQuote(),ZE_Init.needEditorStats&&l.updateCount(b),"smartCompose"===l.initobj.editorType&&(l.PlaceIcon(),p()),l.removeAlterToolbar();break;case"object":l.insertObj(),ZE_Init.needEditorStats&&l.updateCount(b);break;case"code":l.insertCode(),ZE_Init.needEditorStats&&l.updateCount(b);break;case"edithtml":l.htmlView(),ZE_Init.needEditorStats&&l.updateCount(b);break;case"insertCode":l.squireInstance.makeCodeList();break;case"more":l.expandToolbar(a);break;case"markdown":l.setContent(l.makeMarkDownTags(l.getContent()));break;case"attach":i=a.target||a.srcElement,ZE.hasClass(i,"zei-arrow")?l.showDropDown(a,"attach"):l.initobj.id?ZE_Init.attach(l.initobj.id):ZE_Init.attach();break;case"template":i=a.target,ZE_Init.template(l.initobj.id),l.removeAlterToolbar();break;case"signature":i=a.target,ZE_Init.signature(l.initobj.id),l.removeAlterToolbar();break;case"spellcheck":case"spellcheckZia":i=a.target||a.srcElement,ZE.hasClass(i,"zei-arrow")?l.spellcheckOptions(a,b):"richtext"===l.mode&&l.ZiaFilesLoaded?l.triggerZiaSpellcheck():l.spellcheck(a);break;case"spellcheckPlain":l.spellcheck(a);break;case"plainText":l.updateOtheroptions(a.target,"others"),ZE_Init.needEditorStats&&l.updateCount(b);break;case"bold":j=l.doc.queryCommandState("bold"),j?l.squireInstance.removeBold():l.squireInstance.bold(),l.saveCurrentState(),l.updateToolbar();break;case"italic":j=l.doc.queryCommandState("italic"),j?l.squireInstance.removeItalic():l.squireInstance.italic(),l.saveCurrentState(),l.updateToolbar();break;case"underline":j=l.doc.queryCommandState("underline"),j?l.squireInstance.removeUnderline():l.squireInstance.underline(),l.saveCurrentState(),l.updateToolbar();break;case"j-left":case"j-right":case"j-center":case"j-full":l.squireInstance.setTextAlignment(b.split("-")[1]),l.saveCurrentState(),l.updateToolbar();break;case"insertorderedlist":l.insertListOperation("OL"),l.saveCurrentState();break;case"insertunorderedlist":l.insertListOperation("UL"),l.saveCurrentState();break;case"insertHTML":l.showInsertHTMLDialog();break;case"format":l.formatPainter();break;case"superscript":j=l.doc.queryCommandState(b),j?l.squireInstance.removeSuperscript():l.squireInstance.superscript(),l.saveCurrentState(),l.updateToolbar();break;case"subscript":j=l.doc.queryCommandState(b),j?l.squireInstance.removeSubscript():l.squireInstance.subscript(),l.saveCurrentState(),l.updateToolbar();break;case"lineHeight":l.showDropDown(a,b,"lineHeight");case"removeformat":var u,v=l.getContent();l.win.focus(),ZE_Init.is_ie?l.squireInstance.removeAllFormatting(null):l.doc.execCommand(b,!1,void 0),u=l.getContent(),u!==v&&l.saveCurrentState();break;case"checkbox":var w=l.squireInstance.makeCheckBoxList();w._editorRef().initobj.checkBoxList[0].addEventListener("click",c.bind(l),!1),delete w._editorRef().initobj.checkBoxList,l.saveCurrentState(),l.updateToolbar();break;default:l.doc.execCommand(b,!1,void 0),l.updateToolbar(),ZE_Init.needEditorStats&&l.updateCount(b),l.removeAlterToolbar()}document.getElementsByClassName("ze_SCmb ze_SCmbN")[0]&&"smiley"!==b&&"tableGrid"!==b&&p()},ZE.prototype.insertListOperation=function(a){"use strict";var b,c,d=this,e="makeUnorderedList",f="makeOrderedList",g=d.doc.getSelection().anchorNode;if(1===g.nodeType&&"ze_area"===g.classList[0]){var h=d.doc.getSelection().anchorNode.firstChild,i=d.doc.getSelection(),j=document.createRange();j.setStartBefore(h),j.setEndAfter(h),i.removeAllRanges(),i.addRange(j)}switch(a){case"UL":if(b=d.squireInstance.testPresenceinSelection(e,e,a,/>UL\b/)){if(c=d.doc.getSelection().anchorNode,c=3===c.nodeType?c.parentNode.parentNode:c.parentNode,"OL"===c.nodeName)return d.squireInstance.makeUnorderedList(),!1;b=d.squireInstance.getNearest(d.doc.getSelection().anchorNode,d.doc.body,"UL"),null!==b?d.squireInstance.decreaseListLevel():d.squireInstance.removeList()}else d.squireInstance.makeUnorderedList();d.updateToolbar();break;case"OL":if(b=d.squireInstance.testPresenceinSelection(f,f,a,/>OL\b/)){if(c=d.doc.getSelection().anchorNode,c=3===c.nodeType?c.parentNode.parentNode:c.parentNode,"UL"===c.nodeName)return d.squireInstance.makeOrderedList(),!1;b=d.squireInstance.getNearest(d.doc.getSelection().anchorNode,d.doc.body,"OL"),null!==b?d.squireInstance.decreaseListLevel():d.squireInstance.removeList()}else d.squireInstance.makeOrderedList();d.updateToolbar()}},ZE.drag=function(a,b){"use strict";var c=document,d=c.body,e=c.getElementById(b),f=e.style,g=ZE.getPos(e),h=a.clientX-g.offsetLeft,i=a.clientY-g.offsetTop,j=d.clientWidth-e.offsetWidth,k=Math.max(d.scrollHeight,c.documentElement.scrollHeight)-e.offsetHeight;return f.cursor="move",f.filter='alpha(opacity="90")',f.opacity="0.9",c.onmousemove=function(b){a=b||window.event;var c=a.clientX-h,d=a.clientY-i;return c>=0&&c<=j?f.left=c+"px":c<0?f.left="0px":c>j&&(f.left=j+"px"),d>=0&&d<=k?f.top=d+"px":d<0?f.top="0px":d>k&&(f.top=k+"px"),!1},c.onmouseup=function(){return f.cursor="",f.filter='alpha(opacity="100")',f.opacity="1",c.onmousemove=null,c.onmouseup=null,!1},!1},ZE.setPosition=function(a,b){"use strict";var c,d,e,f=document,g=f.body,h=f.documentElement,i=a.style;ZE_Init.is_ie?(d=g.clientHeight-a.offsetHeight,e=Math.max(g.scrollTop,f.documentElement.scrollTop),c=d/3+e):(d=Math.min(g.clientHeight,h.clientHeight),e=Math.max(g.scrollTop,h.scrollTop),c=(d-a.offsetHeight)/3+e),c<0&&(c=10),i.top=c+"px",c=(g.clientWidth-a.offsetWidth)/3+ZE.getPos(b).offsetLeft/2,c<50&&(c=100),i.left=c+"px"},ZE.prototype.focus=function(){"use strict";var a=this;"plaintext"===a.mode?a._textarea.focus():a.win.focus()},ZE.getPos=function(){"use strict";var a={};return a.left=0,a.top=0,ZE_Init.is_ie&&(a=document.documentElement.getBoundingClientRect()),function(b){var c=b.getBoundingClientRect(),d=document.documentElement.scrollTop,e=document.documentElement.scrollLeft,f=window.scrollY||window.pageYOffset||d||document.body.scrollTop,g=window.scrollX||window.pageXOffset||e||document.body.scrollLeft;return{offsetLeft:c.left+g-a.left,offsetTop:c.top+f-a.top}}}(),ZE.prototype.updateCount=function(a){"use strict";var b=this;switch(a){case"bold":a="b";break;case"italic":a="i";break;case"underline":a="u";break;case"strikethrough":a="st";break;case"justifyleft":a="jl";break;case"justifyright":a="jr";break;case"justifyfull":a="jf";break;case"justifycenter":a="jc";break;case"insertunorderedlist":a="ul";break;case"insertorderedlist":a="ol";break;case"outdent":a="od";break;case"indent":a="id";break;case"removeformat":break;case"link":a="li";break;case"unlink":a="uli";break;case"table":a="ta";break;case"inserthorizontalrule":a="hr";break;case"quote":a="qu";break;case"image":a="img";break;case"spellcheck":a="sp";break;case"subscript":a="ss";break;case"superscript":a="sps";break;case"forecolor":a="fc";break;case"hilitecolor":a="bc";break;case"object":a="ihtm";break;case"edithtml":a="ehtm";break;case"code":a="cod"}b.clickCount[a]?b.clickCount[a]++:b.clickCount[a]=1},ZE.prototype.resize=function(a){"use strict";var b=this,c=b.iframe,d=b.editordiv;a.height&&(d.style.height=a.height+"px",c.style.height=a.height+"px"),a.width&&(d.style.height=a.height+"px",c.style.height=a.height+"px")},ZE.prototype.freeze=function(){"use strict";var a,b=document,c=b.body,d=b.getElementById("ze_freeze");if(d)a=d.style,a.height=Math.max(c.scrollHeight,b.documentElement.scrollHeight)+"px",a.width=c.clientWidth+"px",a.display="";else{var e=b.createElement("div");a=e.style,e.id=e.className="ze_freeze",a.height=Math.max(c.scrollHeight,b.documentElement.scrollHeight)+"px",a.width=c.clientWidth+"px",document.body.appendChild(e),window.addEventListener("resize",function(a){var d=b.getElementById("ze_freeze"),e=d.style;d&&e&&"none"!==e.display&&(c=b.body,e.height=Math.max(c.scrollHeight,b.documentElement.scrollHeight)+"px",e.width=c.clientWidth+"px")},!0)}},ZE.prototype.hideFreeze=function(){"use strict";var a=document.getElementById("ze_freeze");a&&(a.style.display="none")},ZE.conDrop=function(a,b){var c,d,e,f,g=ZE.i18n,h=a.list.length;c=document.createElement("div"),c.id="ze_dropdown",c.className="ze_dd shw";var i=a.type;d=document.createElement("ul");var j=["align","list","indent","textDir","others","lineHeight","scripts","formatingoptions"];a.ulClass&&(d.className=a.ulClass);var k="#ffffff";attachOnClick=function(a){return function(){a.clk(b.initobj.id)}};var l,m=function(a){function b(a){return("0"+parseInt(a).toString(16)).slice(-2)}if(void 0===a.match)return!1;var c=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return null!==c&&"#"+b(c[1])+b(c[2])+b(c[3])};for("backcolor"===a.action?void 0!==(l=b.getFormattingValues("highlight"))&&(l=m(l)):"forecolor"===a.action&&(l=m(b.doc.queryCommandValue("forecolor"))),void 0!==l&&(k=l),f=0;f<h;f++){if(e=document.createElement("li"),"fontsize"==i?e.setAttribute("data-size",a.list[f].datAttr):"fontfamily"==i?"System Font"!==a.list[f].htm&&(e.style.fontFamily=a.list[f].ff):"colorpicker"==i?(e.style.backgroundColor=a.list[f],a.list[f]===k&&(e.className="sel")):j.includes(i)?e.setAttribute("data-"+i,a.list[f].datAttr):"heading"===i&&(e.setAttribute("data-"+i,a.list[f].datAttr),e.style.fontSize=a.list[f].fontsize+"px"),a.list[f].htm)if(a.list[f].datAttr&&"switchmode"==a.list[f].datAttr){if(b.initobj.avoidPlainText||!ZE_Init.needplaintext)continue;"richtext"==a.editr.mode?(ZE_Init.language,e.innerHTML=g("Plain Text Mode")):"plaintext"==a.editr.mode&&(ZE_Init.language,e.innerHTML=g("Rich Text Mode"))}else if(e.innerHTML=a.list[f].htm,"System Font"===a.list[f].htm){var n=document.createElement("li");n.className="ze_lne";var o=document.createElement("b");d.appendChild(n),e.innerHTML="",o.innerHTML=a.list[f].htm,e.appendChild(o),e.className="nohr"}if(a.list[f].liClass&&(e.className=a.list[f].liClass),d.appendChild(e),a.list[f].clk){var p=a.list[f];ZE._addEvent(e,"click",attachOnClick(p))}}c.appendChild(d),document.body.appendChild(c)},ZE.prototype.showDropDown=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=a.target,s=document,t=q.doc;switch(n=["#ffffff","#cceeff","#ccccff","#e5ccff","#ffccff","#ffccee","#ffcccc","#ffe5cc","#ffffcc","#ccffcc","#ccffff","#cccccc","#99ccff","#9999ff","#cc99ff","#ff99ff","#ff99cc","#ff9999","#ffcc99","#ffff99","#99ff99","#99ffff","#c0c0c0","#66ccff","#6666ff","#b266ff","#ff66fe","#ff66b2","#ff6666","#ffb266","#feff66","#66ff66","#66feff","#999999","#399cfd","#3333ff","#9933ff","#ff33fe","#ff3398","#ff3333","#ff9933","#feff33","#33ff33","#33feff","#666666","#3399ff","#0000ff","#7700ff","#ff00ee","#ff0077","#ff0000","#ff7f00","#feff00","#00ff00","#00feff","#444444","#0065cc","#0000cc","#6600cc","#cc00cb","#cc00cc","#cc0000","#cc6600","#cbcc00","#00cc00","#00cbcc","#333333","#004c99","#000099","#4B0099","#990098","#99004c","#990000","#994c00","#989900","#009900","#009899","#000000","#003366","#000066","#330066","#660066","#660032","#660000","#663300","#666600","#006600","#006666"],o=[{htm:"<i class='ze_smilenew'></i>"},{htm:"<i class='ze_sad'></i>"},{htm:"<i class='ze_lol'></i>"},{htm:"<i class='ze_angry'></i>"},{htm:"<i class='ze_tongueout'></i>"},{htm:"<i class='ze_coolnew'></i>"},{htm:"<i class='ze_winknew'></i>"},{htm:"<i class='ze_meh'></i>"},{htm:"<i class='ze_tearofjoy'></i>"},{htm:"<i class='ze_shocked'></i>"},{htm:"<i class='ze_loveit'></i>"},{htm:"<i class='ze_neutral'></i>"},{htm:"<i class='ze_worried'></i>"},{htm:"<i class='ze_yummy'></i>"},{htm:"<i class='ze_sleepy'></i>"},{htm:"<i class='ze_dizzy'></i>"},{htm:"<i class='ze_sick'></i>"},{htm:"<i class='ze_injured'></i>"},{htm:"<i class='ze_idea'></i>"},{htm:"<i class='ze_doubtful'></i>"},{htm:"<i class='ze_tensed'></i>"},{htm:"<i class='ze_searching'></i>"},{htm:"<i class='ze_anxious'></i>"},{htm:"<i class='ze_lipssealed'></i>"},{htm:"<i class='ze_halo'></i>"},{htm:"<i class='ze_like'></i>"},{htm:"<i class='ze_dislike'></i>"},{htm:"<i class='ze_claps'></i>"},{htm:"<i class='ze_yoyo'></i>"},{htm:"<i class='ze_ontarget'></i>"}],d=q.toolbarobject[b],function(){var a=q.toolbardiv.querySelectorAll("[data-dropdown]");a.length&&a.forEach(function(a){a.removeAttribute("data-dropdown")})},l=function(){e&&(document.body.removeChild(e),ZE.removeClass(d,"ze_dn"),"attach"!=b&&ZE.removeClass(d,"ze_Sel"),ZE._removeEvent(s,"mousedown",g),ZE._removeEvent(t,"mousedown",g),ZE._removeEvent(t,"keydown",g)),addremoveDropdownAttrs(!1)},addremoveDropdownAttrs=function(a){"function"==typeof ZE_Init.removeTooltip&&ZE_Init.removeTooltip();var b;q.toolbardiv&&(a?(b=q.toolbardiv.querySelectorAll("[data-tooltip]"),b.length&&b.forEach(function(a){a.setAttribute("data-dropdown",!0)})):(b=q.toolbardiv.querySelectorAll("[data-dropdown]"),b.length&&b.forEach(function(a){a.removeAttribute("data-dropdown")})))},g=function(a){if(e=document.getElementById("ze_dropdown"),"fontsizeEditable"===a.target.getAttribute("id"))return!1;if(a)for(m=a.target;null!==m&&m!==e;)m=m.parentNode;m||l()},f=function(a){var e=a.target;switch("richtext"==q.mode&&p&&(q.win.focus(),q.restoreSelection(p)),b){case"fontfamily":if(q.win.focus(),"UL"===e.nodeName)return!1;q.updateFontfamily(e,d);break;case"fontsize":q.win.focus(),q.updateFontsize(e,d);break;case"forecolor":case"backcolor":q.win.focus(),q.updateColor(e,r,b);break;case"alignoptions":case"listoptions":case"indentoptions":case"scriptoptions":case"formatingoptions":case"heading":q.updateFormatoptions(e,d,c);break;case"directionoptions":q.updateDirectionOptions(e,d,c);break;case"otheroptions":q.updateOtheroptions(e,c);break;case"lineHeight":q.updateFormatoptions(e,d,c);break;case"smiley":if("smartCompose"===q.initobj.type||"function"!=typeof q.initobj.getSmiley){q.insertSmiley(e);break}for(var e=a.target;null!==e;){if("smileydivmn"===e.className)return l(),!0;if("smileyCateg"===e.className)return!0;e=e.parentElement}}l()},addremoveDropdownAttrs(!0),b){case"fontfamily":k={},k.type=b,"function"==typeof ZE_Init._getFontFamily?k.list=ZE_Init._getFontFamily():q.initobj.hasOwnProperty("fontfamilyList")?k.list=q.initobj.fontfamilyList:k.list=ZE_Init.fontfamily();var u,v,w=q.doc.queryCommandValue("fontname"),x=ZE_Init[b].length;if(w){var y,z;for(u=w.split(",")[0].toLowerCase(),v=0;v<x;v++)y=ZE_Init[b][v],z=y.ff.split(",")[0].toLowerCase().replace(/\'/g,'"'),z===u?y.liClass="sel":z===u.split(",")[0].replace(/\"/g,"")?y.liClass="sel":y.liClass=""}break;case"fontsize":k={type:b,list:ZE_Init[b]};var A,B,C=q.doc.queryCommandValue("fontSize");if(fontSizeAnchorArray=ZE_Init[b],fontSizeAnchorArrayLength=fontSizeAnchorArray.length,C||(C=q.getFormattingValues("size")),C){switch(C){case"1":case 1:case"10px":B="1";break;case"2":case 2:case"13px":B="2";break;case"3":case 3:case"16px":B="3";break;case"4":case 4:case"18px":B="4";break;case"5":case 5:case"24px":B="5";break;case"6":case 6:case"32px":B="6";break;case"7":case 7:case"48px":B="7"}for(A=0;A<fontSizeAnchorArrayLength;A++)fontSizeAnchorArray[A].datAttr===B?fontSizeAnchorArray[A].liClass="sel":fontSizeAnchorArray[A].liClass=""}else for(A=0;A<fontSizeAnchorArrayLength;A++)fontSizeAnchorArray[A].liClass="";break;case"forecolor":k={type:"colorpicker",ulClass:"ze_cb",list:n,action:"forecolor"};break;case"backcolor":k={type:"colorpicker",ulClass:"ze_cb",list:n,action:"backcolor"};break;case"smiley":var D=function(a,b){q.insertSmiley(a,b)};if("function"==typeof q.initobj.getSmiley){q.squireInstance.focus();var E=q.initobj.getSmiley(D),F=document.createElement("ul");F.appendChild(E),F.className="ze_smiley";var G=document.createElement("div");G.id="ze_dropdown",G.className="ze_dd shw",E.className="ze_sb",G.appendChild(F),document.body.appendChild(G);var H=E.getElementsByClassName("smileydivmn")[0],I=E.getElementsByClassName("smileyCateg")[0].offsetHeight}else k={type:b,ulClass:"ze_sb",list:o};break;case"otheroptions":k={type:c,list:ZE_Init[c],editr:q},k.ulClass="ze_ddr";break;case"alignoptions":case"listoptions":case"indentoptions":case"scriptoptions":case"formatingoptions":case"heading":case"directionoptions":k={type:c,list:ZE_Init[c]};break;case"attach":k={type:b,list:ZE_Init.attachDrop};break;case"lineHeight":k={type:c,list:ZE_Init[c]}}for(q.win.focus(),"richtext"==q.mode&&(p=q.saveSelection()),("smiley"!==b||"smiley"===b&&"function"!=typeof q.initobj.getSmiley)&&ZE.conDrop(k,q),e=s.getElementById("ze_dropdown"),"fontfamily"==b?e.style.minWidth="189px":"fontsize"==b&&(e.style.minWidth="52px"),"smartCompose"!==q.initobj.editorType&&ZE.addClass(d,"ze_dn"),ZE.addClass(d,"ze_Sel"),ZE._addEvent(e,"click",f),ZE._addEvent(s,"mousedown",g),ZE._addEvent(t,"mousedown",g),ZE._addEvent(t,"keydown",g);"B"!==r.nodeName;)r=r.parentNode;if(h=ZE.getPos(r),i=e.style,"otheroptions"===b?i.left=h.offsetLeft-e.offsetWidth+r.getBoundingClientRect().width+"px":"smiley"===b?"smartCompose"===q.initobj.editorType?(j=s.getElementsByClassName("ze_tbEd")[0].offsetWidth,i.left=h.offsetLeft+j-2+"px"):i.left=h.offsetLeft-e.offsetWidth+r.getBoundingClientRect().width+5+"px":i.left=h.offsetLeft+"px","smiley"===b&&"smartCompose"===q.initobj.editorType){document.body.offsetHeight<r.getBoundingClientRect().top+e.offsetHeight?i.top=h.offsetTop-e.offsetHeight+34+"px":i.top=h.offsetTop+"px"}else i.top=h.offsetTop+r.offsetHeight-1+"px";if(e.style.display="block",rectObj=document.body.getBoundingClientRect(),dropRectObj=e.getBoundingClientRect(),dropRectObj.height+dropRectObj.top>rectObj.height){var J=dropRectObj.height+dropRectObj.top-rectObj.height;if(e.firstChild.style.height=dropRectObj.height-J-50+"px","smiley"===b&&"function"==typeof q.initobj.getSmiley){var K=F.offsetHeight;H.style.height=K-I-30+"px"}}},ZE.prototype.updateFontfamily=function(a,b){var c,d=this;d.doc,d.getContent({plaintext:!0});b.firstChild.innerHTML=a.innerHTML,b.firstChild.style.fontFamily=a.innerHTML+",helvetica, sans-serif",c=a.style.fontFamily,b.hasAttribute("sel")&&b.removeAttribute("sel"),d.win.focus(),d.squireInstance.setFontFace(c),d.saveCurrentState()},ZE.prototype.updateFontsize=function(a,b){var c=this;c.doc,c.getContent();"UL"===a.nodeName?b.firstChild.innerHTML=parseInt(ZE_Init.defaultFontSize):b.firstChild.innerHTML=a.innerHTML,b.hasAttribute("sel")&&b.removeAttribute("sel"),c.win.focus();var d=(a.getAttribute("data-size"),document.getElementById("fontsizeEditable"));d&&(d.contentEditable=!1);var e=4/3*parseFloat(a.innerText);c.squireInstance.setFontSize(e+"px"),c.saveCurrentState()},ZE.prototype.updateColor=function(a,b,c){var d,e,f,g=this,h=g.doc;g.getContent();for(d=a.style.backgroundColor,b.hasAttribute("sel")&&b.removeAttribute("sel"),d=d.replace(/rgb\(|\)/g,"").split(","),f=d.length,e=0;e<f;e++)d[e]=parseInt(d[e],10).toString(16),d[e]=1==d[e].length?"0"+d[e]:d[e];if(d="#"+d.join(""),g.win.focus(),"backcolor"==c?g.squireInstance.setHighlightColour(d):"forecolor"==c&&g.squireInstance.setTextColour(d),"backcolor"==c){var i=h.queryCommandValue("backcolor");"number"==typeof i?b.firstChild.style.borderBottom="3px rgb("+(255&i)+","+(i>>8&255)+","+(i>>16&255)+") solid":("transparent"==i&&(i=g.getFormattingValues("highlight")||"white"),b.firstChild.style.borderBottom="3px "+i+" solid")}else{var i=h.queryCommandValue("forecolor");b.firstChild.style.borderBottomColor="number"==typeof i?"rgb("+(255&i)+","+(i>>8&255)+","+(i>>16&255)+")":h.queryCommandValue("forecolor")}g.saveCurrentState()},ZE.prototype.updateDirectionOptions=function(a,b,c){var d=this,e=ZE.i18n,f=a.getAttribute("data-"+c)||b.getAttribute("data-attr");b.hasAttribute("sel")&&b.removeAttribute("sel"),d.win.focus();var g={"zei-rtl":e("RTL"),"zei-ltr":e("LTR")};switch(f){case"rtl":case"RTL":d.squireInstance.setTextDirection("rtl"),b.firstChild.className="zei-rtl",curNode=b.firstChild,d.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-rtl"]):curNode.title=g["zei-rtl"];break;case"ltr":case"LTR":d.squireInstance.setTextDirection("ltr"),b.firstChild.className="zei-ltr",curNode=b.firstChild,d.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-ltr"]):curNode.title=g["zei-ltr"]}d.saveCurrentState()},ZE.prototype.updateFormatoptions=function(a,b,c){var d,e=this,f=ZE.i18n,g=(e.doc,{"zei-textleft":f("Align left"),"zei-textright":f("Align right"),"zei-textcenter":f("Align center"),"zei-textjustify":f("Align justify"),"zei-order":f("Number list"),"zei-unorder":f("Bullet list"),"zei-indent":f("Increase Indent"),"zei-outdent":f("Decrease Indent"),"zei-rtl":f("RTL"),"zei-ltr":f("LTR"),"zei-superScript":f("Superscript"),"zei-subScript":f("Subscript"),"zei-formatpaint":f("Format Painter"),"zei-removeformat":f("Remove Formatting")});switch(b.hasAttribute("sel")&&b.removeAttribute("sel"),d=a.getAttribute("data-"+c)||b.getAttribute("data-attr"),e.win.focus(),d){case"Normal":e.doc.execCommand("formatBlock",!1,"<div>"),b.firstChild.innerHTML="1.2 (Normal)";break;case"Heading1":e.doc.execCommand("formatBlock",!1,"<H1>"),b.firstChild.innerHTML="Heading1";break;case"Heading2":e.doc.execCommand("formatBlock",!1,"<H2>"),b.firstChild.innerHTML="Heading2";break;case"Heading3":e.doc.execCommand("formatBlock",!1,"<H3>"),b.firstChild.innerHTML="Heading3";break;case"Heading4":e.doc.execCommand("formatBlock",!1,"<H4>"),b.firstChild.innerHTML="Heading4";break;case"Heading5":e.doc.execCommand("formatBlock",!1,"<H5>"),b.firstChild.innerHTML="Heading5";break;case"Heading6":e.doc.execCommand("formatBlock",!1,"<H6>"),b.firstChild.innerHTML="Heading6";break;case"justifyleft":e.squireInstance.setTextAlignment("left"),curNode=b.firstChild,"zei-textleft\tze_txt"!==curNode.className&&(curNode.className="zei-textleft",curNode.className="zei-textleft",e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-textleft"]):curNode.title=g["zei-textleft"]);break;case"justifyright":e.squireInstance.setTextAlignment("right"),curNode=b.firstChild,"zei-textright\tze_txt"!==curNode.className&&(curNode.className="zei-textright",e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-textright"]):curNode.title=g["zei-textright"]);break;case"justifyfull":e.squireInstance.setTextAlignment("justify"),curNode=b.firstChild,"zei-textjustify\tze_txt"!==curNode.className&&(curNode.className="zei-textjustify",e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-textjustify"]):curNode.title=g["zei-textjustify"]);break;case"justifycenter":e.squireInstance.setTextAlignment("center"),curNode=b.firstChild,"zei-textcenter\tze_txt"!==curNode.className&&(curNode.className="zei-textcenter",e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-textcenter"]):curNode.title=g["zei-textcenter"]);break;case"insertunorderedlist":case"Bullet":if(e.insertListOperation("UL"),"Bullets"===b.title)return;curNode=b.firstChild,curNode.className="zei-unorder",e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-unorder"]):curNode.title=g["zei-unorder"];break;case"insertorderedlist":case"Numbering":if(e.insertListOperation("OL"),"Numbering"===b.title)return;curNode=b.firstChild,curNode.className="zei-order",e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-order"]):curNode.title=g["zei-order"];break;case"removelist":e.squireInstance.removeList();break;case"checkbox":e.squireInstance.makeUnorderedList({class:""}),e.updateToolbar();break;case"indent":e.getPosFromCursor("UL")>0||e.getPosFromCursor("OL")>0?e.squireInstance.increaseListLevel():e.squireInstance.increaseQuoteLevel(),b.firstChild.className="zei-indent",curNode=b.firstChild,e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-indent"]):curNode.title=g["zei-indent"];break;case"outdent":var h=e.getPosFromCursor("OL"),i=e.getPosFromCursor("UL");-1==h&&-1==i?e.squireInstance.decreaseQuoteLevel():i>h?e.getPosFromCursor("UL",1)>0||e.getPosFromCursor("OL")>0?e.squireInstance.decreaseListLevel():e.squireInstance.removeList():h>i&&(e.getPosFromCursor("OL",1)>0||e.getPosFromCursor("UL")>0?e.squireInstance.decreaseListLevel():e.squireInstance.removeList()),b.firstChild.className="zei-outdent",curNode=b.firstChild,e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-outdent"]):curNode.title=g["zei-outdent"];break;case"singleInd":e.squireInstance.setLineHeight("1.0");break;case"normalInd":e.squireInstance.setLineHeight("1.2");break;case"mediumInd":e.squireInstance.setLineHeight("1.5");break;case"doubleInd":e.squireInstance.setLineHeight("2.0");break;case"superscript":currentState=e.doc.queryCommandState(d),currentState?e.squireInstance.removeSuperscript():e.squireInstance.superscript(),e.saveCurrentState(),b.firstChild.className="zei-superScript",curNode=b.firstChild,e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-superScript"]):curNode.title=g["zei-superScript"],e.updateToolbar();break;case"subscript":currentState=e.doc.queryCommandState(d),currentState?e.squireInstance.removeSubscript():e.squireInstance.subscript(),e.saveCurrentState(),b.firstChild.className="zei-subScript",curNode=b.firstChild,e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-subScript"]):curNode.title=g["zei-subScript"],e.updateToolbar();break;case"formatpainter":e.formatPainter(),curNode=b.firstChild,curNode.className="zei-formatpaint",e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-formatpaint"]):curNode.title=g["zei-formatpaint"];break;case"removeformat":var j,k=e.getContent();e.win.focus(),ZE_Init.is_ie?e.squireInstance.removeAllFormatting(null):e.doc.execCommand(d,!1,void 0),j=e.getContent(),j!==k&&e.saveCurrentState(),curNode=b.firstChild,curNode.className="zei-removeformat",e.initobj.customTooltip?curNode.setAttribute("data-tooltip",g["zei-removeformat"]):curNode.title=g["zei-removeformat"]}e.saveCurrentState()},ZE.prototype.IndentOptions=function(a){var b=this;switch(a){case"indent":b.getPosFromCursor("UL")>0||b.getPosFromCursor("OL")>0?b.squireInstance.increaseListLevel():b.squireInstance.increaseQuoteLevel();break;case"outdent":var c=b.getPosFromCursor("OL"),d=b.getPosFromCursor("UL");-1==c&&-1==d?b.squireInstance.decreaseQuoteLevel():d>c?b.getPosFromCursor("UL",1)>0||b.getPosFromCursor("OL")>0?b.squireInstance.decreaseListLevel():b.squireInstance.removeList():c>d&&(b.getPosFromCursor("OL",1)>0||b.getPosFromCursor("UL")>0?b.squireInstance.decreaseListLevel():b.squireInstance.removeList())}},ZE.prototype.updateOtheroptions=function(a,b){var c=this,d=a.getAttribute("data-"+b)||a.getAttribute("title");c.win.focus(),"switchmode"==d?"richtext"==c.mode?c.confirmPlainText(c.getContent()):"plaintext"==c.mode&&c.richText(c.getContent()):"spellcheck"==d&&c.spellcheck()},ZE.prototype.insertSmiley=function(a,b){var c,d,e=this,f=ZE.getContextValue(),g="vertical-align:middle; width:24px; height:24px;";if(e.win.focus(),"function"!=typeof e.initobj.getSmiley){if(d=ZE_Init.smileyPath||f+"/ze/images/","LI"==a.nodeName&&(a=a.firstChild),0!=a.className.indexOf("ze_")||"I"!=a.nodeName)return;c=a.className.replace("ze_",""),e.pasteHTML("<IMG style='"+g+"' src='"+d+c+".gif'></IMG>")}else e.pasteHTML("<img data-attr='smiley' title="+b+" style = '"+g+"' src = '"+a+"'></img>");e.saveCurrentState()},ZE.prototype.createToolbar=function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=this,C={},D=B.initobj.toolbar,E=document,F=(E.body,E.createDocumentFragment()),G=ZE.i18n,H=(ZE_Init.imgPath,0),I=function(a){return function(){a(B.initobj.id,B)}};if(document.getElementsByClassName("ze_tbEd").length>=1)if(e=E.getElementsByClassName("ze_tbEd")[0],v=E.getElementsByClassName("IconDiv")[0],w=E.getElementById("stickIcon"),"zei-unpin"===w.className){if("paragraph"!==a&&"insert"!==a)return!1}else v.parentElement.removeChild(v),e.parentElement.removeChild(e);if(x=function(b,c){var d,f,g,h,i=0,j=0,k=B._microdiv;"insert"===c?d=B._microdiv.childNodes[0]:"paragraph"===c&&(d=B._microdiv.childNodes[1]),f=d.className,h=d.getBoundingClientRect(),"ui-insert"!==f&&"ui-paragraph"!==f||(d.className=f+"\tsel"),
g=k.getBoundingClientRect(),i=E.body.offsetLeft+g.left,j=E.body.offsetTop+g.top,B.iframe.contentWindow.scrollX&&(i-=B.iframe.contentWindow.scrollX),g.left-e.offsetWidth>=0?(i-=e.offsetWidth,"paragraph"===a&&(i+=h.left-g.left)):(i+=g.width,"insert"===a?i=i-h.width-8:"paragraph"===a&&(i-=4)),document.body.offsetHeight-e.offsetHeight/3<e.offsetHeight+j&&(j=j-e.offsetHeight+19),e.style.left=i+"px",e.style.top=j+"px"},e=E.createElement("div"),"general"===a)c=B.initobj.toolbarOrder?B.initobj.toolbarOrder:D?ZE_Init.toolbarOrderGenerate(D):ZE_Init.SmarttoolbarOrder;else if("paragraph"===a)c=ZE_Init.Paragraphtoolbar;else if("insert"===a){if(B.initobj.customToolbar){B.getDropObj(B.initobj.customToolbar());var J=B.DrawList();return e.style.position="absolute",e.className="ze_tbEd ze_SCmbN",e.appendChild(J),document.body.appendChild(e),void x(b,a)}c=ZE_Init.insertToolbar}f=function(a){return function(b){B._stopEvent(b);var c=B._getSelection();try{B._createRange(c)}catch(d){B.range?(B.range.select(),delete B.range):B.win.focus()}return"function"==typeof ZE_Init.toolbarClickTriggered&&ZE_Init.toolbarClickTriggered(),B.execCommand(b,a),!1}},ZE_Init.needEditorBorder||(d.style.borderWidth="0px"),B.toolbarobject=C,"insert"===a?e.className="ze_tbEd ze_SCmbN":"paragraph"===a?e.className="ze_tbEd ze_SCmbPI":(e.className="ze_tbEd",e.style.boxSizing="border-box");var K=function(a){return B._stopEvent(a),!1};A=function(){return function(a){B._stopEvent(a);var b,c=a.target.className,d=B._getSelection();try{B._createRange(d)}catch(e){B.range?(B.range.select(),delete B.range):B.win.focus()}switch(c){case"zei-order":b="insertorderedlist";break;case"zei-unorder":b="insertunorderedlist";break;case"zei-textleft":b="j-left";break;case"zei-textright":b="j-right";break;case"zei-textfull":b="j-full";break;case"zei-textcenter":b="j-center"}return B.execCommand(a,b),B.saveCurrentState(),!1}},y=function(a){a.stopPropagation(),e=E.getElementsByClassName("ze_tbEd")[0],E.getElementsByClassName("ze_tbEd").length>=1&&(e.parentElement.removeChild(e),v.parentElement.removeChild(v))},z=function(a){a.stopPropagation();var b=E.getElementById("stickIcon"),c=b.className;"zei-pin"===c?(b.className="",b.className="zei-unpin"):"zei-unpin"===c&&(b.className="",b.className="zei-pin")},u=function(){var a;if(a=E.createElement("div"),a.className="zei-close",w=document.createElement("div"),w.className="zei-pin",w.id="stickIcon",v=E.createElement("div"),v.style.zIndex="1000",v.className="IconDiv",v.appendChild(w),v.appendChild(a),E.getElementsByClassName("IconDiv")[0]){var b=E.getElementsByClassName("IconDiv")[0];b.parentElement.removeChild(b)}E.body.appendChild(v),t=v.style,t.position="absolute",t.left=e.offsetLeft+e.offsetWidth-37+"px",t.top=e.offsetTop-15+"px",ZE._addEvent(a,"mousedown",y),ZE._addEvent(w,"mousedown",z)};var L=function(a){var b=document.getElementsByClassName("ze_tbEd")[0],c=b.offsetWidth,d=ZE.getPos(B.editordiv),e=B.doc.getSelection().getRangeAt(0).getBoundingClientRect(),f=b.style,g=a.top;g<0&&(g=0),f.top=d.offsetTop+g-b.offsetHeight+"px";var h=B.editordiv.offsetWidth-e.width;h>b.offsetWidth?f.left=d.offsetLeft+e.left+"px":f.left=d.offsetLeft+e.left-h+"px",c!==b.offsetWidth&&(b.style.left=parseInt(b.style.left)-c+"px")};for(h=E.createElement("ul"),g=c.length,H=0;H<g;H++){for("insert"!==a&&H>0&&(h=E.createElement("ul")),k=c[H],l=0,o=k.length;l<o;l++){p=k[l],q=p[0],r=p[2],"paragraph"===a&&"alignLeft"===q?h.className="ta":"paragraph"!==a||"NumBullets"!==q&&"LefttoRight"!==q||(h.className="fl"),i=E.createElement("li"),h.appendChild(i),m=E.createElement("b"),"heading"!==q&&"fontsize"!==q&&"fontfamily"!==q&&"forecolor"!==q&&"backcolor"!==q&&"alignoptions"!==q&&"listoptions"!==q||(m.className="zeSeldd"),"heading"!==q&&"fontsize"!==q&&"fontfamily"!==q||(m.className="ze_ddBg"),"forecolor"!==q&&"backcolor"!==q&&"alignoptions"!==q&&"listoptions"!==q||(m.className="ze_Seldd"),"fontsize"===q&&(n=E.createElement("span"),m.style.minWidth="36px",m.appendChild(n),n.className="ze_txt"),"fontfamily"===q&&(n=E.createElement("span"),n.style.width="100px",n.className="ze_txt",m.style.width="194px",m.appendChild(n)),"heading"===q&&(n=E.createElement("span"),n.innerHTML="Heading1",n.className="ze_txt","general"===a?m.style.width="158px":"paragraph"===a&&(m.style.width="142px"),m.appendChild(n));var M,N=E.createElement("span");N.className=r,"insert"===a&&(N.innerHTML=p[1]),"plainText"===q&&(m.innerHTML="plainText"),"fontsize"===q&&(N.style.cssFloat="right"),m.appendChild(N),"attach"!==q&&"spellcheck"!==q||(M=document.createElement("span"),M.className="zei-arrow",m.appendChild(M)),"alignoptions"!==q&&"listoptions"!==q||(M=document.createElement("span"),M.className="zei-arrow bdr",m.appendChild(M)),i.appendChild(m);var O={alignLeft:G("justifyleft"),alignRight:G("justifyright"),alignCenter:G("justifycenter"),alignjustify:G("justifyfull"),NumBullets:G("Bullet"),DotBullets:G("Numbering"),RightToLeft:G("RTL"),LefttoRight:G("LTR")};q in O&&m.setAttribute("data-attr",O[q]),m.title=G(p[1]),m.title=G(p[1]),"alignoptions"===q||"listoptions"===q?(ZE._addEvent(M,"click",f(q)),ZE._addEvent(M,"mousedown",K),ZE._addEvent(N,"click",A()),ZE._addEvent(N,"mousedown",K)):"custom"===q?(ZE._addEvent(m,"click",I(p[3])),ZE._addEvent(m,"mousedown",K)):(ZE._addEvent(m,"click",f(q)),ZE._addEvent(m,"mousedown",K)),C[q]=m,0!==l&&(j=document.createElement("div"),m.appendChild(j))}("general"===a&&(0===H||3===H)||"insert"===a&&0===H)&&(s=E.createElement("div")),"paragraph"===a?e.appendChild(h):s.appendChild(h),("general"===a&&(2===H||7===H)||"insert"===a&&7===H)&&e.appendChild(s)}"function"==typeof ZE_Init.afterToolbarGenerate&&ZE_Init.afterToolbarGenerate(C);var P,Q,R,S,T,U,V,W,X,Y,Z=0,$=0,_=0,aa=0,ba=document.body.offsetWidth;Y=function(){P=null,ZE._removeEvent(document.body,"mousemove",R)},R=function(a){Z=a.pageX,$=a.pageY,U=e.offsetWidth,P&&(S=Z-_,T=$-aa,V=ba+16-P.getBoundingClientRect().right,S>1&&T>1?(W=S,X=T,P.style.left=S+"px",P.style.top=T+"px",t.left=P.offsetLeft+P.offsetWidth-37+"px",t.top=P.offsetTop-14+"px"):(P.style.left=W+"px",P.style.top=X+"px"))},Q=function(a){e.style.cursor="hand",Z=a.pageX,$=a.pageY,"ze_tbEd"===a.target.className&&(P=e,_=Z-P.offsetLeft,aa=$-P.offsetTop,ZE._addEvent(document.body,"mousemove",R),ZE._addEvent(document.body,"mouseup",Y))},e.appendChild(F),ZE._addEvent(e,"mousedown",Q),ZE._addEvent(e,"mouseup",function(a){return a.stopPropagation(),!1}),E.body.appendChild(e),e.style.position="absolute","general"!==a?x(b,a):(L(b),u()),B.updateToolbar()},ZE.prototype.saveSelection=function(){"use strict";var a,b=this,c=(document,b.doc),d=b.win.getSelection?b.win.getSelection():c.selection;try{d&&(d.createRange?a=d.createRange():d.getRangeAt?0==d.rangeCount?b.focusAtStart(!0):a=d.getRangeAt(0):d.anchorNode&&d.focusNode&&c.createRange&&(a=c.createRange(),a.setStart(d.anchorNode,d.anchorOffset),a.setEnd(d.focusNode,d.focusOffset),a.collapsed!==d.isCollapsed&&(a.setStart(d.focusNode,d.focusOffset),a.setEnd(d.anchorNode,d.anchorOffset))))}catch(e){}return a},ZE.prototype.restoreSelection=function(a){"use strict";var b=this,c=(document,b.doc),d=b.win.getSelection?b.win.getSelection():c.selection;d&&a&&(a.select?a.select():d.removeAllRanges&&d.addRange&&(d.removeAllRanges(),d.addRange(a)))},ZE.prototype._getSelection=function(){"use strict";return"comment"!==this.initobj.type?this.win.getSelection():document.getSelection()},ZE.prototype._createRange=function(a){"use strict";try{return a.getRangeAt(0)}catch(b){return this.doc.createRange()}},ZE.prototype._getSelectedText=function(){"use strict";try{var a=this._getSelection();if(a)return a.toString()}catch(b){return}},ZE.prototype.getParentElement=function(){"use strict";var a=this,b=a._getSelection(),c=a._createRange(b),d=c.commonAncestorContainer;try{for(!c.collapsed&&c.startContainer==c.endContainer&&c.startOffset-c.endOffset<=1&&c.startContainer.hasChildNodes()&&(d=c.startContainer.childNodes[c.startOffset]);3===d.nodeType;)d=d.parentNode;return d}catch(e){return}},ZE.prototype.pasteHTML=function(a){"use strict";var b,c,d=this,e=d.win;if(e.getSelection){if(b=e.getSelection(),b.getRangeAt&&b.rangeCount){c=b.getRangeAt(0),c.deleteContents();var f=d.doc.createElement("div");f.innerHTML=a;for(var g,h,i=d.doc.createDocumentFragment();g=f.firstChild;)h=i.appendChild(g);c.insertNode(i),h&&(c=c.cloneRange(),c.setStartAfter(h),c.collapse(!0),b.removeAllRanges(),b.addRange(c))}}else d.doc.selection&&"Control"!==d.doc.selection.type&&d.doc.selection.createRange().pasteHTML(a)},ZE.prototype.insertHTML=function(a,b){"use strict";var c=this,d=c.mode;d&&"plaintext"===d?c.insertText(a):(c.win.focus(),c.squireInstance?c.squireInstance.insertHTML(a,null,{avoidSanitize:!0}):c.pasteHtml(a),b||c.saveCurrentState())},ZE.prototype.insertText=function(a){"use strict";var b=this,c=b._textarea,d=c.value,e=c.selectionStart,f=c.selectionEnd;c&&(a=ZE.getText(a),e||0===e?c.value=d.substring(0,e)+a+d.substring(f,d.length):c.value+=a,c.focus())},ZE.prototype.getAllAncestors=function(){"use strict";for(var a=this,b=a.getParentElement(),c=[];b&&1===b.nodeType&&"body"!==b.tagName.toLowerCase();)c.push(b),b=b.parentNode;return c.push(a.doc.body),c},ZE.prototype.createImage=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R=this,S=document.getElementById("ze_ins_image"),T=ZE.i18n,U="bestfit",V=R.getParentElement(),W=R.initobj.imgMaxUploadSize||ZE_Init.maxImageUploadSize||3,X=W+" MB";W<1&&(X=1024*W+" KB"),b="function"==typeof R.initobj.getImgUploadAction?R.initobj.getImgUploadAction():R.initobj.imgAction||ZE_Init.imgAction;V&&"IMG"!==V.nodeName&&(V=void 0),"function"==typeof R.initobj.getImgUploadParameters?b+=R.initobj.getImgUploadParameters():("function"==typeof ZE_Init.imgParametersFunction&&ZE_Init.imgParametersFunction(),ZE_Init.imgParameters&&(b+=ZE_Init.imgParameters));var Y=function(){S.parentNode.removeChild(S),ZE.hideOverlay(),e.disabled=c.disabled=d.disabled=g.disabled=!1,a&&a.reset(),R.win.focus(),ZE._removeEvent(document,"keydown",Z),ZE._removeEvent(R.doc,"keydown",Z),i.removeAttribute("src"),j.removeAttribute("src"),i.style.display="none",j.style.display="none",ZE.activeEditor&&delete ZE.activeEditor,ZE.captchaProcessing&&delete ZE.captchaProcessing},Z=function(a){var b=document.getElementById("ze_captcha");if(27==a.keyCode){if(b&&"none"!==b.style.display)return void(b.style.display="none");R._stopEvent(a),Y()}},$=function(){var a=R.initobj.defaultImageOption||U;ZE.removeClass(B,"zei-unoption"),ZE.addClass(B,"zei-option"),ZE.removeClass(A,"zei-option"),ZE.addClass(A,"zei-unoption"),"bestfit"===a?(ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-unoption"),ZE.addClass(D,"zei-option"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption")):"smallfit"===a?(ZE.removeClass(C,"zei-unoption"),ZE.addClass(C,"zei-option"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption")):(ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-unoption"),ZE.addClass(E,"zei-option")),s.style.display="",t.style.display="none",i.src?(i.style.display="",x.style.display="none",n.style.display="",k.style.display="none",l.style.display="none"):(x.style.display="block",i.style.display="none",o&&"finished"!=o?o&&"loading"==o&&(l.style.display="",k.style.display="none"):(ZE.insertImageMsg(T("Maximum file size supported: "+X),"imginfo"),ZE.removeClass(k,"ze_popuperrmsg"),l.style.display="none")),j.style.display="none"},_=function(a){a.stopPropagation();var b=R.initobj.defaultImageOption||U;ZE.removeClass(B,"zei-option"),ZE.addClass(B,"zei-unoption"),ZE.removeClass(A,"zei-unoption"),ZE.addClass(A,"zei-option"),"bestfit"===b?(ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-unoption"),ZE.addClass(D,"zei-option"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption"),ZE.removeClass(F,"zei-option"),ZE.addClass(F,"zei-unoption")):"smallfit"===b?(ZE.removeClass(C,"zei-unoption"),ZE.addClass(C,"zei-option"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption"),ZE.removeClass(F,"zei-option"),ZE.addClass(F,"zei-unoption")):(ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-unoption"),ZE.addClass(E,"zei-option"),ZE.removeClass(F,"zei-option"),ZE.addClass(F,"zei-unoption")),s.style.display="none",t.style.display="",i.style.display="none",j.src?(j.style.display="",x.style.display="none"):(j.style.display="none",x.style.display="block"),f.focus(),n.style.display="none",k.style.display="none",l.style.display="none"},aa=function(){V?g.focus():d.checked&&f.focus()},ba=function(){var o=S.getElementsByTagName("input");e=o[0],f=o[1];var y=S.getElementsByTagName("span"),z=S.getElementsByTagName("label");c=y[0],d=y[1],m=z[2],k=y[2],l=y[3],n=y[4],u=y[5],v=y[6],w=y[7],N=y[8],x=y[9],g=y[14],h=y[15],I=y[10],H=y[12],J=y[11],K=y[13],a=document.ze_img_form,a.action=b;var Q=S.getElementsByTagName("div");s=Q[3],t=Q[5],G=s=Q[4];var R=S.getElementsByTagName("td");r=R[0],p=S.getElementsByTagName("i"),q=p[1],i=document.getElementById("ze_comp_img"),j=document.getElementById("ze_url_img"),i.removeAttribute("src"),j.removeAttribute("src"),B=c.getElementsByTagName("i")[0],A=d.getElementsByTagName("i")[0],C=u.getElementsByTagName("i")[0],D=v.getElementsByTagName("i")[0],E=w.getElementsByTagName("i")[0],F=N.getElementsByTagName("i")[0],M=I.getElementsByTagName("i")[0],L=H.getElementsByTagName("i")[0],O=J.getElementsByTagName("i")[0],P=K.getElementsByTagName("i")[0],V?(_(event),r.style.display="none",j.src=V.src,j.style.display="",f.disabled=!0,f.value=V.src):($(),r.style.display="",f.disabled=!1)};ZE.showOverlay(),R.win.focus(),Q=R.saveSelection();var ca='<div class="zep_PUtt">'+T("Insert Image")+'<i class="zei-close"></i></div>';ca+='<div class="zep_PUcen"><form name="ze_img_form" method="post" enctype="multipart/form-data" action="'+b+'" target="ze_img_request">',ca+='<table class="ze_ptble">',ca+="<tbody>",ca+="<tr>",ca+='<td colspan="2" style="padding-bottom:10px;"><span><i class="zei-option"></i>&nbsp;',ca+='<label for="ze_img_comp">'+T("Upload from Disk")+"</label>&nbsp;",ca+='</span>&nbsp;<span><i class="zei-unoption"></i>&nbsp;',ca+='<label for="ze_img_url">'+T("Link from Web (Url)")+"</label>&nbsp;",ca+="</span></td>",ca+="</tr>",ca+="<tr>",ca+='<td colspan="2" style="padding-bottom:10px;">',ca+="<div>",ca+='<div style="height:0px;width:0px;visibility:hidden;">',ca+='<input id="uploadfile" type="file" name="img_file">',ca+="</div>",ca+="<div>",ca+='<label for="uploadfile" id="ze_choose_image" class="ze_input_text">'+T("Click to choose an image")+"</label>",ca+="</div>",ca+='<div style="display: none;"><input  class="ze_input_text"  type="text" placeholder = "'+T("Provide an image URL")+'"></div>',ca+="</div>",ca+='<p class="ze_iiSnF"><span>'+(T("Maximum file size supported: ")+X)+'</span></p><span style="display: none;"><img src="'+ZE_Init.imgPath+'/images/process.gif" align="absmiddle" style="margin-right:3px;"><b style="color:#1daf15;">'+T("Uploading image...")+'</b></span><span class="ze_iiSnF" style="display:none;"></span>',ca+="</td>",ca+="</tr>",ca+="<tr>",ca+='<td valign="middle">',ca+='<div class="ze_iiS"><span><i class="zei-unoption"></i>&nbsp;',ca+='<label for="ze_img_comp">'+T("Small")+"</label>",ca+="</span></div>",ca+='<div class="ze_iiS"><span><i class="zei-unoption"></i>&nbsp;',ca+='<label for="ze_img_comp">'+T("Best Fit")+"</label>",ca+="</span></div>",ca+='<div class="ze_iiS"><span><i class="zei-option"></i>&nbsp;',ca+='<label for="ze_img_comp">'+T("Original")+"</label>",ca+="</span></div>",ca+='<div class="ze_iiS"><span><i class="zei-unoption"></i>&nbsp;',ca+='<label for="ze_img_comp">'+T("Fit to Width")+"</label>",ca+="</span></div></td>",ca+='<td  width="122"><div class="ze_iiI"><span class="ze_iiIP" style="display: block;">Image Preview</span><img id="ze_comp_img" display:="" none;"="" style="display: none;"><img id="ze_url_img" style="width: 120px; height: 120px; display: none;"></div></td>',ca+="</tr>",ca+="<tr>",ca+='<td class = "ze_image_align">',ca+="<div><b>"+T("Alignment Options")+"</b></div>",ca+='<div class = "ze_image_list">',ca+='<span> <i class = "zei-option"></i> <label for="ze_img_comp">'+T("Bottom")+"</label></span>",ca+='<span> <i class = "zei-unoption"></i> <label for="ze_img_comp">'+T("Left")+"</label></span>",ca+='<span> <i class = "zei-unoption"></i> <label for="ze_img_comp">'+T("Top")+"</label></span>",ca+='<span> <i class = "zei-unoption"></i> <label for="ze_img_comp">'+T("Right")+"</label></span>",ca+="</div></td></tr>",ca+='</tbody></table><input type="hidden" name="'+ZE.getCSRFParamName()+'" value="'+ZE.getCSRFCookie(R)+'"/></form>',ca+="</div>",ca+='<div class="zep_PUbtm"><span style="opacity:0.5 !important;pointer-events:none" class="sel">Insert</span><span data-val="Cancel">Cancel</span></div>';var da=document.createElement("div");da.className="zep_PU",da.id="ze_ins_image",da.name="ze_ins_image",da.innerHTML=ca,document.body.appendChild(da),S=da,ba(),ZE.setPosition(S,R.editordiv),aa(),ZE._addEvent(R.doc,"keydown",Z),ZE._addEvent(document,"keydown",Z),c.onclick=function(a){i.hasAttribute("src")?g.removeAttribute("style"):(g.style.opacity=.5,g.style.pointerEvents="none"),a.stopPropagation(),document.getElementById("ze_comp_img")&&(document.getElementById("ze_comp_img").style.display=""),document.getElementById("ze_url_img")&&(document.getElementById("ze_url_img").style.display="none"),$(),aa()},d.onclick=function(a){j.hasAttribute("src")?g.removeAttribute("style"):(g.style.opacity=.5,g.style.pointerEvents="none"),document.getElementById("ze_comp_img")&&(document.getElementById("ze_comp_img").style.display="none"),document.getElementById("ze_url_img")&&(document.getElementById("ze_url_img").style.display=""),_(a),aa()},u.onclick=function(a){a.stopPropagation(),ZE.removeClass(C,"zei-unoption"),ZE.addClass(C,"zei-option"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption"),ZE.removeClass(F,"zei-option"),ZE.addClass(F,"zei-unoption")},v.onclick=function(a){a.stopPropagation(),ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-unoption"),ZE.addClass(D,"zei-option"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption"),ZE.removeClass(F,"zei-option"),ZE.addClass(F,"zei-unoption")},N.onclick=function(a){a.stopPropagation(),ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption"),ZE.removeClass(E,"zei-option"),ZE.addClass(E,"zei-unoption"),ZE.removeClass(F,"zei-unoption"),ZE.addClass(F,"zei-option")},w.onclick=function(a){a.stopPropagation(),ZE.removeClass(C,"zei-option"),ZE.addClass(C,"zei-unoption"),ZE.removeClass(D,"zei-option"),ZE.addClass(D,"zei-unoption"),ZE.removeClass(E,"zei-unoption"),ZE.addClass(E,"zei-option"),ZE.removeClass(F,"zei-option"),ZE.addClass(F,"zei-unoption")};var ea=function(a){for(var b in a){var c=a[b];ZE.removeClass(c,"zei-option"),ZE.addClass(c,"zei-unoption")}},fa={};H.onclick=function(a){a.stopPropagation(),ZE.removeClass(L,"zei-unoption"),ZE.addClass(L,"zei-option"),fa={n1:M,n2:O,n3:P},ea(fa)},I.onclick=function(a){a.stopPropagation(),ZE.removeClass(M,"zei-unoption"),ZE.addClass(M,"zei-option"),fa={n1:L,n2:O,n3:P},ea(fa)},J.onclick=function(a){a.stopPropagation(),ZE.removeClass(O,"zei-unoption"),ZE.addClass(O,"zei-option"),fa={n1:M,n2:L,n3:P},ea(fa)},K.onclick=function(a){a.stopPropagation(),ZE.removeClass(P,"zei-unoption"),ZE.addClass(P,"zei-option"),fa={n1:M,n2:O,n3:L},ea(fa)},url_img_upload=function(a){var b,c=f.value;if(0!==c.length){var d="http://",e="https://";if(0!==f.value.indexOf(d)&&0!==f.value.indexOf(e))return b=T("Invalid URL. Make sure it starts with "+d+" or "+e+". "),ZE.insertImageMsg(b,"error"),x.style.display="block",j.style.display="none",void j.removeAttribute("src");if(c&&j.src!==c){var h=c.lastIndexOf("."),i=c.length;if("svg"===c.slice(h+1,i).toLowerCase())return b=T("Oops!  .svg image types are not supported. Try with another format."),ZE.insertImageMsg(b,"error"),x.style.display="block",j.style.display="none",void j.removeAttribute("src");x.style.display="none",j.src=c,j.style.display="",g.removeAttribute("style"),j.onerror=function(){j.removeAttribute("src"),j.style.display="none",b=T("There are no images found in the specified URL"),ZE.insertImageMsg(b,"error"),x.style.display="block"}}k.style.display="none"}},f.onkeyup=f.onblur=url_img_upload,f.onpaste=f.oncut=function(){setTimeout(url_img_upload,50)},fileInputChange=function(f){if(e.files&&e.files[0]&&e.files[0].size/1048576>W){if(ZE.insertImageMsg(T("Maximum file size supported: ")+X,"error"),e.value="",""!=e.value){var h=e.cloneNode(!0);h.onchange=e.onchange,e.parentNode.replaceChild(h,e)}}else{ZE.captchaParam?(ZE_Init.imgParameters||ZE_Init.context?a.action=b+"&"+ZE.captchaParam:a.action=b+"?"+ZE.captchaParam,delete ZE.captchaParam):R._stopEvent(f),ZE.captchaProcessing=e.onchange;var j=e.value;if(""!=e.value){if(!/(\.(gif|jpg|jpeg|bmp|png))$/i.test(j)){var p=T("Formats: ");return a.reset(),ZE.insertImageMsg(p+" GIF/JPG/PNG","error"),x.style.display="block",i.style.display="none",i.removeAttribute("src"),e.focus(),!1}ZE.activeEditor=R,i.style.visibility="hidden",n.style.display="none",i.style.width="",i.style.height="";var q;o="loading",q=e.files?e.files[0].name:e.value,i.onload=function(){if(o="finished",g.removeAttribute("style"),i.onload=void 0,e.disabled=c.disabled=d.disabled=g.disabled=!1,l.style.display="none",q.length>45){var a=q.substring(q.lastIndexOf("."),q.length),b=q.substring(0,40)+"..";q=b+a}n.textContent=T(q),y=this.width,z=this.height,i.style.width="120px",i.style.height="120px",ZE.hasClass(A,"zei-option")?(i.style.display="none",n.style.display="none"):(x.style.display="none",n.style.display="",k.style.display="none"),i.style.visibility="",m.innerHTML=T("Replace Image")},e.disabled=!1,a.submit(),e.disabled=c.disabled=d.disabled=g.disabled=!0,ZE.insertImageMsg(T("Uploading Image"),"info")}}},e.onchange=fileInputChange,G.onclick=function(a){a.stopPropagation(),ZE_Init.is_ie||(R._stopEvent(a),e.click())},S.getElementsByClassName("zei-close")[0].onclick=h.onclick=function(a){R._stopEvent(a),Y()},g.onclick=function(a){a.stopPropagation();var b=function(a){var b=400,c=parseInt(.75*R.editordiv.offsetWidth);if(c>b&&(c=b),ZE.hasClass(A,"zei-option")&&(a.width?(y=a.width,z=a.height):(y=a.naturalWidth,z=a.naturalHeight)),a.setAttribute("orig_width",y),a.setAttribute("orig_height",z),a.setAttribute("size_option","original"),ZE.hasClass(C,"zei-option")){var d=2.5;y>c&&(d=y/150),a.width=y/d,a.height=z/d,a.setAttribute("size_option","small")}else if(ZE.hasClass(D,"zei-option")){var d=1;y>c&&(d=y/c),a.width=y/d,a.height=z/d,a.setAttribute("size_option","bestfit")}else ZE.hasClass(F,"zei-option")&&(a.setAttribute("width","100%"),a.style.display="",a.setAttribute("orig_width",a.offsetWidth),a.setAttribute("orig_height",a.offsetHeight),a.setAttribute("size_option","fitToWidth"),a.style.display="none");ZE.hasClass(O,"zei-option")?a.style.float="left":ZE.hasClass(P,"zei-option")&&(a.style.float="right"),a.style.display=""};if(V)b(V);else{var c;if(ZE.hasClass(B,"zei-option")){if(c=R.imgURL,!e.value||!c){var d=T("Please browse and choose an image");return ZE.insertImageMsg(d,"error"),e.focus(),!1}}else if(ZE.hasClass(A,"zei-option")){if(!(c=f.value)){var d=T("Provide a valid image URL");return ZE.insertImageMsg(d,"error"),f.focus(),!1}if(!j.src)return!1}Q&&R.restoreSelection(Q),R.win.focus();var g,h=R._getSelection();try{h.isCollapsed||sel.deleteFromDocument(),g=h.getRangeAt(0)}catch(l){g=R._createRange(h)}var i=R.doc.createElement("img");i.src=c,i.style.display="none",setTimeout(function(){b(i),R.saveCurrentState()},500);var k=R.doc.createElement("br");ZE.hasClass(M,"zei-option")?(g.insertNode(k),g.insertNode(i),g.selectNode(k)):ZE.hasClass(L,"zei-option")?(g.insertNode(i),g.insertNode(k),g.selectNode(k)):(g.insertNode(i),g.selectNode(i)),g.collapse(!1),h.removeAllRanges(),h.addRange(g)}R._stopEvent(a),Y(),delete R.imgURL},ZE.prototype.previewImage=function(a){var b,c,d,e=this,f=document.getElementById("ze_ins_image");f&&"none"!=f.style.display?(b=document.getElementById("ze_comp_img"),b.src=a,e.imgURL=a,b.style.display=""):(b=document.createElement("img"),b.src=a,c=e._getSelection(),d=e._createRange(c),d.insertNode(b),d.selectNode(b),d.collapse(!1),c.removeAllRanges(),c.addRange(d))}},ZE.insertImageMsg=function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o=document.getElementById("ze_ins_image"),p=ZE.i18n;if(o)if(c=o.getElementsByTagName("input"),d=o.getElementsByTagName("span"),e=o.getElementsByTagName("label"),f=e[2],g=d[2],h=d[3],i=d[4],j=d[8],k=d[0],l=k.getElementsByTagName("i")[0],n=document.getElementById("ze_comp_img"),"info"==b)g.innerHTML="",g.style.display="none",h.style.display="";else if("error"==b){if(h.style.display="none",g.innerHTML=a,g.style.display="block",ZE.addClass(g,"ze_popuperrmsg"),m=c[0],n&&ZE.hasClass(l,"zei-option")){if(n.removeAttribute("src"),j.style.display="block",n.style.display="none",m.disabled=!1,m.value="",""!=m.value){var q=m.cloneNode(!0);q.onchange=m.onchange,m.parentNode.replaceChild(q,m)}f.innerHTML=p("Click to choose an image"),i.style.display="none"}}else"imginfo"==b&&(h.style.display="none",g.innerHTML=a,g.style.display="block")},ZE.insertErrorMsg=function(a){"use strict";var b=document.getElementById("ze_comp_img"),c=ZE.i18n;if(b){var d,e,f,g,h,i=document.getElementById("ze_ins_image"),j=i.getElementsByTagName("span"),k=j[0],l=(j[1],i.getElementsByTagName("input")),m=i.getElementsByTagName("label"),n=l[0];if(d=m[2],g=j[2],h=j[3],f=j[4],e=j[8],l=i.getElementsByTagName("input"),j=i.getElementsByTagName("span"),n.disabled=k.disabled=!1,h.style.display="none",g.innerHTML=a,ZE.addClass(g,"ze_popuperrmsg"),g.style.display="",d.innerHTML=c("Click to choose an image"),f.style.display="none",e.style.display="block",b.removeAttribute("src"),n.value="",""!=n.value){var o=n.cloneNode(!0);o.onchange=n.onchange,n.parentNode.replaceChild(o,n)}}else alert(a)},ZE.prototype.insertImage=function(a,b,c){"use strict";var d,e,f,g,h,i,j=this;if(b=b||{},i=b.size||"original",a){var k=function(a,b,c){var d,e,f,g=400,h=parseInt(.75*j.editordiv.offsetWidth);return c=c||"original",h>g&&(h=g),"small"===c?(f=2.5,a>h&&(f=a/150),d=a/f,e=b/f):"bestfit"===c?(f=1,a>h&&(f=a/h),d=a/f,e=b/f):(d=a,e=b),{width:d,height:e}};d="function"==typeof Image?new Image:document.createElement("img"),d.onload=function(){h=c||{},e=this.width,f=this.height,h.orig_width=e,h.orig_height=f,g=k(e,f,i),h.style=h.style||"",this.width=g.width,this.height=g.height,h.width=this.width,h.height=this.height,h.size_option=i,j.squireInstance.insertImage(a,h),"function"==typeof j.initobj.isKeyupActionTriggered&&j.initobj.isKeyupActionTriggered()},d.onerror=function(){},d.src=a}},ZE.prototype.showInsertHTMLDialog=function(a){"use strict";var b,c,d,e,f,g,h=this,i=document,j=h.doc.getElementById("ze_ins_insertHtml"),k=ZE.i18n,l=function(){return['<div class="zep_PUtt">'+k("Insert HTML")+'<i class="zei-close"></i></div>','<div class="zep_PUcen">','<table class="ze_ptble">',"<tbody>","<tr>","<td>",'<textarea style="width:500px;height:250px;resize:none;">',"</textarea>","</td>","</tr>","</tbody>","</table>","</div>",'<div class="zep_PUbtm">','<span class="sel">'+k("Insert")+"</span>",'<span data-val="Cancel">'+k("Cancel")+"</span>","</div>"].join("")},m=function(){i.removeEventListener("keydown",g,!0),j.parentNode.removeChild(j),ZE.hideOverlay()};g=function(a){27===a.keyCode&&(h._stopEvent(a),m())};var n=function(){var a,b=d.value;m(),DOMPurify&&(a=ZE.getHookMethod("ze_insert_html",h.initobj.hookOnInsertHTML),ZE.addHook("afterSanitizeElements",a),h.initobj.customTags=/meta/gi,h.initobj.allowTagsInsertHTML instanceof Array?h.initobj.allowTagsInsertHTML.push("meta"):h.initobj.allowTagsInsertHTML=["meta"],b=DOMPurify.sanitize(b,{originator:"ze_insert_html",ADD_TAGS:h.initobj.allowTagsInsertHTML||[],ADD_ATTR:h.initobj.allowAttrsInsertHTML||[]}),ZE.removeHook("afterSanitizeElements",a)),h.insertHTML(b),delete h.initobj.customTags;var c=h.initobj.allowTagsInsertHTML.indexOf("meta");c>0&&c.splice(c,1)};j||(ZE.showOverlay(),j=i.createElement("div"),j.id="ze_ins_insertHtml",j.className="zep_PU zep_arrb",j.innerHTML=l(),i.body.appendChild(j),ZE.setPosition(j,h.editordiv),d=j.getElementsByTagName("textarea")[0],b=j.getElementsByClassName("zei-close")[0],c=j.getElementsByTagName("span"),e=c[0],f=c[1],setTimeout(function(){d.focus()},0),f.onclick=b.onclick=function(a){h._stopEvent(a),m()},e.onclick=function(a){h._stopEvent(a),n()},ZE._addEvent(i,"keydown",g))},ZE.prototype.resizeElement=function(a){"use strict";var b,c,d,e,f,g,f,e,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=(document,ZE.i18n),v=!1,w=t.doc,x=a,y=18,z=function(){var a=400,b=parseInt(.75*t.editordiv.offsetWidth),g=1,h=2.5;if(b>a&&(b=a),e=x.getAttribute("orig_width"),f=x.getAttribute("orig_height"),e>b&&(g=e/b,h=e/150),c=g,d=h,x.hasAttribute("size_option")){var m=x.getAttribute("size_option");"small"===m?i.className="ze_sltd":"original"===m?k.className="ze_sltd":"bestfit"===m?j.className="ze_sltd":"fitToWidth"===m&&(l.className="ze_sltd")}},A=function(a){return parseFloat(a.style.height)},B=function(a){return parseFloat(a.style.width)},C=function(a){return parseFloat(a.style.top)},D=function(a){return parseFloat(a.style.left)},E=function(a){return a.width||parseFloat(a.style.width)},F=function(a,b){a.height=b},G=function(a,b){a.width=b},H=function(a,b){a.style.top=b+"px"},I=function(a,b){a.style.left=b+"px"},J=function(){return B(b)>y},K=function(a){G(x,e/d),F(x,f/d),x.setAttribute("size_option","small"),t.win.focus(),r(),t._stopEvent(a),t.saveCurrentState()},L=function(a){x.setAttribute("width","100%"),x.removeAttribute("height"),x.setAttribute("size_option","fitToWidth"),t.win.focus(),r(),t._stopEvent(a),t.saveCurrentState()},M=function(a){G(x,e/c),F(x,f/c),x.setAttribute("size_option","bestfit"),t.win.focus(),r(),t._stopEvent(a),t.saveCurrentState()},N=function(){x.parentElement.removeChild(x),t.win.focus(),r(),t.saveCurrentState()},O=function(a){F(x,f),G(x,e),x.setAttribute("size_option","original"),t.win.focus(),"comment"===t.initobj.type&&(r(),t._stopEvent(a),t.saveCurrentState())},P=function(){var a=t.doc.getSelection(),b=document.createRange();b.selectNode(x),a.removeAllRanges(),a.addRange(b),t.createLink(),r(),a.removeRange(b)};g=w.createElement("span"),g.id="ze_imgBlock",g.className="ze_spell",i=w.createElement("span"),i.innerHTML=u("Small"),j=w.createElement("span"),l=w.createElement("span"),l.innerHTML=u("Fit to Width"),j.innerHTML=u("Best Fit"),k=w.createElement("span"),k.innerHTML=u("Original"),m=w.createElement("span"),m.className="sep",m.innerHTML=u("Remove"),h=w.createElement("span"),h.innerHTML=u("More"),h.className="sep",h.id="more",g.appendChild(i),g.appendChild(j),g.appendChild(k),g.appendChild(l),"comment"!==t.initobj.type&&g.appendChild(h),g.appendChild(m),w.body.appendChild(g);var Q=function(){return function(a){x.src=ZE_Init.imgPath+"/images/process.gif",x.id="ze_"+a+"_refresh",t._pendingImagesList[x.id]=!0,x.style.height="16px",x.style.width="16px",x.removeAttribute("height"),x.removeAttribute("width"),x.className="ze_img_upload",t.squireInstance.focus()}},R=function(){return function(a){a="ze_"+a+"_refresh";var b=t.doc.getElementById(a);delete t._pendingImagesList[a],b&&b.parentNode.removeChild(b)}},S=function(){var a=document.createElement("div"),b=document.createElement("img");b.src=ZE_Init.imgPath+"/images/process.gif",a.appendChild(b);try{var c=t._getSelection(),d=t._createRange(c);d.insertNode(a),d.selectNode(a),d.collapse(!1),
c.removeAllRanges(),c.addRange(d)}catch(e){}return a},T=function(a){try{var b=a.getElementsByTagName("img")[0];b.parentElement.removeChild(b)}catch(c){}},U=function(a){return function(b,c){c="ze_"+c+"_refresh";var d=t.doc.getElementById(c);if(delete t._pendingImagesList[c],!d)return void(t._unusedImagesList[c]=b);d.onload=function(){d.setAttribute("orig_width",e),d.setAttribute("orig_height",f),d.style.removeProperty("height"),d.style.removeProperty("width"),"edit"===a?(d.width=parseInt(e),d.height=parseInt(f),ZE.setImageSizeOptions(d,"bestfit",t.editordiv.offsetWidth)):(d.width=this.width+"px",d.height=this.height+"px",ZE.setImageSizeOptions(d,"bestfit",t.editordiv.offsetWidth)),d.removeAttribute("data-zeload")},d.setAttribute("data-zeload",!0),d.src=b,d.removeAttribute("id"),d.removeAttribute("class"),t.saveCurrentState()}};ZE._addEvent(m,"mousedown",N),ZE._addEvent(k,"mousedown",O),ZE._addEvent(i,"mousedown",K),ZE._addEvent(j,"mousedown",M),ZE._addEvent(l,"mousedown",L),ZE._addEvent(g,"mouseup",function(){return event.preventDefault(),event.stopPropagation(),event.stopImmediatePropagation(),r(),!1},!1),"comment"!==t.initobj.type&&ZE._addEvent(h,"mousedown",function(b){if(document.getElementById("img_edit_link_options"))return!1;var c=[],d=!0;t.initobj.hasOwnProperty("showImgEditOption")&&(d=t.initobj.showImgEditOption),d&&(a.src&&a.src.indexOf(window.location.hostname)<0?c.push([{cmd:u("Edit"),id:"Edit",style:{pointerEvents:"none",opacity:"0.3"}}]):c.push([{cmd:u("Edit"),id:"Edit"}])),t.initobj.hasOwnProperty("parseImage")&&c.push([{cmd:t.initobj.parseImage.HeaderTxt,id:"custom"}]),c.push([{cmd:u("Link"),id:"Link"}]);var g=function(a){if(t._stopEvent(a),"Link"===a.target.id)i.parentElement.removeChild(i),P();else if("Edit"===a.target.id)"function"==typeof t.initobj.processPastedFile&&(i.parentElement.removeChild(i),e=x.getAttribute("orig_width"),f=x.getAttribute("orig_height"),r(),t.initobj.processPastedFile(x.src,t,Q(),U("edit"),R(),"source"));else if("custom"===a.target.id){r(),i.parentElement.removeChild(i),a.preventDefault(),a.stopPropagation();var b=S();t.initobj.parseImage.callback(a,x.src,b,T)}},h="img_edit_link_options";t.constructContextMenu(c,h,g);var i=document.getElementById(h),j=(ZE.getPos(t.editordiv),i.style);V=0,W=0;var k=t.iframe.getBoundingClientRect(),l=a.getBoundingClientRect();b.pageX||b.pageY?(V=k.left+l.left+(b.pageX-l.left),W=t.win.scrollY?k.top+l.top+(b.pageY-l.top)-t.win.scrollY:k.top+l.top+(b.pageY-l.top)-t.win.pageYOffset):(V=k.left+l.left+(b.clientX-l.left),W=t.win.scrollY?k.top+l.top+(b.clientY-l.top)-t.win.scrollY:k.top+l.top+(b.clientY-l.top)-t.win.pageYOffset),j.left=parseInt(V)+"px",j.top=parseInt(W)+"px";var m=i.offsetHeight;if(W+m>window.innerHeight-20){var n=W-m;j.top=n<41?"40px":parseInt(n)+"px"}},!1),b=w.createElement("div"),w.body.appendChild(b),b.className="enc",b.id="enclose",b.style.position="absolute",o=x.getBoundingClientRect();var V=o.left,W=o.top;t.win.scrollX?b.style.left=V+t.win.scrollX+"px":b.style.left=V+t.win.pageXOffset+"px",t.win.scrollY?b.style.top=o.top+t.win.scrollY+"px":b.style.top=o.top+t.win.pageYOffset+"px",b.style.height=o.height+"px",b.style.width=o.width+"px",g.contentEditable="false",g.style.left=b.style.left,H(g,C(b)+A(b)),z(),t.win.scrollY?W+=t.win.scrollY:W+=t.win.pageYOffset,t.win.scrollX?V+=t.win.scrollX:V+=t.win.pageXOffset;var X=w.createElement("div");X.className="smallDiv smallDiv-tl",X.id="smallDiv1",w.body.appendChild(X),X.setAttribute("data-resize","resize"),X.style.top=W+"px",X.style.left=V+"px",X.style.cursor="nw-resize";var Y=w.createElement("div");Y.className="smallDiv smallDiv-tr",Y.id="smallDiv2",w.body.appendChild(Y),Y.setAttribute("data-resize","resize"),Y.style.top=W+"px",Y.style.left=V+o.width-12+"px",Y.style.cursor="ne-resize";var Z=w.createElement("div");Z.className="smallDiv smallDiv-br",Z.id="smallDiv3",w.body.appendChild(Z),Z.setAttribute("data-resize","resize"),Z.style.top=W+o.height-14+"px",Z.style.left=V+o.width-14+"px",Z.style.cursor="se-resize";var $=w.createElement("div");$.className="smallDiv smallDiv-bl",$.id="smallDiv4",$.setAttribute("data-resize","resize"),w.body.appendChild($),$.style.top=W+o.height-14+"px",$.style.left=V+"px",$.style.cursor="sw-resize";var _=w.createElement("div");_.className="smallDiv smallDiv-bl",_.id="more",_.style.top=W+"px",_.style.left=V+o.width-12+"px";var aa=function(a){46===a.keyCode?N():r()},ba=function(){X.style.left=b.style.left,X.style.top=b.style.top,I(Y,B(b)+D(b)-14),Y.style.top=b.style.top,$.style.left=b.style.left-14,H($,A(b)+C(b)-14),I(Z,B(b)+D(b)-14),H(Z,A(b)+C(b)-14)};r=function(){var a=w.getElementById("ze_imgBlock");a&&w.body.removeChild(a),ZE._removeEvent(w,"keydown",aa);var c=document.getElementById("img_edit_link_options");if(w.getElementById("smallDiv1"))try{X.parentElement.removeChild(X),Y.parentElement.removeChild(Y),Z.parentElement.removeChild(Z),$.parentElement.removeChild($),c&&c.length>1&&c.parentElement.removeChild(c),b.parentElement.removeChild(b)}catch(d){}};var ca=function(a){n=this,v=!0,t._stopEvent(a),p=a.clientX,q=a.clientY,ZE._removeEvent(w,"keydown",aa),ZE._addEvent(w,"mousemove",ga),ZE._addEvent(w,"mouseup",ha)},da=function(){x.height=parseFloat(b.style.height),x.width=parseFloat(b.style.width),x.style.width&&(x.style.width=""),x.style.height&&(x.style.height="")},ea=function(){v=!1,s(),da(),ZE._removeEvent(X,"mousedown",ca),ZE._removeEvent(Y,"mousedown",ca),ZE._removeEvent(Z,"mousedown",ca),ZE._removeEvent($,"mousedown",ca),X.parentElement.removeChild(X),Y.parentElement.removeChild(Y),Z.parentElement.removeChild(Z),$.parentElement.removeChild($),b.parentElement.removeChild(b);var a=w.getElementById("ze_imgBlock");a&&w.body.removeChild(a),E(x)===e/c?x.setAttribute("size_option","bestfit"):E(x)===e/d?x.setAttribute("size_option","small"):E(x)===e&&x.setAttribute("size_option","original"),t.saveCurrentState()},fa=function(a,c){if(v){if(c.clientX<=0||c.clientY<=0||c.clientX>t.editordiv.offsetWidth)return void ea(a);var d,e,f,g,h,i,j,k,l=(D(b),C(b),A(b)),m=B(b);a===Y?(d=0,e=0):a===Z?(d=0,e=1):a===$?(d=1,e=0):(d=1,e=1),c.clientX<p?(f=p-c.clientX,0===d?J()&&(g=m/(m-f),m/=g,h=l-l/g,l/=g,ZE.setCss(b,"height",l+"px"),ZE.setCss(b,"width",m+"px"),0===e&&H(b,C(b)+h)):(g=(m+f)/m,i=m-m/g,m+=m-m/g,j=l-l/g,l+=l-l/g,ZE.setCss(b,"height",l+"px"),ZE.setCss(b,"width",m+"px"),k=D(b),C(b),I(b,k-i),1===e&&H(b,C(b)-j))):(f=c.clientX-p,0===d?(g=(m+f)/m,m+=m-m/g,h=l-l/g,l+=h,ZE.setCss(b,"height",l+"px"),ZE.setCss(b,"width",m+"px"),0===e&&H(b,C(b)-h)):J()&&(g=m/(m-f),i=m-m/g,m/=g,j=l-l/g,l/=g,ZE.setCss(b,"height",l+"px"),ZE.setCss(b,"width",m+"px"),k=D(b),I(b,k+i),1===e&&H(b,C(b)+j))),ba(),p=c.clientX,q=c.clientY,x.hasAttribute("size_option")&&x.removeAttribute("size_option")}},ga=function(a){fa(n,a)},ha=function(a){t._stopEvent(a),ea(n,a)};s=function(){ZE._removeEvent(w,"mousemove",ga),ZE._removeEvent(w,"mouseup",ha)},ZE._addEvent(w,"keydown",aa),ZE._addEvent(X,"mousedown",ca),ZE._addEvent(Y,"mousedown",ca),ZE._addEvent(Z,"mousedown",ca),ZE._addEvent($,"mousedown",ca)},ZE.prototype.getDropObj=function(a){"use strict";this.insertListObj=a,this.list=a.lists},ZE.prototype.DrawList=function(){"use strict";var a,b=this,c=ZE.i18n,d={},e=function(a){return b._stopEvent(a),!1},f=function(){var a,c=j.getElementsByClassName("ze_tbEd"),d=j.getElementsByClassName("IconDiv")[0],e=j.getElementById("ze_dropdown");a=function(){b.insertIconRef.className="ui-insert",b.insertIconRef.style.visibility="",b.paraIconRef.className="ui-paragraph",b.initobj.microParaToolbar?b.paraIconRef.style.visibility="":b.paraIconRef.style.visibility="hidden"};var f=j.getElementById("stickIcon");f?"zei-unpin"===f.className||e||(c[0].parentElement.removeChild(c[0]),d.parentElement.removeChild(d)):(a(),c[0]&&!e&&c[0].parentElement.removeChild(c[0])),c[1]&&(a(),c[1].parentElement.removeChild(c[1]))},g=function(a){return function(c){b._stopEvent(c);var d=b._getSelection();try{b._createRange(d)}catch(e){b.range?(b.range.select(),delete b.range):b.win.focus()}return b.execCommand(c,a),!1}},h=this.insertListObj||[],i=this.list||[],j=document,k=j.createElement("div"),l=j.createElement("ul"),m=h.divId;if(h.onClick&&l.addEventListener("mousedown",function(a){a.stopPropagation();var b=a.target||a.srcElement,c=$(b).closest("li"),d=$(c).data();h.onClick(b,c,d,k),f()}),l.type="none",l.className="ze_txtIcon",i.forEach(function(b){if(a=j.createElement("li"),b.htm&&"object"===_typeof(b.htm))for(var c=b.htm.length,d=0;d<c;d++)a.innerHTML+=b.htm[d];else b.htm&&"string"==typeof b.htm?a.innerHTML=b.htm:b.dom&&a.appendChild(b.dom);$(a).data(b.data),l.appendChild(a)}),b.initobj.customNotesToolbar){var n,o,p,q,r,s,a,g=function(a){return function(c){b._stopEvent(c);var d=b._getSelection();try{b._createRange(d)}catch(e){b.range?(b.range.select(),delete b.range):b.win.focus()}return b.execCommand(c,a),!1}},t=ZE_Init.insertNotesToolbar,u=t.length;b.toolbarobject=d,j.createElement("ul");for(var v=0;v<u;v++){n=t[v],o=n.length;for(var w=0;w<o;w++){p=n[w],q=p[0],r=p[2],a=j.createElement("li"),l.appendChild(a),s=j.createElement("b");var x=j.createElement("span");x.className=r,x.innerHTML=p[1],s.appendChild(x),a.appendChild(s),s.title=c(p[1]),d[q]=s,ZE._addEvent(s,"click",g(q)),ZE._addEvent(s,"mousedown",e)}}}return k.id=m||"ze_SmartDropDown",k.appendChild(l),k},ZE.prototype.removeToolbar=function(){var a,b=document.getElementsByClassName("ze_tbEd"),c=b.length,d=document.getElementsByClassName("IconDiv"),e=d.length;for(a=0;a<e;a++)d[a].parentElement.removeChild(d[a]);for(a=0;a<c;a++)b[a].parentElement.removeChild(b[a])},ZE.prototype.createLink=function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=document,w=v.getElementById("ze_link"),x=ZE.i18n,y=u._getSelectedText();for(m=u.getParentElement();null!==m&&"BODY"!==m.nodeName;m=m.parentNode){if("A"===m.nodeName){l=!0;break}if("IMG"===m.nodeName){n=!0,"A"===m.parentNode.nodeName&&(l=!0,m=m.parentNode);break}}var z=function(){var a=w.getElementsByTagName("form")[0];ZE._removeEvent(v,"keydown",s),w.parentNode.removeChild(w),ZE.hideOverlay(),a&&a.reset()};s=function(a){27===a.keyCode&&(u._stopEvent(a),z()),13===a.keyCode&&(u._stopEvent(a),t(a))};var A=function(){b.checked=!0,c.checked=!1,j.style.display=k.style.display="none",i.style.display=""},B=function(){b.checked=!1,c.checked=!0,i.style.display="none",j.style.display=k.style.display=""},C=function(){b.checked&&(n||y)?setTimeout(function(){e.focus()},0):c.checked&&(n||y)?setTimeout(function(){f.focus()},0):setTimeout(function(){d.focus()},0)},D=function(a,b){var c,d,e;u.doc.execCommand("createlink",!1,a);try{c=u._getSelection(),c.collapseToEnd(),e=u.getParentElement(),"A"===e.tagName&&(ZE_Init.preventTargetBlank||(e.target="_blank",u.initobj.anchorReferer&&(e.rel="noreferer")),e.textContent===b||e.getElementsByTagName("img")||(e.textContent=b),d=u._createRange(c),d.selectNode(e),c.removeAllRanges(),c.addRange(d),c.collapseToEnd())}catch(h){u.range&&(u.range.select(),delete u.range),u.doc.execCommand("createlink",!1,a),e=u.getParentElement(),"A"===e.tagName&&(ZE_Init.preventTargetBlank||(e.target="_blank",u.initobj.anchorReferer&&(e.rel="noreferer")),e.innerText===b||e.getElementsByTagName("img")||(e.innerText=b),c=u._getSelection(),d=u._createRange(c),d.moveToElementText(e),d.collapse(!1),d.select())}var f=u.doc.createRange();f.setStart(e,0),f.setEndAfter(e),f.selectNode(e);var g=u.iframe.contentWindow.getSelection();g.removeAllRanges(),g.addRange(f),u.win.focus(),u.iframe.contentWindow.getSelection().collapseToEnd(),u.saveCurrentState()},E=function(){var o,r,s,t;if(a=w.getElementsByTagName("input"),b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],u.initobj.hasOwnProperty("customClass")){var v=u.initobj.customClass.link;b.className=v,c.className=v}p=w.getElementsByTagName("span"),q=w.getElementsByClassName("zei-close")[0],o=w.getElementsByTagName("tr"),h=o[1],i=o[2],j=o[3],k=o[4],h.style.display=n?"none":"",l?(n||(d.value=m.textContent),"mailto:"===m.protocol?(B(),r=m.href,s=r.split("mailto:"),t=s[1].split("?subject="),f.value=t[0]||"",g.value=t[1]||""):(A(),e.value=m.href)):(A(),n||(d.value=y||""))},F=new RegExp("^[\\w]([\\w-\\.\\+\\']*)@([\\w\\-\\.]*)(\\.[a-zA-Z]{2,22}(\\.[a-zA-Z]{2}){0,2})$"),G=new RegExp("^(ht|f)tp(s?)\\:\\/\\/[-.\\w]*(\\/?)([a-zA-Z0-9\\-\\.\\?\\,\\:\\'\\/\\\\\\+=&amp;%\\$#_@]*)?$"),H=ZE.trim(y);if(F.test(H)&&!l)return void D("mailto:"+H,H);if(G.test(H)&&!l)return void D(H,H);ZE.showOverlay(),u.win.focus(),r=u.saveSelection(),o='<div class="zep_PUtt">'+x("Insert Link")+'<i class="zei-close"></i></div>',o+='<div class="zep_PUcen">',o+='<form><table class="ze_ptble">',o+="<tr><td>"+x("Link")+'</td><td><input type="radio" id="ze_link_url" checked="true"/><label for="ze_link_url">'+x("URL")+'</label>&nbsp;<input id="ze_link_email" type="radio"/><label for="ze_link_email">'+x("Email")+"</label></td>",o+="<tr><td>"+x("Selected Text")+'&nbsp;</td><td><input type="text"></td></tr>',o+="<tr><td>"+x("Web address")+'</td><td><input type="text"></td></tr>',o+='<tr style="display:none;"><td>'+x("Email address")+'</td><td><input type="text"></td></tr>',o+='<tr style="display:none;"><td>'+x("Subject")+'</td><td><input type="text"></td></tr>',o+="</table></form></div>",o+='<div class="zep_PUbtm"><span class="sel">'+x("OK")+'</span><span data-val="Cancel">'+x("Cancel")+"</span></div></div>";var I=v.createElement("div");I.className="zep_PU",I.innerHTML=o,I.id="ze_link",document.body.appendChild(I),w=I,E(),ZE.setPosition(w,u.editordiv),C(),b.onclick=function(){A(),C()},c.onclick=function(){B(),C()},q.onclick=p[1].onclick=function(a){u._stopEvent(a),z()},t=function(a){var h="http://",i="https://";u._stopEvent(a);var j,k,o,p,q,s,t,v=d.value;if(q=/^\/\/[a-zA-Z0-9]/g,r&&u.restoreSelection(r),b.checked?(j=e.value,j=ZE.trim(j)):c.checked&&(j=f.value,j=ZE.trim(j)),k=g.value,l)if(j){b.checked?0!==j.indexOf(h)&&0!==j.indexOf(i)&&0!==j.indexOf("ftp://")&&0!==j.indexOf("ssh://")&&(j=h+j):c.checked&&(j="mailto:"+j,k&&(j+="?subject="+k)),m.href=j,ZE_Init.preventTargetBlank||(m.target="_blank",u.initobj.anchorReferer&&(m.rel="noreferer")),n||m.textContent===v||(m.textContent=v),p=u.doc.createRange(),p.setStart(m,0),p.setEndAfter(m),p.selectNode(m);var w=u.iframe.contentWindow.getSelection();w.removeAllRanges(),w.addRange(p),u.win.focus(),r&&u.restoreSelection(r),u.saveCurrentState()}else confirm("Please confirm that you want to unlink this element.\n\nLink points to: "+decodeURI(m.href))&&(o=u._getSelection(),p=u._createRange(o),p.selectNode(m),u.doc.execCommand("unlink",!1,null),z());else{if(!(v=ZE.trim(v))&&!n)return alert(x("You must Select or ENTER Some text to create link")),d.focus(),!1;if(b.checked){if(!j)return alert(x("Please enter URL to make a link")),e.focus(),!1;q.lastIndex=0,0!==j.indexOf(h)&&0!==j.indexOf(i)&&!0!==q.test(j)&&0!==j.indexOf("ftp://")&&0!==j.indexOf("ssh://")&&(j=h+j)}else if(c.checked){if(!j)return alert(x("Please enter Email to make a link")),f.focus(),!1;j="mailto:"+j,k&&(j+="?subject="+k)}if(n)u.squireInstance.makeLink(j),(s=u.getParentElement())&&"a"===s.tagName.toLowerCase()&&(ZE_Init.preventTargetBlank||(s.target="_blank",u.initobj.anchorReferer&&(s.rel="noreferer")));else if(y&&0!==y.length)D(j,v);else{var A="<a id='an_link'";ZE_Init.preventTargetBlank||(A+="target='_blank'",u.initobj.anchorReferer&&(A+="rel='noreferer'")),A+="></a>&nbsp;",u.win.focus(),u.pasteHTML(A),t=u.doc.getElementById("an_link"),t&&(t.appendChild(u.doc.createTextNode(v)),t.setAttribute("href",j),t.removeAttribute("id")),u.saveCurrentState()}}return z(),!1},p[0].onclick=t,ZE._addEvent(v,"keydown",s)},ZE.prototype.showAnchorTag=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k=a,l=this,m=document,n=ZE.i18n,o=l.saveSelection();b=function(b){if(c=document.getElementById("ze_linkBlock"),b)for(a=b.target;null!==a&&a!==c;a=a.parentNode);a||d()},e=function(){d()},d=function(){(c=document.getElementById("ze_linkBlock"))&&(document.body.removeChild(c),ZE._removeEvent(m,"mousedown",b),ZE._removeEvent(l.doc,"mousedown",b),ZE._removeEvent(l.doc,"keydown",e))},f=function(){var a=l.doc.createRange();a.setStart(k,0),a.setEndAfter(k),a.selectNode(k);var b=l.iframe.contentWindow.getSelection();b.removeAllRanges(),b.addRange(a),l.win.focus(),o&&l.restoreSelection(o)},g=function(){var a=l.doc.createRange();a.setStart(k,0),a.setEndAfter(k),a.selectNode(k);var b;b="comment"===l.initobj.type?l.doc.getSelection():l.iframe.contentWindow.getSelection(),b.removeAllRanges(),b.addRange(a),l.win.focus(),"comment"===l.initobj.type?l.squireInstance.removeLink():(l.doc.execCommand("unlink",!1,null),l.iframe.contentWindow.getSelection().collapseToStart()),d(),l.saveCurrentState()},h=function(){var a,b,c=document.getElementById("ze_linkBlock"),d=ZE.getPos(l.editordiv),e=c.style,f=document,g=document.body,h=f.documentElement,j=0,m=0,n=l.iframe.getBoundingClientRect(),o=k.getBoundingClientRect(),p=document.body.getBoundingClientRect().width,q=Math.max(g.scrollTop,h.scrollTop);if(j=n.left+o.left,m=n.top+o.top+k.offsetHeight+(q||0),j<p/2?(e.left=parseInt(j)+"px",e.top=parseInt(m)+"px",e.right="auto",b=j+c.offsetWidth):(e.left="auto",e.top=parseInt(m)+"px",j=window.innerWidth-j-k.offsetWidth,e.right=parseInt(j)+"px",b=j+c.offsetWidth),b>=p){var r=i.innerHTML;r.length>55&&(r=r.substring(0,54)+"..."),i.innerHTML=r}if(m+c.offsetHeight>l.editordiv.offsetHeight+d.offsetTop&&(e.top="auto",m=window.innerHeight-m+k.offsetHeight,e.bottom=parseInt(m)+"px"),"comment"===l.initobj.type&&(e.bottom="auto","auto"===e.right?e.left=d.offsetLeft+"px":e.left="auto",a=document.getSelection().getRangeAt(0).getBoundingClientRect().top,e.top=a+c.offsetHeight+"px"),"IMG"===k.firstChild.nodeName){var s=k.firstChild,t=s.style.float;if("left"===t){var u=s.offsetHeight+m;e.top=u+"px"}else if("right"===t){var v=s.getBoundingClientRect().x+j,u=s.offsetHeight+m;e.top=u+"px",e.left=v+"px"}}},c=document.getElementById("ze_linkBlock"),c&&d(),j=document.createElement("span"),j.id="ze_linkBlock",j.className="ze_spell",i=document.createElement("a"),0===k.href.indexOf("mailto")?i.appendChild(l.doc.createTextNode(k.href)):(i.setAttribute("href",k.href),j.appendChild(l.doc.createTextNode(n("Go to:"))),i.appendChild(l.doc.createTextNode(k.href)),i.target="_blank",l.initobj.anchorReferer&&(i.rel="noreferrer"),i.style.marginLeft="-5px"),j.appendChild(i);var p=document.createElement("span");p.innerHTML=n("Change");var q=document.createElement("span");q.innerHTML=n("Remove");var r=document.createElement("i");r.className="zei-close",j.appendChild(i),j.appendChild(p),j.appendChild(q),j.appendChild(r),document.body.appendChild(j),h(),ZE._addEvent(r,"click",function(){d(),f()}),ZE._addEvent(i,"click",function(){d(),f()}),ZE._addEvent(q,"click",g),ZE._addEvent(p,"click",function(){o&&l.restoreSelection(o),l.win.focus(),l.createLink(k),d()}),l.updateToolbar(),ZE._addEvent(m,"mousedown",b),ZE._addEvent(l.doc,"mousedown",b),ZE._addEvent(l.doc,"keydown",e)},ZE.prototype.spellcheck=function(){var a=this,b=a.toolbarobject,c=(b.spellcheck,b.spellcheckoptions,"locale"),d=document,e=ZE.i18n,f=ZE.getContextValue();ZE.activeEditor=a,c=void 0!==a.defaultSpellcheckLanguage?a.defaultSpellcheckLanguage:ZE_Init.useProxy?navigator.language:"locale";var g=d.getElementById("ze_spellcheck"),h=f+"/ze/spellcheck?spellchecklang="+c+"&domainname="+ZE_Init.domain;if(ZE_Init.useProxy&&ZE_Init.spellcheckProxyUrl?h+="&spellcheckurl="+ZE_Init.spellcheckProxyUrl+"&useProxy="+ZE_Init.useProxy:h+="&spellcheckurl="+ZE_Init.spellcheckURL,ZE_Init.useSameDomain&&(h+="&useSameDomain=true"),g)g.src=h;else{var i=d.createElement("iframe");i.name=i.id="ze_spellcheck",i.src=h;var j=i.style,k=a.iframe;j.width="500px",j.left="-1000px",j.height="50px",j.top=ZE.getPos(k).offsetTop+"px",j.position="absolute",d.body.appendChild(i)}if(a.scspan){var l=a.sclog;l.style.display="",l.innerHTML=e("Checking..."),a.screcheck.style.display="none",a.sccancel.style.display="",a.scclose.style.display="none",a.scspan.style.display=""}else{var m=d.createDocumentFragment(),n=d.createElement("span");n.className="ze_spell";a.toolbardiv.getBoundingClientRect();m.appendChild(n),a.scspan=n;var o=d.createElement("span");o.appendChild(d.createTextNode(e("Checking")+"...")),n.appendChild(o),a.sclog=o;var p=d.createElement("a"),q=e("Recheck");p.style.display="none",p.title=p.href=q,p.appendChild(d.createTextNode(q)),p.onclick=function(){return a.removeSpellcheckspans(),a.spellcheck(),!1},n.appendChild(p),a.screcheck=p;var r=d.createElement("a"),s=e("Cancel");r.title=r.href=s,r.appendChild(d.createTextNode(s)),r.onclick=function(){return a.cancelSpellcheck(),a.scspan.style.display="none",!1},n.appendChild(r),a.sccancel=r;var t=d.createElement("a"),u=e("Close");t.title=t.href=u,t.style.display="none",t.appendChild(d.createTextNode(u)),t.onclick=function(){return a.removeSpellcheckspans(),a.scspan.style.display="none",!1},n.appendChild(t),a.scclose=t,a.toolbardiv.appendChild(m)}},ZE.prototype.cancelSpellcheck=function(){var a=this;return document.getElementById("ze_spellcheck").src=ZE_Init.jsPath+"/html/blank.html",a.spellcheckContentSet&&(a.removeSpellcheckspans(),delete a.spellcheckContentSet),!1},ZE.prototype.getSpellcheckRemovedContent=function(a){"use strict";var b,c,d,e,f,g=this,h=g.spellcheckdiv;if("plaintext"===a&&void 0!==h?(b=h.cloneNode(!0),c=b,d=c.getElementsByTagName("span")):"richtext"===a&&(b=g.doc.body.cloneNode(!0),c=b,d=c.getElementsByTagName("span")),d){for(f=d.length-1;f>=0;f--)if(e=d[f],e.hasAttribute("data-s")||e.getAttribute("data-s"))if(e.style.backgroundColor="",e.style.length>0)e.removeAttribute("data-s");else if(e.hasChildNodes()){for(var i=e.childNodes,j=e.parentNode,k=0;k<i.length;k++)j.insertBefore(i[k].cloneNode(!0),e);j.removeChild(e)}return c.innerHTML}},ZE.prototype.removeSpellcheckspans=function(){var a,b=this,c=b.mode,d=b.spellcheckdiv;if(ZE.activeEditor&&delete ZE.activeEditor,"plaintext"===c?d&&(a=d.getElementsByTagName("span"),b.spellCheckDivEvent&&ZE._removeEvent(d,"mouseup",b.spellCheckDivEvent)):(a=b.doc.getElementsByTagName("span"),b.spellCheckEvent&&ZE._removeEvent(b.doc,"mouseup",b.spellCheckEvent)),a){for(var e=a.length-1;e>=0;e--){var f=a[e];if(f.hasAttribute("data-s")||f.getAttribute("data-s"))if(f.style.backgroundColor="",f.style.length>0)f.removeAttribute("data-s");else if(f.hasChildNodes()){for(var g=f.childNodes,h=f.parentNode,i=0;i<g.length;i++)h.insertBefore(g[i].cloneNode(!0),f);h.removeChild(f)}}if("plaintext"===c&&d){var j=b._textarea;j.value=ZE.getText(d.innerHTML),j.style.display="",d.parentNode.removeChild(d),delete b.spellcheckdiv}}},ZE.prototype.setSpellcheckContent=function(a){var b=this;if(b.spellcheckContentSet=!0,"plaintext"===b.mode){var c=document.createElement("div"),d=b._textarea;c.className=d.className,c.style.cssText=d.style.cssText,c.style.overflow="auto",c.style.clear="both",c.innerHTML=a,b.spellCheckDivEvent=function(a){return b.spellCheckEventDiv(a)},ZE._addEvent(c,"mouseup",b.spellCheckDivEvent),b.editordiv.appendChild(c),d.style.display="none",b.spellcheckdiv=c}else{var e=b.doc;e.body.innerHTML=a,b.spellCheckEvent||(b.spellCheckEvent=function(a){return b.spellCheckMenu(a)}),ZE._addEvent(e,"mouseup",b.spellCheckEvent),b.win.focus()}b.sclog.style.display="none",b.screcheck.style.display="",b.sccancel.style.display="none",b.scclose.style.display=""},ZE.prototype.spellCheckEventDiv=function(a){if(0!==a.button)return!1;for(var b=this,c=a.target,d=c;d&&"BODY"!==d.nodeName&&"HTML"!==d.nodeName;d=d.parentNode)if(d.hasAttribute("data-s")){c=d;break}if(!c.hasAttribute("data-s"))return!1;b._stopEvent(a);var e,f=document,g=function a(c){c&&b._stopEvent(c),ZE._removeEvent(f,"keydown",a),ZE._removeEvent(f,"mousedown",h);var d=document.getElementById("ze_spellcheckmenu_div");d&&d.parentNode.removeChild(d)},h=function(a){b._stopEvent(a);var c=a.target;if("LI"!==c.nodeName)return g(),!1;if("undefined"==typeof ze_spellcheck_options)return!1;for(;null!==c&&c!==ze_spellcheck_options;)c=c.parentNode;null===c&&g()},i=function(a){b._stopEvent(a),a.preventDefault(),a.stopPropagation();var d=a.target;if("UL"===d.nodeName)return!1;if("LI"===d.nodeName){if(value=d.getAttribute("data-i"),"No Suggestions"===value)return;if("Ignore All"===value)b.leaveSimilarErrorWords(c.getAttribute("replaceword"));else if("Dictionary"===value)b.addToDictionary(c.getAttribute("replaceword"));else if("Custom Dictionary"===value)b.customDictionary();else{var e,h=c,i=h.parentNode,j=h.style;if(e="Ignore"===value?h.textContent:d.textContent,j&&j.length>1)j.backgroundColor="",h.removeAttribute("data-s"),h.textContent=h.textContent.replace(h.getAttribute("replaceword"),e),h.removeAttribute("replaceword");else{if(h.textContent===h.getAttribute("replaceword"))i.insertBefore(f.createTextNode(e),h);else{h.textContent=h.textContent.replace(h.getAttribute("replaceword"),e);for(var k=h.firstChild;k;){var l=k.cloneNode(!0);i.insertBefore(l,h),k=k.nextSibling}}i.removeChild(h)}}}return g(),!1},j=(f.createDocumentFragment(),{spellcheck:[]}),k=c.getAttribute("data-s");k=k.split(","),j.spellcheck[0]=[];for(var l,m=0;(l=k[m])&&m<5;m++){f.createElement("li").innerHTML=l,j.spellcheck[0][m]={},j.spellcheck[0][m].cmd=l,0===m&&"No Suggestions"===l&&(j.spellcheck[0][m]["data-i"]="No Suggestions",j.spellcheck[0][m].color="#bcb9af",j.spellcheck[0][m].fontWeight="Normal")}j.spellcheck[1]=[],j.spellcheck[1][0]={},j.spellcheck[1][0].cmd="Add to Dictionary",j.spellcheck[1][0]["data-i"]="Dictionary",j.spellcheck[1][1]={},j.spellcheck[1][1].cmd="Ignore",j.spellcheck[1][1]["data-i"]="Ignore",j.spellcheck[1][2]={},j.spellcheck[1][2].cmd="Ignore All",j.spellcheck[1][2]["data-i"]="Ignore All",j.spellcheck[2]=[],j.spellcheck[2][0]={},j.spellcheck[2][0].cmd="Custom Dictionary",j.spellcheck[2][0]["data-i"]="Custom Dictionary",b.constructContextMenu(j.spellcheck,"ze_spellcheckmenu_div",i),e=document.getElementById("ze_spellcheckmenu_div"),ZE._addEvent(f,"keydown",g);var n=(ZE.getPos(b.editordiv),e.style);posx=0,posy=0;var o=b.iframe.getBoundingClientRect(),p=c.getBoundingClientRect();a.pageX||a.pageY?(posx=o.left+p.left+(a.pageX-p.left),b.win.scrollY?posy=o.top+p.top+(a.pageY-p.top)-b.win.scrollY:posy=o.top+p.top+(a.pageY-p.top)-b.win.pageYOffset):(posx=o.left+p.left+(a.clientX-p.left),b.win.scrollY?posy=o.top+p.top+(a.clientY-p.top)-b.win.scrollY:posy=o.top+p.top+(a.clientY-p.top)-b.win.pageYOffset),n.left=parseInt(posx)+"px",n.top=parseInt(posy)+"px";var q=e.offsetHeight;if(posy+q>window.innerHeight-20){var r=posy-q;n.top=r<41?"40px":parseInt(r)+"px"}},ZE.prototype.spellCheckMenu=function(a){if(0!==a.button)return!1;for(var b=this,c=a.target,d=c;d&&"BODY"!==d.nodeName&&"HTML"!==d.nodeName;d=d.parentNode)if(d.hasAttribute("data-s")){c=d;break}if(!c.hasAttribute("data-s"))return!1;b._stopEvent(a);var e,f=b.doc,g=document,h=function a(c){c&&"keydown"!==c.type&&b._stopEvent(c),ZE._removeEvent(g,"mousedown",i),ZE._removeEvent(f,"mousedown",a),ZE._removeEvent(f,"keydown",a);var d=document.getElementById("ze_spellcheckmenu_div");d&&d.parentNode.removeChild(d)},i=function(a){b._stopEvent(a);var c=a.target;if("LI"!==c.nodeName)return h(),!1;if("undefined"==typeof ze_spellcheck_options)return!1;for(;null!==c&&c!==ze_spellcheck_options;)c=c.parentNode;null===c&&h()},j=function(a){b._stopEvent(a);var d,e=a.target;if("UL"===e.nodeName)return!1;if("LI"===e.nodeName){if("No Suggestions"===(d=e.getAttribute("data-i")))return;if("Ignore All"===d)b.leaveSimilarErrorWords(c.getAttribute("replaceword"));else if("Dictionary"===d)b.addToDictionary(c.getAttribute("replaceword"));else if("Custom Dictionary"===d)b.customDictionary();else{var g,i=c,j=i.parentNode,k=i.style;if(g="Ignore"===d?i.textContent:e.textContent,k&&k.length>1)k.backgroundColor="",i.removeAttribute("data-s"),i.textContent=i.textContent.replace(i.getAttribute("replaceword"),g),i.removeAttribute("replaceword");else{if(i.textContent===i.getAttribute("replaceword"))j.insertBefore(f.createTextNode(g),i);else{i.textContent=i.textContent.replace(i.getAttribute("replaceword"),g);for(var l=i.firstChild;l;){var m=l.cloneNode(!0);j.insertBefore(m,i),l=l.nextSibling}}j.removeChild(i)}}}return h(),!1},k=(g.createDocumentFragment(),{spellcheck:[]}),l=c.getAttribute("data-s");l=l.split(","),k.spellcheck[0]=[];for(var m,n=0;(m=l[n])&&n<5;n++){g.createElement("li").innerHTML=m,k.spellcheck[0][n]={},k.spellcheck[0][n].cmd=m,0===n&&"No Suggestions"===m&&(k.spellcheck[0][n]["data-i"]="No Suggestions",k.spellcheck[0][n].color="#bcb9af",k.spellcheck[0][n].fontWeight="Normal")}k.spellcheck[1]=[],k.spellcheck[1][0]={},k.spellcheck[1][0].cmd="Add to Dictionary",k.spellcheck[1][0]["data-i"]="Dictionary",k.spellcheck[1][1]={},k.spellcheck[1][1].cmd="Ignore",k.spellcheck[1][1]["data-i"]="Ignore",k.spellcheck[1][2]={},k.spellcheck[1][2].cmd="Ignore All",k.spellcheck[1][2]["data-i"]="Ignore All",k.spellcheck[2]=[],k.spellcheck[2][0]={},k.spellcheck[2][0].cmd="Custom Dictionary",k.spellcheck[2][0]["data-i"]="Custom Dictionary",b.constructContextMenu(k.spellcheck,"ze_spellcheckmenu_div",j),e=document.getElementById("ze_spellcheckmenu_div"),ZE._addEvent(f,"mousedown",h),ZE._addEvent(f,"keydown",h);var o=ZE.getPos(b.editordiv),p=e.style;a.clientY,o.offsetTop,b.toolbardiv.offsetHeight,a.clientX,o.offsetLeft;posx=0,posy=0;var q=b.iframe.getBoundingClientRect(),r=c.getBoundingClientRect();a.pageX||a.pageY?(posx=q.left+r.left+(a.pageX-r.left),b.win.scrollY?posy=q.top+r.top+(a.pageY-r.top)-b.win.scrollY:posy=q.top+r.top+(a.pageY-r.top)-b.win.pageYOffset):(posx=q.left+r.left+(a.clientX-r.left),b.win.scrollY?posy=q.top+r.top+(a.clientY-r.top)-b.win.scrollY:posy=q.top+r.top+(a.clientY-r.top)-b.win.pageYOffset),p.left=parseInt(posx)+"px",p.top=parseInt(posy)+"px";var s=e.offsetHeight;if(posy+s>window.innerHeight-20){var t=posy-s;p.top=t<41?"40px":parseInt(t)+"px"}},ZE.prototype.removeSpellcheckEvent=function(a){var b=this;b.spellCheckEvent&&ZE._removeEvent(b.doc,"mouseup",b.spellCheckEvent),ZE.activeEditor&&delete ZE.activeEditor;var c=b.sclog;c.style.display="",c.innerHTML="success"===a?ZE.i18n("No errors"):ZE.i18n("Try Again"),setTimeout(function(){b.sclog.style.display="none",b.screcheck.style.display=""},2500),b.screcheck.style.display="none",b.sccancel.style.display="none",b.scclose.style.display="",b.scspan.style.display=""},ZE.prototype.leaveSimilarErrorWords=function(a){var b,c=this,d=c.mode,e=c.spellcheckdiv;if(a=a.toLowerCase(),"plaintext"===d?e&&(b=e.getElementsByTagName("span")):b=c.doc.getElementsByTagName("span"),b)for(var f=b.length-1;f>=0;f--){var g=b[f];if(g.hasAttribute("replaceword")&&a===g.getAttribute("replaceword").toLowerCase())if(g.style.backgroundColor="",g.style.length>0)g.removeAttribute("data-s"),g.removeAttribute("replaceword");else if(g.hasChildNodes()){for(var h=g.childNodes,i=g.parentNode,j=0;j<h.length;j++)i.insertBefore(h[j].cloneNode(!0),g);i.removeChild(g)}}},ZE.prototype.spellcheckOptions=function(a,b){var c=this,d=a.target,e=document,f=e.getElementById("ze_spellcheck_options"),g=c.doc,h=c.toolbarobject[b];ZE.addClass(h,"ze_dn ze_Sel");var i=function(a){a&&"keydown"!==a.type&&c._stopEvent(a),f&&(f.style.display="none",ZE._removeEvent(f,"click",k)),ZE.removeClass(h,"ze_dn ze_Sel"),ZE._removeEvent(e,"mousedown",m),ZE._removeEvent(g,"mousedown",m),ZE._removeEvent(g,"keydown",m),f=e.getElementById("ze_spellcheck_options"),f&&f.parentElement.removeChild(f),o.appendChild(r)},j=function a(b){b&&c._stopEvent(b),ZE._removeEvent(e,"keydown",a),ZE._removeEvent(e,"mousedown",m);var d=document.getElementById("ze_spellcheckmenu_div");d&&d.parentNode.removeChild(d)},k=function(a){c._stopEvent(a);var b=a.target,e=b.nodeName;if("UL"===e)return!1;if("LI"===e);else"IMG"===b.nodeName&&(b=b.parentNode),"SPAN"===b.nodeName&&(b=b.parentNode);if(b.hasAttribute("data-cd")&&"customdictionary"===b.getAttribute("data-cd"))c.ZiaFilesLoaded?c.showCustomDictionary():c.customDictionary();else{var g=document.createElement("i");g.className="zei-tick","LI"===b.nodeName&&b.insertBefore(g,b.firstChild),f.setAttribute("data-index",b.getAttribute("data-index")),
d.setAttribute("data-lang",b.getAttribute("data-lang")),c.defaultSpellcheckLanguage=b.getAttribute("data-lang"),"locale"===c.defaultSpellcheckLanguage&&(c.defaultSpellcheckLanguage=ZE.getLanguage(navigator.language.toLowerCase())),c.ZiaFilesLoaded&&"richtext"===c.mode?c.triggerZiaSpellcheck():"function"===c.initobj.changeSpellcheckLanguage&&c.initobj.changeSpellcheckLanguage(c.defaultSpellcheckLanguage)}i()},l=function(){var a=.6*(window.innerHeight-c.iframe.getBoundingClientRect().top);return a<150?a=150:a>300&&(a=300),a},m=function(a){if(a){if(_target=a.target,"LI"!==_target.nodeName)j(),i();else if(void 0===f)return!1;for(;null!==_target&&_target!==f;)_target=_target.parentNode}_target||i()},n=d.className;if(n&&n.search("ze_dn")>0)return i(),!1;if(f)f.style.display="",f.firstChild.style.height=l()+"px",ZE.addClass(h,"ze_dn"),ZE_Init.needEditorStats&&c.updateCount("spo");else{var o=e.createDocumentFragment(),p=(ZE_Init.imgPath,ZE.i18n),q=e.createElement("div");q.className="ze_dd shw",q.id="ze_spellcheck_options",f=q;var r=e.createElement("ul");r.className="ze_spellCheck",r.style.height=l()+"px",r.style.overflow="hidden",r.style.overflowY="scroll",o.appendChild(r);var s=ZE_Init.spellCheckOptions;c.ZiaFilesLoaded?s=c.getZiaSpellcheckLangList():s||(s=[["locale","Auto"],["af-ZA","Afrikaans"],["am","Amharic"],["ar",""],["hy_AM",""],["az","Azeri"],["bg_BG",""],["bn_BN","Bengali"],["ca","Catal"],["cs_CZ","esk"],["da","Danske"],["nl_NL","Nederlands"],["en-AU","English(AU)"],["en-CA","English(CA)"],["en-NZ","English(NZ)"],["en-GB","English(UK)"],["en-US","English(US)"],["en_ZA","English(ZA)"],["eo_l3","Esperanto"],["et_EE","Eesti"],["fo_FO","Faroese"],["fa","Farsi"],["fj_FJ","Fijian"],["fr-FR","Franais"],["fy_NL","Frisian"],["gl","Galego"],["de-AT","Deutsch(AT)"],["de-CH","Deutsch(CH)"],["de-DE","Deutsch(DE)"],["el_GR",""],["he-IL",""],["hi_IN",""],["hu","Magyar"],["id_ID","Indonesia"],["ia","Interlingua"],["ga_IE","Gaeilge"],["is","slenska"],["it","Italiano"],["ko","Korean"],["la","Latin"],["lv-LV","Latvijas"],["lt","Lietuvos"],["mi","Maori"],["ms_MY","Melayu"],["mr_IN","Marathi"],["mn_MN","Mongolian(MN)"],["ne_NP","Nepali"],["nb_NO","Norsk bokml"],["nn","Norsk Nynorsk"],["ns_ZA","Northern Sotho"],["oc_FR","Occitan"],["or_OR","Oriya"],["PL","Polski"],["pt_PT","Portugus(PT)"],["pt-BR","Portugus(BR)"],["qu_BO","Quechua"],["rw_RW","Rheato-Romanic"],["ro","Romn"],["ru",""],["gd_GB","Scots gaelic"],["sr",""],["sk","Slovensk"],["sl","Slovenski"],["es_CL","Espaol(CL)"],["es_CO","Espaol(CO)"],["es_EC","Espaol(EC)"],["es-ES","Espaol(ES)"],["es-MX","Espaol(MX)"],["es_NI","Espaol(NI)"],["es_PE","Espaol(PE)"],["es_PR","Espaol(PR)"],["es_UY","Espaol(UY)"],["sv_SE","Svenska"],["sw_KE","Swahili"],["ta_TA",""],["tn_ZA","Tswana"],["ts_ZA","Tsonga"],["uz_UZ","Uzbek"],["ve_ZA","Venda"],["vi_VI","Vietnamese"],["xh_ZA","Xhosa"],["zu-ZA","Zulu"]]),c.defaultSpellcheckLanguage||(c.defaultSpellcheckLanguage=ZE_Init.spellcheckLanguage||c.initobj.spellcheckLanguage||"locale");for(var t,u=0;t=s[u];u++){var v=t[0],w=t[1],x=e.createElement("li");x.title=x.href=w,x.setAttribute("data-index",u),x.setAttribute("data-lang",v);var y=e.createElement("i");c.defaultSpellcheckLanguage===v&&(y.className="zei-tick"),x.appendChild(y);e.createElement("span");x.appendChild(e.createTextNode(w)),r.appendChild(x)}var z=e.createElement("ul");z.className="custom";var A=e.createElement("li");z.appendChild(A),A.setAttribute("data-cd","customdictionary"),A.title=A.href="Custom Dictionary";var B=(e.createElement("span"),document.createElement("i"));B.className="zei-custDict",A.appendChild(B),A.appendChild(e.createTextNode(p("Custom Dictionary"))),ZE.addClass(h,"ze_dn"),q.appendChild(o),q.appendChild(z),e.body.appendChild(q);var C=q.querySelectorAll("[data-lang='"+c.defaultSpellcheckLanguage+"']")[0];if(C){var D=C.offsetTop;C.parentElement.scrollTop=D}ZE_Init.needEditorStats&&c.updateCount("spo")}ZE._addEvent(f,"mousedown",k);var E=ZE.getPos(d),F=f.style,G=E.offsetLeft,H=G-f.offsetWidth+d.offsetWidth;H<c.editordiv.getBoundingClientRect().left?F.left=G+"px":F.left=H+5+"px",F.top=E.offsetTop+d.offsetHeight-1+"px"},ZE.prototype.addToDictionary=function(a){var b,c=this,d=location,e="locale",f=(c.popupdiv,document);c.leaveSimilarErrorWords(a),b=document.createElement("form"),b.method="POST",ZE_Init.useProxy?b.action=ZE_Init.spellcheckProxyUrl+"/lt/customdictionary.lt?operation=add&word="+a+"&servicename="+d.hostname.split(".")[0]+"&language="+e+"&iscsignature="+ZE_Init.iscsignature:b.action=d.protocol+"//"+ZE_Init.spellcheckURL+"/lt/customdictionary.lt?operation=add&word="+a+"&servicename="+d.hostname.split(".")[0]+"&language="+e+"&iscsignature="+ZE_Init.iscsignature,b.target="ze_spellcheck",f.body.appendChild(b),b.submit(),f.body.removeChild(b)},ZE.prototype.customDictionary=function(){var a=this,b=document,c=b.getElementById("ze_cstm_dict"),d=ZE.i18n,e="locale";e=a.defaultSpellcheckLanguage||"locale";var f=function(){ZE._removeEvent(b,"keydown",g),c.parentNode.removeChild(c),ZE.hideOverlay(),a.win.focus()},g=function(b){27==b.keyCode&&(a._stopEvent(b),f())};if(ZE.showOverlay(),c)c.style.display="",c.getElementsByTagName("iframe")[0].src=location.protocol+"//"+ZE_Init.spellcheckURL+"/lt/customdictionary2g.lt?CD_LANGUAGE="+e;else{var h="<div class='zep_PUtt' onmousedown='ZE.drag(event,\"ze_cstm_dict\");return false;'>";h+=d("Custom Dictionary"),h+="<i class='zei-close'></i></div>",h+="<div class='zep_PUcen' style='margin:10px 0px 10px 0px;'>",h+="<iframe frameborder='0' style='border: medium none; width: 420px; height: 260px;' src="+location.protocol+"//"+ZE_Init.spellcheckURL+"/lt/customdictionary2g.lt?CD_LANGUAGE="+e+"></iframe>",h+="</div>";var i=b.createElement("div");i.className="zep_PU",i.innerHTML=h,i.id="ze_cstm_dict",document.body.appendChild(i),c=i}ZE.setPosition(c,a.editordiv),c.getElementsByClassName("zei-close")[0].onclick=function(b){a._stopEvent(b),f()},c.focus(),ZE._addEvent(b,"keydown",g)},ZE.prototype.createTable=function(a){function b(b){p._stopEvent(b);var d,e,f,h,i,j,k,n,o,q,v,w,x,y,z,A,B,C,D,E,F,G,H,I=p.initobj;ZE_Init.outGoingFontFamily;if(m&&p.restoreSelection(m),g){if(!((d=g.value)>0&&d<100))return u(s("Specify valid number for Rows")),g.focus(),g.select(),!1;if(e=r.querySelectorAll("[data-attr='cols']")[0],!((f=e.value)>0&&f<100))return u(s("Specify valid number for Columns")),e.focus(),e.select(),!1}if(h=r.querySelectorAll("[data-attr='width']")[0],!((i=h.value)>1&&i<1e4))return u(s("Specify valid number for Width")),h.focus(),h.select(),!1;if(j=r.querySelectorAll("[data-attr='padding']")[0],a){if(E=r.querySelectorAll("[data-attr='spacing']")[0],""==(G=E.value)||!(G>=0&&G<100))return u(s("Specify valid number for Cell Padding")),E.focus(),E.select(),!1;if(F=r.querySelectorAll("[data-attr='spacing']")[0],""==(H=F.value)||!(H>=0&&H<100))return u(s("Specify valid number for Cell Spacing")),F.focus(),F.select(),!1}if(j=r.querySelectorAll("[data-attr='border']")[0],""==(k=j.value)||!(k>=0&&k<100))return u(s("Specify valid number for Border")),j.focus(),j.select(),!1;if(n=p.doc,o=r.getElementsByTagName("select")[0],a)D=a.style,a.width&&(a.width=""),l?(a.style.tableLayout="fixed",a.style.wordWrap="break-word"):(a.style.tableLayout="",a.style.wordWrap=""),D.width=i+o.options[o.selectedIndex].value,a.style.border&&(a.style.border=""),a.border=k,a.cellPadding=G,a.cellSpacing=H,D.border=k+"px solid black",D.color="black",p.win.focus();else{for(q=n.createDocumentFragment(),q.appendChild(n.createElement("br")),v=n.createElement("table"),D=v.style,D.width=i+o.options[o.selectedIndex].value,D.fontSize=I.defaultfontsize||ZE_Init.defaultFontSize||"",D.fontFamily=I.defaultfontfamily||ZE_Init.defaultFontFamily||"",v.cellPadding="2",v.cellSpacing="2",v.border=k,D.border=k+"px solid black",D.color="black",w=n.createElement("tbody"),x=0;x<d;x++){for(z=n.createElement("tr"),y=0;y<f;y++){A=n.createElement("td");var J=n.createElement("div");J.appendChild(n.createElement("br")),A.appendChild(J),z.appendChild(A)}w.appendChild(z)}v.appendChild(w),q.appendChild(v),q.appendChild(n.createElement("br")),p.win.focus(),B=p._getSelection();try{B.isCollapsed||B.deleteFromDocument(),C=B.getRangeAt(0)}catch(K){C=p._createRange(B)}try{C.insertNode(q),t(v)}catch(L){u(s("Exception in inserting table"))}}return c(),p.saveCurrentState(),!1}var c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=document,r=q.getElementById("ze_ins_table"),s=ZE.i18n;c=function(){var a=r.getElementsByTagName("form")[0];q.removeEventListener("keydown",d,!0),r.parentNode.removeChild(r),ZE.hideOverlay(),a&&a.reset(),p.win.focus(),p.range&&(p.range.select(),delete p.range)},initialize=function(){var b,c,d,e,f,h,i,j;g&&(g.value=a.rows.length,g.disabled=!0),b=r.querySelectorAll("[data-attr='cols']")[0],b&&(b.value=a.rows[0].cells.length,b.disabled=!0),c=r.querySelectorAll("[data-attr='width']")[0],f=a.style.width||a.width,h=r.getElementsByTagName("select")[0],-1!=f.indexOf("%")?h.selectedIndex="0":h.selectedIndex="1",f&&(c.value=parseInt(f));var m=a.style.tableLayout;k&&(""===m?(k.classList.remove("zei-check"),k.classList.add("zei-uncheck"),l=!1):(k.classList.remove("zei-uncheck"),k.classList.add("zei-check"),l=!0)),c.focus(),i=r.querySelectorAll("[data-attr='padding']")[0],a.cellPadding?i.value=a.cellPadding:i.value="0",j=r.querySelectorAll("[data-attr='spacing']")[0],a.cellSpacing?j.value=a.cellSpacing:j.value="0",d=r.querySelectorAll("[data-attr='border']")[0],e=a.style.border||a.border,d.value=e?parseInt(e):"0"},d=function(a){27===a.keyCode&&(p._stopEvent(a),c()),13===a.keyCode&&(p._stopEvent(a),b(a))},n=s(a?"Edit Table Properties":"Insert Table"),e='<div class="zep_PUtt">'+s(n)+'<i class="zei-close"></i></div>',e+='<div class="zep_PUcen">',e+='<form><table class="ze_ptble">',a||(e+="<tr><td>"+s("Rows")+'</td><td><input data-attr="rows" type="text" class="ze_m20" value="2" maxlength="2" size="2"></td><td>'+s("Columns")+'</td><td><input data-attr="cols" type="text" value="2" maxlength="2" size="2"></td></tr>'),e+="<tr><td>"+s("Width")+'</td><td><input data-attr="width" type="text" value="100" maxlength="4" size="2"/></td><td colspan="2"><div class="ze_select"><select class="select"><option value="%">%</option><option value="px">'+s("px")+"</option></select></div></td></tr>",a&&(e+="<tr><td>"+s("Cell Padding")+'</td><td><input data-attr="padding" type="text" maxlength="2" size="2"/></td><td>'+s("Cell Spacing")+'</td><td><input data-attr="spacing" type="text" maxlength="2" size="2"/></td></tr>'),e+="<tr><td>"+s("Border")+'</td><td><input data-attr="border" type="text" value="1" maxlength="2" size="2"/></td></tr>',e+='<tr><td colspan="2" data-attr="layoutContainer"><label class="zeRadioEle"><i data-attr="tableLayout" class="zei-uncheck"></i><span>'+s("Wrap text")+"</span></label></td></tr>",e+="</table></form></div>",e+='<div class="zep_PUbtm"><span class="sel">'+s("OK")+'</span><span data-val="Cancel">'+s("Cancel")+"</span></div>",ZE.showOverlay(),p.win.focus(),m=p.saveSelection(),f=q.createElement("div"),f.setAttribute("class","zep_PU zep_arrb"),f.innerHTML=e,f.id="ze_ins_table",r=f,document.body.appendChild(f),ZE.setPosition(r,p.editordiv),r.getElementsByTagName("input"),g=r.querySelectorAll("[data-attr='rows']")[0],h=r.getElementsByTagName("span"),o=h[0],i=r.getElementsByClassName("zei-close")[0],j=r.querySelectorAll("[data-attr='layoutContainer'")[0],k=r.querySelectorAll("[data-attr='tableLayout'")[0],ZE._addEvent(j,"click",function(){"zei-check"===k.classList[0]?(k.classList.remove("zei-check"),k.classList.add("zei-uncheck"),l=!1):(k.classList.add("zei-check"),k.classList.remove("zei-uncheck"),l=!0)}),a?initialize():g.focus();var t=function(a){for(var b=a,c=b.offsetWidth,d=b.getElementsByTagName("TR"),e=d[0].getElementsByTagName("TD"),f=e.length,g=d.length,h=c/f,i=0;i<g;i++)for(var j=0;j<f;j++)d[i].getElementsByTagName("TD")[j]&&(d[i].getElementsByTagName("TD")[j].style.width=h+"px")};i.onclick=h[2].onclick=function(a){p._stopEvent(a),c()};var u=function(a){o=r.getElementsByTagName("span"),o[0].style.display="",o[0].innerHTML=a};h[1].onclick=b,ZE._addEvent(q,"keydown",d)},ZE.prototype.insertObj=function(){"use strict";var a,b,c,d,e,f,g=this,h=document,i=h.getElementById("ze_ins_obj"),j=ZE.i18n;g.freeze(),b=function(){i.style.display="none",a.value="",g.hideFreeze(),g.win.focus(),h.removeEventListener("keydown",c,!0)},c=function(a){27===a.keyCode&&(g._stopEvent(a),b())},i?i.style.display="":(d="<div class='ze_pop_header' onmousedown='ZE.drag(event,\"ze_ins_obj\");return false;'><img class='ze_closeimg' src='",d+=ZE_Init.imgPath+"/images/spacer.gif'/>",d+="<h4>"+j("Insert HTML")+"</h4></div>",d+='<div class="ze_subpart ze_objsub"><span class="ze_clr"><textarea class="ze_objecttxt">',d+="</textarea></span></div>",d+='<div class="ze_botpart"><input type="submit" class="ze_btn" value=',d+=j("Insert")+' /><input type="submit" class="ze_btn" value='+j("Cancel")+" /></div>",e=h.createElement("div"),e.className="ze_objpop",e.innerHTML=d,e.id="ze_ins_obj",document.body.appendChild(e),i=e),ZE.setPosition(i,g.editordiv),a=i.getElementsByTagName("textarea")[0],a.focus(),f=i.getElementsByTagName("input"),i.getElementsByTagName("img")[0].onclick=f[1].onclick=function(a){g._stopEvent(a),b()},f[0].onclick=function(c){g._stopEvent(c);var d=a.value;if(d=ZE.trim(d),0===d.length)return alert(j("Please Enter some HTML")),a.focus(),!1;g.win.focus(),g.doc.execCommand("inserthtml",!1,d),b()},h.addEventListener("keydown",c,!0)},ZE.prototype.showContextMenu=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=ZE.i18n,n=document,o=l.doc;a.target;_target1=a.target,delete_table=function(){l.win.focus(),c.parentNode.removeChild(c),hideContextMenu(),l.win.focus(),l.saveCurrentState()},delete_current_row=function(){if(l.win.focus(),j=get_current_row()){if(j.parentNode.removeChild(j),0==c.rows.length)return void delete_table();hideContextMenu(),l.saveCurrentState()}},delete_current_column=function(){if(l.win.focus(),j=get_current_row()){var a=get_current_column(),b=getPosition(j,a),c=j.parentNode,e=c.getElementsByTagName("TR");for(d=e.length,k=0;k<d;k++){var f=e[k].children;e[k].removeChild(f[b])}if(!e[0].hasChildNodes())return void delete_table();hideContextMenu(),l.saveCurrentState()}},get_current_row=function(){if(i=_target1,"TR"!=i.nodeName)for(;null!==i&&"TR"!=i.nodeName;i=i.parentNode);return i},getColumnsNo=function(a){return a.children.length},constructRow=function(a,b){var c,d=o.createDocumentFragment(),e=o.createElement("tr"),f=b.rowStyle,g=b.colStyle;if(f)for(var h=f.split(";"),i=h.length,j=0;j<i;j++)c=h[j].split(":"),c[0].trim().length>0&&(e.style[c[0].trim()]=c[1].trim());if(d.appendChild(e),g){var l=g.split(";");i=l.length}else i=0;for(k=0;k<a;k++){for(var m=o.createElement("td"),n=0;n<i;n++)c=l[n].split(":"),c[0].trim().length>0&&(m.style[c[0].trim()]=c[1].trim());var p=o.createElement("div");p.appendChild(o.createElement("br")),m.appendChild(p),e.appendChild(m)}return d},insert_row_above=function(a){l.win.focus(),j=get_current_row();var b={};if(b={rowStyle:j.getAttribute("style")||null,colStyle:j.childNodes[0].getAttribute("style")||null},j){var c=getColumnsNo(j);f=constructRow(c,b),j.parentNode.insertBefore(f,j),"noHide"!==a&&hideContextMenu(),selectedRange&&l.restoreSelection(selectedRange),l.win.focus(),l.saveCurrentState()}},insert_row_below=function(a){l.win.focus(),j=get_current_row();var b={};if(b={rowStyle:j.getAttribute("style")||null,colStyle:j.childNodes[0].getAttribute("style")||null},j){var c=getColumnsNo(j);f=constructRow(c,b),j.parentNode.insertBefore(f,j.nextSibling),"noHide"!==a&&hideContextMenu(),selectedRange&&l.restoreSelection(selectedRange),l.win.focus(),l.saveCurrentState()}},insert_column_left=function(a){if(l.win.focus(),j=get_current_row()){var b=get_current_column(),c=b.getAttribute("style"),e=0,f={};if(c){var g=c.split(";");e=g.length;var h;f.borderWidth=j.parentElement.firstChild.firstChild.style.borderWidth,f.borderStyle=j.parentElement.firstChild.firstChild.style.borderStyle}var i=getPosition(j,b),m=j.parentNode,n=m.getElementsByTagName("TR");for(d=n.length,k=0;k<d;k++){var p=n[k].children,q=o.createElement("td");e>0&&(q.style.width=j.offsetWidth+"px");for(var r=0;r<e;r++)h=g[r].split(":"),h[0].trim().length>0&&(q.style[h[0].trim()]=h[1].trim());for(r=0;r<Object.keys(f).length;r++)q.style.borderWidth=f.borderWidth,q.style.borderStyle=f.borderStyle;var s=o.createElement("div");s.appendChild(o.createElement("br")),q.appendChild(s),n[k].insertBefore(q,p[i])}"noHide"!==a&&hideContextMenu(),l.saveCurrentState()}},getPosition=function(a,b){var c=a.children;for(d=c.length,k=0;k<d;k++)if(b===c[k])return k},get_current_column=function(){if(i=_target1,"TD"!=i.nodeName)for(;null!==i&&("TD"!=i.nodeName&&"TH"!=i.nodeName);i=i.parentNode);return i},insert_column_right=function(a){if(l.win.focus(),j=get_current_row()){var b=get_current_column(),c=b.getAttribute("style"),e=0,f={};if(c){var g=c.split(";");e=g.length;var h;f.borderWidth=j.parentElement.firstChild.firstChild.style.borderWidth,f.borderStyle=j.parentElement.firstChild.firstChild.style.borderStyle}var i=getPosition(j,b),m=j.parentNode,n=m.getElementsByTagName("TR");for(d=n.length,k=0;k<d;k++){var p=n[k].children,q=o.createElement("td");e>0&&(q.style.width=j.offsetWidth+"px");for(var r=0;r<e;r++)h=g[r].split(":"),h[0].trim().length>0&&(q.style[h[0].trim()]=h[1].trim());for(r=0;r<Object.keys(f).length;r++)q.style.borderWidth=f.borderWidth,q.style.borderStyle=f.borderStyle;var s=o.createElement("div");s.appendChild(o.createElement("br")),q.appendChild(s),n[k].insertBefore(q,p[i].nextSibling)}"noHide"!==a&&hideContextMenu(),l.saveCurrentState()}},edit_table=function(){var a=c;l.createTable(a),hideContextMenu(1)};var p={table:[[{cmd:m("Insert Rows Above"),id:"insert_row",class:"li_class",method:insert_row_above,subMenu:"RA"},{cmd:m("Insert Rows Below"),class:"li_class",method:insert_row_below,subMenu:"RB"},{cmd:m("Insert Column left"),class:"li_class",method:insert_column_left,subMenu:"CL"},{cmd:m("Insert Column right"),class:"li_class",method:insert_column_right,subMenu:"CR"}],[{cmd:m("Delete Row"),id:"delete_row",method:delete_current_row},{cmd:m("Delete Column"),class:"li_class",method:delete_current_column},{cmd:m("Delete Table"),method:delete_table}],[{cmd:m("Edit Table"),method:edit_table}]]};switch(executeFunction=function(a,b){b[a].method()},b){case"table":if(!get_current_row())return;e=p.table}hideContextMenu=function(a){a||(selectedRange&&l.restoreSelection(selectedRange),l.win.focus()),(g=document.getElementById("ze_contextMenudd"))&&(document.body.removeChild(g),ZE._removeEvent(n,"mousedown",h),ZE._removeEvent(o,"mousedown",h),ZE._removeEvent(o,"keydown",h))},h=function(a){if(g=document.getElementById("ze_contextMenudd"),a)for(i=a.target;null!==i&&i!==g;i=i.parentNode);i||hideContextMenu()},setPositions=function(a){var b=0,c=0,d=document,e=document.body,f=d.documentElement,h=Math.max(e.scrollTop,f.scrollTop),i=l.iframe.getBoundingClientRect(),j=_target1.getBoundingClientRect();a.pageX||a.pageY?(b="comment"===l.initobj.type?j.left:i.left+j.left+(a.pageX-j.left),l.win.scrollX>0&&(b-=l.win.scrollX),c=l.win.scrollY?i.top+j.top+(a.pageY-j.top)-l.win.scrollY:i.top+j.top+(a.pageY-j.top)-l.win.pageYOffset,"comment"===l.initobj.type&&(c=j.top)):(b=i.left+j.left+(a.clientX-j.left),c=l.win.scrollY?i.top+j.top+(a.clientY-j.top)-l.win.scrollY:i.top+j.top+(a.clientY-j.top)-l.win.pageYOffset),c+=h||0,g.style.left=parseInt(b)+"px",g.style.top=parseInt(c)+"px";var k=(ZE.getPos(l.editordiv),g.style),m=g.offsetHeight,n=document.body.getBoundingClientRect().width;if(b+g.offsetWidth+10>n&&(k.left="auto",b=window.innerWidth-b,k.right=parseInt(b)+"px"),c+m>window.innerHeight-20){var o=c-m;k.top=o<10?"40px":parseInt(o)+"px"}},l.constructContextMenu(e,"ze_contextMenudd"),l.win.focus(),selectedRange=l.saveSelection(),g=document.getElementById("ze_contextMenudd"),setPositions(a),ZE._addEvent(n,"mousedown",h),ZE._addEvent(o,"mousedown",h),ZE._addEvent(o,"keydown",h)};var constructTable=function(a){"use strict";a.preventDefault(),a.stopPropagation();var b=a.target.getAttribute("data-action");switch(a.target.parentNode.getAttribute("data-subMenu")){case"RB":"increase"===b?insert_row_below("noHide"):"decrease"===b&&delete_current_row("RB");break;case"RA":"increase"===b?insert_row_above("noHide"):"decrease"===b&&delete_current_row("RA");break;case"CL":"increase"===b?insert_column_left("noHide"):"decrease"===b&&delete_current_column("CL");break;case"CR":"increase"===b?insert_column_right("noHide"):"decrease"===b&&delete_current_column("CR")}},loopInlineStyles=function(a,b){var c=Object.keys(b);return c.forEach(function(d,e){a.style[c[e]]=b[d]}),a};ZE.prototype.constructContextMenu=function(a,b,c){var d,e,f,g,h,i,j=this,k=a.length;for(d=document.createElement("div"),d.className="ze_dd shw notrans ze_tbdr",d.id=b,e=document.createElement("div"),f=document.createElement("ul"),h=0;h<k;h++){var l=a[h];for(i=0;i<l.length;i++)if(g=document.createElement("li"),g.innerHTML=l[i].cmd,l[i].style&&loopInlineStyles(g,l[i].style),l[i].id&&(g.id=l[i].id),l[i].class&&(g.className=l[i].class),f.appendChild(g),g.setAttribute("data-value",i),l[i]["data-i"]&&g.setAttribute("data-i",l[i]["data-i"]),l[i].color&&(g.style.color=l[i].color),l[i].fontWeight&&(g.style.fontWeight=l[i].fontWeight),l[i].method&&(g.onclick=l[i].method),l[i].subMenu){var m=document.createElement("i");m.className="zei-plus",m.setAttribute("data-action","increase"),m.id="ze_subMenu",g.appendChild(m),g.setAttribute("data-subMenu",l[i].subMenu),ZE._addEvent(m,"click",constructTable)}g=document.createElement("li"),g.className="ze_lne",f.appendChild(g)}e.appendChild(f),d.appendChild(e);var n=document.getElementsByClassName("ze_tbEd")[0];n&&n.parentElement.removeChild(n),document.body.appendChild(d),c&&ZE._addEvent(f,"mousedown",c),d.addEventListener("contextmenu",function(a){return j._stopEvent(a),!1},!1)},ZE.prototype.insertCode=function(){var a,b,c,d,e,f,g,h,i=this;if(i.doc.execCommand("insertorderedlist",!1," "),a=i.win.getSelection(),b=a.anchorNode,"OL"===b.nodeName)return void(b.className="code");for(c=!1;null!==b&&"BODY"!==b.nodeName;b=b.parentNode)if("OL"===b.nodeName){b.className="code",c=!0;break}if(!c){if(d=a.getRangeAt(0),e=d.commonAncestorContainer,1!==e.nodeType)for(;null!==e&&"BODY"!==e.nodeName&&1!==e.nodeType;e=e.parentNode);if(1===e.nodeType)for(f=e.getElementsByTagName("ol"),g=f.length,h=0;h<g;h++)if(a.containsNode(f[h],!0)){f[h].className="code";break}}},ZE.prototype._createTableGrid=function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=document,w=u.doc,x=a.target,y=u.initobj,z=5,A=5,B=[],C=0,D=0;u.toolbarobject&&(t=u.toolbarobject[b],"smartCompose"!==u.initobj.editorType?ZE.addClass(t,"ze_dn ze_Sel"):ZE.addClass(t,"ze_Sel"));var E={TABLEID:"tablegen_div",DROPDOWNID:"ze_dropdown",ROWATTR:"data-row_num",COLATTR:"data-col_num"};s=function(){var a=u.doc.createElement("div"),b=u.doc.createElement("br");a.appendChild(b);var c=u.doc.getSelection();if(null!==typeof c.anchorNode){var d=u.doc.createRange(),e=c.anchorNode;e.parentNode.insertBefore(a,e.nextSibling),d.setStart(a,0),d.setEnd(a,0),c.removeAllRanges(),c.addRange(d)}},k=u.saveSelection();var F=function(a,b,c){a.setAttribute(b,c)},G=function(a,b){var c,d;for(c=0;c<z;c++)for(d=0;d<A;d++)if(c<a&&d<b){var e=v.getElementById("displayDiv");e.innerHTML=a+"x"+b,B[c].childNodes[d].style.backgroundColor="#F4F4F4"}else B[c].childNodes[d].style.backgroundColor="#fff"};(j=function(){var a=v.createElement("div");a.id=E.DROPDOWNID,a.className="ze_dd shw ze_dropDown";var b=v.createElement("div");b.innerHTML="1 x 1",b.align="center",b.id="displayDiv",b.className="ze_tableDtl",e=document.createElement("table"),F(e,"id",E.TABLEID),e.className="ze_mainTable";for(var c=1;c<=z;c++){f=v.createElement("tr");for(var d=1;d<=A;d++)g=v.createElement("td"),g.className="ze_tableGridCol",ZE._setAttribute(g,E.ROWATTR,c),ZE._setAttribute(g,E.COLATTR,d),ZE._appendChildren(f,[g]);B.push(f),ZE._appendChildren(e,[f])}var h=v.createElement("ul"),i=v.createElement("li");return i.className="iTable",ZE._appendChildren(i,[b,e]),ZE._appendChildren(h,[i]),ZE._appendChildren(a,[h]),a}(),l=ZE.getPos(x),v.body.appendChild(j),"smartCompose"===u.initobj.editorType)?(h=v.getElementsByClassName("ze_tbEd")[0].offsetWidth-2,j.style.left=l.offsetLeft+h+"px",document.body.offsetHeight<x.getBoundingClientRect().top+300?j.style.top=l.offsetTop-j.offsetHeight+34+"px":j.style.top=l.offsetTop+"px"):(j.style.left=l.offsetLeft-2+"px",j.style.top=l.offsetTop+x.offsetHeight+"px");var H=v.getElementById(E.TABLEID),I=function(a){if(j=document.getElementById(E.DROPDOWNID),a)for(c=a.target;null!==c&&c!==j;)c=c.parentNode;c||(r(),j.parentElement.removeChild(j))};q=function(a){var b,c;if(d&&(C=d),i&&(D=i),d=a.target.dataset.row_num,i=a.target.dataset.col_num,Number(C)>Number(d))Number(C)>=5&&(m=v.getElementById(E.TABLEID),z--,m.deleteRow(z),B.pop());else if(Number(d)===z&&10!==z){m=v.getElementById(E.TABLEID),f=v.createElement("tr"),f.style.border="2",z++;for(var h=0;h<A;h++)g=v.createElement("td"),g.className="ze_tableGridCol",ZE._setAttribute(g,E.ROWATTR,z),ZE._setAttribute(g,E.COLATTR,h+1),f.appendChild(g);B.push(f),m.insertBefore(f,m.lastChild.nextSibling)}if(Number(D)>Number(i)){if(Number(D)>=5){b=e.getElementsByTagName("TR");for(var j,k=0;k<b.length;k++){j=A;for(var l=b[k].getElementsByTagName("TD"),n=0;n<1;n++)b[k].removeChild(l[j-1]),j--}A--}}else if(Number(i)===Number(A)&&10!==A){B=[],A+=1;var o=A;c=e.getElementsByTagName("TR"),m=v.getElementById(E.TABLEID);for(var p=0;p<c.length;p++){g=v.createElement("td");var q=c[p].getElementsByTagName("TD");g.className="ze_tableGridCol",ZE._setAttribute(g,E.ROWATTR,p+1),ZE._setAttribute(g,E.COLATTR,o),c[p].insertBefore(g,q[q.length-1].nextSibling),B.push(c[p])}}d||i?d?i?G(d,i):G(d,D):G(C,i):G(C,D)};var J=function(a){for(var b=a,c=b.offsetWidth,d=b.getElementsByTagName("TR"),e=d[0].getElementsByTagName("TD"),f=e.length,g=d.length,h=c/f,i=0;i<g;i++)for(var j=0;j<f;j++)d[i].getElementsByTagName("TD")[j].style.width=h+"px"},K=function(a,b){var c,d;u.win.focus(),k&&u.restoreSelection(k);var e=w.body.ownerDocument.createDocumentFragment();e.appendChild(v.createElement("br"));var f=v.createElement("table"),g=f.style;g.fontSize=y.defaultfontsize||ZE_Init.defaultFontSize||"",g.fontFamily=y.defaultfontfamily||ZE_Init.defaultFontFamily||"",g.width="100%",g.borderCollapse="collapse",g.border="1px solid black",f.className="ze_tableView",f.cellPadding="2",f.cellSpacing="2",f.border="1";var h,i,j=v.createElement("tbody");for(c=0;c<a;c++){for(h=v.createElement("tr"),d=0;d<b;d++){i=v.createElement("td");var l=v.createElement("div");l.appendChild(v.createElement("br")),i.appendChild(l),h.appendChild(i)}j.appendChild(h)}f.appendChild(j),e.appendChild(f),e.appendChild(v.createElement("br")),u.win.focus(),n=u._getSelection();try{n.isCollapsed||n.deleteFromDocument(),o=n.getRangeAt(0)}catch(m){o=u._createRange(n)}try{u.win.focus(),o.insertNode(e),J(f)}catch(p){}o.collapse(!1),n.removeAllRanges(),n.addRange(o),u.saveCurrentState(),s()};r=function(){"smartCompose"===u.initobj.editorType?ZE.removeClass(t,"ze_Sel"):t&&ZE.removeClass(t,"ze_dn ze_Sel"),ZE._removeEvent(H,"click",p),ZE._removeEvent(H,"mousemove",q),ZE._removeEvent(v,"mousedown",I),ZE._removeEvent(w,"mousedown",I),ZE._removeEvent(w,"keydown",I)},p=function(b){u._stopEvent(a),b.target.hasAttribute(E.ROWATTR)&&b.target.hasAttribute(E.COLATTR)?K(d,i):K(C,D),j=v.getElementById(E.DROPDOWNID),r(),j.parentElement.removeChild(j)},ZE._addEvent(v,"mousedown",I),ZE._addEvent(w,"mousedown",I),ZE._addEvent(w,"keydown",I),ZE._addEvent(H,"click",p),ZE._addEvent(H,"mousemove",q)},ZE.prototype.insertQuote=function(){"use strict";var a,b,c,d,e,f,g=this,h=g.doc;for(g.win.focus(),f=g.win.getSelection().anchorNode.parentNode;null!==f;){if("BLOCKQUOTE"===f.nodeName)return!0;f=f.parentNode}if(a=g._getSelection(),b=g._createRange(a),c=h.createDocumentFragment(),d=h.createElement("blockquote"),c.appendChild(d),e=h.createElement("div"),d.appendChild(e),ZE_Init.inlineQuotes?(d.style.border="1px solid #CCCCCC",d.style.padding="7px",d.style.backgroundColor="#F5F5F5"):d.className="block_quote",a.isCollapsed)e.appendChild(h.createElement("br")),b.insertNode(c),b.selectNodeContents(e),b.collapse(!0),a.removeAllRanges(),a.addRange(b);else{e.appendChild(b.cloneContents());var i=h.createElement("div");i.appendChild(c),c.appendChild(h.createElement("br")),g.insertHTML(i.innerHTML,!0)}g.saveCurrentState()},ZE.prototype.htmlView=function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=document,s=ZE.i18n;l=q.getContent();var t={TITLE:s("EDIT HTML"),HTAB:s("HTML"),PTAB:s("Preview"),SAVE:s("Apply changes"),CANCEL:s("Cancel")};g=function(c){a.style.display="block",b.style.display="block",a.value=n(c)},o=function(a,b){if(b.initobj.htmlViewStyleProps){var c=b.initobj.htmlViewStyleProps;Object.keys(c).forEach(function(b){a.style[b]=c[b]})}},f=function(){a.style.display="block",b.style.display="block";var c=DOMPurify.sanitize(a.value,{ADD_TAGS:q.initobj.allowTagsInsertHTML||[],ADD_ATTR:q.initobj.allowAttrsInsertHTML||[]}),d=b.contentWindow.document.body;d.innerHTML=c,o(d,q)},k=function(){ZE.hideOverlay(),c.parentNode.removeChild(c)},m=function(a){for(var b="",c=4*a;c--;)b+=" ";return b},n=function(a){a=a.trim();for(var b="",c=0,d=a.split(/</),e=d.length,f=0,g=e;f<g;f++){var h=d[f].split(/>/);2===h.length?("/"===d[f][0]&&c--,b+=m(c),"/"!==d[f][0]&&c++,f>0&&(b+="<"),b+=h[0].trim()+">\n",""!==h[1].trim()&&(b+=m(c)+h[1].trim().replace(/\s+/g," ")+"\n"),h[0].match(/^(img|hr|br)/)&&c--):b+=m(c)+h[0]+"\n"}return b},p=[String('<div class = "ze_popupTitle">'+t.TITLE),'<span class = "zei-close"> </span>',"</span>","</div>",'<div class = "ze_popupEditor">','<textarea style="resize:none;"></textarea>',"<iframe></iframe>","</div>",'<div class = "ze_popupButton">','<span class = "sel">'+t.SAVE+"</span>",'<span data-val = "Cancel">'+t.CANCEL+"</span>","</div>"].join(""),ZE.showOverlay(),c=r.createElement("div"),c.className="ze_popup",c.innerHTML=p,c.addEventListener("DOMNodeInsertedIntoDocument",function(){q.initobj.hasOwnProperty("popupConstructedCallback")&&"function"==typeof q.initobj.popupConstructedCallback&&q.initobj.popupConstructedCallback("editHTML",c)},!1),r.body.appendChild(c),ZE.setPosition(c,q.editordiv),d=c.getElementsByClassName("ze_popupEditor")[0],a=d.childNodes[0],b=d.childNodes[1],e=c.getElementsByClassName("ze_popupButton")[0],h=e.childNodes[0],i=e.childNodes[1],j=c.getElementsByClassName("zei-close")[0],ZE._addEvent(h,"mousedown",function(){var b=DOMPurify.sanitize(a.value,{ADD_TAGS:q.initobj.allowTagsInsertHTML||[],ADD_ATTR:q.initobj.allowAttrsInsertHTML||[]});q.setContent(b),k()}),ZE._addEvent(i,"mousedown",k),ZE._addEvent(j,"mousedown",k),ZE._addEvent(a,"keyup",function(){var c=DOMPurify.sanitize(a.value,{ADD_TAGS:q.initobj.allowTagsInsertHTML||[],ADD_ATTR:q.initobj.allowAttrsInsertHTML||[]}),d=b.contentWindow.document.body;d.innerHTML=c,o(d,q)}),g(l),f()},ZE.prototype.resizeColumn=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l=this,m=l.doc,n=document,o=a;m.getElementById("_resizecolDivs")&&(d=m.getElementById("_resizecolDivs"),d.parentElement.removeChild(d)),k=function(){m.getElementById("_resizecolDivs")&&(d=m.getElementById("_resizecolDivs"),d.parentElement.removeChild(d),delete m.event,ZE._removeEvent(m,"keydown",k))},f=function(a,b){var c=a,d=b,e=c.getElementsByTagName("TR"),f=e[0].getElementsByTagName("TD")||e[0].getElementsByTagName("TH"),g=f.length,h=e.length;c.style.width=null;for(var i=d/g,j=0;j<h;j++)for(var k=0;k<g;k++)e[j].getElementsByTagName("TD")[k].style.width=i+"px"},j=function(a){var b,c,d,f=a.clientY,g=0,h=o.getBoundingClientRect();m.documentElement.scrollTop?g=m.documentElement.scrollTop:m.body.scrollTop&&(g=m.body.scrollTop);var i=h.height;c=function(){e&&e.parentElement.removeChild(e),
l.doc.querySelectorAll("#_resizecolDivs")[0]&&(s=l.doc.querySelectorAll("#_resizecolDivs")[0],s.parentElement.removeChild(s)),ZE._removeEvent(m,"mousemove",d),ZE._removeEvent(m,"mouseup",c),o.style.height=b+"px"},d=function(c){b="rowTop"===a.target.id?f>c.clientY?i+c.clientY:i-c.clientY:i+c.clientY-f,e.style.top=c.clientY+g+"px"},ZE._addEvent(m,"mousemove",d),ZE._addEvent(m,"mouseup",c)},h=function(a){var b=a.clientY,c=a.target.id,d=e.getBoundingClientRect(),f=d.height,g=function(a){var c=f+a.clientY-b;e.style.height=c+"px"},h=function a(){var d=q[c].getElementsByTagName("td").length;b=e.getBoundingClientRect().height;for(var f=0;f<d;f++)q[c].getElementsByTagName("td")[0].style.height=b+"px";e.parentElement.removeChild(e),l.doc.querySelectorAll("#_resizecolDivs")[0]&&(s=l.doc.querySelectorAll("#_resizecolDivs")[0],s.parentElement.removeChild(s)),ZE._removeEvent(m,"mousemove",g),ZE._removeEvent(m,"mouseup",a)};ZE._addEvent(m,"mousemove",g),ZE._addEvent(m,"mouseup",h)},c=function(a){var b,c=a.clientX,d=0,h=o.getBoundingClientRect(),j=h.width;m.documentElement.scrollLeft?d=m.documentElement.scrollLeft:m.body.scrollLeft&&(d=m.body.scrollLeft),g=function(f){b="tabLeft"===a.target.id?j-f.clientX:j+f.clientX-c,e.style.left=f.clientX+d+"px"},i=function(){f(o,b),e=m.getElementById("_colEncloseDiv"),e&&e.parentElement.removeChild(e),s=l.doc.querySelectorAll("#_resizecolDivs")[0],l.doc.querySelectorAll("#_resizecolDivs")[0]&&s.parentElement.removeChild(s),ZE._removeEvent(m,"mousemove",g),ZE._removeEvent(m,"mouseup",i)},ZE._addEvent(m,"mousemove",g),ZE._addEvent(m,"mouseup",i)};var p=function(a){var b=a.clientX,c=e.getBoundingClientRect(),d=c.width,f=function b(){u=q.length;var c=parseInt(a.target.id);for(y=0;y<u;y++)q[y].getElementsByTagName("TD")[c]?q[y].getElementsByTagName("TD")[c].style.width=e.offsetWidth-9+"px":q[y].getElementsByTagName("TH")[c]&&(q[y].getElementsByTagName("TH")[c].style.width=e.offsetWidth-9+"px");m.removeEventListener("mousemove",g,!1),m.removeEventListener("mouseup",b,!1),ZE._removeEvent(m,"keydown",k),e.parentElement.removeChild(e);var d=m.getElementById("_resizecolDivs");d&&d.parentElement.removeChild(d)},g=function(a){var c=d+a.clientX-b;e.style.width=c<=75?"75px":c+"px",e.style.height=o.offsetHeight+"px"};m.addEventListener("mousemove",g,!1),m.addEventListener("mouseup",f,!1)};b=function(a){if(l._stopEvent(a),3===a.which)return!1;e=n.createElement("div");var b,d,f=a.target,g=0,i=e.style,k=parseInt(f.id);return e.id="_colEncloseDiv",i.position="absolute","number"==typeof k&&"ze_rowResize"===f.className&&"rowTop"!==f.id&&"rowBottom"!==f.id?(b=q[k].getBoundingClientRect(),i.left=b.left+"px",i.width=b.width+"px",i.height=b.height+"px",i.border="2px dashed #686666",i.top=b.top+w+"px",m.body.appendChild(e),h(a),!0):"rowTop"===f.id||"rowBottom"===f.id?(b=q[0].getBoundingClientRect(),i.left=b.left+"px",g=o.getBoundingClientRect().top,i.width=b.width+"px",i.border="2px dashed #686666","rowBottom"===a.target.id&&(g=o.getBoundingClientRect().bottom),i.top=g+w+"px",m.body.appendChild(e),j(a),!0):(g=o.getBoundingClientRect().top,i.top=g+w+"px",i.height=o.getBoundingClientRect().height+"px","tabLeft"===a.target.id?(i.left=o.getBoundingClientRect().left+x+"px",i.border="2px dashed #686666",m.body.appendChild(e),c(a),!0):"tabRight"===a.target.id?(i.left=o.getBoundingClientRect().right+x+"px",i.border="2px dashed #686666",m.body.appendChild(e),c(a),!0):(d=r[k].getBoundingClientRect(),i.left=d.left+x+"px",i.width=d.width+"px",i.border="2px dashed #686666",m.body.appendChild(e),void p(a)))};var q=o.getElementsByTagName("tr"),r=q[0].getElementsByTagName("td");0===r.length&&(r=q[0].getElementsByTagName("th"));var s=document.createElement("div");s.id="_resizecolDivs";var t,u=r.length,v=0,w=0,x=0;m.documentElement.scrollTop?w=m.documentElement.scrollTop:m.body.scrollTop&&(w=m.body.scrollTop),m.documentElement.scrollLeft?x=m.documentElement.scrollLeft:m.body.scrollLeft&&(x=m.body.scrollLeft);for(var y=0;y<=u;y++){t=document.createElement("div");var z=t.style;t.className="ze_colResize",t.id=y-1,v=o.getBoundingClientRect().top,z.top=w+v+"px",m.documentElement.scrollLeft?x=m.documentElement.scrollLeft:m.body.scrollLeft&&(x=m.body.scrollLeft),z.width="3px",z.height=o.getBoundingClientRect().height+"px",y===u?(t.id="tabRight",z.left=o.getBoundingClientRect().right+x+"px"):0===y?(t.id="tabLeft",z.left=o.getBoundingClientRect().left+"px"):z.left=r[y].getBoundingClientRect().left+x+"px",s.appendChild(t)}for(var A=0;A<=q.length;A++){t=n.createElement("div");var B,C=t.style,D=o.getBoundingClientRect();v=0,t.className="ze_rowResize",t.id=A-1,C.position="absolute",0===A?(t.id="rowTop",C.left=D.left+"px",C.width=D.width+"px",v+=D.top+w,C.top=v-1+"px"):A===q.length?(t.id="rowBottom",v+=D.bottom+w,C.left=D.left+"px",C.width=D.width+"px",C.top=v-1+"px"):(B=q[A].getBoundingClientRect(),v+=B.top,C.left=B.left+"px",C.width=B.width+"px",C.top=w+v-1+"px"),C.height="3px",s.appendChild(t)}m.body.appendChild(s),ZE._addEvent(s,"mousedown",b),void 0===m.event&&(m.event="added",ZE._addEvent(m,"keydown",k))},ZE.show_CaptchaImage=function(a,b){"use strict";var c,d,e,f,g,h,i,j=document,k=j.getElementById("ze_captcha"),l=ZE.i18n;i=b||ZE.activeEditor;var m=function(){var a=k.getElementsByTagName("span");h=a[0],f=a[1],g=a[2]};k?k.style.display="":(d="<div class='zep_PUtt' onmousedown='ZE.drag(event,\"ze_captcha\");return false;'>",d+=l("Word Verification")+"<i class='zei-close'></i></div>",d+="<div class='zep_PUcen'>",d+="<div><table width='100%' cellspacing='0' cellpadding='5' border='0' align='center' class='ze_bordersizemain'>",d+="<tbody><tr><th align='right'>",d+=l("Image Text")+"</th><td>"+l("Enter the text you see in below image"),d+="</td></tr>",d+="<tr><td>&nbsp;</td><td>"+l("Letters are not case sensitive")+"</td></tr>",d+="<tr><td>&nbsp;</td><td>",d+="<input type='text' id ='ze_captcha_text' class='.ze_textbox' style='width: 202px;'>",d+="</td></tr>",d+="<tr><td>&nbsp;</td><td>",d+="<div  class='ze_captcha'>",d+="<img align='absmiddle' height ='72px' class='ze_hip' alt="+l("HIPImage")+" title="+l("Image Verification")+" name='ze_hipImg'></div><span id ='ze_refresh_hip' title ="+l("Refresh image")+" class='ze_change-captcha-icon'></span></td></tr>",d+="</tbody></table></div></div>",d+="<div class='zep_PUbtm'><span>"+l("Go")+"</span><span>"+l("Cancel")+"</span></div>",k=j.createElement("div"),k.className="zep_PU",k.innerHTML=d,k.id="ze_captcha",document.body.appendChild(k)),m(),e=j.getElementById("ze_captcha_text"),e.value="",e.focus(),ZE.setPosition(k,i.editordiv),c=k.getElementsByTagName("img"),c[0].src="/showcaptcha?digest="+a,f.onclick=h.onclick=function(b){var c=e.value,d=b?b.target:window.event.srcElement;return ZE.captchaParam=a+"="+c,"ze_refresh_hip"===d.id&&(ZE.captchaParam=" "),ZE.captchaProcessing&&ZE.captchaProcessing(),"ze_refresh_hip"!==d.id&&(k.parentNode.removeChild(k),!1)},k.getElementsByClassName("zei-close")[0].onclick=g.onclick=function(){k.parentNode.removeChild(k);var a=l("Unable to insert image. Retry after sometime");return ZE.insertImageMsg(a,"error"),i.inlineImagesToBe&&i.inlineImagesToBe.length>0&&i.inlineImagesToBe.splice(0,i.inlineImagesToBe.length),!1}},ZE.prototype.formatPainter=function(){"use strict";var a,b,c,d,e,f,g;a=this,a.doc.body.className+=" formatPainter";var h="makeUnorderedList",i="makeOrderedList";d=function(b){if("backcolor"===b||"forecolor"===b){var c=a.doc.queryCommandValue(b);return f(c)}return a.doc.queryCommandValue(b)},e=function(b){return a.doc.queryCommandState(b)},f=function(a){return"number"!=typeof a?a:"rgb("+(255&a)+", "+((65280&a)>>8)+", "+((16711680&a)>>16)+")"};var j=a.squireInstance.testPresenceinSelection(h,h,"UL",/>UL\b/);j?b=!0:(j=a.squireInstance.testPresenceinSelection(i,i,"OL",/>OL\b/))&&(c=!0),e("justifyLeft")?g="left":e("justifyRight")?g="Right":e("justifyFull")?g="justify":e("justifyCenter")&&(g="center"),a.initobj.formatPainter={fontName:d("fontname"),fontsize:d("fontsize"),backcolor:d("backcolor"),forecolor:d("forecolor"),bold:e("bold"),italic:e("italic"),underline:e("underline"),strike:e("strikethrough"),numbering:c,bullets:b,txtAli:g}},ZE.prototype.makeMarkDownTags=function(a){var b=0,c={bold:"*",italic:"-",strike:"~",underlink:"_",highlight:"`"},d={"*":["<b>","</b>"],"-":["<i>","</i>"],"~":["<strike>","</strike>"],_:["<u>","</u>"],"`":["<span class='highlight'style='background-color:#fff8a6'>","<span>"]},e={h5:"##### ",h4:"#### ",h3:"### ",h2:"## ",h1:"# ",quote:"! ",hr:"---"},f={"##### ":["<h5>","</h5>"],"#### ":["<h4>","</h4>"],"### ":["<h3>","</h3>"],"## ":["<h2>","</h2>"],"# ":["<h1>","</h1>"],"! ":["<blockquote>","<blockquote>"],"---":["<hr>","</hr>"],"- ":["<li>","</li>"]},g=function(a){return/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/g.test(a)},h=function(a){var b=/\[.*?\]\(.*?\)/gm,c=/\[.*?\]/gm,d=/\(.*?\)/gm,e=a.match(b);return null!==e&&e.length>0&&e.forEach(function(b){var e=b.match(c),f=b.match(d);e=e[0].replace("[",""),e=e.replace("]",""),f=f[0].replace(")",""),f=f.replace("(","");var h=/<a.*?>(.*)?<\/a>/;null!==f.match(h)&&(f=f.match(h)[1]);var i="<a href = "+f+">"+e+"</a>",j=a.indexOf(b);g(f)&&(a=a.replace(a.substring(j,j+b.length),i))}),a},i=function(a){var b=/!\[.*?\]\(.*?\)/gm,c=/\[.*?\]/gm,d=/\(.*?\)/gm,e=a.match(b);return null!==e&&e.length>0&&e.forEach(function(b){var e=b.match(c),f=b.match(d);e=e[0].replace("[",""),e=e.replace("]",""),f=f[0].replace(")",""),f=f.replace("(","");var g=/<a.*?>(.*)?<\/a>/;f=f.match(g)[1];var h="<img alt='"+e+"' src = "+f+">",i=a.indexOf(b);a=a.replace(a.substring(i,i+b.length),h)}),a},j=[],k=function(a){var b=/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/g,c=/target="_blank"/g,d=[],e=a.match(b);e&&e.forEach(function(b){l(b,a).forEach(function(a){d.push(a)})});var f=a.match(c);return f&&f.forEach(function(b){l(b,a).forEach(function(a){d.push(a)})}),d},l=function(a,b){var c=a.length;if(0===c)return[];for(var d,e=0,f=[];(d=b.indexOf(a,e))>-1;){var g={};g={start:d,end:d+a.length},f.push(g),e=d+c}return f},m=function(a,b,c){var d=a.length;if(0==d)return[];for(var e,f=0,g=[];(e=b.indexOf(a,f))>-1;)g.push(e),f=e+d;return g},n=function a(c,d,e,g){if(0==c.length)return[];g&&(b=map);var h,i=f[c];if(d.indexOf(c)>-1){h=d.indexOf(c);var k;k=i[0],d=d.replace(d.substring(h,h+c.length),k),b++,a(c,d,!1)}return j.push(d),j[0]},o=function(a,b){var c,d=k(a),e=[];return b.some(function(a){c&&(e.push(c),c=null),d.some(function(b){if(!(a<b.start||a>b.end)||e.includes(a))return c=null,!0;c=a})}),c&&e.push(c),0===d.length?b:e},p=function(a,b){var c=0,e=m(a,b,!1);e=o(b,e);var f=d[a],g=e.length;return e.forEach(function(d,h){if(e[h-1]){if(e[h-1]+a.length!==e[h]){if(i=c%2==0?f[0]:f[1],g%2!=0&&c%2==0&&g-1===h)return!1;b=b.substring(0,d)+i+b.substring(d+a.length),c++,e.forEach(function(b,c){e[c]=b+(i.length-a.length)})}}else if(0===h){var i=f[0];b=b.substring(0,d)+i+b.substring(d+a.length),c++,e.forEach(function(b,c){e[c]=b+(i.length-a.length)})}}),b},q=function(a){return Object.keys(c).forEach(function(b){var d=c[b],e=m(d,a,!1);if(2===e.length&&e[1]===e[0]+d.length)return!1;e.length>=2&&(a=p(d,a))}),Object.keys(e).forEach(function(c){j=[],b=0;var d=e[c];a=n(d,a,!1,0)}),a},r=q(a.trim());r=i(r),r=h(r);for(var s=r.split("\n"),t=0;t<s.length;t++)s[t]="<div>"+s[t]+"</div>";return r=s.join(""),DOMPurify.sanitize(r)},ZE.prototype.showCustomDictionary=function(){var a,b,c,d,e,f,g,h=this,i=function(){c=a.querySelectorAll("[data-attr='languageList']")[0];var b,d=q();d.forEach(function(a){b=document.createElement("option"),b.text=a[1],b.value=a[0],c.appendChild(b)})},j=function(a){h.bluePencilInstance.getPersonalDictionary().get(a,function(a){"success"===a.status&&(b=a.personalDictionary,k(b))})},k=function(b){d=a.querySelectorAll("[data-attr='dictionaryList']")[0],d.innerHTML="";var c;b.forEach(function(a){c=document.createElement("option"),c.text=a,c.value=a,d.appendChild(c)})},l=function(){return'<div class="zep_PUtt">'+ZE.i18n("Custom Dictionary")+'<i data-attr="close" class="zei-close"></i></div><div class="zep_PUcen"><div class="zeCustmDic"><div class="zeCustmDicTxt">'+ZE.i18n("Is your word flagged during Spell Check")+ZE.i18n("Add these words into Custom Dictionary, to be ignored during Spell Check.")+'</div><div class="zeCustmDicLang"><label>'+ZE.i18n("Language")+':</label><select data-attr="languageList"></select></div><div class="zeCustmDicCont"><div class="zeCustmDicWordList"><span>'+ZE.i18n("Custom Word List")+':</span><select data-attr="dictionaryList" multiple style="width:200px;height:115px;"></select></div><div class="zeCustmDicAction"><div class="zeCustmDicAddWord"><span>'+ZE.i18n("Custom Word")+':</span><input data-attr="newWord" class="zeCustmDicAddIP" type="text" maxlength="50" /><input data-attr="add" type="button" class="zeCustmDicBtn" value="Add" /></div><div class="zeCustmDicRemoveWord"><input data-attr="delete" type="button" class="zeCustmDicBtn" value="Remove" /></div></div></div></div><div>'},m=function(){c.value=h.defaultSpellcheckLanguage},n=function(){var b=a.querySelectorAll("[data-attr='close']")[0];e=a.querySelectorAll("[data-attr='delete']")[0],f=a.querySelectorAll("[data-attr='newWord']")[0],g=a.querySelectorAll("[data-attr='add']")[0],ZE._addEvent(b,"click",function(){ZE.hideOverlay(),a.parentElement.removeChild(a)}),ZE._addEvent(c,"change",function(a){var b=a.target.value;d.innerHTML="",j(b)}),ZE._addEvent(e,"click",function(){o()}),ZE._addEvent(g,"click",function(){p()})},o=function(){var a=d.querySelectorAll("option:checked"),b=c.value;a.forEach(function(a){h.bluePencilInstance.getPersonalDictionary().delete(b,a.value,function(b){"success"===b.status&&a.parentElement.removeChild(a)})})},p=function(){var a=c.value,b=f.value;h.bluePencilInstance.getPersonalDictionary().add(a,b,function(b){"success"===b.status&&(f.value="",j(a))})},q=function(){return[["af","Afrikaans"],["am","Amharic"],["ar",""],["hy-AM",""],["az-AZ","Azeri"],["bg",""],["bn","Bengali"],["cn","Catal"],["cs","esk"],["da","Danske"],["nl","Nederlands"],["en-AU","English(AU)"],["en-CA","English(CA)"],["en-NZ","English(NZ)"],["en-GB","English(UK)"],["en-US","English(US)"],["en-ZA","English(ZA)"],["eo_l3","Esperanto"],["et","Eesti"],["fo","Faroese"],["fa","Farsi"],["fj","Fijian"],["fr","Franais"],["fy","Frisian"],["gl-ES","Galego"],["de-AT","Deutsch(AT)"],["de-CH","Deutsch(CH)"],["de-DE","Deutsch(DE)"],["el",""],["he",""],["hi",""],["hu","Magyar"],["id","Indonesia"],["ia","Interlingua"],["ga","Gaeilge"],["is","slenska"],["it","Italiano"],["ko","Korean"],["la","Latin"],["lv-LV","Latvijas"],["lt-LT","Lietuvos"],["mi","Maori"],["ms","Melayu"],["mr","Marathi"],["mn","Mongolian(MN)"],["ne","Nepali"],["nb","Norsk bokml"],["nn-NO","Norsk Nynorsk"],["ns-ZA","Northern Sotho"],["oc-FR","Occitan"],["or","Oriya"],["pl","Polski"],["pt-PT","Portugus(PT)"],["pt-BR","Portugus(BR)"],["qu","Quechua"],["rw_RW","Rheato-Romanic"],["ro","Romn"],["ru-RU",""],["gd-GB","Scots gaelic"],["sr",""],["sk","Slovensk"],["sl","Slovenski"],["es-CL","Espaol(CL)"],["es-CO","Espaol(CO)"],["es-EC","Espaol(EC)"],["es-ES","Espaol(ES)"],["es-MX","Espaol(MX)"],["es-NI","Espaol(NI)"],["es-PE","Espaol(PE)"],["es-PR","Espaol(PR)"],["es-UY","Espaol(UY)"],["sv-SE","Svenska"],["sw-KE","Swahili"],["ta",""],["tn-ZA","Tswana"],["ts","Tsonga"],["uz_UZ","Uzbek"],["ve-ZA","Venda"],["vi","Vietnamese"],["xh","Xhosa"],["zu","Zulu"]]};!function(){a=document.createElement("div"),a.className="zep_PU",a.innerHTML=l(),document.body.appendChild(a),i(),ZE.showOverlay(),ZE.setPosition(a,h.editordiv),void 0!==h.defaultSpellcheckLanguage&&"locale"!==h.defaultSpellcheckLanguage||(h.defaultSpellcheckLanguage=ZE.getLanguage(navigator.language.toLowerCase())),j(h.defaultSpellcheckLanguage),n(),m()}()};