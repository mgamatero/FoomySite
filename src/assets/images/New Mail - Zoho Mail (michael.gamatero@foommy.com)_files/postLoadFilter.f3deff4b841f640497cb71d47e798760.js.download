"use strict";!function(){var m,f,p=zmail.Settings.Modules,e=p.create("Apps.Filter"),t=zmail.Settings.MailSuite.Common.React.UIComponents.LoadingAnimation,r=zmText.get("mail"),F=function(){return void 0!==m},i=function(){F()&&(ReactDOM.unmountComponentAtNode(m[0]),f=m=void 0)},g=function(){return F()||(m=$.e(zdom("div",null))),m},n=function(d,u){F()||(!function(e,t){zmUtil.hideMenu();var n=r.addFilter;e&&(n=t?"Associated Filters":r.run),f=Dialog.new({maskWrapperClass:"SC_Pop zmFilterPop",title:n,$content:g(),closeAction:i,ignoreMouseDown:!1,dialogDidMount:function(e){var t=e.$els;$.e(t.$positionWrapper).addClass("SC_PopTop")}})}("runThrough"===d,u.forwardEmail),ReactDOM.render(React.createElement(t,null),g()[0]),zmAppLoader.load("zm-settings-app-filters-new").then(function(){var s=ZMStore.getInstance("IncomingFilterCollection");s.fetchFilters().then(function(){if(F())if(ReactDOM.unmountComponentAtNode(m[0]),"runThrough"===d)if((u.folderId||u.forwardEmail)&&0<s.length)o=u.folderId,l=u.forwardEmail,a=s,c=p.import("Apps.Filter.Views.Utils.RunThroughPane"),ReactDOM.render(React.createElement(c,{folderId:o,forwardEmail:l,collection:a,dialog:f}),g()[0]);else{var e=p.import("Apps.Filter.Views.Utils.NoFilters");ReactDOM.render(React.createElement(e,null),g()[0])}else u&&(t=u,n=s,r=p.import("Apps.Filter.Views.Utils.FilterPane"),i=p.import("Apps.Filter.Models"),ReactDOM.render(React.createElement(r,{filter:new i.Filter({attrs:t,collection:n}),dialog:f}),g()[0]));var t,n,r,i,o,l,a,c})}))};$.subscribe("FILTER_SUGGESTION",function(e,t){n("filterSuggestion",t)}),$.subscribe("FILTER_RUNTHROUGH",function(e,t){n("runThrough",{folderId:t})}),$.subscribe("FILTER_FORWARDEMAIL",function(e,t){n("runThrough",{forwardEmail:t})});var o={true:"classifySenderInSmartFilter",false:"excludeSenderInSmartFilter",undefined:"excludeSenderInSmartFilter"};e.categoriseMail=function(e){var t=e.include,n=e.msgId,r=e.filType;return Backbone.ajax({url:"".concat(zmail.conPath,"/filter.do"),data:{accId:zmail.accId,mode:o[t],msgId:n,filType:r}})},e.loadFilterModels=function(){return zmAppLoader.load("zm-settings-app-filters-models")},e.fetchFilters=function(){var t=$.Deferred();return e.loadFilterModels().then(function(){ZMStore.getInstance("IncomingFilterCollection").fetchFilters().then(function(e){t.resolve(e)},t.reject)}),t.promise()},e.fetchFilterNamesAndId=function(){var t=$.Deferred();return e.fetchFilters().then(function(e){t.resolve(zmail.Settings.Apps.Filter.Models.getFilterNamesAndId())},t.reject),t.promise()}}(),window.__rollupModule=void 0;