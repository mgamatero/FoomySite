//$Id$
/**
 * IMPORTANT NOTE: This compressed javascript includes thirdparty javascripts
 * listed at video.zoho.com/html/thirdparty.html
 * The original javascript sources are available in the above location.
 */
function VideoChatUtil(){}!function(){var objPattExpr=/^\[(id|name|tag|class)=([\w\-\$]*)\]$/,Drizzle=function(selector,context){return new Drizzle.prototype.init(selector,context)};Drizzle.helper={findEach:function(element,attributeName,name,elements){var nodes,i;for(element.getAttribute(attributeName)===name&&elements.push(element),nodes=element.childNodes,i=0;i<nodes.length;i++)1===nodes[i].nodeType&&Drizzle.helper.findEach(nodes[i],attributeName,name,elements)},trim:function(value){return value.replace(/^\s+|\s+$/g,"")},getEventHandler:function(elem,type){var eventObj,i;for(i=0;i<Drizzle.events.length;i++)if(eventObj=Drizzle.events[i],eventObj.target===elem&&eventObj.type===type)return eventObj;return{}},eventDispatch:function(event){var eventObj,fn,i;if(event||(event=window.event),eventObj=Drizzle.helper.getEventHandler(this,event.type),eventObj.func)for(i=0;i<eventObj.func.length;i++)fn=eventObj.func[i],fn.apply(this,arguments)},attachEvent:function(elem,type,eventHandle){elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle)},removeEvent:function(elem,type,eventHandle){elem.removeEventListener?elem.removeEventListener(type,eventHandle,!1):elem.detachEvent&&elem.detachEvent("on"+type,eventHandle)},indexOf:function(arr,element){var i;for(i=0;i<arr.length;i++)if(arr[i]===element)return i;return-1},findHeightAndWidth:function(obj,name){var ret,displayProp,key,elem,old={};if(0==obj.length)return 0;if(elem=obj[0],elem===document){var body=elem.body,docElement=elem.documentElement;return ret="Width"===name?Math.max(body.scrollWidth,docElement.scrollWidth,body.offsetWidth,docElement.offsetWidth,body.clientWidth,docElement.clientWidth):Math.max(body.scrollHeight,docElement.scrollHeight,body.offsetHeight,docElement.offsetHeight,body.clientHeight,docElement.clientHeight)}if(elem===window)return ret="BackCompat"===document.compatMode?elem.document.body["client"+name]:elem.document.documentElement["client"+name];displayProp=obj.css("display"),"none"==displayProp&&(old.visibility=elem.style.visibility,old.display=elem.style.display,elem.style.visibility="hidden",elem.style.display="block"),ret="Width"===name?elem.offsetWidth:elem.offsetHeight;for(key in old)elem.style[key]=old[key];return ret}},Drizzle.prototype={length:0,cssNumber:{left:!0,right:!0,top:!0,bottom:!0,width:!0,height:!0},init:function(selector,context){var match,elem,i,elements;if(!selector)return this;if(selector==document||selector==window||selector==document.body)return this.length=1,this[0]=selector,this;if(selector.constructor===Array){for(this.length=selector.length,i=0;i<selector.length;i++)this[i]=selector[i];return this}if(selector.nodeType&&1===selector.nodeType)return this.length=1,this[0]=selector,this;if("string"!=typeof selector)return this;if(match=objPattExpr.exec(selector),!match)return this;if(context||(context=document),"id"===match[1])if(context.getElementById)elem=context.getElementById(match[2]),elem&&elem.parentNode&&(this.length=1,this[0]=elem);else for(elements=new Array,Drizzle.helper.findEach(context,match[1],match[2],elements),this.length=elements.length,i=0;i<elements.length;i++)this[i]=elements[i];else if("name"===match[1])if(context.getElementsByName)for(elem=context.getElementsByName(match[2]),this.length=elem.length,i=0;i<elem.length;i++)this[i]=elem[i];else for(elements=new Array,Drizzle.helper.findEach(context,match[1],match[2],elements),this.length=elements.length,i=0;i<elements.length;i++)this[i]=elements[i];else if("tag"===match[1])for(elem=context.getElementsByTagName(match[2]),this.length=elem.length,i=0;i<elem.length;i++)this[i]=elem[i];else if("class"===match[1])for(elem=context.getElementsByClassName(match[2]),this.length=elem.length,i=0;i<elem.length;i++)this[i]=elem[i]},find:function(selector){return new Drizzle.prototype.init(selector,this[0])},css:function(cssObject){var i,style,name,value,type,obj;if("string"==typeof cssObject){var styleProp;return this[0]?(window.getComputedStyle?styleProp=window.getComputedStyle(this[0],null):document.documentElement.currentStyle&&(styleProp=this[0].currentStyle),value=styleProp[cssObject],(null==value||""==value)&&(value=this[0].style[cssObject]),""===value?"auto":value):this[0]}for(i=0;i<this.length;i++){style=this[i].style;for(obj in cssObject){name=obj,value=cssObject[name],type=typeof value,"number"===type&&this.cssNumber[name]&&(value+="px");try{style[name]=value}catch(e){}}}return this},addClass:function(value){var i,elem,searchClass;if(value&&"string"==typeof value)for(i=0;i<this.length;i++)elem=this[i],1===elem.nodeType&&(elem.className?(searchClass=" "+elem.className+" ",searchClass.indexOf(" "+value+" ")<0&&(elem.className+=" "+value+" ")):elem.className=value);return this},removeClass:function(value){var i,elem,className;for(i=0;i<this.length;i++)if(elem=this[i],value&&"string"==typeof value){if(1===elem.nodeType&&elem.className){for(className=" "+elem.className+" ";className.indexOf(" "+value+" ")>=0;)className=className.replace(" "+value+" "," ");elem.className=className}}else elem.className="";return this},findClass:function(value){var i,elem,className;if(value&&"string"==typeof value)for(i=0;i<this.length;i++)if(elem=this[i],1===elem.nodeType){if(!elem.className)return!1;if(className=" "+elem.className+" ",className.indexOf(" "+value+" ")>=0)return!0}return!1},append:function(html){var fragement,dive,elem,i,j,nodes,arr=[];for(fragement=document.createDocumentFragment(),dive=document.createElement("div"),fragement.appendChild(dive),dive.innerHTML=html,nodes=dive.childNodes,dive.parentNode.removeChild(dive),j=0;j<nodes.length;j++)arr.push(nodes[j]);for(i=0;i<this.length;i++)for(elem=this[i],j=0;j<arr.length;j++)elem.appendChild(arr[j]);return this},show:function(){return this.css({display:"block"})},hide:function(){return this.css({display:"none"})},html:function(html){var elem,i;for(i=0;i<this.length;i++)elem=this[i],elem.innerHTML=html;return this},remove:function(){var elem,i;for(i=0;i<this.length;i++)elem=this[i],elem.parentNode&&elem.parentNode.removeChild(elem);return this.length=0,this},toArray:function(callback){var arr=[],j=0;for(i=0;i<this.length;i++)callback&&callback(this[i])!==!0||(arr[j++]=this[i]);return arr},bind:function(type,handle){var elem,eventObj,i;for(i=0;i<this.length;i++)if(elem=this[i],eventObj=Drizzle.helper.getEventHandler(elem,type),eventObj.target)eventObj.func.push(handle);else{var eventHandle=function(){return Drizzle.helper.eventDispatch.apply(elem,arguments)},func=new Array;func.push(handle),eventObj={target:elem,type:type,handlerFunc:eventHandle,func:func},Drizzle.events.push(eventObj),Drizzle.helper.attachEvent(elem,type,eventHandle)}return this},unbind:function(type,handle){var elem,eventObj,i,j;for(i=0;i<this.length;i++)elem=this[i],eventObj=Drizzle.helper.getEventHandler(elem,type),eventObj.target&&(handle&&(j=Drizzle.helper.indexOf(eventObj.func,handle),eventObj.func.splice(j,1)),handle&&0!=eventObj.func.length||(j=Drizzle.helper.indexOf(Drizzle.events,eventObj),Drizzle.events.splice(j,1),Drizzle.helper.removeEvent(elem,type,eventObj.handlerFunc)));return this},load:function(handle){return this.bind("load",handle)},resize:function(handle){return this.bind("resize",handle)},attr:function(name,value){var elem,i;for(i=0;i<this.length;i++)elem=this[i],elem.setAttribute(name,value+"");return this},removeAttr:function(name){var elem,i;for(i=0;i<this.length;i++)elem=this[i],elem.removeAttribute(name);return this},width:function(){return Drizzle.helper.findHeightAndWidth(this,"Width")},height:function(){return Drizzle.helper.findHeightAndWidth(this,"Height")},scrollTop:function(){var elem;return 0==this.length?0:(elem=this[0],elem!=window?0:"undefined"!=typeof window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0)},scrollLeft:function(){var elem;return 0==this.length?0:(elem=this[0],elem!=window?0:"undefined"!=typeof window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft?document.body.scrollLeft:0)},drag:function(handler){var parent;if(0==handler.length||0==this.length)return!1;for(parent=handler[0];parent&&parent!=this[0];)parent=parent.parentNode;if(!parent)return!1;var that=this;this.moveOptions={},this.moveOptions.handler=handler,this.moveOptions.mouseDownHandler=function(event){return that.mouseDown(event)},this.bind("mousedown",this.moveOptions.mouseDownHandler)},destroyDrag:function(){this.unbind("mousedown"),this.moveOptions={},Drizzle(document).unbind("mousemove"),Drizzle(document).unbind("mouseup")},mouseDown:function(event){var target,parent,that=this;for(target=event.srcElement?event.srcElement:event.target,parent=target;parent&&parent!=this.moveOptions.handler[0];)parent=parent.parentNode;return parent?(event.pageX?(this.moveOptions.leftoffset=event.pageX-parseInt(this.css("left")),this.moveOptions.topoffset=event.pageY-parseInt(this.css("top"))):(this.moveOptions.leftoffset=event.clientX-parseInt(this.css("left")),this.moveOptions.topoffset=event.clientY-parseInt(this.css("top"))),this.moveOptions.windowWidth=Drizzle(window).width(),this.moveOptions.windowHeight=Drizzle(window).height(),this.moveOptions.elemWidth=this.width(),this.moveOptions.elemHeight=this.height(),this.moveOptions.mouseMoveHandler=function(event){return that.mouseDrag(event)},Drizzle(document).bind("mousemove",this.moveOptions.mouseMoveHandler),this.moveOptions.mouseUpHandler=function(event){return that.mouseUp(event)},Drizzle(document).bind("mouseup",this.moveOptions.mouseUpHandler),event.preventDefault?event.preventDefault():event.returnValue=!1,!1):!1},mouseDrag:function(event){var x,y,scrollLeft=0,scrollTop=0;return"absolute"==this.css("position")&&(scrollLeft=Drizzle(window).scrollLeft(),scrollTop=Drizzle(window).scrollTop()),event.pageX?(x=event.pageX-this.moveOptions.leftoffset,y=event.pageY-this.moveOptions.topoffset):(x=event.clientX-this.moveOptions.leftoffset,y=event.clientY-this.moveOptions.topoffset),x+this.moveOptions.elemWidth>this.moveOptions.windowWidth+scrollLeft&&(x=this.moveOptions.windowWidth-this.moveOptions.elemWidth+scrollLeft),y+this.moveOptions.elemHeight>this.moveOptions.windowHeight+scrollTop&&(y=this.moveOptions.windowHeight-this.moveOptions.elemHeight+scrollTop),scrollLeft>x&&(x=scrollLeft),scrollTop>y&&(y=scrollTop),this.css({top:y,left:x}),event.preventDefault?event.preventDefault():event.returnValue=!1,!0},mouseUp:function(event){this.mouseDrag(event),Drizzle(document).unbind("mousemove",this.moveOptions.mouseMoveHandler),Drizzle(document).unbind("mouseup",this.moveOptions.mouseUpHandler)}},Drizzle.prototype.init.prototype=Drizzle.prototype,window.Drizzle=Drizzle,Drizzle.events=new Array}(),function(){Drizzle.findBrowser=function(userAgent){void 0==userAgent&&(userAgent=navigator.userAgent.toLowerCase());var offset,i,fullVersion,version,browser={},browserName=!1;if(browser.opera=!1,browser.msie=!1,browser.chrome=!1,browser.safari=!1,browser.mozilla=!1,browser.webkit=!1,browser.edge=!1,browser.ios=!1,browser.android=!1,-1!=(offset=userAgent.indexOf("opera")))browserName="opera",fullVersion=userAgent.substring(offset+6),-1!=(offset=userAgent.indexOf("version"))&&(fullVersion=userAgent.substring(offset+8));else if(-1!=(offset=userAgent.indexOf("msie")))browserName="msie",fullVersion=userAgent.substring(offset+5);else if(-1!=userAgent.indexOf("trident/"))browserName="msie",offset=userAgent.indexOf("rv:"),fullVersion=userAgent.substring(offset+3);else if(-1!=(offset=userAgent.indexOf("edge")))browserName="edge",fullVersion=userAgent.substring(offset+5);else if(-1!=(offset=userAgent.indexOf("chrome")))browserName="chrome",fullVersion=userAgent.substring(offset+7),browser.webkit=!0;else if(-1!=(offset=userAgent.indexOf("safari")))browserName="safari",fullVersion=userAgent.substring(offset+7),-1!=(offset=userAgent.indexOf("version"))&&(fullVersion=userAgent.substring(offset+8)),browser.webkit=!0;else if(-1!=(offset=userAgent.indexOf("firefox")))browserName="mozilla",fullVersion=userAgent.substring(offset+8);else{if(-1!=(offset=userAgent.indexOf("ios"))&&-1!=(offset=userAgent.indexOf("zohotalk")))return browser.ios=!0,browser.version=0,browser;if(-1!=(offset=userAgent.indexOf("com.zoho.chat/zohovideolibandroid")))return browser.android=!0,browser.version=0,browser}return-1!=(i=fullVersion.indexOf(";"))&&(fullVersion=fullVersion.substring(0,i)),-1!=(i=fullVersion.indexOf(" "))&&(fullVersion=fullVersion.substring(0,i)),version=parseInt(""+fullVersion,10),isNaN(version)&&(version=parseInt(navigator.appVersion,10)),browser[browserName]=!0,browser.version=version,browser},Drizzle.browser=Drizzle.findBrowser()}(),function(){Drizzle.findOS=function(){var osName,platform=navigator.platform.toLowerCase(),os={};return os.win=!1,os.mac=!1,os.linux=!1,/win/i.test(platform)?osName="win":/mac/i.test(platform)?osName="mac":/linux/i.test(platform)&&(osName="linux"),os[osName]=!0,os},Drizzle.os=Drizzle.findOS()}(),VideoChatUtil.showFullScreen=function(element){var fullScreenEnabled=document.mozFullScreenEnabled||document.webkitFullscreenEnabled,fullScreenElemet=document.fullscreenElemet||document.mozFullScreenElement||document.webkitFullscreenElement,func=element.requestFullScreen||element.mozRequestFullScreen||element.webkitRequestFullscreen;fullScreenEnabled&&(fullScreenElemet||func&&func.call(element))},VideoChatUtil.exitFullScreen=function(){var fullScreenEnabled=document.mozFullScreenEnabled||document.webkitFullscreenEnabled,fullScreenElemet=document.fullscreenElemet||document.mozFullScreenElement||document.webkitFullscreenElement,func=document.exitFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen;fullScreenEnabled&&fullScreenElemet&&func&&func.call(document)},VideoChatUtil.isWebRTCAvailable=function(){if(Drizzle.browser.mozilla&&Drizzle.browser.version<33)return!1;if(Drizzle.browser.chrome&&Drizzle.browser.version<38)return!1;var RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate,RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription;return navigator.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,navigator.getUserMedia instanceof Function&&RTCPeerConnection instanceof Function&&RTCSessionDescription instanceof Function&&RTCIceCandidate instanceof Function},VideoChatUtil.parseJSON=function(data){return window.JSON.parse(data)},VideoChatUtil.stringifyJSON=function(data){return window.JSON.stringify(data)},VideoChatUtil.decodeString=function(str){return DOMParser&&(str=(new DOMParser).parseFromString(str,"text/html").body.textContent),str};var CallReceiver=function(){function init(){userAgent=navigator.userAgent.toLowerCase();var paramsValue={},url=window.location.href,params=url.split("?")[1],paramsArray=new Array;params&&(paramsArray=params.split("&"));for(var i=0;i<paramsArray.length;i++){var temp=paramsArray[i].split("=");paramsValue[temp[0]]=temp[1]}paramsValue.location?parentLocation=paramsValue.location:-1!=userAgent.indexOf("zohomail-nativedesktop")&&(parentLocation=window.location.protocol+"//"+window.location.host),fId=keyPrefix+":"+(new Date).getTime(),localStorage.setItem(fId,"true"),Drizzle(window).bind("message",this.receiveMessage),Drizzle(window).bind("storage",this.storageEventHandler),window.onbeforeunload=function(){localStorage.removeItem(fId)}}function receiveMessage(event){if(event.origin===parentLocation){var data=VideoChatUtil.parseJSON(event.data),action=data.action;if("IS_PREFERED_WINDOW"===action){for(var result="YES",recentId=0,i=0;i<localStorage.length;i++){var temp=localStorage.key(i).split(":");2==temp.length&&temp[0]==keyPrefix&&temp[1]>recentId&&(recentId=temp[1])}0!=recentId&&(recentId=keyPrefix+":"+recentId,recentId!=fId&&(result="NO")),data.result=result;var message=VideoChatUtil.stringifyJSON(data);parent.postMessage(message,parentLocation)}else if("MUTE_STATUS_CHANGE"===action){var value=data.status+":"+(new Date).getTime();localStorage.setItem(muteKey,value);var event={};event.key=muteKey,event.newValue=value,CallReceiver.storageEventHandler(event)}else if("POST_REQUEST"===action){var url=!1;switch(data.sub_action){case"CHAT_REQUEST":url="/requestchat.do";break;case"CHAT_RECEIVED":url="/chatreceived.do";break;case"CHAT_ANSWERED":url="/chatanswered.do";break;case"START_CHAT":url="/startchat.do";break;case"MESSAGE_SIGNALING":url="/messagesignaling.do";break;case"CONNECT_NOTIFY":url="/connectnotify.do";break;case"STOP_CHAT":url="/stopchat.do";break;case"DISCONNECT_NOTIFY":url="/disconnectnotify.do";break;case"DISCONNECT_ACKNOWLEDGEMENT":url="/sendacknowledgement.do";break;case"CREATE_CONFERENCE":url="/createconference.do";break;case"INVITE_PARTICIPANT":url="/inviteconfparticipants.do";break;case"UPDATE_CONF_START_TIME":url="/updateconfstarttime.do";break;case"SEND_FEEDBACK":url="/sendfeedback.do";break;case"CONNECTION_DETAILS":url="/sendconnectiondetails.do";break;case"JOIN_REQUEST":url="/joinrequest.do"}0!=url&&postRequest(url,data.params,data.callbackId)}else if("CSRF_DATA"===action){var csrf=getCSRF();sendCSRF(data.callbackId,csrf)}}}function storageEventHandler(event){if(event.key==muteKey){var jsonData={};jsonData.action="MUTE_STATUS_CHANGE";var status=event.newValue.split(":");jsonData.status=1==status[0]||"true"==status[0]?!0:!1;var message=VideoChatUtil.stringifyJSON(jsonData);parent.postMessage(message,parentLocation)}}function sendCurrentUserInfo(currentUserZuid,currentUserName,wmsJSURL,csrfParam,csrfValue){var jsonData={};jsonData.action="CURRENT_USER_INFO",jsonData.currentUserZuid=currentUserZuid,jsonData.currentUserName=currentUserName,jsonData.wmsJSURL=wmsJSURL,jsonData.csrfParam=csrfParam,jsonData.csrfValue=csrfValue;var message=VideoChatUtil.stringifyJSON(jsonData);parent.postMessage(message,parentLocation)}function sendCSRF(callbackId,csrf){var jsonData={};jsonData.action="CSRF_DATA",jsonData.callbackId=callbackId,jsonData.csrf=csrf;var message=VideoChatUtil.stringifyJSON(jsonData);parent.postMessage(message,parentLocation)}function setCSRF(csrfParam,csrfCookie){csrfParamName=csrfParam,csrfCookieName=csrfCookie}function sendResponseText(callbackId,text){var jsonData={};jsonData.callbackId=callbackId,jsonData.action="AJAX_RESPONSE",jsonData.message=VideoChatUtil.parseJSON(text);var message=VideoChatUtil.stringifyJSON(jsonData);parent.postMessage(message,parentLocation)}function getXMLHttp(){var xmlHttp=!1;try{xmlHttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{xmlHttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){xmlHttp=!1}}return xmlHttp||"undefined"==typeof XMLHttpRequest||(xmlHttp=new XMLHttpRequest),xmlHttp}function postRequest(url,param,callbackId){var xmlHttp=getXMLHttp();if(xmlHttp!==!1){if(-1!=userAgent.indexOf("zohomail-nativedesktop"))url=url.substring(0,url.indexOf(".")),url=videoServer+"/api"+url;else{var csrf=getCSRF();-1==param.indexOf(csrf)&&(param+="&"+csrf)}xmlHttp.open("POST",url,!0),xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),xmlHttp.send(param),xmlHttp.onreadystatechange=function(){4===xmlHttp.readyState&&callbackId&&sendResponseText(callbackId,xmlHttp.responseText)}}}function getCSRF(){var csrfCookieValue=!1;return csrfCookieName&&(csrfCookieValue=getCookie(csrfCookieName)),csrfParamName+"="+csrfCookieValue}function getCookie(cName){for(var c=document.cookie.split("; "),i=0;i<c.length;i++){var cookie=c[i].split("=");if(cookie[0]==cName)return cookie[1]}return!1}function setVideoServerLocation(value){videoServer=value}var parentLocation="*",fId=0,keyPrefix="zv_callreceiverframe",muteKey="zv_mutestatus",csrfParamName=!1,csrfCookieName=!1,videoServer=!1,userAgent=!1;return{init:init,receiveMessage:receiveMessage,storageEventHandler:storageEventHandler,sendCurrentUserInfo:sendCurrentUserInfo,setCSRF:setCSRF,setVideoServerLocation:setVideoServerLocation}}();