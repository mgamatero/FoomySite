_defineSettingsModule("Categories",function(a,e){"use strict";var t=e("Platform.Components").CategoryManager.create("calendar",{props:{title:"Calendar"}});a.Calendar=t},"MailSuite"),_defineSettingsModule("Pages",function(a,e){"use strict";var t="calendar-generals",i=e("Platform.Components"),l=e("Platform.Entities"),s=i.SettingPageManager,n=l.SettingPage.Types,c=s.create(t,{props:{title:"Calendar Preferences"},attributes:{card:t,category:"calendar",type:n.Title,pageCSSClass:"calendar-generals-page",appContainer:!0}});a.CalendarGenerals=c},"MailSuite"),_defineSettingsModule("Cards",function(a,e){"use strict";var t=e("Platform.Components").SettingCardManager,i=t.create("calendar-generals",{props:{openable:!0,addToSearch:!1,title:"Calendar Preferences"},state:{hidden:!1},attributes:{category:"calendar"},openAction:t.CardActions.OpenPageAction("calendar-generals")});a.CalendarGenerals=i},"MailSuite"),_defineSettingsModule("CalendarGeneralView",function(a,t){"use strict";function s(){for(;v[0].firstChild;)v[0].removeChild(v[0].firstChild);var a=zcal.cdata.opt;0==zcal.timezones.length&&ZCL_uXHR("/cal/timez.do",function(a){zcal.timezones=ZCL_Evl(1,a.responseText)});var t="",i=$("<ul></ul>");for(var l in t+="<li><h3 style='position:relative'><span>"+zcal.i18n.timezone+"<span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3><div class='startup'><p><span class='SC_select zcl_Stz' data-tooltip='"+a.CTIM+"'>"+z()+"</span></p></div></li>",t+="<li><h3 style='position:relative'><span>"+zcal.i18n.dateformat+"</span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3><div class='section-content startup' ><div class='fontSettings mb' rel='"+a.DF+"' >",zcal.DATEFORMAT)t+='<em value="'+a.DF+'" id="zcl_DF" rel="'+l+'" class="'+(a.DF==l?"sel":"")+'">'+zcal.DATEFORMAT[l]+"</em>";for(var l in t+="</div></div></li>",t+="<li><h3 style='position:relative'><span>"+zcal.i18n.timeformat+"</span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3><div class='section-content startup'><div class='fontSettings mb' rel='"+a.TF+"'>",zcal.TIMEFORMAT)t+='<em id="zcl_TF"  rel="'+l+'" class="'+(a.TF==l?"sel":"")+'">'+zcal.TIMEFORMAT[l]+"</em>";for(var l in t+="</div></div></li>",t+="<li><h3 style='position:relative'><span>"+zcal.i18n.defaultview+"</span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3><div class='section-content startup'><div class='fontSettings mb' rel='"+a.DEF+"'>",zcal.DEFAULTVIEW)t+='<em id="zcl_DEF" rel="'+l+'" class="'+(a.DEF==l?"sel":"")+'">'+zcal.DEFAULTVIEW[l]+"</em>";for(var l in t+="</div></div></li>",t+="<li><h3 style='position:relative'><span>"+zcal.i18n.firdayofthwk+"</span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3><div class='section-content startup'><div class='fontSettings mb' rel='"+a.WK+"'>",Date.WEEK_DAYS[0])t+='<em id="zcl_WK"  rel="'+l+'" class="'+(a.WK==l?"sel":"")+'">'+Date.WEEK_DAYS[0][l]+"</em>";for(var l in t+="</div></div></li>",t+="<li><h3 style='position:relative'><span>"+zcal.i18n.workweek+"</span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3>",t+="<div class='section-content startup'><div class='fontSettings' rel='"+a.WS+"'><span>"+zcal.i18n.from+"</span>",Date.WEEK_DAYS[0])t+='<em id="zcl_WS" rel="'+l+'" class="'+(a.WS==l?"sel":"")+'">'+Date.WEEK_DAYS[0][l]+"</em>";for(var l in t+="</div></div>",t+="<div class='section-content startup'><div class='fontSettings' rel='"+a.WE+"'><span>"+zcal.i18n.to+"</span>",Date.WEEK_DAYS[0])t+='<em id="zcl_WE" rel="'+l+'" class="'+(a.WE==l?"sel":"")+'">'+Date.WEEK_DAYS[0][l]+"</em>";t+="</div></div>",t+="</li>";var s=1==zcal.cdata.opt.TF?u:zcal.HOURS;t+="<li><h3 style='position:relative'><span>"+zcal.i18n.workinghours+"</span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3><div class='startup'><p><span>"+zcal.i18n.from+"</span><span class='SC_select zcl_Sdf'><input value='"+s[a.HS]+"' type='text' id='zcl_HS' rel="+a.HS+" readonly=''></span><span>"+zcal.i18n.to+"</span><span class='SC_select zcl_Sdf'><input value='"+s[a.HE]+"' type='text' id='zcl_HE' rel="+a.HE+" readonly=''></span></p></div></li>";var n=a.SIE,c=a.DDE,r=a.REM,d=a.NWTB,o=a.SGI;t+="<li><h3>"+zcal.i18n.outsideworkingtime_busy+"<div class='onoffButton' id='zcl_nonWHr' data-marker='nonworkingHour'><div class='"+(1==d?"sdiv":"sdiv sadiv")+"' rel='"+(1==d?"on":"off")+"' data-on='"+zcal.i18n.on+"' data-off='"+zcal.i18n.off+"'></div></div></h3><div class='startup help zcl_mt'><em><img src="+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+" class='info-message'></em><span>"+zcal.i18n.showworkinghours+"</span></div></li>",t+="<li><h3 style='position:relative'><span>"+zcal.i18n.automatic_addinv+"<span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3><div class='section-content startup'><div class='fontSettings mb' rel='"+n+"'>",t+='<em id="zcl_autoInv"  rel="0" class="'+("0"==n?"sel":"")+'">'+zcal.i18n.allow+"</em>",t+='<em id="zcl_autoInv"  rel="2" class="'+("2"==n?"sel":"")+'">'+zcal.i18n.allowiffree+"</em>",t+='<em id="zcl_autoInv"  rel="1" class="'+("1"==n?"sel":"")+'">'+zcal.i18n.dontallow+"</em>",t+="</div></div></li>",t+="<li><h3 style='position:relative'><span>"+zcal.i18n.groupinvite_add+"<span><span id='load' style='display:none;position: absolute'><span class='loader'></span></span></h3><div class='section-content startup'><div class='fontSettings mb' rel='"+o+"'>",t+='<em id="zcl_autoGrpInv"  rel="1" class="'+("1"==o?"sel":"")+'">'+zcal.i18n.allow+"</em>",t+='<em id="zcl_autoGrpInv"  rel="0" class="'+("0"==o?"sel":"")+'">'+zcal.i18n.dontallow+"</em>",t+="</div></div></li>",t+="<li><h3>"+zcal.i18n.denied_events+"<div class='onoffButton' id='zcl_showDE' data-marker='deniedEvents'><div class='"+(1==c?"sdiv":"sdiv sadiv")+"' rel='"+(1==c?"on":"off")+"' data-on='"+zcal.i18n.on+"' data-off='"+zcal.i18n.off+"'></div></div></h3><div class='startup help zcl_mt'><em><img src="+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+" class='info-message'></em><span>"+zcal.i18n.disdenied_eventsmsg+"</span></div></li>",t+="<li><h3>"+zcal.i18n.reminder_notification+"<div class='onoffButton' id='zcl_remNotify' data-marker='reminderNotify'><div class='"+(1==r?"sdiv":"sdiv sadiv")+"' rel='"+(1==r?"on":"off")+"' data-on='"+zcal.i18n.on+"' data-off='"+zcal.i18n.off+"'></div></div></h3><div class='startup help zcl_mt'><em><img src="+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+" class='info-message'></em><span>"+zcal.i18n.rem_notifymsg+"</span></div></li>",i.append($(t)),v.append(i),v.off("click").on("click",function(e){var a=e.target||e.srcElement;if("zcl_TF"==a.id)(t=$(a)).parent().find("em").removeClass("sel").addClass(""),t.removeClass("").addClass("sel"),t.parent()[0].setAttribute("rel",t[0].getAttribute("rel")),h(e);else if("zcl_DF"==a.id){(t=$(a)).parent().find("em").removeClass("sel").addClass(""),t.removeClass("").addClass("sel"),t.parent()[0].setAttribute("rel",t[0].getAttribute("rel")),h(e)}else if("zcl_DEF"==a.id){(t=$(a)).parent().find("em").removeClass("sel").addClass(""),t.removeClass("").addClass("sel"),t.parent()[0].setAttribute("rel",t[0].getAttribute("rel")),h(e)}else if("zcl_WK"==a.id){(t=$(a)).parent().find("em").removeClass("sel").addClass(""),t.removeClass("").addClass("sel"),t.parent()[0].setAttribute("rel",t[0].getAttribute("rel")),h(e)}else if("zcl_WS"==a.id){(t=$(a)).parent().find("em").removeClass("sel").addClass(""),t.removeClass("").addClass("sel"),t.parent()[0].setAttribute("rel",t[0].getAttribute("rel")),h(e)}else if("zcl_WE"==a.id){(t=$(a)).parent().find("em").removeClass("sel").addClass(""),t.removeClass("").addClass("sel"),t.parent()[0].setAttribute("rel",t[0].getAttribute("rel")),h(e)}else if("zcl_autoInv"==a.id){(t=$(a)).parent().find("em").removeClass("sel").addClass(""),t.removeClass("").addClass("sel"),t.parent()[0].setAttribute("rel",t[0].getAttribute("rel")),h(e)}else if("zcl_autoGrpInv"==a.id){var t;(t=$(a)).parent().find("em").removeClass("sel").addClass(""),t.removeClass("").addClass("sel"),t.parent()[0].setAttribute("rel",t[0].getAttribute("rel")),h(e)}var i=1==zcal.cdata.opt.TF?u:zcal.HOURS;if("INPUT"==e.target.tagName&&"zcl_HS"==e.target.id){var l=[];for(var s in i){(r={}).value=s,r.text=i[s],l.push(r)}var n=e.target;g({menuItems:l,par:e.target,parWidth:!0}).then(function(a){n.value=a.text,n.setAttribute("rel",a.value),h(e),zmUtil.hideMenu(e)})}if("INPUT"==e.target.tagName&&"zcl_HE"==e.target.id){var c=[];for(var s in i){var r;(r={}).value=s,r.text=i[s],c.push(r)}n=e.target;g({menuItems:c,par:e.target,parWidth:!0}).then(function(a){n.value=a.text,n.setAttribute("rel",a.value),h(e),zmUtil.hideMenu()})}}),v.find("#zcl_TZ").on("click",function(t){var a=zcal.timezones,e=[];for(var i in a)for(var l in a[i]){var s={};s.id=l,s.name=a[i][l]+" ("+l+")",s.display_text=a[i][l]+" ("+l+")",e.push(s)}var n,c={},r=$(this);c.parentDOM=r.parent(),c.displayAs="dropdown",c.parWidth=!1,c.onSelect=function(a,e){p(r,a,e),h(t),n.hide()},c.dataCallback=function(){return e},(n=zmUtil.createFLComp("generic",c)).show()});var p=function(a,e,t){a.val(t.display_text),a.attr("rel",e),a[0].parentNode.setAttribute("data-tooltip",t.display_text)};v.find("[data-marker=showallTimezone]").removeAttr("data-marker").on("click",function(){f(),$(this).remove()}),v.find("[data-marker=showallTimezone1]").removeAttr("data-marker").on("click",function(){0<zcal.timezones.length?z():ZCL_uXHR("/cal/timez.do",function(a){zcal.timezones=ZCL_Evl(1,a.responseText)}),$(this).remove()});var m=v.find("[data-marker=nonworkingHour]");return m&&m.on("click",function(){var a=$(this);"sdiv"==a.find("div")[0].className?(a.find("div").removeClass("sdiv").addClass("sdiv sadiv"),a.find("div")[0].setAttribute("rel","off")):(a.find("div").removeClass("sdiv sadiv").addClass("sdiv"),a.find("div")[0].setAttribute("rel","on")),h()}),v.find("[data-marker=automaticInvitation]").on("click",function(){var a=$(this);a.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),a.find("i").removeClass("msi-unoption").addClass("msi-option"),h(e)}),v.find("[data-marker=deniedEvents]").on("click",function(){var a=$(this);"sdiv"==a.find("div")[0].className?(a.find("div").removeClass("sdiv").addClass("sdiv sadiv"),a.find("div")[0].setAttribute("rel","off")):(a.find("div").removeClass("sdiv sadiv").addClass("sdiv"),a.find("div")[0].setAttribute("rel","on")),h()}),v.find("[data-marker=reminderNotify]").on("click",function(){var a=$(this);"sdiv"==a.find("div")[0].className?(a.find("div").removeClass("sdiv").addClass("sdiv sadiv"),a.find("div")[0].setAttribute("rel","off")):(a.find("div").removeClass("sdiv sadiv").addClass("sdiv"),a.find("div")[0].setAttribute("rel","on")),h()}),v.find("[data-marker=saveGeneral]").on("click",function(){h()}),v}var p={},u=["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],v=$("<li class='SC_setbox zcl_setbox'></li>"),f=function(){0<zcal.timezones.length?l():i({mode:"mypref",callback:function(){l()}})},i=function(e){ZCL_XHR("/cal/timez.do",function(a){zcal.timezones=ZCL_Evl(1,a.responseText),e.callback&&e.callback()})},l=function(){var a="<select>";for(var e in zcal.timezones)for(var t in zcal.timezones[e]){a+="<option "+(zcal.cdata.opt.TIM==t?"selected":"")+" value="+t+' id="zc_tzOp">'+unescape(zcal.timezones[e][t])+" ("+t+")</option>"}return a+="</select>"},z=function(){return'<input value="'+ZCL_getHTML(zcal.cdata.opt.CTIM)+'" type="text"  rel='+zcal.cdata.opt.TIM+' readonly="" id="zcl_TZ">'},h=function(a){n()&&c(a)},n=function(){var a,e,t,i,l=zcal.cdata.opt;if($("#zcl_TZ")){var s=$("#zcl_TZ")[0].getAttribute("rel");if(s&&s!=l.TIM)return!0}for(var n=["DF","TF","DEF","WK","WS","WE"],c=0;c<n.length;c++)if(l[n[c]]!=parseInt($("#zcl_"+n[c]).parent()[0].getAttribute("rel"),10))return!0;var r=["HS","HE"];for(c=0;c<r.length;c++)if(l[r[c]]!=parseInt($("#zcl_"+r[c])[0].getAttribute("rel"),10))return!0;i=1==$("#zcl_nonWHr").find("[rel=on]").length?1:0;var d,o=$("#zcl_autoInv"),p=($("#zcl_showDE"),$("#zcl_remNotify"),$("#zcl_autoGrpInv"));return a=d=o.parent()[0].getAttribute("rel"),e=1==$("#zcl_showDE").find("[rel=on]").length?1:0,t=1==$("#zcl_remNotify").find("[rel=on]").length?1:0,d=p.parent()[0].getAttribute("rel"),l.DDE!=e||l.SIE!=a||l.REM!=t||l.NWTB!=i||l.SGI!=d},c=function(e){var a=zcal.cdata.opt;!function(){var a,e,t,i=zcal.cdata.opt;if(p={},a=[["DF",3],["TF",1],["DEF",4],["WK",6],["WS",6],["WE",6]],e=parseInt($("#zcl_HS")[0].getAttribute("rel"),10),(t=parseInt($("#zcl_HE")[0].getAttribute("rel"),10))<=e)return _zm.succErrMsg("e",zcal.i18n.wkhretgrwkhrst),!1;p.HS=e,p.HE=t;var l=$("#zcl_TZ")?$("#zcl_TZ")[0].getAttribute("rel"):null;l&&l!=zcal.cdata.opt.TIM?(p.TIM=l,p.CTIM=$("#zcl_TZ")[0].value):p.TIM=zcal.cdata.opt.TIM;for(var s=0;s<a.length;s++){var n=a[s][0],c=parseInt($("#zcl_"+n).parent()[0].getAttribute("rel"),10);p[n]=0<=c&&c<=a[s][1]?c:i[n]}var r,d=$("#zcl_autoInv"),o=($("#zcl_showDE"),$("#zcl_remNotify"),$("#zcl_autoGrpInv"));return r=d.parent()[0].getAttribute("rel"),p.SIE=r,r=o.parent()[0].getAttribute("rel"),p.SGI=r,p.DDE=1==$("#zcl_showDE").find("[rel=on]").length?1:0,p.REM=1==$("#zcl_remNotify").find("[rel=on]").length?1:0,p.NWTB=1==$("#zcl_nonWHr").find("[rel=on]").length?1:0,!0}()||(e&&("zcl_TZ"==e.target.id||"zcl_HS"==e.target.id||"zcl_HE"==e.target.id?e.target.parentNode.parentNode.parentNode.parentNode.querySelector("#load").style.display="":e.target.parentNode.parentNode.parentNode.querySelector("#load").style.display=""),ZCL_XHR("/cal/set.do?type=gen&obj="+encodeURIComponent('{"DF":'+p.DF+',"TF":'+p.TF+',"DEF":'+p.DEF+',"WK":'+p.WK+',"WS":'+p.WS+',"WE":'+p.WE+',"HS":'+p.HS+',"HE":'+p.HE+',"MTO":'+a.MTO+', "TH":'+a.TH+',"FS":'+a.FS+',"TIM":"'+p.TIM+'", "DDE":'+p.DDE+', "SIE":'+p.SIE+', "SGI":'+p.SGI+', "REM":'+p.REM+',"NWTB":'+p.NWTB+"}"),function(a){r(a,e)}))},r=function(a,t){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){var i=zcal.cdata.opt;for(var l in e.TZLBL&&(i.TZLBL=e.TZLBL,i.DATE=e.DATE.toString(),i.TZ_OFFSET=e.TZ_OFFSET,zcal.cdate=ZCL_parseDateTimeStr(e.DATE_STR).getTime(),zcal.timezoneupdated=!0),p)i[l]=p[l];setTimeout(function(){for(var a=document.querySelectorAll("#load"),e=0;e<a.length;e++)a[e].style.display="none";t&&"zcl_TF"==t.target.id&&s()},1e3)}},g=function(a){var i=[];(a.menuItems||[]).forEach(function(a){var e=a.value,t=a.text;i.push({htm:"<div>"+t+"</div>",data:{value:e,text:t}})});var l=$.Deferred();return a.list=i,a.clk=function(a,e,t){l.resolve(a,e.parentNode,t)},a.onHide=function(){l.reject()},i.length?zmsuite.showMenu(a):l.reject(),l.fail(zmUtil.hideMenu),l.promise()};a.getGeneralView=s,a.initialize=function(a){(a=a||{}).process.resolve()},a.uninitialize=function(a){(a=a||{}).process.resolve()}},"MailSuite.Apps.CalendarGenerals"),_defineSettingsModule("CalendarGenerals",function(a,e){"use strict";function t(){return e("MailSuite.Apps.CalendarGenerals.CalendarGeneralView")}function i(){$.Deferred();var a,e=d.makeDeferred();return"undefined"==typeof zcal?(a=$.Deferred(),zmApp.loadCalendar("/calendar/settings",a),a.promise()).done(function(){t().initialize({process:e})}).fail(e.reject):t().initialize({process:e}),e.promise()}function l(){var a=d.makeDeferred();return t().uninitialize({process:a}),a.promise()}function s(){return t().getGeneralView()}function n(){return null}var c,r=e("Platform.Components").SettingAppManager,d=e("Platform.System.Utils");c=r.create("calendar-generals",{attributes:{page:"calendar-generals",isReactApp:!1},initialize:i,uninitialize:l,getView:s,handleContainerEvent:n}),a.App=c},"MailSuite.Apps"),function(a){"use strict";var e="calendar-generals",t="calendar-generals",i="time-zone",l="date-format",s="time-format",n="default-view",c="automatic-invi",r="reminder-notifi",d={cardItem:{title:"Time Zone"}},o={cardItem:{title:"Date Format"}},p={cardItem:{title:"Time Format"}},m={cardItem:{title:"Defaut View"}},u={cardItem:{title:"Automatic invitation"}},v={cardItem:{title:"Reminder notification"}},f=a("Platform.Components"),z=a("Platform.Entities"),h=(a("Platform.System.Utils"),f.SettingCardItemManager),g=z.SettingCardItem.Types;h.create(i,{props:{title:d.cardItem.title,value:""},attributes:{type:g.LabelValue,card:e},primaryAction:h.CardItemActions.OpenPageAction(t,{showSection:i})}),h.create(l,{props:{title:o.cardItem.title,value:""},attributes:{type:g.LabelValue,card:e},primaryAction:h.CardItemActions.OpenPageAction(t,{showSection:l})}),h.create(s,{props:{title:p.cardItem.title,value:""},attributes:{type:g.LabelValue,card:e},primaryAction:h.CardItemActions.OpenPageAction(t,{showSection:s})}),h.create(n,{props:{title:m.cardItem.title,value:""},attributes:{type:g.LabelValue,card:e},primaryAction:h.CardItemActions.OpenPageAction(t,{showSection:n})}),h.create(c,{props:{title:u.cardItem.title,value:""},attributes:{type:g.LabelValue,card:e},primaryAction:h.CardItemActions.OpenPageAction(t,{showSection:c})}),h.create(r,{props:{title:v.cardItem.title,value:""},attributes:{type:g.LabelValue,card:e},primaryAction:h.CardItemActions.OpenPageAction(t,{showSection:r})})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,e){"use strict";var t="email-notify",i=e("Platform.Components"),l=e("Platform.Entities"),s=i.SettingPageManager,n=l.SettingPage.Types,c=s.create(t,{props:{title:"Email Notification"},attributes:{card:t,category:"calendar",type:n.Title,pageCSSClass:"email-notify-page",appContainer:!0}});a.CalendarEmailNotify=c},"MailSuite"),_defineSettingsModule("Cards",function(a,e){"use strict";var t=e("Platform.Components").SettingCardManager,i=t.create("email-notify",{props:{openable:!0,addToSearch:!1,title:"Email Notification"},state:{hidden:!1},attributes:{category:"calendar"},openAction:t.CardActions.OpenPageAction("email-notify")});a.CalendarEmailNotify=i},"MailSuite"),_defineSettingsModule("EmailNotifyView",function(a,e){"use strict";e("MailSuite.Apps.CalendarGenerals.CalendarGeneralView"),$(document.createDocumentFragment());function l(){var a=$("<ul></ul>"),n=zcal.cdata.opt,e="",t=n.MT,i=n.MTO;if(n.CMAIL&&""!=n.CMAIL)e+='<li><div class="startup help zcl_mb">',e+="<p>"+C(zcal.i18n.revertmsg1,['<a class="SC_lnk">'+n.CMAIL+"</a>",'<a class=" link SC_lnk" data-marker="resendEmail">',"</a>"])+" </p><p>"+C(zcal.i18n.revertmsg2,['<a class=" link SC_lnk">'+i+"</a>"])+"</p></div></div></li>",e+='<li><div><div class="SC_PUbtm"><span data-marker="reverttoPrevious">'+zcal.i18n.rebutton+"</span></div></li>";else{if(e+='<li class="SC_cal_prefer">',"1"==zcal.emlNfy){n.REMID.split(",");e+="<h3>"+zcal.i18n.emailaddress+'</h3><div class="startup"><p><span  class="SC_select"><input type="text" value='+i+" rel="+i+' readonly="" id="zcl_MTO"></span></p></div><div class="startup help zcl_mb"> <em><img src='+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+' class="info-message"></em><span>'+zcal.i18n.emailaddress_msg2+"</span></div>"}else e+="<h3>"+zcal.i18n.notify_emailaddress+'</h3><div id="zcl_emailD"><div class="startup zcl_mb"><p><span>'+i,"0"!=zcal.emlNfy&&"1"!=zcal.emlNfy&&(e+='<a class="link SC_lnk" data-marker="changeEmailNotify">'+zcal.i18n.change+"</a>"),e+='</span></p></div></div><div class="startup help zcl_mb"> <em><img src='+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+' class="info-message"></em><span>'+zcal.i18n.emailaddress_msg1+"</span></div>";if(e+="<h3>"+zcal.i18n.email_format+"</h3>",e+='<div class="section-content startup" ><div class="fontSettings" rel='+n.MT+'> <em id="enotifyType" rel=0 class="'+(0==t?"sel":"")+'">'+zcal.i18n.sendhtml+'</em><em id="enotifyType" rel=1 class="'+(1==t?"sel":"")+'">'+zcal.i18n.sendplaintext+"</em></div></div>",e+="</li>",0==t){for(var l in e+="<li><h3>"+zcal.i18n.agenda_notify+"</h3><div class='section-content startup'><div class='fontSettings mb' rel='"+n.AI+"'>",zcal.AGENDA_INTERVAL)e+='<em id="zcl_AI" rel="'+l+'" class="'+(n.AI==l?"sel":"")+'">'+zcal.AGENDA_INTERVAL[l]+"</em>";e+="</div></div></li>"}}a.append($(e)),a.find("#enotifyType").on("click",function(){var a=$(this);a.parent().find("em").removeClass("sel").addClass(""),a.removeClass("").addClass("sel"),a.parent()[0].setAttribute("rel",a[0].getAttribute("rel")),z(a.index()),v()}),a.find("#zcl_AI").on("click",function(){var a=$(this);a.parent().find("em").removeClass("sel").addClass(""),a.removeClass("").addClass("sel"),a.parent()[0].setAttribute("rel",a[0].getAttribute("rel")),v()});var s=a.find("[data-marker=agendaNotify]").removeAttr("data-marker");s.length&&s.on("click",function(a){var e=[];for(var t in zcal.AGENDA_INTERVAL){var i={};i.value=t,i.text=zcal.AGENDA_INTERVAL[t],e.push(i)}var l=a.target;_({menuItems:e,par:a.target,parWidth:!0}).then(function(a){l.value=a.text,l.setAttribute("rel",a.value),zmUtil.hideMenu()})});var c=a.find("#zcl_MTO");c.length&&c.on("click",function(a){var e=n.REMID.split(","),t=[];for(var i in e){var l={};l.value=i,l.text=e[i],t.push(l)}var s=a.target;_({menuItems:t,par:a.target,parWidth:!0}).then(function(a){s.value=a.text,s.setAttribute("rel",a.value),zmUtil.hideMenu()})});var r=a.find("[data-marker=notifyType]").removeAttr("data-marker");r.length&&r.on("click",function(a){var e=$(this);e.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),e.find("i").removeClass("msi-unoption").addClass("msi-option"),z(e.index())});var d=a.find("[data-marker=resendEmail]").removeAttr("data-marker");d.length&&d.on("click",function(a){ZCL_XHR("/cal/set.do?type=resendemail",h)});var o=a.find("[data-marker=reverttoPrevious]").removeAttr("data-marker");o.length&&o.on("click",function(a){ZCL_XHR("/cal/set.do?type=revert",g)});var p=a.find("[data-marker=changeEmailNotify]").removeAttr("data-marker");p.length&&p.on("click",function(a){f()});var m=a.find("[data-marker=saveENotify]").removeAttr("data-marker");return m.length&&m.on("click",function(a){v()}),u.empty().append(a),u}var u=$('<li class="SC_setbox zcl_setbox"></li>'),t={},v=function(){if(function(){var a=zcal.cdata.opt,e=$("#enotifyType");if($("#zcl_MTO")[0]){var t=$("#zcl_MTO")[0].value;if(!c(t))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),$("#zcl_MTO").focus(),!1;if(t!=a.MTO)return!0}if(e.length){var i=parseInt($("#enotifyType").parent()[0].getAttribute("rel"));if(a.MT!=i)return!0;var l=-1;if(0===i&&(l=$("#zcl_AI").parent()[0].getAttribute("rel")),l!=a.AI)return!0}return!1}()){var a=zcal.cdata.opt,e=$("#enotifyType");(t={}).MTO=$("#zcl_MTO")[0]?$("#zcl_MTO")[0].value:a.MTO,t.MT=e.length?$("#enotifyType").parent()[0].getAttribute("rel"):a.MT,t.AI=0==t.MT?$("#zcl_AI").parent()[0].getAttribute("rel"):-1,ZCL_XHR("/cal/set.do?type=notify&mailto="+t.MTO.zcalescape()+"&as="+t.MT+"&agenda_notify="+t.AI,i)}},i=function(a){var e=ZCL_Evl(1,a.responseText);"success"==e.status&&(_zm.succErrMsg("s",zcal.i18n.successedit),zcal.cdata.opt.MTO=e.MTO,zcal.cdata.opt.MT=e.MT,zcal.cdata.opt.AI=e.AI)},f=function(){var a=$("<li></li>"),e="";e+='<div class="startup"><p><span class="mtb"><span class="SC_select zcl_Sem fn"><input class="inputShadow" id="zcl_MTO" value="'+zcal.cdata.opt.MTO+'" placeholder="" type="text"></span></span></p></div><div class="zcl_senmr">',e+='<div class="SC_PUbtm"><span data-marker="confirmEmail">'+zcal.i18n.confirm+'</span><span data-marker="cancelEmail" data-val="Cancel">'+zcal.i18n.cancel+"</span></div></div>",a.append($(e));var t=a.find("[data-marker=confirmEmail]").removeAttr("data-marker");t&&t.on("click",function(){s()});var i=a.find("[data-marker=cancelEmail]").removeAttr("data-marker");return i&&i.on("click",function(){l()}),u.find("#zcl_emailD").empty().append(a),u},s=function(){var a=zcal.cdata.opt,e=$("#zcl_MTO")[0].value.trim();if(a.CMAIL&&""!=a.CMAIL&&e!=a.CMAIL||null==a.CMAIL||""==a.CMAIL&&e!=a.MTO){if(!c(e))return _zm.succErrMsg("e",zcal.i18n.entervalidemail),$("#zcl_MTO").focus(),!1;a.CMAIL=e,ZCL_XHR("/cal/set.do?type=changeemail&mailto="+e.zcalescape(),n)}else l()},n=function(a){$.Deferred();var e=ZCL_Evl(1,a.responseText);""!=e.MTO&&""==e.CMAIL?(zcal.cdata.opt.MTO=e.MTO,zcal.cdata.opt.CMAIL=e.CMAIL,null!=e.MSG?"INVALID_ID"==e.MSG?_zm.succErrMsg("e",zcal.i18n.nonregisteredemailid):"NOPERM"==e.MSG&&_zm.succErrMsg("e",zcal.i18n.nonregisteredemailid):_zm.succErrMsg("s",zcal.i18n.mailconfirmed)):(zcal.cdata.opt.CMAIL=e.CMAIL,_zm.succErrMsg("s",zcal.i18n.verifymailsend)),l()},c=function(a){a=a.trim();return/^[\w]([\w\-\.\+\'\/]*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})$/i.test(a)},z=function(a){if(0===a){var e=zcal.cdata.opt;if(0==$("#zcl_AI").length){var t=$("<li></li>"),i="";for(var l in i+="<h3>"+zcal.i18n.agendanotification+"</h3><div class='section-content startup'><div class='fontSettings mb' rel='"+e.AI+"'>",zcal.AGENDA_INTERVAL)i+='<em id="zcl_AI" rel="'+l+'" class="'+(e.AI==l?"sel":"")+'">'+zcal.AGENDA_INTERVAL[l]+"</em>";i+="</div></div>",t.append($(i)),t.find("#zcl_AI").on("click",function(){var a=$(this);a.parent().find("em").removeClass("sel").addClass(""),a.removeClass("").addClass("sel"),a.parent()[0].setAttribute("rel",a[0].getAttribute("rel")),v()}),$(".SC_cal_prefer").after(t)}}else 0<$("#zcl_AI").length&&$("#zcl_AI").parents("LI")[0].remove()},h=function(a){var e=ZCL_Evl(1,a.responseText);zcal.cdata.opt.CMAIL=e.CMAIL,_zm.succErrMsg("s",zcal.i18n.mailsendsuccess)},g=function(a){var e=ZCL_Evl(1,a.responseText);zcal.cdata.opt.CMAIL=e.CMAIL,l()},C=function(a,e){return a.replace(/\{[0-9]\}/g,function(a){return a=a.replace(/[\{\}]/g,""),e[parseInt(a)]})},_=function(a){var i=[];(a.menuItems||[]).forEach(function(a){var e=a.value,t=a.text;i.push({htm:"<div>"+t+"</div>",data:{value:e,text:t}})});var l=$.Deferred();return a.list=i,a.clk=function(a,e,t){l.resolve(a,e.parentNode,t)},a.onHide=function(){l.reject()},i.length?zmsuite.showMenu(a):l.reject(),l.fail(zmUtil.hideMenu),l.promise()};a.initialize=function(a){(a=a||{}).process.resolve()},a.uninitialize=function(a){(a=a||{}).process.resolve()},a.getEmailNotifyView=l},"MailSuite.Apps.CalendarEmailNotify"),_defineSettingsModule("EmailNotify",function(a,e){"use strict";function t(){return e("MailSuite.Apps.CalendarEmailNotify.EmailNotifyView")}function i(){$.Deferred();var a,e=d.makeDeferred();return"undefined"==typeof zcal?(a=$.Deferred(),zmApp.loadCalendar("/calendar/settings",a),a.promise()).done(function(){t().initialize({process:e})}).fail(e.reject):t().initialize({process:e}),e.promise()}function l(){var a=d.makeDeferred();return t.uninitialize({process:a}),a.promise()}function s(){return t().getEmailNotifyView()}function n(){return null}var c,r=e("Platform.Components").SettingAppManager,d=e("Platform.System.Utils");c=r.create("email-notify",{attributes:{page:"email-notify",isReactApp:!1},initialize:i,uninitialize:l,getView:s,handleContainerEvent:n}),a.App=c},"MailSuite.Apps"),function(a){"use strict";var e="email-notify",t="email-notify",i="email-address",l="agenda-notify",s={cardItem:{title:"Email Address"}},n={cardItem:{title:"Agenda notification"}},c=a("Platform.Components"),r=a("Platform.Entities"),d=(a("MailSuite.Settings.Calendar"),a("Platform.System.Utils"),c.SettingCardItemManager),o=r.SettingCardItem.Types;d.create(i,{props:{title:s.cardItem.title,value:""},attributes:{type:o.LabelAction,card:e},primaryAction:d.CardItemActions.OpenPageAction(t,{showSection:i})}),d.create(l,{props:{title:n.cardItem.title,value:""},attributes:{type:o.LabelAction,card:e},primaryAction:d.CardItemActions.OpenPageAction(t,{showSection:l})})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,e){"use strict";var t="calendar-import",i=e("Platform.Components"),l=e("Platform.Entities"),s=i.SettingPageManager,n=l.SettingPage.Types,c=s.create(t,{props:{title:"Import"},attributes:{card:t,category:"calendar",type:n.Title,pageCSSClass:"calendar-import-page",appContainer:!0}});a.CalendarImport=c},"MailSuite"),_defineSettingsModule("Cards",function(a,e){"use strict";var t=e("Platform.Components").SettingCardManager,i=t.create("calendar-import",{props:{openable:!0,title:"Import",addToSearch:!1},state:{hidden:!1},attributes:{category:"calendar"},openAction:t.CardActions.OpenPageAction("calendar-import")});a.CalendarImport=i},"MailSuite"),_defineSettingsModule("ImportView",function(c,a){"use strict";var r=function(){var a,e,t,i=$("#zcl_impMoreOpt");$("#zcl_impMoreOptTxt");return(a=$('<li id="zcl_impOvr"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></li>")).off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),i.append(a),(e=$('<li id="zcl_impAtt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></li>")).off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),i.append(e),(t=$('<li id="zcl_impRem"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includereminder+"</span></div></li>")).off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),i.append(t),$('<li id="zcl_impPvt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></li>").off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),i},d=function(){var a,e,t,i,l=$("#zcl_impMoreOpt1"),s=$("#zcl_impMoreOptTxt1");l.is(":visible")?(l.html(""),s.text(zcal.i18n.moreoptions),l.hide()):((a=$('<li id="zcl_impOvr"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></li>")).off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),l.append(a),(e=$('<li id="zcl_impAtt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></li>")).off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),l.append(e),(t=$('<li id="zcl_impRem"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includereminder+"</span></div></li>")).off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),l.append(t),(i=$('<li id="zcl_impPvt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></li>")).off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),l.append(i),s.text(zcal.i18n.hideoptions),l.show())},o=function(a){a.hasClass("msi-check")?a.removeClass("msi-check").addClass("msi-uncheck"):a.removeClass("msi-uncheck").addClass("msi-check")},p=function(){var a,e=!1,t=!1,i=!1,l=!1,s=$("#zcl_impFil").val().trim(),n=ZCL_$("zcl_impFil").files,c=$("#zcl_impMoreOpt"),r=n[0];if(r.size>zcal.ZCL_MAXFILESIZE)return 125829120==zcal.ZCL_MAXFILESIZE?zmUtil.succErrMsg("e",zcal.i18n.exceed_maxsize):zmUtil.succErrMsg("e",zcal.i18n.importfailure_exceedsize),!1;if(".ics"!=s.substr(s.lastIndexOf(".")))return zmUtil.succErrMsg("e",zcal.i18n.sel_validicsfile),!1;if(c.is(":visible")){var d=$("#zcl_impOvr").find("i"),o=$("#zcl_impAtt").find("i"),p=$("#zcl_impRem").find("i"),m=$("#zcl_impPvt").find("i");e=!!d.hasClass("msi-check"),t=!!o.hasClass("msi-check"),i=!!p.hasClass("msi-check"),l=!!m.hasClass("msi-check")}if(null==(a=$("#zcl_impCal").val()))return zmUtil.succErrMsg("e",zcal.i18n.selvacalnam),!1;$("#zcl_impCkey").val(a);var u=ZCL_getCookie("aprmjrnpkcrkks");document.zcl_impEve.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:"mstpcrdhkur",value:u}}])),$("#zcl_owrEvent").val(e),$("#zcl_incAtt").val(t),$("#zcl_incRem").val(i),$("#zcl_mkPvt").val(l);var v=new FormData;v.append("zcl_impFil",r),v.append("zcl_impCkey",a),v.append("zcl_owrEvent",e),v.append("zcl_incAtt",t),v.append("zcl_incRem",i),v.append("zcl_mkPvt",l),v.append("mstpcrdhkur",u);var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=this.responseText?JSON.parse(this.responseText):"";z(a)}else 400!=this.status&&500!=this.status||zmUtil.succErrMsg("e",zcal.i18n.failimport)},f.open("POST",zcal_zmcontext+"/cal/import.do",!0),f.send(v)},z=function(a){if(""==a)zmUtil.succErrMsg("e",zcal.i18n.failimport);else{var e=a;if(0==e.PCNT)zmUtil.succErrMsg("e",zcal.i18n.failimport);else"10000"<e.TCNT?zmUtil.succErrMsg("e",zcal.i18n.importfailure_exceedlimit):(zmUtil.succErrMsg("s",zcal.i18n.successimport+". "+zcal.i18n.totallyprocessed+" : "+(null==e.PCNT?0:e.PCNT)+". "+zcal.i18n.actuallyimported+" : "+(null==e.ACNT?0:e.ACNT)),zcalEvents.loadMonthData()),ZCL_$("zcl_impFil").value="",ZCL_$("zcl_filediv").remove(),$("#choose1").find("span")[0].innerHTML="<b>"+zcal.i18n.selfiletoimport+"</b>"+zcal.i18n.drag_files}},m=function(){var a,e,t,i,l,s,n=$("#zcl_impUrl")[0].value.trim();$("#zcl_impMoreOpt1");if(!/^(http|https|webcal|webcals)\:\/\/[-.\w]*(\/?)([a-zA-Z0-9\-\.\?\,\:\'\/\\\+=&amp;%\$#_@]*)?$/i.test(n))return zmUtil.succErrMsg("e",zcal.i18n.provide_httpurl),$("#zcl_impUrl")[0].value="",$("#zcl_impUrl")[0].focus(),!1;var c=$("#zcl_impMoreOpt1").find("#zcl_impOvr").find("i"),r=$("#zcl_impMoreOpt1").find("#zcl_impAtt").find("i"),d=$("#zcl_impMoreOpt1").find("#zcl_impRem").find("i"),o=$("#zcl_impMoreOpt1").find("#zcl_impPvt").find("i");if(t=!!c.hasClass("msi-check"),i=!!r.hasClass("msi-check"),l=!!d.hasClass("msi-check"),s=!!o.hasClass("msi-check"),null==(a=$("#zcl_impCal1").val()))return zmUtil.succErrMsg("e",zcal.i18n.selvacalnam),!1;e=$("#zcl_impCal option:selected").data("cid");var p="/cal/impurl.do?url="+encodeURIComponent(n)+"&impCkey="+a+"&incAtt="+i+"&owrEvent="+t+"&incRem="+l+"&mkPvt="+s+(e?"&calId="+e:"");ZCL_XHR(p,function(a){var e=ZCL_Evl(1,a.responseText);u(e)})},u=function(a){""==a||0==a.PCNT?zmUtil.succErrMsg("e",zcal.i18n.failimport):("10000"<a.TCNT?zmUtil.succErrMsg("e",zcal.i18n.importfailure_exceedlimit):(zmUtil.succErrMsg("s",zcal.i18n.cal_successimport+". "+zcal.i18n.numofeve_processed+" : "+(null==a.PCNT?0:a.PCNT)+". "+zcal.i18n.imported+" : "+(null==a.ACNT?0:a.ACNT)),zcalEvents.loadMonthData()),$("#zcl_impUrl")[0].value="")},v=function(){var a='<select id="zcl_impCal" datachange = "false">';return a+=n(),a+="</select>"},n=function(t){var a=zcal.cdata.calOrdArr,i="";return a.forEach(function(a){var e=zcal.cdata.calLst;"1"==e[a][8]&&(i+='<option value="'+e[a][9]+'" data-cid="'+a+'" '+(a==t?"selected":"")+">"+ZCL_getHTML(e[a][0])+"</option>")}),a.length<100&&(i+='<option value="0">'+zcal.i18n.newcal+"</option>"),i},f=function(){var a='<select id="zcl_impCal1" datachange = "false">';return a+=h(),a+="</select>"},h=function(t){var a=zcal.cdata.calOrdArr,i="";return a.forEach(function(a){var e=zcal.cdata.calLst;"1"==e[a][8]&&(i+='<option value="'+e[a][9]+'" data-cid="'+a+'" '+(a==t?"selected":"")+">"+ZCL_getHTML(e[a][0])+"</option>")}),a.length<100&&(i+='<option value="0">'+zcal.i18n.newcal+"</option>"),i},e=function(){$.subscribe("/calendar/added",c.updCalSel),$.subscribe("/calendar/updated",c.updCalSel),$.subscribe("/calendar/deleted",c.updCalSel),$.subscribe("/calendar/statusChanged",c.updCalSel)},t=function(){$.unsubscribe("/calendar/added",c.updCalSel),$.unsubscribe("/calendar/updated",c.updCalSel),$.unsubscribe("/calendar/deleted",c.updCalSel),$.unsubscribe("/calendar/statusChanged",c.updCalSel)};c.initialize=function(a){(a=a||{}).process.resolve(),e()},c.uninitialize=function(a){(a=a||{}).process.resolve(),t()},c.getImportView=function(){var a=$(document.createDocumentFragment()),e=(zcal.cdata.opt,zcal.cdata.calOrdArr,""),t=$("<li class='SC_setbox zcl_setbox'></li>"),i=$("<ul></ul>");e+="<li>",e+="<h3>"+zcal.i18n.importfromfile+'</h3><div class="zm_impexp pb40">',e+='<iframe name="zcl_imp" id="zcl_imp" style="display:none"></iframe><form action="'+zcal_zmcontext+'/cal/import.do" method="post" enctype="multipart/form-data" target="zcl_imp" onSubmit="return false;" id="zcl_impEve" name="zcl_impEve">',e+='<input id="zcl_impCkey" value="0" name="zcl_impCkey" type="hidden"/>',e+='<input id="zcl_owrEvent" value="false" name="zcl_owrEvent" type="hidden"/>',e+='<input id="zcl_incAtt" value="false" name="zcl_incAtt" type="hidden"/>',e+='<input id="zcl_incRem" value="false" name="zcl_incRem" type="hidden"/>',e+='<input id="zcl_mkPvt" value="false" name="zcl_mkPvt" type="hidden"/>',e+='<div id="importDiv" style="display:;"> <div class="zm_impexpDragdiv"><div id="choose1" data-marker="calimport"><span> <b>'+zcal.i18n.selfiletoimport+'</b></span></div></div></div><input type="file" id="zcl_impFil" name="zcl_impFil" style="display:none"/>',e+="</form>",e+='<div class="SC_select default">'+v()+"</div>",e+='<div class="zcl_mb">',e+='<ul class="zcl_Sckls" id="zcl_impMoreOpt" class="moreOptions">',e+='<li id="zcl_impOvr"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></li>",e+='<li id="zcl_impAtt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></li>",e+='<li id="zcl_impRem"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includereminder+"</span></div></li>",e+='<li id="zcl_impPvt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></li>",e+="</ul></div>",e+="</div></div>",e+='<div class="SC_PUbtm"><span data-marker="calImportfile">'+zcal.i18n.import+"</span></div>",e+="</li>",e+="<li>",e+="<h3>"+zcal.i18n.importfromurl+'</h3><div class="zm_impexp pb40"><div class="zcl_mb"><div class="startup zcl_mb"><p><span class="mtb">'+zcal.i18n.providecalurl+'<span class="SC_select zcl_Sem fn"><input class="inputShadow" id="zcl_impUrl" placeholder="" type="text"/></span></span></p><div class="SC_select default">'+f()+"</div></div></div>",e+='<div class="zcl_mb">',e+='<ul class="zcl_Sckls"  id="zcl_impMoreOpt1" class="moreOptions">',e+='<li id="zcl_impOvr"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></li>",e+='<li id="zcl_impAtt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></li>",e+='<li id="zcl_impRem"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includereminder+"</span></div></li>",e+='<li id="zcl_impPvt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></li>",e+="</ul></div></div>",e+='<div class="startup help zcl_mb"><em><img src='+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+' class="info-message"></em><span>'+zcal.i18n.provide_icalurl+"</span></div>",e+='<div class="SC_PUbtm"><span data-marker="calImporturl">'+zcal.i18n.import+"</span></div>",e+="</li>",i.append($(e)),i.find("#zcl_impOvr").off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),i.find("#zcl_impAtt").off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),i.find("#zcl_impRem").off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),i.find("#zcl_impPvt").off("click").on("click",function(a){var e;e=$(this).find("i"),o(e)}),t.append(i);t.find("#zcl_impCal");var l=t.find("select");l.length&&l.change(function(a){var e=a.target||a.srcElement;this.setAttribute("datachange","true");var t=this.value;"zcl_impCal"==e.id?c.newcal.imp="file":"zcl_impCal1"==e.id&&(c.newcal.imp="url"),0==t&&ZCL_createCal()});var s=t.find("[data-marker=calImportfile]").removeAttr("data-marker");s.length&&s.on("click",function(a){p()});var n=t.find("[data-marker=calImporturl]").removeAttr("data-marker");return n.length&&n.on("click",function(a){m()}),t.find("#zcl_impMoreOptTxt").off("click").on("click",function(a){r()}),t.find("#zcl_impMoreOptTxt1").off("click").on("click",function(a){d()}),t.find("#choose1").on("click",function(a){var e=a.target||a.srcElement;"SC_icn"!=e.className&&"msi-close"!=e.className&&$("#zcl_impFil").click()}),t.find("#zcl_impFil").on("change",function(a){var e=zmUtil.fileTyp(a.target.files[0].name)[1];e+=" zm-attIcn";var t=a.target.files[0].size/1024;t=Math.round(100*t)/100;var i=$("#choose1").find("span"),l=$('<div class="zmCAt" id="zcl_filediv"></div>'),s='<div class="zmL SC_Pbar"><div class="zmLst"><div class="zmDtl"><div class="zmSze"><span class="sum">'+t+'KB</span></div><div class="zmFrm"><span>'+ZCL_getHTML(a.target.files[0].name)+'</span></div><div class="zmImg"><i class="'+e+'"></i></div><div class="SC_icn"><i class="msi-close"></i></div></div></div></div></div>';l[0].innerHTML=s,i[0].innerHTML="",l.find(".SC_icn").on("click",function(){$("#zcl_impFil")[0].value="",l[0].innerHTML="",i[0].innerHTML="<b>"+zcal.i18n.selfiletoimport+"</b> "}),i.append(l)}),a.append(t),a},c.updCalSel=function(a,e){var t=$("#zcl_impCal"),i=$("#zcl_impCal1"),l=e&&e.calid&&c.newcal&&"file"==c.newcal.imp?n(e.calid):n(),s=e&&e.calid&&c.newcal&&"url"==c.newcal.imp?h(e.calid):h();""!=l&&(t.empty(),t.html(l),c.newcal={}),""!=s&&(i.empty(),i.html(s),c.newcal={})},c.showImportStatus=z,c.newcal={}},"MailSuite.Apps.CalendarImport"),_defineSettingsModule("Import",function(a,e){"use strict";function t(){return e("MailSuite.Apps.CalendarImport.ImportView")}function i(){$.Deferred();var a,e=d.makeDeferred();return"undefined"==typeof zcal?(a=$.Deferred(),zmApp.loadCalendar("/calendar/settings",a),a.promise()).done(function(){t().initialize({process:e})}).fail(e.reject):t().initialize({process:e}),e.promise()}function l(){var a=d.makeDeferred();return t().uninitialize({process:a}),a.promise()}function s(){return t().getImportView()}function n(){return null}var c,r=e("Platform.Components").SettingAppManager,d=e("Platform.System.Utils");c=r.create("calendar-import",{attributes:{page:"calendar-import",isReactApp:!1},initialize:i,uninitialize:l,getView:s,handleContainerEvent:n}),a.App=c},"MailSuite.Apps"),function(a){"use strict";var e="calendar-import",t="calendar-import",i="by-file",l="by-url",s={cardItem:{title:"By File"}},n={cardItem:{title:"By URL"}},c=a("Platform.Components"),r=a("Platform.Entities"),d=(a("MailSuite.Settings.Calendar"),a("Platform.System.Utils"),c.SettingCardItemManager),o=r.SettingCardItem.Types;d.create(i,{props:{title:s.cardItem.title},attributes:{type:o.Action,card:e},primaryAction:d.CardItemActions.OpenPageAction(t,{showSection:i})}),d.create(l,{props:{title:n.cardItem.title},attributes:{type:o.Action,card:e},primaryAction:d.CardItemActions.OpenPageAction(t,{showSection:l})})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,e){"use strict";var t="calendar-subscribe",i=e("Platform.Components"),l=e("Platform.Entities"),s=i.SettingPageManager,n=l.SettingPage.Types,c=s.create(t,{props:{title:"Subscribe"},attributes:{card:t,category:"calendar",type:n.Title,pageCSSClass:"calendar-subscribe-page",appContainer:!0}});a.CalendarSubscribe=c},"MailSuite"),_defineSettingsModule("Cards",function(a,e){"use strict";var t=e("Platform.Components").SettingCardManager,i=t.create("calendar-subscribe",{props:{openable:!0,title:"Subscribe",addToSearch:!1},state:{hidden:!1},attributes:{category:"calendar"},openAction:t.CardActions.OpenPageAction("calendar-subscribe")});a.CalendarSubscribe=i},"MailSuite"),_defineSettingsModule("SubscribeView",function(a,e){"use strict";function t(a,e){for(var t=0;t<e.length;t++){var i=zcalGroup.getGroup(e[t]);i&&a.push({id:e[t],name:i.name,display_text:i.name})}}var v,d,f=[],o=[],p=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),i=function(){for(var a=o,e=$('<div class="editFilterParent ht100p"></div>'),t=$('<div class="subDiv"></div>'),i=$('<div class="SC_ptit"><div><div class="impExpHeading">'+zcal.i18n.holidays+"</div></div></div>"),l=$('<div class="SC_filt_bottom SC_filt_bottomCustom"><div data-marker="loadingAnimation"></div></div>'),s=($('<div class="editFilterParent"></div>'),0);s<a.length;s++){var n=$('<div class="zmL"></div>'),c="";c+="<ul><li><span>"+ZCL_getHTML(a[s][0])+"</span></li>",c+='<li><div class="SC_PUbtm">',-1==zcal.cdata.calOUids.indexOf(a[s][1])?c+='<span data-val="Cancel"   data-marker="sub" id="sub">'+zcal.i18n.subscribe+"</span>":c+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",c+="</div></li>",c+="</ul>",n.html(c);var r=n.find("[data-marker=sub]").removeAttr("data-marker");r.length&&m(r,a[s][1],a[s][0]);var d=n.find("[data-marker=unsub]").removeAttr("data-marker");d.length&&u(d,a[s][1]),e.append(n)}return l.append(e),t.append(i),t.append(l),p.empty().append(t),p},m=function(a,e,t){a.on("click",{uid:e,name:t},function(a){l(a.data.uid,a.data.name)})},l=function(a,e){var t="/cal/subHoli.do?mode=sub&huid="+encodeURIComponent(a)+"&loc="+e;ZCL_XHR(t,function(a){k(a)})},u=function(a,e){a.on("click",{uid:e},function(a){z(a.data.uid)})},z=function(a){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),function(a){A(a)})},h=function(){if(0==o.length){ZCL_XHR("/cal/subHoli.do?mode=list",function(a){var e;"list"==(e=ZCL_Evl(1,a.responseText)).mode&&(o=e.obj,zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return i()}}).done(function(a){a.card.show()}))})}else{zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return i()}}).done(function(a){a.card.show()})}},g=function(){var a=$("#zcl_fEmailId").val();if(!ZCL_isEmail(a))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),ZCL_$("zcl_fEmailId").focus(),!1;ZCL_XHR("/cal/subCal.do?mode=pub-lst&mailId="+a.zcalescape(),function(a){s(a)})},s=function(a){var e=ZCL_Evl(1,a.responseText);if("pub-lst"==e.mode)if("du"==e.result){var t=e.obj;f=[t.pub,t.pvt,t.org,e.mid],n()}else"su"==e.result?_zm.succErrMsg("i",zcal.i18n.cannotsubtoowncal):"nonzoho"==e.result?_zm.succErrMsg("i",ZCL_replaceComName(zcal.i18n.theuserdonthavezohoacc)):"np"==e.result?_zm.succErrMsg("e",zcal.i18n.cannotsubnonorgmemcal):"UserNotInCal"==e.result&&_zm.succErrMsg("e",zcal.i18n[e.result])},n=function(){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return c()}}).done(function(a){a.card.show()})},C=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),c=function d(){var a=f[0],o=f[1],p=f[2];v=$('<div id="subDiv1"></div>');var e=$('<div class="SC_setTab"><div class="SC_setTabList"><span class="sel" id="pub">'+zcal.i18n.public+'</span><span id="org">'+zcal.i18n.org+'</span><span id="pri">'+zcal.i18n.eprivate+"</span></div></div>"),t=$('<div class="SC_filt_bottom SC_filt_bottomCustom"></div>'),m=$('<div class = "editFilterParent ht100p"></div>');if(w(a)){var i='<div class="zmL"><ul><li><em>'+zcal.i18n.calnotfound+"</em></li></ul></div>";m.append(i)}else for(var l in a){var s=$('<div class="zmL"></div>'),n="";n+="<ul><li><span>"+ZCL_getHTML(a[l][0])+"</span><em>"+(1==a[l][1]||4==a[l][1]?zcal.i18n.viewonlyfreebusy:zcal.i18n.vieweventdetail)+"</em></li>",n+='<li><div class="SC_PUbtm">',-1==zcal.cdata.calOUids.indexOf(a[l][2])?n+='<span  data-val="Cancel" data-marker="sub">'+zcal.i18n.subscribe+"</span>":n+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",n+="</div></li>",n+="</ul>",s.html(n);var c=s.find("[data-marker=sub]").removeAttr("data-marker");c.length&&c.on("click",{id:l},function(a){b(a.data.id)});var r=s.find("[data-marker=unsub]").removeAttr("data-marker");r.length&&r.on("click",{uid:a[l][2]},function(a){z(a.data.uid)}),m.append(s)}if(e.on("click",function(a){var e=a.target||a.srcElement;if("pri"==e.id)if(m.empty(),$(e.parentNode).find("span").removeClass("sel"),$(e).addClass("sel"),w(o)){var t='<div class="zmL"><ul><li><em>'+zcal.i18n.calnotfound+"</em></li></ul></div>";m.append(t)}else for(var i in o){var l=$('<div class="zmL"></div>'),s="";s+="<ul><li><span>"+ZCL_getHTML(o[i][0])+"</span><em>"+(0==o[i][1]?zcal.i18n.viewonlyfreebusy:1==o[i][1]?zcal.i18n.vieweventdetail:2==o[i][1]?zcal.i18n.private_shperm_editevent:zcal.i18n.private_shperm_delegate)+"</em></li>",s+='<li><div class="SC_PUbtm">',-1==zcal.cdata.calOUids.indexOf(o[i][2])?s+='<span  data-val="Cancel" data-marker="sub">'+zcal.i18n.subscribe+"</span>":s+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",s+="</div></li>",s+="</ul>",l.html(s),(n=l.find("[data-marker=sub]").removeAttr("data-marker")).length&&n.on("click",{id:i},function(a){b(a.data.id)}),(c=l.find("[data-marker=unsub]").removeAttr("data-marker")).length&&c.on("click",{uid:o[i][2]},function(a){z(a.data.uid)}),m.append(l)}else if("pub"==e.id)m.empty(),$(e.parentNode).find("span").removeClass("sel"),$(e).addClass("sel"),d();else if("org"==e.id){if(m.empty(),$(e.parentNode).find("span").removeClass("sel"),$(e).addClass("sel"),w(p)){t='<div class="zmL"><ul><li><em>'+zcal.i18n.calnotfound+"</em></li></ul></div>";m.append(t)}else for(var i in p){var n,c;l=$('<div class="zmL"></div>'),s="";s+="<ul><li><span>"+ZCL_getHTML(p[i][0])+"</span><em>"+(1==p[i][1]?zcal.i18n.viewonlyfreebusy:zcal.i18n.vieweventdetail)+"</em></li>",s+='<li><div class="SC_PUbtm">',-1==zcal.cdata.calOUids.indexOf(p[i][2])?s+='<span  data-val="Cancel" data-marker="sub">'+zcal.i18n.subscribe+"</span>":s+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",s+="</div></li>",s+="</ul>",l.html(s),(n=l.find("[data-marker=sub]").removeAttr("data-marker")).length&&n.on("click",{id:i},function(a){b(a.data.id)}),(c=l.find("[data-marker=unsub]").removeAttr("data-marker")).length&&c.on("click",{uid:p[i][2]},function(a){z(a.data.uid)}),m.append(l)}var r=m.find("#zcl_pvtshreqlnk");r.length||(r=$('<span class="SC_lnk" id="zcl_pvtshreqlnk"/>'),m.append(r)),r.html("&raquo;"+zcal.i18n.sendreqforindividualshare),r.off("click").on("click",{eid:f[3]},function(a){_(a.data.eid)})}}),!w(o));var u=m.find("#zcl_pvtshreqlnk");return u.length||(u=$('<span class="SC_lnk" id="zcl_pvtshreqlnk"/>'),m.append(u)),u.html("&raquo;"+zcal.i18n.sendreqforindividualshare),u.off("click").on("click",{eid:f[3]},function(a){_(a.data.eid)}),t.append(m),v.append(e),v.append(t),C.empty().append(v),C},_=function(a){var e="/cal/sentReq.do?mailId="+a.zcalescape();ZCL_XHR(e,function(a){r(a)})},r=function(){_zm.succErrMsg("s",zcal.i18n.requestmailsent)},b=function(a){var e="/cal/subCal.do?mode=sub-url&url="+encodeURIComponent(location.protocol+"//"+zcal.ZCAL+"/ical/"+a);ZCL_XHR(e,function(a){k(a)})},S=function(a){var e="/cal/subCal.do?mode=sub-url&url="+encodeURIComponent(a);ZCL_XHR(e,function(a){k(a)})},k=function(a){var e;if(200===a.status)if("success"==(e=ZCL_Evl(1,a.responseText)).status){var t=e.obj;zcal.cdata.calOLst=t.calOLst,zcal.cdata.calOUids=t.calOUids,zcal.cdata.calGLst=t.calGLst,y(t.calALst),_zm.succErrMsg("s",zcal.i18n.calSubSuccess),$.publish("/calendar/subscribed"),v?c():p&&i(),$("#zcl_subLink")[0].value=""}else _zm.succErrMsg("e",zcal.i18n[e.status]),$("#zcl_subLink")[0].value="";else(e=ZCL_Evl(1,a.responseText)).message?_zm.succErrMsg("e",e.message):_zm.succErrMsg("e",zcal.i18n.errmsg),$("#zcl_subLink")[0].value=""},y=function(a){var e;for(var t in zcal.cdata.calALst={},a)"recruit"!=(e=a[t])[14]&&(zcal.cdata.calALst[t]=ZCL_Evl(1,JSON.stringify(e)))},A=function(a){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){var t=e.id;zcal.cdata.calLst[t]?(delete zcal.cdata.calLst[t],ZCL_remCalid(t),_zm.succErrMsg("s",zcal.i18n.caldeleted)):(zcal.cdata.calOLst[t]||zcal.cdata.calGLst[t]||zcal.cdata.calALst[t])&&(zcal.cdata.calGLst[t]?delete zcal.cdata.calGLst[t]:delete zcal.cdata.calOLst[t],ZCL_remOCalid(e.uid),_zm.succErrMsg("s",zcal.i18n.unsubscribesuc)),ZCL_gothro(t),v?c():p&&i(),$.publish("/calendar/deleted",{calid:t,caluid:e.uid,mode:"delete"})}else _zm.succErrMsg("e",e.status)},w=function(a){for(var e in a)if(a.hasOwnProperty(e))return!1;return!0},L=function(){var a,e=[];return a=zcalGroup.getGroupList("personal"),t(e,a),a=zcalGroup.getGroupList("org"),t(e,a),e},M=function(a,e,t){a.val(t.display_text),a.attr("data-gid",e)},T={},E=function(a){d=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'></div>");for(var e=$("<div class='SC_setTab'><div class='SC_setTabList' id='zcl_grpcallst_tabs'></div></div><div class='SC_filt_bottom SC_filt_bottomCustom'><div class='editFilterParent'  id='zcl_grpcallst'></div></div>"),t=[{type:"def",text:zcal.i18n.available},{type:"sh",text:zcal.i18n.shared},{type:"sub",text:zcal.i18n.subscribed}],i=0;i<t.length;i++){var l=$('<span id="zcl_grpcal_'+t[i].type+'">></span>');l.addClass("def"==t[i].type?"sel":""),l.text(t[i].text),P(l,t[i].type),e.find(".SC_setTabList").append(l)}return $.when(x(a)).then(function(a){I("def")}),d.append(e),d},P=function(a,e){a.off("click").on("click",{type:e},function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),I(a.data.type)})},x=function(a){var e=$.Deferred();return ZCL_XHR("/cal/grpDtl.do?mode=grp-callst&comid="+a,function(a){T=ZCL_Evl(1,a.responseText),e.resolve(T)}),e},I=function(a){var e,t=$("#zcl_grpcallst");if(e="sh"==a?T.shdcLst:"sub"==a?T.subcLst:T.owncLst,t.empty(),w(e)){if(t.is(":empty")){s=$('<div class="zmL"><li><em>'+zcal.i18n.no_sharecalendar+"</em></li></div>");t.append(s)}}else for(var i in e){var l=e[i],s=$('<div class="zmL"></div>'),n="";n+="<ul><li><span>"+ZCL_getHTML(l.CNAME)+"</span></li>",n+='<li><div class="SC_PUbtm">',"def"!=a&&(l.IS_OWN||1==l.IS_OWN||(0==l.IS_SUB?n+='<span data-val="Cancel" data-marker="sub" id="sub">'+zcal.i18n.subscribe+"</span>":n+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>")),n+="</div></li>",n+="</ul>",s.html(n);var c=s.find("[data-marker=sub]").removeAttr("data-marker");c.length&&c.on("click",{uid:i,gid:T.comid},function(a){Z(a.data.uid,a.data.gid)});var r=s.find("[data-marker=unsub]").removeAttr("data-marker");r.length&&r.on("click",{uid:i},function(a){O(a.data.uid)}),t.append(s)}d.find("SC_filt_bottom SC_filt_bottomCustom").append(t)},Z=function(a,e){var t="/cal/subCal.do?mode=grpcal-sub&caluid="+encodeURIComponent(a)+"&grpid="+e;ZCL_XHR(t,N)},O=function(a){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),U)},N=function(a){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){var t,i=e.obj,l=e.uid;zcal.cdata.calOLst=i.calOLst,zcal.cdata.calOUids=i.calOUids,zcal.cdata.calGLst=i.calGLst,zcal.cdata.calByGrp=i.calByGrp,y(i.calALst),_zm.succErrMsg("s",zcal.i18n.calSubSuccess),D(l),"zcl_grpcal_sh"==(t=$("#zcl_grpcallst_tabs").find(".sel"))[0].id?I("sh"):"zcl_grpcal_sub"==t[0].id?I("sub"):I("def"),$.publish("/calendar/subscribed")}else"available"==e.status?_zm.succErrMsg("s",zcal.i18n.calSubSuccess):_zm.succErrMsg("e",e.status)},U=function(a){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){var t,i=e.id,l=e.uid;$.publish("/calendar/deleted",{calid:i,caluid:l,mode:"unsubscribe"}),D(l),"zcl_grpcal_sh"==(t=$("#zcl_grpcallst_tabs").find(".sel"))[0].id?I("sh"):"zcl_grpcal_sub"==t[0].id?I("sub"):I("def")}else _zm.succErrMsg("e",e.status)},D=function(a){if(!w(T)){if(T.owncLst&&T.owncLst[a])return void(T.owncLst[a].IS_SUB=0==T.owncLst[a].IS_SUB?1:0);if(T.shdcLst&&T.shdcLst[a])return void(T.shdcLst[a].IS_SUB=0==T.shdcLst[a].IS_SUB?1:0);T.subcLst&&T.subcLst[a]&&(T.subcLst[a].IS_SUB=0==T.subcLst[a].IS_SUB?1:0)}};a.initialize=function(a){(a=a||{}).process.resolve()},a.uninitialize=function(a){(a=a||{}).process.resolve()},a.getSubscribeView=function(){var a=$(document.createDocumentFragment()),e=$("<li class='SC_setbox zcl_setbox'></li>"),t=(zcal.cdata.opt,""),i=$("<ul></ul>");t+="<li>",t+="<h3>"+zcal.i18n.subscribe_weburl+'</h3><div class="startup zcl_mb"><p><span class="mtb">'+zcal.i18n.enterurl+'<span class="SC_select zcl_Sem fn"><input id="zcl_subLink" class="inputShadow" placeholder="" type="text"></span></span></p></div><div class="startup help zcl_mb"><em><img src='+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+' class="info-message"></em><span>'+zcal.i18n.provide_httpurl+'</span></div><div class="SC_PUbtm"><span data-marker="subToCal">'+zcal.i18n.subscribe+"</span></div>",t+="</li>",t+="<li>",t+="<h3>"+zcal.i18n.subsribe_contacts+'</h3><div class="startup zcl_mb"><p><span class="mtb">'+zcal.i18n.provide_contemail+'<span class="SC_select zcl_Sem fn"><input class="inputShadow" placeholder="" type="text" id="zcl_fEmailId"></span></span></p></div><div class="startup help zcl_mb"><em><img src='+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+' class="info-message"></em><span>'+zcal.i18n.friends_email_note+'</span></div><div class="SC_PUbtm"><span data-marker="listFCal">'+zcal.i18n.subscribe+"</span></div>",t+="</li>",t+="<li>",t+="<h3>"+zcal.i18n.subscribe_holiday+'</h3><div class="startup help zcl_mb"><em><img src='+(zmail.imgPath?zmail.imgPath+"settings/lightbulb-info.png":zmResource.get("image","settings/lightbulb-info.png"))+' class="info-message"></em><span>'+zcal.i18n.holiday_note+'</span></div><div class="SC_PUbtm"><span data-marker="holidaylist">'+zcal.i18n.showavaicountry+"</span></div>",t+="</li>",ZCL_GRP_SECTION&&(t+="<li>",t+="<h3>"+zcal.i18n.subscribe_group+"</h3>",0<L().length?(t+='<div class="startup zcl_mb"><p><span>'+zcal.i18n.selgroupview+'</span><span class="SC_select" style=""><input data-marker="pergrouplist" type="text" value="'+zcal.i18n.selectagroup+'" id="zcl_gid" readonly=""></span></p></div>',t+='<div class="SC_PUbtm"><span data-marker="listGCal">'+zcal.i18n.ok+"</span></div>"):t+='<div class="startup zcl_mb"><p><span>'+zcal.i18n.nogroup+"</span></p></div>",t+="</li>");i.append($(t)),e.append(i),a.append(e);var l=e.find("[data-marker=holidaylist]").removeAttr("data-marker");l.length&&l.on("click",function(){h()});var s=e.find("[data-marker=pergrouplist]").removeAttr("data-marker");s.length&&s.on("click",function(){var t,a=L(),e={},i=$(this);e.parentDOM=i.parent(),e.displayAs="popup",e.onSelect=function(a,e){M(i,a,e),t.hide()},e.onHide=function(){_zm.remove(_zm("#","zm_dropDown"))},e.dataCallback=function(){return a},(t=zmUtil.createFLComp("generic",e)).show()});var n=e.find("[data-marker=listFCal]").removeAttr("data-marker");n.length&&n.on("click",function(a){g()});var c=e.find("[data-marker=listGCal]").removeAttr("data-marker");c.length&&c.on("click",function(a){var e=$("#zcl_gid")[0].getAttribute("data-gid");null!=e?zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return E(e)}}).done(function(a){a.card.show()}):_zm.succErrMsg("e",zcal.i18n.selectagroup)});var r=e.find("[data-marker=subToCal]").removeAttr("data-marker");return r.length&&r.on("click",function(a){var e=$("#zcl_subLink")[0].value.trim();if(""==e)return _zm.succErrMsg("e",zcal.i18n.entervalidhttpurl),$("#zcl_subLink")[0].focus(),!1;/^(http|webcal)(s?)\:\/\/[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*(:(0-9)*)*(\/?)([a-zA-Z0-9\-\.\?\,\:\'\/\\\+=&amp;%\$\*\]\[#_@]*)?$/.test(e)?S(e):(_zm.succErrMsg("e",zcal.i18n.entervalidhttpurl),$("#zcl_subLink")[0].value="",$("#zcl_subLink")[0].focus())}),a}},"MailSuite.Apps.CalendarSubscribe"),_defineSettingsModule("Subscribe",function(a,e){"use strict";function t(){return e("MailSuite.Apps.CalendarSubscribe.SubscribeView")}function i(){var a,e=d.makeDeferred();return $.Deferred(),"undefined"==typeof zcal?(a=$.Deferred(),zmApp.loadCalendar("/calendar/settings",a),a.promise()).done(function(){t().initialize({process:e})}).fail(e.reject):t().initialize({process:e}),e.promise()}function l(){var a=d.makeDeferred();return t.uninitialize({process:a}),a.promise()}function s(){return t().getSubscribeView()}function n(){return null}var c,r=e("Platform.Components").SettingAppManager,d=e("Platform.System.Utils");c=r.create("calendar-subscribe",{attributes:{page:"calendar-subscribe",isReactApp:!1},initialize:i,uninitialize:l,getView:s,handleContainerEvent:n}),a.App=c},"MailSuite.Apps"),function(a){"use strict";var e="calendar-subscribe",t="calendar-subscribe",i="web-url",l="friends-calendar",s="holi-day",n="groups",c={cardItem:{title:"Web URL"}},r={cardItem:{title:"Friends Calendar"}},d={cardItem:{title:"HoliDays"}},o={cardItem:{title:"Groups"}},p=a("Platform.Components"),m=a("Platform.Entities"),u=(a("MailSuite.Settings.Calendar"),a("Platform.System.Utils"),p.SettingCardItemManager),v=m.SettingCardItem.Types;u.create(i,{props:{title:c.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:u.CardItemActions.OpenPageAction(t,{showSection:i})}),u.create(l,{props:{title:r.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:u.CardItemActions.OpenPageAction(t,{showSection:l})}),u.create(s,{props:{title:d.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:u.CardItemActions.OpenPageAction(t,{showSection:s})}),u.create(n,{props:{title:o.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:u.CardItemActions.OpenPageAction(t,{showSection:n})})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,e){"use strict";var t="calendar-sync",i=e("Platform.Components"),l=e("Platform.Entities"),s=i.SettingPageManager,n=l.SettingPage.Types,c=s.create(t,{props:{title:"Sync"},attributes:{card:t,category:"calendar",type:n.Title,pageCSSClass:"calendar-sync-page",appContainer:!0}});a.CalendarSync=c},"MailSuite"),_defineSettingsModule("Cards",function(a,e){"use strict";var t=e("Platform.Components").SettingCardManager,i=t.create("calendar-sync",{props:{openable:!0,title:"Synchronize",addToSearch:!1},state:{hidden:!1},attributes:{category:"calendar"},openAction:t.CardActions.OpenPageAction("calendar-sync")});a.CalendarSync=i},"MailSuite"),_defineSettingsModule("SyncView",function(a,e){"use strict";var n=[],c=0,r=function(a){if("caldav"===a)z();else if("gcal"===a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return i()}}).done(function(a){a.card.show()})}else if("outlook"===a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return t()}}).done(function(a){a.card.show()})}else"zcalsync"===a&&C()},t=function(){var a=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),e=$('<div class="SC_ptit"><div><div class="impExpHeading">'+ZCL_replaceProName(zcal.i18n.ms_title)+"</div></div></div>"),t=$('<div id="zmsdialogcont_zcl_olpp" class="SC_PUcen" style="max-height: 337px;"></div>'),i="";return i+='<div id="zcl_olpp">',i+='<div class="SC_PUcen zcl_ovr" style="max-height: 551px;">',i+='<ul class="SC_cal_groups">',i+='<li><div id="zcl_olbtn" class="SC_PUbtm" style="display: inline-block;float: right;padding-top: 0;"><a title='+ZCL_replaceComName(zcal.i18n.outlooktitle64)+" href= "+zcal.OUTLOOK64+' class="SC_lnk"><span>Download</span></a></div><span>'+ZCL_replaceComName(zcal.i18n.outlooktitle64)+"<s>Beta</s></span><em>("+ZCL_replaceProName(zcal.i18n.outlooksubtitle64)+")</em></li>",i+='<li><div id="zcl_olbtn" class="SC_PUbtm" style="display: inline-block;float: right;padding-top: 0;"><a title='+ZCL_replaceComName(zcal.i18n.outlooktitle32)+" href= "+zcal.OUTLOOK32+' class="SC_lnk"><span>Download</span></a></div><span>'+ZCL_replaceComName(zcal.i18n.outlooktitle32)+"<s>Beta</s></span><em>("+ZCL_replaceProName(zcal.i18n.outlooksubtitle32)+")</em></li>",i+="</ul>",i+="<p>"+zcal.i18n.mssync_help_link+"</p>",i+="</div>",i+="</div>",t.append($(i)),t.find("a").addClass("SC_lnk"),a.append(e),a.append(t),a},i=function(){h=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>');var a=$('<div class="SC_PUtt"><div><div class="impExpHeading">'+zcal.i18n.gcal+"</div></div></div>"),e=$('<div id="bt_div" class="SC_filt_bottom SC_filt_bottomCustom"></div>');return h.append(a),h.append(e),n&&0<n.length?l():ZCL_XHR("/cal/getGCal.do?mode=auth",function(a){(n=ZCL_Evl(1,a.responseText))?l():d(e)}),h},d=function(a){a.append('<div style="padding: 30px 20px 0;">'+zcal.i18n.gcalauthmsg+'</div><div style="padding: 30px 20px 0;"><i class="msi-uncheck" id="term_pol"></i>'+ZCL_replaceString(zcal.i18n.gcaltermspolicy,["<a href='https://policies.google.com/terms' class='zcl_lk' target='_blank' style='vertical-align: top;font-size: 14px;text-decoration:  none;' rel='noreferrer'>","<a href='https://policies.google.com/privacy' class='zcl_lk' target='_blank' style='vertical-align: top;font-size: 14px;text-decoration:  none;' rel='noreferrer'>"])+'</div><div class="SC_PUbtm"><span data-marker="gcal">'+zcal.i18n.authenticategcal+"</span></div>"),a.find(".msi-uncheck").on("click",function(a){"msi-uncheck"==a.target.className?a.target.className="msi-check":a.target.className="msi-uncheck"}),a.find("[data-marker=gcal]").removeAttr("data-marker").on("click",function(){"msi-uncheck"==a.find("#term_pol")[0].className?_zm.succErrMsg("e",zcal.i18n.autherrmsg):(window.newWindow=window.open("","","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=no,width=700,height=500,left=110px,top=10px"),ZCL_XHR("/cal/getGCal.do?mode=auth",function(a){n=ZCL_Evl(1,a.responseText),v()}))})},l=function(){var a=h.find("#bt_div"),e="";if(a.empty(),n&&0<n.length)for(var t=0;t<n.length;t++){var i=$('<div class="editFilterParent" id="zcl_gcallst"></div>');n[t].gcalName=n[t].gcalName.replace("<","&lt;").replace(">","&gt;"),e+='<div class="zmL" i><ul><li>',e+='<span id="zcl_synccal">'+n[t].gcalName+"</span>",-1==zcal.cdata.calOUids.indexOf("gCal_"+decodeURIComponent(n[t].gcalId))?e+='<li><div class="SC_PUbtm"><span data-val="Cancel" data-marker="sub">'+zcal.i18n.synchronize+"</span></div></li>":e+='<li><div class="SC_PUbtm"><span class="sel" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span></div></li>",e+="</li></ul></div>",1===c&&(i.addClass("zcl_disls"),e+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),i.html(e);var l=i.find("[data-marker=sub]").removeAttr("data-marker");l.length&&o(l,{gcalId:n[t].gcalId,gcalName:n[t].gcalName,authMail:n[t].authMail});var s=i.find("[data-marker=unsub]").removeAttr("data-marker");s.length&&u(s,{gcalId:n[t].gcalId,gcalName:n[t].gcalName,authMail:n[t].authMail})}else d(a);a.append(i)},o=function(a,e){a.off("click").on("click",{calid:e.gcalId,calname:e.gcalName,email:e.authMail},function(a){s(),ZCL_XHR("/cal/getGCal.do?mode=sub&calId="+a.data.calid+"&calName="+encodeURIComponent(a.data.calname)+"&ownerMailID="+a.data.email,m)})},s=function(){var a=$("#zcl_gcallst");p(1);var e=a.find(".zmL");0==a.find("#zcl_syncstatus").length&&e.append($('<li id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</li>")),a.find("#zcl_syncstatus").parent().addClass("zcl_disls"),e.find("span.button").off("click")},p=function(a){c=a},m=function(a){if(ZCL_clrStck(),200==a.status){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){var t=e.obj;zcal.cdata.calOLst=t.calOLst,zcal.cdata.calOUids=t.calOUids,zcal.cdata.calGLst=t.calGLst,zcal.cdata.calALst=t.calALst,ZCL_updateAppCalList(t.calALst),$.publish("/calendar/subscribed")}}},u=function(a,e){a.off("click").on("click",{calid:e.gcalId,calname:e.gcalName},function(a){ZCL_XHR("/cal/getGCal.do?mode=unsub&calId="+a.data.calid+"&calName="+encodeURIComponent(a.data.calname),function(a){var e=ZCL_Evl(1,a.responseText);"success"==e.status&&(c=0,n=null,$.publish("/calendar/deleted",{calid:e.id,caluid:e.uid,mode:"delete"}),l())})})},v=function(){if(n)l();else{var t=document.location.protocol+"//"+zcal.ZCAL,a=function a(e){(e.origin||e.originalEvent.origin)===t&&(f(),e.source.close(),window.addEventListener?window.removeEventListener("message",a,!1):window.detachEvent("onmessage",a))};window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent("onmessage",a);document.body.offsetHeight,document.body.offsetWidth;var e="GoogleAuthenticationWindow_"+location.hostname.split(".")[0];newWindow.location.href=zcal.GCALSYNC,newWindow.name=e}},f=function(){ZCL_XHR("/cal/getGCal.do?mode=list",function(a){n=ZCL_Evl(1,a.responseText),v()})},z=function(){ZCL_XHR("/cal/caldavCalLst.do?mode=callist",function(a){var e=ZCL_Evl(1,a.responseText);zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return g(e,"my")}}).done(function(a){a.card.show()})})},h=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),g=function t(a,e){zcal.caldavList=a,h.empty();var i=-1!=zcal.ZCAL.indexOf("skydesk.jp")?zcal.i18n.caldav_help:zcal.i18n.caldav+'&nbsp;<a class="SC_lnk" href="https://'+zcal.ZOHOSTATIC+'/help/caldav-sync-zoho-calendar.html#CalDAV" target="_blank">(?)</a>',l=$('<div class="SC_PUtt"><div><div class="impExpHeading">'+i+"</div></div></div>"),s=$('<div class="filterTopMenu"><ul class="SCS_tab"><li class="'+("my"==e?"stSel":"")+'" id="myCal">My Calendars</li></ul></div>');0<Object.keys(a[1]).length&&s[0].childNodes[0].append($('<li id="othCal" class="'+("oth"==e?"stSel":"")+'">Other Calendars</li>')[0]),0<Object.keys(a[2]).length&&s[0].childNodes[0].append($('<li id="grpCal" class="'+("grp"==e?"stSel":"")+'">Group Calendars</li>')[0]);var n=$('<div id="zmsdialogcont_zcl_caldav_pp" class="SC_PUcen"></div>'),c=$('<div id="zcl_caldav_pp"><div><div class="SC_filt_bottom zcl_cdavovr" style="display: block;"><div class="SC_cal_groups"><ul></ul></div></div></div></div>');if("my"==e)for(var r in a[0]){var d=a[0][r],o=ZCL_getHTML(d.NAME),p=1==d.SHOWHIDE,m=d.CALID,u=1==d.ISDEF,v=1==d.SYNC;if(zcal.cdata.calLst[m]){var f=$('<li id="'+(u?"ownCal":"othCal")+'" class="'+(p?"":"disable")+'">'+(u?"":'<i class="'+(v?"msi-check":"msi-uncheck")+'"></i>')+"<span>"+o+"</span></li>");u||f.off("click").on("click",{calid:m},function(a){var e,i,t=a.data.calid;"msi-uncheck"==(e=$(this).find("i"))[0].className?e.removeClass("msi-uncheck").addClass("msi-check"):e.removeClass("msi-check").addClass("msi-uncheck"),i="msi-check"==e[0].className?"enable":"disable",ZCL_XHR("/cal/enablecaldav.do?mode="+i+"&calid="+t,function(a){var e=ZCL_Evl(1,a.responseText).id;for(var t in zcal.caldavList[0])zcal.caldavList[0][t].CALID==e&&(zcal.caldavList[0][t].SYNC="enable"==i?1:0)})})}c.find("ul").append(f)}else if("oth"==e){for(var r in a[1]){d=a[1][r],o=ZCL_getHTML(d.NAME),p=1==d.SHOWHIDE,m=d.CALID,u=1==d.ISDEF,v=1==d.SYNC;if(zcal.cdata.calOLst[m]){f=$('<li id="'+(u?"ownCal":"othCal")+'" class="'+(p?"":"disable")+'">'+(u?"":'<i class="'+(v?"msi-check":"msi-uncheck")+'"></i>')+"<span>"+o+"</span></li>");u||f.off("click").on("click",{calid:m},function(a){var e,i,t=a.data.calid;"msi-uncheck"==(e=$(this).find("i"))[0].className?e.removeClass("msi-uncheck").addClass("msi-check"):e.removeClass("msi-check").addClass("msi-uncheck"),i="msi-check"==e[0].className?"enable":"disable",ZCL_XHR("/cal/enablecaldav.do?mode="+i+"&calid="+t,function(a){var e=ZCL_Evl(1,a.responseText).id;for(var t in zcal.caldavList[1])zcal.caldavList[1][t].CALID==e&&(zcal.caldavList[1][t].SYNC="enable"==i?1:0)})})}c.find("ul").append(f)}c[0].insertBefore($('<div class="zcl_grey" style="padding: 15px 30px 0;">Other Calendars will be synced in read-only mode.</div>')[0],c[0].firstChild)}else if("grp"==e)for(var r in a[2]){d=a[2][r],o=ZCL_getHTML(d.NAME),p=1==d.SHOWHIDE,m=d.CALID,u=1==d.ISDEF,v=1==d.SYNC;if(zcal.cdata.calGLst[m]){f=$('<li id="'+(u?"ownCal":"othCal")+'" class="'+(p?"":"disable")+'">'+(u?"":'<i class="'+(v?"msi-check":"msi-uncheck")+'"></i>')+"<span>"+o+"</span></li>");u||f.off("click").on("click",{calid:m},function(a){var e,i,t=a.data.calid;"msi-uncheck"==(e=$(this).find("i"))[0].className?e.removeClass("msi-uncheck").addClass("msi-check"):e.removeClass("msi-check").addClass("msi-uncheck"),i="msi-check"==e[0].className?"enable":"disable",ZCL_XHR("/cal/enablecaldav.do?mode="+i+"&calid="+t,function(a){var e=ZCL_Evl(1,a.responseText).id;for(var t in zcal.caldavList[2])zcal.caldavList[2][t].CALID==e&&(zcal.caldavList[2][t].SYNC="enable"==i?1:0)})})}c.find("ul").append(f)}return n.append(c),h.append(l),s&&(s.on("click",function(a){if("myCal"==a.target.id){var e=a.target;$(e.parentNode).find("li").removeClass("stSel"),$(e).addClass("stSel"),t(zcal.caldavList,"my")}else if("othCal"==a.target.id){e=a.target;$(e.parentNode).find("li").removeClass("stSel"),$(e).addClass("stSel"),t(zcal.caldavList,"oth")}else if("grpCal"==a.target.id){e=a.target;$(e.parentNode).find("li").removeClass("stSel"),$(e).addClass("stSel"),t(zcal.caldavList,"grp")}}),h.append(s)),h.append(n),h},C=function(){var a="https://"+zcal.ZOHOSTATIC+"/help/zoho-calsync-android.html";window.open(a,"_blank")};a.initialize=function(a){(a=a||{}).process.resolve()},a.uninitialize=function(a){(a=a||{}).process.resolve()},a.getSyncView=function(){zcal.cdata.opt;var a,e=(a={},-1!=zcal.ZCAL.indexOf("zoho")&&-1==zcal.ZCAL.indexOf("zoho.com.cn")&&-1==zcal.ZCAL.indexOf("baihui")&&-1==zcal.ZCAL.indexOf("zoho.in")&&-1==zcal.ZCAL.indexOf("zoho.com.au")&&(a.outlook={text:zcal.i18n.outlook,msg:zcal.i18n.ms_subtitle,type:"outlook"}),-1==zcal.ZCAL.indexOf("zoho.com.cn")&&-1==zcal.ZCAL.indexOf("baihui")&&(a.gcal={text:zcal.i18n.gcal,msg:zcal.i18n.gcal_subtitle,type:"gcal"}),a.caldav={text:zcal.i18n.caldav,msg:ZCL_replaceProName(zcal.i18n.cald_subtitle),type:"caldav"},-1==zcal.ZCAL.indexOf("zoho.com.cn")&&-1==zcal.ZCAL.indexOf("baihui")&&-1!=zcal.ZCAL.indexOf("zoho")&&(a.zcalsync={text:ZCL_replaceComName(zcal.i18n.zcalsync),msg:ZCL_replaceProName(zcal.i18n.zcalsync_subnote),type:"zcalsync"}),a),t=$('<li class="SC_setbox zcl_setbox"></li>'),i=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),l=$('<div class="SC_filt_bottom SC_filt_bottomCustom"></div>');for(var s in e){var n=e[s],c=$("<div class='zmL'></div>");c.html("<ul><li><span>"+n.text+"</span><em>"+n.msg+"</em></li></ul>"),c.on("click",{type:n.type},function(a){r(a.data.type)}),l.append(c)}return i.append(l),t.append(i),t},a.openOutlookCard=t,a.openCalDAVCard=z,a.openGCalCard=i,a.setGCalSyncStatus=p,a.listGCal=l,a.openSyncCard=r},"MailSuite.Apps.CalendarSync"),_defineSettingsModule("Sync",function(a,e){"use strict";function t(){return e("MailSuite.Apps.CalendarSync.SyncView")}function i(){var a,e=d.makeDeferred();return $.Deferred(),"undefined"==typeof zcal?(a=$.Deferred(),zmApp.loadCalendar("/calendar/settings",a),a.promise()).done(function(){t().initialize({process:e})}).fail(e.reject):t().initialize({process:e}),e.promise()}function l(){var a=d.makeDeferred();return t.uninitialize({process:a}),a.promise()}function s(){return t().getSyncView()}function n(){return null}var c,r=e("Platform.Components").SettingAppManager,d=e("Platform.System.Utils");c=r.create("calendar-sync",{attributes:{page:"calendar-sync",isReactApp:!1},initialize:i,uninitialize:l,getView:s,handleContainerEvent:n}),a.App=c},"MailSuite.Apps"),function(a){"use strict";var e="calendar-sync",t="calendar-sync",i="microsoft-outlook",l="google-calendar",s="cal-dav",n="zoho-calsync",c={cardItem:{title:"Microsoft Outlook"}},r={cardItem:{title:"Google Calendar"}},d={cardItem:{title:"CalDAV"}},o={cardItem:{title:"Zoho CalSync - Android"}},p=a("Platform.Components"),m=a("Platform.Entities"),u=(a("MailSuite.Settings.Calendar"),a("Platform.System.Utils"),p.SettingCardItemManager),v=m.SettingCardItem.Types,f=function(){var a;a="https://"+zcal.ZOHOSTATIC+"/help/zoho-calsync-android.html",window.open(a,"_blank")};if(!zmail.isFuji&&!zmail.isBaihui&&-1==document.domain.indexOf("zoho.in"))u.create(i,{props:{title:c.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:function(){u.CardItemActions.OpenPageAction(t),zmail.Settings.MailSuite.App.openApp().done(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage(t).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarSync.SyncView;e.requestPreviewCard({getView:function(){return a.openOutlookCard()}}).done(function(a){a.card.show()})}).fail(function(){})})}});if(!zmail.isBaihui)u.create(l,{props:{title:r.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:function(){u.CardItemActions.OpenPageAction(t),zmail.Settings.MailSuite.App.openApp().done(function(){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage(t).done(function(){zmail.Settings.MailSuite.Apps.CalendarSync.SyncView.openSyncCard("gcal")}).fail(function(){})})}});u.create(s,{props:{title:d.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:function(){u.CardItemActions.OpenPageAction(t),zmail.Settings.MailSuite.App.openApp().done(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage(t).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarSync.SyncView;e.requestPreviewCard({getView:function(){return a.openCalDAVCard()}}).done(function(a){a.card.show()})}).fail(function(){})})}});if(!zmail.isFuji&&!zmail.isBaihui)u.create(n,{props:{title:o.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:function(){f()}})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,e){"use strict";var t="calendar-zohoapp",i=e("Platform.Components"),l=e("Platform.Entities"),s=i.SettingPageManager,n=l.SettingPage.Types,c=s.create(t,{props:{title:"Zoho Apps"},attributes:{card:t,category:"calendar",type:n.Title,pageCSSClass:"calendar-zohoapp-page",appContainer:!0}});a.CalendarZohoApp=c},"MailSuite"),_defineSettingsModule("Cards",function(a,e){"use strict";var t=e("Platform.Components").SettingCardManager;if(!zmail.isRebranded)var i=t.create("calendar-zohoapp",{props:{openable:!0,title:"Zoho Apps",addToSearch:!1},state:{hidden:!1},attributes:{category:"calendar"},openAction:t.CardActions.OpenPageAction("calendar-zohoapp")});a.CalendarZohoApp=i},"MailSuite"),_defineSettingsModule("ZohoappView",function(a,e){"use strict";var n,c,r,d,l,s,o,p,i={},m=function(e,a){o=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>');var t=$('<div class="SC_ptit"><div><div class="impExpHeading">'+a+"</div></div></div>"),i=$('<div class="SC_filt_bottom SC_filt_bottomCustom" id="btDiv"></div>');o.append(t),o.append(i);return"recruit"==e?d&&0:"crm"==e?n&&0:"task-sync"==e?c&&0:"project"==e?l&&0:"contacts"==e&&s&&0,p||(p=$.Deferred(),ZCL_uXHR("/cal/getPortal.do?mode="+e,function(a){p.resolve(a),u(e,a)})),p.done(function(){p=""}),o},u=function(a,e){if("crm"==a)if((n=n||ZCL_Evl(1,e.responseText)).obj&&-1!=Object.keys(n.obj).indexOf("isOrgAdmin")&&n.obj.isOrgAdmin||n.obj&&-1==Object.keys(n.obj).indexOf("isOrgAdmin")&&("in-process"==n.status||"success"==n.status))v();else{i.crm="error";var t="503"==n.status?zcal.i18n.subscribeunavailable:"sync-noperm"==n.status?ZCL_replaceComName(zcal.i18n.crmcal_noperm):n.obj&&-1!=Object.keys(n.obj).indexOf("isOrgAdmin")&&!n.obj.isOrgAdmin?zcal.i18n.initiate_sync_msg:ZCL_replaceComName(zcal.i18n.noacc_inzohocrm);C(t)}else if("task-sync"==a)if("in-process"==(c=c||ZCL_Evl(1,e.responseText)).status||"success"==c.status)z();else{i.task="error";t="503"==c?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzohotask);C(t)}else if("project"==a)if("503"!=(l=l||ZCL_Evl(1,e.responseText)).obj&&"Empty result set"!=l.obj&&"error"!=l.obj&&"Noportals"!=l.obj)r=l.obj,g();else{i.project="error";t="503"==l.obj?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzohopro);C(t)}else if("contacts"==a)if("ok"==(s=s||ZCL_Evl(1,e.responseText)).status)h();else{i.contacts="error";t="503"==s?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzohocont);C(t)}else if("recruit"==a){if("new"==(d=d||ZCL_Evl(1,e.responseText)).obj.VERSION)if("in-process"==d.status||"success"==d.status)f();else{i.recruit="error";t="503"==d.obj?zcal.i18n.subscribeunavailable:"sync-noperm"==d.obj?ZCL_replaceComName(zcal.i18n.recruitcal_noperm):ZCL_replaceComName(zcal.i18n.noacc_inzohorecruit);C(t)}else if("503"!=d.obj&&"error"!=d.obj)f();else{i.recruit="error";t="503"==d.obj?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzohorecruit);C(t)}}},v=function(){var i=o.find("#btDiv"),a="";i.empty();var e=$('<div class="editFilterParent"></div>');a+='<div class="zmL"><ul><li><span id="zcl_synccal">'+ZCL_replaceComName(zcal.i18n.crmcal)+"<span></li>",-1==zcal.cdata.calOUids.indexOf("zohoCrm_")?a+='<li><div class="SC_PUbtm"><span rel="enable" data-val="Cancel" data-marker="sub">'+zcal.i18n.synchronize+"</span></div></li>":a+='<li><div class="SC_PUbtm"><span rel="enable" data-val="sel" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span></div></li>",a+="</ul></div>",a+=n.obj.isOrgAdmin?"<div><b>Note: </b>"+zcal.i18n.token_gen_note+"</div>":"","in-process"==n.status&&(e.addClass("zcl_disls"),a+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),e.html(a);var t=e.find("[data-marker=sub]").removeAttr("data-marker");t.length&&t.off("click").on("click",{soid:n.obj.ZSOID},function(a){var e,t;"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),t=(e=i).find("#zcl_synccal"),0==e.find("#zcl_syncstatus").length&&t.after($('<em id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</em>")),e.find("#zcl_syncstatus").parent().addClass("zcl_disls"),t.find("span.button").off("click"),ZCL_XHR("/cal/subCal.do?mode=crm-sync&crmid="+a.data.soid,_))});var l=e.find("[data-marker=unsub]").removeAttr("data-marker");if(l.length){var s=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoCrm_"));s=-1!=s.indexOf(",")?s.substring(0,s.indexOf(",")):s,l.on("click",{uid:s,mode:"crm"},function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),S(a.data.uid,a.data.mode))})}i.append(e)},f=function(){var a=o.find("#btDiv"),e=d.obj.VERSION;a.empty();var t=$('<div class="editFilterParent"></div>'),i="";i+='<div class="zmL"><ul><li><span id="zcl_synccal">'+ZCL_replaceComName(zcal.i18n.recruitcal)+"<span></li>","new"==e?-1==zcal.cdata.calOUids.indexOf("zohoRecruit4_")?i+='<li><div class="SC_PUbtm"><span rel="enable" data-val="Cancel" data-marker="sub">'+zcal.i18n.synchronize+"</span></div></li>":i+='<li><div class="SC_PUbtm"><span rel="enable" data-val="sel" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span></div></li>":-1==zcal.cdata.calOUids.indexOf("zohoRecruit_")?i+='<li><div class="SC_PUbtm"><span rel="enable" data-val="Cancel" data-marker="sub">'+zcal.i18n.subscribe+"</span></div></li>":i+='<li><div class="SC_PUbtm"><span rel="enable" data-val="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span></div></li>",i+="</ul></div>",t.html(i);var l=t.find("[data-marker=sub]").removeAttr("data-marker");l.length&&l.off("click").on("click",{soid:d.obj.ZSOID},function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),ZCL_XHR("/cal/subCal.do?mode=recruitcal-sub&recid="+a.data.soid,b))});var s=t.find("[data-marker=unsub]").removeAttr("data-marker");if(s.length){var n=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoRecruit"));n=-1!=n.indexOf(",")?n.substring(0,n.indexOf(",")):n,s.on("click",{uid:n,mode:"recruit"},function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),S(a.data.uid,a.data.mode))})}a.append(t)},z=function(){var a=o.find("#btDiv"),e="";a.empty();var t=$('<div class="editFilterParent"></div>');e+='<div class="zmL"><ul><li><span>'+ZCL_replaceComName(zcal.i18n.zohotask)+"<span></li>",-1==zcal.cdata.calOUids.indexOf("zohoTask_")?e+='<li><div class="SC_PUbtm"><span rel="enable" data-val="Cancel" data-marker="sub">'+zcal.i18n.synchronize+"</span></div></li>":e+='<li><div class="SC_PUbtm"><span rel="enable" data-val="sel" data-marker="unsub">'+(c.isOldTaskSubscribed?zcal.i18n.unsubscribe:zcal.i18n.unsynchronize)+"</span></div></li>",e+="</ul></div>","in-process"==c.status&&(t.addClass("zcl_disls"),e+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),t.html(e);var i=t.find("[data-marker=sub]").removeAttr("data-marker");i.length&&i.on("click",function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),ZCL_XHR("/cal/subCal.do?mode=task-sync",b))});var l=t.find("[data-marker=unsub]").removeAttr("data-marker");if(l.length){var s=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoTask_"));s=-1!=s.indexOf(",")?s.substring(0,s.indexOf(",")):s,l.on("click",{uid:s,mode:"task"},function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),S(a.data.uid,a.data.mode))})}a.append(t)},h=function(){var a=o.find("#btDiv"),e="";a.empty();var t=$('<div class="editFilterParent"></div>');e+='<div class="zmL"><ul><li><span>'+zcal.i18n.contactscal+"<span></li>",-1==zcal.cdata.calOUids.indexOf("zohoContacts_")?e+='<li><div class="SC_PUbtm"><span rel="enable" data-val="Cancel" data-marker="sub">'+zcal.i18n.subscribe+"</span></div></li>":e+='<li><div class="SC_PUbtm"><span rel="enable" data-val="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span></div></li>",e+="</ul></div>",t.append(e);var i=t.find("[data-marker=sub]").removeAttr("data-marker");i.length&&i.on("click",function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),ZCL_XHR("/cal/subCal.do?mode=contactcal-sub",b))});var l=t.find("[data-marker=unsub]").removeAttr("data-marker");if(l.length){var s=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoContacts_"));s=-1!=s.indexOf(",")?s.substring(0,s.indexOf(",")):s,l.on("click",{uid:s,mode:"contacts"},function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),S(a.data.uid,a.data.mode))})}a.append(t)},g=function(){var a=o.find("#btDiv"),e=r;a.empty();var t=$('<div class="editFilterParent"></div>');for(var i in e){var l,s=$('<div class="zmL"/>');l="<ul><li><span>"+ZCL_getHTML(e[i].portal)+"<span></li>",-1==zcal.cdata.calOUids.indexOf("zohoProject_"+e[i].portal_zoid)?l+='<li><div class="SC_PUbtm"><span rel="enable" data-val="Cancel" data-marker="sub" >'+zcal.i18n.subscribe+"</span></div></li>":l+='<li><div class="SC_PUbtm"><span rel="enable" data-val="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span></div></li>",l+="</ul>",s.html(l);var n=s.find("[data-marker=sub]").removeAttr("data-marker");n.length&&n.on("click",{portal:e[i].portal,portalid:e[i].portal_zoid},function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),ZCL_XHR("/cal/subCal.do?mode=project-sub&portal="+a.data.portal+"&portalId="+encodeURIComponent(a.data.portalid),b))});var c=s.find("[data-marker=unsub]").removeAttr("data-marker");c.length&&c.on("click",{uid:"zohoProject_"+e[i].portal_zoid,mode:"project"},function(a){"enable"==a.target.getAttribute("rel")&&(a.target.setAttribute("rel","disabled"),S(a.data.uid,a.data.mode))}),t.append(s)}a.append(t)},C=function(a){o.find("#btDiv").append("<div class='editFilterParent'><div class='zmL'><ul><li><span>"+a+"</span></li></ul></div></div></div></div>")},_=function(a){if(ZCL_clrStck(),200==a.status){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){if("sync-initiated"==e.sync_mode)"in-process"==e.sync_status?n.status=e.sync_status:(n.status="success",setTimeout(function(){_zm.succErrMsg("s",zcal.i18n.synccompmsg)},2e3));else if("success"==e.sync_status){n.status=e.sync_status;var t=e.obj;zcal.cdata.calOLst=t.calOLst,zcal.cdata.calOUids=t.calOUids,zcal.cdata.calGLst=t.calGLst,zcal.cdata.calALst=t.calALst,ZCL_updateAppCalList(t.calALst),setTimeout(function(){_zm.succErrMsg("s",zcal.i18n.synccompmsg)},2e3),zcalCRM.loadCRMUsers()}else"in-process"==e.sync_status?n.status=e.sync_status:setTimeout(function(){_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed))},2e3);v(),$.publish("/calendar/subscribed")}else setTimeout(function(){_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed))},2e3)}},b=function(a){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){var t=e.obj,i=e.mode;e.uid;zcal.cdata.calOLst=t.calOLst,zcal.cdata.calOUids=t.calOUids,zcal.cdata.calGLst=t.calGLst,zcal.cdata.calALst=t.calALst,ZCL_updateAppCalList(t.calALst),"contactcal-sub"===i?(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),h()):"project-sub"===i?(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),g()):"task-sync"===i?("completed"==e.sync_status?(c.status="success",_zm.succErrMsg("s",zcal.i18n.synccompmsg)):"in-process"==e.sync_status&&(c.status="in-process"),z()):"recruitcal-sub"==i&&(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),f()),$.publish("/calendar/subscribed")}},S=function(a,e){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),function(a){t(a,e)})},t=function(a,e){var t=ZCL_Evl(1,a.responseText);if("success"==t.status){var i=t.id,l=t.uid;$.publish("/calendar/deleted",{calid:i,caluid:l,mode:"unsubscribe"}),"contacts"===e?h():"project"===e?g():"task"===e?z():"crm"===e?v():"recruit"===e&&f()}else _zm.succErrMsg("e",t.status)};a.initialize=function(a){(a=a||{}).process.resolve()},a.uninitialize=function(a){(a=a||{}).process.resolve()},a.getZohoappView=function(){zcal.cdata.opt;var a={zcrm:{text:ZCL_replaceComName(zcal.i18n.zohocrmcal),msg:zcal.i18n.sync,type:"crm"},zrecruit:{text:ZCL_replaceComName(zcal.i18n.zohorecruitcal),msg:zcal.i18n.sync,type:"recruit"},ztask:{text:ZCL_replaceComName(zcal.i18n.zohotask),msg:zcal.i18n.sync,type:"task-sync"},zprojects:{text:ZCL_replaceComName(zcal.i18n.zohoprojects),msg:zcal.i18n.subscribe,type:"project"},zcontacts:{text:ZCL_replaceComName(zcal.i18n.zohocontactscal),msg:zcal.i18n.subscribe,type:"contacts"}},e=$('<li class="SC_setbox zcl_setbox"></li>'),t=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),i=$('<div class="SC_filt_bottom SC_filt_bottomCustom"></div>');for(var l in a){var s=a[l];if("crm"==s.type&&""!=zcal.ZCRM||"recruit"==s.type&&""!=zcal.ZRECRUIT||"task-sync"==s.type&&""!=zcal.ZTSK||"project"==s.type||"contacts"==s.type){var n=$("<div class='zmL'></div>");n.html("<ul><li><span>"+s.text+"</span><em>"+s.msg+"</em></li></ul>"),n.on("click",{type:s.type,txt:s.text},function(a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return m(a.data.type,a.data.txt)}}).done(function(a){a.card.show()})}),i.append(n)}}return t.append(i),e.append(t),e},a.openAppCalCard=m,a.setCrmSyncStatus=function(a){n.status=a},a.setCrmSyncFailedStatus=function(){n.status="success",_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed)),v()},a.listCrmCal=v},"MailSuite.Apps.CalendarZohoApp"),_defineSettingsModule("ZohoApps",function(a,e){"use strict";function t(){return e("MailSuite.Apps.CalendarZohoApp.ZohoappView")}function i(){var a,e=d.makeDeferred();return $.Deferred(),"undefined"==typeof zcal?(a=$.Deferred(),zmApp.loadCalendar("/calendar/settings",a),a.promise()).done(function(){t().initialize({process:e})}).fail(e.reject):t().initialize({process:e}),e.promise()}function l(){var a=d.makeDeferred();return t.uninitialize({process:a}),a.promise()}function s(){return t().getZohoappView()}function n(){return null}var c,r=e("Platform.Components").SettingAppManager,d=e("Platform.System.Utils");c=r.create("calendar-zohoapp",{attributes:{page:"calendar-zohoapp",isReactApp:!1},initialize:i,uninitialize:l,getView:s,handleContainerEvent:n}),a.App=c},"MailSuite.Apps"),function(a){"use strict";var e="calendar-zohoapp",t="calendar-zohoapp",i="zoho-crm",l="zoho-recruit",s="zoho-task",n="zoho-projects",c="zoho-contacts",r={cardItem:{title:"Zoho CRM"}},d={cardItem:{title:"Zoho Recruit"}},o={cardItem:{title:"Zoho Task"}},p={cardItem:{title:"Zoho Projects"}},m={cardItem:{title:"Zoho Contacts"}},u=a("Platform.Components"),v=a("Platform.Entities"),f=(a("MailSuite.Settings.Calendar"),a("Platform.System.Utils"),u.SettingCardItemManager),z=v.SettingCardItem.Types;if(!zmail.isRebranded){f.create(i,{props:{title:r.cardItem.title},attributes:{type:z.Action,card:e},primaryAction:function(){f.CardItemActions.OpenPageAction(t),zmail.Settings.MailSuite.App.openApp().done(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage(t).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;e.requestPreviewCard({getView:function(){return a.openAppCalCard("crm","Zoho CRM Calendar")}}).done(function(a){a.card.show()})}).fail(function(){})})}});if(!zmail.isFuji)f.create(l,{props:{title:d.cardItem.title},attributes:{type:z.Action,card:e},primaryAction:function(){f.CardItemActions.OpenPageAction(t),zmail.Settings.MailSuite.App.openApp().done(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage(t).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;e.requestPreviewCard({getView:function(){return a.openAppCalCard("recruit","Zoho Recruit Calendar")}}).done(function(a){a.card.show()})}).fail(function(){})})}});f.create(s,{props:{title:o.cardItem.title},attributes:{type:z.Action,card:e},primaryAction:function(){f.CardItemActions.OpenPageAction(t),zmail.Settings.MailSuite.App.openApp().done(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage(t).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;e.requestPreviewCard({getView:function(){return a.openAppCalCard("task-sync","Zoho Task")}}).done(function(a){a.card.show()})}).fail(function(){})})}}),f.create(n,{props:{title:p.cardItem.title},attributes:{type:z.Action,card:e},primaryAction:function(){f.CardItemActions.OpenPageAction(t),zmail.Settings.MailSuite.App.openApp().done(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage(t).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;e.requestPreviewCard({getView:function(){return a.openAppCalCard("project","Zoho Projects")}}).done(function(a){a.card.show()})}).fail(function(){})})}}),f.create(c,{props:{title:m.cardItem.title},attributes:{type:z.Action,card:e},primaryAction:function(){f.CardItemActions.OpenPageAction(t),zmail.Settings.MailSuite.App.openApp().done(function(){var e=zmail.Settings.MailSuite.App.Core.Framework;e.requestShowPage(t).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;e.requestPreviewCard({getView:function(){return a.openAppCalCard("contacts","Zoho Contacts (Birthday Calendar)")}}).done(function(a){a.card.show()})}).fail(function(){})})}})}}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,e){"use strict";var t="calendar-mgaocalendars",i=e("Platform.Components"),l=e("Platform.Entities"),s=i.SettingPageManager,n=l.SettingPage.Types,c=s.create(t,{props:{title:"Calendars"},attributes:{card:t,category:"calendar",type:n.Title,pageCSSClass:"calendar-mgaocalendars-page",appContainer:!0}});a.CalendarMGAOCalendars=c}),_defineSettingsModule("Cards",function(a,e){"use strict";var t=e("Platform.Components").SettingCardManager,i=t.create("calendar-mgaocalendars",{props:{openable:!0,title:"Calendars",addToSearch:!1},state:{hidden:!1},attributes:{category:"calendar"},openAction:t.CardActions.OpenPageAction("calendar-mgaocalendars")});a.CalendarMGAOCalendars=i},"MailSuite"),_defineSettingsModule("MGAOCalendarsView",function(a,e){"use strict";function t(){for(var a=$('<div class="filterTopMenu"><ul class="SCS_tab"><li class="stSel" id="myCal">'+zcal.i18n.mycalendars+"</li>"+(ZCL_GRP_SECTION?'<li id="grpCal">'+zcal.i18n.groupcalendars+"</li>":"")+'<li id="appCal">'+zcal.i18n.appcalendars+'</li><li id="othCal">'+zcal.i18n.othercalendars+"</li></ul></div>"),e=$('<div><div class="zcl_Twpr_Callist"><div class="SC_filt_bottom SC_filt_bottomCustom"  id="topB"><div class="zmL SC_filt_bld"><ul class="bld"><li></li><li>'+zcal.i18n.calname+"</li><li>"+zcal.i18n.action+'</li> <li class="conditions">'+zcal.i18n.status+'</li></ul></div></div><div class="SC_Twpr zcl_Twpr_Callist zcl_setsrl"> <div class="SC_filt_bottom SC_filt_bottomCustom" id="listCal"></div></div></div></div>');z[0].firstChild;)z[0].removeChild(z[0].firstChild);return z.append(a),z.append(e),i=zcal.cdata.calOrdArr,l=zcal.cdata.calLst,i.forEach(function(a){l[a]&&c(a,l[a])}),a.find("#grpCal").on("click",function(a){var e=d(a);z.append(e)}),a.find("#myCal").on("click",function(a){var e=$(this);e.parent().find("li").removeClass("stSel"),e.addClass("stSel");t()}),a.find("#appCal").on("click",function(a){var e=p();z.append(e)}),a.find("#othCal").on("click",function(a){var e=u();z.append(e)}),z}function f(a){var e,t;t=1!=(e=zcal.getCalObj(a))[2],s(a,t,e)}var i,l,z=$('<div data-reactroot class="SC_setbox zcl_setbox zcl_setboxgpls"></div>'),n=function(a,e){if("groups"==a)0==z.find("#listCal")[0].childNodes.length&&(z.find("#listCal").html('<div class="startup help zcl_mb">'+zcal.i18n.nocalendar_msg+"</div>"),t=z.find("#listCal").find("a"),$("#topB").empty(),t.off("click").on("click",function(a){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage("calendar-subscribe",{}).done(function(){}).fail(function(){})}));else if("apps"==a){if(0==z.find("#listCal")[0].childNodes.length)z.find("#listCal").html('<div class="startup help zcl_mb">'+zcal.i18n.noappcal+"</div>"),$("#topB").empty()}else if("other"==a){var t;if(0==z.find("#listCal")[0].childNodes.length)z.find("#listCal").html('<div class="startup help zcl_mb">'+zcal.i18n.nocalendar_msg+"</div>"),$("#topB").empty(),(t=z.find("#listCal").find("a")).off("click").on("click",function(a){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage("calendar-subscribe",{}).done(function(){}).fail(function(){})})}else if("del"==a){if($("#zcl_callist")[0]&&$("#zcl_callist")[0].getAttribute("rel")==e)zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard().done(function(a){a.close()}).fail(function(){})}},s=function(e,t,i){ZCL_XHR("/cal/calAct.do?mode=en-dis&calid="+e+"&isen="+t,function(a){"success"==ZCL_Evl(1,a.responseText).status&&(i[2]=t?"1":"0",$.publish("/calendar/statusChanged",{calid:e,sts:i[2]}))})},c=function(a,s){var e,t,i,l,n,c=$('<div id="d" class="zmL '+(1==s[8]?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),r=ZCL_getCalColor(s[1])[1],d=ZCL_getHTML(s[0]),o=$('<li><div style="background-color:'+r+'" class="SClbl"><i class="'+(1==s[2]?"msi-tick":"")+'"></i></div></li>');o.find(".SClbl").off("click").on("click",{calid:a},function(a){var e=a.data.calid;f(e)}),c.find("ul").append(o);var p=$('<li><strong class="filterControl">'+d+"</strong></li>");h(p,a,s,"my"),c.find("ul").append(p);var m=$('<li class="filterControl"><b></b></li>');n=m.find("b"),"0"==zcal.shrCal&&"0"==zcal.pvtUrl||((e=$('<span data-id="sh">'+zcal.i18n.share+"</span>")).off("click").on("click",{calid:a,cobj:s},function(a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return b(a.data.calid,a.data.cobj,"my")}}).done(function(a){a.card.show()})}),n.append(e)),"0"!=zcal.impExp&&1==s[13][2]&&((t=$('<span data-id="exp">'+zcal.i18n.exports+"</span>")).off("click").on("click",{calid:a,ckey:s[9]},function(a){!(!zmAdHocSettings||!zmAdHocSettings.getSecuredownload||"1"!==zmAdHocSettings.getSecuredownload())?ZCL_secureDow("export",a.data.ckey):ZCL_formSubmit({ckey:a.data.ckey,mode:"calexp"},"/cal/export.do","GET")}),n.append(t)),1==s[13][3]&&((i=$('<span data-id="emp">'+zcal.i18n.empty+"</span>")).off("click").on("click",{calid:a},function(a){var e=a.data.calid;ZCL_empCal(e)}),n.append(i)),1==s[13][4]&&((l=$('<span data-id="del">'+zcal.i18n.del+"</span>")).off("click").on("click",{calid:a,ckey:s[9]},function(a){var e=a.data.calid;ZCL_delCal(e,!1,"my")}),n.append(l)),c.find("ul").append(m);var u=$('<li><div class="onoffButton" style="background-color: transparent !important;"></div></li>');if("false"==s[3]){var v=$("<div data-on="+zcal.i18n.on+" data-off="+zcal.i18n.off+">");0==s[8]?v.addClass("sdiv sadiv"):v.addClass("sdiv"),v.off("click").on("click",{calid:a},function(a){var t=$(this),i=t.parents(".zmL"),l=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+l+"&isshow="+!!t.hasClass("sadiv"),function(a){var e=ZCL_Evl(1,a.responseText);"success"==e.status?(s[8]=e.isshow?1:0,t.removeAttr("class").addClass(e.isshow?"sdiv inctop":"sdiv sadiv"),i.removeAttr("class").addClass(e.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:l,visibility:e.isshow}),e.isshow?zmUtil.succErrMsg("s",zcal.i18n.on_msg):zmUtil.succErrMsg("s",zcal.i18n.off_msg)):zmUtil.succErrMsg("e",e.message)})}),u.find(".onoffButton").append(v)}c.find("ul").append(u),z.find("#listCal").append(c)},h=function(a,e,t,i){a.on("click",{calid:e,cobj:t,ty:i},function(a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return r(a.data.calid,a.data.cobj,a.data.ty)}}).done(function(a){a.card.show()})})},g=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'  id='zcl_callist'></div>"),v=function(c,a){var r=$('<div id="calgrp" class="SC_Twpr zcl_Twpr" style="top:46px"><div class="SC_filt_bottom SC_filt_bottomCustom" id="zcl_gpmem"></div></div>');a?a.append(r):g.append(r);var d,o,p=zmComponent.loadingBand({container:g.find("#zcl_gpmem")[0]||a.find("#zcl_gpmem")[0],type:"pagination"}),m="";for(var e in zcal.cdata.calByGrp)for(var t in zcal.cdata.calByGrp[e])t==c&&(d=e);var u=[],v=[],f=[],z=!1;ZCL_uXHR("/cal/groups/"+d+"/getMembers",function(a){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){var t=e.members;for(var i in t)(t[i].isOwner||t[i].isModerator)&&zmail.zuid==t[i].zid&&(z=!0);for(var l in t)t[l].isOwner?u.push(t[l]):t[l].isModerator?v.push(t[l]):f.push(t[l])}var s=(o={grpId:d,members:f,owner:u,moderator:v,is_owner:z}).members.length+o.owner.length+o.moderator.length;for(var i in m+='<div class="editFilterParent zcl_stfrm"  style="height:'+($("#calgrp")[0].offsetHeight-20)+'px; overflow: auto;">',m+="<div>",m+='<input type="hidden" id="zcl_calid" value="'+(c||"")+'">',m+='<input type="hidden" id="zcl_calgid" value="'+(o.grpId?o.grpId:"")+'">',o.is_owner&&(m+='<div class="zcl_addcaltx"><b>'+zcal.i18n.members+'</b><span id="zcl_ad_att_eredit" style="color:#ff4e67;display:none;margin-left:10px">Add only org members</span></div>',m+='<div class="SC_sch" style="margin-bottom: 20px;position: relative;width:500px;" id="zcl_addsrhdiv"><i class="msi-search"></i>',m+='<input type="text" placeholder="'+zcal.i18n.add_memplahold+'" id="zcl_addsrhmem" style="width: 225px;">',m+="</div>"),m+='<div id="zcl_addmem_di" class="SC_PUcen"></div>',m+='<h4 id="isMem" style="">'+(1==s?"1 Person":s+" "+zcal.i18n.members)+"</h4>",m+='<div id="zcl_memdiv" class="SC_PUcen" style="min-height: 50px;width: 500px;">',m+='<ul class="SC_P2r P2rBlkGery viewMem SC_PhrTxt" id="zcl_memView" style="">',o.owner)m+='<li data-id="'+o.owner[i].zid+'" class="zm_mem_post loadPost" id='+o.owner[i].email+">",m+='<div class="SC_avtr">',m+='<img src="'+o.owner[i].photo+'">',m+="</div>",m+='<div><strong style="word-wrap:break-word;display: inline-block;max-width: 140px;white-space: normal;">'+ZCL_getHTML(o.owner[i].fname)+'</strong><i class="SC_Otxt">'+(o.owner[i].isOwner?zcal.i18n.owner:o.owner[i].isModerator?zcal.i18n.moderator:"")+"</i><span>"+o.owner[i].email+"</span>",m+="</div>",m+="</li>";for(var i in o.moderator)m+='<li data-id="'+o.moderator[i].zid+'" class="zm_mem_post loadPost" id='+o.moderator[i].email+">",m+='<div class="SC_avtr">',m+='<img src="'+o.moderator[i].photo+'">',m+="</div>",m+='<div><strong  style="word-wrap:break-word;display: inline-block;max-width: 140px;white-space: normal;">'+ZCL_getHTML(o.moderator[i].fname)+'</strong><i class="SC_Otxt">'+(o.moderator[i].isOwner?zcal.i18n.owner:o.moderator[i].isModerator?zcal.i18n.moderator:"")+"</i><span>"+o.moderator[i].email+"</span>",m+="</div>",o.is_owner&&o.moderator[i].zid!=zmail.zuid&&(m+='<div><div class="SCmb" onclick="ZCL_memper(event,\''+o.moderator[i].zid+'\')"><ul class="zm_action" data-tooltip="More actions"><li class=""><b><i class="msi-action"></i><div class="SC_hd"></div></b></li></ul></div></div>'),m+="</li>";for(var i in o.members)m+='<li data-id="'+o.members[i].zid+'" class="zm_mem_post loadPost" id='+o.members[i].email+">",m+='<div class="SC_avtr">',m+='<img src="'+o.members[i].photo+'">',m+="</div>",m+="<div><strong>"+ZCL_getHTML(o.members[i].fname)+'</strong><i class="SC_Otxt">'+(o.members[i].isOwner?zcal.i18n.owner:o.members[i].isModerator?zcal.i18n.moderator:"")+"</i><span>"+o.members[i].email+"</span>",m+="</div>",o.is_owner&&(m+='<div><div class="SCmb" onclick="ZCL_memper(event,\''+o.members[i].zid+'\')"><ul class="zm_action" data-tooltip="More actions"><li class=""><b><i class="msi-action"></i><div class="SC_hd"></div></b></li></ul></div></div>'),m+="</li>";m+="</ul></div>";var n=zcal.cdata.calGLst[c];2==n[13][4]&&(m+='<div class="zmMSgEdt"><div class="zm_grpAction zm_CA"><div class="zm_CATxt"><div class="zm_CATitle">'+zcal.i18n.del_grp+'</div><p style="margin-top: 10px;">'+zcal.i18n.del_grp_msg+'</p></div><div class="zm_CABtn"><span class="SC_thmBBtn SC_lnk deleteButton" id="zcl_delgrp">'+zcal.i18n.del_grp_btn+"</span></div></div></div>"),m+="</div></li>",r.find("#zcl_gpmem").append($(m)),C(),p(),r.find("#zcl_addsrhmem")[0].focus(),zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:r.find("#zcl_addsrhmem")[0],excludeMe:!0,contactType:["org"],exclude:function(){var a=[];if(r.find("#zcl_memView")[0].childNodes)for(var e in r.find("#zcl_memView")[0].childNodes){var t=r.find("#zcl_memView")[0].childNodes[e].id;t&&a.push(t)}return a},onSelect:function(a,e){e=e.item.attributes;_(e),r.find("#zcl_addsrhmem").val("")}}),r.find("#zcl_delgrp").on("click",function(){var a;for(var e in zcal.cdata.calByGrp)for(var t in zcal.cdata.calByGrp[e])t==c&&(a=e);k(a,n[0])})}),$("#zcl_addsrhmem").on("keydown",function(a){if(13==a.keyCode&&"zcl_addsrhmem"==this.id){for(var e=this.value.split(","),t=0;t<e.length;t++){var i=e[t].trim(),l=i.indexOf("<"),s=i.indexOf(">");-1<l&&-1<s&&(i=i.substring(l+1,s)),i=i.replace(/,/g,"")}if(ZCL_isEmail(i)){var n={promise:!1,eid:i,type:["org"]},c=zmail.ContactBook.get(n);if(c[0]&&c[0].isOrg);else ZCL_$("zcl_addsrhmem").parentNode.className="SC_sch zcl_cl_ad_er",ZCL_$("zcl_ad_att_eredit").style.display="",ZCL_$("zcl_ad_att_eredit").innerHTML="Add only org members"}$("#zcl_addsrhmem").val("")}}),$("#zcl_addsrhmem").on("focusout",function(){ZCL_$("zcl_addsrhmem").parentNode.className="SC_sch",ZCL_$("zcl_ad_att_eredit").style.display="none",ZCL_$("zcl_ad_att_eredit").innerHTML=""}),$("#zcl_addsrhmem").on("keypress",function(a){13!=a.keyCode&&(ZCL_$("zcl_addsrhmem").parentNode.className="SC_sch",ZCL_$("zcl_ad_att_eredit").style.display="none",ZCL_$("zcl_ad_att_eredit").innerHTML="")})}),window.onresize=function(){$(".zmMSgEdt")[0]&&C()}},C=function(){var a=$(".zcl_addcaltx")[0]?$(".zcl_addcaltx")[0].offsetHeight:0,e=$("#zcl_addsrhdiv")[0]?$("#zcl_addsrhdiv")[0].offsetHeight:0,t=$("#zcl_addmem_di")[0]?$("#zcl_addmem_di")[0].offsetHeight:0,i=$("#isMem")[0]?$("#isMem")[0].offsetHeight:0,l=$(".zmMSgEdt")[0]?$(".zmMSgEdt")[0].offsetHeight:0;$("#zcl_memdiv")[0].style.height=$("#calgrp")[0].offsetHeight-(a+e+t+i+l+117.2)+"px",$("#zcl_memdiv")[0].style.height=$("#zcl_memdiv")[0].style.height<"10px"?"10px":$("#zcl_memdiv")[0].style.height},_=function(s){var n=zmComponent.loadingBand({container:$("#zcl_addsrhdiv")[0],type:"pagination"});$("#zcl_addsrhmem")[0].setAttribute("placeholder","Adding member..");var a=$("#zcl_calgid")[0].value,c=s.zid;ZCL_XHR("/cal/groups/"+a+"/addMember/"+c,function(a){if("success"==ZCL_Evl(1,a.responseText).status){var e=document.createElement("li");e.setAttribute("data-id",s.zid),e.id=s.email;var t='<div class="SC_avtr">';t+='<img src="'+s.internalData.attrs.photo+'">',t+="</div>",t+="<div>",t+="<strong>"+s.firstName+"</strong>",t+='<i class="SC_Otxt"></i>',t+="<span>"+s.email+"</span>",t+="</div>",t+="<div>",t+='<div class="SCmb" onclick="ZCL_memper(event, \''+c+"')\">",t+='<ul class="zm_action"><li class=""><b><i class="msi-action"></i><div class="SC_hd"></div></b></li></ul>',t+="</div>",t+="</div>",e.innerHTML=t,$("#zcl_memView")[0].appendChild(e);var i=$("#isMem"),l=$("#zcl_memView");i[0].innerHTML=l[0].childNodes.length-1+1+zcal.i18n.members,zmUtil.succErrMsg("s",zcal.i18n.addmember_msg),n(),$("#zcl_addsrhmem")[0].setAttribute("placeholder","Add for members by name or email")}})},r=function(a,e,t){var i,l,s=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'  id='zcl_callist' rel="+a+"></div>"),n=$("<div class='SC_setTab'><div class='SC_setTabList'><span class='sel' id='det'>"+zcal.i18n.edit+"</span></div></div>");for(var c in"groups"==t&&(i="<span id='grpmem'>"+zcal.i18n.members+"</span><span id='em'>"+zcal.i18n.embed+"</span>",n.find(".SC_setTabList")[0].append($(i)[0]),n.find(".SC_setTabList")[0].append($(i)[1]),0==e[13][0]&&0==e[13][7]||(i="<span id='sh'>"+zcal.i18n.share+"</span>",$(i).insertBefore(n.find(".SC_setTabList")[0].childNodes[2]))),"apps"==t&&"gcal"==e[14]?(i="<span id='sh'>"+zcal.i18n.share+"</span>",n.find(".SC_setTabList")[0].append($(i)[0])):"my"==t?"0"==zcal.shrCal&&"0"==zcal.pvtUrl||(i="<span id='sh'>"+zcal.i18n.share+"</span><span id='em'>"+zcal.i18n.embed+"</span>",n.find(".SC_setTabList")[0].append($(i)[0]),n.find(".SC_setTabList")[0].append($(i)[1])):"other"==t&&(0!=e[13][0]&&"0"!=zcal.shrCal&&(i="<span id='sh'>"+zcal.i18n.share+"</span>",n.find(".SC_setTabList")[0].append($(i)[0])),1==e[13][6]&&(i="<span id='em'>"+zcal.i18n.embed+"</span>",n.find(".SC_setTabList")[0].append($(i)[0]))),zcal.cdata.calByGrp)for(var r in zcal.cdata.calByGrp[c])r==a&&(l=c);$(this);var d,o,p,m=a,u=e;return d=zcalDetailsView.render(m,u,l,t),n.find("#det").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),s[0].removeChild(s[0].childNodes[1]),d=zcalDetailsView.render(m,u,l,t),s.append(d)}),n.find("#sh").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),s[0].removeChild(s[0].childNodes[1]),o=zcalShareView.render(m,u),s.append(o)}),n.find("#em").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),s[0].removeChild(s[0].childNodes[1]),p=zcalEmbedView.render(m,u),s.append(p)}),n.find("#grpmem").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),s[0].removeChild(s[0].childNodes[1]),v(m,s)}),s.append(n),s.append(d),s},b=function(s,n,c){var r,t,d=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'  id='zcl_callist' rel="+s+"></div>"),a=$("<div class='SC_setTab'><div class='SC_setTabList'><span id='det'>"+zcal.i18n.edit+"</span><span class='sel' id='sh'>"+zcal.i18n.share+"</span></div></div>"),i=zcalShareView.render(s,n);if("groups"==c){var e="<span id='grpmem'>"+zcal.i18n.members+"</span>";$(e).insertBefore(a.find(".SC_setTabList")[0].childNodes[1])}if("apps"!=c){var l="<span id='em'>"+zcal.i18n.embed+"</span>";a.find(".SC_setTabList")[0].append($(l)[0])}return a.find("#det").on("click",function(a){var e,t=$(this);for(var i in t.parent().find("span").removeClass("sel"),t.addClass("sel"),d[0].removeChild(d[0].childNodes[1]),zcal.cdata.calByGrp)for(var l in zcal.cdata.calByGrp[i])l==s&&(e=i);r=zcalDetailsView.render(s,n,e,c),d.append(r)}),a.find("#sh").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),d[0].removeChild(d[0].childNodes[1]),i=zcalShareView.render(s,n),d.append(i)}),a.find("#em").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),d[0].removeChild(d[0].childNodes[1]),t=zcalEmbedView.render(s,n),d.append(t)}),a.find("#grpmem").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),d[0].removeChild(d[0].childNodes[1]),v(s,d)}),d.append(a),d.append(i),d},d=function(){var a=zcal.cdata.gcalOdrArr;z[0].removeChild(z[0].childNodes[1]);var e=$('<div><div class="zcl_Twpr_Callist"><div class="SC_filt_bottom SC_filt_bottomCustom"  id="topB"><div class="zmL SC_filt_bld"><ul class="bld"><li></li><li>'+zcal.i18n.calname+"</li><li>"+zcal.i18n.action+'</li> <li class="conditions">'+zcal.i18n.status+'</li></ul></div></div><div class="SC_Twpr zcl_Twpr_Callist zcl_setsrl"> <div class="SC_filt_bottom SC_filt_bottomCustom" id="listCal"></div></div></div></div>'),t=z.find("#grpCal");for(var i in t.parent().find("li").removeClass("stSel"),t.addClass("stSel"),z.append(e),a){var l=a[i],s=zcal.cdata.calGLst;o(l,s[l])}n("groups")},o=function(a,s){var e,t,i,l="groups",n=$('<div class="zmL '+(1==s[8]?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),c=ZCL_getCalColor(s[1])[1],r=ZCL_getHTML(s[0]),d=$('<li><div style="background-color:'+c+'" class="SClbl"><i class="'+(1==s[2]?"msi-tick":"")+'"></i></div></li>');d.find(".SClbl").off("click").on("click",{calid:a},function(a){var e=a.data.calid;f(e)}),n.find("ul").append(d);var o=$('<li><strong class="filterControl">'+r+"</strong></li>");h(o,a,s,l),n.find("ul").append(o);var p=$('<li class="filterControl"><b></b></li>');i=p.find("b"),0==s[13][0]&&0==s[13][7]||((e=$('<span data-id="sh">'+zcal.i18n.share+"</span>")).off("click").on("click",{calid:a,cobj:s},function(a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return b(a.data.calid,a.data.cobj,l)}}).done(function(a){a.card.show()})}),i.append(e)),1==s[13][5]&&((t=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>")).off("click").on("click",{calid:a,ckey:s[9]},function(a){var e=a.data.calid;y(e,!0,l)}),i.append(t)),n.find("ul").append(p);var m=$('<li><div class="onoffButton" style="background-color: transparent !important;"></li>');if("false"==s[3]){var u=$("<div data-on="+zcal.i18n.on+" data-off="+zcal.i18n.off+"></div>");0==s[8]?u.addClass("sdiv sadiv"):u.addClass("sdiv"),u.off("click").on("click",{calid:a},function(a){var t=$(this),i=t.parents(".zmL"),l=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+l+"&isshow="+!!t.hasClass("sadiv"),function(a){var e=ZCL_Evl(1,a.responseText);"success"==e.status?(s[8]=e.isshow?1:0,t.removeAttr("class").addClass(e.isshow?"sdiv inctop":"sdiv sadiv"),i.removeAttr("class").addClass(e.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:l,visibility:e.isshow}),e.isshow?zmUtil.succErrMsg("s",zcal.i18n.on_msg):zmUtil.succErrMsg("s",zcal.i18n.off_msg)):zmUtil.succErrMsg("e",e.message)})}),m.find(".onoffButton").append(u)}n.find("ul").append(m),z.find("#listCal").append(n)},p=function(){var a=$('<div><div class="zcl_Twpr_Callist"><div class="SC_filt_bottom SC_filt_bottomCustom"  id="topB"><div class="zmL SC_filt_bld"><ul class="bld"><li></li><li>'+zcal.i18n.calname+"</li><li>"+zcal.i18n.action+'</li> <li class="conditions">'+zcal.i18n.status+'</li></ul></div></div><div class="SC_Twpr zcl_Twpr_Callist zcl_setsrl"> <div class="SC_filt_bottom SC_filt_bottomCustom" id="listCal"></div></div></div></div>');z[0].removeChild(z[0].childNodes[1]),z.append(a);var e=z.find("#appCal");for(var t in e.parent().find("li").removeClass("stSel"),e.addClass("stSel"),l=zcal.cdata.calALst)m(t,l[t]);n("apps")},m=function(a,s){var e,t,i,l,n="apps",c=$('<div class="zmL '+(1==s[8]?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),r=ZCL_getCalColor(s[1])[1],d=ZCL_getHTML(s[0]),o=$('<li><div style="background-color:'+r+'" class="SClbl"><i class="'+(1==s[2]?"msi-tick":"")+'"></i></div></li>');o.find(".SClbl").off("click").on("click",{calid:a},function(a){var e=a.data.calid;f(e)}),c.find("ul").append(o);var p=$('<li><strong class="filterControl">'+d+"</strong></li>");h(p,a,s,n),c.find("ul").append(p);var m=$('<li class="filterControl"><b></b></li>');l=m.find("b"),0==s[13][0]&&0==s[13][7]||((e=$('<span data-id="sh">'+zcal.i18n.share+"</span>")).off("click").on("click",{calid:a,cobj:s},function(a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return b(a.data.calid,a.data.cobj,n)}}).done(function(a){a.card.show()})}),l.append(e)),1==s[13][5]&&((t=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>")).off("click").on("click",{calid:a,ckey:s[9]},function(a){var e=a.data.calid;y(e,!0,n)}),l.append(t)),2!=s[5]&&(5!=s[5]||"zcontacts"!=s[14]&&"zprojects"!=s[14])||((i=$('<span data-id="upd">'+zcal.i18n.update+"</span>")).off("click").on("click",{calid:a,ckey:s[9]},function(a){var e=a.data.calid;A(e)}),l.append(i)),c.find("ul").append(m);var u=$('<li><div class="onoffButton" style="background-color: transparent !important;"></div></li>');if("false"==s[3]){var v=$("<div data-on="+zcal.i18n.on+" data-off="+zcal.i18n.off+"></div>");0==s[8]?v.addClass("sdiv sadiv"):v.addClass("sdiv"),v.off("click").on("click",{calid:a},function(a){var t=$(this),i=t.parents(".zmL"),l=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+l+"&isshow="+!!t.hasClass("sadiv"),function(a){var e=ZCL_Evl(1,a.responseText);"success"==e.status?(s[8]=e.isshow?1:0,t.removeAttr("class").addClass(e.isshow?"sdiv inctop":"sdiv sadiv"),i.removeAttr("class").addClass(e.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:l,visibility:e.isshow}),e.isshow?zmUtil.succErrMsg("s",zcal.i18n.on_msg):zmUtil.succErrMsg("s",zcal.i18n.off_msg)):zmUtil.succErrMsg("e",e.message)})}),u.find(".onoffButton").append(v)}c.find("ul").append(u),z.find("#listCal").append(c)},u=function(){var a=$('<div><div class="zcl_Twpr_Callist"><div class="SC_filt_bottom SC_filt_bottomCustom"  id="topB"><div class="zmL SC_filt_bld"><ul class="bld"><li></li><li>'+zcal.i18n.calname+"</li><li>"+zcal.i18n.action+'</li> <li class="conditions">'+zcal.i18n.status+'</li></ul></div></div><div class="SC_Twpr zcl_Twpr_Callist zcl_setsrl"> <div class="SC_filt_bottom SC_filt_bottomCustom" id="listCal"></div></div></div></div>');z[0].removeChild(z[0].childNodes[1]),z.append(a);var e=z.find("#othCal");for(var t in e.parent().find("li").removeClass("stSel"),e.addClass("stSel"),l=zcal.cdata.calOLst)S(t,l[t]);n("other")},S=function(a,s){var e,t,i,l,n="other",c=$('<div class="zmL '+(1==s[8]?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),r=ZCL_getCalColor(s[1])[1],d=ZCL_getHTML(s[0]),o=$('<li><div style="background-color:'+r+'" class="SClbl"><i class="'+(1==s[2]?"msi-tick":"")+'"></i></div></li>');o.find(".SClbl").off("click").on("click",{calid:a},function(a){var e=a.data.calid;f(e)}),c.find("ul").append(o);var p=$('<li><strong class="filterControl">'+d+"</strong></li>");h(p,a,s,n),c.find("ul").append(p);var m=$('<li class="filterControl"><b></b></li>');l=m.find("b"),0!=s[13][0]&&"0"!=zcal.shrCal&&((e=$('<span data-id="sh">'+zcal.i18n.share+"</span>")).off("click").on("click",{calid:a,cobj:s},function(a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard({getView:function(){return b(a.data.calid,a.data.cobj,n)}}).done(function(a){a.card.show()})}),l.append(e)),1==s[13][5]&&((t=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>")).off("click").on("click",{calid:a,ckey:s[9]},function(a){var e=a.data.calid;y(e,!0,n)}),l.append(t)),2==s[5]&&((i=$('<span data-id="upd">'+zcal.i18n.update+"</span>")).off("click").on("click",{calid:a,ckey:s[9]},function(a){var e=a.data.calid;A(e)}),l.append(i)),c.find("ul").append(m);var u=$('<li><div class="onoffButton" style="background-color: transparent !important;"></div></li>');if("false"==s[3]){var v=$("<div data-on="+zcal.i18n.on+" data-off="+zcal.i18n.off+">");0==s[8]?v.addClass("sdiv sadiv"):v.addClass("sdiv"),v.off("click").on("click",{calid:a},function(a){var t=$(this),i=t.parents(".zmL"),l=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+l+"&isshow="+!!t.hasClass("sadiv"),function(a){var e=ZCL_Evl(1,a.responseText);"success"==e.status?(s[8]=e.isshow?1:0,t.removeAttr("class").addClass(e.isshow?"sdiv inctop":"sdiv sadiv"),i.removeAttr("class").addClass(e.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:l,visibility:e.isshow}),e.isshow?zmUtil.succErrMsg("s",zcal.i18n.on_msg):zmUtil.succErrMsg("s",zcal.i18n.off_msg)):zmUtil.succErrMsg("e",e.message)})}),u.find(".onoffButton").append(v)}c.find("ul").append(u),z.find("#listCal").append(c)},k=function(e,a){var t=zcal.i18n.deletegroup+" "+a,i="<div>"+zcal.i18n.deletemsg+"</div>",l={title:t,mask:!0,style:{width:"500px"},buttons:[{txt:zcal.i18n.del,callback:function(a){a.target.innerHTML="Deleting",ZCL_XHR("/cal/groups/"+e,function(a){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){var t=zcal.cdata.calByGrp[e.groupId],i=Object.keys(t)[0],l=t[i][10][2];$.publish("/calendar/deleted",{calid:i,caluid:l,grpid:e.groupId,mode:"grpdelete"}),zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard().done(function(a){a.close()}).fail(function(){}),zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView.groupCalendarView(),zmsDialog.remove()}else zmUtil.succErrMsg("e",e.status),zmsDialog.remove()},"delete")}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){zmsDialog.remove()}}]};ZCL_$("zcl_grpdel")||$("body").append('<div id="zcl_grpdel" class="zcl_addcalcn"></div>'),$("#zcl_grpdel").html(i),zmsDialog.create("zcl_grpdel",l)},y=function(t,a,i){var e,l=a?zcal.i18n.areyousureunsub:zcal.i18n.deletecalendar;zmsDialog.confirm(l,{onOk:function(){e=zcal.getCalObj(t),ZCL_XHR("/cal/calAct.do?mode=del&calid="+t+"&calencpt="+e[9],function(a){var e=ZCL_Evl(1,a.responseText);"success"==e.status&&$.publish("/calendar/deleted",{calid:t,caluid:e.uid,mode:"delete",type:i})})}})},A=function(a){var e=1==zcal.CALMODE?"/cal/gsubCal.do?&grpid="+ZCL_ZGID+"&mode=userUpd&calid="+a:"/cal/subCal.do?mode=userUpd&calid="+a;ZCL_XHR(e,function(){ZCL_setCalendars(),zcalEvents.loadMonthData(),zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully)})},w=function(){$.subscribe("/calendar/added",t),$.subscribe("/calendar/updated",t),$.subscribe("/calendar/deleted",a.delCal),$.subscribe("/calendar/statusChanged",a.updCalSts)};a.initialize=function(a){(a=a||{}).process.resolve(),w()},a.uninitialize=function(a){(a=a||{}).process.resolve()},a.delCal=function(a,e){var t=e.calid,i=z.find("[data-id="+t+"]");i.length&&i.remove(),n("del",t)},a.updCalSts=function(a,e){var t,i=e.calid;e.sts;0<(t=z.find("[data-id="+i+"]")).find("i").length&&t.find("i").removeAttr("class").addClass(1==e.sts?"msi-tick":"")},a.getMGAOCalendarsView=t,a.openShare=b,a.openEmbed=function(s,n,c){var a,r,t,d=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'  id='zcl_callist' rel="+s+"></div>"),e=$("<div class='SC_setTab'><div class='SC_setTabList'><span id='det'>"+zcal.i18n.edit+"</span><span id='sh'>"+zcal.i18n.share+"</span><span class='sel' id='em'>"+zcal.i18n.embed+"</span></div></div>"),i=zcalEmbedView.render(s,n);return"groups"==c&&(a="<span id='grpmem'>"+zcal.i18n.members+"</span>",$(a).insertBefore(e.find(".SC_setTabList")[0].childNodes[1])),e.find("#det").on("click",function(a){var e,t=$(this);for(var i in t.parent().find("span").removeClass("sel"),t.addClass("sel"),d[0].removeChild(d[0].childNodes[1]),zcal.cdata.calByGrp)for(var l in zcal.cdata.calByGrp[i])l==s&&(e=s);r=zcalDetailsView.render(s,n,e,c),d.append(r)}),e.find("#sh").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),d[0].removeChild(d[0].childNodes[1]),t=zcalShareView.render(s,n),d.append(t)}),e.find("#em").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),d[0].removeChild(d[0].childNodes[1]),i=zcalEmbedView.render(s,n),d.append(i)}),e.find("#grpmem").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),d[0].removeChild(d[0].childNodes[1]),v(s,d)}),d.append(e),d.append(i),d},a.groupCalendarView=d,a.appCalendarView=p,a.otherCalendarView=u,a.ZCL_delCal=y,a.ZCL_icsDown=function(a){var e=$("#zcl_pwd")[0].value,t=$("#zcl_repwd")[0].value;""==e&&""==t?($("#zcl_pwd_er")[0].style.display="",$("#zcl_repwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none"):e==t?($("#zcl_repeqwd_er")[0].style.display="none",$("#zcl_repwd")[0].className="SC_tiput",ZCL_formSubmit({ckey:a,password:e,resformat:"zip",mode:"pwdcalexp"},"/cal/export.do","GET"),zmsDialog.remove()):($("#zcl_repeqwd_er")[0].style.display="",$("#zcl_repwd")[0].className="SC_tiput zcl_cl_ad_er",$("#zcl_pwdcon")[0].style.display="none")},a.openDetail=r,a.openGrpMem=function(s,a,n){var e;g[0].setAttribute("rel",s);var t=$("<div class='SC_setTab'><div class='SC_setTabList'><span  id='det'>"+zcal.i18n.edit+"</span><span class='sel' id='grpmem'>"+zcal.i18n.members+"</span><span id='em'>"+zcal.i18n.embed+"</span></div></div>");"apps"==n||"groups"==n?0==a[13][0]&&0==a[13][7]||(e="<span id='sh'>"+zcal.i18n.share+"</span>",$(e).insertBefore(t.find(".SC_setTabList")[0].childNodes[2])):"my"==n?"0"==zcal.shrCal&&"0"==zcal.pvtUrl||(e="<span id='sh'>"+zcal.i18n.share+"</span>",$(e).insertBefore(t.find(".SC_setTabList")[0].childNodes[1])):"other"==n&&0!=a[13][0]&&"0"!=zcal.shrCal&&(e="<span id='sh'>"+zcal.i18n.share+"</span>",$(e).insertBefore(t.find(".SC_setTabList")[0].childNodes[1]));$(this);var c,i,l,r=s,d=a;return t.find("#grpmem").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),g[0].removeChild(g[0].childNodes[1]),v(r,g)}),t.find("#det").on("click",function(a){var e,t=$(this);for(var i in t.parent().find("span").removeClass("sel"),t.addClass("sel"),g[0].removeChild(g[0].childNodes[1]),zcal.cdata.calByGrp)for(var l in zcal.cdata.calByGrp[i])l==s&&(e=i);c=zcalDetailsView.render(r,d,e,n),g.append(c)}),t.find("#sh").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),g[0].removeChild(g[0].childNodes[1]),i=zcalShareView.render(r,d),g.append(i)}),t.find("#em").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),g[0].removeChild(g[0].childNodes[1]),l=zcalEmbedView.render(r,d),g.append(l)}),g.empty(),g.append(t),v(r),g}},"MailSuite.Apps.CalendarMGAOCalendars");var zcalDetailsView=function(a){function h(a){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard().done(function(a){a.close()});var e=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;"apps"==a?e.appCalendarView():"groups"==a?e.groupCalendarView():"other"==a&&e.otherCalendarView()}var d,g,C,_,b,S;return(a=a||{}).render=function(a,e,t,i){g=a,_=(C=e)[9];var l=ZCL_getHTML(e[0]),s=C[1].split(":")[0],n=C[1].split(":")[1];d=$('<div id="caldetails" class="SC_Twpr zcl_Twpr" style="top:46px"><div class="SC_filt_bottom SC_filt_bottomCustom" id="SC_detail"></div></div>');var c='<div class="editFilterParent zcl_stfrm">';if(c+='<div class="zmL noPad">',c+='<div class="SC_srch shw">',c+='<table class="condition">',c+="<tbody>","group"==C[14]&&1!=C[13][8]?(c+='<tr><td class="gbld">'+zcal.i18n.calname+"</td></tr>",c+='<tr><td><table><tbody><tr><td><ul class="zcl_frmrw"><input id="zcl_calname" placeholder="" value="'+l+'" type="text" disabled></ul></td></tr></tbody></table></td></tr>'):(c+='<tr><td class="gbld">'+zcal.i18n.calname+"</td></tr>",c+='<tr><td><table><tbody><tr><td><div class="SC_select SC_selectnoneArw newFltr"><input id="zcl_calname" placeholder="" value="'+l+'" type="text"></div></td></tr></tbody></table></td></tr>'),c+="</tbody>",c+="</table>",c+=e[4]&&""!=e[4]?"group"==e[14]&&1!=e[13][8]?'<div class=""  id="zcl_caldesc"><div class="SC_srch shw"><div class="gbld">'+zcal.i18n.description+'</div><div class="zcl_vwdes" id="zcl_cedesc" style="max-width: 400px;">'+ZCL_getHTML(e[4])+"</div></div></div>":'<div class="zmL"  id="zcl_caldesc"><div class="SC_srch shw"><table class="condition"><tbody><tr><td class="gbld">'+zcal.i18n.description+'</td></tr><tr><td><textarea class="SC_tiput" >'+ZCL_getHTML(e[4])+"</textarea></td></tr></tbody></table></div></div>":"group"==e[14]&&1!=e[13][8]?"":'<span class="zcl_grey zcl_cp" id="zcl_opencaldesc">+'+zcal.i18n.addnote+'</span><div class="zmL" style="display:none"  id="zcl_caldesc"><div class="SC_srch shw"><table class="condition"><tbody><tr><td class="gbld">'+zcal.i18n.description+'</td></tr><tr><td><textarea class="SC_tiput"></textarea></td></tr></tbody></table></div></div>',c+="</div>",c+="</div>",c+='<div class="zcl_sczml"><div class="SC_srch shw"><div class="gbld">'+zcal.i18n.calcolor+"</div></div>",c+='<div class="zcl_calcol" id="zcl_calcol">'+function(a){a=a||"0";for(var e="<ul >",t=!1,i=0;i<zcal.calcolor.length;i++)t=a==i||zcal.calcolor[i][1].toLowerCase()==a.toLowerCase()||t,e+='<li id="selCo" style="background-color:'+zcal.calcolor[i][1]+';" rel="'+i+'">',e+=a==i||zcal.calcolor[i][1].toLowerCase()==a.toLowerCase()?'<i class="msi-tick"></i>':"",e+=9==i?"</ul><ul>":"";return e+="</ul>",t||(e+='<ul><li id="selCo" style="background-color:'+a+'" rel="'+a+'"><i class="msi-tick"></i></li>',e+="<li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>"),e}(s)+"</div>",c+='<input type="hidden" id="zcl_calid" value="'+(a||"")+'">',c+='<input type="hidden" id="zcl_calgid" value="'+(t||"")+'">',c+='<div class="zcl_addcaltx zcl_sczml">',c+='<div class="SC_srch shw">',c+='<div class="gbld">'+zcal.i18n.textcolor+"</div>",c+="</div>",c+='<u data-marker ="textColor" id="zcl_txtcol"><i class="'+(0==n?"msi-option":"msi-unoption")+'"></i><u class="">'+zcal.i18n.white+'</u></u><u data-marker ="textColor"><i class="'+(1==n?"msi-option":"msi-unoption")+'"></i><u class="">'+zcal.i18n.black+"</u></u>",c+="</div>",c+='<div class="zmL">',c+='<div class="SC_srch shw">',c+='<table class="condition">',c+="<tbody>",c+='<tr><td class="gbld">'+zcal.i18n.calendarid+"</td></tr>",c+='<tr><td><p class="zcl_Calid">'+_+"</p></td></tr>",c+="</tbody>",c+="</table>",c+="</div>",c+="</div>","my"==i&&(c+='<div class="zmL">',c+='<div class="SC_srch shw">',c+='<table class="condition">',c+="<tbody>",c+='<tr><td class="gbld">'+zcal.i18n.calendaruid+"</td></tr>",c+='<tr><td><p class="zcl_Calid">'+C[10][2]+"</p></td></tr>",c+="</tbody>",c+="</table>",c+="</div>",c+="</div>"),1==e[13][6]&&"ztask"!=e[14]&&(c+='<div class="zmL">',c+='<div class="SC_srch shw">',c+='<table class="condition">',c+="<tbody>",c+='<tr><td class="gbld">'+zcal.i18n.reminder+"</td></tr>",c+="</tbody>",c+="</table>",c+="</div>",c+='<ul id="zcl_addrem" class="zcl_rem">',c+='<li data-marker="calReminder">',c+='<span><i class="msi-add"></i>Add Reminder</span>',c+="</li>",c+="</ul>",c+="</div>"),c+='<div class="zmL">',c+='<div class="SC_srch shw">',c+='<p class="match" data-marker="markAsBusy">',c+='<em><i class="msi-check"></i>',c+='<span class="fn ml5">'+zcal.i18n.markasbusy_cal+"</span>",c+="</em>",c+="</p>",c+="</div>",c+="</div>",c+='<div class="SC_PUbtm">',c+='<span class="sel" data-marker="detailSave">'+zcal.i18n.save+"</span>",c+='<span data-val="Cancel">'+zcal.i18n.cancel+"</span>",c+="</div>",c+="</div>",d.find("#SC_detail").append($(c)),(b=d.find("[data-marker=calReminder]").removeAttr("data-marker")).html(ZCL_putCalAlarm(C[6])),b.find(".msi-close").off("click").on("click",function(){$(this).closest("ul").remove(),b.find("#zcl_addrem").length||ZCL_AppendRemAddLnk(b[0])}),S=d.find("[data-marker=markAsBusy]").removeAttr("data-marker"),null!=C[16]&&""!=C[16]){var r=S.find("i");0<r.length&&(r.removeAttr("class").addClass("1"==C[16]?"msi-check":"msi-uncheck"),r.off("click").on("click",function(){this.className="msi-check"==this.className?"msi-uncheck":"msi-check"}))}else S.remove();return d.find("#zcl_opencaldesc").off("click").on("click",function(){ZCL_$("zcl_caldesc").style.display="",this.style.display="none"}),d.find("[data-marker=textColor]").removeAttr("data-marker").on("click",function(a){var e=$(this);e.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),e.find("i").removeClass("msi-unoption").addClass("msi-option")}),d.find("#selCo").on("click",function(a){for(var e=zcal.$("zcl_calcol").getElementsByTagName("li"),t=0;t<e.length;t++)e[t].innerHTML="";a.target.innerHTML='<i class="msi-tick"></i>'}),d.find("[data-marker=detailSave]").removeAttr("data-marker").off("click").on("click",function(){!function(s){for(var a,e,t=S&&0<S.find(".msi-check").length?"1":"0",i=$("#zcl_calname")[0].value.replace(zcal.REG,"").zcalescape(),l=$("#zcl_caldesc")[0]?0<$("#zcl_caldesc")[0].getElementsByTagName("TEXTAREA").length?$("#zcl_caldesc")[0].getElementsByTagName("TEXTAREA")[0].value.trim().replace(zcal.REG,"").zcalescape():$("#zcl_cedesc")[0].innerHTML.trim().replace(zcal.REG,"").zcalescape():"",n=ZCL_$("zcl_calcol").getElementsByTagName("li"),c=0,r=0;r<n.length;r++){var d=n[r].getElementsByTagName("i");if(0<d.length&&"msi-tick"==d[0].className){c=n[r].getAttribute("rel");break}}var o=1;"msi-option"==$("#zcl_txtcol")[0].getElementsByTagName("i")[0].className&&(o=0);var p=$("#zcl_calgid")[0].value;$("#zcl_calid")[0].value;if(b[0]&&(a=ZCL_getAlarmObj(b[0].childNodes)[0]),"groups"==s){var m=[];if(""!=a.ACTYPE&&null!=a.ACTYPE&&(a.ACTYPE!=C[6].ACTYPE||a.REMTIME!=C[6].REMTIME||a.REMTYPE!=C[6].REMTYPE)){var u=a.REMTIME.split(","),v=a.REMTYPE.split(","),f=a.ACTYPE.split(",");for(var r in u)obj={},obj.remt=parseInt(u[r]),obj.remty=v[r],obj.actty=f[r],m.push(obj)}var z={calname:i,caldesc:l,calcol:c,txtcol:o,caluid:_,reminder:m};ZCL_XHR("/cal/groups/"+p+"?groupData="+JSON.stringify(z),function(a){var e=ZCL_Evl(1,a.responseText);if("success"==e.status){zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully);var t=e.obj,i=zcal.getCalObj(e.calid);if(i[0]=t[0],i[1]=t[1],i[4]=t[4],1<t[6].length)for(var l in i[6].ACTYPE="",i[6].REMTIME="",i[6].REMTYPE="",t[6])i[6].ACTYPE+=""==i[6].ACTYPE?t[6][l].ACTYPE:","+t[6][l].ACTYPE,i[6].REMTIME+=""==i[6].REMTIME?t[6][l].REMTIME:","+t[6][l].REMTIME,i[6].REMTYPE+=""==i[6].REMTYPE?t[6][l].REMTYPE:","+t[6][l].REMTYPE;else 0<t[6].length?i[6]=t[6][0]:i[6]={};$.publish("/calendar/updated"),h(s)}else zmUtil.succErrMsg("e",e.error)})}else a&&(a.ACTYPE||a.ACTYPE==C[6].ACTYPE&&null!=a.ACTYPE)?a.ACTYPE==C[6].ACTYPE&&a.REMTIME==C[6].REMTIME&&a.REMTYPE==C[6].REMTYPE&&t==C[16]&&i==C[0]&&c==C[1].split(":")[0]&&o==C[1].split(":")[1]&&l==C[4]||(e="&remt="+a.REMTIME+"&remty="+a.REMTYPE+"&actty="+a.ACTYPE+"&busy="+t):e="&remt=&remty=&actty=&busy="+t,e&&ZCL_XHR("/cal/calAct.do?mode=edit-adv&caluid="+_+"&calid="+g+e+"&calcol="+c+"&txtcol="+o+"&caldesc="+l+"&calname="+i,function(a){var e=ZCL_Evl(1,a.responseText);if("success"===e.status){C[6]=e.obj.REM,C[16]=e.obj.BUSY,zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully);var t=zcal.getCalObj(e.id);t[0]=e.calobj[0],t[1]=e.calobj[1],t[4]=e.calobj[4],$.publish("/calendar/updated"),h(s)}})}(i)}),d.find("[data-val=Cancel]").off("click").on("click",h),d},a.close=h,a}(zcalDetailsView||{}),zcalShareView=function(a){var l,s,c,n,r,d,o,p,m,u,v,f,z,h={};(a=a||{}).render=function(a,e){s=a,n=(c=e)[9],l=$('<div id="zcl_calshare" class="SC_Twpr zcl_Twpr" style="top:46px"><div class="SC_filt_bottom SC_filt_bottomCustom" id="SC_detail"></div></div>');var t='<div class="editFilterParent zcl_stfrm">';t+='<div data-marker="publicShare" class="zmL"></div>',t+='<div data-marker="orgShare" class="zmL"></div>',t+='<div data-marker="privateAddress" class="zmL"></div>',t+='<div data-marker="indShare" class="zmL"></div>',t+='<div class="zcl_Sshlst" data-marker="sharedList"></div>',t+='<div class="SC_PUbtm"><span data-val="Cancel">'+zcal.i18n.cancel+"</span></div>",t+="</div>";var i=$(t);if(0!=c[13][0]||1==c[13][7])return r=i.find("[data-marker=publicShare]").removeAttr("data-marker"),$orgShare=i.find("[data-marker=orgShare]").removeAttr("data-marker"),d=i.find("[data-marker=privateAddress]").removeAttr("data-marker"),o=i.find("[data-marker=indShare]").removeAttr("data-marker"),v=i.find("[data-marker=sharedList]").removeAttr("data-marker"),0==c[13][0]&&1==c[13][7]?0!=zcal.pvtUrl&&(3==c[5]?S:G)():1==c[13][0]&&0==c[13][7]?0!=zcal.shrCal&&1!=zcal.shrCal&&(3==c[5]?S:x)():1==c[13][0]&&1==c[13][7]?0==zcal.shrCal&&0!=zcal.pvtUrl?(3==c[5]?S:G)():0!=zcal.shrCal&&1!=zcal.shrCal&&0==zcal.pvtUrl?(3==c[5]?S:x)():0!=zcal.shrCal&&1!=zcal.shrCal&&0!=zcal.pvtUrl&&(3==c[5]?S():(x(),G())):0==zcal.shrCal&&0!=zcal.pvtUrl?(r&&(r.remove(),r=void 0),o&&(o.remove(),o=void 0),v&&(v.remove(),v=void 0),G()):1==zcal.shrCal&&0==zcal.pvtUrl?(r&&(r.remove(),r=void 0),d&&(d.remove(),d=void 0),(zcal.cdata.calLst[s]?y:k)()):1==zcal.shrCal&&0!=zcal.pvtUrl?(r&&(r.remove(),r=void 0),zcal.cdata.calLst[s]?(G(),y()):k()):2==zcal.shrCal&&0==zcal.pvtUrl?(d&&(d.remove(),d=void 0),zcal.cdata.calLst[s]?(x(),y()):k()):zcal.cdata.calLst[s]?(x(),-1!=zmail.zoid&&I(),G(),y()):k(),i.find("[data-val=Cancel]").off("click").on("click",q),l.find("#SC_detail").html(i),l;(l=void 0).remove()};function g(a){var i=[];(a.menuItems||[]).forEach(function(a){var e=a.value,t=a.text;i.push({htm:"<div>"+t+"</div>",data:{value:e,text:t}})});var l=$.Deferred();return a.list=i,a.clk=function(a,e,t){l.resolve(a,e,t)},a.onHide=function(){l.reject()},i.length?zmsuite.showMenu(a):l.reject(),l.fail(zmUtil.hideMenu),l.promise()}function t(a,e){for(var t=0;t<e.length;t++){var i=zcalGroup.getGroup(e[t]);i&&a.push({id:e[t],name:i.name,display_text:i.name})}}function C(a){this.theme=a&&a.theme||0,this.language=a&&a.lang||"en",this.calKey=a&&a.ckey}var _,b,S=function(){var a="/cal/shareCal.do?mode=cal-pubpvtinfo&caluid="+c[9]+"&calid="+s+"&calmode=0";ZCL_XHR(a,function(a){var e=ZCL_Evl(1,a.responseText);e.obj&&(c[10]=e.obj),x()})},k=function(){var a="/cal/shareCal.do?mode=sh-calinfo&caluid="+c[9]+"&calid="+s+"&calmode=0";ZCL_XHR(a,function(a){var e=ZCL_Evl(1,a.responseText);e.calInfo&&(c[10]=e.calInfo[10],c[11]=e.calInfo[11],c[12]=e.calInfo[12]),e.pvtLst&&(z=e.pvtLst),e.grpInfo&&(f=e.grpInfo),i(),x()})},y=function(){ZCL_XHR("/cal/shareCal.do?mode=priv-shlst&calid="+s+"&calmode=0",function(a){var e=ZCL_Evl(1,a.responseText);e.obj&&(z=e.obj,zcal.cdata.grpLst?(f=zcal.cdata.grpLst,i()):A())})},i=function(){var a='<div class="SC_srch shw">';a+='<table class="condition">',a+="<tbody>",a+='<tr><td class="gbld">'+zcal.i18n.sharewith_indorgrp+"</td></tr>",a+="</tbody>",a+="</table>",a+="</div>",a+='<div class="SC_srch shw">',a+='<table class="condition">',a+="<tbody>",a+="<tr><td><table><tbody><tr>",a+='<td width="60px"><div class="SC_select first zcl_w60" data-marker="shareType"><i class="msi-invitee"></i></div></td>',a+='<td width="43%" class="zcl_Calshemail" style="padding: 0 10px;"><div class="SC_select SC_selectnoneArw" ><input placeholder="'+zcal.i18n.typeaemailid+'" value="" class="zm_sgst" type="text" data-marker="shareTo"></div></td>',a+='<td width="29%"><div class="SC_select"><input class="disabled" readonly="" value="'+zcal.i18n.private_shperm_viewevent+'" type="text"   data-marker="sharePerm"></div></td>',a+='<td class="" style="padding-left: 10px;vertical-align: middle;"><span class="zcl_lk" data-marker="share">'+zcal.i18n.share+"</span></td>",a+="</tr></tbody></table></td></tr>",a+="</tbody>",a+="</table>",a+="</div>",o.html(a),p=o.find("[data-marker=shareType]").removeAttr("data-marker"),m=o.find("[data-marker=shareTo]").removeAttr("data-marker"),u=o.find("[data-marker=sharePerm]").removeAttr("data-marker"),o.find("[data-marker=share]").removeAttr("data-marker").off("click").on("click",function(a){if(1==h.type){var e=m.attr("data-gid");if(null==e)return!1;h.grpid=e}else{var t=m[0].value;if(!ZCL_isEmail(t))return zmUtil.succErrMsg("e",zcal.i18n.entervalidemail),m[0].focus(),!1;h.email=t}M(h)}),e({value:0}),w()},A=function(){var t=zmComponent.loadingBand({container:$(o)[0],type:"pagination"});ZCL_uXHR("/cal/groups",function(a){if(200==a.status){var e=ZCL_Evl(1,a.responseText);zcal.cdata.grpLst=e.grpLst,f=zcal.cdata.grpLst,zcalGroup.loadGroup(),t(),i()}})},w=function(){var a=$("<table></table>");for(var e in z[0]){var t=(n=P(0))[z[0][e]].text;(s=$('<tr><td><i class="msi-invitee"></i></td><td width="43%"><span>'+ZCL_getHTML(e)+'</span></td><td width="29%"><div class="SC_select"><input type="text" class="disabled" readonly value="'+t+'"></div></td><td><i class="msi-close"></i></td></tr>')).find("input").off("click").on("click",{menuItems:n,email:e},function(e){g({menuItems:e.data.menuItems,par:this,parWidth:!0}).then(function(a){M({type:0,email:e.data.email,perm:a.value}),zmUtil.hideMenu()})}),s.find(".msi-close").off("click").on("click",{email:e},function(a){L({email:a.data.email,mode:0})}),a.append(s)}for(var i in z[1]){var l=f.pgrp[i]||f.ogrp[i];if(l){var s,n;t=(n=P(1))[z[1][i]].text;(s=$('<tr><td width="5%"><i class="msi-group"></i></td><td width="43%"><span>'+ZCL_getHTML(l.GNAME)+'</span></td><td width="29%"><div class="SC_select"><input type="text" class="disabled" readonly value="'+t+'"></div></td><td><i class="msi-close"></i></td></tr>')).find("input").off("click").on("click",{menuItems:n,grpid:i},function(e){g({menuItems:e.data.menuItems,par:this,parWidth:!0}).then(function(a){M({type:1,grpid:e.data.grpid,perm:a.value}),zmUtil.hideMenu()})}),s.find(".msi-close").off("click").on("click",{grpid:i},function(a){L({grpid:a.data.grpid,mode:1})}),a.append(s)}}v.html(a)},L=function(a){var e=a.mode,t="/cal/shareCal.do?&calid="+s+"&caluid="+c[9]+"&calmode=0";t+=0==e?"&mode=priv-sh-del&shuser="+a.email.zcalescape():"&mode=grp-sh-del&grpid="+a.grpid,ZCL_XHR(t,function(a){var e,t,i=ZCL_Evl(1,a.responseText);e=i.mode,t=i.obj,"grp-sh-del"==e?delete z[1][t[0]]:delete z[0][t[0]],zmUtil.succErrMsg("s","Calendar sharing removed successfully"),w()})},M=function(a){var e="/cal/shareCal.do?calid="+s+"&perm="+a.perm+"&caluid="+n+"&calmode=0";1==a.type?e+="&mode=grp-sh&grpid="+a.grpid:e+="&mode=priv-sh&shuser="+a.email.zcalescape(),ZCL_XHR(e,function(a){var e,t=ZCL_Evl(1,a.responseText);"success"==t.status?(zmUtil.succErrMsg("s",zcal.i18n.sharedsuccessfully),e=t.obj,"grp-sh"===t.mode?z[1][e[0]]=e[1]:z[0][e[0]]=e[1],i()):"maxLmtReached"==t.status?zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.maxLmtReached,[60])):"noPermission"==t.status?zmUtil.succErrMsg("e",zcal.i18n.NoPermission):"WaitForApprvl"==t.status?zmUtil.succErrMsg("e",zcal.i18n.waitforapprovalcalmsg):zmUtil.succErrMsg("e",zcal.i18n[t.status])})},e=function t(a){var e=!ZCL_isEmpty(f.pgrp)||!ZCL_isEmpty(f.ogrp),i=a.value,l=P(i);if(h.type=i,h.perm=l[1].value,p&&(p.html('<i class="'+(1==i?"msi-group":"msi-invitee")+'"></i>'),p.off("click").on("click",{isgrp:e},function(a){var e=[{value:0,text:zcal.i18n.individuals}];a.data.isgrp&&e.push({value:1,text:zcal.i18n.groups}),g({menuItems:e,par:this,parWidth:!1}).then(function(a){t(a),zmUtil.hideMenu()})})),m)if(m.off("click"),m.val(""),1==i){m.attr("placeholder",zcal.i18n.selectagroup);var s=E();m.off("click").on("click",function(a){var t,e={},i=$(this);e.parentDOM=i.parent(),e.displayAs="dropdown",e.onSelect=function(a,e){T(i,a,e),t.hide()},e.dataCallback=function(){return s},(t=zmUtil.createFLComp("generic",e)).show()})}else m.attr("placeholder",zcal.i18n.typeaemailid),zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:m[0],excludeMe:!0,contactType:["org","personal","crm"],exclude:function(){return[]},onSelect:function(a,e){m[0].value=e.item.attributes.email,h.email=e.item.attributes.email}})});u&&u.off("click").on("click",function(a){var e=this;g({menuItems:l,par:this,parWidth:!0}).then(function(a){e.value=a.text,h.perm=a.value,zmUtil.hideMenu()})})},T=function(a,e,t){a.val(t.display_text),a.attr("data-gid",e)},E=function(){var a,e=[];return a=zcalGroup.getGroupList("personal"),t(e,a),a=zcalGroup.getGroupList("org"),t(e,a),e},P=function(a){if(2==a)var e=[{value:1,text:zcal.i18n.private_shperm_freebusy},{value:2,text:zcal.i18n.private_shperm_viewevent}];else{e=[{value:0,text:zcal.i18n.private_shperm_freebusy},{value:1,text:zcal.i18n.private_shperm_viewevent}];0==a&&(e.push({value:2,text:zcal.i18n.private_shperm_editevent}),e.push({value:3,text:zcal.i18n.private_shperm_delegate}))}return e},x=function(){var a='<div class="SC_srch shw">';a+='<table class="condition">',a+="<tbody>",a+='<tr><td class="gbld">'+zcal.i18n.public_share+"</td></tr>",a+="</tbody>",a+="</table>",a+="</div>",a+="<div>",a+='<table class="condition">',a+="<tbody>",a+="<tr><td>",a+='<div><span data-marker="makePublic">',a+='<i class="'+(0!=c[10][1]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.makethiscalpub+"</span>",a+="</span></div>",0!=c[10][1]&&(a+='<div class="zcl_Sshp zcl_Sshpu">',a+="<div>",a+='<span data-marker="chgPubPerm" rel="fb">',a+='<i class="'+(1==c[10][1]||4==c[10][1]?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.public_shperm_freebusy+"</span>",a+="</span>",a+='<span data-marker="chgPubPerm" rel="vd">',a+='<i class="'+(2==c[10][1]||3==c[10][1]?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.public_shperm_viewevent+"</span>",a+="</span>",1==c[13][1]&&(a+="<div>",a+='<span data-marker="allowER"><i class="'+(3==c[10][1]||4==c[10][1]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.allow_requisition+"</span></span>",a+=3==c[10][1]||4==c[10][1]?'<ul><li><span class="zcl_lk" data-marker="webAPI">'+zcal.i18n.webapiforevent+'</span></li><li><span class="zcl_lk" data-marker="eventReq">'+zcal.i18n.calpubevtreq+"</span></li></ul>":"",a+="</div>"),a+="</div>",a+="<div>",a+='<span class="zcl_lk" data-marker="pubICAL">'+zcal.i18n.ical+"</span>",a+='<span class="zcl_sp"></span><span class="zcl_lk" data-marker="pubHTML">'+zcal.i18n.html+"</span>",""==c[14]&&(a+='<span class="zcl_sp"></span><span class="zcl_lk" data-marker="mailto">Mail to</span>',a+='<span class="zcl_sp"></span><span class="zcl_lk" data-marker="linkto">Link to</span>'),a+="</div>",a+="</div>"),a+="</td></tr>",a+="</tbody>",a+="</table>",a+="</div>",r.html(a),r.find("[data-marker=makePublic]").removeAttr("data-marker").off("click").on("click",function(a){var e,t=$(this).find("i");e=t.hasClass("msi-check")?(t.removeClass("msi-check").addClass("msi-uncheck"),0):(t.removeClass("msi-uncheck").addClass("msi-check"),1),O({perm:e,mode:"enable/disable"})}),r.find("[data-marker=chgPubPerm]").removeAttr("data-marker").off("click").on("click",function(a){var e,t=$(this),i=t.parent();e="vd"===$(this).attr("rel")?2:1,e=3<=c[10][1]?1==e?4:3:e,i.find(".msi-option").removeClass().addClass("msi-unoption"),t.find("i").addClass("msi-option"),O({perm:e,mode:"change"})}),r.find("[data-marker=allowER]").removeAttr("data-marker").off("click").on("click",function(a){var e,t=$(this).find("i");e=t.hasClass("msi-check")?(t.removeClass("msi-check").addClass("msi-uncheck"),0):(t.removeClass("msi-uncheck").addClass("msi-check"),1),N(e)}),r.find("[data-marker=pubICAL]").removeAttr("data-marker").off("click").on("click",function(a){U("ical")}),r.find("[data-marker=pubHTML]").removeAttr("data-marker").off("click").on("click",function(a){U("embed")}),r.find("[data-marker=mailto]").removeAttr("data-marker").off("click").on("click",function(a){R()}),r.find("[data-marker=linkto]").removeAttr("data-marker").off("click").on("click",function(a){H()}),r.find("[data-marker=webAPI]").removeAttr("data-marker").off("click").on("click",function(a){D()}),r.find("[data-marker=eventReq]").removeAttr("data-marker").off("click").on("click",function(a){V()})},I=function(){var a="";a+='<div class="SC_srch shw">',a+='<table class="condition">',a+='<tbody><tr><td class="gbld">'+zcal.i18n.orgshare+"</td></tr></tbody>",a+="</table>",a+="</div>",a+="<div>",a+='<table class="condition">',a+="<tbody><tr><td>",a+='<span data-marker="enableOrgSh"><i class="'+(0!=c[10][3]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.enableorgadd+"</span></span>",0!=c[10][3]&&(a+='<div class="zcl_Sshp" style="margin-top: 15px;" id="permDiv">'+zcal.i18n.permission+' <span class="SC_select">',a+='<input value="'+(1==c[10][3]?zcal.i18n.private_shperm_freebusy:zcal.i18n.private_shperm_viewevent)+'" type="text" rel="'+(1==c[10][3]?zcal.i18n.private_shperm_freebusy:zcal.i18n.private_shperm_viewevent)+'" readonly="" data-marker="orgSharePerm" style="border: none;margin-top: 4px;margin-left: 4px;">',a+="</span></div>"),a+="</td></tr></tbody>",a+="</table>",a+="</div>",$orgShare.html(a),$orgShare.find("[data-marker=enableOrgSh]").removeAttr("data-marker").off("click").on("click",function(a){var e=$(this).find("i");orgPerm=e.hasClass("msi-check")?(e.removeClass("msi-check").addClass("msi-uncheck"),0):(e.removeClass("msi-uncheck").addClass("msi-check"),1),Z({perm:orgPerm,mode:"enadis"})}),$orgShare.find("[data-marker=orgSharePerm]").removeAttr("data-marker").off("click").on("click",function(a){var e=P(2),t=this;g({menuItems:e,par:this,parWidth:!0}).then(function(a){t.value=a.text,Z({perm:a.value,mode:"change"}),zmUtil.hideMenu()})})},Z=function(i){var l=i.perm,a="/cal/shareCal.do?orgshare="+l+"&mode=org-sh&calid="+s+"&caluid="+c[9]+"&calmode=0";ZCL_XHR(a,function(a){var e,t=ZCL_Evl(1,a.responseText);"success"===t.status&&(c[10][3]=t.orgPerm,e="change"==i.mode?zcal.i18n.orgsharechanged:0==l?zcal.i18n.orgshare_disabled:zcal.i18n.orgshare_enabled,zmUtil.succErrMsg("s",e),I())})},O=function(i){var l=i.perm,a="/cal/shareCal.do?pubshare="+l+"&mode=pub-sh&calid="+s+"&caluid="+c[9]+"&calmode=0";ZCL_XHR(a,function(a){var e,t=ZCL_Evl(1,a.responseText);"success"===t.status&&(c[10][1]=t.pub,e="change"===i.mode?zcal.i18n.publicsharechanged:0==l?zcal.i18n.publicshare_disabled:zcal.i18n.publicshare_enabled,zmUtil.succErrMsg("s",e)),x()})},N=function(i){var a,e=c[10][1];a="/cal/shareCal.do?pubshare="+(e=1==i?2==e?3:4:4==e?1:2)+"&mode=pub-sh&calid="+s+"&caluid="+c[9]+"&calmode=0",ZCL_XHR(a,function(a){var e,t=ZCL_Evl(1,a.responseText);"success"===t.status&&(c[10][1]=t.pub,e=0==i?zcal.i18n.allow_requisition_disabled:zcal.i18n.allow_requisition_enabled,zmUtil.succErrMsg("s",e)),x()})},U=function(a){$("#zcl_calpubaddress").length||$("body").append("<div id='zcl_calpubaddress' class='zcl_ovr'/>");var e,t=$("#zcl_calpubaddress");e='<div class="SC_set">',e+='<textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/"+(""==c[14]||"gcal"==c[14]?"":c[14]+"/")+a+"/"+c[9]+"</textarea>",e+='<span class="">'+zcal.i18n.calurlmsg+"</span>",e+="</div>",t.html(e);var i={title:zcal.i18n.publicaddress,mask:!0,pos:"center",closeaction:function(){t.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calpubaddress",i)},D=function(){$("#zcl_calwebapi").length||$("body").append("<div id='zcl_calwebapi' class='zcl_ovr'/>");var a,e=$("#zcl_calwebapi");a='<div class="SC_set SC_filt_bottom">',a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.calwebapimsg+"</td></tr>",a+='<tr><td><textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/eventreq/"+c[9]+"?name=[name]&mailId=[EmailId]&date=[MM/dd/yyyy]&time=[13:00]&reason=[Reason for Appointment]</textarea></td></tr>",a+="</table></div>",a+="</div>",a+="</div>",e.html(a);var t={title:zcal.i18n.apiforeventreq,mask:!0,pos:"center",closeaction:function(){e.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calwebapi",t)},R=function(){$("#zcl_calmailto").length||$("body").append("<div id='zcl_calmailto' class='zcl_ovr' style='width: 600px;'/>");var a=$("#zcl_calmailto");a.html('<div class="SC_set"><div class="zcl_ad_gr_m" style="max-height: 200px;overflow-y: auto;min-height:50px" ><input style="width:100%" id="zcl_emailgrp" type="text"  placeholder="Enter the email address" value=""><ul id="zcl_emUl" style="white-space:normal"></ul></div><span class="">By mailing the calendar to individuals/groups, they can subscribe to it.</span></div>');var e={title:"Mail To",mask:!0,pos:"center",closeaction:function(){a.remove(),zmsDialog.remove()},customClass:"SC_SetPop",buttons:[{txt:zcal.i18n.send,callback:function(){var a="";if(""!=$("#zcl_emailgrp")[0].value){var e=$("#zcl_emailgrp")[0].value;ZCL_isEmail(e)?a+=""!=a.trim()?","+e:e:($("#zcl_emailgrp")[0].value="",$("#zcl_emailgrp")[0].focus(),zmUtil.succErrMsg("e",zcal.i18n.entervalidemail))}if($("#zcl_emUl")[0].childNodes)for(var t in $("#zcl_emUl")[0].childNodes)if($("#zcl_emUl")[0].childNodes[t].id){var i=$("#zcl_emUl")[0].childNodes[t].id;a+=""!=a.trim()?","+i:i}if(a){var l=c[9];ZCL_XHR("/cal/mailTo.do?ckey="+l+"&mailids="+a.ZCL_calescape(),function(a){"success"==ZCL_Evl(1,a.responseText).status&&zmUtil.succErrMsg("s",zcal.i18n.mailsendsuccess)}),zmsDialog.remove()}}}]};zmsDialog.create("zcl_calmailto",e),setTimeout(function(){$("#zcl_emailgrp")[0].focus()},500),$("#zcl_emailgrp").on("keydown",function(a){if(13==a.keyCode&&"zcl_emailgrp"==this.id){for(var e=this.value.split(","),t=0;t<e.length;t++){var i=e[t].trim(),l=i.indexOf("<"),s=i.indexOf(">");-1<l&&-1<s&&(i=i.substring(l+1,s)),i=i.replace(/,/g,"")}if(ZCL_isEmail(i)){var n={};n.id=i;var c=document.createElement("li");c.setAttribute("id",n.id),c.innerHTML=(n.profileImage?"<img src="+n.profileImage+">":"<img src="+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+">")+"<span>"+n.id+'</span><i class="msi-close"></i>',$("#zcl_emUl").append(c),$("#zcl_emailgrp")[0].value="",$("#zcl_emUl").find(".msi-close").on("click",function(a){a.target.parentNode.remove()}),$("#zcl_emailgrp").val("")}}}),zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:$("#zcl_emailgrp")[0],excludeMe:!0,contactType:["org","crm","personal"],exclude:function(){var a=[];if($("#zcl_emUl")[0].childNodes){var e=$("#zcl_emUl")[0].childNodes;for(var t in e)a.push(e[t].id)}return a},onSelect:function(a,e){e=e.item.attributes;var t=document.createElement("li");t.setAttribute("data-zid",e.zid),t.setAttribute("id",e.id),t.innerHTML=(e.profileImage?"<img src="+e.profileImage+">":"<img src="+(zmail.defaultPhoto?zmail.defaultPhoto:zmResource.get("image","SC-Photo.png"))+">")+"<span>"+e.firstName+'</span><i class="msi-close"></i>',$("#zcl_emUl").append(t),$("#zcl_emailgrp")[0].value="",$("#zcl_emUl").find(".msi-close").on("click",function(a){a.target.parentNode.remove()})}})})},H=function(){$("#zcl_linkto").length||$("body").append("<div id='zcl_linkto' class='zcl_ovr'/>");var a,e=$("#zcl_linkto");a='<div class="SC_set">',a+='<textarea type="text" readonly class="zcl_Stxt"><a href="'+location.protocol+"//"+zcal.ZCAL+"/"+(""==c[14]||"gcal"==c[14]?"":c[14]+"/")+"ical/"+c[9]+'/mailto" style="background-image:url('+location.protocol+zcal.imgPath+"zoho/zcl_add_to_calendar.png?"+zcal.TSTAMP+');background-color:transparent;display:block;height:35px;width:111px;" target="_blank" alt='+ZCL_replaceProName(zcal.i18n.mailtotooltipmsg)+" title="+ZCL_replaceProName(zcal.i18n.mailtotooltipmsg)+"></a></textarea>",a+='<span class="">'+zcal.i18n.tolinkthiscalwebsite+"</span>",a+="</div>",e.html(a);var t={title:"Link To",mask:!0,pos:"center",closeaction:function(){e.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_linkto",t)};C.prototype={setTheme:function(a){this.theme=a},setLanguage:function(a){this.language=a},getURL:function(){return'<iframe src="'+location.protocol+"//"+zcal.ZCAL+"/eventreqForm/"+this.calKey+"?theme="+this.theme+"&l="+this.language+"&tz="+zcal.cdata.opt.TZLBL.zcalescape()+'" frameborder="0" scrolling="no" marginWidth="0" border="0px" marginHeight="0" height="350px" width="432px" allowTransparency="true" align="center"></iframe>'}};function F(){b&&b.html('<textarea class="zcl_Stxt">'+_.getURL()+"</textarea>")}var V=function(){$("#zcl_calereq").length||$("body").append("<div id='zcl_calereq' class='zcl_ovr'/>");var a,e,t=$("#zcl_calereq");_=new C({lang:"en",theme:0,ckey:c[9]}),e=["#D5E4F7","#899AFF","#6FC252","#D4D4D4","#FF8F8F","#FF8FC1","#C9CE46","#FFAE00","#6F0DC2","#C81515"],a='<div class="SC_set SC_filt_bottom">',a+='<div class="conditionDiv">',a+="<table><tr><td>",a+='<div><div class="zmL">',a+='<div class="SC_srch shw">',a+='<table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.chooseyourclolor+"</td></tr>",a+='<tr><td><ul class="zcl_cecolr" id="zcl_ereqTheme">';for(var i=0;i<e.length;i++)a+='<li style="background-color:'+e[i]+'" class='+(i===_.theme?"zcl_sl":"")+'><i class="msi-tick"></i></li>';a+="</ul></td></tr>",a+="</table>",a+="</div>",a+="</div></div>",a+="</td>",a+="<td>",a+='<div><div class="zmL">',a+='<div class="SC_srch shw">',a+='<table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.language+"</td></tr>",a+='<tr><td><table><tr><td><div class="SC_select" data-marker="languageSel"></div></td></tr></table></td></tr>',a+="</table>",a+="</div>",a+="</div></div>",a+="</td></tr></table>",a+="</div>",a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.calwebapimsg+"</td></tr>",a+='<tr><td data-marker="ereqCode"><textarea class="zcl_Stxt">'+_.getURL()+"</textarea></td></tr>",a+="</table></div>",a+="</div>",a+="</div>",t.html(a),b=t.find("[data-marker=ereqCode]").removeAttr("data-marker"),t.find("#zcl_ereqTheme").find("li").off("click").on("click",function(a){var e=$(this);e.parent().find("li").removeClass("zcl_sl"),e.addClass("zcl_sl"),_.setTheme(e.index()),F()});var l=t.find("[data-marker=languageSel]").removeAttr("data-marker"),s=function(){var a=zcalEmbed.languages(),e='<select class="select">';for(var t in a)e+='<option value="'+t+'">'+a[t]+"</option>";return e+="</select>"}();l.html(s),l.find("select").off("change").on("change",function(a){_.setLanguage(this.value),F()});var n={title:zcal.i18n.calpubevtreq,mask:!0,pos:"center",closeaction:function(){t.remove(),zmsDialog.remove()},customClass:"SC_SetPop",buttons:[{txt:zcal.i18n.preview,callback:function(){var a,e=window.open();e.document.open(),a=_.getURL().replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),e.document.write("<html><body>"+a+"</body></html>"),e.document.close()}}]};zmsDialog.create("zcl_calereq",n)},G=function(){var a='<div class="SC_srch shw">';a+='<table class="condition">',a+="<tbody>",a+='<tr><td class="gbld">'+zcal.i18n.privateaddress+"</td></tr>",a+="</tbody>",a+="</table>",a+="</div>",a+="<div>",a+='<table class="condition">',a+="<tbody>",a+="<tr><td>",a+='<span data-marker="enablePvtURL"><i class="'+(c[10][0]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.endableprivateadd+"</span></span>",c[10][0]&&(a+='<div class="zcl_Sshp"><div><span class="zcl_lk" data-marker="pvtICAL">'+zcal.i18n.ical+'</span><span class="zcl_sp"></span><span class="zcl_lk" data-marker="pvtHTML">'+zcal.i18n.html+"</span>",a+='<span class="SC_button zcl_ovr" data-marker="pvtReset">'+zcal.i18n.reseturl+"</span></div></div>"),a+="</td></tr>",a+="</tbody>",a+="</table>",a+="</div>",d.html(a),d.find("[data-marker=enablePvtURL]").removeAttr("data-marker").off("click").on("click",function(a){var e,t=$(this).find("i");t.hasClass("msi-check")?(t.removeClass("msi-check").addClass("msi-uncheck"),e="priv-dis"):(e="priv-reset",t.removeClass("msi-uncheck").addClass("msi-check")),j({mode:e,msg:"enable/disable"})}),d.find("[data-marker=pvtICAL]").removeAttr("data-marker").off("click").on("click",function(a){B("ical")}),d.find("[data-marker=pvtHTML]").removeAttr("data-marker").off("click").on("click",function(a){B("embed")}),$pvtReset=d.find("[data-marker=pvtReset]").removeAttr("data-marker"),$pvtReset.off("click").on("click",function(a){j({mode:"priv-reset",msg:"reset"})})},j=function(t){var a=c[9],i=t.mode;ZCL_XHR("/cal/shareCal.do?calid="+s+"&caluid="+a+"&mode="+i+"&calmode=0",function(a){var e=ZCL_Evl(1,a.responseText);"priv-reset"===i?(c[10][0]=e.pvtId,zmUtil.succErrMsg("s","reset"==t.msg?zcal.i18n.privateurlchanged:zcal.i18n.privateshare_enabled)):(c[10][0]=null,zmUtil.succErrMsg("s",zcal.i18n.privateshare_disabled)),G()})},B=function(a){var e;$("#zcl_calpvtaddress").length||$("body").append("<div id='zcl_calpvtaddress' class='zcl_ovr'/>"),e=$("#zcl_calpvtaddress");var t='<div class="SC_set">';t+='<textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/"+(""==c[14]?"":c[14]+"/")+a+"/"+c[9]+"/pvt_"+c[10][0]+"</textarea>",t+='<span class="">'+zcal.i18n.calurlmsg+"</span>",t+="</div>",e.html(t);var i={title:zcal.i18n.privateaddress,mask:!0,pos:"center",closeaction:function(){e.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calpvtaddress",i)},q=function(){zmail.Settings.MailSuite.App.Core.Framework.requestPreviewCard().done(function(a){a.close()})};return a.close=q,a}(zcalShareView||{}),zcalEmbedView=function(a){var n,d,c,o,p,m,u,v;a=a||{};function f(){return[zcal.i18n.blue,zcal.i18n.green,zcal.i18n.red,zcal.i18n.pink,zcal.i18n.violet,zcal.i18n.rosybrown,zcal.i18n.purple,zcal.i18n.grey,zcal.i18n.orange,zcal.i18n.brown,zcal.i18n.yellow]}function z(a){this.template=a&&a.type||0,this.title=a&&a.title,this.defaultCal=a&&a.dcal,this.selectedCal=[],this.view=e[this.template].v,this.color=e[this.template].c,this.language=a&&a.lang||"en",this.width=e[this.template].w,this.height=e[this.template].h,this.timezone=a&&a.tz,this.showTitle=!0,this.showTimezone=!0,this.detailview=!1}var e=[{w:"600",h:"500",c:-1,v:0},{w:"300",h:"500",c:0,v:-1},{w:"350",h:"500",c:10,v:-1},{w:"300",h:"500",c:0,v:-1},{w:"400",h:"400",c:-1,v:-1},{w:"700",h:"270",c:0,v:-1},{w:"300",h:"400",c:-1,v:-1},{w:"350",h:"500",c:1,v:-1},{w:"300",h:"500",c:7,v:-1},{w:"300",h:"500",c:0,v:-1}];z.prototype={setTemplate:function(a){this.template=parseInt(a),this.view=e[this.template].v,this.color=e[this.template].c,this.width=e[this.template].w,this.height=e[this.template].h},setTitle:function(a){this.title=a},setCalendars:function(a){this.selectedCal=""!=a?a.split(","):[]},setView:function(a){this.view=parseInt(a)},setColor:function(a){this.color=parseInt(a)},setLanguage:function(a){this.language=a},setWidth:function(a){this.width=parseInt(a)},setHeight:function(a){this.height=parseInt(a)},setTimezone:function(a){this.timezone=a},setShowTitle:function(a){this.showTitle=a},setShowTimezone:function(a){this.showTimezone=a},setDetailview:function(a){this.detailview=a},getURL:function(){var a='<iframe src="'+location.protocol+"//"+zcal.ZCAL+(""===c[14]||"gcal"===c[14]?"":"/"+c[14])+"/embed/"+this.defaultCal+"?";if(zcal.cdata.calLst[d]){var e=this.selectedCal.length,t="";if(0!=e)for(var i=0;i<e;i++)t+=(0==i?"":",")+this.selectedCal[i];a+=""!=t?"cal="+t+"&":""}return a+="title="+ZCL_getHTML(this.title).replace("&#39;","").zcalescape(),a+="&type="+(this.template+1),a+="&l="+this.language,a+="&tz="+this.timezone.zcalescape(),a+="&shtitle="+(this.showTitle?1:0),a+="&shtz="+(this.showTimezone?1:0),a+="&shdv="+(this.detailview?1:0),a+=-1!=this.color?"&c="+this.color:"",a+=-1!=this.view?"&v="+this.view:"",a+='" width="'+this.width+'" height="'+this.height+'" frameborder="0" scrolling="no"></iframe>'}};function h(){0==zcal.timezones.length&&ZCL_uXHR("/cal/timez.do",function(a){zcal.timezones=ZCL_Evl(1,a.responseText)}),t(),i(),l(),b()}var t=function(){p&&p.html('<div><div class="zcl_emb'+(o.template+1)+'"></div></div>')},i=function(){var a,e,t;if(m){t='<div class="zmL">',t+='<div class="SC_srch shw">',t+='<table class="condition">',t+="<tbody><tr>",t+='<td class="gbld">'+zcal.i18n.title+"</td>",t+="</tr><tr>",t+='<td><div class="SC_select SC_selectnoneArw first"><input placeholder="Untitled"  class="SC_tiput"  value="'+ZCL_getHTML(o.title)+'" type="text"></div></td>',t+="</tr></tbody>",t+="</table>",t+="</div>",t+="</div>",zcal.cdata.calLst[d]&&(t+='<div class="zmL">',t+='<div class="SC_srch shw">',t+='<table class="condition">',t+="<tbody><tr>",t+='<td class="gbld">'+zcal.i18n.select_calendar+'</td></tr><tr><td><select style="width:100%" size="4" multiple="multiple"/></td>',t+="</tr></tbody>",t+="</table>",t+="</div>",t+="</div>"),-1==o.color&&-1==o.view||(t+='<div class="zmL">',t+='<div class="SC_srch shw">',t+='<table class="condition">',t+="<tbody>",t+='<tr><td class="gbld">'+(-1!=o.view?zcal.i18n.chooseyourview:zcal.i18n.chooseacolor)+"</td></tr>",t+='<tr><td><table><tbody><tr><td><div class="SC_select first" data-marker="viewColorSel"><input type="text" id="color" class="disabled"  readonly value='+zcal.i18n.vday+"></div></td></tr></tbody></table></td></tr>",t+="</tbody>",t+="</table>",t+="</div>",t+="</div>"),m.html(t),m.find("input.SC_tiput").off("change").on("change",function(a){o.setTitle(this.value),b()}),a=m.find("select");var i=C();if(a.html(i),a.off("click").on("click",function(a){var e=$(this),t=[];$.each(e.find("option:selected"),function(){var a=$(this).val();a!=o.defaultCal&&t.push(a)}),o.setCalendars(t.join(",")),b()}),e=m.find("[data-marker=viewColorSel]").removeAttr("data-marker"))if(-1!=o.color){for(var l=f(),s=[],n=0;n<l.length;n++){$("#color")[0].value=l[o.color];var c={text:l[n],value:n};s.push(c)}e.on("click",function(a){var e=a.target;_({menuItems:s,par:this,parWidth:!0}).then(function(a){e.value=a.text,o.setColor(a.value),b(),zmUtil.hideMenu()})})}else if(-1!=o.view){var r=[{text:zcal.i18n.vday,value:0},{text:zcal.i18n.week,value:1},{text:zcal.i18n.month,value:2}];e.on("click",function(a){var e=a.target;_({menuItems:r,par:this,parWidth:!0}).then(function(a){e.value=a.text,o.setView(a.value),b(),zmUtil.hideMenu()})})}}},l=function(){var a,e;if(u){e='<div class="zmL">',e+='<div class="SC_srch shw">',e+='<table class="condition">',e+="<tbody>",e+='<tr><td class="gbld">'+zcal.i18n.language+"</td></tr>",e+='<tr><td><table><tbody><tr><td><div class="SC_select first" data-marker="languageSel"><input type="text" id="lan" class="disabled"  readonly value="English"></div></td></tr></tbody></table></td></tr>',e+="</tbody>",e+="</table>",e+="</div>",e+="</div>",e+='<div class="zmL">',e+='<div class="SC_srch shw">',e+="<table>",e+="<tbody><tr>",e+='<td><table class="condition"><tbody><tr><td class="gbld">'+zcal.i18n.width+'</td></tr><tr><td><table><tbody><tr><td><div class="SC_select SC_selectnoneArw first"><input id="zcl_embedWdt" value="'+o.width+'px" type="text"></div></td></tr></tbody></table></td></tr></tbody></table></td>',e+='<td><table class="condition"><tbody><tr><td class="gbld">'+zcal.i18n.height+'</td></tr><tr><td><table><tbody><tr><td><div class="SC_select SC_selectnoneArw"><input id="zcl_embedHgt" value="'+o.height+'px" type="text"></div></td></tr></tbody></table></td></tr></tbody></table></td>',e+="</tr></tbody>",e+="</table>",e+="</div>",e+="</div>",e+='<div class="zmL">',e+='<div class="SC_srch shw">',e+='<table class="condition">',e+="<tbody>",e+="<tr><td><table><tbody><tr>",e+='<td><span class="mLnone mr20" id="zcl_embedShowTitle"><i  class="'+(o.showTitle?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.title+"</span></span></td>",e+='<td><span class="mLnone" id="zcl_embedShowTz"><i  class="'+(o.showTimezone?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.timezone+"</span></span></td>",e+="</tr></tbody></table></td></tr>",0==o.template&&(e+='<tr><td><span class="mLnone" id="zcl_embedDview"><i class="'+(o.detailview?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.detailsview+"</span></span></td></tr>"),e+="</tbody>",e+="</table>",e+="</div>",e+="</div>",u.html(e),a=u.find("[data-marker=languageSel]").removeAttr("data-marker");var t=-1!=zcal.ZCAL.indexOf(".baihui.com")?{zh:zcal.i18n.chines,en:zcal.i18n.english}:{en:zcal.i18n.english,da:zcal.i18n.danish,de:zcal.i18n.german,es:zcal.i18n.spanish,fr:zcal.i18n.french,hu:zcal.i18n.hungarian,it:zcal.i18n.italian,ja:zcal.i18n.japanes,nl:zcal.i18n.dutch,pl:zcal.i18n.polish,pt:zcal.i18n.portuguese,ru:zcal.i18n.russian,sv:zcal.i18n.swedish,tr:zcal.i18n.turkish,zh:zcal.i18n.chines},i=[];for(var l in t){var s={text:t[l],value:l};i.push(s)}a.on("click",function(a){var e=a.target;_({menuItems:i,par:this,parWidth:!0}).then(function(a){e.value=a.text,o.setLanguage(a.value),b(),zmUtil.hideMenu()})}),$wdtDOM=u.find("#zcl_embedWdt"),$wdtDOM.off("change").on("change",function(a){var e=this.value;""!=e&&(e=e.replace(/\D/g,""),o.setWidth(e),b())}),u.find("#zcl_embedHgt").off("change").on("change",function(a){var e=this.value;""!=e&&(e=e.replace(/\D/g,""),o.setHeight(e),b())}),u.find("#zcl_embedShowTitle").off("click").on("click",function(a){var e,t,i;i="msi-check"==(e=(t=$(this).find("i")).hasClass("msi-check")?"msi-uncheck":"msi-check"),t.attr("class",e),o.setShowTitle(i),b()}),u.find("#zcl_embedShowTz").off("click").on("click",function(a){var e,t,i;i="msi-check"==(e=(t=$(this).find("i")).hasClass("msi-check")?"msi-uncheck":"msi-check"),t.attr("class",e),o.setShowTimezone(i),b()}),u.find("#zcl_embedDview").off("click").on("click",function(a){var e,t,i;i="msi-check"==(e=(t=$(this).find("i")).hasClass("msi-check")?"msi-uncheck":"msi-check"),t.attr("class",e),o.setDetailview(i),b()})}},g=function(){return'<input value="'+ZCL_getHTML(zcal.cdata.opt.CTIM)+'" type="text"  rel='+ZCL_getHTML(zcal.cdata.opt.TIM)+' readonly="" id="zcl_emTZ">'},C=function(){var a=zcal.cdata.calOrdArr,i="";return a.forEach(function(a){var e=zcal.cdata.calLst,t=e[a][9]==o.defaultCal||-1!=o.selectedCal.indexOf(e[a][9])?"selected":"";i+='<option value="'+e[a][9]+'" '+t+">"+ZCL_getHTML(e[a][0])+"</option>"}),i},_=function(a){var i=[];(a.menuItems||[]).forEach(function(a){var e=a.value,t=a.text;i.push({htm:"<div>"+t+"</div>",data:{value:e,text:t}})});var l=$.Deferred();return a.list=i,a.clk=function(a,e,t){l.resolve(a,e,t)},a.onHide=function(){l.reject()},i.length?zmsuite.showMenu(a):l.reject(),l.fail(zmUtil.hideMenu),l.promise()},b=function(){v&&v.html('<textarea class="zcl_Stxt">'+o.getURL()+"</textarea>")};return a.render=function(a,e){d=a,o=new z({title:(c=e)[0],dcal:c[9],tz:zcal.cdata.opt.TIM,lang:zcal.cdata.opt.LANG});var t,i="";n=$('<div id="calembed" class="SC_Twpr zcl_Twpr" style="top:46px"><div class="SC_filt_bottom SC_filt_bottomCustom" id="SC_embed"></div>');var l='<div class="editFilterParent zcl_stfrm">';l+='<div class="zcl_Semdtmp" data-marker="embedTpl">',l+="</div>",l+='<div class="conditionDiv">',l+='<table class="zcl_Semdsp">',l+="<tbody>",l+="<tr>",l+='<td data-marker="embedTplImg"></td>',l+='<td><div data-marker="embedTitleSec"></div></td>',l+='<td><div data-marker="embedTZSec"></div></td>',l+="</tr>",l+="</tbody>",l+="</table>",l+="</div>",l+='<div class="zmL">',l+='<div class="SC_srch shw">',l+='<table class="condition">',l+='<tbody><tr><td class="gbld">'+zcal.i18n.timezone+'</td></tr><tr><td><table><tbody><tr><td><div style="width: 380px!important" class="SC_select first" id="zcl_embedTZ">'+g()+"</div></td></tr></tbody></table></td></tr></tbody>",l+="</table>",l+="</div>",l+="</div>",l+='<div class="zmL">',l+='<div class="SC_srch shw">',l+='<table class="condition">',l+="<tbody>",l+='<tr><td class="gbld">'+zcal.i18n.embed_instruction+"</td></tr>",l+='<tr><td><table class="zcl_w100pc">',l+='<tbody><tr><td data-marker="embedCode"></td></tr></tbody>',l+="</table></td></tr>",l+="</tbody>",l+="</table>",l+="</div>",l+="</div>",l+='<div class="SC_PUbtm">',l+='<span class="sel" id="pre">'+zcal.i18n.preview+"</span>",l+='<span data-val="Cancel" id="ref">'+zcal.i18n.refresh+"</span>",l+="</div>",l+="</div>",n.find("#SC_embed").append(l),t=n.find("[data-marker=embedTpl]").removeAttr("data-marker");for(var s=0;s<10;s++)i+="<span "+(s==o.template?'class="zcl_sl"':"")+">"+(s+1)+"</span>";t.html(i),t.find("span").off("click").on("click",function(a){var e=$(this);e.parent().find("span").removeClass("zcl_sl"),e.addClass("zcl_sl"),o.setTemplate(e.index()),h()}),n.find("#zcl_emTZ").on("click",function(){var a=zcal.timezones,e=[];for(var t in a)for(var i in a[t]){var l={};l.id=i,l.name=a[t][i]+" ("+i+")",l.display_text=a[t][i]+" ("+i+")",e.push(l)}var s,n={},c=$(this);n.parentDOM=c.parent(),n.displayAs="dropdown",n.parWidth=!0,n.onSelect=function(a,e){r(c,a,e),s.hide()},n.dataCallback=function(){return e},(s=zmUtil.createFLComp("generic",n)).show()});var r=function(a,e,t){a.val(t.display_text),a.attr("rel",e),o.setTimezone(e),b()};return n.find("#zcl_embedShowTz").off("click").on("click",function(a){var e,t,i;i="msi-check"==(e=(t=$(this).find("i")).hasClass("msi-check")?"msi-uncheck":"msi-check"),t.attr("class",e),o.setShowTimezone(i),b()}),n.find("#pre").on("click",function(){var a,e=window.open();e.document.open(),a=o.getURL().replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),e.document.write("<html><body>"+a+"</body></html>"),e.document.close()}),n.find("#ref").on("click",function(){o=new z({title:c[0],dcal:c[9],tz:zcal.cdata.opt.TIM,lang:zcal.cdata.opt.LANG,type:o.template}),h()}),p=n.find("[data-marker=embedTplImg]").removeAttr("data-marker"),m=n.find("[data-marker=embedTitleSec]").removeAttr("data-marker"),u=n.find("[data-marker=embedTZSec]").removeAttr("data-marker"),v=n.find("[data-marker=embedCode]").removeAttr("data-marker"),h(),n},a.showAllTimezone=function(){var a="<select>";for(var e in zcal.timezones)for(var t in zcal.timezones[e]){a+="<option "+(zcal.cdata.opt.TIM==t?"selected":"")+" value="+t+">"+ZCL_getHTML(zcal.timezones[e][t])+" ("+t+")</option>"}a+="</select>",$("#zcl_embedTZ").html(a),u.find("#zcl_embedTZ select").off("change").on("change",function(a){o.setTimezone(this.value),b()})},a}(zcalEmbedView||{});_defineSettingsModule("MGAOCalendars",function(a,e){"use strict";function t(){return e("MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView")}function i(){var a,e=d.makeDeferred();return $.Deferred(),"undefined"==typeof zcal?(a=$.Deferred(),zmApp.loadCalendar("/calendar/settings",a),a.promise()).done(function(){t().initialize({process:e})}).fail(e.reject):t().initialize({process:e}),e.promise()}function l(){var a=d.makeDeferred();return t.uninitialize({process:a}),a.promise()}function s(){return t().getMGAOCalendarsView()}function n(){return null}var c,r=e("Platform.Components").SettingAppManager,d=e("Platform.System.Utils");c=r.create("calendar-mgaocalendars",{attributes:{page:"calendar-mgaocalendars",isReactApp:!1},initialize:i,uninitialize:l,getView:s,handleContainerEvent:n}),a.App=c},"MailSuite.Apps"),function(a){"use strict";var e="calendar-mgaocalendars",t="calendar-mgaocalendars",i="my-calendars",l="group-calendars",s="app-calendars",n="other-calendars",c={cardItem:{title:"My Calendars"}},r={cardItem:{title:"Group Calendars"}},d={cardItem:{title:"App. Calendars"}},o={cardItem:{title:"Other Calendars"}},p=a("Platform.Components"),m=a("Platform.Entities"),u=(a("MailSuite.Settings.Calendar"),a("Platform.System.Utils"),p.SettingCardItemManager),v=m.SettingCardItem.Types;u.create(i,{props:{title:c.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:function(){zmail.Settings.MailSuite.App.openApp().done(function(){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage(t).done(function(){zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView.getMGAOCalendarsView()}).fail(function(){})})}}),u.create(l,{props:{title:r.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:function(){zmail.Settings.MailSuite.App.openApp().done(function(){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage(t).done(function(){zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView.groupCalendarView()}).fail(function(){})})}}),u.create(s,{props:{title:d.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:function(){zmail.Settings.MailSuite.App.openApp().done(function(){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage(t).done(function(){zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView.appCalendarView()}).fail(function(){})})}}),u.create(n,{props:{title:o.cardItem.title},attributes:{type:v.Action,card:e},primaryAction:function(){zmail.Settings.MailSuite.App.openApp().done(function(){zmail.Settings.MailSuite.App.Core.Framework.requestShowPage(t).done(function(){zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView.otherCalendarView()}).fail(function(){})})}})}(zmail.Settings.Modules.import),_defineSettingsModule("ZCAL_Setinit",function(a,e){"use strict";var n;n=$.Deferred(),$.subscribe("/zm-settings/mailsuite-app/opened",function(){var a;(a=$.Deferred(),zmApp.loadCalendar("/calendar/settings",a),a.promise()).done(function(){var a=[zcal.i18n.allow,zcal.i18n.dontallow,zcal.i18n.allowiffree],e=[zcal.i18n.off,zcal.i18n.on],t=zmail.Settings.Platform.Components.SettingCardItemManager,i=zmail.Settings.Platform.Components.SettingCardManager,l=zmail.Settings.Platform.Components.CategoryManager,s=zmail.Settings.Platform.Components.SettingPageManager;l.get("calendar").setProp("title",zcal.i18n.calendar),i.get("calendar-generals").setProp("title",zcal.i18n.calendarpreferences),i.get("email-notify").setProp("title",zcal.i18n.emailnotification),i.get("calendar-import").setProp("title",zcal.i18n.import),i.get("calendar-subscribe").setProp("title",zcal.i18n.subscribe),i.get("calendar-sync").setProp("title",zcal.i18n.synchronize),zmail.isRebranded||(i.get("calendar-zohoapp").setProp("title",ZCL_replaceComName(zcal.i18n.zohoapps)),s.get("calendar-zohoapp").setProp("title",ZCL_replaceComName(zcal.i18n.zohoapps)),t.get("zoho-crm").setProp("title",ZCL_replaceComName(zcal.i18n.zohocrm)),zmail.isFuji||t.get("zoho-recruit").setProp("title",ZCL_replaceComName(zcal.i18n.zohorecruit)),t.get("zoho-task").setProp("title",ZCL_replaceComName(zcal.i18n.zohotask)),t.get("zoho-projects").setProp("title",ZCL_replaceComName(zcal.i18n.zohoprojects)),t.get("zoho-contacts").setProp("title",ZCL_replaceComName(zcal.i18n.zohocontacts))),i.get("calendar-mgaocalendars").setProp("title",zcal.i18n.calendars),s.get("calendar-generals").setProp("title",zcal.i18n.calendarpreferences),s.get("email-notify").setProp("title",zcal.i18n.emailnotification),s.get("calendar-import").setProp("title",zcal.i18n.import),s.get("calendar-subscribe").setProp("title",zcal.i18n.subscribe),s.get("calendar-sync").setProp("title",zcal.i18n.synchronize),t.get("time-zone").setProp("title",zcal.i18n.timezone),t.get("date-format").setProp("title",zcal.i18n.dateformat),t.get("time-format").setProp("title",zcal.i18n.timeformat),t.get("default-view").setProp("title",zcal.i18n.defaultview),t.get("automatic-invi").setProp("title",zcal.i18n.automatic_inv),t.get("reminder-notifi").setProp("title",zcal.i18n.reminder_notification),t.get("email-address").setProp("title",zcal.i18n.emailaddress),t.get("agenda-notify").setProp("title",zcal.i18n.agendanotification),t.get("by-file").setProp("title",zcal.i18n.file),t.get("by-url").setProp("title",zcal.i18n.url),t.get("web-url").setProp("title",zcal.i18n.weburl),t.get("friends-calendar").setProp("title",zcal.i18n.friendscalendar),t.get("holi-day").setProp("title",zcal.i18n.holiday),ZCL_GRP_SECTION?(t.get("groups").setProp("title",zcal.i18n.groups),t.get("group-calendars").setProp("title",zcal.i18n.groupcalendars)):(t.get("groups").setProp("title",""),t.get("group-calendars").setProp("title","")),zmail.isFuji||zmail.isBaihui||-1!=document.domain.indexOf("zoho.in")||t.get("microsoft-outlook").setProp("title",zcal.i18n.outlook),zmail.isFuji||zmail.isBaihui||t.get("zoho-calsync").setProp("title",ZCL_replaceComName(zcal.i18n.zcalsync)),zmail.isBaihui||t.get("google-calendar").setProp("title",zcal.i18n.gcal),t.get("cal-dav").setProp("title",zcal.i18n.caldav),t.get("my-calendars").setProp("title",zcal.i18n.mycalendars),t.get("app-calendars").setProp("title",zcal.i18n.appcalendars),t.get("other-calendars").setProp("title",zcal.i18n.othercalendars),t.get("time-zone").setProp("value",zcal.cdata.opt.TIM),t.get("date-format").setProp("value",zcal.DATEFORMAT[zcal.cdata.opt.DF]),t.get("time-format").setProp("value",zcal.TIMEFORMAT[zcal.cdata.opt.TF]),t.get("default-view").setProp("value",zcal.DEFAULTVIEW[zcal.cdata.opt.DEF]),t.get("automatic-invi").setProp("value",a[zcal.cdata.opt.SIE]),t.get("reminder-notifi").setProp("value",e[zcal.cdata.opt.REM]),void 0===zcal.cdata.opt.CMAIL?t.get("email-address").setProp("value",zcal.cdata.opt.MTO):t.get("email-address").setProp("value",zcal.cdata.opt.CMAIL),t.get("agenda-notify").setProp("value",zcal.AGENDA_INTERVAL[zcal.cdata.opt.AI]),n.resolve()}).fail(function(){SystemUtils.debugLog("Module load failed !!!"),n.reject()})}),n.promise()},"MailSuite.Apps.ZCAL_Setinit");
