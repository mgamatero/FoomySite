"use strict";define([],function(n,e){var t=n("zmComponent"),g=zmText.get("markdown");t.markdown={};var a=function(){function n(){babelHelpers.classCallCheck(this,n)}return babelHelpers.createClass(n,[{key:"init",value:function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.constructMarkdownComponent(n)}},{key:"setHeight",value:function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=$.e(n.$el);$.e(e).css("height","400px")}},{key:"constructMarkdownComponent",value:function(){var n={showArrow:!0,par:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).par,removeLi:!0,liDom:$.e(this.constructDOM()),spanClass:["minwid","zmMarkDownDD"].join(" ")},e=new zmDropDownMenu(n);e.paint(),this.setHeight(e)}},{key:"getMarkdownKeyValue",value:function(){var n=zdom("b",null,g.bold),e=zdom("i",null,g.italic),t=zdom("u",null,g.underline),a=zdom("strike",null,g.strike),r=zdom("h1",null,g.heading1),i=zdom("h2",null,g.heading2),o=zdom("h3",null,g.heading3),l=zdom("h4",null,g.heading4),h=zdom("h5",null,g.heading5),c=zdom("span",null,zdom("blockquote",{className:"SC_quote"},"blockquote")),u=zdom("span",null,zdom("span",{className:"zmBlueLink cursorPointer"},g.text)),s=zdom("span",null,g.image),d=zdom("mark",null,g.highlight);return{values:{bold:"*"+g.bold+"*",italic:"-"+g.italic+"-",underline:"_"+g.underline+"_",strike:"~"+g.strike+"~",heading1:"# "+g.heading1,heading2:"## "+g.heading2,heading3:"### "+g.heading3,heading4:"#### "+g.heading4,heading5:"##### "+g.heading5,text:"! "+g.quote,link:g.linkMarkdown,image:g.imageMarkdown,highlight:"`"+g.highlight+"`"},tags:[n,e,t,a,r,i,o,l,h,c,u,s,d]}}},{key:"constructComponent",value:function(){return zdom("div",{ref:"container",className:"zmMarkDownDDWrap"},zdom("div",{className:"zmMarkDownDDHdr"},zdom("div",{className:"zmMarkDownValue"},zdom("div",{className:"zmMarkDownKey"},g.key),zdom("div",{className:"zmMarkDownAction"},g.action))),zdom("div",{ref:"content",className:"zmMarkDownDDCont"}))}},{key:"constructDOM",value:function(){var t,a,r,n=_zm.getDOMReferenceMap(this.constructComponent(),!1),i=n.content,e=this.getMarkdownKeyValue(),o=e.values,l=e.tags;return Object.keys(o).forEach(function(n,e){a=zdom("div",{className:"zmMarkDownKey"},o[n]),r=zdom("div",{className:"zmMarkDownAction"}),$.e(r).appendDOM(l[e]),t=zdom("div",{className:"zmMarkDownValue"}),$.e(t).appendDOM(a),$.e(t).appendDOM(r),$.e(i).appendDOM(t)}),n.container}}]),n}();return t.markdown.UI=a,t}),define([],function(n,e){var t=n("zmComponent.markdown"),O=[".",",","(",")","[","]"],y=[];return t.Component=function(n){var i,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d={"*":["<b>","</b>"],"-":["<i>","</i>"],"~":["<strike>","</strike>"],_:["<u>","</u>"],"`":["<span class='highlight'style='background-color:#fff8a6'>","</span>"]},g={h5:"##### ",h4:"#### ",h3:"### ",h2:"## ",h1:"# ",quote:"!"},m={"# ":"</h1>","## ":"</h2>","### ":"</h3>","#### ":"</h4>","##### ":"</h5>","!":"</blockquote>"},f={"##### ":["<h5>","</h5>"],"#### ":["<h4>","</h4>"],"### ":["<h3>","</h3>"],"## ":["<h2>","</h2>"],"# ":["<h1>","</h1>"],"!":["<blockquote>","<blockquote>"]},v=[];i=function(n,e){var t=n.length;if(0===t)return[];for(var a,r=0,i=[];-1<(a=e.indexOf(n,r));){var o;o={start:a,end:a+n.length},i.push(o),r=a+t}return i};var p=function(n,e){var t,a=function(e){var t=[],n=e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g);n&&n.forEach(function(n){i(n,e).forEach(function(n){t.push(n)})});var a=e.match(/target="_blank"/g);return a&&a.forEach(function(n){i(n,e).forEach(function(n){t.push(n)})}),t}(n),r=[];return e.some(function(e){return t&&(r.push(t),t=null),a.some(function(n){return!(e<n.start||e>n.end)||r.includes(e)?!(t=null):(t=e,"")}),""}),t&&r.push(t),0===a.length?e:r},c=function(t,n,e,a){if(zmUtil.parseURLS(t).length)return t;var r,i,o,l,h,c,u;if("#"===n||"!"===n)return 0!==e.start||Object.keys(g).forEach(function(n){v=[];var e=g[n];if(zmUtil.parseURLS(t).length)return t;t=function n(e,t,a,r){var i;if(0===e.length)return[];var o,l=f[e];return-1<t.indexOf(e)&&(i=t.indexOf(e),""===t.charAt(i-1)&&(o=l[0],y.push(m[e]),n(e,t=t.replace(t.substring(i,i+e.length),o)))),v.push(t),v[0]}(e,t)}),t;if(void 0===e||0!==e.start&&" "!==a.charAt(e.start-1)&&!O.includes(a.charAt(e.start-1))||" "!==a.charAt(e.end)&&!e.lastWord&&!O.includes(a.charAt(e.end)))return t;var s=[];return s.push(0),s.push(t.length-1),r=n,l=0,h=p(i=t,s),c=d[r],u=h.length,h.forEach(function(n,e){if(h[e-1]){if(h[e-1]+r.length!==h[e]||e%2==0){if(o=l%2==0?c[0]:c[1],u%2!=0&&l%2==0&&u-1===e)return!1;i=i.substring(0,n)+o+i.substring(n+r.length),l++,h.forEach(function(n,e){h[e]=n+(o.length-r.length)})}}else if(0===e){var t=c[0];i=i.substring(0,n)+t+i.substring(n+r.length),l++,h.forEach(function(n,e){h[e]=n+(t.length-r.length)})}}),t=i},t={"*":/\*+([^*]+)\*+/g,_:/_+([^_]+)_+/g,"-":/-+([^-]+)-+/g,"~":/~+([^~]+)~+/g,"`":/`+([^`]+)`+/g,"#":/#{1,5}\s[^#]*/g,"!":/!\s+([^!])/g},a=n.split("\n");Object.keys(t).forEach(function(h,n){a.forEach(function(l,n){y=[];var e=l.match(t[h]);null!==e&&e.forEach(function(n){var e=l.indexOf(n),t=e+n.length,a=!1;t===l.length&&(a=!0);var r=c(n,h,{start:e,end:t,lastWord:a},l),i=l.indexOf(n),o=l.substring(i,i+n.length);l=l.replace(o,r)}),y.forEach(function(n){void 0!==n&&(l+=n)}),a[n]=l})}),a=a.join("\n");var o,l,h,r,u,s,k,z,b=(l=/\[.*?\]/gm,h=/\(.*?\)/gm,null!==(r=(o=a).match(/!\[.*?\]\(.*?\)/gm))&&0<r.length&&r.forEach(function(n){var e=n.match(l),t=n.match(h);e=(e=e[0].replace("[","")).replace("]","");var a=/<a.*?>(.*)?<\/a>/;null!==(t=(t=t[0].replace(")","")).replace("(","")).match(a)&&(t=t.match(a)[1]);var r=zdom("img",null);$.e(r).attr("alt",e),$.e(r).attr("src",t);var i=o.indexOf(n);zmUtil.parseURLS(t).length&&(o=o.replace(o.substring(i,i+n.length),r.outerHTML))}),o);s=/\[.*?\]/gm,k=/\(.*?\)/gm,null!==(z=(u=b).match(/\[.*?\]\(.*?\)/gm))&&0<z.length&&z.forEach(function(n){var e=n.match(s),t=n.match(k);e=(e=e[0].replace("[","")).replace("]","");var a=/<a.*?>(.*)?<\/a>/;null!==(t=(t=t[0].replace(")","")).replace("(","")).match(a)&&(t=t.match(a)[1]);var r=zdom("a",null);$.e(r).attr("href",t),$.e(r).attr("target","_blank"),$.e(r).text(e);var i=u.indexOf(n);zmUtil.parseURLS(t).length&&(u=u.replace(u.substring(i,i+n.length),r.outerHTML))});var w=(b=u).replace(/\n/gi,"<br />"),D="<div>",M="</div>";return e.hasOwnProperty("tags")&&(D="<"+e.tags+">",M="</"+e.tags+">"),w=D+w+M},t.bestFitWidth=function(n,e){var t=.75*n.offsetWidth,a=1,r=e.offsetWidth,i=e.offsetHeight;400<t&&(t=400),t<r&&(a=r/t),e.width=r/a,e.height=i/a},t}),define([],function(n,e){var t=n("zmComponent.markdown"),i={"<b>":" *","</b>":"* ","<i>":" -","</i>":"- ","<strike>":" ~","</strike>":"~ ","<u>":" _","</u>":"_ ","<highlight>":" `","</highlight>":"` "};return t.reverseMarkdown=function(a){Object.keys(i).forEach(function(n){a=a.replace(n,i[n])});var r=/[^<]*(<a href="([^"]+)">([^<]+)<\/a>)/g;return a.match(/<a[^>]*>([^<]+)<\/a>/g).forEach(function(n){if(0<=n.indexOf("ref='markdown")){var e=n.exec(r),t="["+e[3]+"]("+e[2]+")";a=a.replace(n,t)}}),a},t});