function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){"use strict";!function(e){"use strict";var i=1,a=function e(a){var t=a.data;var r={};if(t.length>1){for(var l in t){r.calmode=3;r.sindex=1;r.rcount=zmail.Search.Models.Contexts.calendarContextSearch.pageSize;if(a.paginate){i=i==1?r.rcount+1:i+r.rcount}r.sindex=i;if(t[l].name=="calendar"){r.calId=t[l].obj.calId}if(t[l].name=="title"){r.title=t[l].value}if(t[l].name=="date"){r.date=t[l].value;r.dateformat=zmail.userDateFormat}if(t[l].name=="location"){r.loc=t[l].value}if(t[l].name=="organizer"){r.orgId=t[l].obj.ORGANIZERID}if(t[l].name=="from-date"){r.from=t[l].value;r.dateformat=zmail.userDateFormat}if(t[l].name=="to-date"){r.to=t[l].value;r.dateformat=zmail.userDateFormat}if(t[l].name=="allday event"){r.allday=1}else{r.title!=r.title?r.title="":r.title=r.title;r.from!=r.from?r.from="":r.from=r.from;r.to!=r.to?r.to="":r.to=r.to;r.calId!=r.calId?r.calId="":r.calId=r.calId;r.date!=r.date?r.date="":r.date=r.date;r.loc!=r.loc?r.loc="":r.loc=r.loc;r.orgId!=r.orgId?r.orgId="":r.orgId=r.orgId;r.dateformat!=r.dateformat?r.dateformat="":r.dateformat=r.dateformat;r.allday!=r.allday?r.allday="":r.allday=r.allday}}}else{r.calmode=3;r.sindex=1;r.rcount=zmail.Search.Models.Contexts.calendarContextSearch.pageSize;if(a.paginate){i=i==1?r.rcount+1:i+r.rcount}r.sindex=i;if(t[0].name=="calendar"){r.calId=t[0].obj.calId}else if(t[0].name=="title"){r.title=t[0].value}else if(t[0].name=="location"){r.loc=t[0].value}else if(t[0].name=="organizer"){r.orgId=t[0].obj.ORGANIZERID}else if(t[0].name=="date"){r.date=t[0].value;r.dateformat=zmail.userDateFormat}else if(t[0].name=="from-date"){r.from=t[0].value;r.dateformat=zmail.userDateFormat}else if(t[0].name=="to-date"){r.to=t[0].value;r.dateformat=zmail.userDateFormat}else if(t[0].name=="allday event"){r.allday=1}}return r};e.calendarParam=a}(zmail.Core.Namespaces.create("zmail.Search.Utils.CommonUtil"))}(),function(){"use strict";!function(e){"use strict";e.calendarGenerator=function(e,a){var t=e.obj;var r=$(document.createDocumentFragment());var l=["SPAN",{attrs:{class:"SC_mtb"},child:[["text","Results from Calendar"]]}];l=_zm.getDOM(l);a.listingHeader.$el.find(".SC_flt").html(l);if(t!=undefined){if(t.length!=0){var i=$('<div class="zcl zcl_agendavw" id="zcl_workarea"></div>');var n=$('<ul id="zcl_encloser" class="zcl_frmbg"></ul>');var o=$("<li></li>");var c=$('<ul id="zcl_agnlst" class="zcl_agnlst"></ul>');i.append(n);n.append(o);o.append(c);for(var s in t){for(var u in t[s]){var m=t[s][u];var f=u;var d=zcal.getCalObj(m.CNAME);var v=t[s][u].SD,p=ZCL_parseDateStr(v),C=t[s][u].ST,z=t[s][u].ET,h=t[s][u].LOC,g=t[s][u].ADAY;var y=zcal.getCalObj(t[s][u].CNAME);var S=y[1].split(":"),F=ZCL_getCalColor(S[0]);var _=$("<li>"+'<div class="zcl_table">'+'<ul><li class="zcl_w70">'+"<img src="+t[s][u].PHOTO+' height="42px" width="42px">'+"</li>"+'<li class="zcl_w70">'+'<ul class="zcl_agdate">'+"<li>"+p.dateBy("E")+"</li>"+"<li>"+p.dateBy("dd")+"</li>"+"<li>"+p.dateBy("NNN yyyy")+"</li>"+"</ul> </li>"+'<li class="zcl_agncclr">'+'<span style = "background-color:'+F[1]+'"></span>'+"</li>"+'<li class="zcl_grevlst">'+"<ul><li><b>"+ZCL_getHTML(t[s][u].SUM)+"</b></li>"+"<li>"+(g==1?"<em>All day</em>":"<em>"+ZCL_timeInUFormat(C)+"-"+ZCL_timeInUFormat(z)+"</em>")+(h!=""?"<span>Location</span>":"")+"<em>"+ZCL_getHTML(h)+"</em></li>"+"</ul></li></ul></div></li>");I(_,m,f);c.append(_);r.append(i)}}}else{var i=$('<div class="zmInfoWarnMsg" id="noevents">No Events Found</div>');r.append(i)}}else{var i=$('<div class="zmInfoWarnMsg" id="noevents">No Events Found</div>');r.append(i)}return r};var I=function e(a,t,r,l){a.on("click",{obj:t},function(e){zcal[r]={};zcal[r].EMODE=0;ZCL_editEve(r,e,t.CNAME,t.EUID)})}}(zmail.Core.Namespaces.create("zmail.Search.Utils.CommonUtil"))}(),function(){"use strict";var a=zmail.Core.Namespaces,e=a.create("zmail.Search.Models.Filters");(function(e,a){"use strict";var t=a("zmail.Search.Utils.TypeCreator"),r=a("zmail.ValueTypeInferrer.TYPES"),l=t.newType(e.StringFilter,{className:"ZCalTitleFilter",name:"title",description:"text",valueType:r.String.name,multipleInstance:false,validate:function e(a){return _.isString(a)}});e.ZCalTitleFilter=l}).call(e,e,function(e){return a.get(e,{ignore__namespace:!0})})}(),function(){"use strict";var a=zmail.Core.Namespaces,e=a.create("zmail.Search.Models.Filters");(function(e,a){"use strict";var t,r=a("zmail.Search.Utils.TypeCreator").newType(e.StringFilter,{className:"LocationFilter",name:"location",description:"text",values:function e(m){var f=$.Deferred();var a=[];if(m!==""){if(m.length==1){if(Object.keys(zcal.search).indexOf("location")!=-1){if(Object.keys(zcal.search.location).indexOf(m)!=-1){for(var t in zcal.search.location[m]){var r={LOC:zcal.search.location[m][t].LOC};a.push(r)}f.resolve(a)}else{var l="/cal/suggest.do?mode=loc&srchLoc="+m;var i=ZCL_XHR(l,function(e){var a=ZCL_Evl(1,e.responseText);var t="",r=a.obj;var l=[];for(var i in r){for(var n in r[i]){l.push(r[i][n].LOC)}}var i,o=l.length,c=[],s={};for(i=0;i<o;i++){s[l[i]]=0}for(i in s){var u={LOC:i};c.push(u)}if(zcal.search.location){zcal.search.location[m]=c}else{zcal.search.location={};zcal.search.location[m]=c}if(a.status=="success"){f.resolve(c)}else{f.reject()}})}}else{var l="/cal/suggest.do?mode=loc&srchLoc="+m;var i=ZCL_XHR(l,function(e){var a=ZCL_Evl(1,e.responseText);var t="",r=a.obj;var l=[];for(var i in r){for(var n in r[i]){l.push(r[i][n].LOC)}}var i,o=l.length,c=[],s={};for(i=0;i<o;i++){s[l[i]]=0}for(i in s){var u={LOC:i};c.push(u)}if(zcal.search.location){zcal.search.location[m]=c}else{zcal.search.location={};zcal.search.location[m]=c}if(a.status=="success"){f.resolve(c)}else{f.reject()}})}}}return f.promise()},multipleInstance:false,filterProps:["LOC"],filterValues:true,autofillText:function e(a){a=a||{};var t=[a.LOC||""].join(", ");return t},getValue:function e(){var a=this.value||{};if(_.isString(a)){return a}return a.LOC||""},validate:function e(a){if(_typeof(a)=="object"||_.isString(a)){return true}}});e.LocationFilter=r}).call(e,e,function(e){return a.get(e,{ignore__namespace:!0})})}(),function(){"use strict";var a=zmail.Core.Namespaces,e=a.create("zmail.Search.Models.Filters");(function(e,a){"use strict";var t,c=a("zmail.Search.Utils.TypeCreator").newType(e.BaseFilter,{className:"ZCalOrganizerFilter",name:"organizer",description:"text/emailid",values:function e(a){var n=$.Deferred();var o=[];if(Object.keys(zcal.search).indexOf("organizer")!=-1){for(var t in zcal.search){for(var r in zcal.search[t]){o.push(zcal.search[t][r])}}n.resolve(o)}else{var l="/cal/suggest.do?mode=orgname&srchOrg="+c.name;var i=ZCL_XHR(l,function(e){var a=ZCL_Evl(1,e.responseText);var t="",r=a.obj;for(var l in r){for(var i in r[l]){t=r[l][i];o.push(t)}}zcal.search.organizer=o;if(a.status=="success"){n.resolve(o)}else{n.reject()}})}return n.promise()},multipleInstance:false,filterProps:["ORGANIZERNAME","EMAIL_ID","PHOTO"],filterValues:true,searchStartsWith:true,autofillDOM:function e(a){a=a||{};var t=a.ORGANIZERNAME||a.EMAIL_ID||a.PHOTO||"";var r=a.EMAIL_ID||"";var l=a.PHOTO||"";var i=$('<div class="zmConWra">');var n=$('<div class="SC_avtr">'+"<img src="+l+">"+"</div>"+'<div class="zmConData">'+"<div>"+'<strong class="js-name">'+t+"</strong>"+"</div>"+"<div>"+'<span class="js-desc">'+r+"</span>"+"</div>"+"</div>"+"</div>");i.append(n);return i},getValue:function e(){var a=this.value||{};if(_.isString(a)){return a}return a.ORGANIZERNAME||""},validate:function e(a){var t;if(_typeof(a)=="object"){t=a.ORGANIZERNAME}return _.isString(t)}});e.ZCalOrganizerFilter=c}).call(e,e,function(e){return a.get(e,{ignore__namespace:!0})})}(),function(){"use strict";var a=zmail.Core.Namespaces,e=a.create("zmail.Search.Models.Filters");(function(e,a){"use strict";var t,r=a("zmail.Search.Utils.TypeCreator").newType(e.BaseFilter,{className:"ZCalCalendarFilter",name:"calendar",description:"calendar name",values:function e(){var a=zcal.cdata.calLst,t=[];var r=Object.keys(a);for(var l in r){var i={};i.calName=a[r[l]][0];i.calId=r[l];t.push(i)}return t},multipleInstance:false,filterProps:["calName"],filterValues:true,autofillText:function e(a){return a.calName},getValue:function e(){var a=this.value||{};return a.calName||""},validate:function e(a){if(_typeof(a)=="object"){return true}return false}});e.ZCalCalendarFilter=r}).call(e,e,function(e){return a.get(e,{ignore__namespace:!0})})}(),function(){"use strict";var a=zmail.Core.Namespaces,e=a.create("zmail.Search.Models.Filters");(function(e,a){"use strict";var t,r=a("zmail.Search.Utils.TypeCreator").newType(e.BooleanFilter,{className:"ZCalAlldayFilter",name:"allday event",multipleInstance:false});e.ZCalAlldayFilter=r}).call(e,e,function(e){return a.get(e,{ignore__namespace:!0})})}(),function(){"use strict";(function(e){"use strict";var a,t=e("zmail.Search.Utils.TypeCreator").newType(this.BaseFilter,{name:"date",className:"ZCalDateFilter",viewClassName:"DateFilter",value:undefined,multipleInstance:false,validateOnSet:false,validate:function e(a){return a instanceof Date},getValue:function e(){if(this.value instanceof Date){return this.value.getDateBy(zmail.userDateFormat)}return}});this.ZCalDateFilter=t}).call(zmail.Core.Namespaces.create("zmail.Search.Models.Filters"),zmail.Core.Namespaces.get)}(),function(){"use strict";(function(l){"use strict ";var e=l("zmail.Search.Utils.TypeCreator"),i=this.ZCalDateFilter;this.ZCalFromDateFilter=e.newType(i,{name:"from-date",className:"ZCalFromDateFilter",multipleInstance:false,validate:function e(a){if(i.validate(a)){var t=l("zmail.Search.Environment");if(t.has("ZCalToDateFilter")){var r=t.get("ZCalToDateFilter")[0].toJSON().actualValue;if(i.validate(r)){return a.getTime()<r.getTime()}return false}return true}return false}})}).call(zmail.Core.Namespaces.create("zmail.Search.Models.Filters"),zmail.Core.Namespaces.get)}(),function(){"use strict";(function(l){"use strict";var e=l("zmail.Search.Utils.TypeCreator"),i=this.ZCalDateFilter;this.ZCalToDateFilter=e.newType(i,{name:"to-date",className:"CalToDateFilter",multipleInstance:false,validate:function e(a){if(i.validate(a)){var t=l("zmail.Search.Environment");if(t.has("ZCalFromDateFilter")){var r=t.get("ZCalFromDateFilter")[0].toJSON().actualValue;if(i.validate(r)){return a.getTime()>r.getTime()}return false}return true}return false}})}).call(zmail.Core.Namespaces.create("zmail.Search.Models.Filters"),zmail.Core.Namespaces.get)}(),function(){"use strict";function a(){var e=zmail.Search.Models.Filters,l=zmail.Search.Utils.CommonUtil,a={contextName:"Calendar",contextID:"calendar",tabRegexp:/zcal_Container/,placeholder:"Search Events",pageSize:100,defaultFilterClass:e.ZCalTitleFilter,filterClass:[e.ZCalTitleFilter,e.LocationFilter,e.ZCalOrganizerFilter,e.ZCalCalendarFilter,e.ZCalAlldayFilter,e.ZCalDateFilter,e.ZCalFromDateFilter,e.ZCalToDateFilter],shortcutId:"calendarSearch",url:"/zm/cal/srchAct.do",hasPagination:function(){return this.response&&this.response.haspagination},searchQuery:function(e){return l.calendarParam(e)},getView:function(e){var a=e.response,t=this.getFrameworkInstance(),r=a;return this.response=a,l.calendarGenerator(r,t)},contextIcon:"msi-calendar",ajax:function(e){var a=e;a.mstpcrdhkur=zmAjq.getCookie("aprmjrnpkcrkks");var t={url:this.url,type:"GET",data:$.param(a)};return $.ajax(t)}};return new zmail.Search.Models.Contexts.SearchContext(a)}function e(){var e;"undefined"==typeof zcal||zcal&&0==Object.keys(zcal.i18n).length?(e=$.Deferred(),zmApp.loadCalendar("/calendar/settings",e),e.promise()).done(function(){t.calendarContextSearch=a(),zmail.Search.registerContext(t.calendarContextSearch),zmail.Search.Models.Contexts.calendarContextSearch.contextName=zcal.i18n.calendar}):(t.calendarContextSearch=a(),zmail.Search.registerContext(t.calendarContextSearch),zmail.Search.Models.Contexts.calendarContextSearch.contextName=zcal.i18n.calendar),zmail.calSearchLoaded=!0,$.publish("CALSEARCH_INIT")}var t=zmail.Search.Models.Contexts;zmail.Search?e():$.subscribe("SEARCH_INIT",function(){e()})}();
