"use strict";!function(){var e=zmail.Core.Namespaces.create("dateParser"),a=zmText.get("dateParser"),t=function(e){this.par=e.par,this.config=e,this.event={},this.task={}},n={task:{}};n.task.getHeader=function(e){var t=e,n=$.e(zdom("li",{className:"stSel"},a.dParser.newTask));return n.off("click").on("click",function(){t.toggle("task")}),n},n.task.getContent=function(e){try{return new zmTask.Create({action:"addMTask",new:!0,tasks:{TITLE:e.title,DUEDATE:e.ts.getDateBy("dd MMM yyyy"),SUMMARY:""}}).taskEle}catch(e){return zmUtil.debugLog(e),""}},n.event={},n.event.getHeader=function(e){var t=e,n=$.e(zdom("li",null,a.dParser.newCal));return n.off("click").on("click",function(){t.toggle("event")}),n},n.event.getContent=function(e){try{return ZCL_mailDetViewEvePopup({action:"addMEvent",SUM:e.title,SD:e.ts.getDateBy("yyyyMMdd"),ST:e.ts.getTimeBy("HHmm"),view:"new"})}catch(e){return zmUtil.debugLog(e),""}},t.prototype.components=n,t.prototype.hide=function(){this.popref.hide()},t.prototype.toggle=function(e){var t=this.currApp;t!==e&&(this[t].header.removeClass("stSel"),this[e].header.addClass("stSel"),this[t].content.$el.removeClass("shw"),this[e].content.$el.addClass("shw"),this.currApp=e)},t.prototype.construct=function(){var n=this;Object.keys(this.components).forEach(function(e){var t=n.components[e].getContent(n.config);t?(n[e].content=t,n[e].header=n.components[e].getHeader(n)):(n[e].content={$el:$.e(zdom("fragment",null))},n[e].header="")});var t=zdom("ul",{className:"SCS_tab"});Object.keys(n.components).forEach(function(e){n[e].header&&t.appendChild(n[e].header[0])}),t=zdom("div",{className:"zm_ddTab"},t);var e=zdom("fragment",null,t,n.task.content.$el[0],n.event.content.$el[0]);n.event.content.$el&&n.event.content.$el.removeClass("shw"),n.task.content.$el.hasClass("shw")||n.task.content.$el.addClass("shw"),n.currApp="task";var a={divId:"Dote",spanClass:"minwid",par:this.par,showArrow:!0,loadHTML:!0,htm:e,onHide:function(){n.hide()}};n.popref=zmsuite.showMenu(a)};e.loadQuickAdder=function(e){e.ts instanceof Date||(e.ts=new Date(e.ts)),zmUtil.requireTaskModule("taskCreate").done(function(){new t(e).construct()})}}(),function(){var m=!1,d={0:function(e){var t=e.value,n=e.textToBeFocused;return zdom("span",{className:"zm_inLnk","data-value":t},n).outerHTML},1:function(e){var t=e.textToBeFocused,n=zmText.get("dateParser").dParser;return zdom("span",{className:"zmPhoneBridgeItem"},zdom("span",{className:"zmMailContIntegLink"},t),"Â ",zdom("span",{className:"zmBtn smallBtn thmBgBtn jsCallBtn","data-value":t},zdom("i",{className:"msi-audioCall jsCallBtn","data-value":t}),n.call)).outerHTML}};zmail.Core.Namespaces.create("ZMail.preview").smartHighlighter=function(e,t){try{var n=zdom("div",null,$.dangerouslyParseHTML(t)),l=[];if(e.hasOwnProperty("DATECONTENT")&&(a=e.DATECONTENT,s=(new Date).setHours(0,0,0,0),r=[],a.forEach(function(e,t){o=(o=e.MatchingDate[0]).replace(/ /,"T"),o=new Date(o),s<=o&&(e.type=0,r.push({focusType:0,textToBeFocused:e.MatchingText,value:e.MatchingDate[0]}))}),l=r),e.hasOwnProperty("PHONE_NUMBERS"))e.PHONE_NUMBERS.forEach(function(e){l.push({focusType:1,textToBeFocused:e})});if(m=!1,!l.length)return!1;return function e(t,n,a){var o;n=n||3;var s=t.childNodes,r=s.length;for(o=0;o<r&&!m;o++){var i=s[o];if(1===i.nodeType&&-1==="html,head,style,title,link,meta,script,object,iframe,".indexOf(i.nodeName.toLowerCase()+",")&&e(i,n,a),i.nodeType===n){var c=a(i.data);if(c){for(var l=document.createDocumentFragment(),d=zdom("div",null,$.dangerouslyParseHTML(c));d.firstChild;)l.appendChild(d.firstChild);var u=i.parentNode;u.insertBefore(l,i),u.removeChild(i)}}}}(n,3,function(e){e=_zm.escapeTags(e);var t,n,a,o,s,r,i="",c=!1;for(n=0;n<l.length;n++)t=(r=l[n]).textToBeFocused,-1!==(a=e.indexOf(t))&&(c=!0,o=a+t.length,s=(s=e.substring(0,o)).replace(t,d[r.focusType](r)),i=i.concat(s),e=e.substring(o,e.length),l.splice(n,1),n-=1,l.length||(m=!0));return i=i.concat(e),c&&i||""}),n.innerHTML}catch(e){zmUtil.debugLog(e)}var a,o,s,r}}();