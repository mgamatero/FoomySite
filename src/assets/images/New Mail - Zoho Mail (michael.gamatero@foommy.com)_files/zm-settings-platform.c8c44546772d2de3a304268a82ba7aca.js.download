"use strict";_defineSettingsModule("Models",function(t){var e=function(t,e){return Backbone.Model.extend(t,e)},n=function(t,e){return Backbone.Collection.extend(t,e)},i=e({}),r=n({model:i});t.Events={propsChange:"change",collectionAdd:"add",collectionRemove:"remove"},t.defineModel=e,t.defineCollection=n,t.BaseModel=i,t.BaseCollection=r},"Platform"),_defineSettingsModule("EntityModel",function(t,e){var n=e("Platform.Models");t.Props=n.defineModel({}),t.State=n.defineModel({}),t.Attributes=n.defineModel({defaults:{id:""}})},"Platform.Models"),_defineSettingsModule("ComponentModel",function(t,e){var n=e("Platform.Models");t.Props=n.defineModel({}),t.State=n.defineModel({}),t.Attributes=n.defineModel({defaults:{id:"",name:"",type:""}})},"Platform.Models"),_defineSettingsModule("Base",function(t,e,n){var l=e("Platform.System.Utils"),i=e("Platform.Models.EntityModel"),c=e("Platform.Events.Base"),r=n.Class,u=function(){};((u.prototype=new r).constructor=u).Events={change:"change",propsChange:"props.change",stateChange:"state.change",attributesChange:"attributes.change",exclusiveSetAdded:"exclusiveset.add",exclusiveSetRemoved:"exclusiveset.remove",managerAdded:"manager.add",managerRemoved:"manager.remove",destroyed:"destroyed"},u.validateID=function(t){if(!(t=t||""))throw new Error("[id] value is not valid - Cannot be empty");if(!1===/^([a-z-]+)$/gm.test(t))throw new Error("[id] value is not valid - Should only contain [a-z] & [-]");if("-"===t.charAt(0)||"-"===t.charAt(t.length-1))throw new Error("[id] value is not valid - [-] are allowed only in-between");if(t.replace(/([-]{2,})/gm,"-").length!==t.length)throw new Error("[id] value is not valid - Consecutive [-] are not allowed")};var o=l.makePrivateMethod(function(t){var e=(t=t||{}).props||{},n=t.state||{},i=t.attributes||{},r=l.copyProperties(this.constructor.prototype._required(),{props:[],state:[],attributes:[]});r.props.forEach(function(t){if(!e.hasOwnProperty(t))throw new Error("Required prop missing: "+t)}),r.state.forEach(function(t){if(!n.hasOwnProperty(t))throw new Error("Required state missing: "+t)}),r.attributes.forEach(function(t){if(!i.hasOwnProperty(t))throw new Error("Required attribute missing: "+t)})},u),a=l.makePrivateMethod(function(t){var e=this,n=e._default();(t=t||{}).props=t.props||{},t.state=t.state||{},t.attributes=t.attributes||{},o.call(e,t),t.props=l.copyProperties(t.props,n.props),t.state=l.copyProperties(t.state,n.state),t.attributes=l.copyProperties(t.attributes,n.attributes),e.props=new i.Props(t.props),e.state=new i.State(t.state),e.attributes=new i.Attributes(t.attributes)},u),s=l.makePrivateMethod(function(){var t=this._instanceProperties();l.copyProperties(t,this)},u),p={_required:function(){return{props:[],state:[],attributes:[]}},_default:function(){return{props:{},state:{},attributes:{}}},_instanceProperties:function(){return{_defaultEventHandlers:void 0}},init:function(t){a.call(this,t),s.call(this),this.bindEvents()},bindEvents:function(){var n=this;n.unbindEvents(),n.props.on("change",function(t){var e={instance:n,changed:l.cloneObject(t.changed),props:n.props,type:"props"};c.publishEvent(n,u.Events.propsChange,e)}),n.state.on("change",function(t){var e={instance:n,changed:l.cloneObject(t.changed),state:n.state,type:"state"};c.publishEvent(n,u.Events.stateChange,e)}),n.attributes.on("change",function(t){var e={instance:n,changed:l.cloneObject(t.changed),attributes:n.attributes,type:"attributes"};c.publishEvent(n,u.Events.attributesChange,e)});var t=[u.Events.propsChange,u.Events.stateChange,u.Events.attributesChange].join(" ");c.subscribeEvent(n,t,function(t){c.publishEvent(n,u.Events.change,t)});var e,i,r,o,a,s=n._defaultEventHandlers;if(s)for(e in s){for(o in(i=s[e]||[]).constructor!==Array&&(i=[i]),i)a="function"==typeof(o=i[o])?(r=n,o):("function"==typeof(r=o.source||n)&&(r=r()),o.handler);c.subscribeEvent(r,e,a)}},unbindEvents:function(){var t=this;t.props.off(),t.state.off(),t.attributes.off();var e=[u.Events.change,u.Events.propsChange,u.Events.stateChange,u.Events.attributesChange,u.Events.exclusiveSetAdded,u.Events.exclusiveSetRemoved,u.Events.managerAdded,u.Events.managerRemoved,u.Events.destroyed].join(" ");c.unsubscribeEvent(t,e);var n,i,r,o,a,s=t._defaultEventHandlers;if(s)for(n in s){for(o in(i=s[n]||[]).constructor!==Array&&(i=[i]),i)a="function"==typeof(o=i[o])?(r=t,o):("function"==typeof(r=o.source||t)&&(r=r()),o.handler);c.unsubscribeEvent(r,n,a)}},destroy:function(t){t=t||{},c.publishEvent(this,u.Events.destroyed),this.unbindEvents()},getProp:function(t){return 1===arguments.length?this.props.get(t):l.cloneObject(this.props.attributes)},setProp:function(){var t,e,n,i=this,r=[],o={};1===arguments.length&&"object"===babelHelpers.typeof(arguments[0])?(r=[t=arguments[0],n=arguments[1]||{}],o=t):2===arguments.length&&"object"===babelHelpers.typeof(arguments[0])&&"object"===babelHelpers.typeof(arguments[1])?(r=[t=arguments[0],n=arguments[1]||{}],o=t):"string"==typeof arguments[0]&&(r=[t=arguments[0],e=arguments[1],n=arguments[2]||{}],o[t]=e),n=n||{},i.props.set.apply(i.props,r),n.triggerChange&&!i.props.hasChanged()&&(i.props.changed=o,i.props.trigger("change",i.props))},getState:function(t){return 1===arguments.length?this.state.get(t):l.cloneObject(this.state.attributes)},setState:function(){var t,e,n,i=this,r=[],o={};1===arguments.length&&"object"===babelHelpers.typeof(arguments[0])?(r=[t=arguments[0],n=arguments[1]||{}],o=t):2===arguments.length&&"object"===babelHelpers.typeof(arguments[0])&&"object"===babelHelpers.typeof(arguments[1])?(r=[t=arguments[0],n=arguments[1]||{}],o=t):1<arguments.length&&"string"==typeof arguments[0]&&(r=[t=arguments[0],e=arguments[1],n=arguments[2]||{}],o[t]=e),n=n||{},i.state.set.apply(i.state,r),n.triggerChange&&!i.state.hasChanged()&&(i.state.changed=o,i.state.trigger("change",i.state))},getAttribute:function(t){return 1===arguments.length?this.attributes.get(t):l.cloneObject(this.attributes.attributes)},setAttribute:function(){var t,e,n,i=this,r={};1===arguments.length&&"object"===babelHelpers.typeof(arguments[0])?(t=arguments[0],n=arguments[1]||{},r=t):2===arguments.length&&"object"===babelHelpers.typeof(arguments[0])&&"object"===babelHelpers.typeof(arguments[1])?(t=arguments[0],n=arguments[1]||{},r=t):1<arguments.length&&"string"==typeof arguments[0]&&(t=arguments[0],e=arguments[1],n=arguments[2]||{},r[t]=e),n=n||{},i.attributes.set(t,e),n.triggerChange&&!i.attributes.hasChanged()&&(i.attributes.changed=r,i.attributes.trigger("change",i.attributes))},reset:function(){throw new Error("Not implemented")},on:function(t,e){c.subscribeEvent(this,t,e)},off:function(t,e){c.unsubscribeEvent(this,t,e)}};l.copyProperties(p,u.prototype),t.Entity=u},"Platform.System"),_defineSettingsModule("Models",function(t,e,n){var i=e("Platform.System.Base"),r=e("Platform.System.Utils"),o=i.Class,a=n.defineModel({defaults:{id:"",entity:null}}),s=n.defineCollection({model:a}),l=function(){};(l.prototype=new o).constructor=l;var c={init:function(t){if(t=t||{},this._collection=new s,"function"!=typeof t.type)throw new Error("Required property [type] missing in [opts] argument");this._class=t.type},get:function(e){var t=this._collection.find(function(t){if(t.get("id")===e)return!0});return t?t.get("entity"):null},getAll:function(){var t=this._collection,e=[];return t.each(function(t){e.push(t.get("entity"))}),e},put:function(t){var e=this._collection;if(this.get(t.getAttribute("id")))throw new Error("Entity with [id]="+t.getAttribute("id")+" exists in collection");if(!(t instanceof this._class))throw new Error("Entity not an instance of provided class type");e.on("add",function(){t.getProp("notifyNew")&&(App=zmail.Settings.MailSuite.App.Entities.MailSuiteApp,App.setProp({newCardAdded:!0}),App.setProp({newCardAdded:!1},{silent:!0}))}),e.add(new a({id:t.getAttribute("id"),entity:t}))},remove:function(e){var t=this._collection,n=t.find(function(t){if(t.get("id")===e)return!0});return n?(t.remove(n),n.get("entity")):null}};r.copyProperties(c,l.prototype);l.create=function(t,e){(e=e||{}).type=t;var n=new l;return n.init(e),n},t.EntityCollectionSet=l},"Platform"),_defineSettingsModule("EntitySet",function(t,e){var n=e("Platform.Models"),i=e("Platform.System.Base"),r=e("Platform.System.Utils"),o=e("Platform.Events.Base"),a=i.Class,s=i.Entity,l=n.BaseCollection,c=function(){};((c.prototype=new a).constructor=c).Events={entityAdded:"entityAdded",entityRemoved:"entityRemoved",selectionChanged:"selectionChanged"};var u=r.makePrivateMethod(function(e){return this._collection.find(function(t){return t.get("entity")===e})},c),p=r.makePrivateMethod(function(t){return void 0!==u.call(this,t)},c),d=r.makePrivateMethod(function(t){if(t.getState("selected")){var e=this._selected;e&&e!==t&&e.setState("selected",!1),this._selected=t,o.publishEvent(this,c.Events.selectionChanged,{instance:this,selected:t})}},c),f={init:function(t){t=t||{},this._collection=new l,this._selected=null},destroy:function(){},addEntity:function(t){var e=this,n=e._collection;if(t instanceof s&&!p.call(e,t)){n.add({entity:t}),d.call(e,t);var i=function(){d.call(e,t)};t.on(s.Events.stateChange,i),t._exclusiveSetStateChange=i,o.publishEvent(t,s.Events.exclusiveSetAdded,{exclusiveSet:e})}},removeEntity:function(t){var e=this,n=e._collection;if(t instanceof s){var i=u.call(e,t);i&&(n.remove(i),t.off(s.Events.stateChange,t._exclusiveSetStateChange),t._exclusiveSetStateChange=void 0,t===e._selected&&(e._selected=null),o.publishEvent(t,s.Events.exclusiveSetRemoved,{exclusiveSet:e}))}},on:function(t,e){o.subscribeEvent(this,t,e)},off:function(t,e){o.unsubscribeEvent(this,t,e)},getSelected:function(){return this._selected},setSelected:function(t){u.call(this,t)&&t.setState("selected",!0)}};r.copyProperties(f,c.prototype),t.ExclusiveSelection=c},"Platform.Models"),_defineSettingsModule("EntitySet",function(t,e){var n=e("Platform.Models"),i=e("Platform.System.Base"),r=e("Platform.System.Utils"),o=e("Platform.Events.Base"),a=i.Class,s=i.Entity,l=n.BaseCollection,c=function(){};((c.prototype=new a).constructor=c).Events={selectionChanged:"selectionChanged"};var u=r.makePrivateMethod(function(e){return this._collection.find(function(t){return t.get("entity")===e})},c),p=r.makePrivateMethod(function(t){return void 0!==u.call(this,t)},c),d=r.makePrivateMethod(function(t){t.getState("selected")&&o.publishEvent(this,c.Events.selectionChanged,{instance:this,selected:this.getSelected()})},c),f={init:function(t){t=t||{},this._collection=new l},destroy:function(){},addEntity:function(t){var e=this,n=e._collection;if(t instanceof s&&!p.call(e,t)){n.add({entity:t}),d.call(e,t);var i=function(){d.call(e,t)};t.on(s.Events.stateChange,i),t._inclusiveSetStateChange=i}},removeEntity:function(t){var e=this._collection;if(t instanceof s){var n=u.call(this,t);n&&(e.remove(n),t.off(s.Events.stateChange,t._inclusiveSetStateChange),d.call(this,t))}},on:function(t,e){o.subscribeEvent(this,t,e)},off:function(t,e){o.unsubscribeEvent(this,t,e)},getSelected:function(){var t=this._collection,n=[];return t.each(function(t){var e=t.get("entity");e.getState("selected")&&n.push(e)}),n},setSelected:function(t,e){u.call(this,t)&&t.setState("selected",e)}};r.copyProperties(f,c.prototype),t.InclusiveSelection=c},"Platform.Models"),_defineSettingsModule("Components",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.Models"),r=e("Platform.System.Utils"),o=e("Platform.Events.Base"),a=n.Class,s=i.EntityCollectionSet,l=function(){};((l.prototype=new a).constructor=l).Events={entityAdded:"entity.added",entityRemoved:"entity.removed"};var c={init:function(t){var e=this;t=t||{},e._entityType=t.entityType,e._entitySet=s.create(e._entityType),e._collection=e._entitySet._collection},create:function(){throw new Error("Abstract method")},get:function(t){return this._entitySet.get(t)},getAll:function(){return this._entitySet.getAll()},add:function(t){try{this._entitySet.put(t)}catch(t){return!1}return o.publishEvent(this,l.Events.entityAdded,{entity:t}),!0},put:function(t){return this.add(t)},remove:function(t){var e=this._entitySet.remove(t);return e&&o.publishEvent(this,l.Events.entityRemoved,{entity:e}),void 0!==e},on:function(t,e){o.subscribeEvent(this,t,e)},off:function(t,e){o.unsubscribeEvent(this,t,e)},filterBy:function(l){var t=this.getAll(),c=!(l=r.copyProperties(l,{props:{},state:{},attributes:{}})).hasOwnProperty("matchAll")||l.matchAll;return t=t.filter(function(t){var e,n,i,r=t.getProp(),o=t.getState(),a=t.getAttribute(),s=!0;for(e in l.props)s=r[e]===l.props[e]?c?s&&!0:s||!0:c?s&&!1:s||!1;for(n in l.state)s=o[n]===l.state[e]?c?s&&!0:s||!0:c?s&&!1:s||!1;for(i in l.attributes)s=a[i]===l.attributes[i]?c?s&&!0:s||!0:c?s&&!1:s||!1;return s})}};r.copyProperties(c,l.prototype),t.EntityManager=l},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.System.Utils"),r=n.Entity,o=function(){};(o.prototype=new r).constructor=o;var a={_default:function(){return{props:{iconImage:""},state:{hidden:!1,disabled:!1,selected:!1},attributes:{default:!1}}},_required:function(){return{props:["title"],attributes:["id"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getAttribute("id");r.validateID(e)}};i.copyProperties(a,o.prototype),t.Category=o},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.System.Utils"),r=n.Entity,o=function(){};(o.prototype=new r).constructor=o;var a={_required:function(){return{props:["transformer"],attributes:["id"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getAttribute("id");r.validateID(e)},transform:function(){var t=this.getProp("transformer");if("function"!=typeof t)throw new Error("[transformer] should be a function");return t.apply(this,arguments)}};i.copyProperties(a,o.prototype);o.isDataTransformerInstance=function(t){try{return t instanceof o}catch(t){return!1}},t.DataTransformer=o},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),a=e("Platform.System.Utils"),r=n.Entity,i=function(){};(i.prototype=new r).constructor=i;var o={_required:function(){return{props:["errors","fetch","save"],attributes:["id"]}},init:function(t){var e=this;t=t||{},r.prototype.init.call(e,t);var n=e.getProp("errors");if("object"!==babelHelpers.typeof(n)&&"function"!=typeof n)throw new Error("[errors] property is not valid");if("function"!=typeof e.getProp("fetch"))throw new Error("[fetch] property is not valid");if("function"!=typeof e.getProp("save"))throw new Error("[save] property is not valid");var i=e.getAttribute("id");r.validateID(i)},fetch:function(t){t=t||{};var e=this.getProp("fetch"),n=this.getProp("errors"),i=a.makeDeferred();"function"!=typeof n&&(n=function(t){return n[t]});var r=e(t);if(!a.isPromise(r))throw new Error("[fetch] function did not return a valid promise");return r.done(function(t){i.resolve(t)}),r.fail(function(t){if(arguments.length<1)throw new Error("[fetch] promise.fail() did not return a valid errCode");i.reject({code:t,message:n(t)})}),i.promise()},save:function(t,e){e=e||{};var n=this.getProp("save"),i=this.getProp("errors"),r=a.makeDeferred();"function"!=typeof i&&(i=function(t){return i[t]});var o=n(t,e);if(!a.isPromise(o)&&!a.isNativePromise(o))throw new Error("[save] function did not return a valid promise");return o.then(function(){r.resolve()},function(t){if(arguments.length<1)throw new Error("[save] promise.fail() did not return a valid errCode");r.reject({code:t,message:i(t)})}),r.promise()}};a.copyProperties(o,i.prototype);i.isPersisterInstance=function(t){try{return t instanceof i}catch(t){return!1}},t.Persister=i},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.System.Utils"),r=n.Entity,o=function(){};(o.prototype=new r).constructor=o;var a={_instanceProperties:function(){return{_openAction:null}},_default:function(){return{props:{title:"",selectable:!1,linkedPage:null,linkedPageSection:null},state:{selected:!1},attributes:{id:null,section:null}}},_required:function(){return{props:["title"],attributes:["id"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getAttribute("id");r.validateID(e)}};i.copyProperties(a,o.prototype),t.QuickNavigatorItem=o},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.System.Utils"),r=n.Entity,o=function(){};(o.prototype=new r).constructor=o;var a={_default:function(){return{props:{title:""},state:{selected:!1},attributes:{id:null}}},_required:function(){return{props:["title"],attributes:["id"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getAttribute("id");r.validateID(e)}};i.copyProperties(a,o.prototype),t.QuickNavigatorSection=o},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.System.Utils"),r=n.Entity,o=function(){};(o.prototype=new r).constructor=o;var a={_required:function(){return{props:["errors","validator"],attributes:["id"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getProp("errors");if("object"!==babelHelpers.typeof(e)&&"function"!=typeof e)throw new Error("[errors] property is not valid");if("function"!=typeof this.getProp("validator"))throw new Error("[validator] property is not valid");var n=this.getAttribute("id");r.validateID(n)},validate:function(t,e){e=e||{};var n=this.getProp("validator")(t,e);if(!n)throw new Error("[validator] result is invalid");if(!n.hasOwnProperty("valid"))throw new Error("[validator] result is invalid. No [valid] property found");var i,r=n.valid;if(!r&&!n.hasOwnProperty("errCode"))throw new Error("[validator] result is invalid. No [errCode] property found");if(!(r||(i=n.errCode)&&"number"==typeof i))throw new Error("[validator] result is invalid. [errCode] should be a number");if(n={valid:r},!r){var o,a=this.getProp("errors");o="function"==typeof a?a(i):a[i],n.error={code:i,message:o}}return n}};i.copyProperties(a,o.prototype);o.isValidatorInstance=function(t){try{return t instanceof o}catch(t){return!1}},t.Validator=o},"Platform"),_defineSettingsModule("Components",function(t,e,n){var i=e("Platform.Entities"),r=e("Platform.System.Utils"),o=i.Validator,a=n.EntityManager,s=function(){};(s.prototype=new a).constructor=s;var l={init:function(t){(t=t||{}).entityType=o,a.prototype.init.call(this,t)},create:function(t,e){var n=new o;return n.init({props:{errors:e.errors,validator:e.validator},attributes:{id:t}}),this.put(n),n}};r.copyProperties(l,s.prototype);var c=new s;c.init(),n.ValidatorManager=c},"Platform"),_defineSettingsModule("Basic",function(t,e){var n=e("Platform.Components").ValidatorManager,i=zmText.get("zm-settings-platform","basicValidators.errors"),r=n.create("basic-range",{errors:{1:i.belowMinRange,2:i.aboveMaxRange},validator:function(t,e){var n={valid:!1,errCode:-1};if(!(e=e||{}).hasOwnProperty("max")&&!e.hasOwnProperty("min"))throw new Error("RangeValidator requires range [max], [min] in [opts] arguments");var i=e.max;return t<e.min?n.errCode=1:i<t?n.errCode=2:n.valid=!0,n}}),o=n.create("basic-optionset",{errors:{1:i.notInOptionsSet},validator:function(t,e){var n={valid:!1,errCode:-1},i=(e=e||{}).options;if("function"==typeof i&&(i=i()),!i||i.constructor!==Array)throw new Error("OptionSetValidator required list of [options] in [opts] arguments");return-1!==i.indexOf(t)?n.valid=!0:n.errCode=1,n}});t.RangeValidator=r,t.OptionSetValidator=o},"Platform.Validators"),_defineSettingsModule("Types",function(t,e){var n=e("Platform.Components").ValidatorManager,i=zmText.get("zm-settings-platform","typeValidators.errors"),r=n.create("type-number",{errors:{1:i.notNumber},validator:function(t,e){var n={valid:!1,errCode:-1};return e=e||{},"number"!=typeof t?n.errCode=1:n.valid=!0,n}});t.NumberValidator=r},"Platform.Validators"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),s=e("Platform.System.Utils"),i=e("Platform.Entities"),r=e("Platform.Components"),o=n.Entity,a=i.Validator,l=i.Persister,c=r.ValidatorManager,u=function(){};(u.prototype=new o).constructor=u;var p={_default:function(){return{props:{defaultValue:"",value:void 0},state:{initialized:!1,initializing:!1,disabled:!1,hidden:!1,fetching:!1,saving:!1},attributes:{category:null}}},_required:function(){return{props:["defaultValue"],attributes:["id"]}},_instanceProperties:function(){return{_validations:[],_persister:null,_compareValue:null}},init:function(t){var e=this;t=t||{},e._validations=[],e._persister=null,o.prototype.init.call(e,t);var n=e.getAttribute("id");o.validateID(n),t.props&&t.props.hasOwnProperty("value")&&e.set(t.props.value)},initialize:function(t){var n=this,e=(t=t||{}).value;if(!0===t.reInit&&n.setState({initialized:!1}),n.getState("initialized"))return!0;n.setState({initializing:!0});var i,r=n._persister,o=function(t){var e=!1;return void 0===t&&(t=n.getProp("defaultValue")),n.set(t,{noSave:!0}).valid&&(n.setState({initialized:!0}),e=!0),n.setState({initializing:!1}),e};return!t.hasOwnProperty("value")&&r?(n.setState({fetching:!0}),(i=r.fetch()).done(o),i.fail(function(t){t=t||{},s.debugLog("initialize.fetch failed for setting",n,t)}),i.always(function(){n.setState({fetching:!1})}),i):o(e)},get:function(){return this.getState("initialized")?this.getProp("value"):this.getProp("defaultValue")},set:function(t,e){var n=this,i=n.validate(t);e=e||{};var r,o,a=n._persister;return i.valid?(e.customProp?(o=n.getProp(e.customProp),n.setProp({customProp:t})):(o=n.get(),n.setProp({value:t})),i.success=!0):i.success=!1,("function"==typeof n._compareValue?0!==n._compareValue(t,o):t!==o)&&!0===i.success&&a&&!e.noSave&&n.getState("initialized")&&(n.setState({saving:!0}),(r=a.save(t,e)).fail(function(t){s.debugLog("set.save failed for setting",n,t),e.revertOnFail&&(e.customProp?n.setProp({customProp:o}):n.setProp({value:o}))}),r.always(function(){n.setState({saving:!1})}),i.promise=r),i},validate:function(t){arguments.length<1&&(t=this.getProp("value"));var e,n,i,r,o=this._validations;o=o||[];var a=function(t){return function(){return t.validate.apply(e,arguments)}};for(var s in o){if(i=(e=o[s]).opts,!(n=a(e=e.validator)(t,i)||{}).hasOwnProperty("valid"))throw new Error("Validator returned invalid format result");if(!1===n.valid){if(!n.hasOwnProperty("error"))throw new Error("Validator returned invalid format result");if(!(r=n.error)||!r.hasOwnProperty("code")||!r.hasOwnProperty("message"))throw new Error("Validator returned invalid format result")}if(!1===n.valid)return n}return{valid:!0}},getPersister:function(){return this._persister},setPersister:function(t){if(!(t instanceof l)&&null!==t)throw new Error("Invalid persister argument");this._persister=t},addValidator:function(t,e){"string"==typeof t&&(t=c.get(t)),t instanceof a?this._validations.push({validator:t,opts:e}):s.debugLog("addValidator: Invalid validator provided")},removeValidator:function(n){if(n instanceof a){var i=-1;this._validations.filter(function(t,e){return t.validation===n&&(i=e),!0}),-1!==i&&this._validations.splice(i,1)}else s.debugLog("removeValidator: Invalid validator provided")}};s.copyProperties(p,u.prototype),t.Setting=u},"Platform"),_defineSettingsModule("Entities",function(t,e,n){var i=e("Platform.System.Utils"),r=e("Platform.Validators.Basic"),o=n.Setting,a=r.OptionSetValidator,s=function(){};(s.prototype=new o).constructor=s;var l={init:function(t){t=t||{},o.prototype.init.call(this,t),this.addValidator(a,{options:[!0,!1]})}};i.copyProperties(l,s.prototype),t.BooleanSetting=s},"Platform"),_defineSettingsModule("Entities",function(t,e,n){var i=e("Platform.System.Utils"),r=e("Platform.Validators.Basic"),o=n.Setting,a=r.OptionSetValidator,s=function(){};(s.prototype=new o).constructor=s;var l={_default:function(){var t;return t=o.prototype._default.call(this),t=i.copyProperties(t,{props:{options:[]}},!0)},_required:function(){var t;return(t=o.prototype._required.call(this)).props.push("options"),t},init:function(t){var e=this;t=t||{},o.prototype.init.call(e,t),e.addValidator(a,{options:function(){return e.getProp("options")||[]}})}};i.copyProperties(l,s.prototype),t.OptionSetting=s},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.System.Utils"),r=n.Entity,o=function(){};(o.prototype=new r).constructor=o;var a={_default:function(){return{props:{openable:!1,title:"",displayOrder:"auto",indicateNew:!1,indicateNewText:"",notifyNew:!1,loadFrameworkOnCommandExecution:!0,addToSearch:!0},state:{hidden:!1,disabled:!1},attributes:{category:null}}},_required:function(){return{props:["title"],attributes:["id"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getAttribute("id");r.validateID(e)}};i.copyProperties(a,o.prototype),t.SettingCard=o},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.System.Utils"),r=n.Entity,o=function(){};(o.prototype=new r).constructor=o;var a={_default:function(){return{props:{displayOrder:"auto",addToSearch:!0,loadFrameworkOnCommandExecution:!0,showInBreadCrumb:!1,showListCards:{}},attributes:{card:null}}},_required:function(){return{props:["title"],attributes:["id","type"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getAttribute("id");r.validateID(e)}};i.copyProperties(a,o.prototype);o.isSettingCardItemInstance=function(t){try{return t instanceof o}catch(t){return!1}},o.Types={Label:"label",Action:"action",LabelValue:"label-value",LabelAction:"label-action",RollingText:"rolling-text",colorDom:"color-dom"},t.SettingCardItem=o},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),i=e("Platform.System.Utils"),r=n.Entity,o={Basic:"pt-basic",Title:"pt-title",TitleToggleSwitch:"pt-title-toggleswitch",TitleChoiceMenu:"pt-title-choicemenu",PageAlone:"pt-page-alone"},a=function(){};(a.prototype=new r).constructor=a;var s={_default:function(){return{props:{title:"",showTitle:!1,toggleSwitchActive:!1,toggleSwitchFlex:!1,toggleSwitchOnText:"",toggleSwitchOffText:"",choiceItems:[],currentChoice:null,openPageAction:null,focusedSection:null},state:{active:!1},attributes:{type:o.Basic,appContainer:!1,pageCSSClass:"",pageClassNames:null,headerClassNames:null,containerClassNames:null,id:"",category:null,card:null,defaultPageName:null,activeCardItem:null,pageCSSClassName:null,mode:"",pageCategory:"",showActionable:!1}}},_required:function(){return{attributes:["id"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getAttribute("id");r.validateID(e)},isActive:function(){return this.getState("active")},onComponentCreate:function(t){"function"==typeof this._onComponentCreate&&this._onComponentCreate(t)},onFocusSection:function(t){return"function"==typeof this._onFocusSection&&this._onFocusSection(t)}};i.copyProperties(s,a.prototype),a.Types=o,t.SettingPage=a},"Platform"),_defineSettingsModule("Entities",function(t,n){var e=n("Platform.System.Base"),i=n("Platform.System.Utils"),r=e.Entity,o={Basic:"pst-basic",Title:"pst-title",TitleToggleSwitch:"pst-title-toggleswitch",PageAlone:"pst-page-alone"},a=function(){};(a.prototype=new r).constructor=a;var s={_default:function(){return{props:{title:"",toggleSwitchActive:!1,toggleSwitchOnText:"",toggleSwitchOffText:"",showSection:!0,position:"",infoMsg:"",showLoader:!1,highlight:!0,highlightCls:"highlightClass"},state:{disabled:!1},attributes:{page:null,type:o.Basic,appContainer:!1}}},_required:function(){return{attributes:["id"]}},init:function(t){t=t||{},r.prototype.init.call(this,t);var e=this.getAttribute("id");r.validateID(e)},isActive:function(){var t=this.getState(),e=this.getAttribute();return!(!n("Platform.Components.SettingPageManager").get(e.settingPage).isActive()||t.disabled)}};i.copyProperties(s,a.prototype),a.Types=o,t.SettingPageSection=a},"Platform"),_defineSettingsModule("Entities",function(t,e){var n=e("Platform.System.Base"),r=e("Platform.System.Utils"),i=e("Platform.Events.Base"),o=n.Entity,a=function(){};((a.prototype=new o).constructor=a).Events={viewUpdated:"view.updated"};var s={_default:function(){return{props:{reactInstance:null},state:{initialized:!1,active:!1,viewMounted:!1},attributes:{id:null,page:null,pageSection:null,isReactApp:!1}}},_required:function(){return{attributes:["id"]}},init:function(t){t=t||{},o.prototype.init.call(this,t);var e=this.getAttribute("id");o.validateID(e)},destroy:function(t){t=t||{},this.uninitialize(t),o.prototype.destroy.call(this,t)},initialize:function(t){var e,n=this;r.debugLog("[app] initialize invoked on app",n.getAttribute("id"));try{e=n._initialize(t)}catch(t){e=!1,r.debugLog("Error in initializing app",t)}var i=function(){n.setState({initialized:!0})};return r.isPromise(e)?e.done(i):r.isNativePromise(e)?e.then(i):e&&i(),e},uninitialize:function(t){var e,n=this;r.debugLog("[app] uninitialize invoked on app",n.getAttribute("id"));try{e=n._uninitialize(t)}catch(t){e=!1,r.debugLog("Error in uninitializing app",t)}var i=function(){n.setState({initialized:!1})};return r.isPromise(e)?e.done(i):e&&i(),e},getView:function(){var e;r.debugLog("[app] getView invoked on app",this.getAttribute("id"));try{e=this._getView()}catch(t){e=null,r.debugLog("Error in acquiring view for app",t)}return e},triggerViewUpdate:function(t){t=t||{},this.setState({viewUpdating:!0}),i.publishEvent(this,a.Events.viewUpdated,t),this.setState({viewUpdating:!1})},requestPreviewCard:function(t){return t=t||{},e("MailSuite.App.Core.Framework").requestPreviewCard(t)},handleContainerEvent:function(t,e){var n;r.debugLog("[app] handleContainerEvent invoked on app",this.getAttribute("id"),t,e);try{n=this._handleContainerEvent(t,e)}catch(t){n=null,r.debugLog("Error in handleContainerEvent invocation",t)}return n}};r.copyProperties(s,a.prototype),t.SettingApp=a},"Platform"),_defineSettingsModule("Components",function(t,e,n){var i=e("Platform.Models"),r=e("Platform.Entities"),o=e("Platform.System.Base"),a=e("Platform.System.Utils"),s=e("Platform.Events.Base"),l=o.Entity,c=r.Category,u=n.EntityManager,p=i.EntitySet.ExclusiveSelection,d=function(){};((d.prototype=new u).constructor=d).Events={categorySelected:"categorySelected",categoryAdded:"categoryAdded",categoryRemoved:"categoryRemoved"};var f={init:function(t){var e,n=this;(t=t||{}).entityType=c,u.prototype.init.call(n,t),n._exclusiveSet=new p,(e=n._exclusiveSet).init();var i=p.Events.selectionChanged;e.on(i,function(t){s.publishEvent(n,d.Events.categorySelected,t)})},add:function(t){var e=this._exclusiveSet;u.prototype.add.call(this,t)&&(e.addEntity(t),s.publishEvent(this,d.Events.categoryAdded,{category:t}),s.publishEvent(t,l.Events.managerAdded,{manager:this}))},remove:function(t){var e=this,n=e._exclusiveSet,i=e.get(t);u.prototype.remove.call(e,t)&&(n.removeEntity(i),i&&(s.publishEvent(e,d.Events.categoryRemoved,{category:i}),s.publishEvent(i,l.Events.managerRemoved,{manager:e})))},getDefault:function(){var t=this.getAll(),e=a.findInArray(t,function(t){return!0===t.getAttribute("default")});return e?e.getAttribute("id"):null},getSelected:function(){var t=this._exclusiveSet.getSelected();return t?t.getAttribute("id"):null},setSelected:function(t){var e=this._exclusiveSet,n=this.get(t);return!!n&&e.setSelected(n)},create:function(t,e){e=a.copyProperties(e,{attributes:{id:t}},!0);var n=new c;return n.init(e),this.put(n),n}};a.copyProperties(f,d.prototype);var g=new d;g.init(),g.Events=d.Events,t.CategoryManager=g},"Platform"),_defineSettingsModule("Components",function(t,e,n){var i=e("Platform.Entities"),r=e("Platform.System.Utils"),o=i.DataTransformer,a=n.EntityManager,s=function(){};(s.prototype=new a).constructor=s;var l={init:function(t){(t=t||{}).entityType=o,a.prototype.init.call(this,t)},create:function(t,e){var n=new o;return n.init({props:{transformer:e.transformer},attributes:{id:t}}),this.put(n),n},transform:function(t,e,n){var i=this.get(t);if(!o.isDataTransformerInstance(i))throw new Error("No transformer found with given id "+t);return i.getProp("transformer").apply(i,[e,n])}};r.copyProperties(l,s.prototype);var c=new s;c.init(),t.DataTransformerManager=c},"Platform"),_defineSettingsModule("Components",function(t,e,i){var n=e("Platform.Entities"),r=e("Platform.System.Utils"),o=n.Persister,a=i.EntityManager,s=function(){};(s.prototype=new a).constructor=s;var l={init:function(t){(t=t||{}).entityType=o,a.prototype.init.call(this,t)},create:function(t,e){var n=new o;(n.init({props:{errors:e.errors,fetch:e.fetch,save:e.save},attributes:{id:t}}),e.settingId)&&i.SettingManager.setPersister(e.settingId,n);return this.put(n),n}};r.copyProperties(l,s.prototype);var c=new s;c.init(),t.PersisterManager=c},"Platform"),_defineSettingsModule("Components",function(t,e,n){var i=e("Platform.Models"),r=e("Platform.Entities"),o=e("Platform.System.Utils"),a=r.QuickNavigatorItem,s=n.EntityManager,l=i.EntitySet.ExclusiveSelection,c=function(){};(c.prototype=new s).constructor=c;var u={init:function(t){(t=t||{}).entityType=a,s.prototype.init.call(this,t),this._exclusiveSet=new l,this._exclusiveSet.init()},add:function(t){var e=this._exclusiveSet;s.prototype.add.call(this,t)&&e.addEntity(t)},remove:function(t){var e=this._exclusiveSet,n=this.get(t);s.prototype.remove.call(this,t)&&e.removeEntity(n)},getSelected:function(){var t=this._exclusiveSet.getSelected();return t?t.getAttribute("id"):null},setSelected:function(t){var e=this._exclusiveSet,n=this.get(t);return!!n&&e.setSelected(n)},create:function(t,e){e=o.copyProperties(e,{attributes:{id:t}},!0);var n=new a(e);return n.init(e),"function"==typeof e.openAction&&(n._openAction=e.openAction),this.put(n),n},getAllBySection:function(t){return this.filterBy({attributes:{section:t}})}};o.copyProperties(u,c.prototype);var p=new c;p.init(),t.QuickNavigatorItemManager=p},"Platform"),_defineSettingsModule("Components",function(t,e,n){var i=e("Platform.Models"),r=e("Platform.Entities"),o=e("Platform.System.Utils"),a=r.QuickNavigatorSection,s=n.EntityManager,l=i.EntitySet.ExclusiveSelection,c=function(){};(c.prototype=new s).constructor=c;var u={init:function(t){(t=t||{}).entityType=a,s.prototype.init.call(this,t),this._exclusiveSet=new l,this._exclusiveSet.init()},add:function(t){var e=this._exclusiveSet;s.prototype.add.call(this,t)&&e.addEntity(t)},remove:function(t){var e=this._exclusiveSet,n=this.get(t);s.prototype.remove.call(this,t)&&e.removeEntity(n)},getSelected:function(){var t=this._exclusiveSet.getSelected();return t?t.getAttribute("id"):null},setSelected:function(t){var e=this._exclusiveSet,n=this.get(t);return!!n&&e.setSelected(n)},create:function(t,e){e=o.copyProperties(e,{attributes:{id:t}},!0);var n=new a;return n.init(e),this.put(n),n}};o.copyProperties(u,c.prototype);var p=new c;p.init(),t.QuickNavigatorSectionManager=p},"Platform"),_defineSettingsModule("Components",function(t,n,l){var e=n("Platform.System.Base"),i=n("Platform.Entities"),r=n("Platform.System.Utils"),o=i.SettingCardItem,a=l.EntityManager,s=l.DataTransformerManager,c=e.Entity,u=i.DataTransformer,p=function(){};(p.prototype=new a).constructor=p;var d={init:function(t){(t=t||{}).entityType=o,a.prototype.init.call(this,t)},create:function(t,e){e=r.copyProperties(e,{attributes:{id:t}},!0);var n,i=new o;return i.init(e),"string"==typeof e.transformer?n=s.get(e.transformer):u.isDataTransformerInstance(e.transformer)?n=e.transformer:"function"==typeof e.transformer&&(n=s.create(t,e)),n&&(i._transformer=n),e.primaryAction&&(i._primaryAction=e.primaryAction),e.secondaryAction&&(i._secondaryAction=e.secondaryAction),this.put(i),function(t,e){var n=t.getProp(),i=t.getAttribute(),r=e.searchCommand||{},o=l.SettingCardManager.get(i.card).getProp();if(r.title=r.title||n.title,r.triggerCommand=r.triggerCommand||"card-command-"+i.card,r.callback=r.callback||function(){t._primaryAction()},(e.searchCommand||n.addToSearch&&o.addToSearch)&&0<r.title.trim().length&&"function"==typeof t._primaryAction){var a=zmail.Settings.Platform.Commands,s=!0;r.hasOwnProperty("isSearchable")&&(s=r.isSearchable),a.register([{command:"carditem-command-"+i.id,title:r.title,executeDependentCommands:!1,on:r.triggerCommand,base:r.triggerCommand,isSearchable:s,callback:function(){r.callback.call(this)}}])}}(i,e),function(t,e){var n=t.getProp(),i=t.getAttribute(),r=l.SettingCardManager.get(i.card).getProp();if(e.searchCommand||r.addToSearch&&n.addToSearch){var o=e.searchCommand||{},a=o.callback||function(){t._primaryAction()};zmail.Commander.register({name:"settings-card-item-command-"+i.id,description:o.title||n.title,group:[o.triggerCommand||"","settings"+i.card],action:function(){return n.loadFrameworkOnCommandExecution?this.execute("load-settings").then(a):a()}})}}(i,e),i},bindSetting:function(t,e){var n=e.getProp();n.value=e.get(),t._transformer&&(n=t._transformer.transform("props",n)),t.setProp(n),this.bindSettingEvents(t,e)},unbindSetting:function(t,e){this.unbindSettingEvents(t,e)},bindSettingEvents:function(n,t){var e=c.Events;n._onSettingPropsChange=function(t){var e=(t=t||{}).changed||{};n._transformer&&(e=n._transformer.transform("props",e)),n.setProp(e)},t.on(e.propsChange,n._onSettingPropsChange)},unbindSettingEvents:function(t,e){var n=c.Events;e.off(n.propsChange,t._onSettingPropsChange),t._onSettingPropsChange=void 0},getAllByCard:function(t){return this.filterBy({attributes:{card:t}})}};r.copyProperties(d,p.prototype);var f=new p;f.init(),f.CardItemActions={OpenPageAction:function(t,e){return function(){return e=e||{},n("MailSuite.App.Core.Framework").requestShowPage(t,e)}}},t.SettingCardItemManager=f},"Platform"),_defineSettingsModule("Components",function(t,n,e){var i=n("Platform.Entities"),r=n("Platform.System.Base"),o=n("Platform.System.Utils"),a=n("Platform.Events.Base"),s=i.SettingCard,l=e.EntityManager,c=r.Entity,u=zmText.get("zm-settings-platform","components.cardManager"),p=function(){};(p.prototype=new l).constructor=p;var d={init:function(t){(t=t||{}).entityType=s,l.prototype.init.call(this,t)},create:function(t,e){e=o.copyProperties(e,{attributes:{id:t}},!0);var n=new s;return n.init(e),this.put(n),e.openAction&&(n._openAction=e.openAction),function(t,e){var n=t.getProp(),i=t.getAttribute(),r=e.searchCommand||{};if(r.title=r.title||n.title,r.triggerCommand=r.triggerCommand||"goto",r.callback=r.callback||function(){t._openAction()},(e.searchCommand||n.addToSearch)&&0<r.title.trim().length&&"function"==typeof r.callback){var o=zmail.Settings.Platform.Commands,a=zmail.Settings.SearchCommandIntegrator;o.register([{command:"card-command-goto-"+i.id,title:r.title,executeDependentCommands:!1,on:["goto"],isSearchable:!1,callback:function(){t._openAction()}}]),o.register([{command:"card-command-"+i.id,title:r.title,executeDependentCommands:!1,callback:function(){var t=this.getDependentCommands()||[];t.length?(t.unshift({command:"card-command-goto-"+i.id,title:u.labels.gotoPage}),a.showAutoFill(t)):r.callback.call(this)}}])}}(n,e),n},bindEvents:function(){var n=this;l.prototype.bindEvents.call(n),n.on(l.Events.entityAdded,function(t){var e=(t=t||{}).entity;a.publishEvent(e,c.Events.managerAdded,{manager:n})}),n.on(l.Events.entityRemoved,function(t){var e=(t=t||{}).entity;a.publishEvent(e,c.Events.managerRemoved,{manager:n})})},unbindEvents:function(){l.prototype.unbindEvents.call(this),this.off(l.Events.entityAdded),this.off(l.Events.entityRemoved)},getAllByCategory:function(t){return this.filterBy({attributes:{category:t}})}};o.copyProperties(d,p.prototype);var f=new p;f.init(),f.CardActions={OpenPageAction:function(t,e){return function(){return e=e||{},n("MailSuite.App.Core.Framework").requestShowPage(t,e)}}},t.SettingCardManager=f},"Platform"),_defineSettingsModule("Components",function(t,e,f){var g=e("Platform.Entities"),m=e("Platform.System.Utils"),h=g.Setting,v=g.BooleanSetting,y=g.OptionSetting,n=f.EntityManager,S=g.Validator,b={boolean:"boolean",option:"option"},i=function(){};(i.prototype=new n).constructor=i;var r={init:function(t){(t=t||{}).entityType=h,n.prototype.init.call(this,t)},create:function(t,e){e=m.copyProperties(e,{attributes:{id:t}},!0);var n=null;if((n=e.type===b.option?new y:e.type===b.boolean?new v:new h).init(e),this.put(n),e.persister){var i,r=g.Persister,o=f.PersisterManager;"string"==typeof e.persister?i=o.get(e.persister):r.isPersisterInstance(e.persister)?i=e.persister:"object"===babelHelpers.typeof(e.persister)&&(i=o.create(t,e.persister)),i&&n.setPersister(i)}if("function"==typeof e.compareValue&&(n._compareValue=e.compareValue),e.validations){var a=e.validations;a&&a.constructor!==Array&&(a=[a]),a.forEach(function(t){S.isValidatorInstance(t)?n.addValidator(t):n.addValidator(t.validator,t.opts)})}if(e.category){var s,l=g.Category,c=f.CategoryManager;"string"==typeof e.category?s=c.get(e.category):l.isCategoryInstance(e.category)&&(s=e.category),s&&n.setAttribute({category:s.getAttribute("id")})}if(e.cardItem){var u,p=g.SettingCardItem,d=f.SettingCardItemManager;"string"==typeof e.cardItem?u=d.get(e.cardItem):p.isSettingCardItemInstance(e.cardItem)?u=e.cardItem:"object"===babelHelpers.typeof(e.cardItem)&&(u=d.create(t,e.cardItem)),u&&d.bindSetting(u,n)}return n},getAllByCategory:function(e){return this.getAll().filter(function(t){return t.getAttribute("category")===e})}};m.copyProperties(r,i.prototype);var o=new i;o.init(),o.Types=b,t.SettingManager=o},"Platform"),_defineSettingsModule("Components",function(t,e,n){var i=e("Platform.Entities"),r=e("Platform.System.Utils"),o=i.SettingPage,a=n.EntityManager,s=function(){};(s.prototype=new a).constructor=s;var l={init:function(t){(t=t||{}).entityType=o,a.prototype.init.call(this,t)},create:function(t,e){e=r.copyProperties(e,{attributes:{id:t}},!0);var n=new o;return n.init(e),this.put(n),"function"==typeof e.onComponentCreate&&(n._onComponentCreate=e.onComponentCreate),"function"==typeof e.onFocusSection&&(n._onFocusSection=e.onFocusSection),n}};r.copyProperties(l,s.prototype);var c=new s;c.init(),t.SettingPageManager=c},"Platform"),_defineSettingsModule("Components",function(t,e,i){var n=e("Platform.Entities"),r=e("Platform.System.Utils"),o=n.SettingPageSection,a=i.EntityManager,s=function(){};(s.prototype=new a).constructor=s;var l={init:function(t){(t=t||{}).entityType=o,a.prototype.init.call(this,t)},create:function(t,e){e=r.copyProperties(e,{attributes:{id:t}},!0);var n=new o;return n.init(e),e.quickNavigation&&i.QuickNavigatorItemManager.create(t,e.quickNavigation),this.put(n),n},getAllByPage:function(t){return this.filterBy({attributes:{page:t}})}};r.copyProperties(l,s.prototype);var c=new s;c.init(),t.SettingPageSectionManager=c},"Platform"),_defineSettingsModule("Components",function(t,e,s){var n=e("Platform.Entities"),i=e("Platform.System.Base"),l=e("Platform.System.Utils"),c=i.Entity.Events,u=n.SettingApp,r=s.EntityManager,o=function(){};(o.prototype=new r).constructor=o;var a={init:function(t){(t=t||{}).entityType=u,r.prototype.init.call(this,t)},create:function(t,e){var r,n,i=s.SettingPageManager,o=s.SettingPageSectionManager;if((e=l.copyProperties(e,{attributes:{id:t}},!0)).attributes.page&&e.attributes.pageSection)throw new Error("Only [page] or [pageSection] is allowed");var a=new u;return a.init(e),"function"==typeof e.initialize&&(a._initialize=e.initialize),"function"==typeof e.uninitialize&&(a._uninitialize=e.uninitialize),"function"==typeof e.getView&&(a._getView=e.getView),"function"==typeof e.handleContainerEvent&&(a._handleContainerEvent=e.handleContainerEvent),(r=e.attributes.page?i.get(e.attributes.page):(n=o.get(e.attributes.pageSection),i.get(n.getAttribute("page")))).on(c.stateChange,function(t){if(((t=t||{}).changed||{}).hasOwnProperty("active")){var e=r.getState("active"),n=a.getState();a.setState({active:e&&n.initialized&&n.viewMounted})}}),a.on(c.stateChange,function(t){var e=(t=t||{}).changed||{},n=a.getState(),i=r.getState("active");e.hasOwnProperty("active")?a.handleContainerEvent(n.active?"active":"inactive",{}):(e.hasOwnProperty("initialized")||e.hasOwnProperty("viewMounted"))&&a.setState({active:i&&n.initialized&&n.viewMounted})}),this.put(a),a},getAppForPage:function(e){if(!e)return null;var t=this.getAll();return(t=t.filter(function(t){return t.getAttribute("page")===e}))[0]||null},getAppForPageSection:function(e){if(!e)return null;var t=this.getAll();return(t=t.filter(function(t){return t.getAttribute("pageSection")===e}))[0]||null}};l.copyProperties(a,o.prototype);var p=new o;p.init(),t.SettingAppManager=p},"Platform"),_defineSettingsModule("Commands",function(t,e,n){var i=function(t){t=t||{},this.map={},this.names=[]};i.prototype={add:function(t,e){var n,i=this.map;return t in i?n=i[t]:(n=[],i[t]=n,this.names.push(t),this.names.sort()),n.push(e),this},_remove:function(t){delete this.map[t];var e=this.names.indexOf(t);-1<=e&&this.names.splice(e,0)},remove:function(t,e){var n,i=this.map[t];return i&&i.length&&-1<=(n=i.indexOf(e))&&(i.splice(n,0),this._remove(t)),this},get:function(e){var t=this.map,n=[],i=_(this.names).filter(function(t){return-1!==t.indexOf(e)});return 0<i.length&&_(i).each(function(e){n=n.concat(_(t[e]).map(function(t){return{title:e,command:t}}))}),n}},n.SortedMap=i},"Platform"),_defineSettingsModule("Commands",function(s,t,e){var l={},c={},r=new e.SortedMap,u=new e.SortedMap,o=function(e,t){0<(t=(t=$.trim(t)||"").split(" ")).length&&e in l&&_(t).each(function(t){t in c||(c[t]=e)})},a={getDependentCommands:function(){return _(u.get(this.command)).map(function(t){return{command:t.command,title:l[t.command].title,base:l[t.command].base}})}},p=function(t,e,n){void 0===t[e]&&(t[e]=n)},n=function(e){var t;!function(t){if(!(t&&t.command&&t.callback&&t.title))throw new Error("define commands in proper structure");if(t.command in l)throw new Error("command name already exists")}(e),t=e,_.extend(t,a),p(t,"executeDependentCommands",!0),p(t,"suppressError",!0),p(t,"isSearchable",!0),(e=t).isSearchable&&r.add(e.title.toLocaleLowerCase(),e.command);var n=e.on&&$.trim(e.on)||"";if(n){var i=n.split(" ");_(i).each(function(t){t=c[t]||t,u.add(t,e.command)})}o(e.commandName,e.aliases),l[e.command]=e};s.register=function(t){_.isArray(t)||(t=[t]),_(t).each(function(t){n(t)})},s.setAliases=o,s.get=function(t){return t=t||"",_(r.get(t.toLocaleLowerCase())).map(function(t){return{command:t.command,title:l[t.command].title,base:l[t.command].base}})},s.getByCommandName=function(t){return l[t]},s.execute=function(t,e){var n,i,r,o=l[t]||l[c[t]];if(o)try{var a=o.callback(e);return o.executeDependentCommands&&(n=o,i=a,r=u.get(n.command),_(r).each(function(t){s.execute(t.command,i)})),a}catch(t){if(!o.suppressError)throw t;window.console.error("Suppressed Error: ",t)}}},"Platform"),function(){var n,r=zmail.Settings.Platform.Commands,o={};o.getSearchField=function(){return zmSearch.searchField},o.updateSearchText=function(t){if(t&&t.title){var e=$.trim(t.base||""),n=[];if(e){var i=e.split(" ");n=_(i).map(function(t){return r.getByCommandName(t).title})}n.push(t.title),o.getSearchField().val(n.join(" => "))}},o.clearSearchAutoFill=function(){void 0!==zmSearch.currentAutoFillId&&zmAutoFill.removeAutoFill(zmSearch.currentAutoFillId)},o.getAutoFillObj=function(t){return{contentArray:t||zmail.Settings.Platform.Commands.get(""),display:"title",compare:["title"],LType:"2",OType:"2",callback:function(t){o.updateSearchText(t),n&&_.isFunction(n.callback)?(n.callback(t),n=void 0):t&&t.title&&t.command&&r.execute(t.command)},text:!0}},o.updateAutoFill=function(t){o.clearSearchAutoFill(),zmSearch.currentAutoFillId=zmAutoFill.setAutofill(o.getAutoFillObj(t),o.getSearchField())},o.showAutoFill=function(t,e){n=e,setTimeout(function(){zmAutoFill.showAutoFill(o.getSearchField(),o.getAutoFillObj(t))})},zmail.Settings.SearchCommandIntegrator=o}(),function(t){var e=zmail.Settings.Platform.Commands,n=zmail.Settings.SearchCommandIntegrator,i=zmText.get("zm-settings-platform","commands"),r=function(t){var n=zmail.Settings.Platform.Components.SettingAppManager.getAppForPage(t),i=$.Deferred();if(n.getState().active)i.resolve();else{n.on("state.change",function t(e){e.changed&&e.changed.active&&(n.off("state.change",t),i.resolve())})}return zmail.Settings.MailSuite.App.Core.Framework.requestShowPage(t),i.promise()};e.register([{command:"goto",title:i.labels.goto,aliases:"",executeDependentCommands:!1,callback:function(){n.showAutoFill(this.getDependentCommands())}},{command:"show-carddeck",title:i.labels.dashboard,on:"goto",executeDependentCommands:!1,callback:function(){t("MailSuite.App.Core.Framework").requestShowCardDeck()}},{command:"load-filters",title:i.labels.loadFilters,isSearchable:!1,executeDependentCommands:!1,callback:function(){return r("filters")}},{command:"load-importexport",title:i.labels.importExport,isSearchable:!1,executeDependentCommands:!1,callback:function(){return r("importexport")}}])}(zmail.Settings.Modules.import),function(t){var r,e,a,s;r=zmail.Core.Namespaces.get,e=r("zmail.Commander"),a=r("$.Deferred"),s=zmText.get("zm-settings-platform","commands"),e.register([{name:"load-settings",group:"settings",description:s.labels.settings,searchable:!1,action:function(){return zmail.Settings.MailSuite.App.openApp()}},{name:"settings-card-deck",description:[s.labels.settingsDashboard,s.labels.gotoSettings],action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Framework");t.requestShowCardDeck()})}},{name:"load-antispam",description:s.labels.antispam,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam")})}},{name:"whitelist-domains",description:s.labels.whitelistdomain,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam").then(function(){var t=zmail.Settings.MailSuite.Apps.AntiSpam;t.Models.tabs.set({currentTab:2}),ZMStore.getInstance("WLDomainCollection").fetchCombinedList().then(function(){setTimeout(function(){t.Events.trigger("wd/focus")},100)})})})}},{name:"whitelist-emails",description:s.labels.whitelistemail,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam").then(function(){var t=zmail.Settings.MailSuite.Apps.AntiSpam;t.Models.tabs.set({currentTab:1}),t.Models.emailAddrTabs.set({currentTab:1}),ZMStore.getInstance("WLEmailCollection").fetchCombinedList().then(function(){setTimeout(function(){t.Events.trigger("we/focus")},100)})})})}},{name:"blacklist-emails",description:s.labels.blacklistemail,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam").then(function(){var t=zmail.Settings.MailSuite.Apps.AntiSpam;t.Models.tabs.set({currentTab:1}),t.Models.emailAddrTabs.set({currentTab:1}),ZMStore.getInstance("WLEmailCollection").fetchCombinedList().then(function(){setTimeout(function(){t.Events.trigger("be/focus")},100)})})})}},{name:"blacklist-domains",description:s.labels.blacklistdomain,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam").then(function(){var t=zmail.Settings.MailSuite.Apps.AntiSpam;t.Models.tabs.set({currentTab:2}),ZMStore.getInstance("WLDomainCollection").fetchCombinedList().then(function(){setTimeout(function(){t.Events.trigger("bd/focus")},100)})})})}},{name:"unsubscribed-list",description:s.labels.unsubscribedlist,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam").then(function(){zmail.Settings.MailSuite.Apps.AntiSpam.Models.tabs.set({currentTab:3})})})}},{name:"language-filter",description:s.labels.langfilter,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam").then(function(){zmail.Settings.MailSuite.Apps.AntiSpam.Models.tabs.set({currentTab:4})})})}},{name:"trusted-senders",description:s.labels.trust,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam").then(function(){var t=zmail.Settings.MailSuite.Apps.AntiSpam;t.Models.tabs.set({currentTab:1}),t.Models.emailAddrTabs.set({currentTab:2}),ZMStore.getInstance("WLEmailCollection").fetchCombinedList().then(function(){setTimeout(function(){t.Events.trigger("te/focus")},100)})})})}},{name:"rejected-senders",description:s.labels.reject,group:"settings-antispam",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("antispam").then(function(){var t=zmail.Settings.MailSuite.Apps.AntiSpam;t.Models.tabs.set({currentTab:1}),t.Models.emailAddrTabs.set({currentTab:2}),ZMStore.getInstance("WLEmailCollection").fetchCombinedList().then(function(){setTimeout(function(){t.Events.trigger("re/focus")},100)})})})}},{name:"load-smart-menu-setting",description:[s.labels.smartMenu],group:"settings-system",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("general-settings").then(function(){zmail.Settings.MailSuite.Apps.GeneralSettings.AppCore.setFocusedSection("smart-menu")})})}},{name:"load-desktop-notification-setting",description:[s.labels.desktopNotification],group:"settings-system",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("general-settings").then(function(){zmail.Settings.MailSuite.Apps.GeneralSettings.AppCore.setFocusedSection("desktop-notification")})})}},{name:"load-secure-your-download-setting",description:[s.labels.secureYourDownload],group:"settings-system",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("general-settings").then(function(){zmail.Settings.MailSuite.Apps.GeneralSettings.AppCore.setFocusedSection("secure-download")})})}},{name:"load-trash-cleanup-setting",description:[s.labels.trashretention],group:"settings-system",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("general-settings").then(function(){zmail.Settings.MailSuite.Apps.GeneralSettings.AppCore.setFocusedSection("trash-cleanup")})})}},{name:"load-label-preference-setting",description:[s.labels.labelpref],group:"settings-system",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("general-settings").then(function(){zmail.Settings.MailSuite.Apps.GeneralSettings.AppCore.setFocusedSection("icon-text")})})}},{name:"load-keyboard-shortcuts",description:s.labels.keyboardShortcuts,group:"settings-keyboard-shortcuts",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("keyboardshortcuts")})}},{name:"load-Compose",description:s.labels.composeSettings,group:"settings-compose-settings",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("compose-settings")})}},{name:"load-mail-conversation-settings",description:s.labels.conversation,group:"settings-conversation",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("mail-conversation-settings")})}},{name:"load-integrations-settings",description:s.labels.integrations,group:"settings-integrations-settings",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("integrations-settings")})}},{name:"load-signature",description:s.labels.signature,group:"settings-signatures",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("signatures")})}},{name:"load-outofoffice",description:s.labels.outOfOffice,group:"settings-outofoffice",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("vacationreply")})}},{name:"load-sendmailas",description:s.labels.sendMailAs,group:"settings-sendmailas",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("sendmailas")})}},{name:"load-mail-view-options",description:s.labels.mailViewOptions,group:"settings-view-options",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("mail-view-options")})}},{name:"load-folders",description:s.labels.folderSettings,group:"settings-folders",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("folders")})}},{name:"load-filters",description:s.labels.filters,group:"settings-filters",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("filters")})}},{name:"import-filter",description:s.labels.importFilters,group:"settings-filters-import",action:function(){return this.execute("load-filters").done(function(){zmail.Settings.Apps.Filter.Views.Utils.importFilters()})}},{name:"export-filter",description:s.labels.exportFilters,group:"settings-filters-export",action:function(){return this.execute("load-filters").done(function(){zmail.Settings.Apps.Filter.Views.Utils.exportFilters()})}},{name:"create-new-incoming-filter",description:[s.labels.newIncomingFilter,s.labels.createIncomingFilter,s.labels.addIncomingFilter],group:"settings-filters-incoming-new",searchable:!0,action:function(){return this.execute("load-filters").then(function(){zmail.Settings.Apps.Filter.Events.trigger("show-filter-bottom-band"),zmail.Settings.Apps.Filter.Models.filterTabs.set({currentTab:1}),ZMStore.getInstance("IncomingFilterCollection").fetchFilters().then(function(){zmail.Settings.Apps.Filter.Events.trigger("create-new-filter")})})}},{name:"create-new-outgoing-filter",description:[s.labels.newOutgoingFilter,s.labels.createOutgoingFilter,s.labels.addOutgoingFilter],group:"settings-filters-outgoing-new",searchable:!0,action:function(){return this.execute("load-filters").then(function(){zmail.Settings.Apps.Filter.Models.filterTabs.set({currentTab:2}),ZMStore.getInstance("OutgoingFilterCollection").fetchFilters().then(function(){zmail.Settings.Apps.Filter.Events.trigger("create-new-filter")})})}},{name:"edit-incoming-filters",description:[s.labels.editIncomingFilters,s.labels.updateIncomingFilters],group:"settings-filters-edit",searchable:!0,action:function(){var e=this;this.preventDefault();var n=a();return this.execute("load-filters").then(function(){return ZMStore.getInstance("IncomingFilterCollection").fetchFilters().then(function(){var t=zmail.Settings.Apps.Filter.Models.getFilterNamesAndId();if(zmail.Settings.Apps.Filter.Models.filterTabs.set({currentTab:1}),t&&0<t.length)return e.setPlaceholder(s.labels.selectFilters),n.resolve(),e.showList({provider:t,text:"name",filterProps:"name"}).then(function(t){zmail.Settings.Apps.Filter.Events.trigger("edit-filter"+t.id),e.reset(!0)});n.resolve(),e.reset(!0)})}),n.promise()}},{name:"edit-outgoing-filters",description:[s.labels.editOutgoingFilters,s.labels.updateOutgoingFilters],searchable:!0,group:"settings-filters-edit",action:function(){var e=this;this.preventDefault();var n=a();return this.execute("load-filters").then(function(){return ZMStore.getInstance("OutgoingFilterCollection").fetchFilters().then(function(){var t=zmail.Settings.Apps.Filter.Models.getOutgoingFilterNamesAndId();if(zmail.Settings.Apps.Filter.Models.filterTabs.set({currentTab:2}),t&&0<t.length)return e.setPlaceholder(s.labels.selectFilters),n.resolve(),e.showList({provider:t,text:"name",filterProps:"name"}).then(function(t){zmail.Settings.Apps.Filter.Events.trigger("edit-filter"+t.id),e.reset(!0)});n.resolve(),e.reset(!0)})}),n.promise()}},{name:"run-through-filters",description:[s.labels.runThroughFilter,s.labels.filterRunThrough],group:"settings-filters-runThrough",action:function(){var e,n=this;this.preventDefault();var i=a();return this.execute("load-filters").then(function(){return ZMStore.getInstance("IncomingFilterCollection").fetchFilters().then(function(){var t=zmail.Settings.Apps.Filter.Models.getFilterNamesAndId();if(zmail.Settings.Apps.Filter.Models.filterTabs.set({currentTab:1}),t&&0<t.length)return n.setPlaceholder(s.labels.selectFolder),n.showList({provider:r("zmfolAction").getMailFolderPaths(),text:"path"}).then(function(t){return e=t,n.setPlaceholder(s.labels.selectFilter),n.showList({provider:zmail.Settings.Apps.Filter.Models.getFilterNamesAndId(),text:"name"})}).then(function(t){return ZMStore.getInstance("IncomingFilterCollection").get(t.id).runThrough(e.id)}).then(function(){$.publish("/mail/listMails"),r("_zm").succErrMsg("s",s.labels.runThroughSuccessful),n.reset(!0)});i.resolve(),n.reset(!0)})}),i.promise()}},{name:"load-import-export",description:s.labels.importExport,group:"settings-import-export",action:function(){return this.execute("load-settings").then(function(){var t=r("zmail.Settings.MailSuite.App.Core.Util");return t.loadSettingsPage("importexport")})}},{name:"show-export-log",description:s.labels.exportLog,group:"settings-import-export-exportLog",action:function(){return this.execute("load-import-export").then(function(){zmail.Settings.Apps.ImportExport.Views.Utils.showExportList()})}},{name:"show-import-log",description:s.labels.importLog,group:"settings-import-export-importLog",action:function(){return this.execute("load-import-export").then(function(){zmail.Settings.Apps.ImportExport.Views.Utils.showImportList()})}},{name:"show-ewidget-app",description:s.labels.gotoeWidget,action:function(){var r=this;this.preventDefault();var o=a();return ZMWidgets.openRhs().done(function(){r.setPlaceholder(s.labels.searchApps);var t=ZMWidgets.getPluginsByLocation("rhs").list,e=ZMWidgets.getDisabledApps(),n=[];for(var i in t)e.indexOf(i)<0&&n.push({name:t[i].displayName,id:i});r.showList({provider:n,text:"name"}).then(function(t){ZMWidgets.renderApp(t.id),r.reset(!0)}),o.resolve()}),o.promise()}}])}();